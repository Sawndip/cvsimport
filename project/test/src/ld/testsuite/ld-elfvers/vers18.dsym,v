head	1.4;
access;
symbols
	binutils-2_24-branch:1.4.0.8
	binutils-2_24-branchpoint:1.4
	binutils-2_21_1:1.3.2.1
	binutils-2_23_2:1.4
	binutils-2_23_1:1.4
	binutils-2_23:1.4
	binutils-2_23-branch:1.4.0.6
	binutils-2_23-branchpoint:1.4
	binutils-2_22_branch:1.4.0.4
	binutils-2_22:1.4
	binutils-2_22-branch:1.4.0.2
	binutils-2_22-branchpoint:1.4
	binutils-2_21:1.3
	binutils-2_21-branch:1.3.0.2
	binutils-2_21-branchpoint:1.3
	binutils-2_20_1:1.2
	binutils-2_20:1.2
	binutils-arc-20081103-branch:1.2.0.28
	binutils-arc-20081103-branchpoint:1.2
	binutils-2_20-branch:1.2.0.26
	binutils-2_20-branchpoint:1.2
	dje-cgen-play1-branch:1.2.0.24
	dje-cgen-play1-branchpoint:1.2
	arc-20081103-branch:1.2.0.22
	arc-20081103-branchpoint:1.2
	binutils-2_19_1:1.2
	binutils-2_19:1.2
	binutils-2_19-branch:1.2.0.20
	binutils-2_19-branchpoint:1.2
	binutils-2_18:1.2
	binutils-2_18-branch:1.2.0.18
	binutils-2_18-branchpoint:1.2
	binutils-csl-coldfire-4_1-32:1.2
	binutils-csl-sourcerygxx-4_1-32:1.2
	binutils-csl-innovasic-fido-3_4_4-33:1.2
	binutils-csl-sourcerygxx-3_4_4-32:1.2
	binutils-csl-coldfire-4_1-30:1.2
	binutils-csl-sourcerygxx-4_1-30:1.2
	binutils-csl-coldfire-4_1-28:1.2
	binutils-csl-sourcerygxx-4_1-29:1.2
	binutils-csl-sourcerygxx-4_1-28:1.2
	binutils-csl-arm-2006q3-27:1.2
	binutils-csl-sourcerygxx-4_1-27:1.2
	binutils-csl-arm-2006q3-26:1.2
	binutils-csl-sourcerygxx-4_1-26:1.2
	binutils-csl-sourcerygxx-4_1-25:1.2
	binutils-csl-sourcerygxx-4_1-24:1.2
	binutils-csl-sourcerygxx-4_1-23:1.2
	binutils-csl-sourcerygxx-4_1-21:1.2
	binutils-csl-arm-2006q3-21:1.2
	binutils-csl-sourcerygxx-4_1-22:1.2
	binutils-csl-palmsource-arm-prelinker-1_0-1:1.2
	binutils-csl-sourcerygxx-4_1-20:1.2
	binutils-csl-arm-2006q3-19:1.2
	binutils-csl-sourcerygxx-4_1-19:1.2
	binutils-csl-sourcerygxx-4_1-18:1.2
	binutils-csl-renesas-4_1-9:1.2
	binutils-csl-sourcerygxx-3_4_4-25:1.2
	binutils-csl-renesas-4_1-8:1.2
	binutils-csl-renesas-4_1-7:1.2
	binutils-csl-renesas-4_1-6:1.2
	binutils-csl-sourcerygxx-4_1-17:1.2
	binutils-csl-sourcerygxx-4_1-14:1.2
	binutils-csl-sourcerygxx-4_1-15:1.2
	binutils-csl-sourcerygxx-4_1-13:1.2
	binutils-2_17:1.2
	binutils-csl-sourcerygxx-4_1-12:1.2
	binutils-csl-sourcerygxx-3_4_4-21:1.2
	binutils-csl-wrs-linux-3_4_4-24:1.2
	binutils-csl-wrs-linux-3_4_4-23:1.2
	binutils-csl-sourcerygxx-4_1-9:1.2
	binutils-csl-sourcerygxx-4_1-8:1.2
	binutils-csl-sourcerygxx-4_1-7:1.2
	binutils-csl-arm-2006q1-6:1.2
	binutils-csl-sourcerygxx-4_1-6:1.2
	binutils-csl-wrs-linux-3_4_4-22:1.2
	binutils-csl-coldfire-4_1-11:1.2
	binutils-csl-sourcerygxx-3_4_4-19:1.2
	binutils-csl-coldfire-4_1-10:1.2
	binutils-csl-sourcerygxx-4_1-5:1.2
	binutils-csl-sourcerygxx-4_1-4:1.2
	binutils-csl-wrs-linux-3_4_4-21:1.2
	binutils-csl-morpho-4_1-4:1.2
	binutils-csl-sourcerygxx-3_4_4-17:1.2
	binutils-csl-wrs-linux-3_4_4-20:1.2
	binutils-2_17-branch:1.2.0.16
	binutils-2_17-branchpoint:1.2
	binutils-csl-2_17-branch:1.2.0.14
	binutils-csl-2_17-branchpoint:1.2
	binutils-csl-gxxpro-3_4-branch:1.2.0.12
	binutils-csl-gxxpro-3_4-branchpoint:1.2
	binutils-2_16_1:1.2
	binutils-csl-arm-2005q1b:1.2
	binutils-2_16:1.2
	binutils-csl-arm-2005q1a:1.2
	binutils-csl-arm-2005q1-branch:1.2.0.10
	binutils-csl-arm-2005q1-branchpoint:1.2
	binutils-2_16-branch:1.2.0.8
	binutils-2_16-branchpoint:1.2
	csl-arm-2004-q3d:1.2
	csl-arm-2004-q3:1.2
	binutils-2_15:1.2
	binutils-2_15-branchpoint:1.2
	csl-arm-2004-q1a:1.2
	csl-arm-2004-q1:1.2
	binutils-2_15-branch:1.2.0.6
	cagney_bfdfile-20040213-branch:1.2.0.4
	cagney_bfdfile-20040213-branchpoint:1.2
	cagney_bigcore-20040122-branch:1.2.0.2
	cagney_bigcore-20040122-branchpoint:1.2
	csl-arm-2003-q4:1.2
	binutils-2_14:1.1.10.1
	binutils-2_14-branch:1.1.0.10
	binutils-2_14-branchpoint:1.1
	binutils-2_13_2_1:1.1
	binutils-2_13_2:1.1
	binutils-2_13_1:1.1
	binutils-2_13:1.1
	binutils-2_13-branchpoint:1.1
	binutils-2_13-branch:1.1.0.8
	binutils-2_12_1:1.1
	binutils-2_12:1.1
	binutils-2_12-branch:1.1.0.6
	binutils-2_12-branchpoint:1.1
	cygnus_cvs_20020108_pre:1.1
	binutils-2_11_2:1.1
	binutils-2_11_1:1.1
	binutils-2_11:1.1
	x86_64versiong3:1.1
	binutils-2_11-branch:1.1.0.4
	binutils-2_10_1:1.1
	binutils-2_10:1.1
	binutils-2_10-branch:1.1.0.2
	binutils-2_10-branchpoint:1.1
	binutils_latest_snapshot:1.4
	repo-unification-2000-02-06:1.1
	binu_ss_19990721:1.1;
locks; strict;
comment	@# @;


1.4
date	2010.12.10.06.08.11;	author vapier;	state Exp;
branches;
next	1.3;

1.3
date	2010.10.28.09.08.35;	author amodra;	state Exp;
branches
	1.3.2.1;
next	1.2;

1.2
date	2003.05.05.03.33.09;	author hjl;	state Exp;
branches;
next	1.1;

1.1
date	99.07.07.15.36.29;	author ian;	state Exp;
branches
	1.1.10.1;
next	;

1.3.2.1
date	2011.02.10.03.41.08;	author amodra;	state Exp;
branches;
next	;

1.1.10.1
date	2003.05.06.01.15.09;	author drow;	state Exp;
branches;
next	;


desc
@@


1.4
log
@ld: elfvers tests: support symbol prefixed targets

The symbol versioning tests mix C-visible symbols and linker-visible
symbols in order to verify .symver behavior.  This works for most
people, but fail for targets that have a symbol prefix.  So add a
helper file with macros that expand gcc's __USER_LABEL_PREFIX__ as
necessary and convert all .symver users over to it.

Now that the tests are usable on prefixed targets, update the tests
to take into account an optional leading underscore.

Signed-off-by: Mike Frysinger <vapier@@gentoo.org>
@
text
@0+ g +DO \*ABS\*	0+ +VERS_1\.1 +VERS_1\.1
0+ g +DO \*ABS\*	0+ +VERS_1\.2 +VERS_1\.2
0+ g +DO \*ABS\*	0+ +VERS_2\.0 +VERS_2\.0
[0-9a-f]+ +w +DF (\.text|\.opd|\*ABS\*)	[0-9a-f]+ \(Base\) +(0x[0-9a-f]+ )?_?show_foo
[0-9a-f]+ +w +DF (\.text|\.opd|\*ABS\*)	[0-9a-f]+ \(VERS_1\.1\) +(0x[0-9a-f]+ )?_?show_foo
[0-9a-f]+ +w +DF (\.text|\.opd|\*ABS\*)	[0-9a-f]+ \(VERS_1\.2\) +(0x[0-9a-f]+ )?_?show_foo
[0-9a-f]+ +w +DF (\.text|\.opd|\*ABS\*)	[0-9a-f]+ +VERS_2\.0 +(0x[0-9a-f]+ )?_?show_foo
@


1.3
log
@	* ld-elfvers/vers.exp: Enable test for powerpc64.
	* ld-elfweak/elfweak.exp: Likewise
	* ld-shared/shared.exp: Likewise.  Xfail non-pic dso tests for ppc64.
	* ld-elfvers/vers1.dsym, * ld-elfvers/vers1.sym,
	* ld-elfvers/vers2.dsym, * ld-elfvers/vers3.dsym,
	* ld-elfvers/vers4.sym, * ld-elfvers/vers4a.dsym,
	* ld-elfvers/vers4a.sym, * ld-elfvers/vers6.dsym,
	* ld-elfvers/vers6.sym, * ld-elfvers/vers7a.dsym,
	* ld-elfvers/vers7a.sym, * ld-elfvers/vers9.dsym,
	* ld-elfvers/vers9.sym, * ld-elfvers/vers15.dsym,
	* ld-elfvers/vers15.sym, * ld-elfvers/vers16.dsym,
	* ld-elfvers/vers16a.dsym, * ld-elfvers/vers17.dsym,
	* ld-elfvers/vers18.dsym, * ld-elfvers/vers18.sym,
	* ld-elfvers/vers19.dsym, * ld-elfvers/vers20.dsym,
	* ld-elfvers/vers21.dsym, * ld-elfvers/vers21.sym,
	* ld-elfvers/vers22.dsym, * ld-elfvers/vers22a.dsym,
	* ld-elfvers/vers22a.sym, * ld-elfvers/vers22b.dsym,
	* ld-elfvers/vers23.dsym, * ld-elfvers/vers23a.dsym,
	* ld-elfvers/vers23a.sym, * ld-elfvers/vers23b.dsym,
	* ld-elfvers/vers25a.dsym, * ld-elfvers/vers26a.dsym,
	* ld-elfvers/vers27a.dsym, * ld-elfvers/vers27d.dsym,
	* ld-elfvers/vers27d.sym, * ld-elfvers/vers27d4.dsym,
	* ld-elfvers/vers28b.dsym, * ld-elfvers/vers28c.dsym,
	* ld-elfvers/vers29.dsym, * ld-elfvers/vers30.dsym,
	* ld-elfvers/vers31.dsym, * ld-elfvers/vers32a.dsym,
	* ld-elfvers/vers32b.dsym, * ld-elfvers/vers32c.dsym,
	* ld-elfweak/dso.dsym, * ld-elfweak/dsodata.dsym,
	* ld-elfweak/dsow.dsym, * ld-elfweak/dsowdata.dsym,
	* ld-elfweak/strong.sym, * ld-elfweak/strongcomm.sym,
	* ld-elfweak/strongdata.sym, * ld-elfweak/weak.dsym,
	* ld-elfweak/weakdata.dsym: Relax whitespace matching, tighten
	non-whitespace matching.  Match powerpc64 functions in .opd section.
	* ld-shared/elf-offset.ld: Place powerpc64 .toc sections.
@
text
@d4 4
a7 4
[0-9a-f]+ +w +DF (\.text|\.opd|\*ABS\*)	[0-9a-f]+ \(Base\) +(0x[0-9a-f]+ )?show_foo
[0-9a-f]+ +w +DF (\.text|\.opd|\*ABS\*)	[0-9a-f]+ \(VERS_1\.1\) +(0x[0-9a-f]+ )?show_foo
[0-9a-f]+ +w +DF (\.text|\.opd|\*ABS\*)	[0-9a-f]+ \(VERS_1\.2\) +(0x[0-9a-f]+ )?show_foo
[0-9a-f]+ +w +DF (\.text|\.opd|\*ABS\*)	[0-9a-f]+ +VERS_2\.0 +(0x[0-9a-f]+ )?show_foo
@


1.3.2.1
log
@apply mainline testsuite fixes and tweaks
@
text
@d4 4
a7 4
[0-9a-f]+ +w +DF (\.text|\.opd|\*ABS\*)	[0-9a-f]+ \(Base\) +(0x[0-9a-f]+ )?_?show_foo
[0-9a-f]+ +w +DF (\.text|\.opd|\*ABS\*)	[0-9a-f]+ \(VERS_1\.1\) +(0x[0-9a-f]+ )?_?show_foo
[0-9a-f]+ +w +DF (\.text|\.opd|\*ABS\*)	[0-9a-f]+ \(VERS_1\.2\) +(0x[0-9a-f]+ )?_?show_foo
[0-9a-f]+ +w +DF (\.text|\.opd|\*ABS\*)	[0-9a-f]+ +VERS_2\.0 +(0x[0-9a-f]+ )?_?show_foo
@


1.2
log
@bfd/

2003-05-04  H.J. Lu <hjl@@gnu.org>

	* elflink.h (elf_merge_symbol): Correctly handle weak definiton.

ld/testsuite/

2003-05-04  H.J. Lu <hjl@@gnu.org>

	* ld-elfvers/vers18.dsym: Updated for weak definiton change.
	* ld-elfvers/vers18.ver: Likewise.
	* ld-elfvers/vers19.ver: Likewise.

	* ld-elfweak/elfweak.exp: Remove xfail.
@
text
@d1 7
a7 7
[0]* g    DO \*ABS\*	[0]*  VERS_1.1    VERS_1.1
[0]* g    DO \*ABS\*	[0]*  VERS_1.2    VERS_1.2
[0]* g    DO \*ABS\*	[0]*  VERS_2.0    VERS_2.0
[0-9a-f]*  w   DF (.text|\*ABS\*)	[0-9a-f]* \(Base\)       (0x[0-9a-f][0-9a-f] )?show_foo
[0-9a-f]*  w   DF (.text|\*ABS\*)	[0-9a-f]* \(VERS_1.1\)   (0x[0-9a-f][0-9a-f] )?show_foo
[0-9a-f]*  w   DF (.text|\*ABS\*)	[0-9a-f]* \(VERS_1.2\)   (0x[0-9a-f][0-9a-f] )?show_foo
[0-9a-f]*  w   DF (.text|\*ABS\*)	[0-9a-f]*  VERS_2.0    (0x[0-9a-f][0-9a-f] )?show_foo
@


1.1
log
@	* ld-elfvers/vers.exp: Add new tests vers17 to vers19.
	* ld/elfvers/{vers17.*, vers18.*, vers19.*}: New files.
@
text
@a0 1
[0-9a-f]*  w   DF (\*UND\*)	[0-9a-f]*  VERS_2.0    (0x[0-9a-f][0-9a-f] )?show_foo
d7 1
@


1.1.10.1
log
@	Merge from mainline:
	2003-05-04  H.J. Lu <hjl@@gnu.org>
	* ld-elfvers/vers18.dsym: Updated for weak definiton change.
	* ld-elfvers/vers18.ver: Likewise.
	* ld-elfvers/vers19.ver: Likewise.
	* ld-elfweak/dsowdata.dsym: Likewise.
	* ld-elfweak/elfweak.exp: Likewise.
	* ld-elfweak/weakdata.dsym: Likewise.

	* ld-elfweak/elfweak.exp: Remove xfail.

	2003-05-03  H.J. Lu <hjl@@gnu.org>
	* ld-elfvers/vers.exp: Add vers27a, vers27b, vers27c1 and
	vers27c2 to test versioned definition vs. hidden definition in
	different files.

	* ld-elfvers/vers27a.c: New file.
	* ld-elfvers/vers27a.dsym: Likewise.
	* ld-elfvers/vers27a.map: Likewise.
	* ld-elfvers/vers27a.ver: Likewise.
	* ld-elfvers/vers27b.c: Likewise.

	* ld-elfvers/vers27b.dsym: New empty file.
	* ld-elfvers/vers27b.ver: Likwise.
	* ld-elfvers/vers27c.c: Likwise.
	* ld-elfvers/vers27c.dsym: Likwise.
	* ld-elfvers/vers27c.ver: Likwise.

	2003-05-02  Andreas Jaeger  <aj@@suse.de>
	* ld-elfvers/vers.exp (build_exec): Disable vers26b3 on x86-64-linux.
@
text
@d1 1
a7 1
[0-9a-f]*  w   DF (.text|\*ABS\*)	[0-9a-f]*  VERS_2.0    (0x[0-9a-f][0-9a-f] )?show_foo
@


