head	1.12;
access;
symbols
	binutils-2_24-branch:1.12.0.10
	binutils-2_24-branchpoint:1.12
	binutils-2_21_1:1.12
	binutils-2_23_2:1.12
	binutils-2_23_1:1.12
	binutils-2_23:1.12
	binutils-2_23-branch:1.12.0.8
	binutils-2_23-branchpoint:1.12
	binutils-2_22_branch:1.12.0.6
	binutils-2_22:1.12
	binutils-2_22-branch:1.12.0.4
	binutils-2_22-branchpoint:1.12
	binutils-2_21:1.12
	binutils-2_21-branch:1.12.0.2
	binutils-2_21-branchpoint:1.12
	binutils-2_20_1:1.11
	binutils-2_20:1.11
	binutils-arc-20081103-branch:1.11.0.16
	binutils-arc-20081103-branchpoint:1.11
	binutils-2_20-branch:1.11.0.14
	binutils-2_20-branchpoint:1.11
	dje-cgen-play1-branch:1.11.0.12
	dje-cgen-play1-branchpoint:1.11
	arc-20081103-branch:1.11.0.10
	arc-20081103-branchpoint:1.11
	binutils-2_19_1:1.11
	binutils-2_19:1.11
	binutils-2_19-branch:1.11.0.8
	binutils-2_19-branchpoint:1.11
	binutils-2_18:1.11
	binutils-2_18-branch:1.11.0.6
	binutils-2_18-branchpoint:1.11
	binutils-csl-coldfire-4_1-32:1.11
	binutils-csl-sourcerygxx-4_1-32:1.11
	binutils-csl-innovasic-fido-3_4_4-33:1.11
	binutils-csl-sourcerygxx-3_4_4-32:1.7
	binutils-csl-coldfire-4_1-30:1.11
	binutils-csl-sourcerygxx-4_1-30:1.11
	binutils-csl-coldfire-4_1-28:1.11
	binutils-csl-sourcerygxx-4_1-29:1.11
	binutils-csl-sourcerygxx-4_1-28:1.11
	binutils-csl-arm-2006q3-27:1.11
	binutils-csl-sourcerygxx-4_1-27:1.11
	binutils-csl-arm-2006q3-26:1.11
	binutils-csl-sourcerygxx-4_1-26:1.11
	binutils-csl-sourcerygxx-4_1-25:1.11
	binutils-csl-sourcerygxx-4_1-24:1.11
	binutils-csl-sourcerygxx-4_1-23:1.11
	binutils-csl-sourcerygxx-4_1-21:1.11
	binutils-csl-arm-2006q3-21:1.11
	binutils-csl-sourcerygxx-4_1-22:1.11
	binutils-csl-palmsource-arm-prelinker-1_0-1:1.11
	binutils-csl-sourcerygxx-4_1-20:1.11
	binutils-csl-arm-2006q3-19:1.11
	binutils-csl-sourcerygxx-4_1-19:1.11
	binutils-csl-sourcerygxx-4_1-18:1.11
	binutils-csl-renesas-4_1-9:1.11
	binutils-csl-sourcerygxx-3_4_4-25:1.7
	binutils-csl-renesas-4_1-8:1.11
	binutils-csl-renesas-4_1-7:1.11
	binutils-csl-renesas-4_1-6:1.11
	binutils-csl-sourcerygxx-4_1-17:1.11
	binutils-csl-sourcerygxx-4_1-14:1.11
	binutils-csl-sourcerygxx-4_1-15:1.11
	binutils-csl-sourcerygxx-4_1-13:1.11
	binutils-2_17:1.11
	binutils-csl-sourcerygxx-4_1-12:1.11
	binutils-csl-sourcerygxx-3_4_4-21:1.11
	binutils-csl-wrs-linux-3_4_4-24:1.7
	binutils-csl-wrs-linux-3_4_4-23:1.7
	binutils-csl-sourcerygxx-4_1-9:1.11
	binutils-csl-sourcerygxx-4_1-8:1.11
	binutils-csl-sourcerygxx-4_1-7:1.11
	binutils-csl-arm-2006q1-6:1.11
	binutils-csl-sourcerygxx-4_1-6:1.11
	binutils-csl-wrs-linux-3_4_4-22:1.7
	binutils-csl-coldfire-4_1-11:1.11
	binutils-csl-sourcerygxx-3_4_4-19:1.11
	binutils-csl-coldfire-4_1-10:1.11
	binutils-csl-sourcerygxx-4_1-5:1.11
	binutils-csl-sourcerygxx-4_1-4:1.11
	binutils-csl-wrs-linux-3_4_4-21:1.7
	binutils-csl-morpho-4_1-4:1.11
	binutils-csl-sourcerygxx-3_4_4-17:1.11
	binutils-csl-wrs-linux-3_4_4-20:1.7
	binutils-2_17-branch:1.11.0.4
	binutils-2_17-branchpoint:1.11
	binutils-csl-2_17-branch:1.11.0.2
	binutils-csl-2_17-branchpoint:1.11
	binutils-csl-gxxpro-3_4-branch:1.7.0.6
	binutils-csl-gxxpro-3_4-branchpoint:1.7
	binutils-2_16_1:1.7
	binutils-csl-arm-2005q1b:1.7
	binutils-2_16:1.7
	binutils-csl-arm-2005q1a:1.7
	binutils-csl-arm-2005q1-branch:1.7.0.4
	binutils-csl-arm-2005q1-branchpoint:1.7
	binutils-2_16-branch:1.7.0.2
	binutils-2_16-branchpoint:1.7
	csl-arm-2004-q3d:1.7
	csl-arm-2004-q3:1.7
	binutils-2_15:1.4
	binutils-2_15-branchpoint:1.4
	csl-arm-2004-q1a:1.4
	csl-arm-2004-q1:1.4
	binutils-2_15-branch:1.4.0.6
	cagney_bfdfile-20040213-branch:1.4.0.4
	cagney_bfdfile-20040213-branchpoint:1.4
	cagney_bigcore-20040122-branch:1.4.0.2
	cagney_bigcore-20040122-branchpoint:1.4
	csl-arm-2003-q4:1.4
	binutils-2_14:1.3
	binutils-2_14-branch:1.3.0.2
	binutils-2_14-branchpoint:1.3
	binutils_latest_snapshot:1.12;
locks; strict;
comment	@# @;


1.12
date	2009.09.23.03.12.27;	author amodra;	state Exp;
branches;
next	1.11;

1.11
date	2006.02.02.22.53.46;	author hjl;	state Exp;
branches;
next	1.10;

1.10
date	2006.02.02.22.05.56;	author hjl;	state Exp;
branches;
next	1.9;

1.9
date	2005.08.15.15.39.48;	author amodra;	state Exp;
branches;
next	1.8;

1.8
date	2005.03.16.21.52.47;	author hjl;	state Exp;
branches;
next	1.7;

1.7
date	2004.09.22.07.24.14;	author amodra;	state Exp;
branches;
next	1.6;

1.6
date	2004.07.02.11.25.54;	author kkojima;	state Exp;
branches;
next	1.5;

1.5
date	2004.05.12.05.58.09;	author kkojima;	state Exp;
branches;
next	1.4;

1.4
date	2003.12.01.06.56.51;	author amodra;	state Exp;
branches;
next	1.3;

1.3
date	2003.04.24.05.19.09;	author kkojima;	state Exp;
branches;
next	1.2;

1.2
date	2002.11.04.01.18.13;	author kkojima;	state Exp;
branches;
next	1.1;

1.1
date	2002.10.11.14.44.55;	author kkojima;	state Exp;
branches;
next	;


desc
@@


1.12
log
@Tolerate some whitespace differences in readelf output.
@
text
@#source: tlsbinpic.s
#source: tlsbin.s
#as: -little
#ld: -EL tmpdir/tlsbin-0-dso.so
#readelf: -Ssrl
#target: sh*-*-linux* sh*-*-netbsd*

There are [0-9]+ section headers, starting at offset 0x[0-9a-f]+:

Section Headers:
 +\[Nr\] Name +Type +Addr +Off +Size +ES Flg Lk Inf Al
 +\[ 0\] +NULL +0+ 0+ 0+ 0+ +0 +0 +0
 +\[ 1\] \.interp .*
 +\[ 2\] \.hash .*
 +\[ 3\] \.dynsym .*
 +\[ 4\] \.dynstr .*
 +\[ 5\] \.rela\.dyn .*
 +\[ 6\] \.rela\.plt .*
 +\[ 7\] \.plt .*
 +\[ 8\] \.text +PROGBITS .*
 +\[ 9\] \.tdata +PROGBITS .* 0+018 00 WAT +0 +0 +4
 +\[10\] \.tbss +NOBITS .* 0+010 00 WAT +0 +0 +1
#...
 +\[[0-9a-f]+\] \.got +PROGBITS .*
#...
 +\[[0-9a-f]+\] \.shstrtab .*
 +\[[0-9a-f]+\] \.symtab .*
 +\[[0-9a-f]+\] \.strtab .*
Key to Flags:
.*
.*
.*

Elf file type is EXEC \(Executable file\)
Entry point 0x402000
There are [0-9]+ program headers, starting at offset [0-9]+

Program Headers:
 +Type +Offset +VirtAddr +PhysAddr +FileSiz +MemSiz +Flg Align
 +PHDR.*
 +INTERP.*
.*Requesting program interpreter.*
 +LOAD.*
 +LOAD.*
 +DYNAMIC.*
 +TLS +0x[0-9a-f]+ 0x[0-9a-f]+ 0x[0-9a-f]+ 0x0+18 0x0+28 R +0x4

 Section to Segment mapping:
 +Segment Sections\.\.\.
 +00 +
 +01 +\.interp *
 +02 +\.interp \.hash \.dynsym \.dynstr \.rela\.dyn \.rela\.plt \.plt \.text *
 +03 +\.tdata \.dynamic \.got *
 +04 +\.dynamic *
 +05 +\.tdata \.tbss *

Relocation section '\.rela\.dyn' at offset 0x[0-9a-f]+ contains 4 entries:
 Offset +Info +Type +Sym\.Value +Sym\. Name \+ Addend
[0-9a-f ]+R_SH_TLS_TPOFF32 +0+ +sG3 \+ 0
[0-9a-f ]+R_SH_TLS_TPOFF32 +0+ +sG2 \+ 0
[0-9a-f ]+R_SH_TLS_TPOFF32 +0+ +sG4 \+ 0
[0-9a-f ]+R_SH_TLS_TPOFF32 +0+ +sG1 \+ 0

Relocation section '\.rela\.plt' at offset 0x[0-9a-f]+ contains 1 entries:
 Offset +Info +Type +Sym\.Value +Sym\. Name \+ Addend
[0-9a-f ]+R_SH_JMP_SLOT[0-9a-f ]+__tls_get_addr \+ [0-9a-f]+

Symbol table '\.dynsym' contains [0-9]+ entries:
 +Num: +Value +Size +Type +Bind +Vis +Ndx +Name
.* NOTYPE +LOCAL +DEFAULT +UND *
.* TLS +GLOBAL +DEFAULT +UND sG3
.* TLS +GLOBAL +DEFAULT +UND sG2
.* TLS +GLOBAL +DEFAULT +UND sG4
.* FUNC +GLOBAL +DEFAULT +UND __tls_get_addr
#...
.* TLS +GLOBAL +DEFAULT +UND sG1
#...

#pass
@


1.11
log
@Updo the last change to binutils and ld/testsuite.
@
text
@d11 12
a22 12
  \[Nr\] Name +Type +Addr +Off +Size +ES Flg Lk Inf Al
  \[ 0\] +NULL +0+ 0+ 0+ 0+ +0 +0 +0
  \[ 1\] \.interp .*
  \[ 2\] \.hash .*
  \[ 3\] \.dynsym .*
  \[ 4\] \.dynstr .*
  \[ 5\] \.rela\.dyn .*
  \[ 6\] \.rela\.plt .*
  \[ 7\] \.plt .*
  \[ 8\] \.text +PROGBITS .*
  \[ 9\] \.tdata +PROGBITS .* 0+018 00 WAT  0   0  4
  \[10\] \.tbss +NOBITS .* 0+010 00 WAT  0   0  1
d24 1
a24 1
  \[[0-9a-f]+\] \.got +PROGBITS .*
d26 3
a28 3
  \[[0-9a-f]+\] \.shstrtab .*
  \[[0-9a-f]+\] \.symtab .*
  \[[0-9a-f]+\] \.strtab .*
d39 3
a41 3
  Type +Offset +VirtAddr +PhysAddr +FileSiz +MemSiz +Flg Align
  PHDR.*
  INTERP.*
d43 4
a46 4
  LOAD.*
  LOAD.*
  DYNAMIC.*
  TLS +0x[0-9a-f]+ 0x[0-9a-f]+ 0x[0-9a-f]+ 0x0+18 0x0+28 R +0x4
d49 7
a55 7
  Segment Sections\.\.\.
   00 +
   01 +\.interp *
   02 +\.interp \.hash \.dynsym \.dynstr \.rela\.dyn \.rela\.plt \.plt \.text *
   03 +\.tdata \.dynamic \.got *
   04 +\.dynamic *
   05 +\.tdata \.tbss *
d69 6
a74 6
 +Num: +Value +Size Type +Bind +Vis +Ndx Name
.* NOTYPE +LOCAL +DEFAULT  UND *
.* TLS +GLOBAL DEFAULT  UND sG3
.* TLS +GLOBAL DEFAULT  UND sG2
.* TLS +GLOBAL DEFAULT  UND sG4
.* FUNC +GLOBAL DEFAULT  UND __tls_get_addr
d76 1
a76 1
.* TLS +GLOBAL DEFAULT  UND sG1
@


1.10
log
@binutils/

2006-02-02  H.J. Lu  <hongjiu.lu@@intel.com>

	* readelf.c (process_program_headers): Undo the change made on
	2004-09-22.  Match PT_DYNAMIC segment only with SHT_DYNAMIC
	sections.

ld/testsuite/

2006-02-02  H.J. Lu  <hongjiu.lu@@intel.com>

	* ld-i386/tlsbin.rd: Update for changed segment map.
	* ld-i386/tlsnopic.rd: Likewise.
	* ld-i386/tlspic.rd: Likewise.
	* ld-powerpc/tlsexe.r: Likewise.
	* ld-powerpc/tlsexe32.r: Likewise.
	* ld-powerpc/tlsexetoc.r: Likewise.
	* ld-powerpc/tlsso.r: Likewise.
	* ld-powerpc/tlsso32.r: Likewise.
	* ld-powerpc/tlstocso.r: Likewise.
	* ld-s390/tlsbin.rd: Likewise.
	* ld-s390/tlsbin_64.rd: Likewise.
	* ld-s390/tlspic.rd: Likewise.
	* ld-s390/tlspic_64.rd: Likewise.
	* ld-sh/tlsbin-2.d: Likewise.
	* ld-sh/tlspic-2.d: Likewise.
	* ld-x86-64/tlsbin.rd: Likewise.
	* ld-x86-64/tlspic.rd: Likewise.
@
text
@d53 1
a53 1
   03 +\.tdata \.tbss \.dynamic \.got *
@


1.9
log
@Adjust for dynamic sym changes.
@
text
@d53 1
a53 1
   03 +\.tdata \.dynamic \.got *
@


1.8
log
@bfd/

2005-03-16  H.J. Lu  <hongjiu.lu@@intel.com>

	* elflink.c (elf_mark_used_section): New.
	(bfd_elf_gc_sections): Call elf_gc_mark_section for
	non-relocatable link if we don't do GC.

include/

2005-03-16  H.J. Lu  <hongjiu.lu@@intel.com>

	* bfdlink.h (bfd_link_info): Add gc_sections.

ld/

2005-03-16  H.J. Lu  <hongjiu.lu@@intel.com>

	* emultempl/elf32.em (gld${EMULATION_NAME}_finish): Remove
	unused empty output sections for non-relocatable link.

	* ld.h (args_type): Remove gc_sections.

	* ldlang.c (lang_mark_used_section): New.
	(lang_gc_sections): Use link_info.gc_sections instead of
	command_line.gc_sections.
	* ldmain.c (main): Likewise.
	* lexsup.c (parse_args): Likewise.
	* ldlang.c (lang_process): Call lang_mark_used_section.

	* ldmain.c (main): Initialize link_info.gc_sections to FALSE.

ld/testsuite/

2005-03-16  H.J. Lu  <hongjiu.lu@@intel.com>

	* ld-alpha/tlsbin.rd: Updated for empty section removal.
	* ld-alpha/tlsbinr.rd: Likewise.
	* ld-alpha/tlspic.rd: Likewise.
	* ld-arm/mixed-lib.sym: Likewise.
	* ld-i386/tlsbin.rd: Likewise.
	* ld-i386/tlsnopic.rd: Likewise.
	* ld-i386/tlspic.rd: Likewise.
	* ld-ia64/tlsbin.rd: Likewise.
	* ld-ia64/tlspic.rd: Likewise.
	* ld-powerpc/apuinfo.rd: Likewise.
	* ld-powerpc/powerpc.exp: Likewise.
	* ld-powerpc/tlsexe32.r: Likewise.
	* ld-s390/tlsbin.rd: Likewise.
	* ld-s390/tlsbin_64.rd: Likewise.
	* ld-s390/tlspic.rd: Likewise.
	* ld-s390/tlspic_64.rd: Likewise.
	* ld-sh/tlsbin-2.d: Likewise.
	* ld-sh/tlspic-2.d: Likewise.
	* ld-sparc/tlssunbin32.rd: Likewise.
	* ld-sparc/tlssunnopic32.rd: Likewise.
	* ld-sparc/tlssunpic32.rd: Likewise.
	* ld-x86-64/tlsbin.rd: Likewise.
	* ld-x86-64/tlspic.rd: Likewise.
@
text
@d13 10
a22 10
  \[ 1\] \.interp +.*
  \[ 2\] \.hash +.*
  \[ 3\] \.dynsym +.*
  \[ 4\] \.dynstr +.*
  \[ 5\] \.rela\.dyn +.*
  \[ 6\] \.rela\.plt +.*
  \[ 7\] \.plt +.*
  \[ 8\] \.text +PROGBITS +0+401000 .*
  \[ 9\] \.tdata +PROGBITS +0+413000 [0-9a-f]+ 0+018 00 WAT  0   0  4
  \[10\] \.tbss +NOBITS +0+413018 [0-9a-f]+ 0+010 00 WAT  0   0  1
d24 1
a24 1
  \[[0-9a-f]+\] \.got +PROGBITS +0+414000 .*
d26 3
a28 3
  \[[0-9a-f]+\] \.shstrtab +.*
  \[[0-9a-f]+\] \.symtab +.*
  \[[0-9a-f]+\] \.strtab +.*
d59 4
a62 4
0+414010  00000197 R_SH_TLS_TPOFF32 +0+ +sG3 \+ 0
0+414014  00000397 R_SH_TLS_TPOFF32 +0+ +sG2 \+ 0
0+414018  00000497 R_SH_TLS_TPOFF32 +0+ +sG4 \+ 0
0+41401c  0000[0-9a-f]+97 R_SH_TLS_TPOFF32 +0+ +sG1 \+ 0
d66 1
a66 1
0+41400c  000005a4 R_SH_JMP_SLOT +[0-9a-f]+ +__tls_get_addr \+ [0-9a-f]+
d70 5
a74 6
 +0: 0+ +0 NOTYPE +LOCAL +DEFAULT  UND *
 +1: 0+ +0 TLS +GLOBAL DEFAULT  UND sG3
 +2: [0-9a-f]+ +0 OBJECT  GLOBAL DEFAULT  ABS _DYNAMIC
 +3: 0+ +0 TLS +GLOBAL DEFAULT  UND sG2
 +4: 0+ +0 TLS +GLOBAL DEFAULT  UND sG4
 +5: [0-9a-f]+ +0 FUNC +GLOBAL DEFAULT  UND __tls_get_addr
d76 1
a76 1
 +[0-9]+: 0+ +0 TLS +GLOBAL DEFAULT  UND sG1
@


1.7
log
@binutils/
	* readelf.c (process_program_headers): Don't include .tbss in non-TLS
	segments.

ld/testsuite/
	* ld-i386/tlsbin.rd: Update for changed segment map.
	* ld-i386/tlsnopic.rd: Likewise.
	* ld-i386/tlspic.rd: Likewise.
	* ld-powerpc/tlsexe.r: Likewise.
	* ld-powerpc/tlsexe32.r: Likewise.
	* ld-powerpc/tlsexetoc.r: Likewise.
	* ld-powerpc/tlsso.r: Likewise.
	* ld-powerpc/tlsso32.r: Likewise.
	* ld-powerpc/tlstocso.r: Likewise.
	* ld-s390/tlsbin.rd: Likewise.
	* ld-s390/tlsbin_64.rd: Likewise.
	* ld-s390/tlspic.rd: Likewise.
	* ld-s390/tlspic_64.rd: Likewise.
	* ld-sh/tlsbin-2.d: Likewise.
	* ld-sh/tlspic-2.d: Likewise.
	* ld-x86-64/tlsbin.rd: Likewise.
	* ld-x86-64/tlspic.rd: Likewise.
@
text
@a24 2
  \[[0-9a-f]+\] \.sbss +.*
  \[[0-9a-f]+\] \.bss +.*
@


1.6
log
@	* emulparams/shlelf32_linux.sh (COMMONPAGESIZE): Set to 4KB.

	* ld-elf/frame.exp: Don't run on sh*-*-elf*.
	* ld-sh/shared-1.d: Adjust for section reordering changes.
	* ld-sh/shared-2.d: Likewise.
	* ld-sh/tlsbin-2.d: Likewise.
	* ld-sh/tlspic-2.d: Likewise.
	* ld-sh/sh64/abi32.xd: Likewise.
	* ld-sh/sh64/abi64.xd: Likewise.
	* ld-sh/sh64/cmpct1.xd: Likewise.
	* ld-sh/sh64/crange1.rd: Likewise.
	* ld-sh/sh64/crange2.rd: Likewise.
	* ld-sh/sh64/crange3-cmpct.rd: Likewise.
	* ld-sh/sh64/crange3-media.rd: Likewise.
	* ld-sh/sh64/crange3.rd: Likewise.
	* ld-sh/sh64/gotplt.d: Likewise.
	* ld-sh/sh64/init-cmpct.d: Likewise.
	* ld-sh/sh64/init-media.d: Likewise.
	* ld-sh/sh64/init64.d: Likewise.
	* ld-sh/sh64/mix1.xd: Likewise.
	* ld-sh/sh64/mix2.xd: Likewise.
	* ld-sh/sh64/shdl32.xd: Likewise.
	* ld-sh/sh64/shdl64.xd: Likewise.
@
text
@d55 2
a56 2
   03 +\.tdata \.tbss \.dynamic \.got *
   04 +\.tbss \.dynamic *
@


1.5
log
@	* ld-sh/tlsbin-2.d: Adjust for section reordering changes
	and removal of unneeded STT_SECTION symbols from .dynsym.
	* ld-sh/tlsbin-3.d: Likewise.
	* ld-sh/tlspic-2.d: Likewise.
@
text
@d23 1
a23 2
  \[11\] \.dynamic +DYNAMIC +0+413018 .*
  \[12\] \.data +.*
a81 46
Symbol table '\.symtab' contains [0-9]+ entries:
 +Num: +Value +Size Type +Bind +Vis +Ndx Name
 +0: 0+ +0 NOTYPE  LOCAL  DEFAULT  UND *
 +1: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +1 *
 +2: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +2 *
 +3: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +3 *
 +4: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +4 *
 +5: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +5 *
 +6: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +6 *
 +7: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +7 *
 +8: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +8 *
 +9: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +9 *
 +10: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +10 *
 +11: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +11 *
 +12: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +12 *
 +13: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +13 *
 +14: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +14 *
 +15: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +15 *
 +16: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +16 *
 +17: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +17 *
 +18: [0-9a-f]+ +0 SECTION LOCAL  DEFAULT +18 *
 +[0-9]+: 00000008 +0 TLS +LOCAL  DEFAULT +9 sl1
 +[0-9]+: 0000000c +0 TLS +LOCAL  DEFAULT +9 sl2
 +[0-9]+: 00000020 +0 TLS +LOCAL  DEFAULT +10 bl1
 +[0-9]+: 00000024 +0 TLS +LOCAL  DEFAULT +10 bl2
 +[0-9]+: 0+ +0 TLS +GLOBAL DEFAULT  UND sG3
 +[0-9]+: [0-9a-f]+ +0 OBJECT  GLOBAL DEFAULT  ABS _DYNAMIC
 +[0-9]+: 0+ +0 TLS +GLOBAL DEFAULT  UND sG2
 +[0-9]+: 0+ +0 TLS +GLOBAL DEFAULT  UND sG4
 +[0-9]+: [0-9a-f]+ +0 FUNC +GLOBAL DEFAULT  UND __tls_get_addr
 +[0-9]+: 0+ +0 TLS +GLOBAL DEFAULT +9 sg1
 +[0-9]+: 0+402000 +0 FUNC +GLOBAL DEFAULT +8 _start
#...
 +[0-9]+: 0+401000 +0 FUNC +GLOBAL DEFAULT +8 fn2
#...
 +[0-9]+: 00000004 +0 TLS +GLOBAL DEFAULT +9 sg2
 +[0-9]+: 0+ +0 TLS +GLOBAL DEFAULT  UND sG1
 +[0-9]+: 00000010 +0 TLS +GLOBAL HIDDEN +9 sh1
 +[0-9]+: [0-9a-f]+ +0 NOTYPE  GLOBAL DEFAULT  ABS _edata
 +[0-9]+: [0-9a-f]+ +0 OBJECT  GLOBAL DEFAULT  ABS _GLOBAL_OFFSET_TABLE_
 +[0-9]+: [0-9a-f]+ +0 NOTYPE  GLOBAL DEFAULT  ABS _end
 +[0-9]+: 00000014 +0 TLS +GLOBAL HIDDEN +9 sh2
 +[0-9]+: 0000001c +0 TLS +GLOBAL DEFAULT +10 bg2
 +[0-9]+: 00000018 +0 TLS +GLOBAL DEFAULT +10 bg1
#...
 +[0-9]+: .*
@


1.4
log
@Update for changed section alignment.
@
text
@d21 5
a25 6
  \[ 9\] \.data +.*
  \[10\] \.tdata +PROGBITS +0+413000 [0-9a-f]+ 0+018 00 WAT  0   0  4
  \[11\] \.tbss +NOBITS +0+413018 [0-9a-f]+ 0+010 00 WAT  0   0  1
  \[12\] \.dynamic +DYNAMIC +0+413018 .*
#...
  \[[0-9a-f]+\] \.got +PROGBITS +0+4130b8 .*
d62 4
a65 4
0+4130c8  00000197 R_SH_TLS_TPOFF32 +0+ +sG3 \+ 0
0+4130cc  00000397 R_SH_TLS_TPOFF32 +0+ +sG2 \+ 0
0+4130d0  00000497 R_SH_TLS_TPOFF32 +0+ +sG4 \+ 0
0+4130d4  0000[0-9a-f]+97 R_SH_TLS_TPOFF32 +0+ +sG1 \+ 0
d69 1
a69 1
0+4130c4  000005a4 R_SH_JMP_SLOT +[0-9a-f]+ +__tls_get_addr \+ [0-9a-f]+
d104 4
a107 5
#...
 +[0-9]+: 00000008 +0 TLS +LOCAL  DEFAULT +10 sl1
 +[0-9]+: 0000000c +0 TLS +LOCAL  DEFAULT +10 sl2
 +[0-9]+: 00000020 +0 TLS +LOCAL  DEFAULT +11 bl1
 +[0-9]+: 00000024 +0 TLS +LOCAL  DEFAULT +11 bl2
d113 1
a113 1
 +[0-9]+: 0+ +0 TLS +GLOBAL DEFAULT +10 sg1
d118 1
a118 1
 +[0-9]+: 00000004 +0 TLS +GLOBAL DEFAULT +10 sg2
d120 2
a121 2
 +[0-9]+: 00000010 +0 TLS +GLOBAL HIDDEN +10 sh1
 +[0-9]+: 004130d8 +0 NOTYPE  GLOBAL DEFAULT  ABS _edata
d124 3
a126 3
 +[0-9]+: 00000014 +0 TLS +GLOBAL HIDDEN +10 sh2
 +[0-9]+: 0000001c +0 TLS +GLOBAL DEFAULT +11 bg2
 +[0-9]+: 00000018 +0 TLS +GLOBAL DEFAULT +11 bg1
@


1.3
log
@	* elf32-sh.c (tpoff): New.
	(struct elf_sh_dyn_relocs): Remove tls_tpoff32.
	(WILL_CALL_FINISH_DYNAMIC_SYMBOL): Pass SHARED instead of INFO.
        (allocate_dynrelocs): Don't make unnecessary dynamic TLS
	relocations.  Adjust WILL_CALL_FINISH_DYNAMIC_SYMBOL uses.
        (sh_elf_relocate_section): Likewise. Remove unnecessary tests.
	(dtpoff_base): Fix wrong indentation.
	(sh_elf_check_relocs): Don't set DF_STATIC_TLS flag with non-TLS
	relocations.  Don't set tls_tpoff32 flag.  Don't make unnecessary
	R_SH_TLS_TPOFF32 relocations.

	* ld-sh/tlsbin-1.d, ld-sh/tlsbin-2.d, ld-sh/tlsbin-3.d,
	ld-sh/tlstpoff-1.d, ld-sh/tlstpoff-2.d: Update for removing
	unnecessary TLS relocs.
@
text
@d22 1
a22 1
  \[10\] \.tdata +PROGBITS +0+413000 [0-9a-f]+ 0+018 00 WAT  0   0  1
d50 1
a50 1
  TLS +0x[0-9a-f]+ 0x[0-9a-f]+ 0x[0-9a-f]+ 0x0+18 0x0+28 R +0x1
@


1.2
log
@	* ld-sh/rd-sh.exp: Add -isa=SHcompact to ASFLAGS for SH-5.
	* ld-sh/tlsbin-1.d: Handle GOT_BIAS appropriately for SH-5.
	* ld-sh/tlspic-1.d: Likewise.
	* ld-sh/tlspic-2.d: Likewise.
	* ld-sh/tlsbin-2.d: Likewise. Make it robust for the symbols
	defined by the linker scripts.
@
text
@d26 1
a26 1
  \[[0-9a-f]+\] \.got +PROGBITS +0+4130c0 .*
d61 1
a61 1
Relocation section '\.rela\.dyn' at offset 0x[0-9a-f]+ contains 19 entries:
d63 4
a66 19
0+401068  00000097 R_SH_TLS_TPOFF32 +0+00
0+401088  00000097 R_SH_TLS_TPOFF32 +0+08
0+4010a8  00000097 R_SH_TLS_TPOFF32 +0+10
0+401154  00000097 R_SH_TLS_TPOFF32 +0+00
0+40116c  00000097 R_SH_TLS_TPOFF32 +0+10
0+401188  00000097 R_SH_TLS_TPOFF32 +0+08
0+40118c  00000097 R_SH_TLS_TPOFF32 +0+0c
0+401190  00000097 R_SH_TLS_TPOFF32 +0+10
0+401194  00000097 R_SH_TLS_TPOFF32 +0+14
0+402038  00000097 R_SH_TLS_TPOFF32 +0+18
0+402050  00000097 R_SH_TLS_TPOFF32 +0+24
0+402068  00000097 R_SH_TLS_TPOFF32 +0+14
0+4020a8  00000097 R_SH_TLS_TPOFF32 +0+00
0+4020ac  00000097 R_SH_TLS_TPOFF32 +0+20
0+4020b0  00000097 R_SH_TLS_TPOFF32 +0+10
0+4130d0  00000197 R_SH_TLS_TPOFF32 +0+ +sG3 \+ 0
0+4130d4  00000397 R_SH_TLS_TPOFF32 +0+ +sG2 \+ 0
0+4130d8  00000497 R_SH_TLS_TPOFF32 +0+ +sG4 \+ 0
0+4130dc  0000[0-9a-f]+97 R_SH_TLS_TPOFF32 +0+ +sG1 \+ 0
d70 1
a70 1
0+4130cc  000005a4 R_SH_JMP_SLOT +[0-9a-f]+ +__tls_get_addr \+ [0-9a-f]+
d123 1
a123 1
 +[0-9]+: 004130e0 +0 NOTYPE  GLOBAL DEFAULT  ABS _edata
@


1.1
log
@	* ld-sh/rd-sh.exp: If the test matches *-dso.d, copy the output
	of linker to the file tmpdir/*-dso.so.
	* ld-sh/tlsbin.s, ld-sh/tlsbinpic.s, ld-sh/tlslib.s: New.
	* ld-sh/tlsbin-0-dso.d: New.
	* ld-sh/tlsbin-1.d: New.
	* ld-sh/tlsbin-2.d: New.
	* ld-sh/tlsbin-3.d: New.
	* ld-sh/tlsbin-4.d: New.
	* ld-sh/tlspic1.s, ld-sh/tlspic2.s: New.
	* ld-sh/tlspic-1.d: New.
	* ld-sh/tlspic-2.d: New.
	* ld-sh/tlspic-3.d: New.
	* ld-sh/tlspic-4.d: New.
@
text
@d85 1
a85 1
0+4130cc  000005a4 R_SH_JMP_SLOT +[0-9a-f]+ +__tls_get_addr \+ 0
d144 2
a145 1
 +[0-9]+: [0-9a-f]+ +0 NOTYPE  GLOBAL DEFAULT +9 __data_start
@

