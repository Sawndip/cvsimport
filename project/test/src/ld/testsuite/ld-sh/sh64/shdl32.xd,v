head	1.12;
access;
symbols
	binutils-2_24-branch:1.12.0.4
	binutils-2_24-branchpoint:1.12
	binutils-2_21_1:1.10
	binutils-2_23_2:1.12
	binutils-2_23_1:1.12
	binutils-2_23:1.12
	binutils-2_23-branch:1.12.0.2
	binutils-2_23-branchpoint:1.12
	binutils-2_22_branch:1.10.0.18
	binutils-2_22:1.10
	binutils-2_22-branch:1.10.0.16
	binutils-2_22-branchpoint:1.10
	binutils-2_21:1.10
	binutils-2_21-branch:1.10.0.14
	binutils-2_21-branchpoint:1.10
	binutils-2_20_1:1.10
	binutils-2_20:1.10
	binutils-arc-20081103-branch:1.10.0.12
	binutils-arc-20081103-branchpoint:1.10
	binutils-2_20-branch:1.10.0.10
	binutils-2_20-branchpoint:1.10
	dje-cgen-play1-branch:1.10.0.8
	dje-cgen-play1-branchpoint:1.10
	arc-20081103-branch:1.10.0.6
	arc-20081103-branchpoint:1.10
	binutils-2_19_1:1.10
	binutils-2_19:1.10
	binutils-2_19-branch:1.10.0.4
	binutils-2_19-branchpoint:1.10
	binutils-2_18:1.10
	binutils-2_18-branch:1.10.0.2
	binutils-2_18-branchpoint:1.10
	binutils-csl-coldfire-4_1-32:1.8
	binutils-csl-sourcerygxx-4_1-32:1.8
	binutils-csl-innovasic-fido-3_4_4-33:1.8
	binutils-csl-sourcerygxx-3_4_4-32:1.7
	binutils-csl-coldfire-4_1-30:1.8
	binutils-csl-sourcerygxx-4_1-30:1.8
	binutils-csl-coldfire-4_1-28:1.8
	binutils-csl-sourcerygxx-4_1-29:1.8
	binutils-csl-sourcerygxx-4_1-28:1.8
	binutils-csl-arm-2006q3-27:1.8
	binutils-csl-sourcerygxx-4_1-27:1.8
	binutils-csl-arm-2006q3-26:1.8
	binutils-csl-sourcerygxx-4_1-26:1.8
	binutils-csl-sourcerygxx-4_1-25:1.8
	binutils-csl-sourcerygxx-4_1-24:1.8
	binutils-csl-sourcerygxx-4_1-23:1.8
	binutils-csl-sourcerygxx-4_1-21:1.8
	binutils-csl-arm-2006q3-21:1.8
	binutils-csl-sourcerygxx-4_1-22:1.8
	binutils-csl-palmsource-arm-prelinker-1_0-1:1.8
	binutils-csl-sourcerygxx-4_1-20:1.8
	binutils-csl-arm-2006q3-19:1.8
	binutils-csl-sourcerygxx-4_1-19:1.8
	binutils-csl-sourcerygxx-4_1-18:1.8
	binutils-csl-renesas-4_1-9:1.8
	binutils-csl-sourcerygxx-3_4_4-25:1.7
	binutils-csl-renesas-4_1-8:1.8
	binutils-csl-renesas-4_1-7:1.8
	binutils-csl-renesas-4_1-6:1.8
	binutils-csl-sourcerygxx-4_1-17:1.8
	binutils-csl-sourcerygxx-4_1-14:1.8
	binutils-csl-sourcerygxx-4_1-15:1.8
	binutils-csl-sourcerygxx-4_1-13:1.8
	binutils-2_17:1.8
	binutils-csl-sourcerygxx-4_1-12:1.8
	binutils-csl-sourcerygxx-3_4_4-21:1.8
	binutils-csl-wrs-linux-3_4_4-24:1.7
	binutils-csl-wrs-linux-3_4_4-23:1.7
	binutils-csl-sourcerygxx-4_1-9:1.8
	binutils-csl-sourcerygxx-4_1-8:1.8
	binutils-csl-sourcerygxx-4_1-7:1.8
	binutils-csl-arm-2006q1-6:1.8
	binutils-csl-sourcerygxx-4_1-6:1.8
	binutils-csl-wrs-linux-3_4_4-22:1.7
	binutils-csl-coldfire-4_1-11:1.8
	binutils-csl-sourcerygxx-3_4_4-19:1.8
	binutils-csl-coldfire-4_1-10:1.8
	binutils-csl-sourcerygxx-4_1-5:1.8
	binutils-csl-sourcerygxx-4_1-4:1.8
	binutils-csl-wrs-linux-3_4_4-21:1.7
	binutils-csl-morpho-4_1-4:1.8
	binutils-csl-sourcerygxx-3_4_4-17:1.8
	binutils-csl-wrs-linux-3_4_4-20:1.7
	binutils-2_17-branch:1.8.0.4
	binutils-2_17-branchpoint:1.8
	binutils-csl-2_17-branch:1.8.0.2
	binutils-csl-2_17-branchpoint:1.8
	binutils-csl-gxxpro-3_4-branch:1.7.0.6
	binutils-csl-gxxpro-3_4-branchpoint:1.7
	binutils-2_16_1:1.7
	binutils-csl-arm-2005q1b:1.7
	binutils-2_16:1.7
	binutils-csl-arm-2005q1a:1.7
	binutils-csl-arm-2005q1-branch:1.7.0.4
	binutils-csl-arm-2005q1-branchpoint:1.7
	binutils-2_16-branch:1.7.0.2
	binutils-2_16-branchpoint:1.7
	csl-arm-2004-q3d:1.6
	csl-arm-2004-q3:1.6
	binutils-2_15:1.4
	binutils-2_15-branchpoint:1.4
	csl-arm-2004-q1a:1.4
	csl-arm-2004-q1:1.4
	binutils-2_15-branch:1.4.0.6
	cagney_bfdfile-20040213-branch:1.4.0.4
	cagney_bfdfile-20040213-branchpoint:1.4
	cagney_bigcore-20040122-branch:1.4.0.2
	cagney_bigcore-20040122-branchpoint:1.4
	csl-arm-2003-q4:1.4
	binutils-2_14:1.2
	binutils-2_14-branch:1.2.0.2
	binutils-2_14-branchpoint:1.2
	binutils-2_13_2_1:1.1.4.1
	binutils-2_13_2:1.1.4.1
	binutils-2_13_1:1.1.4.1
	binutils-2_13:1.1
	binutils-2_13-branchpoint:1.1
	binutils-2_13-branch:1.1.0.4
	binutils-2_12_1:1.1
	binutils-2_12:1.1
	binutils-2_12-branch:1.1.0.2
	binutils-2_12-branchpoint:1.1
	binutils_latest_snapshot:1.12;
locks; strict;
comment	@# @;


1.12
date	2012.06.15.15.13.39;	author amodra;	state Exp;
branches;
next	1.11;

1.11
date	2012.06.06.10.50.17;	author amodra;	state Exp;
branches;
next	1.10;

1.10
date	2006.10.30.00.48.03;	author kkojima;	state Exp;
branches;
next	1.9;

1.9
date	2006.10.22.01.19.06;	author kkojima;	state Exp;
branches;
next	1.8;

1.8
date	2005.08.15.15.39.48;	author amodra;	state Exp;
branches;
next	1.7;

1.7
date	2004.12.11.04.32.37;	author amodra;	state Exp;
branches;
next	1.6;

1.6
date	2004.09.22.06.45.39;	author amodra;	state Exp;
branches;
next	1.5;

1.5
date	2004.07.02.11.25.54;	author kkojima;	state Exp;
branches;
next	1.4;

1.4
date	2003.12.01.06.56.51;	author amodra;	state Exp;
branches;
next	1.3;

1.3
date	2003.10.13.05.09.21;	author kkojima;	state Exp;
branches;
next	1.2;

1.2
date	2002.08.12.09.01.18;	author hp;	state Exp;
branches;
next	1.1;

1.1
date	2002.02.08.06.49.58;	author aoliva;	state Exp;
branches
	1.1.4.1;
next	;

1.1.4.1
date	2002.09.23.22.15.29;	author drow;	state Exp;
branches;
next	;


desc
@@


1.12
log
@ld/
	* ldlang.h (lang_output_section_statement_type): Add after_end field.
	(lang_abs_symbol_at_beginning_of, lang_abs_symbol_at_end_of): Delete.
	(section_for_dot): Declare.
	* ldlang.c (lang_size_sections_1): Correct comment.
	(current_section): Move earlier.
	(current_assign, prefer_next_section): New static vars.
	(lang_do_assignments_1): Add found_end param.  Detect _end
	assignment to set found_end.  Set os->after_end.  Set above statics.
	(lang_do_assignments): Adjust lang_do_assignments_1 call.  Init
	vars.
	(section_for_dot): New function.
	(lang_set_startof): Don't make an absolute symbol.
	(lang_abs_symbol_at_beginning_of, lang_abs_symbol_at_end_of): Delete.
	* ldexp.c (new_rel_from_abs): Use section_for_dot.
	* emultempl/lnk960.em (symbol_at_beginning_of): New function.
	(symbol_at_end_of): Likewise.
	(lnk960_after_allocation): Use them.
	* scripttempl/elf.sc: Precede OTHER_GOT_SYMBOLS with . = .; and
	likewise before __bss_start.

ld/testsuite/
Update far too many tests.
@
text
@.*:     file format .*-sh64
.*
architecture: sh5, flags 0x0+112:
EXEC_P, HAS_SYMS, D_PAGED
start address 0x0+1001

Program Header:
    LOAD off    0x0+100 vaddr 0x0+1000 paddr 0x0+1000 align 2\*\*7
         filesz 0x0+348 memsz 0x0+348 flags r-x
    LOAD off    0x0+448 vaddr 0x0+13c8 paddr 0x0+13c8 align 2\*\*7
         filesz 0x0+194 memsz 0x0+194 flags rw-
    LOAD off    0x0+600 vaddr 0x0+80000 paddr 0x0+80000 align 2\*\*7
         filesz 0x00000004 memsz 0x00000004 flags rw-

Sections:
Idx Name          Size      VMA       LMA       File off  Algn
  0 \.text         0+204  0+1000  0+1000  0+100  2\*\*0
                  CONTENTS, ALLOC, LOAD, READONLY, CODE
  1 \.rodata       0+144  0+1204  0+1204  0+304  2\*\*2
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
  2 \.data         0+194  0+13c8  0+13c8  0+448  2\*\*2
                  CONTENTS, ALLOC, LOAD, DATA
  3 \.stack        0+4  0+80000  0+80000  0+600  2\*\*0
                  CONTENTS, ALLOC, LOAD, DATA
SYMBOL TABLE:
0+1000 l    d  \.text	0+ (|\.text)
0+1204 l    d  \.rodata	0+ (|\.rodata)
0+13c8 l    d  \.data	0+ (|\.data)
0+80000 l    d  \.stack	0+ (|\.stack)
0+ l    df \*ABS\*	0+ .*
0+1150 l       \.text	0+ 0x04 part2
0+ l    df \*ABS\*	0+ .*
0+13f8 g       \.data	0+ dfoo_otherboth2
0+1178 g       \.text	0+ 0x04 bar_otherwithout
0+11b4 g       \.text	0+ 0x04 bazwithout
0+1428 g       \.data	0+ dfoo_mixwithout
0+1554 g       \.data	0+ dbaz_mixwithout2
0+11bc g       \.text	0+ 0x04 baz_other
0+11cc g       \.text	0+ 0x04 baz_mix
0+11c0 g       \.text	0+ 0x04 baz_otherboth
0+13e8 g       \.data	0+ dfoowithout
0+14b4 g       \.data	0+ dbar
0+106c g       \.text	0+ 0x04 foo_mixwithout2
0+11a8 g       \.text	0+ 0x04 bazboth2
0+13fc g       \.data	0+ dfoo_otherwithout
0+11c4 g       \.text	0+ 0x04 baz_otherboth2
0+1174 g       \.text	0+ 0x04 bar_otherboth2
0+1194 g       \.text	0+ 0x04 baz
0+13c8 g       \.data	0+ dfoo
0+14e8 g       \.data	0+ dbar_mixwithout2
0+13dc g       \.data	0+ dfooboth2
0+1408 g       \.data	0+ dfoo_mix2
0+154c g       \.data	0+ dbaz_mixwithout
0+1044 g       \.text	0+ 0x04 foo_mix2
0+1018 g       \.text	0+ 0x04 fooboth2
0+14cc g       \.data	0+ dbar_otherboth2
0+117c g       \.text	0+ 0x04 bar_mix
0+14d0 g       \.data	0+ dbar_otherwithout
0+11dc g       \.text	0+ 0x04 baz_mixboth
0+14c8 g       \.data	0+ dbar_otherboth
0+150c g       \.data	0+ dbazwithout
0+152c g       \.data	0+ dbaz_mix2
0+1184 g       \.text	0+ 0x04 bar_mixboth
0+13f4 g       \.data	0+ dfoo_otherboth
0+14dc g       \.data	0+ dbar_mixboth
0+1024 g       \.text	0+ 0x04 foowithout
0+14e4 g       \.data	0+ dbar_mixwithout
0+11fc g       \.text	0+ 0x04 baz_mixwithout2
0+1030 g       \.text	0+ 0x04 foo_otherboth
0+1540 g       \.data	0+ dbaz_mixboth2
0+104c g       \.text	0+ 0x04 foo_mixboth
0+1534 g       \.data	0+ dbaz_mixboth
0+103c g       \.text	0+ 0x04 foo_mix
0+1518 g       \.data	0+ dbaz_otherboth
0+14e0 g       \.data	0+ dbar_mixboth2
0+14ec g       \.data	0+ dbaz
0+1524 g       \.data	0+ dbaz_mix
0+13c8 g       .*	0+ ___dtors
0+141c g       \.data	0+ dfoo_mixboth2
0+119c g       \.text	0+ 0x04 bazboth
0+13f0 g       \.data	0+ dfoo_other
0+11e8 g       \.text	0+ 0x04 baz_mixboth2
0+1514 g       \.data	0+ dbaz_other
0+1164 g       \.text	0+ 0x04 barboth2
0+1168 g       \.text	0+ 0x04 barwithout
0+14d8 g       \.data	0+ dbar_mix2
0+1560 g       \.data	0+ __bss_start
0+1410 g       \.data	0+ dfoo_mixboth
0+14c4 g       \.data	0+ dbar_other
0+1180 g       \.text	0+ 0x04 bar_mix2
0+14f4 g       \.data	0+ dbazboth
0+1038 g       \.text	0+ 0x04 foo_otherwithout
0+1190 g       \.text	0+ 0x04 bar_mixwithout2
0+13c8 g       .*	0+ ___ctors_end
0+1064 g       \.text	0+ 0x04 foo_mixwithout
0+116c g       \.text	0+ 0x04 bar_other
0+13d0 g       \.data	0+ dfooboth
0+1034 g       \.text	0+ 0x04 foo_otherboth2
0+1400 g       \.data	0+ dfoo_mix
0+13c8 g       .*	0+ ___ctors
0+14d4 g       \.data	0+ dbar_mix
0+100c g       \.text	0+ 0x04 fooboth
0+1170 g       \.text	0+ 0x04 bar_otherboth
0+14c0 g       \.data	0+ dbarwithout
0+1004 g       \.text	0+ 0x04 foo
0+102c g       \.text	0+ 0x04 foo_other
0+1560 g       \.data	0+ _edata
0+1560 g       \.data	0+ _end
0+1430 g       \.data	0+ dfoo_mixwithout2
0+1058 g       \.text	0+ 0x04 foo_mixboth2
0+11d4 g       \.text	0+ 0x04 baz_mix2
0+11c8 g       \.text	0+ 0x04 baz_otherwithout
0+1000 g       \.text	0+ 0x04 start
0+14bc g       \.data	0+ dbarboth2
0+118c g       \.text	0+ 0x04 bar_mixwithout
0+115c g       \.text	0+ 0x04 bar
0+80000 g       \.stack	0+ _stack
0+1520 g       \.data	0+ dbaz_otherwithout
0+11f4 g       \.text	0+ 0x04 baz_mixwithout
0+1160 g       \.text	0+ 0x04 barboth
0+14b8 g       \.data	0+ dbarboth
0+1188 g       \.text	0+ 0x04 bar_mixboth2
0+13c8 g       .*	0+ ___dtors_end
0+151c g       \.data	0+ dbaz_otherboth2
0+1500 g       \.data	0+ dbazboth2
@


1.11
log
@bfd/
	* elflink.c (elf_link_input_bfd): Provide a file symbol for
	each input file with local syms, if the input lacks such.
	(bfd_elf_final_link): Add a file symbol to mark end of locals
	for which we can associate with input files.
	(struct elf_final_link_info): Add filesym_count field.
	(struct elf_outext_info): Add need_second_pass and second_pass.
	(elf_link_output_extsym): Detect symbols defined in the output
	file, emit them on second pass over locals.
ld/testsuite/
Update to suit added STT_FILE symbols.
@
text
@d87 1
a87 1
0+1560 g       \*ABS\*	0+ __bss_start
d107 2
a108 2
0+1560 g       \*ABS\*	0+ _edata
0+1560 g       \*ABS\*	0+ _end
@


1.10
log
@	* ld-sh/sh64/abi32.xd, ld-sh/sh64/abi64.xd, ld-sh/sh64/cmpct1.xd,
	* ld-sh/sh64/crange1.rd, ld-sh/sh64/crange2.rd,
	* ld-sh/sh64/crange3-cmpct.rd, ld-sh/sh64/crange3-media.rd,
	* ld-sh/sh64/crange3.rd, ld-sh/sh64/mix1.xd, ld-sh/sh64/mix2.xd,
	* ld-sh/sh64/shdl32.xd, ld-sh/sh64/shdl64.xd: Update for removal
	of empty sections.
@
text
@d30 1
d32 1
@


1.9
log
@	* gas/sh/sh64/syntax-1.d: Update.

	* ld-sh/sh64/abi32.xd, ld-sh/sh64/abi64.xd, ld-sh/sh64/cmpct1.xd,
	* ld-sh/sh64/crange1.rd, ld-sh/sh64/crange2.rd,
	* ld-sh/sh64/crange3-cmpct.rd, ld-sh/sh64/crange3-media.rd,
	* ld-sh/sh64/crange3.rd, ld-sh/sh64/crangerel1.rd,
	* ld-sh/sh64/crangerel2.rd, ld-sh/sh64/mix1.xd,
	* ld-sh/sh64/mix2.xd, ld-sh/sh64/rel32.xd, ld-sh/sh64/rel64.xd,
	* ld-sh/sh64/reldl32.rd, ld-sh/sh64/reldl64.rd,
	* ld-sh/sh64/shdl32.xd, ld-sh/sh64/shdl64.xd: Update.
@
text
@d76 1
a76 1
0+13c8 g       \.rodata	0+ ___dtors
d92 1
a92 1
0+13c8 g       \.rodata	0+ ___ctors_end
d98 1
a98 1
0+13c8 g       \.rodata	0+ ___ctors
d121 1
a121 1
0+13c8 g       \.rodata	0+ ___dtors_end
@


1.8
log
@Adjust for dynamic sym changes.
@
text
@a29 3
0+ l    d  \*ABS\*	0+ (|\.shstrtab)
0+ l    d  \*ABS\*	0+ (|\.symtab)
0+ l    d  \*ABS\*	0+ (|\.strtab)
d76 1
a76 1
0+13c8 g       \*ABS\*	0+ ___dtors
d92 1
a92 1
0+13c8 g       \*ABS\*	0+ ___ctors_end
d98 1
a98 1
0+13c8 g       \*ABS\*	0+ ___ctors
d121 1
a121 1
0+13c8 g       \*ABS\*	0+ ___dtors_end
@


1.7
log
@bfd/
	* elfcode.h (elf_slurp_symbol_table): Use bfd_elf_sym_name so that
	canonical sections syms have a name.

gas/testsuite/
	Update for changed section syms.

ld/testsuite/
	Update for changed section syms.
@
text
@d11 1
a11 1
         filesz 0x0+194 memsz 0x0+198 flags rw-
d21 1
a21 5
  2 \.ctors        0+  0+13c8  0+13c8  0+604  2\*\*0
                  CONTENTS
  3 \.dtors        0+  0+13c8  0+13c8  0+604  2\*\*0
                  CONTENTS
  4 \.data         0+194  0+13c8  0+13c8  0+448  2\*\*2
d23 1
a23 5
  5 \.sbss         0+  0+1560  0+1560  0+604  2\*\*0
                  CONTENTS
  6 \.bss          0+  0+1560  0+1560  0+5dc  2\*\*0
                  ALLOC
  7 \.stack        0+4  0+80000  0+80000  0+600  2\*\*0
a27 2
0+13c8 l    d  \.ctors	0+ (|\.ctors)
0+13c8 l    d  \.dtors	0+ (|\.dtors)
a28 2
0+1560 l    d  \.sbss	0+ (|\.sbss)
0+1560 l    d  \.bss	0+ (|\.bss)
d79 1
a79 1
0+13c8 g       \.dtors	0+ ___dtors
d95 1
a95 1
0+13c8 g       \.ctors	0+ ___ctors_end
d101 1
a101 1
0+13c8 g       \.ctors	0+ ___ctors
d124 1
a124 1
0+13c8 g       \.dtors	0+ ___dtors_end
@


1.6
log
@bfd/
	* elf.c (IS_LOADED): Define.
	(assign_file_positions_for_segments): Don't round up file offset of
	PT_LOAD segments containing no SEC_LOAD sections, instead round down.
	Delete code handling link script adjustment of lma.  Do the adjust
	in later code handling similar ajustments.  Remove dead code error
	check.  Warn if section lma would require a negative offset
	adjustment.  Tweak lma adjustment to use p_filesz rather than p_memsz.
	Use p_vaddr + p_memsz inside section loop in place of voff.  Don't
	update voff in section loop.  Change voff in segment loop to be an
	adjustment on top of "off".  Set sec->filepos and update "off" later.
	Test for loadable sections consistently using IS_LOADED.  Similarly,
	test for alloc-only sections other than .tbss consistently.
	Don't bother checking SEC_ALLOC in PT_LOAD segments.  Remove FIXME.
	Tidy PT_NOTE handling.  Use %B and %A in error messages.
	(assign_file_positions_except_relocs): Use %B in error message.

ld/testsuite/
	* ld-scripts/overlay-size.d: Don't check .mbss lma.
	* ld-sh/sh64/mix1.xd: Update for changed .bss file offset.
	* ld-sh/sh64/shdl32.xd: Likewise.
	* ld-sh/sh64/shdl64.xd: Likewise.
@
text
@d34 11
a44 11
0+1000 l    d  \.text	0+ 
0+1204 l    d  \.rodata	0+ 
0+13c8 l    d  \.ctors	0+ 
0+13c8 l    d  \.dtors	0+ 
0+13c8 l    d  \.data	0+ 
0+1560 l    d  \.sbss	0+ 
0+1560 l    d  \.bss	0+ 
0+80000 l    d  \.stack	0+ 
0+ l    d  \*ABS\*	0+ 
0+ l    d  \*ABS\*	0+ 
0+ l    d  \*ABS\*	0+ 
@


1.5
log
@	* emulparams/shlelf32_linux.sh (COMMONPAGESIZE): Set to 4KB.

	* ld-elf/frame.exp: Don't run on sh*-*-elf*.
	* ld-sh/shared-1.d: Adjust for section reordering changes.
	* ld-sh/shared-2.d: Likewise.
	* ld-sh/tlsbin-2.d: Likewise.
	* ld-sh/tlspic-2.d: Likewise.
	* ld-sh/sh64/abi32.xd: Likewise.
	* ld-sh/sh64/abi64.xd: Likewise.
	* ld-sh/sh64/cmpct1.xd: Likewise.
	* ld-sh/sh64/crange1.rd: Likewise.
	* ld-sh/sh64/crange2.rd: Likewise.
	* ld-sh/sh64/crange3-cmpct.rd: Likewise.
	* ld-sh/sh64/crange3-media.rd: Likewise.
	* ld-sh/sh64/crange3.rd: Likewise.
	* ld-sh/sh64/gotplt.d: Likewise.
	* ld-sh/sh64/init-cmpct.d: Likewise.
	* ld-sh/sh64/init-media.d: Likewise.
	* ld-sh/sh64/init64.d: Likewise.
	* ld-sh/sh64/mix1.xd: Likewise.
	* ld-sh/sh64/mix2.xd: Likewise.
	* ld-sh/sh64/shdl32.xd: Likewise.
	* ld-sh/sh64/shdl64.xd: Likewise.
@
text
@d29 1
a29 1
  6 \.bss          0+  0+1560  0+1560  0+5e0  2\*\*0
@


1.4
log
@Update for changed section alignment.
@
text
@d21 1
a21 3
  2 \.data         0+194  0+13c8  0+13c8  0+448  2\*\*2
                  CONTENTS, ALLOC, LOAD, DATA
  3 \.ctors        0+  0+155c  0+155c  0+604  2\*\*0
d23 1
a23 1
  4 \.dtors        0+  0+155c  0+155c  0+604  2\*\*0
d25 2
d36 2
a38 2
0+155c l    d  \.ctors	0+ 
0+155c l    d  \.dtors	0+ 
d91 1
a91 1
0+155c g       \.dtors	0+ ___dtors
d107 1
a107 1
0+155c g       \.ctors	0+ ___ctors_end
d113 1
a113 1
0+155c g       \.ctors	0+ ___ctors
d136 1
a136 1
0+155c g       \.dtors	0+ ___dtors_end
@


1.3
log
@[ld]
	* emulparams/shelf32_nbsd.sh (OTHER_SECTIONS): Redefine.

[ld/testsuite]
	* ld-sh/rd-sh.exp (LDFLAGS): Define appropriately for each
	sh64/sh5 targets.
	* ld-sh/sh.exp: Don't do relaxing test for sh64*-*-* and
	sh5*-*-* targets.
	* ld-sh/sh64/relax.exp (emul32): Set to shelf32_nbsd for netbsd.
	* ld-sh/sh64/relfail.exp: Set parameters for netbsd.
	* ld-sh/sh64/sh64.exp: Skip this for netbsd.  Trim the section
	numbers for crangerel1 and crengerel2 tests.
	* ld-sh/sh64/abi32.sd: Update.
	* ld-sh/sh64/abi32.xd: Likewise.
	* ld-sh/sh64/abi64.sd: Likewise.
	* ld-sh/sh64/abi64.xd: Likewise.
	* ld-sh/sh64/abixx-noexp.sd: Likewise.
	* ld-sh/sh64/cmpct1.sd: Likewise.
	* ld-sh/sh64/cmpct1.xd: Likewise.
	* ld-sh/sh64/crange1.rd: Likewise.
	* ld-sh/sh64/crange2.rd: Likewise.
	* ld-sh/sh64/crange3-cmpct.rd: Likewise.
	* ld-sh/sh64/crange3-media.rd: Likewise.
	* ld-sh/sh64/crange3.rd: Likewise.
	* ld-sh/sh64/crangerel1.rd: Likewise.
	* ld-sh/sh64/crangerel2.rd: Likewise.
	* ld-sh/sh64/dlsection.sd: Likewise.
	* ld-sh/sh64/endian.sbd: Likewise.
	* ld-sh/sh64/endian.sld: Likewise.
	* ld-sh/sh64/gotplt.d: Likewise.
	* ld-sh/sh64/init-cmpct.d: Likewise.
	* ld-sh/sh64/init-media.d: Likewise.
	* ld-sh/sh64/init.s: Align functions.
	* ld-sh/sh64/init64.d: Update.
	* ld-sh/sh64/mix1-noexp.sd: Likewise.
	* ld-sh/sh64/mix1.sd: Likewise.
	* ld-sh/sh64/mix1.xd: Likewise.
	* ld-sh/sh64/mix2-noexp.sd: Likewise.
	* ld-sh/sh64/mix2.sd: Likewise.
	* ld-sh/sh64/mix2.xd:Likewise.
	* ld-sh/sh64/rel32.xd: Likewise.
	* ld-sh/sh64/rel64.xd: Likewise.
	* ld-sh/sh64/reldl32.rd: Likewise.
	* ld-sh/sh64/reldl64.rd: Likewise.
	* ld-sh/sh64/shdl32.xd: Update.
	* ld-sh/sh64/shdl64.sd: Likewise.
	* ld-sh/sh64/shdl64.xd: Likewise.
	* ld-sh/shared-1.d: Add -z nocombreloc to ld option.  Update.
	* ld-sh/sub2l-1.d: Make file format match with elf32-sh.*.
	* ld-sh/weak1.d: Likewise.
@
text
@d19 1
a19 1
  1 \.rodata       0+144  0+1204  0+1204  0+304  2\*\*0
d21 1
a21 1
  2 \.data         0+194  0+13c8  0+13c8  0+448  2\*\*0
@


1.2
log
@	* ld-sh/sh64/abi32.xd: Adjust whitespace in elf32 section
	listing.
	* ld-sh/sh64/cmpct1.xd, ld-sh/sh64/mix1.xd, ld-sh/sh64/mix2.xd,
	ld-sh/sh64/rel32.xd, ld-sh/sh64/shdl32.xd: Likewise.
@
text
@d8 1
a8 1
    LOAD off    0x0+80 vaddr 0x0+1000 paddr 0x0+1000 align 2\*\*7
d10 1
a10 1
    LOAD off    0x0+3c8 vaddr 0x0+13c8 paddr 0x0+13c8 align 2\*\*7
d12 2
d17 1
a17 1
  0 \.text         0+204  0+1000  0+1000  0+80  2\*\*0
d19 1
a19 1
  1 \.rodata       0+144  0+1204  0+1204  0+284  2\*\*0
d21 1
a21 1
  2 \.data         0+194  0+13c8  0+13c8  0+3c8  2\*\*0
d23 1
a23 1
  3 \.ctors        0+  0+155c  0+155c  0+560  2\*\*0
d25 1
a25 1
  4 \.dtors        0+  0+155c  0+155c  0+560  2\*\*0
d27 1
a27 1
  5 \.sbss         0+  0+1560  0+1560  0+560  2\*\*0
d29 1
a29 1
  6 \.bss          0+  0+1560  0+1560  0+560  2\*\*0
d31 2
a32 2
  7 \.stack        0+  0+80000  0+80000  0+560  2\*\*0
                  CONTENTS
@


1.1
log
@Contribute sh64-elf.
2002-02-02  Alexandre Oliva  <aoliva@@redhat.com>
* ld-sh/sh64/crange3-cmpct.rd: Adjust offsets.
* ld-sh/sh64/crange3-media.rd: Likewise.
* ld-sh/sh64/crange3.rd: Likewise.
* ld-sh/sh64/crangerel1.rd: Likewise.
* ld-sh/sh64/crangerel2.rd: Likewise.
* ld-sh/sh64/reldl32.rd: Likewise.
* ld-sh/sh64/reldl64.rd: Likewise.
2002-01-28  Alexandre Oliva  <aoliva@@redhat.com>
* ld-sh/sh64/abi32.xd: Formatting changes to match the current
output of objdump.
* ld-sh/sh64/cmpct1.xd: Likewise.
* ld-sh/sh64/crange1.rd: Likewise.
* ld-sh/sh64/crange2.rd: Likewise.
* ld-sh/sh64/crange3-cmpct.rd: Likewise.
* ld-sh/sh64/crange3-media.rd: Likewise.
* ld-sh/sh64/crange3.rd: Likewise.
* ld-sh/sh64/crangerel1.rd: Likewise.
* ld-sh/sh64/crangerel2.rd: Likewise.
* ld-sh/sh64/mix1.xd: Likewise.
* ld-sh/sh64/mix2.xd: Likewise.
* ld-sh/sh64/rel32.xd: Likewise.
* ld-sh/sh64/reldl32.rd: Likewise.
* ld-sh/sh64/reldl64.rd: Likewise.
* ld-sh/sh64/sh64.exp: Likewise.  Reordered cranges and stack
sessions, to match changes in the linker script.
2001-06-14  Alexandre Oliva  <aoliva@@redhat.com>
* ld-sh/sh64/reldl32.rd, ld-sh/sh64/reldl64.rd: Adjust relocation
info to reflect renumbering of relocation types.
2001-03-14  DJ Delorie	<dj@@redhat.com>
* ld-sh/sh64/endian.dbd: New file, endian tests.
* ld-sh/sh64/endian.dld: Ditto.
* ld-sh/sh64/endian.ld:	 Ditto.
* ld-sh/sh64/endian.s:	Ditto.
* ld-sh/sh64/endian.sbd:  Ditto.
* ld-sh/sh64/endian.sld:  Ditto.
* ld-sh/sh64/sh64.exp: Add above tests.	 Add -L option to ld.
2001-03-12  DJ Delorie	<dj@@redhat.com>
* ld-sh/sh64/relax.exp: New file, test disabling relaxing.
* ld-sh/sh64/relax1.s: Ditto.
* ld-sh/sh64/relax2.s: Ditto.
* ld-sh/sh64/relax3.s: Ditto.
* ld-sh/sh64/relax4.s: Ditto.
* ld-sh/sh64/relfail.exp: New file, test for bogus relocs.
* ld-sh/sh64/relfail.s: Ditto.
2001-03-12  DJ Delorie	<dj@@redhat.com>
* ld-sh/sh.exp: This test isn't appropriate for SH64 since it
uses SH32 assembler files.
2001-03-07  DJ Delorie	<dj@@redhat.com>
* ld-selective/selective.exp: Pass "-e _start" for sh64 to
accomodate expected start symbol in test.
2001-03-06  DJ Delorie	<dj@@redhat.com>
* ld-scripts/crossref.exp: Pass -mshelf32 to the linker for sh64,
to match what gcc passes to the linker by default.
* ld-selective/selective.exp: Ditto.
* ld-srec/srec.exp: Ditto, plus XFAIL for sh64.
* ld-undefined/undefined.exp: Add XFAIL for sh64 (it's dwarf2).
2001-03-06  DJ Delorie	<dj@@redhat.com>
* ld-sh/sh64/abi32.xd (stack): Adjust for new default stack layout.
* ld-sh/sh64/abi64.xd (stack): Ditto.
* ld-sh/sh64/cmpct1.xd (stack): Ditto.
* ld-sh/sh64/crange1.rd (stack): Ditto.
* ld-sh/sh64/crange2.rd (stack): Ditto.
* ld-sh/sh64/crange3-cmpct.rd (stack): Ditto.
* ld-sh/sh64/crange3-media.rd (stack): Ditto.
* ld-sh/sh64/crange3.rd (stack): Ditto.
* ld-sh/sh64/mix1.xd (stack): Ditto.
* ld-sh/sh64/mix2.xd (stack): Ditto.
* ld-sh/sh64/shdl32.xd (stack): Ditto.
* ld-sh/sh64/shdl64.xd (stack): Ditto.
2001-01-14  Hans-Peter Nilsson	<hpn@@cygnus.com>
* ld-sh/sh64/mix1.xd: Add SORT_ENTRIES for .cranges section.
* ld-sh/sh64/mix2.xd: Ditto.
2001-01-08  Hans-Peter Nilsson	<hpn@@cygnus.com>
* ld-sh/sh64/abi32.xd: Adjust for bit 0 set on an entry address
being SHmedia.
* ld-sh/sh64/shdl64.xd: Ditto.
* ld-sh/sh64/shdl32.xd: Ditto.
* ld-sh/sh64/mix2.xd: Ditto.
* ld-sh/sh64/crange3-media.rd: Ditto.
* ld-sh/sh64/abi64.xd: Ditto.
2001-01-06  Hans-Peter Nilsson	<hpn@@cygnus.com>
* ld-sh/sh64/crange-2a.s (diversion2): New global symbol.
* ld-sh/sh64/crange1.rd: Adjust to presence of new symbol.
Adjust section type for .cranges; expect sorted contents.
* ld-sh/sh64/crange2.rd: Ditto.
* ld-sh/sh64/crange3.dd, ld-sh/sh64/crange3.rd: Ditto.
* ld-sh/sh64/crangerel1.rd: Adjust to presence of new symbol.
* ld-sh/sh64/crangerel2.rd: Ditto.
* ld-sh/sh64/mix1.xd: Adjust to DEBUGGING being set for .cranges.
* ld-sh/sh64/mix2.xd: Ditto.
* ld-sh/sh64/crange3-cmpct.rd, ld-sh/sh64/crange3-media.rd: New
tests.
* ld-sh/sh64/sh64.exp: Tweak test message.  Run new tests.
2001-01-05  Hans-Peter Nilsson	<hpn@@cygnus.com>
* ld-sh/sh64/shmix-1.s (start2): Add a NOP to provide a valid
target for (unexpanded) PTB.  Add an .align 2 to SHmedia code to
keep properly aligned.
* ld-sh/sh64/mix1.sd, ld-sh/sh64/mix1.xd: Adjust accordingly.
* ld-sh/sh64/mix1-noexp.sd, ld-sh/sh64/mix2-noexp.sd,
ld-sh/sh64/abixx-noexp.sd: New tests for GAS -no-expand and
R_SH_PT_16 relocation.
* ld-sh/sh64/sh64.exp: Run new tests.
2000-12-30  Hans-Peter Nilsson	<hpn@@cygnus.com>
* ld-sh/sh64/crange-2f.s, ld-sh/sh64/crange-2g.s,
ld-sh/sh64/crange-2h.s, ld-sh/sh64/crange-2i.s,
ld-sh/sh64/crange3.dd, ld-sh/sh64/crange3.rd: New tests.
* ld-sh/sh64/sh64.exp: Run new tests.
* ld-sh/sh64/crange1.rd: Correct section flags.
* ld-sh/sh64/crange2.rd: Ditto.
* ld-sh/sh64/crangerel1.rd: Ditto.
2000-12-18  Hans-Peter Nilsson	<hpn@@cygnus.com>
* ld-sh/sh64/crange-1.s, ld-sh/sh64/crange-2a.s,
ld-sh/sh64/crange-2b.s, ld-sh/sh64/crange-2c.s,
ld-sh/sh64/crange-2d.s, ld-sh/sh64/crange-2e.s,
ld-sh/sh64/crange1.rd, ld-sh/sh64/crange2.rd,
ld-sh/sh64/crangerel1.rd, ld-sh/sh64/crangerel2.rd: New tests for
handling .cranges section.
* ld-sh/sh64/sh64.exp: Run new tests.
* ld-sh/sh64/mix1.sd, ld-sh/sh64/mix1.xd, ld-sh/sh64/mix2.sd,
ld-sh/sh64/mix2.xd: Adjust for .cranges section.
2000-12-15  Hans-Peter Nilsson	<hpn@@cygnus.com>
* ld-sh/sh64/abi32.sd, ld-sh/sh64/abi32.xd, ld-sh/sh64/abi64.sd,
ld-sh/sh64/abi64.xd, ld-sh/sh64/cmpct1.xd, ld-sh/sh64/mix1.sd,
ld-sh/sh64/mix1.xd, ld-sh/sh64/mix2.sd, ld-sh/sh64/mix2.xd,
ld-sh/sh64/shdl32.xd, ld-sh/sh64/shdl64.xd: Adjust to .bss and
.data individually 8-byte aligned.
2000-12-09  Hans-Peter Nilsson	<hpn@@cygnus.com>
* ld-sh/sh64/rel-1.s, ld-sh/sh64/rel-2.s, ld-sh/sh64/rel32.xd,
ld-sh/sh64/rel64.xd, ld-sh/sh64/reldl-1.s, ld-sh/sh64/reldl-2.s,
ld-sh/sh64/reldl32.rd, ld-sh/sh64/reldl64.rd: New tests.
* ld-sh/sh64/sh64.exp: Make it possible to use readelf as
inspection tool.  Run new tests.
2000-12-07  Hans-Peter Nilsson	<hpn@@cygnus.com>
* ld-sh/sh64/abi64.sd, ld-sh/sh64/abi32.sd, ld-sh/sh64/mix1.sd,
ld-sh/sh64/mix2.sd: Correct offsets in PT/PTA/PTB expansions.
* ld-sh/sh64/shdl-1.s, ld-sh/sh64/shdl-2.s, ld-sh/sh64/shdl64.sd,
ld-sh/sh64/shdl64.xd, ld-sh/sh64/shdl32.xd: New tests.
* ld-sh/sh64/sh64.exp: Run new tests.
2000-12-01  Hans-Peter Nilsson	<hpn@@cygnus.com>
* ld-sh/sh64/cmpct1.sd, ld-sh/sh64/cmpct1.xd,
ld-sh/sh64/shcmp-1.s: New test.
* ld-sh/sh64/sh64.exp: Add new test to sh64tests.  Reformat.
2000-11-30  Hans-Peter Nilsson	<hpn@@cygnus.com>
* ld-sh/sh64/sh64.exp: Use linker option -mshelf64 for 64-bit ABI
test.
* ld-sh/sh64/abi64.xd: Tweak for 64-bit ELF.
2000-11-29  Hans-Peter Nilsson	<hpn@@cygnus.com>
* ld-sh/sh64/sh64.exp (sh64tests): Use linker option -mshelf32 for
tests.
2000-11-27  Hans-Peter Nilsson	<hpn@@cygnus.com>
* ld-sh/sh64/abi32.sd, ld-sh/sh64/abi64.sd: Correct MOVI
registers.
* ld-sh/sh64/mix1.sd, ld-sh/sh64/mix1.xd, ld-sh/sh64/shmix-1.s:
New test.
* ld-sh/sh64/mix2.sd, ld-sh/sh64/mix2.xd, ld-sh/sh64/shmix-2.s,
ld-sh/sh64/shmix-3.s: New test.
* ld-sh/sh64/sh64.exp: Add new tests to sh64tests.
2000-11-26  Hans-Peter Nilsson	<hpn@@cygnus.com>
* ld-sh/sh64: New testsuite.
@
text
@d14 1
a14 1
Idx Name          Size      VMA               LMA               File off  Algn
d89 1
a89 1
0+155c g     O \.dtors	0+ ___dtors
d98 1
a98 1
0+1560 g     O \*ABS\*	0+ __bss_start
d105 1
a105 1
0+155c g     O \.ctors	0+ ___ctors_end
d111 1
a111 1
0+155c g     O \.ctors	0+ ___ctors
d118 2
a119 2
0+1560 g     O \*ABS\*	0+ _edata
0+1560 g     O \*ABS\*	0+ _end
d128 1
a128 1
0+80000 g     O \.stack	0+ _stack
d134 1
a134 1
0+155c g     O \.dtors	0+ ___dtors_end
@


1.1.4.1
log
@2002-09-23  Daniel Jacobowitz  <drow@@mvista.com>

	Merge from mainline:
	2002-09-19  Jakub Jelinek  <jakub@@redhat.com>
	* ld-i386/i386.exp: New.
	* ld-i386/tlsbin.dd: New test.
	* ld-i386/tlsbinpic.s: New test.
	* ld-i386/tlsbin.rd: New test.
	* ld-i386/tlsbin.s: New test.
	* ld-i386/tlsbin.sd: New test.
	* ld-i386/tlsbin.td: New test.
	* ld-i386/tlslib.s: New test.
	* ld-i386/tlsnopic1.s: New test.
	* ld-i386/tlsnopic2.s: New test.
	* ld-i386/tlsnopic.dd: New test.
	* ld-i386/tlsnopic.rd: New test.
	* ld-i386/tlsnopic.sd: New test.
	* ld-i386/tlspic1.s: New test.
	* ld-i386/tlspic2.s: New test.
	* ld-i386/tlspic.dd: New test.
	* ld-i386/tlspic.rd: New test.
	* ld-i386/tlspic.sd: New test.
	* ld-i386/tlspic.td: New test.

	2002-08-13  H.J. Lu <hjl@@gnu.org>
	* ld-elfvers/vers.exp: Add vers23c and vers23d.

	* ld-elfvers/vers23c.ver: New.
	* ld-elfvers/vers23d.dsym: New.

	2002-08-12  H.J. Lu <hjl@@gnu.org>
	* ld-elfvers/vers.exp: Add vers23.

	* ld-elfvers/vers23.c: New.
	* ld-elfvers/vers23.dsym: New.
	* ld-elfvers/vers23.ver: New.
	* ld-elfvers/vers23a.c: New.
	* ld-elfvers/vers23a.dsym: New.
	* ld-elfvers/vers23a.map: New.
	* ld-elfvers/vers23a.sym: New.
	* ld-elfvers/vers23a.ver: New.
	* ld-elfvers/vers23b.c: New.
	* ld-elfvers/vers23b.dsym: New.
	* ld-elfvers/vers23b.map: New.
	* ld-elfvers/vers23b.ver: New.

	2002-08-10  Alan Modra  <amodra@@bigpond.net.au>
	* ld-discard/discard.exp: Don't run on linuxaout or linuxoldld.
	* ld-linkonce/linkonce.exp: Likewise.
	* ld-selective/sel-dump.exp: Likewise.
	* ld-selective/selective.exp: Don't run on aout or bout.

	2002-08-08  H.J. Lu <hjl@@gnu.org>
	* ld-elfvers/vers.exp: Add vers22.

	* ld-elfvers/vers22.c: New.
	* ld-elfvers/vers22.dsym: New.
	* ld-elfvers/vers22.map: New.
	* ld-elfvers/vers22.ver: New.
	* ld-elfvers/vers22a.c: New.
	* ld-elfvers/vers22a.dsym: New.
	* ld-elfvers/vers22a.sym: New.
	* ld-elfvers/vers22a.ver: New.
	* ld-elfvers/vers22b.c: New.
	* ld-elfvers/vers22b.dsym: New.
	* ld-elfvers/vers22b.ver: New.

	2002-08-08  Stephen Clarke <stephen.clarke@@superh.com>
	* ld-sh/sh64/abi32.xd: Adjust whitespace in elf32 section
	listing.
	* ld-sh/sh64/cmpct1.xd, ld-sh/sh64/mix1.xd, ld-sh/sh64/mix2.xd,
	ld-sh/sh64/rel32.xd, ld-sh/sh64/shdl32.xd: Likewise.

	2002-08-07  H.J. Lu <hjl@@gnu.org>
	* ld-elfvers/vers.exp: Add --no-undefined-version.

	* ld-elfvers/vers1.map: Remove the unused foo1 and foo2.
	* ld-elfvers/vers8.map: Likewise.
	* ld-elfvers/vers18.map: Likewise.

	2002-08-07  Stephen Clarke <stephen.clarke@@superh.com>
	* ld-sh/sh64/abi32.xd: Adjust as type of linker-script-symbols
	is no longer set to object.
	* ld-sh/sh64/abi64.xd, ld-sh/sh64/cmpct1.xd, ld-sh/sh64/crange1.rd,
	ld-sh/sh64/crange2.rd, ld-sh/sh64/crange3-cmpct.rd,
	ld-sh/sh64/crange3-media.rd, ld-sh/sh64/crange3.rd,
	ld-sh/sh64/mix1.xd, ld-sh/sh64/mix2.xd, ld-sh/sh64/shdl32.xd,
	ld-sh/sh64/shdl64.xd: Likewise.

	2002-08-06  H.J. Lu <hjl@@gnu.org>
	* ld-elfvers/vers.exp: Add --no-undefined-version.

	* ld-elfvers/vers1.map: Remove the unused foo1 and foo2.
	* ld-elfvers/vers8.map: Likewise.
	* ld-elfvers/vers18.map: Likewise.

	2002-07-28  John David Anglin  <dave@@hiauly1.hia.nrc.ca>
	* ld-discard/discard.exp, ld-scripts/phdrs.exp, ld-scripts/phdrs2.exp,
	ld-selective/sel-dump.exp: Test hppa*64*-*-hpux* target.
	* ld-elfvers/vers.exp, ld-elfvsb/elfvsb.exp, ld-elfweak/elfweak.exp,
	ld-linkonce/linkonce.exp, ld-shared/shared.exp,
	ld-undefined/weak-undef.exp:  Test hppa*64*-*-hpux* and hppa*-*-linux*
	targets.
	* ld-discard/exit.s, ld-discard/extern.s, ld-discard/start.s,
	ld-discard/static.s: Add whitespace before assembler directives.

	2002-07-15  H.J. Lu <hjl@@gnu.org>
	* ld-elfvers/vers.exp: Add vers21.

	* ld-elfvers/vers21.c: New.
	* ld-elfvers/vers21.dsym: New.
	* ld-elfvers/vers21.map: New.
	* ld-elfvers/vers21.sym: New.
	* ld-elfvers/vers21.ver: New.
@
text
@d14 1
a14 1
Idx Name          Size      VMA       LMA       File off  Algn
d89 1
a89 1
0+155c g       \.dtors	0+ ___dtors
d98 1
a98 1
0+1560 g       \*ABS\*	0+ __bss_start
d105 1
a105 1
0+155c g       \.ctors	0+ ___ctors_end
d111 1
a111 1
0+155c g       \.ctors	0+ ___ctors
d118 2
a119 2
0+1560 g       \*ABS\*	0+ _edata
0+1560 g       \*ABS\*	0+ _end
d128 1
a128 1
0+80000 g       \.stack	0+ _stack
d134 1
a134 1
0+155c g       \.dtors	0+ ___dtors_end
@


