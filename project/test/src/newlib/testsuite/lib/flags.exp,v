head	1.4;
access;
symbols
	cygwin-1_7_35-release:1.4
	cygwin-1_7_34-release:1.4
	newlib-2_2_0:1.4.0.6
	cygwin-1_7_33-release:1.4
	cygwin-1_7_32-release:1.4
	cygwin-1_7_31-release:1.4
	cygwin-1_7_30-release:1.4
	cygwin-1_7_29-release:1.4
	cygwin-1_7_28-release:1.4
	newlib-2_1_0:1.4
	cygwin-1_7_27-release:1.4
	cygwin-1_7_26-release:1.4
	cygwin-1_7_25-release:1.4
	cygwin-1_7_24-release:1.4
	cygwin-1_7_23-release:1.4
	cygwin-1_7_22-release:1.4
	cygwin-1_7_21-release:1.4
	cygwin-1_7_20-release:1.4
	cygwin-1_7_19-release:1.4
	cygwin-64bit-postmerge:1.4
	cygwin-64bit-premerge-branch:1.4.0.4
	cygwin-64bit-premerge:1.4
	cygwin-1_7_18-release:1.4
	newlib-2_0_0:1.4
	cygwin-1_7_17-release:1.4
	cygwin-64bit-branch:1.4.0.2
	cygwin-1_7_16-release:1.4
	cygwin-1_7_15-release:1.4
	cygwin-1_7_14_2-release:1.4
	cygwin-1_7_14-release:1.4
	cygwin-1_7_12-release:1.4
	cygwin-1_7_11-release:1.4
	cygwin-1_7_10-release:1.4
	newlib-1_20_0:1.4
	cygwin-1_7_9-release:1.3
	cygwin-1_7_8-release:1.3
	newlib-1_19_0:1.3
	cygwin-1_7_7-release:1.3
	cygwin-1_7_5-release:1.3
	cygwin-1_7_4-release:1.3
	cygwin-1_7_3-release:1.3
	cygwin-1_7_2-release:1.3
	newlib-1_18_0:1.3
	cygwin-1_7_1-release:1.3
	newlib-1_17_0-arc:1.3.0.4
	binutils-arc-20080908-branch:1.3.0.2
	binutils-arc-20080908-branchpoint:1.3
	newlib-1_17_0:1.3
	newlib-1_16_0:1.3
	newlib-1_15_0:1.2
	newlib-csl-coldfire-4_1-32:1.2
	newlib-csl-sourcerygxx-4_1-32:1.2
	newlib-csl-innovasic-fido-3_4_4-33:1.2
	newlib-csl-coldfire-4_1-30:1.2
	newlib-csl-sourcerygxx-4_1-30:1.2
	newlib-csl-coldfire-4_1-28:1.2
	newlib-csl-sourcerygxx-4_1-28:1.2
	newlib-csl-arm-2006q3-27:1.2
	newlib-csl-sourcerygxx-4_1-27:1.2
	newlib-csl-arm-2006q3-26:1.2
	newlib-csl-sourcerygxx-4_1-26:1.2
	newlib-csl-sourcerygxx-4_1-24:1.2
	newlib-csl-sourcerygxx-4_1-23:1.2
	newlib-csl-sourcerygxx-4_1-21:1.2
	newlib-csl-arm-2006q3-21:1.2
	newlib-csl-arm-2006q3-19:1.2
	newlib-csl-sourcerygxx-4_1-19:1.2
	newlib-csl-sourcerygxx-4_1-18:1.2
	newlib-csl-sourcerygxx-3_4_4-25:1.2
	newlib-csl-sourcerygxx-4_1-17:1.2
	cr-0x5f1:1.2.0.6
	newlib-csl-sourcerygxx-4_1-14:1.2
	newlib-csl-sourcerygxx-4_1-13:1.2
	newlib-csl-sourcerygxx-4_1-12:1.2
	newlib-csl-sourcerygxx-4_1-9:1.2
	newlib-csl-sourcerygxx-4_1-8:1.2
	newlib-csl-sourcerygxx-4_1-7:1.2
	newlib-csl-arm-2006q1-6:1.2
	newlib-csl-sourcerygxx-4_1-6:1.2
	newlib-csl-sourcerygxx-4_1-5:1.2
	newlib-csl-sourcerygxx-4_1-4:1.2
	newlib-autotools-branch:1.2.0.4
	newlib-csl-20060320-branch:1.2.0.2
	newlib-csl-20060320-branchpoint:1.2
	newlib-1_14_0:1.2
	newlib-csl-arm-2005-q1b:1.1
	newlib-csl-arm-2005-q1a:1.1
	newlib-1_13_0:1.1
	csl-arm-2004-q3:1.1
	csl-arm-2004-q1a:1.1
	csl-arm-2004-q1:1.1
	newlib-1_12_0:1.1
	csl-arm-2003-q4:1.1
	w32api-2_2:1.1
	mingw-runtime-2_4:1.1
	newlib-1_11_0:1.1;
locks; strict;
comment	@# @;


1.4
date	2011.09.08.16.18.23;	author jjohnstn;	state Exp;
branches;
next	1.3;

1.3
date	2007.04.05.16.53.17;	author kazu;	state Exp;
branches;
next	1.2;

1.2
date	2005.07.05.00.10.08;	author jjohnstn;	state Exp;
branches
	1.2.2.1;
next	1.1;

1.1
date	2002.05.01.17.06.25;	author fitzsim;	state Exp;
branches;
next	;

1.2.2.1
date	2006.12.22.21.45.29;	author kazu;	state Exp;
branches;
next	;


desc
@@


1.4
log
@
2011-09-08  Jeff Johnston  <jjohnstn@@redhat.com>

        * testsuite/lib/flags.exp: Add logic to add the
        srcdir include directory to compile flags.
@
text
@# Copyright (C) 2002, 2011 by Red Hat, Incorporated. All rights reserved.
#
# Permission to use, copy, modify, and distribute this software
# is freely granted, provided that this notice is preserved.
#

# flags.exp: overrides the dejagnu versions of libgloss_link_flags,
# newlib_link_flags, and newlib_include_flags.

# These versions of the procedures generate link and include flags
# by searching for the needed files in the current build and source
# directories, rather than in the build and source paths of the
# compiler being used.

if {![llength [info procs saved_libgloss_link_flags]]} {
    rename libgloss_link_flags saved_libgloss_link_flags
}

proc libgloss_link_flags { args } {
    global target_cpu
    # These values come from the local site.exp.
    global srcdir objdir
    global multibuildtop

    if {![info exists multibuildtop]} {
	return [saved_libgloss_link_flags $args]
    }

    verbose "In newlib version of libgloss_link_flags...\n"

    if [isnative] {
	return ""
    }

    if [is_remote host] {
	return ""
    }

    set target_build_path "$objdir/$multibuildtop.."

    set gloss_srcdir [lookfor_file ${srcdir} libgloss/$target_cpu]

    if { $gloss_srcdir == "" } {
	return ""
    }

    if [file exists $target_build_path/libgloss/$target_cpu] {
	verbose "libgloss path is $target_build_path/libgloss/$target_cpu" 2
	return "-B$target_build_path/libgloss/$target_cpu/ -L$target_build_path/libgloss/$target_cpu -L$gloss_srcdir"
    } else {
	verbose -log "No libgloss support for this target." 2
	return ""
    }
}

proc newlib_link_flags { args } {
    global tool_root_dir
    global srcdir objdir

    verbose "In newlib version of newlib_link_flags...\n"

    if [is_remote host] {
	return ""
    }

    set ld_script_path [lookfor_file ${tool_root_dir} "ld/ldscripts"];
    if { $ld_script_path != "" } {
	set result "-L[file dirname $ld_script_path]"
    } else {
	set result ""
    }

    return "$result -B$objdir -L$objdir"
}

proc newlib_include_flags { args } {
    global srcdir objdir

    verbose "In newlib version of newlib_include_flags...\n"

    if [is_remote host] {
	return ""
    }

    set newlib_dir [lookfor_file ${srcdir} newlib/libc/include/assert.h]
    if { ${newlib_dir} != "" } {
        set newlib_dir [file dirname ${newlib_dir}]
    }
    return " -I$objdir/targ-include -I$objdir -I${newlib_dir}"
}
@


1.3
log
@	* testsuite/lib/flags.exp (newlib_include_flags): Drop
	-I${newlib_dir}.
@
text
@d1 1
a1 1
# Copyright (C) 2002 by Red Hat, Incorporated. All rights reserved.
d85 5
a89 1
    return " -I$objdir/targ-include"
@


1.2
log
@
2005-07-04  Mark Mitchell  <mark@@codesourcery.com>

        * Makefile.am (site.exp): Set tmpdir.
        * Makefile.in: Regenerated.
        * testsuite/lib/checkoutput.exp (newlib_check_output): Put
        executables in $tmpdir.
        * testsuite/lib/flags.exp (libgloss_link_flags): Use the original
        libgloss version if not running in the build directory.
        * testsuite/lib/newlib.exp (newlib_init): Put testglue.o in
        $tmpdir.
        * testsuite/lib/passfail.exp (newlib_pass_fail): Put executables
        in $tmpdir.
@
text
@d85 1
a85 5
    set newlib_dir [lookfor_file ${srcdir} newlib/libc/include/assert.h]
    if { ${newlib_dir} != "" } {
	set newlib_dir [file dirname ${newlib_dir}]
    }
    return " -I$objdir/targ-include -I${newlib_dir}"
@


1.2.2.1
log
@	newlib/
	* testsuite/lib/flags.exp (newlib_include_flags): Drop
	-I${newlib_dir}.
@
text
@d85 5
a89 1
    return " -I$objdir/targ-include"
@


1.1
log
@	* Add flags.exp.
@
text
@d15 4
d25 4
@

