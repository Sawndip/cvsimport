head	1.10;
access;
symbols
	sid-snapshot-20180601:1.10
	cgen-snapshot-20180601:1.10
	sid-snapshot-20180501:1.10
	cgen-snapshot-20180501:1.10
	sid-snapshot-20180401:1.10
	cgen-snapshot-20180401:1.10
	sid-snapshot-20180301:1.10
	cgen-snapshot-20180301:1.10
	sid-snapshot-20180201:1.10
	cgen-snapshot-20180201:1.10
	sid-snapshot-20180101:1.10
	cgen-snapshot-20180101:1.10
	sid-snapshot-20171201:1.10
	cgen-snapshot-20171201:1.10
	sid-snapshot-20171101:1.10
	cgen-snapshot-20171101:1.10
	sid-snapshot-20171001:1.10
	cgen-snapshot-20171001:1.10
	sid-snapshot-20170901:1.10
	cgen-snapshot-20170901:1.10
	sid-snapshot-20170801:1.10
	cgen-snapshot-20170801:1.10
	sid-snapshot-20170701:1.10
	cgen-snapshot-20170701:1.10
	sid-snapshot-20170601:1.10
	cgen-snapshot-20170601:1.10
	sid-snapshot-20170501:1.10
	cgen-snapshot-20170501:1.10
	sid-snapshot-20170401:1.10
	cgen-snapshot-20170401:1.10
	sid-snapshot-20170301:1.10
	cgen-snapshot-20170301:1.10
	sid-snapshot-20170201:1.10
	cgen-snapshot-20170201:1.10
	sid-snapshot-20170101:1.10
	cgen-snapshot-20170101:1.10
	sid-snapshot-20161201:1.10
	cgen-snapshot-20161201:1.10
	sid-snapshot-20161101:1.10
	cgen-snapshot-20161101:1.10
	sid-snapshot-20160901:1.10
	cgen-snapshot-20160901:1.10
	sid-snapshot-20160801:1.10
	cgen-snapshot-20160801:1.10
	sid-snapshot-20160701:1.10
	cgen-snapshot-20160701:1.10
	sid-snapshot-20160601:1.10
	cgen-snapshot-20160601:1.10
	sid-snapshot-20160501:1.10
	cgen-snapshot-20160501:1.10
	sid-snapshot-20160401:1.10
	cgen-snapshot-20160401:1.10
	sid-snapshot-20160301:1.10
	cgen-snapshot-20160301:1.10
	sid-snapshot-20160201:1.10
	cgen-snapshot-20160201:1.10
	sid-snapshot-20160101:1.10
	cgen-snapshot-20160101:1.10
	sid-snapshot-20151201:1.10
	cgen-snapshot-20151201:1.10
	sid-snapshot-20151101:1.10
	cgen-snapshot-20151101:1.10
	sid-snapshot-20151001:1.10
	cgen-snapshot-20151001:1.10
	sid-snapshot-20150901:1.10
	cgen-snapshot-20150901:1.10
	sid-snapshot-20150801:1.10
	cgen-snapshot-20150801:1.10
	sid-snapshot-20150701:1.10
	cgen-snapshot-20150701:1.10
	sid-snapshot-20150601:1.10
	cgen-snapshot-20150601:1.10
	sid-snapshot-20150501:1.10
	cgen-snapshot-20150501:1.10
	sid-snapshot-20150401:1.10
	cgen-snapshot-20150401:1.10
	sid-snapshot-20150301:1.10
	cgen-snapshot-20150301:1.10
	sid-snapshot-20150201:1.10
	cgen-snapshot-20150201:1.10
	sid-snapshot-20150101:1.10
	cgen-snapshot-20150101:1.10
	sid-snapshot-20141201:1.10
	cgen-snapshot-20141201:1.10
	sid-snapshot-20141101:1.10
	cgen-snapshot-20141101:1.10
	sid-snapshot-20141001:1.10
	cgen-snapshot-20141001:1.10
	sid-snapshot-20140901:1.10
	cgen-snapshot-20140901:1.10
	sid-snapshot-20140801:1.10
	cgen-snapshot-20140801:1.10
	sid-snapshot-20140701:1.10
	cgen-snapshot-20140701:1.10
	sid-snapshot-20140601:1.10
	cgen-snapshot-20140601:1.10
	sid-snapshot-20140501:1.10
	cgen-snapshot-20140501:1.10
	sid-snapshot-20140401:1.10
	cgen-snapshot-20140401:1.10
	sid-snapshot-20140301:1.10
	cgen-snapshot-20140301:1.10
	sid-snapshot-20140201:1.10
	cgen-snapshot-20140201:1.10
	sid-snapshot-20140101:1.10
	cgen-snapshot-20140101:1.10
	sid-snapshot-20131201:1.10
	cgen-snapshot-20131201:1.10
	sid-snapshot-20131101:1.10
	cgen-snapshot-20131101:1.10
	sid-snapshot-20131001:1.10
	cgen-snapshot-20131001:1.10
	sid-snapshot-20130901:1.10
	cgen-snapshot-20130901:1.10
	sid-snapshot-20130801:1.10
	cgen-snapshot-20130801:1.10
	sid-snapshot-20130701:1.10
	cgen-snapshot-20130701:1.10
	sid-snapshot-20130601:1.10
	cgen-snapshot-20130601:1.10
	sid-snapshot-20130501:1.10
	cgen-snapshot-20130501:1.10
	sid-snapshot-20130401:1.10
	cgen-snapshot-20130401:1.10
	sid-snapshot-20130301:1.10
	cgen-snapshot-20130301:1.10
	sid-snapshot-20130201:1.10
	cgen-snapshot-20130201:1.10
	sid-snapshot-20130101:1.10
	cgen-snapshot-20130101:1.10
	sid-snapshot-20121201:1.9
	cgen-snapshot-20121201:1.9
	sid-snapshot-20121101:1.9
	cgen-snapshot-20121101:1.9
	sid-snapshot-20121001:1.9
	cgen-snapshot-20121001:1.9
	sid-snapshot-20120901:1.9
	cgen-snapshot-20120901:1.9
	sid-snapshot-20120801:1.9
	cgen-snapshot-20120801:1.9
	sid-snapshot-20120701:1.9
	cgen-snapshot-20120701:1.9
	sid-snapshot-20120601:1.9
	cgen-snapshot-20120601:1.9
	sid-snapshot-20120501:1.9
	cgen-snapshot-20120501:1.9
	sid-snapshot-20120401:1.9
	cgen-snapshot-20120401:1.9
	sid-snapshot-20120301:1.9
	cgen-snapshot-20120301:1.9
	sid-snapshot-20120201:1.9
	cgen-snapshot-20120201:1.9
	sid-snapshot-20120101:1.9
	cgen-snapshot-20120101:1.9
	sid-snapshot-20111201:1.9
	cgen-snapshot-20111201:1.9
	sid-snapshot-20111101:1.9
	cgen-snapshot-20111101:1.9
	sid-snapshot-20111001:1.9
	cgen-snapshot-20111001:1.9
	sid-snapshot-20110901:1.9
	cgen-snapshot-20110901:1.9
	sid-snapshot-20110801:1.9
	cgen-snapshot-20110801:1.9
	sid-snapshot-20110701:1.9
	cgen-snapshot-20110701:1.9
	sid-snapshot-20110601:1.9
	cgen-snapshot-20110601:1.9
	sid-snapshot-20110501:1.9
	cgen-snapshot-20110501:1.9
	sid-snapshot-20110401:1.9
	cgen-snapshot-20110401:1.9
	sid-snapshot-20110301:1.9
	cgen-snapshot-20110301:1.9
	sid-snapshot-20110201:1.9
	cgen-snapshot-20110201:1.9
	sid-snapshot-20110101:1.9
	cgen-snapshot-20110101:1.9
	sid-snapshot-20101201:1.9
	cgen-snapshot-20101201:1.9
	sid-snapshot-20101101:1.9
	cgen-snapshot-20101101:1.9
	sid-snapshot-20101001:1.9
	cgen-snapshot-20101001:1.9
	sid-snapshot-20100901:1.9
	cgen-snapshot-20100901:1.9
	sid-snapshot-20100801:1.9
	cgen-snapshot-20100801:1.9
	sid-snapshot-20100701:1.9
	cgen-snapshot-20100701:1.9
	sid-snapshot-20100601:1.9
	cgen-snapshot-20100601:1.9
	sid-snapshot-20100501:1.9
	cgen-snapshot-20100501:1.9
	sid-snapshot-20100401:1.9
	cgen-snapshot-20100401:1.9
	sid-snapshot-20100301:1.9
	cgen-snapshot-20100301:1.9
	sid-snapshot-20100201:1.9
	cgen-snapshot-20100201:1.9
	sid-snapshot-20100101:1.9
	cgen-snapshot-20100101:1.9
	sid-snapshot-20091201:1.9
	cgen-snapshot-20091201:1.9
	sid-snapshot-20091101:1.9
	cgen-snapshot-20091101:1.9
	sid-snapshot-20091001:1.8
	cgen-snapshot-20091001:1.8
	arc-sim-20090309:1.5
	sid-snapshot-20090901:1.8
	cgen-snapshot-20090901:1.8
	sid-snapshot-20090801:1.8
	cgen-snapshot-20090801:1.8
	sid-snapshot-20090701:1.7
	cgen-snapshot-20090701:1.7
	dje-cgen-play1-branch:1.7.0.4
	dje-cgen-play1-branchpoint:1.7
	cgen-1_1-branch:1.7.0.2
	cgen-1_1-branchpoint:1.7
	sid-snapshot-20090601:1.5
	cgen-snapshot-20090601:1.5
	sid-snapshot-20090501:1.5
	cgen-snapshot-20090501:1.5
	sid-snapshot-20090401:1.5
	cgen-snapshot-20090401:1.5
	arc-insight_6_8-branch:1.5.0.4
	arc-insight_6_8-branchpoint:1.5
	sid-snapshot-20090301:1.5
	cgen-snapshot-20090301:1.5
	sid-snapshot-20090201:1.5
	cgen-snapshot-20090201:1.5
	sid-snapshot-20090101:1.5
	cgen-snapshot-20090101:1.5
	sid-snapshot-20081201:1.5
	cgen-snapshot-20081201:1.5
	sid-snapshot-20081101:1.5
	cgen-snapshot-20081101:1.5
	sid-snapshot-20081001:1.5
	cgen-snapshot-20081001:1.5
	sid-snapshot-20080901:1.5
	cgen-snapshot-20080901:1.5
	sid-snapshot-20080801:1.5
	cgen-snapshot-20080801:1.5
	sid-snapshot-20080701:1.5
	cgen-snapshot-20080701:1.5
	sid-snapshot-20080601:1.5
	cgen-snapshot-20080601:1.5
	sid-snapshot-20080501:1.5
	cgen-snapshot-20080501:1.5
	sid-snapshot-20080403:1.5
	sid-snapshot-20080401:1.5
	cgen-snapshot-20080401:1.5
	sid-snapshot-20080301:1.5
	cgen-snapshot-20080301:1.5
	sid-snapshot-20080201:1.5
	cgen-snapshot-20080201:1.5
	sid-snapshot-20080101:1.5
	cgen-snapshot-20080101:1.5
	sid-snapshot-20071201:1.5
	cgen-snapshot-20071201:1.5
	sid-snapshot-20071101:1.5
	cgen-snapshot-20071101:1.5
	sid-snapshot-20071001:1.5
	cgen-snapshot-20071001:1.5
	msnyder-fork-checkpoint-branch:1.5.0.2
	msnyder-fork-checkpoint-branchpoint:1.5;
locks; strict;
comment	@# @;


1.10
date	2012.12.17.16.55.41;	author nickc;	state Exp;
branches;
next	1.9;

1.9
date	2009.10.24.22.34.51;	author devans;	state Exp;
branches;
next	1.8;

1.8
date	2009.07.15.16.49.32;	author devans;	state Exp;
branches;
next	1.7;

1.7
date	2009.06.18.18.23.13;	author devans;	state Exp;
branches;
next	1.6;

1.6
date	2009.06.15.05.52.42;	author devans;	state Exp;
branches;
next	1.5;

1.5
date	2003.10.08.17.54.13;	author brolley;	state Exp;
branches;
next	1.4;

1.4
date	2003.07.08.16.23.56;	author devans;	state Exp;
branches;
next	1.3;

1.3
date	2003.06.11.07.25.25;	author devans;	state Exp;
branches;
next	1.2;

1.2
date	2003.06.10.21.22.02;	author devans;	state Exp;
branches;
next	1.1;

1.1
date	2003.05.15.07.25.02;	author devans;	state Exp;
branches;
next	;


desc
@@


1.10
log
@Add copyright notices
@
text
@#! /bin/sh
# Utility script to generate html docs for all ports.
#
#   Copyright 2012 Free Software Foundation
#
# This file is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
# 
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with this program; see the file COPYING3.  If not see
# <http://www.gnu.org/licenses/>.
#

# Run this script in the src/cgen directory.

# Exit on any error.
set -e

# For debugging.
set -x

# ??? Some are missing, need to add them after some research.
#../cpu/m32c.cpu
#../cpu/xc16x.cpu
archs="
cpu/fr30.cpu
cpu/arm.cpu
../cpu/frv.cpu
cpu/i960.cpu
cpu/ip2k.cpu
../cpu/iq2000.cpu
../cpu/lm32.cpu
../cpu/m32r.cpu
cpu/mep.cpu
../cpu/mt.cpu
cpu/openrisc.cpu
cpu/sh.cpu
cpu/xstormy16.cpu
"

if [ ! -f sim.scm ]
then
    echo "Not in the src/cgen directory." >& 2
    exit 1
fi

export builddir=tmp-doc

rm -rf $builddir
mkdir $builddir

export cgendir=`pwd`

(
  set -e
  set -x
  cd $builddir
  $cgendir/configure --prefix /tmp/junk --target m32r-elf

  for a in $archs
  do
    archfile=../$a
    arch=$(basename $archfile .cpu)

    case $arch in
    arm)
      make html ARCH=$arch ARCHFILE=$archfile ISAS=arm INSN_FILE_NAME=arm-arm-insn.html
      mv arm.html arm-arm.html
      mv arm-insn.html arm-arm-insn.html
      make html ARCH=$arch ARCHFILE=$archfile ISAS=thumb INSN_FILE_NAME=arm-thumb-insn.html
      mv arm.html arm-thumb.html
      mv arm-insn.html arm-thumb-insn.html
      ;;
    frv)
      make html ARCH=$arch ARCHFILE=$archfile MACHS="frv,simple,tomcat,fr400" INSN_FILE_NAME=frv-1-insn.html
      mv frv.html frv-1.html
      mv frv-insn.html frv-1-insn.html
      make html ARCH=$arch ARCHFILE=$archfile MACHS="fr500" INSN_FILE_NAME=frv-2-insn.html
      mv frv.html frv-2.html
      mv frv-insn.html frv-2-insn.html
      make html ARCH=$arch ARCHFILE=$archfile MACHS="fr550" INSN_FILE_NAME=frv-3-insn.html
      mv frv.html frv-3.html
      mv frv-insn.html frv-3-insn.html
      ;;
    *)
      make html ARCH=$arch ARCHFILE=$archfile
      ;;
    esac
  done
)

(
  set -e
  set -x
  cd $builddir

  rm -f index.html

  cat > index.html <<EOF
<html>
<head>
<title>CGEN Machine Generated Documentation</title>
</head>
<body>

<h1>Machine Generated Documentation</h1>

<ul>
EOF

  lower="abcdefghijklmnopqrstuvwxyz"
  upper="ABCDEFGHIJKLMNOPQRSTUVWXYZ"

  for html in *.html
  do
    name=""

    case $html in
    *-insn.html) ;;
    index.html) ;;
    arm-arm.*) name="ARM" ;;
    arm-thumb.*) name="ARM Thumb" ;;
    frv-1.*) name="FRV FR400" ;;
    frv-2.*) name="FRV FR500" ;;
    openrisc.*) name="Openrisc" ;;
    xstormy16.*) name="Xstormy16" ;;
    *) name=`echo ${html/.html} | tr $lower $upper` ;;
    esac

    if [ "$name" != "" ]
    then
      echo "<li><a href=\"$html\">$name</a>" >> index.html
    fi
  done

  cat >> index.html <<EOF
</ul>

</body>
</html>
EOF
)
@


1.9
log
@	* gen-all-doc: Add sh.cpu.
@
text
@d3 17
@


1.8
log
@	* gen-all-doc: Generate index.html.
@
text
@d27 1
@


1.7
log
@	* gen-all-doc: Add fr30, ip2k, iq2000, lm32, mep, mt.
@
text
@d36 1
a36 1
builddir=tmp-doc
d80 52
@


1.6
log
@	* gen-all-doc: Use files in ../cpu where possible.
@
text
@d13 1
a13 6
#cpu/fr30.cpu
#cpu/ip2k.cpu
#../cpu/iq2000.cpu
#../cpu/lm32.cpu
#cpu/mep.cpu
#../cpu/mt.cpu
d16 1
d20 3
d24 2
@


1.5
log
@2003-10-06  Dave Brolley  <brolley@@redhat.com>

        * gen-all-doc: Add fr550.
@
text
@d13 15
a27 1
archs="arm frv i960 m32r openrisc xstormy16"
d50 4
a53 1
    case $a in
d55 1
a55 1
      make html ARCH=$a ISAS=arm INSN_FILE_NAME=arm-arm-insn.html
d58 1
a58 1
      make html ARCH=$a ISAS=thumb INSN_FILE_NAME=arm-thumb-insn.html
d63 1
a63 1
      make html ARCH=$a MACHS="frv,simple,tomcat,fr400" INSN_FILE_NAME=frv-1-insn.html
d66 1
a66 1
      make html ARCH=$a MACHS="fr500" INSN_FILE_NAME=frv-2-insn.html
d69 1
a69 1
      make html ARCH=$a MACHS="fr550" INSN_FILE_NAME=frv-3-insn.html
d74 1
a74 1
      make html ARCH=$a
@


1.4
log
@	* gen-all-doc: Ensure run from cgen src dir.
	* gen-all-opcodes: Build in ./tmp-opcodes.  Don't delete dir when done.
	* gen-all-sid: Similarily, in ./tmp-sid.
	* gen-all-sim: Similarily, in ./tmp-sim.
@
text
@d52 3
@


1.3
log
@change build directory to ./tmp-doc
@
text
@d15 6
@


1.2
log
@	* mach.scm (current-*-add!): Disallow redefinition.  Make result
	"unspecified".
	* insn.scm (insn-builtin!): Don't define relaxable here, now defined in
	operand.scm.
	* operand.scm (operand-builtin!): Define RELAXABLE for insns too.
	* cpu/m32r.cpu (disp8,disp24): RELAX renamed to RELAXABLE.

	* gen-all-doc: Split arm and frv docs up a bit.

	* cpu/arm.cpu: Add IDOC attribute.
	* cpu/frv.cpu: Ditto.
	* cpu/i960.cpu: Ditto.
	* cpu/openrisc.cpu: Ditto.
	* cpu/xstormy16.cpu: Ditto.
	* cpu/m32r.cpu: Ditto.
	(all insns): Explicitly specify IDOC attribute.

	* Makefile.am (MACH,ISAS,INSN_FILE_NAME): New vars.
	(desc,opcodes,sim-arch,sim-cpu,gas-test,sim-test): Use MACH,ISAS.
	(html): Use MACH,ISAS,INSN_FILE_NAME.  Generate insn.html separately.
	* Makefile.in: Regenerate.
	* attr.scm (<integer-attribute>:parse-value-def): Implement.
	(-attr-read): Defer computing default value until we know the type.
	(attr-has-attr?): Delete, move contents to <attr-list>:has-attr?.
	(<attr-list>:attr-present?): New method.
	(atlist-attr-present?,obj-attr-present?): New fns.
	(obj-has-attr-value?,obj-has-attr-value-no-default?): New fns.
	(attr-builtin!): New insn attr IDOC.
	* cgen-doc.scm (doc-arguments): New args -I,-N.
	* enum.scm (parse-enum-vals): New arg errtxt, all callers updated.
	Support comment as fourth element of enum value.
	(enum-val-name,enum-val-value,enum-val-attrs,enum-val-comment): New fns.
	* html.scm (gen-html-header): New arg kind, all callers updated.
	(gen-table-of-contents): New arg insn-file, all callers updated.
	(gen-list-entry,gen-doc-header): New fn.
	(get-operands): Delete.
	(gen-iformat-table): Rewrite.
	(gen-insn-doc-1): Print constant-folded and trimmed semantics.
	(gen-insn-doc-list): New args name, comment, insns.  All callers updated.
	(get-insn-properties,guess-insn-idoc-attr!): New fn.
	(insn-sets-pc?,insn-refs-mem?,insn-uses-fpu?): New fns.
	(get-insns-for-category,gen-categories-insn-lists): New fns.
	(gen-insn-docs): Simplify each insn's semantics first.
	Print insn tables sorted by IDOC categories.
	(*insn-html-file-name*): New global.
	(cgen-insn.html): New fn.
	(cgen-all): Update.
	* insn.scm (<insn>): Create a setter for the `tmp' member.
	* semantics.scm (insn-build-known-values): Renamed from
	-build-known-values.  All callers updated.

	* rtl.scm: Move traveral/evaluation support to ...
	* rtl-traverse.scm: New file.
	* read.scm: Maybe-load rtl-traverse.scm.

	* rtl.scm (-rtx-valid-types): Add SETRTX.

	* rtx-funcs.scm (nop,parallel): Fix mode.

	* utils.scm (eqv-lookup-index): New fn.
	(assq-lookup-index): Renamed from lookup-index.  All callers updated.

	* dev.scm (load-doc): Set APPLICATION.
@
text
@d15 4
a18 2
rm -rf /tmp/tmp-cgen-doc
mkdir /tmp/tmp-cgen-doc
d25 1
a25 1
  cd /tmp/tmp-cgen-doc
@


1.1
log
@	* Makefile.am (srcroot): New var.
	(html): New rule.
	* Makefile.in: Regenerate.
	* cgen-doc.scm: New file.
	* html.scm: New file.
	* gen-all-doc: New file.
	* dev.scm (cload): Handle DOC application.
	(load-doc): New fn.
	* machs.scm (machs-for-cpu): New fn.
	* model.scm (models-for-cpu): New fn.
	* utils.scm (gen-c-copyright): Renamed from gen-copyright.
	All uses updated.
	(iota): Rewrite to be identical to pmacro version.  All uses updated.
	* utils-cgen.scm (alpha-sort-obj-list): New fn.
@
text
@d28 21
a48 1
    make html ARCH=$a
@

