head	1.4;
access;
symbols
	sid-snapshot-20180601:1.4
	cgen-snapshot-20180601:1.4
	sid-snapshot-20180501:1.4
	cgen-snapshot-20180501:1.4
	sid-snapshot-20180401:1.4
	cgen-snapshot-20180401:1.4
	sid-snapshot-20180301:1.4
	cgen-snapshot-20180301:1.4
	sid-snapshot-20180201:1.4
	cgen-snapshot-20180201:1.4
	sid-snapshot-20180101:1.4
	cgen-snapshot-20180101:1.4
	sid-snapshot-20171201:1.4
	cgen-snapshot-20171201:1.4
	sid-snapshot-20171101:1.4
	cgen-snapshot-20171101:1.4
	sid-snapshot-20171001:1.4
	cgen-snapshot-20171001:1.4
	sid-snapshot-20170901:1.4
	cgen-snapshot-20170901:1.4
	sid-snapshot-20170801:1.4
	cgen-snapshot-20170801:1.4
	sid-snapshot-20170701:1.4
	cgen-snapshot-20170701:1.4
	sid-snapshot-20170601:1.4
	cgen-snapshot-20170601:1.4
	sid-snapshot-20170501:1.4
	cgen-snapshot-20170501:1.4
	sid-snapshot-20170401:1.4
	cgen-snapshot-20170401:1.4
	sid-snapshot-20170301:1.4
	cgen-snapshot-20170301:1.4
	sid-snapshot-20170201:1.4
	cgen-snapshot-20170201:1.4
	sid-snapshot-20170101:1.4
	cgen-snapshot-20170101:1.4
	sid-snapshot-20161201:1.4
	cgen-snapshot-20161201:1.4
	sid-snapshot-20161101:1.4
	cgen-snapshot-20161101:1.4
	sid-snapshot-20160901:1.4
	cgen-snapshot-20160901:1.4
	sid-snapshot-20160801:1.4
	cgen-snapshot-20160801:1.4
	sid-snapshot-20160701:1.4
	cgen-snapshot-20160701:1.4
	sid-snapshot-20160601:1.4
	cgen-snapshot-20160601:1.4
	sid-snapshot-20160501:1.4
	cgen-snapshot-20160501:1.4
	sid-snapshot-20160401:1.4
	cgen-snapshot-20160401:1.4
	sid-snapshot-20160301:1.4
	cgen-snapshot-20160301:1.4
	sid-snapshot-20160201:1.4
	cgen-snapshot-20160201:1.4
	sid-snapshot-20160101:1.4
	cgen-snapshot-20160101:1.4
	sid-snapshot-20151201:1.4
	cgen-snapshot-20151201:1.4
	sid-snapshot-20151101:1.4
	cgen-snapshot-20151101:1.4
	sid-snapshot-20151001:1.4
	cgen-snapshot-20151001:1.4
	sid-snapshot-20150901:1.4
	cgen-snapshot-20150901:1.4
	sid-snapshot-20150801:1.4
	cgen-snapshot-20150801:1.4
	sid-snapshot-20150701:1.4
	cgen-snapshot-20150701:1.4
	sid-snapshot-20150601:1.4
	cgen-snapshot-20150601:1.4
	sid-snapshot-20150501:1.4
	cgen-snapshot-20150501:1.4
	sid-snapshot-20150401:1.4
	cgen-snapshot-20150401:1.4
	sid-snapshot-20150301:1.4
	cgen-snapshot-20150301:1.4
	sid-snapshot-20150201:1.4
	cgen-snapshot-20150201:1.4
	sid-snapshot-20150101:1.4
	cgen-snapshot-20150101:1.4
	sid-snapshot-20141201:1.4
	cgen-snapshot-20141201:1.4
	sid-snapshot-20141101:1.4
	cgen-snapshot-20141101:1.4
	sid-snapshot-20141001:1.4
	cgen-snapshot-20141001:1.4
	sid-snapshot-20140901:1.4
	cgen-snapshot-20140901:1.4
	sid-snapshot-20140801:1.4
	cgen-snapshot-20140801:1.4
	sid-snapshot-20140701:1.4
	cgen-snapshot-20140701:1.4
	sid-snapshot-20140601:1.4
	cgen-snapshot-20140601:1.4
	sid-snapshot-20140501:1.4
	cgen-snapshot-20140501:1.4
	sid-snapshot-20140401:1.4
	cgen-snapshot-20140401:1.4
	sid-snapshot-20140301:1.4
	cgen-snapshot-20140301:1.4
	sid-snapshot-20140201:1.4
	cgen-snapshot-20140201:1.4
	sid-snapshot-20140101:1.4
	cgen-snapshot-20140101:1.4
	sid-snapshot-20131201:1.4
	cgen-snapshot-20131201:1.4
	sid-snapshot-20131101:1.4
	cgen-snapshot-20131101:1.4
	sid-snapshot-20131001:1.4
	cgen-snapshot-20131001:1.4
	sid-snapshot-20130901:1.4
	cgen-snapshot-20130901:1.4
	sid-snapshot-20130801:1.4
	cgen-snapshot-20130801:1.4
	sid-snapshot-20130701:1.4
	cgen-snapshot-20130701:1.4
	sid-snapshot-20130601:1.4
	cgen-snapshot-20130601:1.4
	sid-snapshot-20130501:1.4
	cgen-snapshot-20130501:1.4
	sid-snapshot-20130401:1.4
	cgen-snapshot-20130401:1.4
	sid-snapshot-20130301:1.4
	cgen-snapshot-20130301:1.4
	sid-snapshot-20130201:1.4
	cgen-snapshot-20130201:1.4
	sid-snapshot-20130101:1.4
	cgen-snapshot-20130101:1.4
	sid-snapshot-20121201:1.4
	cgen-snapshot-20121201:1.4
	sid-snapshot-20121101:1.4
	cgen-snapshot-20121101:1.4
	sid-snapshot-20121001:1.4
	cgen-snapshot-20121001:1.4
	sid-snapshot-20120901:1.4
	cgen-snapshot-20120901:1.4
	sid-snapshot-20120801:1.4
	cgen-snapshot-20120801:1.4
	sid-snapshot-20120701:1.4
	cgen-snapshot-20120701:1.4
	sid-snapshot-20120601:1.4
	cgen-snapshot-20120601:1.4
	sid-snapshot-20120501:1.4
	cgen-snapshot-20120501:1.4
	sid-snapshot-20120401:1.4
	cgen-snapshot-20120401:1.4
	sid-snapshot-20120301:1.4
	cgen-snapshot-20120301:1.4
	sid-snapshot-20120201:1.4
	cgen-snapshot-20120201:1.4
	sid-snapshot-20120101:1.4
	cgen-snapshot-20120101:1.4
	sid-snapshot-20111201:1.4
	cgen-snapshot-20111201:1.4
	sid-snapshot-20111101:1.4
	cgen-snapshot-20111101:1.4
	sid-snapshot-20111001:1.4
	cgen-snapshot-20111001:1.4
	sid-snapshot-20110901:1.4
	cgen-snapshot-20110901:1.4
	sid-snapshot-20110801:1.4
	cgen-snapshot-20110801:1.4
	sid-snapshot-20110701:1.4
	cgen-snapshot-20110701:1.4
	sid-snapshot-20110601:1.4
	cgen-snapshot-20110601:1.4
	sid-snapshot-20110501:1.4
	cgen-snapshot-20110501:1.4
	sid-snapshot-20110401:1.4
	cgen-snapshot-20110401:1.4
	sid-snapshot-20110301:1.4
	cgen-snapshot-20110301:1.4
	sid-snapshot-20110201:1.4
	cgen-snapshot-20110201:1.4
	sid-snapshot-20110101:1.4
	cgen-snapshot-20110101:1.4
	sid-snapshot-20101201:1.4
	cgen-snapshot-20101201:1.4
	sid-snapshot-20101101:1.4
	cgen-snapshot-20101101:1.4
	sid-snapshot-20101001:1.4
	cgen-snapshot-20101001:1.4
	sid-snapshot-20100901:1.4
	cgen-snapshot-20100901:1.4
	sid-snapshot-20100801:1.4
	cgen-snapshot-20100801:1.4
	sid-snapshot-20100701:1.4
	cgen-snapshot-20100701:1.4
	sid-snapshot-20100601:1.4
	cgen-snapshot-20100601:1.4
	sid-snapshot-20100501:1.4
	cgen-snapshot-20100501:1.4
	sid-snapshot-20100401:1.4
	cgen-snapshot-20100401:1.4
	sid-snapshot-20100301:1.4
	cgen-snapshot-20100301:1.4
	sid-snapshot-20100201:1.4
	cgen-snapshot-20100201:1.4
	sid-snapshot-20100101:1.4
	cgen-snapshot-20100101:1.4
	sid-snapshot-20091201:1.4
	cgen-snapshot-20091201:1.4
	sid-snapshot-20091101:1.4
	cgen-snapshot-20091101:1.4
	sid-snapshot-20091001:1.4
	cgen-snapshot-20091001:1.4
	arc-sim-20090309:1.2
	sid-snapshot-20090901:1.4
	cgen-snapshot-20090901:1.4
	sid-snapshot-20090801:1.4
	cgen-snapshot-20090801:1.4
	sid-snapshot-20090701:1.4
	cgen-snapshot-20090701:1.4
	dje-cgen-play1-branch:1.4.0.2
	dje-cgen-play1-branchpoint:1.4
	cgen-1_1-branch:1.3.0.2
	cgen-1_1-branchpoint:1.3
	sid-snapshot-20090601:1.2
	cgen-snapshot-20090601:1.2
	sid-snapshot-20090501:1.2
	cgen-snapshot-20090501:1.2
	sid-snapshot-20090401:1.2
	cgen-snapshot-20090401:1.2
	arc-insight_6_8-branch:1.2.0.2
	arc-insight_6_8-branchpoint:1.2
	sid-snapshot-20090301:1.2
	cgen-snapshot-20090301:1.2
	sid-snapshot-20090201:1.2
	cgen-snapshot-20090201:1.2
	sid-snapshot-20090101:1.2
	cgen-snapshot-20090101:1.2
	sid-snapshot-20081201:1.2
	cgen-snapshot-20081201:1.2
	sid-snapshot-20081101:1.2
	cgen-snapshot-20081101:1.2
	sid-snapshot-20081001:1.2
	cgen-snapshot-20081001:1.2
	sid-snapshot-20080901:1.2
	cgen-snapshot-20080901:1.2
	sid-snapshot-20080801:1.2
	cgen-snapshot-20080801:1.2
	sid-snapshot-20080701:1.2
	cgen-snapshot-20080701:1.2
	sid-snapshot-20080601:1.2
	cgen-snapshot-20080601:1.2
	sid-snapshot-20080501:1.2
	cgen-snapshot-20080501:1.2
	sid-snapshot-20080403:1.2
	sid-snapshot-20080401:1.2
	cgen-snapshot-20080401:1.2
	sid-snapshot-20080301:1.2
	cgen-snapshot-20080301:1.2
	sid-snapshot-20080201:1.2
	cgen-snapshot-20080201:1.2
	sid-snapshot-20080101:1.2
	cgen-snapshot-20080101:1.2
	sid-snapshot-20071201:1.2
	cgen-snapshot-20071201:1.2;
locks; strict;
comment	@# @;


1.4
date	2009.06.24.15.03.09;	author devans;	state Exp;
branches;
next	1.3;

1.3
date	2009.06.14.17.09.56;	author devans;	state Exp;
branches
	1.3.2.1;
next	1.2;

1.2
date	2007.11.13.17.19.31;	author brolley;	state Exp;
branches;
next	1.1;

1.1
date	2007.11.05.15.46.19;	author brolley;	state Exp;
branches;
next	;

1.3.2.1
date	2009.06.24.14.57.45;	author devans;	state Exp;
branches;
next	;


desc
@@


1.4
log
@	* All *.scm files: Update copyright year.
	* utils.scm (copyright-fsf, copyright-redhat): Ditto.
@
text
@; GCC "intrinsics" file entry point.
;
; This is invoked to build support files for registering intrinsic
; functions within gcc. this code has a fair bit of target-specific
; code in it. it's not a general-purpose module yet.
;
; Copyright (C) 2000, 2009 Red Hat, Inc.
; This file is part of CGEN.
;
; This is a standalone script, we don't load anything until we parse the
; -s argument (keeps reliance off of environment variables, etc.).

; Load the various support routines.

(define (load-files srcdir)
  ; Fix up Scheme to be what we use (guile is always in flux).
  (primitive-load-path (string-append srcdir "/guile.scm"))

  (load (string-append srcdir "/read.scm"))
  (load (string-append srcdir "/intrinsics.scm"))
)

(define intrinsics-isas '())

(define intrinsics-arguments
  (list
   (list "-K" "isa" "keep isa <isa> in intrinsics" #f
	 (lambda (args)
	   (for-each
	    (lambda (arg) (set! intrinsics-isas (cons (string->symbol arg) intrinsics-isas)))
	    (string-cut args #\,))))
   (list "-M" "file" "generate insns.md in <file>" #f
	 (lambda (arg) (file-write arg insns.md)))
   (list "-N" "file" "generate intrinsics.h in <file>" #f
	 (lambda (arg) (file-write arg intrinsics.h)))
   (list "-P" "file" "generate intrinsic-protos.h in <file>" #f
	 (lambda (arg) (file-write arg intrinsic-protos.h)))
   (list "-T" "file" "generate intrinsic-testsuite.c in <file>" #f
	 (lambda (arg) (file-write arg intrinsic-testsuite.c)))))

; Kept global so it's available to the other .scm files.
(define srcdir ".")

; Scan argv for -s srcdir.
; We can't process any other args until we find the cgen source dir.
; The result is srcdir.
; We assume "-s" isn't the argument to another option.  Unwise, yes.
; Alternatives are to require it to be the first argument or at least preceed
; any option with a "-s" argument, or to put knowledge of the common argument
; set and common argument parsing code in every top level file.

(define (find-srcdir argv)
  (let loop ((argv argv))
    (if (null? argv)
	(error "`-s srcdir' not present, can't load cgen"))
    (if (string=? "-s" (car argv))
	(begin
	  (if (null? (cdr argv))
	      (error "missing srcdir arg to `-s'"))
	  (cadr argv))
	(loop (cdr argv))))	
)

; Main routine, parses options and calls generators.

(define (cgen-intrinsics argv)
  (let ()

    ; Find and set srcdir, then load all Scheme code.
    ; Drop the first argument, it is the script name (i.e. argv[0]).
    (set! srcdir (find-srcdir (cdr argv)))
    (set! %load-path (cons srcdir %load-path))
    (load-files srcdir)

    (display-argv argv)

    (cgen #:argv argv
	  #:app-name "intrinsics"
	  #:arg-spec intrinsics-arguments
	  #:analyze intrinsics-analyze!)
    )
)

(cgen-intrinsics (program-arguments))
@


1.3
log
@	* attr.scm: Removing trailing whitespace.
	* cgen-intrinsics.scm: Ditto.
	* cgen-sim.scm: Ditto.
	* cos.scm: Ditto.
	* enum.scm: Ditto.
	* guile.scm: Ditto.
	* sim.scm: Ditto.
@
text
@d7 1
a7 1
; Copyright (C) 2000 Red Hat, Inc.
@


1.3.2.1
log
@	* All *.scm files: Update copyright year.
	* utils.scm (copyright-fsf, copyright-redhat): Ditto.
@
text
@d7 1
a7 1
; Copyright (C) 2000, 2009 Red Hat, Inc.
@


1.2
log
@2007-11-13  Dave Brolley  <brolley@@redhat.com>

        * cgen-intrinsics.scm (load-files): Remove reference to fixup.scm.
@
text
@d29 1
a29 1
	   (for-each 
@


1.1
log
@2007-11-05  Dave Brolley  <brolley@@redhat.com>

        * intrinsics.scm,cgen-intrinsics.scm: New application which
        generates code to support intrinsic functions for insns in the
        mep architecture in gcc.
@
text
@a16 1
  (primitive-load-path (string-append srcdir "/fixup.scm"))
@

