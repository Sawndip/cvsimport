head	1.422;
access;
symbols
	cygwin-1_7_35-release:1.421
	cygwin-1_7_34-release:1.418
	cygwin-1_7_33-release:1.397.2.6
	cygwin-1_7_32-release:1.397.2.5
	cygwin-1_7_31-release:1.397.2.4
	cygwin-1_7_30-release:1.397.2.3
	cygwin-1_7_29-release:1.397.2.1
	cygwin-1_7_29-release-branchpoint:1.397.0.2
	cygwin-pre-user-db:1.397
	cygwin-1_7_28-release:1.396
	cygwin-1_7_27-release:1.395
	cygwin-1_7_26-release:1.394
	cygwin-1_7_25-release:1.392
	cygwin-1_7_24-release:1.390
	cygwin-1_7_23-release:1.388
	callout:1.388.0.2
	cygwin-1_7_22-release:1.386
	cygwin-1_7_21-release:1.384
	cygwin-1_7_20-release:1.382
	cygwin-1_7_19-release:1.381
	cygwin-64bit-postmerge:1.377
	cygwin-64bit-premerge-branch:1.376.0.2
	cygwin-64bit-premerge:1.376
	cygwin-1_7_18-release:1.375
	post-ptmalloc3:1.372.2.5
	pre-ptmalloc3:1.372.2.5
	cygwin-1_7_17-release:1.372
	cygwin-64bit-branch:1.372.0.2
	cygwin-1_7_16-release:1.371
	cygwin-1_7_15-release:1.368
	cygwin-1_7_14_2-release:1.367
	cygwin-1_7_14-release:1.367
	cygwin-1_7_12-release:1.365
	cygwin-1_7_11-release:1.364
	cygwin-1_7_10-release:1.362
	signal-rewrite:1.352.0.2
	pre-notty:1.349
	cygwin-1_7_9-release:1.337
	cv-post-1_7_9:1.336.0.2
	cygwin-1_7_8-release:1.335
	cygwin-1_7_7-release:1.325
	cygwin-1_7_5-release:1.315
	cygwin-1_7_4-release:1.314
	cygwin-1_7_3-release:1.313
	cygwin-1_7_2-release:1.312
	fifo_doover3:1.305.0.2
	cygwin-1_7_1-release:1.304
	prefifo:1.297
	cv-branch-2:1.295.0.2
	pre-ripout-set_console_state_for_spawn:1.266
	EOL_registry_mounts:1.259
	preoverlapped:1.250
	drop_9x_support_start:1.240
	cr-0x5f1:1.232.0.2
	cv-branch:1.231.0.2
	pre-ptymaster-archetype:1.229
	cr-0x3b58:1.221.0.4
	cr-0x5ef:1.221.0.2
	after-mmap-privanon-noreserve:1.213
	after-mmap-revamp:1.213
	before-mmap-revamp:1.213
	cgf-more-exit-sync:1.207
	post_wait_sig_exit:1.204
	pre_wait_sig_exit:1.204
	reparent-point:1.171
	noreparent:1.171.0.2
	cr-0x5e6:1.168.0.2
	cr-0x9e:1.152.0.6
	cr-0x9d:1.152.0.4
	cgf-deleteme:1.152.0.2
	pre-sigrewrite:1.146
	corinna-01:1.144
	cr-0x9c:1.133.2.1.0.2
	cr-0x9b:1.133.0.2
	cr-0x99:1.128
	Z-emcb-cygwin_daemon:1.128.0.2
	w32api-2_2:1.100
	mingw-runtime-2_4:1.99
	pre-cgf-merge:1.136
	cgf-dev-branch:1.95.0.2
	predaemon:1.62
	cygwin_daemon_merge_HEAD:1.62
	pregp02r1:1.61.0.2
	cygnus_cvs_20020108_pre:1.56
	Z-cygwin_daemon_merge-new_HEAD:1.76
	Z-cygwin_daemon_merge_HEAD:1.76
	cygwin_daemon:1.48.0.2;
locks; strict;
comment	@ * @;
expand	@o@;


1.422
date	2015.03.04.11.46.02;	author corinna;	state Exp;
branches;
next	1.421;

1.421
date	2015.03.03.12.58.34;	author corinna;	state Exp;
branches;
next	1.420;

1.420
date	2015.02.06.17.09.50;	author corinna;	state Exp;
branches;
next	1.419;

1.419
date	2015.02.06.17.08.10;	author corinna;	state Exp;
branches;
next	1.418;

1.418
date	2015.02.04.11.03.36;	author corinna;	state Exp;
branches;
next	1.417;

1.417
date	2015.01.20.18.23.20;	author corinna;	state Exp;
branches;
next	1.416;

1.416
date	2014.12.18.16.54.10;	author yselkowitz;	state Exp;
branches;
next	1.415;

1.415
date	2014.12.08.11.21.14;	author corinna;	state Exp;
branches;
next	1.414;

1.414
date	2014.12.05.16.31.36;	author yselkowitz;	state Exp;
branches;
next	1.413;

1.413
date	2014.11.13.13.10.25;	author corinna;	state Exp;
branches;
next	1.412;

1.412
date	2014.11.12.11.19.08;	author corinna;	state Exp;
branches;
next	1.411;

1.411
date	2014.11.06.15.32.21;	author corinna;	state Exp;
branches;
next	1.410;

1.410
date	2014.10.22.19.03.02;	author yselkowitz;	state Exp;
branches;
next	1.409;

1.409
date	2014.10.17.08.19.27;	author corinna;	state Exp;
branches;
next	1.408;

1.408
date	2014.10.11.18.28.04;	author corinna;	state Exp;
branches;
next	1.407;

1.407
date	2014.10.08.21.03.40;	author corinna;	state Exp;
branches;
next	1.406;

1.406
date	2014.08.13.17.38.47;	author corinna;	state Exp;
branches;
next	1.405;

1.405
date	2014.08.07.16.25.06;	author yselkowitz;	state Exp;
branches;
next	1.404;

1.404
date	2014.08.04.16.52.04;	author corinna;	state Exp;
branches;
next	1.403;

1.403
date	2014.07.21.11.08.07;	author corinna;	state Exp;
branches;
next	1.402;

1.402
date	2014.07.15.08.45.10;	author corinna;	state Exp;
branches;
next	1.401;

1.401
date	2014.05.19.14.31.08;	author corinna;	state Exp;
branches;
next	1.400;

1.400
date	2014.05.15.11.24.42;	author corinna;	state Exp;
branches;
next	1.399;

1.399
date	2014.04.10.19.20.49;	author corinna;	state Exp;
branches;
next	1.398;

1.398
date	2014.03.05.12.45.49;	author corinna;	state Exp;
branches;
next	1.397;

1.397
date	2014.02.04.16.32.04;	author corinna;	state Exp;
branches
	1.397.2.1;
next	1.396;

1.396
date	2013.12.08.13.42.16;	author corinna;	state Exp;
branches;
next	1.395;

1.395
date	2013.11.29.13.31.54;	author cgf;	state Exp;
branches;
next	1.394;

1.394
date	2013.11.26.17.11.08;	author corinna;	state Exp;
branches;
next	1.393;

1.393
date	2013.09.25.16.17.59;	author cgf;	state Exp;
branches;
next	1.392;

1.392
date	2013.08.31.18.05.31;	author corinna;	state Exp;
branches;
next	1.391;

1.391
date	2013.08.21.20.28.12;	author corinna;	state Exp;
branches;
next	1.390;

1.390
date	2013.08.14.11.44.22;	author corinna;	state Exp;
branches;
next	1.389;

1.389
date	2013.08.09.09.12.55;	author corinna;	state Exp;
branches;
next	1.388;

1.388
date	2013.07.24.14.21.13;	author corinna;	state Exp;
branches
	1.388.2.1;
next	1.387;

1.387
date	2013.07.22.15.08.54;	author corinna;	state Exp;
branches;
next	1.386;

1.386
date	2013.07.19.17.28.34;	author cgf;	state Exp;
branches;
next	1.385;

1.385
date	2013.07.15.11.44.04;	author corinna;	state Exp;
branches;
next	1.384;

1.384
date	2013.06.24.15.12.40;	author yselkowitz;	state Exp;
branches;
next	1.383;

1.383
date	2013.06.07.09.21.53;	author corinna;	state Exp;
branches;
next	1.382;

1.382
date	2013.06.05.09.37.53;	author corinna;	state Exp;
branches;
next	1.381;

1.381
date	2013.05.21.19.04.49;	author corinna;	state Exp;
branches;
next	1.380;

1.380
date	2013.05.21.10.07.55;	author corinna;	state Exp;
branches;
next	1.379;

1.379
date	2013.05.13.19.27.34;	author cgf;	state Exp;
branches;
next	1.378;

1.378
date	2013.04.23.19.36.21;	author corinna;	state Exp;
branches;
next	1.377;

1.377
date	2013.04.23.09.44.35;	author corinna;	state Exp;
branches;
next	1.376;

1.376
date	2013.04.22.10.13.30;	author corinna;	state Exp;
branches;
next	1.375;

1.375
date	2013.01.21.04.38.30;	author cgf;	state Exp;
branches;
next	1.374;

1.374
date	2012.11.21.20.13.06;	author yselkowitz;	state Exp;
branches;
next	1.373;

1.373
date	2012.10.21.10.20.53;	author corinna;	state Exp;
branches;
next	1.372;

1.372
date	2012.07.21.17.13.42;	author cgf;	state Exp;
branches
	1.372.2.1;
next	1.371;

1.371
date	2012.07.18.11.17.25;	author corinna;	state Exp;
branches;
next	1.370;

1.370
date	2012.05.10.08.35.22;	author corinna;	state Exp;
branches;
next	1.369;

1.369
date	2012.05.10.06.51.40;	author corinna;	state Exp;
branches;
next	1.368;

1.368
date	2012.04.24.16.05.20;	author corinna;	state Exp;
branches;
next	1.367;

1.367
date	2012.04.05.15.26.27;	author corinna;	state Exp;
branches;
next	1.366;

1.366
date	2012.04.03.14.54.17;	author corinna;	state Exp;
branches;
next	1.365;

1.365
date	2012.02.25.17.32.38;	author cgf;	state Exp;
branches;
next	1.364;

1.364
date	2012.02.22.01.58.24;	author yselkowitz;	state Exp;
branches;
next	1.363;

1.363
date	2012.02.07.16.50.19;	author cgf;	state Exp;
branches;
next	1.362;

1.362
date	2012.01.28.14.44.23;	author corinna;	state Exp;
branches;
next	1.361;

1.361
date	2012.01.11.19.07.11;	author cgf;	state Exp;
branches;
next	1.360;

1.360
date	2012.01.06.07.12.18;	author yselkowitz;	state Exp;
branches;
next	1.359;

1.359
date	2012.01.01.18.54.25;	author yselkowitz;	state Exp;
branches;
next	1.358;

1.358
date	2011.12.30.20.22.28;	author yselkowitz;	state Exp;
branches;
next	1.357;

1.357
date	2011.12.22.12.25.10;	author corinna;	state Exp;
branches;
next	1.356;

1.356
date	2011.11.07.20.05.49;	author cgf;	state Exp;
branches;
next	1.355;

1.355
date	2011.10.28.09.26.42;	author corinna;	state Exp;
branches;
next	1.354;

1.354
date	2011.10.11.23.20.38;	author cgf;	state Exp;
branches;
next	1.353;

1.353
date	2011.10.05.12.27.36;	author corinna;	state Exp;
branches;
next	1.352;

1.352
date	2011.08.16.14.48.38;	author corinna;	state Exp;
branches;
next	1.351;

1.351
date	2011.08.03.19.17.02;	author yselkowitz;	state Exp;
branches;
next	1.350;

1.350
date	2011.07.21.09.39.22;	author yselkowitz;	state Exp;
branches;
next	1.349;

1.349
date	2011.05.19.07.23.29;	author yselkowitz;	state Exp;
branches;
next	1.348;

1.348
date	2011.05.18.01.25.41;	author yselkowitz;	state Exp;
branches;
next	1.347;

1.347
date	2011.05.17.17.08.10;	author yselkowitz;	state Exp;
branches;
next	1.346;

1.346
date	2011.05.15.18.49.40;	author corinna;	state Exp;
branches;
next	1.345;

1.345
date	2011.05.09.08.57.46;	author yselkowitz;	state Exp;
branches;
next	1.344;

1.344
date	2011.05.06.18.53.21;	author yselkowitz;	state Exp;
branches;
next	1.343;

1.343
date	2011.05.04.22.12.15;	author yselkowitz;	state Exp;
branches;
next	1.342;

1.342
date	2011.05.03.01.13.37;	author yselkowitz;	state Exp;
branches;
next	1.341;

1.341
date	2011.04.18.12.00.04;	author corinna;	state Exp;
branches;
next	1.340;

1.340
date	2011.04.15.09.22.14;	author yselkowitz;	state Exp;
branches;
next	1.339;

1.339
date	2011.03.29.10.32.40;	author corinna;	state Exp;
branches;
next	1.338;

1.338
date	2011.03.29.10.24.19;	author corinna;	state Exp;
branches;
next	1.337;

1.337
date	2011.03.28.14.55.20;	author corinna;	state Exp;
branches;
next	1.336;

1.336
date	2011.03.01.22.35.00;	author cgf;	state Exp;
branches
	1.336.2.1;
next	1.335;

1.335
date	2011.02.22.08.58.15;	author corinna;	state Exp;
branches;
next	1.334;

1.334
date	2011.02.10.17.36.51;	author ericb;	state Exp;
branches;
next	1.333;

1.333
date	2011.02.10.10.51.14;	author yselkowitz;	state Exp;
branches;
next	1.332;

1.332
date	2011.01.12.13.01.43;	author corinna;	state Exp;
branches;
next	1.331;

1.331
date	2010.12.27.17.29.25;	author cgf;	state Exp;
branches;
next	1.330;

1.330
date	2010.11.15.12.44.57;	author corinna;	state Exp;
branches;
next	1.329;

1.329
date	2010.10.27.14.22.27;	author cgf;	state Exp;
branches;
next	1.328;

1.328
date	2010.10.08.10.51.17;	author corinna;	state Exp;
branches;
next	1.327;

1.327
date	2010.09.11.06.53.28;	author davek;	state Exp;
branches;
next	1.326;

1.326
date	2010.09.01.07.16.49;	author corinna;	state Exp;
branches;
next	1.325;

1.325
date	2010.08.31.07.47.51;	author corinna;	state Exp;
branches;
next	1.324;

1.324
date	2010.08.27.17.58.44;	author corinna;	state Exp;
branches;
next	1.323;

1.323
date	2010.08.24.15.25.46;	author corinna;	state Exp;
branches;
next	1.322;

1.322
date	2010.08.18.19.15.37;	author cgf;	state Exp;
branches;
next	1.321;

1.321
date	2010.08.16.13.41.19;	author corinna;	state Exp;
branches;
next	1.320;

1.320
date	2010.08.09.16.47.48;	author yselkowitz;	state Exp;
branches;
next	1.319;

1.319
date	2010.07.19.18.22.40;	author ericb;	state Exp;
branches;
next	1.318;

1.318
date	2010.07.04.17.12.26;	author cgf;	state Exp;
branches;
next	1.317;

1.317
date	2010.05.07.21.25.19;	author cgf;	state Exp;
branches;
next	1.316;

1.316
date	2010.04.28.10.20.34;	author corinna;	state Exp;
branches;
next	1.315;

1.315
date	2010.04.12.17.01.01;	author corinna;	state Exp;
branches;
next	1.314;

1.314
date	2010.04.07.08.55.38;	author corinna;	state Exp;
branches;
next	1.313;

1.313
date	2010.03.29.15.06.09;	author corinna;	state Exp;
branches;
next	1.312;

1.312
date	2010.03.04.09.37.52;	author corinna;	state Exp;
branches;
next	1.311;

1.311
date	2010.03.03.15.05.19;	author corinna;	state Exp;
branches;
next	1.310;

1.310
date	2010.02.26.05.43.50;	author yselkowitz;	state Exp;
branches;
next	1.309;

1.309
date	2010.02.08.09.52.40;	author corinna;	state Exp;
branches;
next	1.308;

1.308
date	2010.01.22.22.31.31;	author corinna;	state Exp;
branches;
next	1.307;

1.307
date	2010.01.15.15.40.05;	author corinna;	state Exp;
branches;
next	1.306;

1.306
date	2010.01.14.18.46.02;	author corinna;	state Exp;
branches;
next	1.305;

1.305
date	2009.12.09.16.52.43;	author cgf;	state Exp;
branches;
next	1.304;

1.304
date	2009.12.06.12.24.34;	author corinna;	state Exp;
branches;
next	1.303;

1.303
date	2009.11.12.14.40.48;	author corinna;	state Exp;
branches;
next	1.302;

1.302
date	2009.10.31.13.24.06;	author corinna;	state Exp;
branches;
next	1.301;

1.301
date	2009.10.13.12.08.22;	author corinna;	state Exp;
branches;
next	1.300;

1.300
date	2009.10.06.21.51.17;	author cwilson;	state Exp;
branches;
next	1.299;

1.299
date	2009.09.26.21.01.10;	author ericb;	state Exp;
branches;
next	1.298;

1.298
date	2009.09.25.23.55.00;	author ericb;	state Exp;
branches;
next	1.297;

1.297
date	2009.07.07.20.12.44;	author davek;	state Exp;
branches;
next	1.296;

1.296
date	2009.07.03.13.01.17;	author corinna;	state Exp;
branches;
next	1.295;

1.295
date	2009.05.09.20.16.06;	author cgf;	state Exp;
branches;
next	1.294;

1.294
date	2009.03.31.09.42.58;	author corinna;	state Exp;
branches;
next	1.293;

1.293
date	2009.03.23.09.46.38;	author corinna;	state Exp;
branches;
next	1.292;

1.292
date	2009.03.19.09.22.01;	author corinna;	state Exp;
branches;
next	1.291;

1.291
date	2009.03.15.13.45.02;	author corinna;	state Exp;
branches;
next	1.290;

1.290
date	2009.03.11.13.00.28;	author corinna;	state Exp;
branches;
next	1.289;

1.289
date	2009.03.11.12.03.44;	author corinna;	state Exp;
branches;
next	1.288;

1.288
date	2009.03.09.14.40.45;	author corinna;	state Exp;
branches;
next	1.287;

1.287
date	2009.03.09.13.22.37;	author corinna;	state Exp;
branches;
next	1.286;

1.286
date	2009.03.06.16.31.25;	author corinna;	state Exp;
branches;
next	1.285;

1.285
date	2009.03.06.10.09.55;	author corinna;	state Exp;
branches;
next	1.284;

1.284
date	2009.02.19.09.22.51;	author corinna;	state Exp;
branches;
next	1.283;

1.283
date	2009.02.18.17.38.16;	author corinna;	state Exp;
branches;
next	1.282;

1.282
date	2009.02.16.20.22.37;	author corinna;	state Exp;
branches;
next	1.281;

1.281
date	2009.02.16.15.36.01;	author corinna;	state Exp;
branches;
next	1.280;

1.280
date	2009.02.13.18.39.37;	author corinna;	state Exp;
branches;
next	1.279;

1.279
date	2009.02.13.08.33.11;	author corinna;	state Exp;
branches;
next	1.278;

1.278
date	2009.02.11.16.06.39;	author corinna;	state Exp;
branches;
next	1.277;

1.277
date	2009.02.05.17.30.17;	author corinna;	state Exp;
branches;
next	1.276;

1.276
date	2009.01.16.12.17.28;	author corinna;	state Exp;
branches;
next	1.275;

1.275
date	2009.01.09.05.18.02;	author cgf;	state Exp;
branches;
next	1.274;

1.274
date	2008.12.31.21.47.45;	author cgf;	state Exp;
branches;
next	1.273;

1.273
date	2008.12.15.12.40.29;	author corinna;	state Exp;
branches;
next	1.272;

1.272
date	2008.11.29.01.39.53;	author cgf;	state Exp;
branches;
next	1.271;

1.271
date	2008.11.26.17.21.04;	author cgf;	state Exp;
branches;
next	1.270;

1.270
date	2008.11.26.10.18.10;	author corinna;	state Exp;
branches;
next	1.269;

1.269
date	2008.09.12.22.32.07;	author cgf;	state Exp;
branches;
next	1.268;

1.268
date	2008.07.29.14.07.21;	author cgf;	state Exp;
branches;
next	1.267;

1.267
date	2008.07.29.10.40.36;	author corinna;	state Exp;
branches;
next	1.266;

1.266
date	2008.06.11.09.43.59;	author corinna;	state Exp;
branches;
next	1.265;

1.265
date	2008.04.24.09.59.54;	author corinna;	state Exp;
branches;
next	1.264;

1.264
date	2008.04.23.11.13.52;	author corinna;	state Exp;
branches;
next	1.263;

1.263
date	2008.04.22.16.55.23;	author corinna;	state Exp;
branches;
next	1.262;

1.262
date	2008.04.21.14.00.24;	author corinna;	state Exp;
branches;
next	1.261;

1.261
date	2008.04.21.12.46.58;	author corinna;	state Exp;
branches;
next	1.260;

1.260
date	2008.04.10.09.27.58;	author corinna;	state Exp;
branches;
next	1.259;

1.259
date	2008.04.01.13.22.47;	author corinna;	state Exp;
branches;
next	1.258;

1.258
date	2008.03.24.14.48.58;	author corinna;	state Exp;
branches;
next	1.257;

1.257
date	2008.03.12.12.41.50;	author corinna;	state Exp;
branches;
next	1.256;

1.256
date	2008.02.15.17.53.11;	author cgf;	state Exp;
branches;
next	1.255;

1.255
date	2008.02.10.15.43.04;	author corinna;	state Exp;
branches;
next	1.254;

1.254
date	2007.12.30.21.12.08;	author davek;	state Exp;
branches;
next	1.253;

1.253
date	2007.12.19.17.38.18;	author corinna;	state Exp;
branches;
next	1.252;

1.252
date	2007.07.10.00.12.54;	author cgf;	state Exp;
branches;
next	1.251;

1.251
date	2007.07.06.20.05.44;	author corinna;	state Exp;
branches;
next	1.250;

1.250
date	2007.06.29.15.13.00;	author corinna;	state Exp;
branches;
next	1.249;

1.249
date	2007.06.28.22.45.49;	author briand;	state Exp;
branches;
next	1.248;

1.248
date	2007.06.28.17.55.01;	author corinna;	state Exp;
branches;
next	1.247;

1.247
date	2007.06.27.12.46.35;	author ericb;	state Exp;
branches;
next	1.246;

1.246
date	2007.06.21.15.57.54;	author corinna;	state Exp;
branches;
next	1.245;

1.245
date	2007.06.21.07.22.16;	author corinna;	state Exp;
branches;
next	1.244;

1.244
date	2007.06.12.15.24.46;	author corinna;	state Exp;
branches;
next	1.243;

1.243
date	2007.06.11.17.38.27;	author corinna;	state Exp;
branches;
next	1.242;

1.242
date	2007.05.15.01.23.30;	author cgf;	state Exp;
branches;
next	1.241;

1.241
date	2007.03.06.14.48.25;	author corinna;	state Exp;
branches;
next	1.240;

1.240
date	2007.02.20.15.48.04;	author corinna;	state Exp;
branches;
next	1.239;

1.239
date	2007.02.14.10.06.46;	author corinna;	state Exp;
branches;
next	1.238;

1.238
date	2007.02.08.13.36.53;	author corinna;	state Exp;
branches;
next	1.237;

1.237
date	2007.02.07.17.22.40;	author corinna;	state Exp;
branches;
next	1.236;

1.236
date	2007.01.21.22.54.05;	author corinna;	state Exp;
branches;
next	1.235;

1.235
date	2006.12.11.19.59.05;	author corinna;	state Exp;
branches;
next	1.234;

1.234
date	2006.08.07.19.29.14;	author corinna;	state Exp;
branches;
next	1.233;

1.233
date	2006.07.25.19.23.23;	author corinna;	state Exp;
branches;
next	1.232;

1.232
date	2006.07.24.01.28.29;	author cgf;	state Exp;
branches
	1.232.2.1;
next	1.231;

1.231
date	2006.07.02.16.22.59;	author cgf;	state Exp;
branches
	1.231.2.1;
next	1.230;

1.230
date	2006.06.15.17.22.56;	author corinna;	state Exp;
branches;
next	1.229;

1.229
date	2006.03.02.15.33.12;	author cgf;	state Exp;
branches;
next	1.228;

1.228
date	2006.02.28.15.32.48;	author corinna;	state Exp;
branches;
next	1.227;

1.227
date	2006.02.16.18.21.49;	author corinna;	state Exp;
branches;
next	1.226;

1.226
date	2006.02.02.23.16.26;	author cgf;	state Exp;
branches;
next	1.225;

1.225
date	2006.02.02.22.46.37;	author corinna;	state Exp;
branches;
next	1.224;

1.224
date	2006.01.31.08.56.22;	author corinna;	state Exp;
branches;
next	1.223;

1.223
date	2006.01.21.02.24.16;	author cgf;	state Exp;
branches;
next	1.222;

1.222
date	2006.01.17.03.49.04;	author cgf;	state Exp;
branches;
next	1.221;

1.221
date	2006.01.12.15.53.51;	author corinna;	state Exp;
branches;
next	1.220;

1.220
date	2006.01.09.12.37.08;	author corinna;	state Exp;
branches;
next	1.219;

1.219
date	2005.12.22.16.45.15;	author corinna;	state Exp;
branches;
next	1.218;

1.218
date	2005.12.14.15.54.33;	author corinna;	state Exp;
branches;
next	1.217;

1.217
date	2005.12.05.22.30.03;	author cgf;	state Exp;
branches;
next	1.216;

1.216
date	2005.12.05.21.02.53;	author cgf;	state Exp;
branches;
next	1.215;

1.215
date	2005.12.03.04.23.35;	author cgf;	state Exp;
branches;
next	1.214;

1.214
date	2005.11.29.18.25.36;	author corinna;	state Exp;
branches;
next	1.213;

1.213
date	2005.11.18.17.48.23;	author corinna;	state Exp;
branches;
next	1.212;

1.212
date	2005.11.11.16.42.15;	author cgf;	state Exp;
branches;
next	1.211;

1.211
date	2005.11.08.22.08.39;	author cgf;	state Exp;
branches;
next	1.210;

1.210
date	2005.10.22.10.28.02;	author corinna;	state Exp;
branches;
next	1.209;

1.209
date	2005.10.20.14.26.23;	author corinna;	state Exp;
branches;
next	1.208;

1.208
date	2005.10.18.18.51.33;	author corinna;	state Exp;
branches;
next	1.207;

1.207
date	2005.10.17.21.22.18;	author corinna;	state Exp;
branches;
next	1.206;

1.206
date	2005.09.28.19.22.25;	author corinna;	state Exp;
branches;
next	1.205;

1.205
date	2005.09.28.19.02.53;	author corinna;	state Exp;
branches;
next	1.204;

1.204
date	2005.08.28.17.34.25;	author cgf;	state Exp;
branches;
next	1.203;

1.203
date	2005.08.28.17.30.34;	author cgf;	state Exp;
branches;
next	1.202;

1.202
date	2005.08.20.06.19.54;	author cgf;	state Exp;
branches;
next	1.201;

1.201
date	2005.08.08.09.45.42;	author corinna;	state Exp;
branches;
next	1.200;

1.200
date	2005.08.02.09.17.13;	author corinna;	state Exp;
branches;
next	1.199;

1.199
date	2005.07.29.17.04.46;	author cgf;	state Exp;
branches;
next	1.198;

1.198
date	2005.07.09.08.22.39;	author corinna;	state Exp;
branches;
next	1.197;

1.197
date	2005.07.08.08.24.12;	author corinna;	state Exp;
branches;
next	1.196;

1.196
date	2005.07.03.02.03.58;	author cgf;	state Exp;
branches;
next	1.195;

1.195
date	2005.06.18.19.04.25;	author corinna;	state Exp;
branches;
next	1.194;

1.194
date	2005.06.17.20.01.59;	author corinna;	state Exp;
branches;
next	1.193;

1.193
date	2005.06.10.12.11.35;	author corinna;	state Exp;
branches;
next	1.192;

1.192
date	2005.05.26.18.19.26;	author cgf;	state Exp;
branches;
next	1.191;

1.191
date	2005.05.25.03.46.10;	author cgf;	state Exp;
branches;
next	1.190;

1.190
date	2005.05.02.03.50.10;	author cgf;	state Exp;
branches;
next	1.189;

1.189
date	2005.04.26.17.27.40;	author cgf;	state Exp;
branches;
next	1.188;

1.188
date	2005.04.19.08.32.58;	author corinna;	state Exp;
branches;
next	1.187;

1.187
date	2005.04.18.17.25.04;	author cgf;	state Exp;
branches;
next	1.186;

1.186
date	2005.04.16.05.20.01;	author cgf;	state Exp;
branches;
next	1.185;

1.185
date	2005.04.02.21.22.52;	author cgf;	state Exp;
branches;
next	1.184;

1.184
date	2005.03.27.01.57.38;	author cgf;	state Exp;
branches;
next	1.183;

1.183
date	2005.03.23.17.16.16;	author cgf;	state Exp;
branches;
next	1.182;

1.182
date	2005.03.22.11.37.55;	author corinna;	state Exp;
branches;
next	1.181;

1.181
date	2005.03.08.09.18.47;	author corinna;	state Exp;
branches;
next	1.180;

1.180
date	2005.03.03.22.08.12;	author corinna;	state Exp;
branches;
next	1.179;

1.179
date	2005.03.01.20.20.45;	author cgf;	state Exp;
branches;
next	1.178;

1.178
date	2005.02.23.17.39.46;	author corinna;	state Exp;
branches;
next	1.177;

1.177
date	2005.02.23.13.12.42;	author corinna;	state Exp;
branches;
next	1.176;

1.176
date	2005.02.22.19.45.41;	author corinna;	state Exp;
branches;
next	1.175;

1.175
date	2005.02.22.15.35.10;	author corinna;	state Exp;
branches;
next	1.174;

1.174
date	2005.02.22.15.30.09;	author corinna;	state Exp;
branches;
next	1.173;

1.173
date	2005.01.25.22.45.10;	author corinna;	state Exp;
branches;
next	1.172;

1.172
date	2004.12.15.17.28.59;	author corinna;	state Exp;
branches;
next	1.171;

1.171
date	2004.11.11.16.26.13;	author cgf;	state Exp;
branches;
next	1.170;

1.170
date	2004.09.05.16.08.44;	author cgf;	state Exp;
branches;
next	1.169;

1.169
date	2004.06.09.16.03.51;	author cgf;	state Exp;
branches;
next	1.168;

1.168
date	2004.05.25.20.00.19;	author cgf;	state Exp;
branches
	1.168.2.1;
next	1.167;

1.167
date	2004.05.25.16.01.49;	author cgf;	state Exp;
branches;
next	1.166;

1.166
date	2004.05.25.03.21.34;	author cgf;	state Exp;
branches;
next	1.165;

1.165
date	2004.05.17.16.06.02;	author corinna;	state Exp;
branches;
next	1.164;

1.164
date	2004.04.14.09.12.04;	author corinna;	state Exp;
branches;
next	1.163;

1.163
date	2004.03.26.21.43.49;	author corinna;	state Exp;
branches;
next	1.162;

1.162
date	2004.03.19.18.00.08;	author cgf;	state Exp;
branches;
next	1.161;

1.161
date	2004.03.17.16.38.48;	author cgf;	state Exp;
branches;
next	1.160;

1.160
date	2004.03.15.11.37.37;	author corinna;	state Exp;
branches;
next	1.159;

1.159
date	2004.02.26.05.10.49;	author cgf;	state Exp;
branches;
next	1.158;

1.158
date	2004.02.05.19.57.03;	author cgf;	state Exp;
branches;
next	1.157;

1.157
date	2004.01.22.19.16.17;	author cgf;	state Exp;
branches;
next	1.156;

1.156
date	2004.01.22.19.14.07;	author cgf;	state Exp;
branches;
next	1.155;

1.155
date	2004.01.20.19.36.35;	author cgf;	state Exp;
branches;
next	1.154;

1.154
date	2004.01.19.23.03.43;	author cgf;	state Exp;
branches;
next	1.153;

1.153
date	2004.01.19.05.46.54;	author cgf;	state Exp;
branches;
next	1.152;

1.152
date	2004.01.03.18.15.03;	author cgf;	state Exp;
branches
	1.152.2.1
	1.152.6.1;
next	1.151;

1.151
date	2003.12.31.06.30.48;	author cgf;	state Exp;
branches;
next	1.150;

1.150
date	2003.12.23.16.26.31;	author cgf;	state Exp;
branches;
next	1.149;

1.149
date	2003.12.01.17.26.28;	author corinna;	state Exp;
branches;
next	1.148;

1.148
date	2003.11.29.23.00.51;	author corinna;	state Exp;
branches;
next	1.147;

1.147
date	2003.11.28.20.55.59;	author cgf;	state Exp;
branches;
next	1.146;

1.146
date	2003.11.19.18.50.22;	author corinna;	state Exp;
branches;
next	1.145;

1.145
date	2003.11.17.17.25.59;	author corinna;	state Exp;
branches;
next	1.144;

1.144
date	2003.11.08.09.48.48;	author corinna;	state Exp;
branches;
next	1.143;

1.143
date	2003.11.06.21.31.24;	author corinna;	state Exp;
branches;
next	1.142;

1.142
date	2003.11.06.14.33.16;	author corinna;	state Exp;
branches;
next	1.141;

1.141
date	2003.11.04.15.48.19;	author corinna;	state Exp;
branches;
next	1.140;

1.140
date	2003.10.27.13.06.56;	author corinna;	state Exp;
branches;
next	1.139;

1.139
date	2003.10.27.11.48.29;	author corinna;	state Exp;
branches;
next	1.138;

1.138
date	2003.10.22.20.32.20;	author corinna;	state Exp;
branches;
next	1.137;

1.137
date	2003.10.22.10.07.59;	author corinna;	state Exp;
branches;
next	1.136;

1.136
date	2003.09.20.03.15.57;	author cgf;	state Exp;
branches;
next	1.135;

1.135
date	2003.09.14.01.58.03;	author cgf;	state Exp;
branches;
next	1.134;

1.134
date	2003.09.13.17.12.01;	author cgf;	state Exp;
branches;
next	1.133;

1.133
date	2003.09.10.19.13.05;	author corinna;	state Exp;
branches
	1.133.2.1;
next	1.132;

1.132
date	2003.09.10.15.51.59;	author corinna;	state Exp;
branches;
next	1.131;

1.131
date	2003.09.08.20.08.53;	author corinna;	state Exp;
branches;
next	1.130;

1.130
date	2003.09.08.08.53.01;	author corinna;	state Exp;
branches;
next	1.129;

1.129
date	2003.09.01.17.12.29;	author cgf;	state Exp;
branches;
next	1.128;

1.128
date	2003.08.18.15.54.26;	author corinna;	state Exp;
branches;
next	1.127;

1.127
date	2003.08.09.16.32.03;	author cgf;	state Exp;
branches;
next	1.126;

1.126
date	2003.07.28.21.14.25;	author cgf;	state Exp;
branches;
next	1.125;

1.125
date	2003.07.25.16.13.12;	author cgf;	state Exp;
branches;
next	1.124;

1.124
date	2003.07.24.19.33.14;	author cgf;	state Exp;
branches;
next	1.123;

1.123
date	2003.07.10.02.33.27;	author cgf;	state Exp;
branches;
next	1.122;

1.122
date	2003.07.10.02.09.24;	author cgf;	state Exp;
branches;
next	1.121;

1.121
date	2003.07.10.01.58.39;	author cgf;	state Exp;
branches;
next	1.120;

1.120
date	2003.06.16.03.24.13;	author cgf;	state Exp;
branches;
next	1.119;

1.119
date	2003.06.06.08.11.19;	author corinna;	state Exp;
branches;
next	1.118;

1.118
date	2003.05.20.12.38.04;	author corinna;	state Exp;
branches;
next	1.117;

1.117
date	2003.05.09.22.11.25;	author corinna;	state Exp;
branches;
next	1.116;

1.116
date	2003.04.21.04.31.06;	author cgf;	state Exp;
branches;
next	1.115;

1.115
date	2003.04.16.03.03.45;	author cgf;	state Exp;
branches;
next	1.114;

1.114
date	2003.04.10.08.22.42;	author corinna;	state Exp;
branches;
next	1.113;

1.113
date	2003.04.03.08.04.40;	author corinna;	state Exp;
branches;
next	1.112;

1.112
date	2003.03.19.20.13.57;	author corinna;	state Exp;
branches;
next	1.111;

1.111
date	2003.03.18.20.01.07;	author tpfaff;	state Exp;
branches;
next	1.110;

1.110
date	2003.03.17.19.16.15;	author cgf;	state Exp;
branches;
next	1.109;

1.109
date	2003.03.17.19.08.11;	author cgf;	state Exp;
branches;
next	1.108;

1.108
date	2003.03.13.23.11.38;	author cgf;	state Exp;
branches;
next	1.107;

1.107
date	2003.03.09.21.51.00;	author corinna;	state Exp;
branches;
next	1.106;

1.106
date	2003.03.09.20.50.11;	author cgf;	state Exp;
branches;
next	1.105;

1.105
date	2003.03.01.02.02.42;	author cgf;	state Exp;
branches
	1.105.2.1;
next	1.104;

1.104
date	2003.02.22.23.03.26;	author cgf;	state Exp;
branches;
next	1.103;

1.103
date	2003.02.22.19.35.03;	author cgf;	state Exp;
branches;
next	1.102;

1.102
date	2003.02.16.19.31.07;	author cgf;	state Exp;
branches;
next	1.101;

1.101
date	2003.02.15.21.45.09;	author cgf;	state Exp;
branches;
next	1.100;

1.100
date	2003.02.08.17.03.34;	author cgf;	state Exp;
branches;
next	1.99;

1.99
date	2003.01.24.15.23.15;	author corinna;	state Exp;
branches;
next	1.98;

1.98
date	2003.01.22.10.43.39;	author corinna;	state Exp;
branches;
next	1.97;

1.97
date	2003.01.21.05.13.42;	author cgf;	state Exp;
branches;
next	1.96;

1.96
date	2003.01.17.13.08.06;	author corinna;	state Exp;
branches;
next	1.95;

1.95
date	2003.01.10.12.32.49;	author corinna;	state Exp;
branches
	1.95.2.1;
next	1.94;

1.94
date	2003.01.10.12.19.17;	author corinna;	state Exp;
branches;
next	1.93;

1.93
date	2002.12.25.23.39.04;	author cgf;	state Exp;
branches;
next	1.92;

1.92
date	2002.12.06.19.48.03;	author cgf;	state Exp;
branches;
next	1.91;

1.91
date	2002.12.04.20.44.17;	author cgf;	state Exp;
branches;
next	1.90;

1.90
date	2002.11.28.00.40.20;	author cgf;	state Exp;
branches;
next	1.89;

1.89
date	2002.11.27.16.11.40;	author cgf;	state Exp;
branches;
next	1.88;

1.88
date	2002.11.27.02.12.50;	author cgf;	state Exp;
branches;
next	1.87;

1.87
date	2002.11.23.17.43.46;	author cgf;	state Exp;
branches;
next	1.86;

1.86
date	2002.11.22.16.27.32;	author cgf;	state Exp;
branches;
next	1.85;

1.85
date	2002.11.15.19.04.36;	author cgf;	state Exp;
branches;
next	1.84;

1.84
date	2002.11.07.09.08.40;	author corinna;	state Exp;
branches;
next	1.83;

1.83
date	2002.11.07.02.19.52;	author cgf;	state Exp;
branches;
next	1.82;

1.82
date	2002.11.04.05.08.15;	author cgf;	state Exp;
branches;
next	1.81;

1.81
date	2002.10.30.21.06.21;	author cgf;	state Exp;
branches
	1.81.2.1;
next	1.80;

1.80
date	2002.10.23.02.20.38;	author cgf;	state Exp;
branches;
next	1.79;

1.79
date	2002.10.21.01.00.58;	author cgf;	state Exp;
branches;
next	1.78;

1.78
date	2002.10.20.04.42.45;	author cgf;	state Exp;
branches;
next	1.77;

1.77
date	2002.10.14.00.06.33;	author cgf;	state Exp;
branches;
next	1.76;

1.76
date	2002.09.03.12.26.51;	author corinna;	state Exp;
branches;
next	1.75;

1.75
date	2002.08.30.12.18.56;	author corinna;	state Exp;
branches;
next	1.74;

1.74
date	2002.08.28.10.50.27;	author corinna;	state Exp;
branches;
next	1.73;

1.73
date	2002.08.28.10.18.20;	author corinna;	state Exp;
branches;
next	1.72;

1.72
date	2002.08.18.05.49.26;	author cgf;	state Exp;
branches;
next	1.71;

1.71
date	2002.08.16.19.41.39;	author cgf;	state Exp;
branches;
next	1.70;

1.70
date	2002.07.29.12.51.52;	author corinna;	state Exp;
branches;
next	1.69;

1.69
date	2002.07.27.01.52.05;	author cgf;	state Exp;
branches;
next	1.68;

1.68
date	2002.07.24.11.06.46;	author corinna;	state Exp;
branches;
next	1.67;

1.67
date	2002.07.03.22.25.38;	author cgf;	state Exp;
branches;
next	1.66;

1.66
date	2002.07.02.09.40.07;	author corinna;	state Exp;
branches;
next	1.65;

1.65
date	2002.06.26.04.21.01;	author cgf;	state Exp;
branches;
next	1.64;

1.64
date	2002.05.13.19.53.46;	author cgf;	state Exp;
branches;
next	1.63;

1.63
date	2002.04.09.23.47.26;	author cgf;	state Exp;
branches;
next	1.62;

1.62
date	2002.02.27.23.06.55;	author cgf;	state Exp;
branches;
next	1.61;

1.61
date	2002.01.21.20.55.59;	author cgf;	state Exp;
branches;
next	1.60;

1.60
date	2002.01.21.03.36.16;	author cgf;	state Exp;
branches;
next	1.59;

1.59
date	2002.01.19.23.06.28;	author cgf;	state Exp;
branches;
next	1.58;

1.58
date	2002.01.19.16.17.59;	author corinna;	state Exp;
branches;
next	1.57;

1.57
date	2002.01.17.10.39.37;	author corinna;	state Exp;
branches;
next	1.56;

1.56
date	2001.12.28.15.53.27;	author corinna;	state Exp;
branches;
next	1.55;

1.55
date	2001.12.26.04.53.34;	author cgf;	state Exp;
branches;
next	1.54;

1.54
date	2001.12.20.18.54.30;	author cgf;	state Exp;
branches;
next	1.53;

1.53
date	2001.12.03.16.47.18;	author cgf;	state Exp;
branches;
next	1.52;

1.52
date	2001.11.12.00.40.29;	author cgf;	state Exp;
branches
	1.52.2.1;
next	1.51;

1.51
date	2001.11.05.23.13.47;	author cgf;	state Exp;
branches;
next	1.50;

1.50
date	2001.11.05.06.09.13;	author cgf;	state Exp;
branches;
next	1.49;

1.49
date	2001.10.16.16.28.39;	author corinna;	state Exp;
branches;
next	1.48;

1.48
date	2001.09.12.17.46.37;	author corinna;	state Exp;
branches
	1.48.2.1;
next	1.47;

1.47
date	2001.09.11.15.25.08;	author cgf;	state Exp;
branches;
next	1.46;

1.46
date	2001.09.09.12.32.54;	author corinna;	state Exp;
branches;
next	1.45;

1.45
date	2001.09.08.01.35.55;	author cgf;	state Exp;
branches;
next	1.44;

1.44
date	2001.09.07.21.32.06;	author cgf;	state Exp;
branches;
next	1.43;

1.43
date	2001.09.03.16.36.54;	author corinna;	state Exp;
branches;
next	1.42;

1.42
date	2001.08.14.15.05.43;	author cgf;	state Exp;
branches;
next	1.41;

1.41
date	2001.08.07.00.01.42;	author cgf;	state Exp;
branches;
next	1.40;

1.40
date	2001.07.27.16.33.20;	author cgf;	state Exp;
branches;
next	1.39;

1.39
date	2001.07.26.20.42.52;	author cgf;	state Exp;
branches;
next	1.38;

1.38
date	2001.06.10.10.00.21;	author corinna;	state Exp;
branches;
next	1.37;

1.37
date	2001.05.21.15.50.36;	author cgf;	state Exp;
branches;
next	1.36;

1.36
date	2001.04.25.16.18.43;	author duda;	state Exp;
branches;
next	1.35;

1.35
date	2001.04.25.14.59.49;	author cgf;	state Exp;
branches;
next	1.34;

1.34
date	2001.04.23.00.48.23;	author cgf;	state Exp;
branches;
next	1.33;

1.33
date	2001.03.19.11.02.41;	author corinna;	state Exp;
branches;
next	1.32;

1.32
date	2001.03.05.06.28.24;	author cgf;	state Exp;
branches;
next	1.31;

1.31
date	2001.02.20.02.53.55;	author cgf;	state Exp;
branches;
next	1.30;

1.30
date	2001.01.30.23.19.19;	author cgf;	state Exp;
branches;
next	1.29;

1.29
date	2001.01.28.06.26.50;	author cgf;	state Exp;
branches;
next	1.28;

1.28
date	2001.01.22.20.29.24;	author cgf;	state Exp;
branches;
next	1.27;

1.27
date	2001.01.03.14.44.13;	author cgf;	state Exp;
branches;
next	1.26;

1.26
date	2000.12.27.00.13.57;	author corinna;	state Exp;
branches;
next	1.25;

1.25
date	2000.12.25.18.37.44;	author cgf;	state Exp;
branches;
next	1.24;

1.24
date	2000.11.26.19.46.17;	author cgf;	state Exp;
branches;
next	1.23;

1.23
date	2000.11.25.10.29.49;	author corinna;	state Exp;
branches;
next	1.22;

1.22
date	2000.11.08.20.36.37;	author cgf;	state Exp;
branches;
next	1.21;

1.21
date	2000.11.07.02.21.33;	author cgf;	state Exp;
branches;
next	1.20;

1.20
date	2000.11.06.16.40.29;	author cgf;	state Exp;
branches;
next	1.19;

1.19
date	2000.10.30.01.53.02;	author cgf;	state Exp;
branches;
next	1.18;

1.18
date	2000.10.14.08.55.44;	author corinna;	state Exp;
branches;
next	1.17;

1.17
date	2000.10.14.01.03.01;	author cgf;	state Exp;
branches;
next	1.16;

1.16
date	2000.07.29.16.24.51;	author cgf;	state Exp;
branches;
next	1.15;

1.15
date	2000.07.28.03.35.52;	author cgf;	state Exp;
branches
	1.15.2.1;
next	1.14;

1.14
date	2000.07.09.05.29.51;	author cgf;	state Exp;
branches;
next	1.13;

1.13
date	2000.07.04.17.25.11;	author corinna;	state Exp;
branches;
next	1.12;

1.12
date	2000.07.01.03.51.55;	author cgf;	state Exp;
branches;
next	1.11;

1.11
date	2000.06.16.19.36.07;	author corinna;	state Exp;
branches;
next	1.10;

1.10
date	2000.06.08.03.58.51;	author cgf;	state Exp;
branches;
next	1.9;

1.9
date	2000.05.31.18.04.00;	author dj;	state Exp;
branches;
next	1.8;

1.8
date	2000.05.23.23.52.50;	author dj;	state Exp;
branches;
next	1.7;

1.7
date	2000.05.15.04.37.03;	author cgf;	state Exp;
branches;
next	1.6;

1.6
date	2000.05.15.03.42.27;	author cgf;	state Exp;
branches;
next	1.5;

1.5
date	2000.04.13.18.52.12;	author corinna;	state Exp;
branches;
next	1.4;

1.4
date	2000.04.07.00.09.27;	author cgf;	state Exp;
branches;
next	1.3;

1.3
date	2000.03.07.05.33.09;	author cgf;	state Exp;
branches;
next	1.2;

1.2
date	2000.02.26.01.14.49;	author cgf;	state Exp;
branches;
next	1.1;

1.1
date	2000.02.17.19.38.31;	author cgf;	state Exp;
branches
	1.1.1.1;
next	;

1.397.2.1
date	2014.03.09.18.56.20;	author cgf;	state Exp;
branches;
next	1.397.2.2;

1.397.2.2
date	2014.05.19.14.27.25;	author corinna;	state Exp;
branches;
next	1.397.2.3;

1.397.2.3
date	2014.05.19.14.30.23;	author corinna;	state Exp;
branches;
next	1.397.2.4;

1.397.2.4
date	2014.07.16.09.54.57;	author corinna;	state Exp;
branches;
next	1.397.2.5;

1.397.2.5
date	2014.08.13.17.39.11;	author corinna;	state Exp;
branches;
next	1.397.2.6;

1.397.2.6
date	2014.11.13.12.53.09;	author corinna;	state Exp;
branches;
next	;

1.388.2.1
date	2013.07.31.14.50.09;	author cgf;	state Exp;
branches;
next	;

1.372.2.1
date	2012.10.22.17.29.00;	author corinna;	state Exp;
branches;
next	1.372.2.2;

1.372.2.2
date	2012.11.22.11.05.50;	author corinna;	state Exp;
branches;
next	1.372.2.3;

1.372.2.3
date	2013.01.21.13.52.13;	author corinna;	state Exp;
branches;
next	1.372.2.4;

1.372.2.4
date	2013.02.08.14.18.12;	author corinna;	state Exp;
branches;
next	1.372.2.5;

1.372.2.5
date	2013.02.15.13.36.52;	author corinna;	state Exp;
branches;
next	1.372.2.6;

1.372.2.6
date	2013.03.28.15.21.38;	author corinna;	state Exp;
branches;
next	1.372.2.7;

1.372.2.7
date	2013.03.28.15.21.56;	author corinna;	state Exp;
branches;
next	1.372.2.8;

1.372.2.8
date	2013.04.22.10.42.07;	author corinna;	state Exp;
branches;
next	;

1.336.2.1
date	2011.03.11.11.37.50;	author corinna;	state Exp;
branches;
next	1.336.2.2;

1.336.2.2
date	2011.03.28.20.16.57;	author corinna;	state Exp;
branches;
next	;

1.232.2.1
date	2006.11.14.10.13.58;	author corinna;	state Exp;
branches;
next	1.232.2.2;

1.232.2.2
date	2006.12.19.10.17.49;	author corinna;	state Exp;
branches;
next	1.232.2.3;

1.232.2.3
date	2007.11.14.16.03.16;	author corinna;	state Exp;
branches;
next	;

1.231.2.1
date	2006.07.06.14.04.33;	author corinna;	state Exp;
branches;
next	1.231.2.2;

1.231.2.2
date	2006.07.12.13.30.47;	author corinna;	state Exp;
branches;
next	1.231.2.3;

1.231.2.3
date	2006.07.18.12.31.00;	author corinna;	state Exp;
branches;
next	1.231.2.4;

1.231.2.4
date	2006.07.24.11.46.29;	author corinna;	state Exp;
branches;
next	;

1.168.2.1
date	2004.05.25.20.10.53;	author cgf;	state Exp;
branches;
next	1.168.2.2;

1.168.2.2
date	2004.05.26.02.03.00;	author cgf;	state Exp;
branches;
next	;

1.152.2.1
date	2004.01.19.05.38.24;	author cgf;	state Exp;
branches;
next	1.152.2.2;

1.152.2.2
date	2004.01.19.15.46.43;	author cgf;	state Exp;
branches;
next	;

1.152.6.1
date	2004.01.22.20.41.28;	author cgf;	state Exp;
branches;
next	1.152.6.2;

1.152.6.2
date	2004.01.23.15.32.23;	author cgf;	state Exp;
branches;
next	;

1.133.2.1
date	2003.09.19.04.11.04;	author cgf;	state Exp;
branches;
next	;

1.105.2.1
date	2003.03.13.23.14.02;	author cgf;	state Exp;
branches;
next	1.105.2.2;

1.105.2.2
date	2003.03.17.19.13.47;	author cgf;	state Exp;
branches;
next	;

1.95.2.1
date	2003.01.24.04.04.20;	author cgf;	state Exp;
branches;
next	1.95.2.2;

1.95.2.2
date	2003.01.25.01.18.28;	author cgf;	state Exp;
branches;
next	1.95.2.3;

1.95.2.3
date	2003.02.09.05.46.40;	author cgf;	state Exp;
branches;
next	1.95.2.4;

1.95.2.4
date	2003.02.15.22.05.06;	author cgf;	state Exp;
branches;
next	1.95.2.5;

1.95.2.5
date	2003.02.16.19.31.25;	author cgf;	state Exp;
branches;
next	1.95.2.6;

1.95.2.6
date	2003.02.23.06.00.23;	author cgf;	state Exp;
branches;
next	1.95.2.7;

1.95.2.7
date	2003.03.01.02.05.42;	author cgf;	state Exp;
branches;
next	1.95.2.8;

1.95.2.8
date	2003.03.09.20.53.46;	author cgf;	state Exp;
branches;
next	1.95.2.9;

1.95.2.9
date	2003.03.10.00.07.01;	author cgf;	state Exp;
branches;
next	1.95.2.10;

1.95.2.10
date	2003.03.19.19.59.57;	author cgf;	state Exp;
branches;
next	1.95.2.11;

1.95.2.11
date	2003.03.21.15.15.19;	author cgf;	state Exp;
branches;
next	1.95.2.12;

1.95.2.12
date	2003.04.04.05.58.29;	author cgf;	state Exp;
branches;
next	1.95.2.13;

1.95.2.13
date	2003.05.10.17.20.55;	author cgf;	state Exp;
branches;
next	1.95.2.14;

1.95.2.14
date	2003.07.06.05.10.44;	author cgf;	state Exp;
branches;
next	1.95.2.15;

1.95.2.15
date	2003.07.10.01.58.56;	author cgf;	state Exp;
branches;
next	1.95.2.16;

1.95.2.16
date	2003.08.06.03.58.58;	author cgf;	state Exp;
branches;
next	1.95.2.17;

1.95.2.17
date	2003.08.27.20.19.56;	author cgf;	state Exp;
branches;
next	1.95.2.18;

1.95.2.18
date	2003.09.02.02.31.09;	author cgf;	state Exp;
branches;
next	1.95.2.19;

1.95.2.19
date	2003.09.10.16.23.40;	author cgf;	state Exp;
branches;
next	1.95.2.20;

1.95.2.20
date	2003.09.11.04.47.23;	author cgf;	state Exp;
branches;
next	1.95.2.21;

1.95.2.21
date	2003.09.14.01.35.38;	author cgf;	state Exp;
branches;
next	1.95.2.22;

1.95.2.22
date	2003.09.14.18.54.10;	author cgf;	state Exp;
branches;
next	;

1.81.2.1
date	2002.11.07.03.47.47;	author cgf;	state Exp;
branches;
next	;

1.52.2.1
date	2001.11.12.19.09.21;	author cgf;	state Exp;
branches;
next	;

1.48.2.1
date	2002.01.04.03.56.15;	author rbcollins;	state Exp;
branches;
next	1.48.2.2;

1.48.2.2
date	2002.01.22.04.52.42;	author rbcollins;	state Exp;
branches;
next	1.48.2.3;

1.48.2.3
date	2002.02.28.12.53.30;	author rbcollins;	state Exp;
branches;
next	1.48.2.4;

1.48.2.4
date	2002.06.13.14.34.19;	author rbcollins;	state Exp;
branches;
next	1.48.2.5;

1.48.2.5
date	2002.06.27.11.30.19;	author scottc;	state Exp;
branches;
next	1.48.2.6;

1.48.2.6
date	2002.07.02.10.58.25;	author scottc;	state Exp;
branches;
next	1.48.2.7;

1.48.2.7
date	2002.07.04.20.09.50;	author scottc;	state Exp;
branches;
next	1.48.2.8;

1.48.2.8
date	2002.07.26.19.03.37;	author scottc;	state Exp;
branches;
next	1.48.2.9;

1.48.2.9
date	2002.07.29.10.54.15;	author scottc;	state Exp;
branches;
next	1.48.2.10;

1.48.2.10
date	2002.07.30.13.31.47;	author scottc;	state Exp;
branches;
next	1.48.2.11;

1.48.2.11
date	2002.08.16.21.46.49;	author scottc;	state Exp;
branches;
next	1.48.2.12;

1.48.2.12
date	2002.08.18.12.09.28;	author scottc;	state Exp;
branches;
next	1.48.2.13;

1.48.2.13
date	2002.08.28.16.09.15;	author scottc;	state Exp;
branches;
next	1.48.2.14;

1.48.2.14
date	2002.08.30.22.08.50;	author scottc;	state Exp;
branches;
next	1.48.2.15;

1.48.2.15
date	2002.09.03.13.52.07;	author scottc;	state Exp;
branches;
next	;

1.15.2.1
date	2000.07.29.16.15.05;	author cgf;	state Exp;
branches;
next	;

1.1.1.1
date	2000.02.17.19.38.31;	author cgf;	state Exp;
branches;
next	;


desc
@@


1.422
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 36.
@
text
@/* version.h -- Cygwin version numbers and accompanying documentation.

   Copyright 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006,
   2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015 Red Hat, Inc.

This file is part of Cygwin.

This software is a copyrighted work licensed under the terms of the
Cygwin license.  Please consult the file "CYGWIN_LICENSE" for
details. */

/* Cygwin versioning is relatively complicated because of its status
   as a shared library.  Let's start with how versioning used to be done.

   Historical versioning in Cygwin 16.0 to 19.5:

   In the olden days of Cygwin, we had a dll major and minor version
   and a registry version.  The major number started at 16 because the
   "b15" GNU-Win32 release of the compiler tools was out when this
   scheme was started.  We incremented the DLL name frequently (for
   every official release) and towards the end of this period every
   release used a different shared memory area to prevent DLLs from
   interfering with each other (embedding a build timestamp into the
   name of the shared memory area).  This turned out to be a Bad Idea
   (tm) because people needed to mingle separate releases and have
   them work together more than we thought they would.  This was
   especially problematic when tty info needed to be retained when an
   old Cygwin executable executed a newer one.

   In the old scheme, we incremented the major number whenever a
   change to the dll invalidated existing executables.  This can
   happen for a number of reasons, including when functions are
   removed from the export list of the dll.  The minor number was
   incremented when a change was made that we wanted to record, but
   that didn't invalidate existing executables.  Both numbers were
   recorded in the executable and in the dll.

   In October 1998 (starting with Cygwin 19.6), we started a new method
   of Cygwin versioning: */

      /* The DLL major and minor numbers correspond to the "version of
	 the Cygwin shared library".  This version is used to track important
	 changes to the DLL and is mainly informative in nature. */

#define CYGWIN_VERSION_DLL_MAJOR 1007
#define CYGWIN_VERSION_DLL_MINOR 36

      /* Major numbers before CYGWIN_VERSION_DLL_EPOCH are
	 incompatible. */

#define CYGWIN_VERSION_DLL_EPOCH 19

      /* CYGWIN_VERSION_DLL_COMBINED gives us a single number
	 representing the combined DLL major and minor numbers. */

      /* WATCH OUT FOR OCTAL!  Don't use, say, "00020" for 0.20 */

#define CYGWIN_VERSION_DLL_MAKE_COMBINED(maj, min) (((maj) * 1000) + min)
#define CYGWIN_VERSION_DLL_COMBINED \
  CYGWIN_VERSION_DLL_MAKE_COMBINED (CYGWIN_VERSION_DLL_MAJOR, CYGWIN_VERSION_DLL_MINOR)

     /* Every version of cygwin <= this uses an old, incorrect method
	to determine signal masks. */

#define CYGWIN_VERSION_PER_PROCESS_API_VERSION_COMBINED(u) \
  CYGWIN_VERSION_DLL_MAKE_COMBINED ((u)->api_major, (u)->api_minor)

#define CYGWIN_VERSION_USER_API_VERSION_COMBINED \
  CYGWIN_VERSION_PER_PROCESS_API_VERSION_COMBINED (user_data)

    /* API versions <= this had a termios structure whose members were
       too small to accomodate modern settings. */
#define CYGWIN_VERSION_DLL_OLD_TERMIOS		5
#define CYGWIN_VERSION_DLL_IS_OLD_TERMIOS \
  (CYGWIN_VERSION_USER_API_VERSION_COMBINED <= CYGWIN_VERSION_DLL_OLD_TERMIOS)

#define CYGWIN_VERSION_DLL_MALLOC_ENV		28
     /* Old APIs had getc/putc macros that conflict with new CR/LF
	handling in the stdio buffers */
#define CYGWIN_VERSION_OLD_STDIO_CRLF_HANDLING \
  (CYGWIN_VERSION_USER_API_VERSION_COMBINED <= 20)

#define CYGWIN_VERSION_CHECK_FOR_S_IEXEC \
  (CYGWIN_VERSION_USER_API_VERSION_COMBINED >= 36)

#define CYGWIN_VERSION_CHECK_FOR_OLD_O_NONBLOCK \
  (CYGWIN_VERSION_USER_API_VERSION_COMBINED <= 28)

#define CYGWIN_VERSION_CHECK_FOR_USING_BIG_TYPES \
  (CYGWIN_VERSION_USER_API_VERSION_COMBINED >= 79)

#define CYGWIN_VERSION_CHECK_FOR_USING_ANCIENT_MSGHDR \
  (CYGWIN_VERSION_USER_API_VERSION_COMBINED <= 138)

#define CYGWIN_VERSION_CHECK_FOR_USING_WINSOCK1_VALUES \
  (CYGWIN_VERSION_USER_API_VERSION_COMBINED <= 138)

#define CYGWIN_VERSION_CHECK_FOR_OLD_IFREQ \
  (CYGWIN_VERSION_USER_API_VERSION_COMBINED <= 161)

#define CYGWIN_VERSION_CHECK_FOR_OLD_CTYPE \
  (CYGWIN_VERSION_USER_API_VERSION_COMBINED <= 209)

#define CYGWIN_VERSION_USE_PSEUDO_RELOC_IN_DLL(u) \
  (CYGWIN_VERSION_PER_PROCESS_API_VERSION_COMBINED (u) >= 227)

#define CYGWIN_VERSION_CHECK_FOR_EXTRA_TM_MEMBERS \
  (CYGWIN_VERSION_USER_API_VERSION_COMBINED >= 272)

#define CYGWIN_VERSION_CYGWIN_CONV 181

     /* API_MAJOR 0.0: Initial version.  API_MINOR changes:
	1: Export cygwin32_ calls as cygwin_ as well.
	2: Export j1, jn, y1, yn.
	3: Export dll_noncygwin_dllcrt0.
	4: New socket ioctls, revamped ifconf support.
	5: Thread support/exports.
	6: Change in termios handling.
	7: Export scandir and alphasort.
	8: Export _ctype_, _sys_errlist, _sys_nerr.
	9: Mount-related changes, new cygwin_umount export.
	   Raw device support (tape, floppies).
       10: Fast math routine support added.
       11: Export seekdir, telldir.
       12: Export pthread_join, pthread_detach.
       13: Export math funcs gamma and friends, also _j0, _j1, etc.
       14: Export snprintf and vnsprintf.
       15: Export glob
       16: Export cygwin_stackdump
       17: Export fast math stuff
       18: Stop exporting _strace_wm
       19: Export fchown, lchown, lacl
       20: regsub, inet_network
       21: incompatible change to stdio cr/lf and buffering
       22: Export cygwin_logon_user, cygwin_set_impersonation_token.
	   geteuid, getegid return effective uid/gid.
	   getuid, getgid return real uid/gid.
	   seteuid, setegid set only effective uid/gid.
	   setuid, setgid set effective and real uid/gid.
       23: Export new dll_crt0 interface and cygwin_user_data for use
	   with crt0 startup code.
       24: Export poll and _poll.
       25: Export getmode and _getmode.
       26: CW_GET_CYGDRIVE_PREFIXES addition to external.cc
       27: CW_GETPINFO_FULL addition to external.cc
       28: Accidentally bumped by cgf
       29: Export hstrerror
       30: CW_GET_CYGDRIVE_INFO addition to external.cc
       31: Export inet_aton
       32: Export getrlimit/setrlimit
       33: Export setlogmask
       34: Separated out mount table
       35: Export drand48, erand48, jrand48, lcong48, lrand48,
	   mrand48, nrand48, seed48, and srand48.
       36: Added _cygwin_S_IEXEC, et al
       37: [f]pathconv support _PC_POSIX_PERMISSIONS and _PC_POSIX_SECURITY
       38: vscanf, vscanf_r, and random pthread functions
       39: asctime_r, ctime_r, gmtime_r, localtime_r
       40: fchdir
       41: __signgam
       42: sys_errlist, sys_nerr
       43: sigsetjmp, siglongjmp fixed
       44: Export dirfd
       45: perprocess change, gamma_r, gammaf_r, lgamma_r, lgammaf_r
       46: Remove cygwin_getshared
       47: Report EOTWarningZoneSize in struct mtget.
       48: Export "posix" regex functions
       49: Export setutent, endutent, utmpname, getutent, getutid, getutline.
       50: Export fnmatch.
       51: Export recvmsg, sendmsg.
       52: Export strptime
       53: Export strlcat, strlcpy.
       54: Export __fpclassifyd, __fpclassifyf, __signbitd, __signbitf.
       55: Export fcloseall, fcloseall_r.
       56: Make ntsec on by default.
       57: Export setgroups.
       58: Export memalign, valloc, malloc_trim, malloc_usable_size, mallopt,
	   malloc_stats
       59: getsid
       60: MSG_NOSIGNAL
       61: Export getc_unlocked, getchar_unlocked, putc_unlocked,
	   putchar_unlocked
       62: Erroneously bumped
       63: Export pututline
       64: Export fseeko, ftello
       65: Export siginterrupt
       66: Export nl_langinfo
       67: Export pthread_getsequence_np
       68: Export netdb stuff
       69: Export strtof
       70: Export asprintf, _asprintf_r, vasprintf, _vasprintf_r
       71: Export strerror_r
       72: Export nanosleep
       73: Export setreuid32, setreuid, setregid32, setregid
       74: Export _strtold a64l hcreate hcreate_r hdestroy hdestroy_r hsearch
		  hsearch_r isblank iswalnum iswalpha iswblank iswcntrl iswctype
		  iswdigit iswgraph iswlower iswprint iswpunct iswspace iswupper
		  iswxdigit l64a mbrlen mbrtowc mbsinit mbsrtowcs mempcpy
		  on_exit setbuffer setlinebuf strndup strnlen tdelete tdestroy
		  tfind towctrans towlower towupper tsearch twalk wcrtomb wcscat
		  wcschr wcscpy wcscspn wcslcat wcslcpy wcsncat wcsncmp wcsncpy
		  wcspbrk wcsrchr wcsrtombs wcsspn wcsstr wctob wctob wctrans
		  wctype wmemchr wmemcmp wmemcpy wmemmove wmemset
       75: Export exp2 exp2f fdim fdimf fma fmaf fmax fmaxf fmin fminf lrint
		  lrintf lround lroundf nearbyint nearbyintf remquo remquof
		  round roundf scalbln scalblnf sincos sincosf tgamma tgammaf
		  truncf
       76: mallinfo
       77: thread-safe exit/at_exit
       78: Use stat and fstat rather than _stat, and _fstat.
	   Export btowc and trunc.
       79: Export acl32 aclcheck32 aclfrommode32 aclfrompbits32 aclfromtext32
		  aclsort32 acltomode32 acltopbits32 acltotext32 facl32
		  fgetpos64 fopen64 freopen64 fseeko64 fsetpos64 ftello64
		  _open64 _lseek64 _fstat64 _stat64 mknod32
       80: Export pthread_rwlock stuff
       81: CW_CHECK_NTSEC addition to external.cc
       82: Export wcscoll wcswidth wcwidth
       83: Export gethostid
       84: Pty open allocates invisible console.  64 bit interface
       85: Export new 32/64 functions from API 0.79 only with leading
	   underscore.  No problems with backward compatibility since no
	   official release has been made so far.  This change removes
	   exported symbols like fopen64, which might confuse configure.
       86: Export ftok
       87: Export vsyslog
       88: Export _getreent
       89: Export __mempcpy
       90: Export _fopen64
       91: Export argz_add argz_add_sep argz_append argz_count argz_create
	   argz_create_sep argz_delete argz_extract argz_insert
	   argz_next argz_replace argz_stringify envz_add envz_entry
	   envz_get envz_merge envz_remove envz_strip
       92: Export getusershell, setusershell, endusershell
       93: Export daemon, forkpty, openpty, iruserok, ruserok, login_tty,
	   openpty, forkpty, revoke, logwtmp, updwtmp
       94: Export getopt, getopt_long, optarg, opterr, optind, optopt,
	   optreset, __check_rhosts_file, __rcmd_errstr.
       95: Export shmat, shmctl, shmdt, shmget.
       96: CW_GET_ERRNO_FROM_WINERROR addition to external.cc
       97: Export sem_open, sem_close, sem_timedwait, sem_getvalue.
       98: Export _tmpfile64.
       99: CW_GET_POSIX_SECURITY_ATTRIBUTE addition to external.cc.
      100: CW_GET_SHMLBA addition to external.cc.
      101: Export err, errx, verr, verrx, warn, warnx, vwarn, vwarnx.
      102: CW_GET_UID_FROM_SID and CW_GET_GID_FROM_SID addition to external.cc.
      103: Export getprogname, setprogname.
      104: Export msgctl, msgget, msgrcv, msgsnd, semctl, semget, semop.
      105: Export sigwait.
      106: Export flock.
      107: Export fcntl64.
      108: Remove unused (hopefully) reent_data export.
      109: Oh well.  Someone uses reent_data.
      110: Export clock_gettime, sigwaitinfo, timer_create, timer_delete,
	   timer_settime
      111: Export sigqueue, sighold.
      112: Redefine some mtget fields.
      113: Again redefine some mtget fields.  Use mt_fileno and mt_blkno as
	   on Linux.
      114: Export rand_r, ttyname_r.
      115: Export flockfile, ftrylockfile, funlockfile, getgrgid_r, getgrnam_r,
	   getlogin_r.
      116: Export atoll.
      117: Export utmpx functions, Return utmp * from pututent.
      118: Export getpriority, setpriority.
      119: Export fdatasync.
      120: Export basename, dirname.
      122: Export statvfs, fstatvfs.
      123: Export utmpxname.
      124: Add MAP_AUTOGROW flag to mmap.
      125: LD_PRELOAD/CW_HOOK available.
      126: Export lsearch, lfind, timer_gettime.
      127: Export sigrelese.
      128: Export pselect.
      129: Export mkdtemp.
      130: Export strtoimax, strtoumax, llabs, imaxabs, lldiv, imaxdiv.
      131: Export inet_ntop, inet_pton.
      132: Add GLOB_LIMIT flag to glob.
      133: Export __getline, __getdelim.
      134: Export getline, getdelim.
      135: Export pread, pwrite
      136: Add TIOCMBIS/TIOCMBIC ioctl codes.
      137: fts_children, fts_close, fts_get_clientptr, fts_get_stream,
	   fts_open, fts_read, fts_set, fts_set_clientptr, ftw, nftw.
      138: Export readdir_r.
      139: Start using POSIX definition of struct msghdr and WinSock2
	   IPPROTO_IP values.
      140: Export mlock, munlock.
      141: Export futimes, lutimes.
      142: Export memmem
      143: Export clock_getres, clock_setres
      144: Export timelocal, timegm.
      145: Add MAP_NORESERVE flag to mmap.
      146: Change SI_USER definition.  FIXME: Need to develop compatibility
	   macro for this?
      147: Eliminate problematic d_ino from dirent structure.  unsetenv now
	   returns int, as per linux.
      148: Add open(2) flags O_SYNC, O_RSYNC, O_DSYNC and O_DIRECT.
      149: Add open(2) flag O_NOFOLLOW.
      150: Export getsubopt.
      151: Export __opendir_with_d_ino
      152: Revert to having d_ino in dirent unconditionally.
      153: Export updwtmpx, Implement CW_SETUP_WINENV.
      154: Export sigset, sigignore.
      155: Export __isinff, __isinfd, __isnanf, __isnand.
      156: Export __srbuf_r, __swget_r.
      157: Export gai_strerror, getaddrinfo, getnameinfo, freeaddrinfo,
	   in6addr_any, in6addr_loopback.
      158: Export bindresvport, bindresvport_sa, iruserok_sa, rcmd_af,
	   rresvport_af.
      159: Export posix_openpt.
      160: Export posix_fadvise, posix_fallocate.
      161: Export resolver functions.
      162: New struct ifreq.  Export if_nametoindex, if_indextoname,
	   if_nameindex, if_freenameindex.
      163: Export posix_madvise, posix_memalign.
      164: Export shm_open, shm_unlink.
      165: Export mq_close, mq_getattr, mq_notify, mq_open, mq_receive,
	   mq_send, mq_setattr, mq_timedreceive, mq_timedsend, mq_unlink.
      166: Export sem_unlink.
      167: Add st_birthtim to struct stat.
      168: Export asnprintf, dprintf, _Exit, vasnprintf, vdprintf.
      169: Export confstr.
      170: Export insque, remque.
      171: Export exp10, exp10f, pow10, pow10f, strcasestr, funopen,
	   fopencookie.
      172: Export getifaddrs, freeifaddrs.
      173: Export __assert_func.
      174: Export stpcpy, stpncpy.
      175: Export fdopendir.
      176: Export wcstol, wcstoll, wcstoul, wcstoull, wcsxfrm.
      177: Export sys_sigabbrev
      178: Export wcpcpy, wcpncpy.
      179: Export _f_llrint, _f_llrintf, _f_llrintl, _f_lrint, _f_lrintf,
	   _f_lrintl, _f_rint, _f_rintf, _f_rintl, llrint, llrintf, llrintl,
	   rintl, lrintl, and redirect exports of lrint, lrintf, rint, rintf.
      180: Export getxattr, lgetxattr, fgetxattr, listxattr, llistxattr,
	   flistxattr, setxattr, lsetxattr, fsetxattr, removexattr,
	   lremovexattr, fremovexattr.
      181: Export cygwin_conv_path, cygwin_create_path, cygwin_conv_path_list.
      182: Export lockf.
      FIXME: Removed 12 year old and entirely wrong wprintf function at
	   this point.  We need a working implementation soon.
      183: Export open_memstream, fmemopen.
      184: Export openat, faccessat, fchmodat, fchownat, fstatat, futimesat,
	   linkat, mkdirat, mkfifoat, mknodat, readlinkat, renameat, symlinkat,
	   unlinkat.
      185: Export futimens, utimensat.
      186: Remove ancient V8 regexp functions.  Also eliminate old crt0 interface
	   which provided its own user_data structure.
      187: Export cfmakeraw.
      188: Export CW_SET_PRIV_KEY.
      189: Implement dirent.d_type.
      190: Export fgetwc, fgetws, fputwc, fputws, fwide, getwc, getwchar,
	   putwc, putwchar, ungetwc.
      191: Export glob_pattern_p
      192: CW_SETERRNO added
      193: Export wcstok.
      194: fcntl.h flags O_DIRECTORY, O_EXEC and O_SEARCH added.
      195: Export wcstod, wcstof.
      196: Export wcsnlen.
      197: Export wcstoimax, wcstoumax.
      198: Export reallocf.
      199: Export open_wmemstream.
      200: Export mbsnrtowcs, wcsnrtombs.
      201: Export wprintf, fwprintf, swprintf, vwprintf, vfwprintf, vswprintf.
      202: Export gethostbyname2.
      203: Export wcsftime.
      204: recv/send flag MSG_DONTWAIT added.
      205: Export wscanf, fwscanf, swscanf, vwscanf, vfwscanf, vswscanf.
      206: Export wcscasecmp, wcsncasecmp.
      207: Export wcsdup.
      208: Export log2, log2f.
      209: Export wordexp, wordfree.
      210: New ctype layout using variable ctype pointer.  Export __ctype_ptr__.
      211: Export fpurge, mkstemps.
      212: Add and export libstdc++ malloc wrappers.
      213: Export canonicalize_file_name, eaccess, euidaccess.
      214: Export execvpe, fexecve.
      215: CW_EXIT_PROCESS added.
      216: CW_SET_EXTERNAL_TOKEN added.
      217: CW_GET_INSTKEY added.
      218: Export get_nprocs, get_nprocs_conf, get_phys_pages, get_avphys_pages.
      219: Export dup3, pipe2, O_CLOEXEC, F_DUPFD_CLOEXEC.
      220: Export accept4, SOCK_CLOEXEC, SOCK_NONBLOCK.
      221: Export strfmon.
      222: CW_INT_SETLOCALE added.
      223: SIGPWR added.
      224: Export xdr* functions.
      225: Export __xdr* functions.
      226: Export __locale_mb_cur_max.
      227: Add pseudo_reloc_start, pseudo_reloc_end, image_base to per_process.
      228: CW_STRERROR added.
      229: Add mkostemp, mkostemps.
      230: Add CLOCK_MONOTONIC.
      231: Add fenv.h functions.
      232: Export cacos, cacosf, cacosh, cacoshf, carg, cargf, casin, casinf,
	   casinh, casinhf, catan, catanf, catanh, catanhf, ccos, ccosf, ccosh,
	   ccoshf, cexp, cexpf, cimag, cimagf, clog, clogf, conj, conjf, cpow,
	   cpowf, cproj, cprojf, creal, crealf, csin, csinf, csinh, csinhf,
	   csqrt, csqrtf, ctan, ctanf, ctanh, ctanhf.
      233: Add TIOCGPGRP, TIOCSPGRP.  Export llround, llroundf.
      234: Export program_invocation_name, program_invocation_short_name.
      235: Export madvise.
      236: Export pthread_yield, __xpg_strerror_r.
      237: Export strchrnul.
      238: Export pthread_spin_destroy, pthread_spin_init, pthread_spin_lock,
	   pthread_spin_trylock, pthread_spin_unlock.
      239: Export pthread_setschedprio.
      240: Export ppoll.
      241: Export pthread_attr_getstack, pthread_attr_getstackaddr,
	   pthread_getattr_np.
      242: Export psiginfo, psignal, sys_siglist.
      243: Export sysinfo.
      244: Export clock_settime.
      245: Export pthread_attr_getguardsize, pthread_attr_setguardsize,
	   pthread_attr_setstack, pthread_attr_setstackaddr.
      246: Add CLOCK_PROCESS_CPUTIME_ID, CLOCK_THREAD_CPUTIME_ID.
	   Export clock_getcpuclockid, pthread_getcpuclockid.
      247: Export error, error_at_line, error_message_count, error_one_per_line,
	   error_print_progname.
      248: Export __fpurge.
      249: Export pthread_condattr_getclock, pthread_condattr_setclock.
      250: Export clock_nanosleep.
      251: RTLD_NODELETE, RTLD_NOLOAD, RTLD_DEEPBIND added.
      252: CW_CVT_ENV_TO_WINENV added.
      253: Export TIOCSCTTY, tcgetsid.
      254: Export getgrouplist.
      255: Export ptsname_r.
      256: Add CW_ALLOC_DRIVE_MAP, CW_MAP_DRIVE_MAP, CW_FREE_DRIVE_MAP.
      257: Export getpt.
      258: Export get_current_dir_name.
      259: Export pthread_sigqueue.
      260: Export scandirat.
      261: Export memrchr.
      262: Export getmntent_r.
      263: Export cfsetspeed.
      264: Consistently export strtold
      265: Export __b64_ntop, __b64_pton.
      266: Export arc4random, arc4random_addrandom, arc4random_buf,
	   arc4random_stir, arc4random_uniform.
      267: Export rawmemchr.
      268: Export GetCommandLineA, GetCommandLineW
      269: Allow application override of posix_memalign.
      270: Redefine mtget.mt_resid field to contain current partition as well
           as number of partitions on tape.
      271: Export posix_spawn, posix_spawnp, and helper functions.
      272: Export tm_gmtoff and tm_zone members.
      273: Skipped.
      274: Export __cxa_atexit and __cxa_finalize.
      275: Introduce account mapping from Windows account DBs.  Add CW_SETENT,
	   CW_GETENT, CW_ENDENT, CW_GETNSSSEP, CW_GETPWSID, CW_GETGRSID,
	   CW_CYGNAME_FROM_WINNAME.
      276: Export ffsl, ffsll.
      277: Add setsockopt(SO_PEERCRED).
      278: Add quotactl.
      279: Export stime.
      280: Static atexit in libcygwin.a, CW_FIXED_ATEXIT.
      281: Add CW_GETNSS_PWD_SRC, CW_GETNSS_GRP_SRC.
      282: Export __bsd_qsort_r, qsort_r.
      283: Export __fbufsize, __flbf, __fpending, __freadable, __freading,
           __fsetlocking, __fwritable, __fwriting. clearerr_unlocked,
           feof_unlocked, ferror_unlocked, fflush_unlocked, fgetc_unlocked,
           fgets_unlocked, fgetwc_unlocked, fgetws_unlocked, fileno_unlocked,
           fputc_unlocked, fputs_unlocked, fputwc_unlocked, fputws_unlocked,
           fread_unlocked, fwrite_unlocked, getwc_unlocked, getwchar_unlocked,
           putwc_unlocked, putwchar_unlocked.
      284: Export sockatmark.
      285: Export wcstold.
      285: Export cabsl, cimagl, creall, finitel, hypotl, sqrtl.
      287: Export issetugid.
     */

     /* Note that we forgot to bump the api for ualarm, strtoll, strtoull */

#define CYGWIN_VERSION_API_MAJOR 0
#define CYGWIN_VERSION_API_MINOR 287

     /* There is also a compatibity version number associated with the
	shared memory regions.  It is incremented when incompatible
	changes are made to the shared memory region *or* to any named
	shared mutexes, semaphores, etc.   The arbitrary starting
	version was 0 (cygwin release 98r2).
	Bump to 4 since this hasn't been rigorously updated in a
	while.  */

#define CYGWIN_VERSION_SHARED_DATA 5

     /* An identifier used in the names used to create shared objects.
	The full names include the CYGWIN_VERSION_SHARED_DATA version
	as well as this identifier. */

#define CYGWIN_VERSION_DLL_IDENTIFIER	"cygwin1"

     /* The Cygwin mount table interface in the Win32 registry also
	has a version number associated with it in case that is
	changed in a non-backwards compatible fashion.  Increment this
	version number whenever incompatible changes in mount table
	registry usage are made.

	1: Original number version.
	2: New mount registry layout, system-wide mount accessibility.
	3: The mount table is not in the registry anymore, but in /etc/fstab.
     */

#define CYGWIN_VERSION_MOUNT_REGISTRY 3

     /* Identifiers used in the Win32 registry. */

#define CYGWIN_INFO_CYGWIN_REGISTRY_NAME "Cygwin"
#define CYGWIN_INFO_INSTALLATIONS_NAME   "Installations"

     /* The default cygdrive prefix. */

#define CYGWIN_INFO_CYGDRIVE_DEFAULT_PREFIX "/cygdrive"

     /* In addition to the above version number strings, the build
	process adds some strings that may be useful in
	debugging/identifying a particular Cygwin DLL:

	The mkvers.sh script at the top level produces a .cc file
	which initializes a cygwin_version structure based on the
	above version information and creates a string table for
	grepping via "fgrep '%%%' cygwinwhatever.dll" if you are
	using GNU grep.  Otherwise you may want to do a
	"strings cygwinwhatever.dll | fgrep '%%%'" instead.

	This will produce output such as:

	%%% Cygwin dll_identifier: cygwin
	%%% Cygwin api_major: 0
	%%% Cygwin api_minor: 0
	%%% Cygwin dll_major: 19
	%%% Cygwin dll_minor: 6
	%%% Cygwin shared_data: 1
	%%% Cygwin registry: b15
	%%% Cygwin build date: Wed Oct 14 16:26:51 EDT 1998
	%%% Cygwin shared id: cygwinS1

	This information can also be obtained through a call to
	cygwin_internal (CW_GETVERSIONINFO).
     */

#define CYGWIN_VERSION_MAGIC(a, b) ((unsigned) ((((unsigned short) a) << 16) | (unsigned short) b))
#define CYGWIN_VERSION_MAGIC_VERSION(a) ((unsigned) ((unsigned)a & 0xffff))
@


1.421
log
@	* common.din (issetugid): Export.
	* glob.cc (issetugid): Drop macro.
	* sec_auth.cc (issetugid): New exported function.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 35
@


1.420
log
@	* common.din: Export cabsl, cimagl, creall, finitel, hypotl, sqrtl.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d471 1
d477 1
a477 1
#define CYGWIN_VERSION_API_MINOR 286
@


1.419
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 35.
@
text
@d470 1
d476 1
a476 1
#define CYGWIN_VERSION_API_MINOR 285
@


1.418
log
@	* common.din (wcstold): Export.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 34
@


1.417
log
@	* common.din (sockatmark): Export.
	* net.cc (sockatmark): New function.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d469 1
d475 1
a475 1
#define CYGWIN_VERSION_API_MINOR 284
@


1.416
log
@* common.din (__fbufsize, __flbf, __fpending, __freadable, __freading,
__fsetlocking, __fwritable, __fwriting, clearerr_unlocked,
feof_unlocked, ferror_unlocked, fflush_unlocked, fgetc_unlocked,
fgets_unlocked, fgetwc_unlocked, fgetws_unlocked, fileno_unlocked,
fputc_unlocked, fputs_unlocked, fputwc_unlocked, fputws_unlocked,
fread_unlocked, fwrite_unlocked, getwc_unlocked, getwchar_unlocked,
putwc_unlocked, putwchar_unlocked): Export.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d4 1
a4 1
   2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014 Red Hat, Inc.
d468 1
d474 1
a474 1
#define CYGWIN_VERSION_API_MINOR 283
@


1.415
log
@	* environ.cc (regopt): Remove function.
	(environ_init): Drop undocumented feature to read application-specific
	environment variables from the registry.
	* include/cygwin/version.h (CYGWIN_INFO_PROGRAM_OPTIONS_NAME): Remove.
@
text
@d461 7
d473 1
a473 1
#define CYGWIN_VERSION_API_MINOR 282
@


1.414
log
@* common.din (__bsd_qsort_r): Add.
(qsort_r): Add.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@a499 1
#define CYGWIN_INFO_PROGRAM_OPTIONS_NAME "Program Options"
@


1.413
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 34.

	* new-features.xml (ov-new1.7.34): Add new section.
	(ov-new1.7.33): Reflect intermediate 1.7.33 release.
@
text
@d460 1
d466 1
a466 1
#define CYGWIN_VERSION_API_MINOR 281
@


1.412
log
@	* cygheap.h (cygheap_pwdgrp): Remove constants NSS_FILES and NSS_DB.
	Use NSS_SRC_FILES and NSS_SRC_DB throughout instead.
	(cygheap_pwdgrp::nss_pwd_src): New inline method.
	(cygheap_pwdgrp::nss_grp_src): Ditto.
	* external.cc (cygwin_internal): Add CW_GETNSS_PWD_SRC and
	CW_GETNSS_GRP_SRC cases.
	* uinfo.cc: Use NSS_SRC_FILES and NSS_SRC_DB throughout.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
	* include/sys/cygwin.h (cygwin_getinfo_types): Add CW_GETNSS_PWD_SRC
	and CW_GETNSS_GRP_SRC.
	(NSS_SRC_FILES): Define.
	(NSS_SRC_DB): Define.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 33
@


1.411
log
@	* dcrt0.cc (cygwin_atexit): Change preceeding comment to reflect
	API version numbers.
	* external.cc (cygwin_internal): disable setting cxx_malloc on 64 bit.
	Add CW_FIXED_ATEXIT case.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
	* include/sys/cygwin.h (cygwin_getinfo_types): Add CW_FIXED_ATEXIT.
	* lib/atexit.c (atexit): Test running Cygwin version by checking
	return value of cygwin_internal (CW_FIXED_ATEXIT).
@
text
@d459 1
d465 1
a465 1
#define CYGWIN_VERSION_API_MINOR 280
@


1.410
log
@* common.din (stime): Export.
* times.cc (stime): New function.
* include/cygwin/time.h (stime): Declare.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d458 1
d464 1
a464 1
#define CYGWIN_VERSION_API_MINOR 279
@


1.409
log
@	* Makefile.in (DLL_OFILES): Add quotactl.o.
	* common.din (quotactl): Export.
	* ntdll.h: Define FILE_FS_CONTROL_INFORMATION::FileSystemControlFlags
	flag values.
	(struct _FILE_FS_CONTROL_INFORMATION): Define.
	(struct _FILE_GET_QUOTA_INFORMATION): Define.
	(typedef struct _FILE_QUOTA_INFORMATION): Define.
	(NtQueryObject): Use PVOID rather than VOID*.
	(NtQueryVolumeInformationFile): Ditto.
	(NtQueryQuotaInformationFile): Declare.
	(NtSetQuotaInformationFile): Declare.
	(NtSetVolumeInformationFile): Declare.
	* quotactl.cc: New file implementing quotactl().
	* include/sys/mount.h (BLOCK_SIZE): Define.
	(BLOCK_SIZE_BITS): Define.
	* include/sys/quota.h: New header.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d457 1
d463 1
a463 1
#define CYGWIN_VERSION_API_MINOR 278
@


1.408
log
@	Add setsockopt(sd, SOL_SOCKET, SO_PEERCRED, NULL, 0) to disable
	initial handshake on AF_LOCAL sockets.
	* fhandler.h (class fhandler_socket): Add no_getpeereid status flag.
	(fhandler_socket::af_local_set_no_getpeereid): New prototype.
	* fhandler_socket.cc (fhandler_socket::af_local_connect): Skip handshake
	if no_getpeereid is set.  Add debug output.
	(fhandler_socket::af_local_accept): Likewise.
	(fhandler_socket::af_local_set_no_getpeereid): New function.
	(fhandler_socket::af_local_copy): Copy no_getpeereid.
	(fhandler_socket::getpeereid): Fail if no_getpeereid is set.
	* net.cc (cygwin_setsockopt): Add SO_PEERCRED for AF_LOCAL/SOCK_STREAM
	sockets.  Add comment to explain why we need it.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d456 1
d462 1
a462 1
#define CYGWIN_VERSION_API_MINOR 277
@


1.407
log
@	* common.din (ffsl): Export.
	(ffsll): Export.
	* syscalls.cc (ffs): Implement using GCC intrinsic.
	(ffsl): Ditto.
	(ffsll): Ditto.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d455 1
d461 1
a461 1
#define CYGWIN_VERSION_API_MINOR 276
@


1.406
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 33.
	(CYGWIN_VERSION_API_MINOR): Bump to reflect intermediate 1.7.32 release.
@
text
@d454 1
d460 1
a460 1
#define CYGWIN_VERSION_API_MINOR 275
@


1.405
log
@* common.din (__cxa_finalize): Export.
* dcrt0.cc (cygwin_atexit): Use d->handle with __cxa_atexit.
* dll_init.cc (dll_list::detach): Use d->handle with __cxa_finalize.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Use 274 for
__cxa_finalize as well.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 32
d449 3
a451 1
      273: Introduce account mapping from Windows account DBs.  Add CW_SETENT,
a453 1
      274: Export __cxa_atexit and __cxa_finalize.
d459 1
a459 1
#define CYGWIN_VERSION_API_MINOR 274
@


1.404
log
@	* common.din (__cxa_atexit): Export.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump to 274.
@
text
@d452 1
a452 1
      274: Export __cxa_atexit.
@


1.403
log
@bump to 32
@
text
@d452 1
d458 1
a458 1
#define CYGWIN_VERSION_API_MINOR 273
@


1.402
log
@Fix typo
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 31
@


1.401
log
@* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 31.
@
text
@d449 1
a449 1
      273: Introduce account mapping from WIndows account DBs.  Add CW_SETENT,
@


1.400
log
@	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump to 273.
@
text
@d4 1
a4 1
   2007, 2008, 2009, 2010, 2011, 2012, 2013 Red Hat, Inc.
d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 30
@


1.399
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 30.
@
text
@d449 3
d457 1
a457 1
#define CYGWIN_VERSION_API_MINOR 272
@


1.398
log
@	* localtime.cc: Define TM_GMTOFF and TM_ZONE based on __TM_GMTOFF and
	__TM_ZONE being defined.  Throughout, write to these struct tm members
	only if CYGWIN_VERSION_CHECK_FOR_EXTRA_TM_MEMBERS is true.
	* libc/strptime.cc: Ditto.
	* include/cygwin/version.h (CYGWIN_VERSION_CHECK_FOR_EXTRA_TM_MEMBERS):
	Define.
	(CYGWIN_VERSION_API_MINOR): Bump to 272.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 29
@


1.397
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 29.
@
text
@d107 3
d448 1
d454 1
a454 1
#define CYGWIN_VERSION_API_MINOR 271
@


1.397.2.1
log
@* localtime.cc: Define TM_GMTOFF and TM_ZONE based on __TM_GMTOFF and __TM_ZONE
being defined.  Throughout, write to these struct tm members only if
CYGWIN_VERSION_CHECK_FOR_EXTRA_TM_MEMBERS is true.
* libc/strptime.cc: Ditto.
* include/cygwin/version.h (CYGWIN_VERSION_CHECK_FOR_EXTRA_TM_MEMBERS): Define.
(CYGWIN_VERSION_API_MINOR): Bump to 272.
@
text
@a106 3
#define CYGWIN_VERSION_CHECK_FOR_EXTRA_TM_MEMBERS \
  (CYGWIN_VERSION_USER_API_VERSION_COMBINED >= 272)

a444 1
      272: Export tm_gmtoff and tm_zone members.
d450 1
a450 1
#define CYGWIN_VERSION_API_MINOR 272
@


1.397.2.2
log
@* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 30.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 30
@


1.397.2.3
log
@Bump copyright
@
text
@d4 1
a4 1
   2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014 Red Hat, Inc.
@


1.397.2.4
log
@Add more missing patches
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 31
@


1.397.2.5
log
@2014-08-11  Corinna Vinschen  <corinna@@vinschen.de>

	* cpuid.h: Add missing copyright header.  Fix formatting.  Use uint32_t
	instead of unsigned throughout.  Change functions to static inline and
	always inline.
	(cpuid): Add parameter to set ecx, allowing to request extended CPUID
	info.
	* fhandler_proc.cc (format_proc_cpuinfo): Use uint32_t instead of
	unsigned throughout.  Add fake decimal places to MHz info.  Handle more
	feature flags.
	* fhandler_random.cc (fhandler_dev_random::write): Allow up to 4K
	input to add entropy.
	* syscalls.cc: Drop including cpuid.h.

2014-08-07  Yaakov Selkowitz  <yselkowi@@redhat.com>

	* common.din (__cxa_finalize): Export.
	* dcrt0.cc (cygwin_atexit): Use d->handle with __cxa_atexit.
	* dll_init.cc (dll_list::detach): Use d->handle with __cxa_finalize.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Use 274 for
	__cxa_finalize as well.

2014-08-04  Anthony Heading  <anthony@@ajrh.net>

	* include/sys/file.h: Add extern "C".

2014-08-04  Corinna Vinschen  <corinna@@vinschen.de>

	* common.din (__cxa_atexit): Export.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump to 274.

2014-07-31  Eric Blake  <eblake@@redhat.com>

	* include/pthread.h: Decorate attribute names with __, for
	namespace safety.
	* include/cygwin/core_dump.h: Likewise.
	* include/cygwin/cygwin_dll.h: Likewise.
	* include/sys/cygwin.h: Likewise.
	* include/sys/strace.h: Likewise.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 32
a448 2
      273: Skipped.
      274: Export __cxa_atexit and __cxa_finalize.
d454 1
a454 1
#define CYGWIN_VERSION_API_MINOR 274
@


1.397.2.6
log
@2014-11-07  Corinna Vinschen  <corinna@@vinschen.de>

	* dcrt0.cc (cygwin__cxa_atexit): Fetch correct DSO handle value
	by searching dll list.  Explain why.

2014-11-06  Corinna Vinschen  <corinna@@vinschen.de>

	* dcrt0.cc (cygwin_atexit): Change preceeding comment to reflect
	API version numbers.
	* external.cc (cygwin_internal): disable setting cxx_malloc on 64 bit.
	Add CW_FIXED_ATEXIT case.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
	* include/sys/cygwin.h (cygwin_getinfo_types): Add CW_FIXED_ATEXIT.
	* lib/atexit.c (atexit): Test running Cygwin version by checking
	return value of cygwin_internal (CW_FIXED_ATEXIT).

2014-11-05  Corinna Vinschen  <corinna@@vinschen.de>

	* lib/atexit.c (atexit): Check for being linked into the executable.
	If so, call __cxa_atexit with NULL DSO handle.  Explain why.
	* lib/dso_handle.c: New file providing fallback __dso_handle.

2014-11-05  Corinna Vinschen  <corinna@@vinschen.de>

	* Makefile.in (NEW_FUNCTIONS): Add atexit to be not exported.
	* lib/atexit.c (atexit): New, statically linkable version of atexit.
	* dcrt0.cc (cygwin_atexit): Add comment to mark this function as old
	entry point.  Indiscriminately check for DSO of function pointer for
	all functions, if checking for DSO of return address fails on x86_64.
	Change comment accordingly.

2014-11-05  Corinna Vinschen  <corinna@@vinschen.de>

	* Makefile.in (NEW_FUNCTIONS): Define target-independent.  Add target
	dependent stuff afterwards.  Globally define timezone and all xdr
	symbols as non-exported from libcygwin.a.

2014-11-03  Corinna Vinschen  <corinna@@vinschen.de>

	* cygheap.cc: Fix formatting.

2014-10-29  Corinna Vinschen  <corinna@@vinschen.de>

	* cygheap.cc (init_cygheap::init_installation_root): Create content of
	installation_dir as non-prefixed path, if possible.

2014-10-29  Corinna Vinschen  <corinna@@vinschen.de>

	* common.din (__cxa_atexit): Define as cygwin__cxa_atexit.
	* dcrt0.cc (cygwin__cxa_atexit): New function.  Explain what we do.

2014-10-28  Corinna Vinschen  <corinna@@vinschen.de>

	* globals.cc (dos_file_warning): Set to false by default.
	* path.cc (warn_msdos): Make static.  Drop test for dos_file_warning.
	(path_conv::check): Check for dos_file_warning here to avoid a function
	call in the default case.

2014-10-27  Corinna Vinschen  <corinna@@vinschen.de>

	* dcrt0.cc (cygwin_atexit): Add workaround for broken atexit calls
	in __gcc_register_frame of DLLs built with gcc-4.8.3-3.

2014-10-27  Corinna Vinschen  <corinna@@vinschen.de>

	* cygheap.cc (init_cygheap::init_installation_root): Set
	installation_dir_len.
	* cygheap.h (struct init_cygheap): Add installation_dir_len member.
	* environ.cc (win_env::add_cache): Use stpcpy for speed.
	(posify_maybe): Use tmp_pathbuf buffer instead of stack.
	(raise_envblock): New function to resize Windows environment block.
	(build_env): Fix indentation.  Call raise_envblock function.  Check if
	$PATH exists and is non-empty.  If not, add PATH variable with Cygwin
	installation directory as content to Windows environment.  Explain why.

2014-10-24  Corinna Vinschen  <corinna@@vinschen.de>

	* fhandler_proc.cc (format_proc_cygdrive): Fix symlink path if cygdrive
	is "/".

2014-10-24  Corinna Vinschen  <corinna@@vinschen.de>

	* gendef (sigdelayed): 64 bit only: Fix seh_pushreg statements in
	prologue.

2014-10-22  Yaakov Selkowitz  <yselkowi@@redhat.com>

	* common.din (stime): Export.
	* times.cc (stime): New function.
	* include/cygwin/time.h (stime): Declare.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.

2014-10-20  Corinna Vinschen  <corinna@@vinschen.de>

	* fhandler_serial.cc: Revert debug code accidentally checked in on
	2014-08-18.

2014-10-20  Corinna Vinschen  <corinna@@vinschen.de>

	* path.cc (symlink_info::check): Set error from status code if opening
	the parent directory failed, but keep special case for root dirs.

2014-10-17  Corinna Vinschen  <corinna@@vinschen.de>

	* cygheap.cc (init_cygheap::init_installation_root): Just memmove
	contents of installation_root instead of calling GetModuleFileNameW
	again.  Copy installation_root to installation_dir before stripping of
	"bin" dir.  Explain what we do.
	* cygheap.h (struct init_cygheap): Add installation_dir member.

2014-10-17  Corinna Vinschen  <corinna@@vinschen.de>

	* cygtls.h (__try): Define __l_endtry as block-local label in 32 bit
	case as well.

2014-10-17  Corinna Vinschen  <corinna@@vinschen.de>

	* Makefile.in (DLL_OFILES): Add quotactl.o.
	* common.din (quotactl): Export.
	* ntdll.h: Define FILE_FS_CONTROL_INFORMATION::FileSystemControlFlags
	flag values.
	(struct _FILE_FS_CONTROL_INFORMATION): Define.
	(struct _FILE_GET_QUOTA_INFORMATION): Define.
	(typedef struct _FILE_QUOTA_INFORMATION): Define.
	(NtQueryObject): Use PVOID rather than VOID*.
	(NtQueryVolumeInformationFile): Ditto.
	(NtQueryQuotaInformationFile): Declare.
	(NtSetQuotaInformationFile): Declare.
	(NtSetVolumeInformationFile): Declare.
	* quotactl.cc: New file implementing quotactl().
	* include/sys/mount.h (BLOCK_SIZE): Define.
	(BLOCK_SIZE_BITS): Define.
	* include/sys/quota.h: New header.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.

2014-10-16  Corinna Vinschen  <corinna@@vinschen.de>

	* Makefile.in (DLL_OFILES): Rearrange with one file per line.

2014-10-16  Corinna Vinschen  <corinna@@vinschen.de>

	* fhandler_proc.cc (format_proc_partitions): Extend output to print
	the windows mount points the device is mounted on.

2014-10-13  Corinna Vinschen  <corinna@@vinschen.de>

	* net.cc (cygwin_setsockopt): Drop redundant test for AF_LOCAL and
	SOCK_STREAM in SO_PEERCRED case, as in the original patch.

2014-10-12  Corinna Vinschen  <corinna@@vinschen.de>

	* dlfcn.cc (gfpod_helper): Only check for POSIX dir separator, same as
	in get_full_path_of_dll.

2014-10-12  Corinna Vinschen  <corinna@@vinschen.de>

	* dlfcn.cc (set_dl_error): Drop useless __stdcall.
	(check_path_access): Ditto.  Drop FE_CWD from call to find_exec.
	(gfpod_helper): Call path_conv::check for all paths containing a dir
	separator to more closely follow the Linux search algorithm.
	(get_full_path_of_dll): Drop useless __stdcall.
	(dlopen): Simplify RTLD_NOLOAD case by calling GetModuleHandleEx
	instead of GetModuleHandle/LoadLibrary.

2014-10-11  Christian Franke  <franke@@computer.org>

	Add setsockopt(sd, SOL_SOCKET, SO_PEERCRED, NULL, 0) to disable
	initial handshake on AF_LOCAL sockets.
	* fhandler.h (class fhandler_socket): Add no_getpeereid status flag.
	(fhandler_socket::af_local_set_no_getpeereid): New prototype.
	* fhandler_socket.cc (fhandler_socket::af_local_connect): Skip handshake
	if no_getpeereid is set.  Add debug output.
	(fhandler_socket::af_local_accept): Likewise.
	(fhandler_socket::af_local_set_no_getpeereid): New function.
	(fhandler_socket::af_local_copy): Copy no_getpeereid.
	(fhandler_socket::getpeereid): Fail if no_getpeereid is set.
	* net.cc (cygwin_setsockopt): Add SO_PEERCRED for AF_LOCAL/SOCK_STREAM
	sockets.  Add comment to explain why we need it.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.

2014-10-10  Corinna Vinschen  <corinna@@vinschen.de>

	* dlfcn.cc (dlopen): Disable old 32 bit code on 64 bit.
	* dcrt0.cc (check_sanity_and_sync): Ditto.
	* dll_init.cc (dll_dllcrt0_1): Fix typo in comment.

2014-10-08  Corinna Vinschen  <corinna@@vinschen.de>

	* common.din (ffsl): Export.
	(ffsll): Export.
	* syscalls.cc (ffs): Implement using GCC intrinsic.
	(ffsl): Ditto.
	(ffsll): Ditto.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.

2014-10-08  Christian Franke  <franke@@computer.org>

	* syscalls.cc (ffs): Fix crash of ffs (0x80000000) on 64 bit.

2014-10-08  Corinna Vinschen  <corinna@@vinschen.de>

	* fhandler_process.cc (format_process_statm): Fix output of dirty
	pages.  Add linefeed.

2014-09-05  Corinna Vinschen  <corinna@@vinschen.de>

	* fhandler_proc.cc (proc_tab): Add entry for cygdrive symlink.
	(format_proc_cygdrive): New function to implement /proc/cygdrive.

2014-09-05  Corinna Vinschen  <corinna@@vinschen.de>

	* exception.h (class exception): Remove unnecessary #ifdef.

2014-09-05  Corinna Vinschen  <corinna@@vinschen.de>

	* winlean.h (DNLEN): Raise to 31.  Explain why.

2014-08-28  Corinna Vinschen  <corinna@@vinschen.de>

	* fhandler_disk_file.cc (fhandler_disk_file::fstatvfs): Try the
	FileFsSizeInformation information class on filesystems choking on
	FileFsFullSizeInformation (I see you Netapp!)

2014-08-27  Corinna Vinschen  <corinna@@vinschen.de>

	* fhandler.h (fhandler_pty_slave::fch_open_handles): Add bool parameter
	to declaration.
	* fhandler_tty.cc (fhandler_pty_slave::fch_open_handles): Add bool
	parameter "chown".  Only request WRITE_OWNER access when opening pty
	synchronization objects if "chown" is set.
	(fhandler_pty_slave::fchmod): Call fch_open_handles with new bool
	parameter set to false.
	(fhandler_pty_slave::fchown): Call fch_open_handles with new bool
	parameter set to true.
	* kernel32.cc (CreateFileMappingW): Fix default standard rights for
	file mappings from READ_CONTROL to STANDARD_RIGHTS_REQUIRED to allow
	changing the DACL (fixes "access denied" error in pinfo::set_acl).

	* fhandler_disk_file.cc (fhandler_base::fstat_helper): Change debug
	output to print mode bits in octal.
	* security.cc (alloc_sd): Ditto.
	(set_file_attribute): Ditto.

2014-08-27  Corinna Vinschen  <corinna@@vinschen.de>

	* ntea.cc (read_ea): Change left-over return to __leave.  Fix
	condition to close handle.  Call NtClose rather than CloseHandle.
	(write_ea): Fix condition to close handle.  Call NtClose rather than
	CloseHandle.
	* security.cc (get_file_sd): Call pc.init_reopen_attr if a valid
	incoming handle was given, pc.get_object_attr otherwise.
	(set_file_sd): Ditto.

2014-08-26  Corinna Vinschen  <corinna@@vinschen.de>

	* path.h (path_conv::init_reopen_attr): Change from void to returning
	POBJECT_ATTRIBUTES.  Take OBJECT_ATTRIBUTES reference as argument, not
	pointer.
	* fhandler_disk_file.cc: Throughout accommodate above change.
	* syscalls.cc: Ditto.
	* ntea.cc (read_ea): Don't set hdl to NULL if it's already NULL.  Set
	attr with pc.init_reopen_attr before trying to reopen file.
	(write_ea): Ditto.
	* security.cc (get_file_sd): Use pc.init_reopen_attr rather than
	pc.get_object_attr when trying to reopen file.
	(set_file_sd): Ditto.

2014-08-25  Corinna Vinschen  <corinna@@vinschen.de>

	* cygtls.cc (san::leave/x86_64): Implement.
	* cygtls.h (class tls_pathbuf): Move counter variables into a union.
	Add 64 bit element _counters covering both counter variables to
	optimize save and restore operations.
	(class san/x86_64): Only store single 64 bit value.
	(san::san/x86_64): Implement.
	(san::leave/x86_64): Only declare here, as returns_twice function.
	Explain why.
	(class san/i686): Change type of _c_cnt and _w_cnt to uint32_t.
	(__try/x86_64): Move definition of __sebastian after the first memory
	barrier.  Drop __sebastian.setup call.

2014-08-25  Corinna Vinschen  <corinna@@vinschen.de>

	* cygtls.cc (_cygtls::remove): Revert previous patch.
	*  cygtls.h (struct _local_storage): Move pathbufs back here.
	(class san/x86_64): Revert class.  Save and restore pathbufs counters
	only.
	(class san/i686): Revert saving and restoring pathbufs counters.
	(__try/x86_64): Add a san variable and call it's setup method.
	(__except/x86_64): Call san::leave to restore pathbufs counters.
	* gendef (_sigbe): Revert previous change.
	* thread.cc (verifyable_object_state): Remove gcc 4.7 workaround in
	forward declaration as well.
	* tls_pbuf.cc (tls_pbuf): Revert previous change.
	* tls_pbuf.h (class tmp_pathbuf): Accommodate reverting pathbufs to
	locals structure.
	* tlsoffsets.h: Regenerate.
	* tlsoffsets64.h: Regenerate.

2014-08-21  Corinna Vinschen  <corinna@@vinschen.de>

	* Throughout, use __try/__except/__endtry blocks, rather than myfault
	handler.
	* cygtls.cc (_cygtls::remove): Accommodate the fact that pathbufs
	has been moved from _local_storage to _cygtls.
	* cygtls.h (class tls_pathbuf): Add comment to hint to gendef usage
	of counters.  Change type of counters to uint32_t for clarity.
	Remove _cygtls as friend class.
	(struct _local_storage): Move pathbufs from here...
	(struct _cygtls): ...to here, allowing to access it from _sigbe.
	(class san): Only define on 32 bit.  Remove errno, _c_cnt and _w_cnt
	members.
	(san::setup): Drop parameter.  Don't initialize removed members.
	(san::leave): Don't set removed members.
	(class myfault): Only define on 32 bit.
	(myfault::faulted): Only keep implementation not taking any parameter.
	Drop argument in call to sebastian.setup.
	(__try/__leave/__except/__endtry): Implement to support real SEH.  For
	now stick to SJLJ on 32 bit.
	* dcrt0.cc (dll_crt0_0): Drop 64 bit call to
	exception::install_myfault_handler.
	* exception.h (exception_handler): Define with EXCEPTION_DISPOSITION
	as return type.
	(PDISPATCHER_CONTEXT): Define as void * on 32 bit.  Define as pointer
	to _DISPATCHER_CONTEXT on 64 bit.
	(class exception): Define separately for 32 and 64 bit.
	(exception::myfault): Add handler for myfault SEH handling on 64 bit.
	(exception::exception): Fix mangled method name to account for change
	in type of last parameter.
	(exception::install_myfault_handler): Remove.
	* exceptions.cc (exception::myfault_handle): Remove.
	(exception::myfault): New SEH handler for 64 bit.
	* gendef (_sigbe): Set tls_pathbuf counters to 0 explicitely when
	returning to the caller.
	* ntdll.h: Move a comment to a better place.
	(struct _SCOPE_TABLE): Define on 64 bit.
	* thread.cc (verifyable_object_isvalid): Remove gcc 4.7 workaround.
	* tls_pbuf.cc (tls_pbuf): Fix to accommodate new place of pathbufs.
	(tls_pathbuf::destroy): Change type of loop variables to uint32_t.
	* tls_pbuf.h (class tmp_pathbuf): Change type of buffer counters to
	uint32_t.  Accommodate new place of pathbufs.
	* tlsoffsets.h: Regenerate.
	* tlsoffsets64.h: Regenerate.

2014-08-21  Corinna Vinschen  <corinna@@vinschen.de>

	* miscfuncs.cc (__import_address): Cover the first dereference to imp
	under the fault handler.

2014-08-21  Corinna Vinschen  <corinna@@vinschen.de>

	* net.cc (if_freenameindex): Don't catch a SEGV from free to fail
	loudly on double free.

2014-08-21  Corinna Vinschen  <corinna@@vinschen.de>

	* dir.cc (rmdir): Don't skip deleting fh in the ENOTEMPTY case.

2014-08-20  Corinna Vinschen  <corinna@@vinschen.de>

	* tls_pbuf.h (tmp_pathbuf::tmp_pathbuf): Convert to inline method.
	(tmp_pathbuf::~tmp_pathbuf): Ditto.
	* tls_pbuf.cc (tmp_pathbuf::tmp_pathbuf): Remove here.
	(tmp_pathbuf::~tmp_pathbuf): Ditto.

2014-08-19  Corinna Vinschen  <corinna@@vinschen.de>

	* dir.cc (dirfd): Per POSIX, return EINVAL on invalid directory stream.
	(telldir): Per POSIX, return -1 and set errno to EBADF, rather than
	just returning 0, on invalid directory stream.
	* signal.cc (sigwaitinfo): Return -1, not EFAULT, when SEGV was catched.

2014-08-19  Corinna Vinschen  <corinna@@vinschen.de>

	* autoload.cc: Replace WNet[...]A with WNet[...]W imports.
	* dcrt0.cc (initial_env): Drop strlwr calls.  Call strcasestr instead.
	* fhandler_netdrive.cc: Throughout, convert to calling WNet UNICODE
	functions.  Use tmp_pathbuf rather than alloca.  Replace call to
	strlwr with call to RtlDowncaseUnicodeString.

2014-08-19  Corinna Vinschen  <corinna@@vinschen.de>

	* fhandler.h (fhandler_serial::is_tty): Reinstantiate.

2014-08-18  Corinna Vinschen  <corinna@@vinschen.de>

	* miscfuncs.cc (strlwr): Rename from cygwin_strlwr.  Drop __stdcall
	decoration.
	(strupr): Rename from cygwin_strupr.  Drop __stdcall decoration.
	* string.h (strlwr): Remove override macro.  Simply declare.
	(strupr): Ditto.

2014-08-18  Corinna Vinschen  <corinna@@vinschen.de>

	* dtable.cc (dtable::init_std_file_from_handle): Mention that console
	handles are kernel objects since Windows 8.
	* fhandler.h (enum conn_state): Add "listener" state.
	(class fhandler_socket): Drop listener status flag.
	(fhandler_socket::lseek): Return -1 and errno ESPIPE.
	(fhandler_serial::lseek): Ditto.
	(fhandler_serial::is_tty): Remove.
	* fhandler_socket.cc (fhandler_socket::listen): Set connect_state to
	listener.  Add comment.
	(fhandler_socket::accept4): Explicitely check if the socket is listening
	and fail with EINVAL, if not.  Explain why we have to do that.
	(fhandler_socket::getpeereid): Drop now redundant test.

2014-08-15  Corinna Vinschen  <corinna@@vinschen.de>

	* winsup.h (_GNU_SOURCE): Define.  Explain why.

2014-08-14  Corinna Vinschen  <corinna@@vinschen.de>

	* dlmalloc.c: Remove unused file.
	* dlmalloc.h: Ditto.
	* malloc.cc: Update to Doug Lea's malloc version 2.8.6.

2014-08-13  Corinna Vinschen  <corinna@@vinschen.de>

	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 33.
	(CYGWIN_VERSION_API_MINOR): Bump to reflect intermediate 1.7.32 release.

2014-07-21  Corinna Vinschen  <corinna@@vinschen.de>

	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 32.

2014-05-06  Corinna Vinschen  <corinna@@vinschen.de>

	* winlean.h (PIPE_REJECT_REMOTE_CLIENTS): Drop temporary definition
	since Mingw64 catched up.
	(DNLEN): Redefine as 16.  Explain why.

2014-03-06  Corinna Vinschen  <corinna@@vinschen.de>

	* setlsapwd.cc (setlsapwd): Use RtlSecureZeroMemory to delete password
	from memory.

2014-11-05  Corinna Vinschen  <corinna@@vinschen.de>

	* new-features.xml (ov-new1.7.33): Document atexit.

2014-10-28  Corinna Vinschen  <corinna@@vinschen.de>

	* cygwinenv.xml: Change default setting of dosfilewarning.
	* new-features.xml (ov-new1.7.33): Document aforementioned change.

2014-10-27  Corinna Vinschen  <corinna@@vinschen.de>

	* new-features.xml (ov-new1.7.33): Document empty $PATH handling.

2014-10-22  Corinna Vinschen  <corinna@@vinschen.de>

	* posix.xml (std-gnu): Add ffsl, ffsll, quotactl.
	(std-notes): Add restrictions of quotactl.

2014-10-22  Yaakov Selkowitz  <yselkowi@@redhat.com>

	* new-features.xml (ov-new1.7.33): Document stime.
	* posix.xml (std-deprec): Add stime.

2014-10-22  Corinna Vinschen  <corinna@@vinschen.de>

	* new-features.xml (ov-new1.7.33): s/Linux/glibc.

2014-10-22  Corinna Vinschen  <corinna@@vinschen.de>

	* new-features.xml (ov-new1.7.33): Update to current state.

2014-08-13  Corinna Vinschen  <corinna@@vinschen.de>

	* new-features.xml (ov-new1.7.33): Add new section.
	(ov-new1.7.32): Reflect intermediate 1.7.32 release.

2014-10-21  Corinna Vinschen  <corinna@@vinschen.de>

	* cygcheck.cc (CYGLSA64_DLL): Remove unused macro.
	(dump_sysinfo): If COMSPEC isn't set in the MSVCRT environment, set it.
	Explain why.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 33
a450 7
      275: Add CW_SETENT, CW_GETENT, CW_ENDENT, CW_GETNSSSEP, CW_GETPWSID,
      	   CW_GETGRSID, CW_CYGNAME_FROM_WINNAME as no-ops for forward compat.
      276: Export ffsl, ffsll.
      277: Add setsockopt(SO_PEERCRED).
      278: Add quotactl.
      279: Export stime.
      280: Static atexit in libcygwin.a, CW_FIXED_ATEXIT.
d456 1
a456 1
#define CYGWIN_VERSION_API_MINOR 280
@


1.396
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 28.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 28
@


1.395
log
@* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 27.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 27
@


1.394
log
@	* common.din: Export posix_spawn[...] functions.
	* exec.cc (execve): Add EXPORT_ALIAS _execve.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
	* posix.sgml (std-susv4):  Add posix_spawn[...] here.
	(std-notimpl): Drop here.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 26
@


1.393
log
@* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 26.
@
text
@d444 1
d450 1
a450 1
#define CYGWIN_VERSION_API_MINOR 270
@


1.392
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Belatedly bump
	to 25.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 25
@


1.391
log
@	* fhandler_tape.cc (mtinfo_drive::create_partitions): Allow partitioning
	of drives supporting select partitions.
	(mtinfo_drive::get_status): Fill in current partition and number of
	partitions on tape into mt_resid.
	* include/cygwin/mtio.h (struct mtget): Align mt_resid comment to
	aforementioned change.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 24
@


1.390
log
@	* include/sys/cygwin.h (struct per_process): Add posix_memalign.  Reduce
	size of unused2 accordingly.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
	* lib/_cygwin_crt0_common.cc (_cygwin_crt0_common): Initialize
	u->posix_memalign with address of posix_memalign.
	* malloc_wrapper.cc (posix_memalign): Call user-provided posix_memalign
	rather than just returning ENOSYS.
	* globals.cc (__cygwin_user_data): Initialize posix_memalign member.
@
text
@d442 2
d449 1
a449 1
#define CYGWIN_VERSION_API_MINOR 269
@


1.389
log
@* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 24.
@
text
@d441 1
d447 1
a447 1
#define CYGWIN_VERSION_API_MINOR 268
@


1.388
log
@Fix copyright date
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 23
@


1.388.2.1
log
@* environ.cc (known): Add preload keyword.
* external.cc: Include new callout.h header.
(cygwin_internal): Initial implementation of CW_CALLOUT and CW_CYGHEAP_MALLOC.
(dll_preload): Handle CYGWIN=preload:foo.dll.
(dummy_callout): Default NULL callout function.
* globals.cc: Include new callout.h header.
(callout): Declare/define.
* uname.cc (uname): Initial implementation of callout handling.
* winsup.h (dll_preload): Declare.
* include/cygwin/version.h: Bump API minor number to 269.
* include/sys/cygwin.h: Define CW_CALLOUT, CW_CYGHEAP_MALLOC.
@
text
@a440 1
      269: Implement Cygwin callout functionality v1
d446 1
a446 1
#define CYGWIN_VERSION_API_MINOR 269
@


1.387
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 23.
@
text
@d4 1
a4 1
   2007, 2008, 2009, 2010, 2011, 2012 Red Hat, Inc.
@


1.386
log
@* common.din: Export GetCommandLine{A,W}.
* kernel32.cc: Add includes needed for GetCommandLine functions.
(ucmd): New function.
(cygwin_GetCommandLineW): Ditto.
(cygwin_GetCommandLineA): Ditto.
* spawn.cc (child_info_spawn::worker): Rename one_line -> cmd.  Use lb_wcs
macro to generate a wide character version of the line buffer.  Remove
duplicate printing of command line.  Don't access members of linebuf directly.
* winf.h: Use pragma once.
(linebuf): Make storage private.
(linebuf::operator size_t): New operator.  Return size of buf.
(linebuf::operator wchar_t): New operator.
(linebuf::wcs): New function.
(lb_wcs): New macro.
* include/cygwin/version.h: Bump API minor number to 268.
* strfuncs.cc: Clarify descriptive file comment.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 22
@


1.385
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 22.
@
text
@d440 1
d446 1
a446 1
#define CYGWIN_VERSION_API_MINOR 267
@


1.384
log
@* common.din (rawmemchr): Export.
* posix.sgml (std-gnu): Add rawmemchr.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 21
@


1.383
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 21.
@
text
@d439 1
d445 1
a445 1
#define CYGWIN_VERSION_API_MINOR 266
@


1.382
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 20.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 20
@


1.381
log
@	* Makefile.in (DLL_OFILES): Add arc4random.o.
	* common.din: Export arc4random, arc4random_addrandom, arc4random_buf,
	arc4random_stir and arc4random_uniform.
	* mktemp.cc (arc4random): Remove static replacement function.
	* posix.sgml (std-bsd): Add arc4random functions.
	* include/cygwin/stdlib.h: Declare arc4random functions.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
	* libc/arc4random.cc: New file implementing arc4random functions taken
	from FreeBSD.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 19
@


1.380
log
@	* libc/base64.c: New file.
	* Makefile.in (DLL_OFILES): Add base64.o.
	* common.din: Export __b64_ntop and __b64_pton.
	* posix.sgml (std-bsd): Add __b64_ntop and __b64_pton.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d437 2
d444 1
a444 1
#define CYGWIN_VERSION_API_MINOR 265
@


1.379
log
@* include/cygwin/version.h: Bump api minor number to reflect previous change.
@
text
@d436 1
d442 1
a442 1
#define CYGWIN_VERSION_API_MINOR 264
@


1.378
log
@Forced checkin
@
text
@d435 1
d441 1
a441 1
#define CYGWIN_VERSION_API_MINOR 263
@


1.377
log
@	* Merge in cygwin-64bit-branch.
@
text
@@


1.376
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 19.
@
text
@d4 1
a4 1
   2007, 2008, 2009, 2010, 2011, 2012, 2013 Red Hat, Inc.
@


1.375
log
@Throughout, update copyrights to reflect dates which correspond to main-branch
checkins.  Regularize copyright format.
@
text
@d4 1
a4 1
   2007, 2008, 2009, 2010, 2011, 2012 Red Hat, Inc.
d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 18
@


1.374
log
@* termios.cc (cfsetspeed): New function.
* cygwin.din (cfsetspeed): Export.
* posix.sgml (std-bsd): Add cfsetspeed.
* include/sys/termios.h (cfsetspeed): Declare.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d3 2
a4 2
   Copyright 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
   2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012 Red Hat, Inc.
@


1.373
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 18.
@
text
@d434 1
d440 1
a440 1
#define CYGWIN_VERSION_API_MINOR 262
@


1.372
log
@* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 17.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 17
@


1.372.2.1
log
@Merge changes from HEAD
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 18
@


1.372.2.2
log
@Pull in changes from HEAD
@
text
@a433 1
      263: Export cfsetspeed.
d439 1
a439 1
#define CYGWIN_VERSION_API_MINOR 263
@


1.372.2.3
log
@Pull in changes from HEAD
@
text
@d3 2
a4 2
   Copyright 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006,
   2007, 2008, 2009, 2010, 2011, 2012 Red Hat, Inc.
@


1.372.2.4
log
@Enforced checkin
@
text
@@


1.372.2.5
log
@Forced checkin
@
text
@@


1.372.2.6
log
@Forced checkin
@
text
@@


1.372.2.7
log
@Forced checkin
@
text
@@


1.372.2.8
log
@Pull in changes from HEAD
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 19
@


1.371
log
@	* cygwin.din (getmntent_r): Export.
	* mount.cc (getmntent_r): New function.
	* posix.sgml (std-gnu): Add getmntent_r.
	* include/mntent.h (getmntent_r): Declare.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 16
@


1.370
log
@	* cygwin.din (memrchr): Export.
	* posix.sgml (std-gnu): Add memrchr.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d433 1
d439 1
a439 1
#define CYGWIN_VERSION_API_MINOR 261
@


1.369
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 16.
@
text
@d432 1
d438 1
a438 1
#define CYGWIN_VERSION_API_MINOR 260
@


1.368
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 15.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 15
@


1.367
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 14.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 14
@


1.366
log
@	* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 13.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 13
@


1.365
log
@* include/cygwin/version.h (CYGWIN_VERSION_DLL_MINOR): Bump to 12.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 12
@


1.364
log
@	* cygwin.din (scandirat): Export.
	* posix.sgml (std-gnu): Add scandirat.
	* syscalls.cc (scandirat): New function.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
	* include/sys/dirent.h (scandirat): Declare.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 11
@


1.363
log
@* include/cygwin/version.h: Bump CYGWIN_VERSION_DLL_MINOR to 11.
@
text
@d431 1
d437 1
a437 1
#define CYGWIN_VERSION_API_MINOR 259
@


1.362
log
@Forced checkin for timestamp
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 10
@


1.361
log
@Update copyright on all files checked in so far this year.
* fhandler.h: Use #pragma once rather than ifdef guards.
(fhandler_console::tc_getpgid): Return our pgid if we have never opened a
console.
* fork.cc: Rearrange includes to accommodate fhandler.h use of pinfo.h.
* sigproc.cc: Ditto.
* spawn.cc: Ditto.
(child_info_spawn::worker): Query myself->pgid rather than calling expensive
function.
* thread.h: Use #pragma once rather than ifdef guards.
* pinfo.h: Use #pragma once rather than ifdef guards.
(pinfo::remember): Don't define if sigproc.h has not been included.
(pinfo::reattach): Ditto.
* sigproc.h: Use #pragma once rather than ifdef guards.  Use different test to
see if pinfo.h has been included.
@
text
@@


1.360
log
@	* cygwin.din (pthread_sigqueue): Export.
	* posix.sgml (std-gnu): Add pthread_sigqueue.
	* thread.cc (pthread_sigqueue): New function.
	* include/thread.h (pthread_sigqueue): New function.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d4 1
a4 1
   2005, 2006, 2007, 2008, 2009, 2010, 2011 Red Hat, Inc.
@


1.359
log
@	* cygwin.din (get_current_dir_name): Export.
	* path.cc (get_current_dir_name): New function.
	* posix.sgml (std-gnu): Add get_current_dir_name.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d430 1
d436 1
a436 1
#define CYGWIN_VERSION_API_MINOR 258
@


1.358
log
@	* cygwin.din (getpt): Export.
	* posix.sgml (std-gnu): Add getpt.
	* tty.cc (getpt): New function.
	* include/cygwin/stdlib.h [!__STRICT_ANSI__] (getpt): Declare.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d429 1
d435 1
a435 1
#define CYGWIN_VERSION_API_MINOR 257
@


1.357
log
@	* external.cc (cygwin_internal): Implement CW_ALLOC_DRIVE_MAP,
	CW_MAP_DRIVE_MAP, CW_FREE_DRIVE_MAP.
	* fhandler_process.cc: Include mount.h.
	(get_volume_path_names_for_volume_name): Move to mount.cc.
	(struct dos_drive_mappings): Ditto.
	* mount.cc (get_volume_path_names_for_volume_name): Move here.
	(dos_drive_mappings::dos_drive_mappings): Ditto.
	(dos_drive_mappings::fixup_if_match): Ditto.
	(dos_drive_mappings::~dos_drive_mappings): Ditto.
	* mount.h (class dos_drive_mappings): Declare her.
	* include/sys/cygwin.h (cygwin_getinfo_types): Add CW_ALLOC_DRIVE_MAP,
	CW_MAP_DRIVE_MAP, CW_FREE_DRIVE_MAP.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d428 1
d434 1
a434 1
#define CYGWIN_VERSION_API_MINOR 256
@


1.356
log
@* cygwin.din (ptsname_r): Export.
* fhandler.cc (fhandler_base::ptsname_r): Define.
* fhandler.h (fhandler_base::ptsname): Delete.
(fhandler_base::ptsname_r): Declare.
(fhandler_pty_master::ptsname_r): Declare.
* fhandler_tty.cc (fhandler_pty_master::ptsname): Delete.
(fhandler_pty_master::ptsname_r): New reentrant function derived from previous
ptsname.
* syscalls.cc (ptsname_r): Implement new function with functionality similar to
Linux.
(ptsname): Use ptsname_r () to fill out buf.
* include/cygwin/stdlib.h (ptsname_r): Declare.
* include/cygwin/version.h: Bump CYGWIN_VERSION_API_MINOR to 255 to reflect
export of ptsname_r.
* pinfo.cc (pinfo::wait): Return bool rather than int.
* pinfo.h (info::wait): Ditto.
(pinfo::reattach): Define !defined(_SIGPROC_H) case for consistency.
* sigproc.cc (child_info_spawn::reattach_children): Use correct dwProcessId
rather than pid when duplicating handle.
@
text
@d427 1
d433 1
a433 1
#define CYGWIN_VERSION_API_MINOR 255
@


1.355
log
@	* cygwin.din (getgrouplist): Export.
	* grp.cc (get_groups): New static function to run the core functionality
	of initgroups and getgrouplist.
	(initgroups32): Call get_groups and just create supplementary group
	list in cygheap.  Rename name of first argument to "user".  Add an
	assertion to test for a NULL user name.
	(initgroups): Rename name of first argument to "user".
	(getgrouplist): New function.
	* posix.sgml (std-bsd): Add getgrouplist.
	* include/cygwin/grp.h (getgrouplist): Declare.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d426 1
d432 1
a432 1
#define CYGWIN_VERSION_API_MINOR 254
@


1.354
log
@* cygwin.din: Remove some _tc* exports.  Add tcgetsid().
* dtable.cc (fh_alloc): Revert ill-advised setting of major/minor.  Use new
is_dev_tty to remember that this device was opened as /dev/tty.
* fhandler.cc (fhandler_base::fstat): Remove leftover debugging statement.
(fhandler_base::tcgetsid): New function.
* fhandler.h ((fhandler_base::tcgetsid): Declare new function.
(fhandler_base::is_dev_tty): Ditto.
(fhandler_termios::opened_as_dev_tty): Declare new field.
(fhandler_termios::is_dev_tty): Declare new function.
(fhandler_termios::tcgetsid): Ditto.
(fhandler_pty_common::use_archetype): Move here from subclass.
(fhandler_pty_slave::use_archetype): Move up.
(fhandler_pty_master::use_archetype): Ditto.
* fhandler_console.cc (fhandler_console::ioctl): Rename second argument from
`buf' to `arg' for consistency.  Call ioctl_termios for common fhandler_termios
ioctl handling.
* fhandler_tty.cc (fhandler_pty_slave::ioctl): Call ioctl_termios for common
fhandler_termios ioctl handling.
(fhandler_pty_master::ioctl): Ditto.
* fhandler_termios.cc (fhandler_termios::tcgetsid): Implement new function.
(fhandler_termios::ioctl_termios): Ditto.  Implements TIOCSCTTY handling.
* syscalls.cc (stat_worker): Set /dev/tty device info when appropriate.
* termios.cc (tcgetpgrp): Avoid extraneous "isatty" check.
(tcgetsid): Implement new function.
* include/cygwin/version.h: Bump CYGWIN_VERSION_API_MINOR to 253.
* include/sys/termios.h (TIOCSCTTY): Define.
@
text
@d425 1
d431 1
a431 1
#define CYGWIN_VERSION_API_MINOR 253
@


1.353
log
@	* external.cc (create_winenv): Rename from sync_winenv.  Take
	environment pointer as parameter and return pointer to corresponding
	win32 environment block if != NULL.  Otherwise just sync as before.
	(cygwin_internal): Add CW_CVT_ENV_TO_WINENV case.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/cygwin.h (cygwin_getinfo_types): Add CW_CVT_ENV_TO_WINENV.
@
text
@d424 1
d430 1
a430 1
#define CYGWIN_VERSION_API_MINOR 252
@


1.352
log
@	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d423 1
d429 1
a429 1
#define CYGWIN_VERSION_API_MINOR 251
@


1.351
log
@* cygwin.din (clock_nanosleep): Export.
* posix.sgml (std-notimpl): Move clock_nanosleep from here...
(std-susv4): ... to here.
(std-notes): Note limitations of clock_nanosleep.
* signal.cc (clock_nanosleep): Renamed from nanosleep, adding clock_id
and flags arguments and changing return values throughout.
Improve checks for illegal rqtp values.  Add support for
CLOCK_MONOTONIC and TIMER_ABSTIME.
(nanosleep): Rewrite in terms of clock_nanosleep.
(sleep): Ditto.
(usleep): Ditto.
* thread.cc: Mark clock_nanosleep in list of cancellation points.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d422 1
d428 1
a428 1
#define CYGWIN_VERSION_API_MINOR 250
@


1.350
log
@* cygwin.din (pthread_condattr_getclock): Export.
(pthread_condattr_setclock): Export.
* posix.sgml (std-notimpl): Move pthread_condattr_getclock and
pthread_condattr_setclock from here...
(std-susv4): ... to here.
* sysconf.cc (sca): Set _SC_CLOCK_SELECTION to _POSIX_CLOCK_SELECTION.
* thread.cc: (pthread_condattr::pthread_condattr): Initialize clock_id.
(pthread_cond::pthread_cond): Initialize clock_id.
(pthread_cond_timedwait): Use clock_gettime() instead of gettimeofday()
in order to support all allowed clocks.
(pthread_condattr_getclock): New function.
(pthread_condattr_setclock): New function.
* thread.h (class pthread_condattr): Add clock_id member.
(class pthread_cond): Ditto.
* include/pthread.h: Remove obsolete comment.
(pthread_condattr_getclock): Declare.
(pthread_condattr_setclock): Declare.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d421 1
d427 1
a427 1
#define CYGWIN_VERSION_API_MINOR 249
@


1.349
log
@* cygwin.din (__fpurge): Export.
* posix.sgml (std-solaris): Add __fpurge.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d420 1
d426 1
a426 1
#define CYGWIN_VERSION_API_MINOR 248
@


1.348
log
@* cygwin.din (error): Export.
(error_at_line): Export.
(error_message_count): Export.
(error_one_per_line): Export.
(error_print_progname): Export.
* errno.cc (error_message_count): Define.
(error_one_per_line): Define.
(error_print_progname): Define.
(_verror): New static function.
(error): New function.
(error_at_line): New function.
* posix.sgml (std-gnu): Add error, error_at_line.
* include/error.h: New header.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d419 1
d425 1
a425 1
#define CYGWIN_VERSION_API_MINOR 247
@


1.347
log
@* cygwin.din (clock_getcpuclockid): Export.
(pthread_getcpuclockid): Export.
* hires.h (PID_TO_CLOCKID): New macro.
(CLOCKID_TO_PID): New macro.
(CLOCKID_IS_PROCESS): New macro.
(THREADID_TO_CLOCKID): New macro.
(CLOCKID_TO_THREADID): New macro.
(CLOCKID_IS_THREAD): New macro.
* ntdll.h (enum _THREAD_INFORMATION_CLASS): Add ThreadTimes.
* posix.sgml (std-notimpl): Add clock_getcpuclockid and
pthread_getcpuclockid from here...
(std-susv4): ... to here.
(std-notes): Remove limitations of clock_getres and clock_gettime.
Note limitation of timer_create to CLOCK_REALTIME.
* sysconf.cc (sca): Set _SC_CPUTIME to _POSIX_CPUTIME, and
_SC_THREAD_CPUTIME to _POSIX_THREAD_CPUTIME.
* thread.cc (pthread_getcpuclockid): New function.
* timer.cc (timer_create): Set errno to ENOTSUP for CPU-time clocks.
* times.cc (clock_gettime): Handle CLOCK_PROCESS_CPUTIME_ID and
CLOCK_THREAD_CPUTIME_ID.
(clock_getres): Ditto.
(clock_settime): Set errno to EPERM for CPU-time clocks.
(clock_getcpuclockid): New function.
* include/pthread.h (pthread_getcpuclockid): Declare.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d417 2
d424 1
a424 1
#define CYGWIN_VERSION_API_MINOR 246
@


1.346
log
@	* cygwin.din (pthread_attr_getguardsize): Export.
	(pthread_attr_setguardsize): Export.
	(pthread_attr_setstack): Export.
	(pthread_attr_setstackaddr): Export.
	* init.cc (dll_entry): Remove wow64_test_stack_marker.  Check for
	unusual stack address by testing stack addresses from current TEB.
	Check validity of _my_tls by testing if it's within the stack as
	given in current TEB.
	* miscfuncs.cc (struct thread_wrapper_arg): New structure used to
	push all required information to thread_wrapper function.
	(thread_wrapper): Wrapper function for actual thread function.
	If an application stack has been given, change %ebp and %esp so that
	the thread function runs on that stack.  If the thread has been created
	by CygwinCreateThread, set up the POSIX guard pages if necessary.
	(CygwinCreateThread): New function.
	* miscfuncs.h (CygwinCreateThread): Declare.
	* ntdll.h (struct _TEB): Define all members up to Peb.
	* posix.sgml (std-susv4): Move pthread_attr_getguardsize,
	pthread_attr_setguardsize and pthread_attr_setstack here.
	(std-deprec): Add pthread_attr_setstackaddr.
	* sysconf.cc (sca): Set _SC_THREAD_ATTR_STACKADDR to
	_POSIX_THREAD_ATTR_STACKADDR.
	* thread.cc (pthread::precreate): Copy pthread_attr stackaddr and
	guardsize members.
	(pthread::create): Call CygwinCreateThread.
	(pthread_attr::pthread_attr): Initialize guardsize.
	(pthread_attr_setstack): New function.
	(pthread_attr_setstackaddr): New function.
	(pthread_attr_setguardsize): New function.
	(pthread_attr_getguardsize): New function.
	(pthread_getattr_np): Copy attr.guardsize.
	* thread.h (pthread_attr): Add member guardsize.
	* include/pthread.h (pthread_attr_getguardsize): Declare.
	(pthread_attr_setguardsize): Declare.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d415 2
d422 1
a422 1
#define CYGWIN_VERSION_API_MINOR 245
@


1.345
log
@* times.cc (settimeofday): Add EFAULT handler.
Set errno to EINVAL if tv.tv_nsec is invalid, and to EPERM if
SetSystemTime fails.  Return -1 in case of failure, all for
compatibility with BSD and Linux.
(clock_settime): New function.
* cygwin.din (clock_settime): Export.
* posix.sgml (std-susv4): Add clock_settime.
Move clock_setres from here...
(std-deprec): ... to here.
(std-notes): Correct limitation of clock_setres to only CLOCK_REALTIME.
Add limitation of clock_settime to only CLOCK_REALTIME.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d413 2
d420 1
a420 1
#define CYGWIN_VERSION_API_MINOR 244
@


1.344
log
@* sysconf.cc (sysinfo): New function.
* cygwin.din (sysinfo): Export.
* posix.sgml (std-gnu): Add sysinfo.
* include/sys/sysinfo.h (struct sysinfo): Define.
(sysinfo): Declare.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d412 1
d418 1
a418 1
#define CYGWIN_VERSION_API_MINOR 243
@


1.343
log
@* cygwin.din (psiginfo): Export.
(psignal): Export.
(sys_siglist): Export.
* posix.sgml (std-notimpl): Move psiginfo and psignal from here...
(std-susv4): ... to here.
(std-deprec): Add sys_siglist.
* strsig.cc (sys_siglist): New array.
(psiginfo): New function.
* include/cygwin/signal.h (sys_siglist): Declare.
(psiginfo): Declare.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d411 1
d417 1
a417 1
#define CYGWIN_VERSION_API_MINOR 242
@


1.342
log
@* cygwin.din (pthread_attr_getstack): Export.
(pthread_attr_getstackaddr): Export.
(pthread_getattr_np): Export.
* ntdll.h (enum _THREAD_INFORMATION_CLASS): Add ThreadBasicInformation.
(struct _THREAD_BASIC_INFORMATION): Define.
(NtQueryInformationThread): Declare.
* posix.sgml (std-susv4): Add pthread_attr_getstack.
(std-gnu): Add pthread_getattr_np.
(std-deprec): Add pthread_attr_getstackaddr.
(std-notimpl): Remove pthread_attr_[gs]etstackaddr, as they were
removed from SUSv4.
* thread.cc (pthread_attr::pthread_attr): Initialize stackaddr.
(pthread_attr_getstack): New function.
(pthread_attr_getstackaddr): New function.
(pthread_attr_setstacksize): Return EINVAL if passed size less than
PTHREAD_STACK_MIN, as required by POSIX.
(pthread_getattr_np): New function.
* thread.h (class pthread_attr): Add stackaddr member.
* include/pthread.h (pthread_attr_getstack): Declare.
(pthread_attr_getstackaddr): Declare unconditionally.
(pthread_attr_setstack): Declare inside false conditional for reference.
(pthread_getattr_np): Declare.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d410 1
d416 1
a416 1
#define CYGWIN_VERSION_API_MINOR 241
@


1.341
log
@	* cygwin.din (ppoll): Export.
	* poll.cc (ppoll): Implement.
	* posix.sgml (std-gnu): Add ppoll.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/poll.h (ppoll): Declare.
@
text
@d408 2
d415 1
a415 1
#define CYGWIN_VERSION_API_MINOR 240
@


1.340
log
@* thread.cc (pthread_setschedprio): New function.
* include/pthread.h (pthread_setschedprio): Declare.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
* cygwin.din (pthread_setschedprio): Export.
* posix.sgml (std-notimpl) Move pthread_setschedprio from here...
(std-susv4) ...to here.
@
text
@d407 1
d413 1
a413 1
#define CYGWIN_VERSION_API_MINOR 239
@


1.339
log
@	* cygwin.din (pthread_spin_destroy): Export.
	(pthread_spin_init): Export.
	(pthread_spin_lock): Export.
	(pthread_spin_trylock): Export.
	(pthread_spin_unlock): Export.
	* posix.sgml (std-susv4): Add pthread_spin_destroy, pthread_spin_init,
	pthread_spin_lock, pthread_spin_trylock, pthread_spin_unlock.
	(std-notimpl): Remove pthread_spin_[...].
	* pthread.cc (pthread_spin_init): New function.
	* thread.cc (pthread_spinlock::is_good_object): New function.
	(pthread_mutex::pthread_mutex): Rearrange initializers to accommodate
	protected data in pthread_mutex.
	(pthread_spinlock::pthread_spinlock): New constructor.
	(pthread_spinlock::lock): New method.
	(pthread_spinlock::unlock): New method.
	(pthread_spinlock::init): New method.
	(pthread_spin_lock): New function.
	(pthread_spin_trylock): New function.
	(pthread_spin_unlock): New function.
	(pthread_spin_destroy): New function.
	* thread.h (PTHREAD_SPINLOCK_MAGIC): Define.
	(class pthread_mutex): Change access level of members shared with
	derived classes to protected.
	(pthread_mutex::set_shared): New protected method.
	(class pthread_spinlock): New class, derived class of pthread_mutex.
	* include/pthread.h (pthread_spin_destroy): Declare.
	(pthread_spin_init): Declare.
	(pthread_spin_lock): Declare.
	(pthread_spin_trylock): Declare.
	(pthread_spin_unlock): Declare.
	* include/cygwin/types.h (pthread_spinlock_t): New typedef.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d406 1
d412 1
a412 1
#define CYGWIN_VERSION_API_MINOR 238
@


1.338
log
@	* include/cygwin/version.h: Bump CYGWIN_VERSION_DLL_MINOR to 10.
@
text
@d404 2
d411 1
a411 1
#define CYGWIN_VERSION_API_MINOR 237
@


1.337
log
@	* cygwin.din (strchrnul): Export.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
	* posix.sgml (std-gnu): Add strchrnul.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 9
@


1.336
log
@* include/cygwin/version.h: Bump CYGWIN_VERSION_DLL_MINOR to 9.
@
text
@d403 1
d409 1
a409 1
#define CYGWIN_VERSION_API_MINOR 236
@


1.336.2.1
log
@	* cygwin.din (pthread_spin_destroy): Export.
	(pthread_spin_init): Export.
	(pthread_spin_lock): Export.
	(pthread_spin_trylock): Export.
	(pthread_spin_unlock): Export.
	* posix.sgml (std-susv4): Add pthread_spin_destroy, pthread_spin_init,
	pthread_spin_lock, pthread_spin_trylock, pthread_spin_unlock.
	(std-notimpl): Remove pthread_spin_[...].
	* pthread.cc (pthread_spin_init): New function.
	* thread.cc (pthread_spinlock::is_good_object): New function.
	(pthread_mutex::pthread_mutex): Rearrange initializers to accommodate
	protected data in pthread_mutex.
	(pthread_spinlock::pthread_spinlock): New constructor.
	(pthread_spinlock::lock): New method.
	(pthread_spinlock::unlock): New method.
	(pthread_spinlock::init): New method.
	(pthread_spin_lock): New function.
	(pthread_spin_trylock): New function.
	(pthread_spin_unlock): New function.
	(pthread_spin_destroy): New function.
	* thread.h (PTHREAD_SPINLOCK_MAGIC): Define.
	(class pthread_mutex): Change access level of members shared with
	derived classes to protected.
	(pthread_mutex::set_shared): New protected method.
	(class pthread_spinlock): New class, derived class of pthread_mutex.
	* include/pthread.h (pthread_spin_destroy): Declare.
	(pthread_spin_init): Declare.
	(pthread_spin_lock): Declare.
	(pthread_spin_trylock): Declare.
	(pthread_spin_unlock): Declare.
	* include/cygwin/types.h (pthread_spinlock_t): New typedef.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@a402 2
      237: Export pthread_spin_destroy, pthread_spin_init, pthread_spin_lock,
	   pthread_spin_trylock, pthread_spin_unlock.
d408 1
a408 1
#define CYGWIN_VERSION_API_MINOR 237
@


1.336.2.2
log
@Pull in HEAD changes
@
text
@d403 1
a403 2
      237: Export strchrnul.
      238: Export pthread_spin_destroy, pthread_spin_init, pthread_spin_lock,
d410 1
a410 1
#define CYGWIN_VERSION_API_MINOR 238
@


1.335
log
@Forced checkin
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 8
@


1.334
log
@strerror_r: obey POSIX, and match newlib header change

* errno.cc (__xpg_strerror_r): New function.
(strerror_r): Update to copy newlib's fixes.
(strerror): Set errno on failure.
(_sys_errlist): Cause EINVAL failure for reserved values.
* cygwin.din: Export new function.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Combine
this into minor 236.
@
text
@@


1.333
log
@* cygwin.din (pthread_yield): Export as alias to sched_yield.
* include/pthread.h (pthread_yield): Declare.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
* posix.sgml (std-deprec): Add pthread_yield.
@
text
@d402 1
a402 1
      236: Export pthread_yield.
@


1.332
log
@	* cygwin.din (madvise): Export posix_madvise as madvise.
	* include/cygwin/version.h: Bump CYGWIN_VERSION_API_MINOR.
	* include/sys/mman.h: Define madvise constants, keep Linux-specific
	constants undefined.
	(madvise): Declare.
@
text
@d402 1
d408 1
a408 1
#define CYGWIN_VERSION_API_MINOR 235
@


1.331
log
@* include/cygwin/version.h: Bump CYGWIN_VERSION_API_MINOR to 234.
@
text
@d4 1
a4 1
   2005, 2006, 2007, 2008, 2009, 2010 Red Hat, Inc.
d400 2
a401 1
      234: Export program_invocation_name, program_invocation_short_name
d407 1
a407 1
#define CYGWIN_VERSION_API_MINOR 234
@


1.330
log
@	* posix.sgml: Move llround and llroundf to implemented SUSv4 functions.
	* include/cygwin/version.h: Add llround and llroundf to the comment for
	the 233 CYGWIN_VERSION_API_MINOR bump.
@
text
@d400 1
d406 1
a406 1
#define CYGWIN_VERSION_API_MINOR 233
@


1.329
log
@* include/cygwin/version.h: Bump CYGWIN_VERSION_API_MINOR to 233.
@
text
@d399 1
a399 1
      233: Add TIOCGPGRP, TIOCSPGRP.
@


1.328
log
@	* cygwin.din: Export new complex math functions from newlib.
	* posix.sgml: Move newly exported complex functions to implemented
	SUSv4 functions.
	* include/cygwin/version.h: Bump API minor version.
@
text
@d399 1
d405 1
a405 1
#define CYGWIN_VERSION_API_MINOR 232
@


1.327
log
@winsup/cygwin/ChangeLog:

	* Makefile.in (DLL_OFILES): Add new fenv.o module.
	(fenv_CFLAGS): New flags definition for fenv.o compile.
	* autoload.cc (std_dll_init): Use fenv.h functions instead of direct
	manipulation of x87 FPU registers.
	* crt0.c (mainCRTStartup): Likewise.
	* cygwin.din (feclearexcept, fegetexceptflag, feraiseexcept,
	fesetexceptflag, fetestexcept, fegetround, fesetround, fegetenv,
	feholdexcept, fesetenv, feupdateenv, fegetprec, fesetprec,
	feenableexcept, fedisableexcept, fegetexcept, _feinitialise,
	_fe_dfl_env, _fe_nomask_env): Export new functions and data items.
	* fenv.cc: New file.
	* posix.sgml: Update status of newly-implemented APIs.
	* include/fenv.h: Likewise related header.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d394 5
d404 1
a404 1
#define CYGWIN_VERSION_API_MINOR 231
@


1.326
log
@	* include/cygwin/version.h: Bump DLL minor version number to 8.
@
text
@d393 1
d399 1
a399 1
#define CYGWIN_VERSION_API_MINOR 230
@


1.325
log
@	* include/cygwin/version.h: Bump DLL minor version number to 7.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 7
@


1.324
log
@	* external.cc (sync_wincwd): Remove.
	(cygwin_internal): Drop CW_SYNC_WINCWD case.
	* globals.cc (ro_u_pipedir): New R/O unicode string.
	* ntdll.h (RtlSetCurrentDirectory_U): Declare.
	* path.cc (cwdstuff::set): Improve comments.  Drop setting Win32 CWD to
	\\?\PIPE\ on init.  Keep Win32 CWD in sync, if possible.  Set to
	\\?\PIPE\ otherwise.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Revert to 230.
	* include/sys/cygwin.h (cygwin_getinfo_types): Remove CW_SYNC_WINCWD.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 6
@


1.323
log
@	* include/cygwin/version.h: Fix comment.
@
text
@a392 1
      231: CW_SYNC_WINCWD.
d398 1
a398 1
#define CYGWIN_VERSION_API_MINOR 231
@


1.322
log
@* external.cc (CW_SETCWD): New option.
* include/cygwin/version.h: Bump api minor to 231.
* include/sys/cygwin.h (CW_SETCWD): Define.
@
text
@d393 1
a393 1
      231: CW_SETCWD
@


1.321
log
@	* include/cygwin/version.h: Bump DLL minor version number to 6.
@
text
@d393 1
d399 1
a399 1
#define CYGWIN_VERSION_API_MINOR 230
@


1.320
log
@Implement POSIX.1-2004 Monotonic Clock.
* hires.h: Change hires_us to hires_ns, with nanosecond resolution.
(hires_ns::primed_ft): Remove.
(hires_ns::nsecs): New prototype.
(hires_ns::usecs): Rewrite in terms of nsecs.
(hires_ns::resolution): New prototype.
* times.cc: Change hires_us to hires_ns.
(ntod): Declare.
(systime): Remove.
(hires_ns::prime): Increase resolution to nanoseconds.
(hires_ns::nsecs): Rename usecs to nsecs to reflect increased resolution.
Remove justdelta argument.
(hires_ns::resolution): New function.
(clock_gettime): Accept CLOCK_MONOTONIC.
Use EINVAL instead of ENOSYS per POSIX.1-2004.
(clock_getres): Ditto.
(clock_setres): Use EINVAL instead of ENOSYS to conform with other
implementations.
* strace.cc (strace::microseconds): Adjust for hires_ns.
* sysconf.cc (sca): Set _SC_MONOTONIC_CLOCK to _POSIX_MONOTONIC_CLOCK.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 5
@


1.319
log
@Add mkostemp and mkostemps.

* mktemp.cc (_gettemp): Add flags argument.  All callers updated.
(mkostemp, mkostemps): New functions.
* cygwin.din (mkostemp, mkostemps): Export.
* posix.sgml: Document them.
* include/cygwin/version.h: Bump version.
@
text
@d392 1
d398 1
a398 1
#define CYGWIN_VERSION_API_MINOR 229
@


1.318
log
@* path.cc (path_conv::check): Move fs-specific settings to a point where we
know that we have filled out the filesystem information.
* path.h (path_conv::path_conv): Use consistent initialization for
constructors.
* include/sys/cygwin.h: Define CW_STRERROR.
* include/cygwin/version.h: Bump CYGWIN_VERSION_API_MINOR to 228.
* include/external.h: Implement CW_STRERROR.
@
text
@d391 1
d397 1
a397 1
#define CYGWIN_VERSION_API_MINOR 228
@


1.317
log
@* Makefile.in (DLL_OFILES): Add pseudo-reloc.o.
* dcrt0.cc (child_info_fork::handle_fork): Call _pei386_runtime_relocator here.
(dll_crt0_1): Ditto for non-fork case.
* dll_init.cc (dll::init): Complain more in comment.  Clean up slightly.
(dll_dllcrt0_1): Call _pei386_runtime_relocator when we know we have a
filled-in per_process structure.
* globals.cc (__cygwin_user_data): Accommodate new fields for
_pei386_runtime_relocator.
* pseudo-reloc.cc: New file adapted from old lib/pseudo-reloc.c.  Include
winsup.h directly.  Collapse #ifdef __CYGWIN__ into one block.  Perform minor
whitespace code reformatting.
(__report_error): Use small_printf to output error.
(_pei386_runtime_relocator): Conditionalize for cygwin to take per_process
pointer parameter.
* winsup.h (_pei386_runtime_relocator): Declare.
* include/cygwin/version.h
(CYGWIN_VERSION_PER_PROCESS_API_VERSION_COMBINED): New macro.
(CYGWIN_VERSION_USER_API_VERSION_COMBINED): Use above macro.
(CYGWIN_VERSION_USE_PSEUDO_RELOC_IN_DLL): New macro.
(CYGWIN_VERSION_API_MINOR): Bump to 227.
* include/sys/cygwin.h: Remove obsolete comment.
(per_process::unused2): Shorten.
(per_process::pseudo_reloc_start): New field.
(per_process::pseudo_reloc_end): Ditto.
(per_process::image_base): Ditto.
* lib/_cygwin_crt0_common.cc: Declare pseudo runtime externs needed for
per_process structure.
(_cygwin_crt0_common): Fill in pseudo_reloc runtime constants.
* lib/pseudo-reloc-dummy.c: New file.  Dummy function to satisify ld.
* lib/pseudo-reloc.c: Delete.
@
text
@d389 2
a390 1
      227: Add pseudo_reloc_start, pseudo_reloc_end, image_base to per_process
d396 1
a396 1
#define CYGWIN_VERSION_API_MINOR 227
@


1.316
log
@	* include/cygwin/version.h: Bump API minor version.
@
text
@d65 3
d69 1
a69 1
  CYGWIN_VERSION_DLL_MAKE_COMBINED (user_data->api_major, user_data->api_minor)
d104 3
d389 1
d395 1
a395 1
#define CYGWIN_VERSION_API_MINOR 226
@


1.315
log
@	* include/cygwin/version.h: Bump DLL minor version number to 5.
@
text
@d382 1
d388 1
a388 1
#define CYGWIN_VERSION_API_MINOR 225
@


1.314
log
@	* include/cygwin/version.h: Bump DLL minor version number to 4.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 4
@


1.313
log
@	* include/cygwin/version.h: Bump DLL minor version number to 3.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 3
@


1.312
log
@	* cygwin.din: Export __xdr functions.
	* include/cygwin/version.h: Bump version.
	* posix.sgml: Add a few more XDR functions to list
	of implemented Solaris functions.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 2
@


1.311
log
@	Add XDR support.
	* cygwin.din: Export xdr functions.
	* include/cygwin/version.h: Bump version.
	* cygxdr.cc: New.
	* cygxdr.h: New.
	* dcrt0.cc (dll_crt0_1): Print the (rare) xdr-related
	error messages to stderr.
	* Makefile.in: Add cygxdr.
	* posix.sgml: Add new XDR functions to list of implemented Solaris
	functions.
@
text
@d381 1
d387 1
a387 1
#define CYGWIN_VERSION_API_MINOR 224
@


1.310
log
@	* include/cygwin/signal.h: Define SIGPWR as synonym for SIGLOST.
	* strsig.cc: Ditto.
	* include/cygwin/version.h: Bump CYGWIN_VERSION_API_MINOR.
@
text
@d380 1
d386 1
a386 1
#define CYGWIN_VERSION_API_MINOR 223
@


1.309
log
@	* external.cc (cygwin_internal): Add CW_INT_SETLOCALE case to
	allow to call internal_setlocale().
	* nlsfuncs.cc (internal_setlocale): Make externally available.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/cygwin.h (cygwin_getinfo_types): Add CW_INT_SETLOCALE.

	* nlsfuncs.cc (lc_mbstowcs): Fix call to f_mbtowc.
	(__set_locale_from_locale_alias): Ignore "@@cjknarrow" modifier.
@
text
@d379 1
d385 1
a385 1
#define CYGWIN_VERSION_API_MINOR 222
@


1.308
log
@	* Makefile.in (DLL_OFILES): Add nlsfunc.o and strfmon.o.
	* autoload.cc (LocaleNameToLCID): Define.
	* cygwin.din (strfmon): Export.
	* nlsfuncs.cc: New file.  Define a lot of internal functions called
	from setlocale.
	(wcscoll): Implement locale-aware here, using CompareStringW function.
	(strcoll): Ditto.
	(wcsxfrm): Implement locale-aware here, usingLCMapStringW function.
	(strxfrm): Ditto.
	(__set_charset_from_locale): Replace __set_charset_from_codepage.
	Return Linux-compatible charset.
	* strfuncs.cc (__set_charset_from_codepage): Remove.
	* wchar.h (__set_charset_from_codepage): Drop definition.
	* wincap.h (wincaps::has_localenames): New element.
	* wincap.cc: Implement above element throughout.
	* libc/strfmon.c: New file.
	* libc/strptime.cc: Remove locale constant strings in favor of
	access to locale-specifc data.
	(strptime): Point _CurrentTimeLocale to locale-specific data.
	Throughout use correct locale-specific format fields for all
	locale-specific formats.
	* include/monetary.h: New file.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d378 1
d384 1
a384 1
#define CYGWIN_VERSION_API_MINOR 221
@


1.307
log
@	* cygwin.din (accept4): Export.
	* fhandler.h (fhandler_socket::accept4): Rename from accept.  Take
	additional flag parameter.
	* fhandler_socket.cc (fhandler_socket::accept4): Ditto.  Handle
	SOCK_NONBLOCK and SOCK_CLOEXEC flags.
	* net.cc (cygwin_socket): Handle SOCK_NONBLOCK and SOCK_CLOEXEC flags
	in type.  Check for invalid flag values.
	(socketpair): Ditto.
	(cygwin_accept): Accommodate renaming of fhandler_socket::accept
	function to accept4.
	(accept4): New function.
	* posix.sgml: Mention accept4 as GNU extensions.
	* include/cygwin/socket.h (SOCK_NONBLOCK): Define.
	(SOCK_CLOEXEC): Define.
	(_SOCK_FLAG_MASK): Define when building Cygwin.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
	* include/sys/socket.h (accept4): Declare.
@
text
@d377 1
d383 1
a383 1
#define CYGWIN_VERSION_API_MINOR 220
@


1.306
log
@	* cygwin.din (dup3): Export.
	(pipe2): Export.
	* dtable.cc (dtable::dup_worker): Take additional flags parameter.
	Handle O_CLOEXEC flag.
	(dtable::dup3): Rename from dup2.  Take additional flags parameter.
	Check for valid flags.  Drop check for newfd == oldfd.
	* dtable.h (dtable::dup_worker): Add flags parameter.
	(dtable::dup3): Rename from dup2.
	* fcntl.cc (fcntl64): Add F_DUPFD_CLOEXEC case.
	* fhandler.h (fhandler_mailslot::get_object_attr): Add flags parameter.
	* fhandler.cc (fhandler_base::open): Use security attribute with
	inheritance according to setting of O_CLOEXEC flag.
	* fhandler_console.cc (fhandler_console::open): Ditto.
	* fhandler_fifo.cc (sec_user_cloexec): New inline function to
	create security attribute with inheritance according to setting of
	O_CLOEXEC flag.
	(fhandler_fifo::open): Call sec_user_cloexec to fetch security
	attribute.
	(fhandler_fifo::wait): Ditto.
	* fhandler_mem.cc (fhandler_dev_mem::open): Ditto.
	* fhandler_mailslot.cc (fhandler_mailslot::get_object_attr): Take
	additional flags parameter.  Use security attribute with inheritance
	according to setting of O_CLOEXEC flag.
	(fhandler_mailslot::open): Call get_object_attr with flags parameter.
	* fhandler_registry.cc (fhandler_registry::open): Call set_close_on_exec
	on real handles to accommodate O_CLOEXEC flag.
	* fhandler_tty.cc (fhandler_tty_slave::open): Ditto.
	* fhandler_tape.cc: Create mutex with inheritance according to setting
	of O_CLOEXEC flag.
	* pipe.cc: Replace usage of O_NOINHERIT with O_CLOEXEC.
	 (fhandler_pipe::init): Simplify setting close_on_exec flag.
	(fhandler_pipe::open): Remove setting close_on_exec flag.
	(fhandler_pipe::create): Use security attribute with inheritance
	according to setting of O_CLOEXEC flag.
	(pipe2): New exported function.
	* posix_ipc.cc: Throughout, open backing files with O_CLOEXEC
	flag to follow POSIX semantics.
	* security.h (sec_none_cloexec): New define.
	* syscalls.cc (dup): Add missing extern "C" qualifier.  Accommodate
	renaming of dtable::dup2 to dtable::dup3.
	(dup2): Ditto.  Check newfd == oldfd here.
	(dup3): New function.  Check newfd == oldfd here.
	(open): Set close_on_exec flag according to O_CLOEXEC flag before
	calling fhandler->open.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d4 1
a4 1
   2005, 2006, 2007, 2008, 2009 Red Hat, Inc.
d376 1
d382 1
a382 1
#define CYGWIN_VERSION_API_MINOR 219
@


1.305
log
@* fhandler_fifo.cc (fhandler_fifo::open): Avoid resetting errno after it has
been explicitly set.
* include/cygwin/version.h: Bump DLL minor version number to 2.
@
text
@d375 1
d381 1
a381 1
#define CYGWIN_VERSION_API_MINOR 218
@


1.304
log
@	* include/cygwin/version.h: Bump DLL minor version number to 1.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 1
@


1.303
log
@	* sysconf.cc (get_nprocs): New function.
	(get_nprocs_conf): Ditto.
	(get_avphys_pages): Ditto.
	(get_phys_pages): Ditto.
	* cygwin.din: Export them.
	* include/sys/sysinfo.h: New header, decalre above new functions.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
	* posix.sgml: Mention them as GNU extensions.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 0
@


1.302
log
@	* cygprops.h: New file.
	* dtable.cc (handle_to_fn): Add check for correct installation_key
	string in object name for pipes and ttys.
	* external.cc (cygwin_internal): Add CW_GET_INSTKEY to allow fetching
	the installation_key from cygserver.
	* fhandler_fifo.cc (fhandler_fifo::fifo_name): Add installation_key
	to fifo name.
	* globals.cc: Include cygprops.h.
	(_RDATA): Move slightly and add comment.
	(cygwin_props): Define.
	* mount.cc (mount_info::init): Accommodate the fact that
	installation_root is now a global variable in DLL common shared memory,
	rather than a member of cygwin_shared.
	* pipe.cc (fhandler_pipe::create_selectable): Add installation_key to
	pipe name.
	* shared.cc (installation_root): Define here for storage in DLL
	common shared memory.
	(installation_key): Ditto.
	(installation_key_buf): Ditto.
	(init_installation_root): Convert from shared_info method to ordinary
	function.  Add initializing installation_key.  Invalidate
	installation_key depending of value of disable_key property.  Add
	comment to explain.
	(get_shared_parent_dir): Add installation_key to directory name.
	(get_session_parent_dir): Ditto.
	(shared_info::initialize): Move call to init_installation_root from
	here...
	(memory_init): ...to here.  Add debug output to print installation root
	and installation key.  Add comment to explain why.
	* shared_info.h (SHARED_INFO_CB): Recalculate.
	(CURR_SHARED_MAGIC): Ditto.
	(class shared_info): Remove definition of installation_root and
	declaration of init_installation_root.
	(init_installation_root): Declare.
	(installation_root): Declare.
	(installation_key): Declare.
	* uinfo.cc (pwdgrp::load): Accommodate the fact that installation_root
	is now a global variable in DLL common shared memory.
	* include/cygwin/version.h: Bump API minor number.
	(CYGWIN_INFO_INSTALLATIONS_NAME): Add.
	* include/sys/cygwin.h (cygwin_getinfo_types): Add CW_GET_INSTKEY.
@
text
@d374 1
d380 1
a380 1
#define CYGWIN_VERSION_API_MINOR 217
@


1.301
log
@	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d373 1
d379 1
a379 1
#define CYGWIN_VERSION_API_MINOR 216
d414 1
@


1.300
log
@Add cygwin wrapper for ExitProcess and TerminateProcess.
@
text
@d372 1
d378 1
a378 1
#define CYGWIN_VERSION_API_MINOR 215
@


1.299
log
@Add fexecve, execvpe.

* exec.cc (fexecve): New function.
* cygwin.din (execvpe, fexecve): Export new fexecve and existing
execvpe.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
* posix.sgml: Mention them.
@
text
@d371 1
d377 1
a377 1
#define CYGWIN_VERSION_API_MINOR 214
@


1.298
log
@Provide euidaccess, canonicalize_file_name; fix fchmodat.

* syscalls.cc (fchmodat): lchmod is not yet implemented.
(euidaccess): New function.
* path.cc (realpath): Update comment.
(canonicalize_file_name): New function.
* include/cygwin/stdlib.h (canonicalize_file_name): Declare it.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
* cygwin.din: Export canonicalize_file_name, eaccess, euidaccess.
* posix.sgml: Mention them.
@
text
@d370 1
d376 1
a376 1
#define CYGWIN_VERSION_API_MINOR 213
@


1.297
log
@winsup/ChangeLog:

	* Makefile.common (COMPILE_CXX): Add support for per-file overrides
	to exclude $(nostdinc) and $(nostdincxx) from compiler flags.
	(COMPILE_CC): Likewise for $(nostdinc).

winsup/cygwin/ChangeLog:

	* Makefile.in (DLL_OFILES): Add libstdcxx_wrapper.o
	(libstdcxx_wrapper_CFLAGS): Add flags for new module.
	(_cygwin_crt0_common_STDINCFLAGS): Define per-file override.
	(libstdcxx_wrapper_STDINCFLAGS, cxx_STDINCFLAGS): Likewise.
	* cxx.cc: Include "cygwin-cxx.h".
	(operator new): Tweak prototype for full standards compliance.
	(operator new[]): Likewise.
	(operator new (nothrow)): New fallback function.
	(operator new[] (nothrow), operator delete (nothrow),
	operator delete[] (nothrow)): Likewise.
	(default_cygwin_cxx_malloc): New struct of pointers to the above,
	for final last-resort fallback default.
	* cygwin-cxx.h: New file.
	(struct per_process_cxx_malloc): Define.
	(default_cygwin_cxx_malloc): Declare extern.
	* cygwin.din (__wrap__ZdaPv): Export new wrapper.
	(__wrap__ZdaPvRKSt9nothrow_t, __wrap__ZdlPv,
	__wrap__ZdlPvRKSt9nothrow_t, __wrap__Znaj,
	__wrap__ZnajRKSt9nothrow_t, __wrap__Znwj,
	__wrap__ZnwjRKSt9nothrow_t): Likewise.
	* globals.cc (__cygwin_user_data): Init newly-repurposed 'forkee'
	field (now 'cxx_malloc') to point to default_cygwin_cxx_malloc.
	* libstdcxx_wrapper.cc: New file.
	(__wrap__ZdaPv, __wrap__ZdaPvRKSt9nothrow_t, __wrap__ZdlPv,
	__wrap__ZdlPvRKSt9nothrow_t, __wrap__Znaj,
	__wrap__ZnajRKSt9nothrow_t, __wrap__Znwj,
	__wrap__ZnwjRKSt9nothrow_t): Define wrapper functions for libstdc++
	malloc operators and their overrides.
	* winsup.h (default_cygwin_cxx_malloc): Declare extern.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
	* include/sys/cygwin.h (struct per_process_cxx_malloc): Forward
	declare here.
	(struct per_process::forkee): Rename and repurpose from this ...
	(struct per_process::cxx_malloc): ... to this.
	* lib/_cygwin_crt0_common.cc: Include cygwin-cxx.h.
	(WEAK): Define shorthand helper macro.
	(__cygwin_cxx_malloc): Define and populate with weak references
	to whatever libstdc++ malloc operators will be visible at final
	link time for Cygwin apps and dlls.
	(_cygwin_crt0_common): Always look up cygwin DLL's internal
	per_process data, and don't test for (impossible) failure.  Inherit
	any members of __cygwin_cxx_malloc that we don't have overrides
	for from the DLL's default and store the resulting overall set of
	overrides back into the DLL's global per_process data.
@
text
@d369 1
d375 1
a375 1
#define CYGWIN_VERSION_API_MINOR 212
@


1.296
log
@	* cygwin.din (fpurge, mkstemps): New exports.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
	* mktemp.cc (_gettemp): Add parameter.
	(mkstemps): New function.
	(mkstemp, mkdtemp, mktemp): Adjust clients.
@
text
@d368 1
d374 1
a374 1
#define CYGWIN_VERSION_API_MINOR 211
@


1.295
log
@* cygwin/version.h (CYGWIN_VERSION_CYGWIN_CONV): New define.
@
text
@d367 1
d373 1
a373 1
#define CYGWIN_VERSION_API_MINOR 210
@


1.294
log
@	* ctype.cc: Remove implementation of ctype functions in favor of
	pointer-based newlib implementation.
	(_ctype_b): Declare.
	(__ctype_cp): Move to newlib. Declare.
	(__ctype_iso): Ditto.
	(__set_ctype): Implement changing __ctype_ptr__.  Only copy character
	class data in applications built under older Cygwin.
	* cygwin.din (__ctype_ptr__): Export.
	* include/ctype.h: Remove in favor of newlib implementation.
	* include/cygwin/config.h (__EXPORT): Define alongside __IMPORT.
	* include/cygwin/version.h (CYGWIN_VERSION_CHECK_FOR_OLD_CTYPE):
	Define check for old vs. new ctype implementation.
	Bump API minor number.
@
text
@d101 2
@


1.293
log
@	* cygwin.din: Export wordexp, wordfree.
	* posix.sgml: Move them to SUSv4 list.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d98 3
d364 1
d370 1
a370 1
#define CYGWIN_VERSION_API_MINOR 209
@


1.292
log
@	* cygwin.din: Export log2, log2f as functions.
	* posix.sgml: Add them to SUSv4 list.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d360 1
d366 1
a366 1
#define CYGWIN_VERSION_API_MINOR 208
@


1.291
log
@	* cygwin.din: Export wcsdup.
	* posix.sgml: Add wcsdup to SUSv4 list.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d359 1
d365 1
a365 1
#define CYGWIN_VERSION_API_MINOR 207
@


1.290
log
@	* cygwin.din: Export wcscasecmp, wcsncasecmp.
	* posix.sgml: Move wcscasecmp, wcsncasecmp to SUSv4 list.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d358 1
d364 1
a364 1
#define CYGWIN_VERSION_API_MINOR 206
@


1.289
log
@	* cygwin.din: Export wscanf, fwscanf, swscanf, vwscanf, vfwscanf,
	vswscanf.
	* posix.sgml: Move fwscanf, swscanf, vwscanf, vfwscanf, vswscanf
	to SUSv4 list.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d357 1
d363 1
a363 1
#define CYGWIN_VERSION_API_MINOR 205
@


1.288
log
@	* fhandler.h (fhandler_socket::wait_for_events): Take additional
	parameter "dontwait".
	* fhandler_socket.cc (fhandler_socket::wait_for_events): Act as if the
	socket is non-blocking if dontwait is true.
	(fhandler_socket::recv_internal): Use incoming MSG_DONTWAIT flag to
	set the wait_for_events dontwait parameter.
	(fhandler_socket::send_internal): Ditto.  Optimize code slightly.
	* include/cygwin/socket.h (MSG_DONTWAIT): Define.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d356 1
d362 1
a362 1
#define CYGWIN_VERSION_API_MINOR 204
@


1.287
log
@	* cygwin.din: Export wcsftime.
	* posix.sgml: Move wcsftime to SUSv4 list.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d355 1
d361 1
a361 1
#define CYGWIN_VERSION_API_MINOR 203
@


1.286
log
@	* cygwin.din: Export gethostbyname2.
	* net.cc: define _CYGWIN_IN_H and include resolv.h.
	(realloc_ent): New function.
	(dup_ent): Call realloc_ent.
	(memcpy4to6): New function.
	(dn_length1): New function.
	(gethostby_helper): New function.
	(gethostbyname2): New function.
	* posix.sgml: Add gethostbyname2.
	* include/cygwin/version.h: Bump API minor number.
	* libc/minires.c (get_options): Look for "inet6" and apply bounds
	to "retry" and "retrans".
	(res_ninit): Set the default options at the beginning.
	(dn_expand): Fix "off by one".
@
text
@d354 1
d360 1
a360 1
#define CYGWIN_VERSION_API_MINOR 202
@


1.285
log
@	* cygwin.din: Export wprintf, fwprintf, swprintf, vwprintf, vfwprintf,
	vswprintf.  Sort.
	* posix.sgml: Move fwprintf, swprintf, vwprintf, vfwprintf, vswprintf
	to SUSv4 list.  Sort SUSv4 list.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d353 1
d359 1
a359 1
#define CYGWIN_VERSION_API_MINOR 201
@


1.284
log
@	* cygwin.din: Export mbsnrtowcs and wcsnrtombs.
	* posix.sgml: Move mbsnrtowcs and wcsnrtombs to SUSv4 section.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d352 1
d358 1
a358 1
#define CYGWIN_VERSION_API_MINOR 200
@


1.283
log
@	* cygwin.din: Export open_wmemstream.
	* posix.sgml: Move open_wmemstream to SUSv4 section.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d351 1
d357 1
a357 1
#define CYGWIN_VERSION_API_MINOR 199
@


1.282
log
@	* cygwin.din: Export reallocf.
	* malloc_wrapper.cc( reallocf): New function.
	* posix.sgml: Add reallocf to BSD section.
	* include/cygwin/version.h: Bump API minor number.
	* libc/fts.c: Remove erroneous reallocf definition.
@
text
@d350 1
d356 1
a356 1
#define CYGWIN_VERSION_API_MINOR 198
@


1.281
log
@	* cygwin.din: Export wcstoimax, wcstoumax.
	* posix.sgml: Move wcstoimax and wcstoumax to SUSv4 section.
	* include/inttypes.h: Declare wcstoimax and wcstoumax.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d349 1
d355 1
a355 1
#define CYGWIN_VERSION_API_MINOR 197
@


1.280
log
@	* cygwin.din: Export wcsnlen.
	* posix.sgml: Move wcsnlen to SUSv4 section.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d348 1
d354 1
a354 1
#define CYGWIN_VERSION_API_MINOR 196
@


1.279
log
@	* cygwin.din: Export wcstod and wcstof.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d347 1
d353 1
a353 1
#define CYGWIN_VERSION_API_MINOR 195
@


1.278
log
@	* syscalls.cc (open): Handle O_DIRECTORY flag.
	* include/fcntl.h: Add SUSv4 flags O_DIRECTORY, O_EXEC and O_SEARCH.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d346 1
d352 1
a352 1
#define CYGWIN_VERSION_API_MINOR 194
@


1.277
log
@	* cygwin.din: Export wcstok.
	* posix.sgml: Move wcstok from unimplemented to susv3.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d345 1
d351 1
a351 1
#define CYGWIN_VERSION_API_MINOR 193
@


1.276
log
@	* Fix copyright dates.
@
text
@d344 1
d350 1
a350 1
#define CYGWIN_VERSION_API_MINOR 192
@


1.275
log
@* include/sys/cygwin.h (CW_SETERRNO): Define.
* external.cc (CW_SETERRNO): Implement.
* include/cygwin/version.h: Bump CYGWIN_VERSION_API_MINOR to 192 to reflect the
above change.
* path.cc (path_prefix_p): Treat X: as equivalent to x:.
* mkglobals_h: Remove unneeded #define.
* spawn.cc (spawn_guts): Avoid overly wordy initialization to zero.
@
text
@d4 1
a4 1
   2005, 2006, 2007, 2008 Red Hat, Inc.
@


1.274
log
@* include/cygwin/version.h: Bump CYGWIN_VERSION_API_MINOR to 191.
@
text
@d343 1
d349 1
a349 1
#define CYGWIN_VERSION_API_MINOR 191
@


1.273
log
@	* cygwin.din: Export fgetwc, fgetws, fputwc, fputws, fwide, getwc,
	getwchar, putwc, putwchar, ungetwc.
	* posix.sgml: Move above functions (add missing) into "implemented
	SUSv3" section.
	* include/cygwin/version.h: Bump api minor number.
@
text
@d342 1
d348 1
a348 1
#define CYGWIN_VERSION_API_MINOR 190
@


1.272
log
@* include/cygwin/version.h: Bump api minor number to 189 to flag the
implementation of dirent.d_type.
@
text
@d340 2
d347 1
a347 1
#define CYGWIN_VERSION_API_MINOR 189
@


1.271
log
@Remove unneeded whitespace.
* fhandler_fifo.cc (fhandler_fifo::open): Rework to cause errno to be set to
ENXIO when opening a fifo write/nonblocking.
* environ.cc (ucreqenv): Rename to ucenv.  Move code from old ucenv here and
conditionalize it on create_upcaseenv.
(ucenv): Delete.
(environ_init): Fix compiler warning by moving create_upcaseenv test to ucenv.
Don't bother checking for child_proc_info when calling ucenv since it is
assumed to be NULL at the point where the function is called.
* path.cc (symlink_worker): Turn off MS-DOS path warnings when dealing with
devices since the device handler passes in a translated MS-DOS path.
* sec_auth.cc (lsaprivkeyauth): Avoid variable initialization which causes a
compiler error.
* fhandler_netdrive.cc: Update copyright.
@
text
@d339 1
d345 1
a345 1
#define CYGWIN_VERSION_API_MINOR 188
@


1.270
log
@	* Makefile.in (DLL_OFILES): Add setlsapwd.o.
	* cygserver.h (CYGWIN_SERVER_VERSION_API): Bump.
	(request_code_t): Define CYGSERVER_REQUEST_SETPWD request type.
	* cygserver_msg.h (client_request_msg::retval): Use default value of -1
	for retval if msglen is 0.
	* cygserver_sem.h (client_request_sem::retval): Ditto.
	* cygserver_shm.h (client_request_shm::retval): Ditto.
	* cygserver_setpwd.h: New file.
	* external.cc (cygwin_internal): Implement new CW_SET_PRIV_KEY type.
	* sec_auth.cc (open_local_policy): Make externally available.
	Get ACCESS_MASK as argument.
	(create_token): Accommodate change to open_local_policy.
	(lsaauth): Ditto.
	(lsaprivkeyauth): New function fetching token by retrieving
	password stored in Cygwin or Interix LSA private data area and
	calling LogonUser with it.
	* security.h (lsaprivkeyauth): Declare.
	(open_local_policy): Declare.
	* setlsapwd.cc: New file implementing setting LSA private data password
	using LsaStorePrivateData or by calling cygserver if available.
	* syscalls.cc (seteuid32): Add workaround to get the original token
	when switching back to the original privileged user, even if
	setgroups group list is still active.  Add long comment to explain why.
	Call lsaprivkeyauth first, only if that fails call lsaauth or
	create_token.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/cygwin.h (cygwin_getinfo_types): Add CW_SET_PRIV_KEY.
@
text
@d329 1
a329 1
           this point.  We need a working implementation soon.
d332 1
a332 1
	   linkat, mkdirat, mkfifoat, mknodat, readlinkat, renameat, symlinkat, 
d336 1
a336 1
           which provided its own user_data structure.
@


1.269
log
@* Makefile.in: Add -c option which is now removed from COMPILE_C*.
* cygwin.din (cfmakeraw): Export.
* termios.cc (cfmakeraw): Implement.
* include/sys/termios.h (cfmakeraw): Declare.
* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR): Bump.
@
text
@d338 1
d344 1
a344 1
#define CYGWIN_VERSION_API_MINOR 187
@


1.268
log
@* include/cygwin/version.h: Add comment indicating that current API number bump
also has another consequence.
@
text
@d337 1
d343 1
a343 1
#define CYGWIN_VERSION_API_MINOR 186
@


1.267
log
@	* Makefile.in (DLL_OFILES): Remove v8 regexp files.
	(OBSOLETE_FUNCTIONS): Remove v8 regexp functions.
	(NEW_FUNCTIONS): Remove POSIX regex functions.
	* cygwin.din: Export POSIX regex functions with their correct symbol
	name.  Export with posix_ prefix for backward compatibility.
	* syscalls.cc (regfree): Remove ancient fake function.
	* regex/regex.h: Remove renaming regex functions within Cygwin.
	* regexp/*: Remove.
	* include /cygwin/version,.h: Bump API minor number.
@
text
@d335 2
a336 1
      186: Remove ancient V8 regexp functions.
@


1.266
log
@	* include/cygwin/version.h (CYGWIN_VERSION_MOUNT_REGISTRY): Bump.
	(CYGWIN_INFO_CYGWIN_MOUNT_REGISTRY_NAME): Remove.
	(CYGWIN_INFO_CYGDRIVE_FLAGS): Remove.
	(CYGWIN_INFO_CYGDRIVE_PREFIX): Remove.
	(CYGWIN_INFO_CYGDRIVE_DEFAULT_PREFIX): Add comment to differ from the
	registry related defines.
@
text
@d335 1
d341 1
a341 1
#define CYGWIN_VERSION_API_MINOR 185
@


1.265
log
@	* cygwin.din (futimens): Export.
	(utimensat): Export.
	* fhandler.cc (fhandler_base::utimens): Replace fhandler_base::utimes.
	Call utimens_fs.
	* fhandler.h (class fhandler_base): Declare utimens_fs instead of
	utimes_fs, utimens instead of utimes.
	(class fhandler_disk_file): Declare utimens instead of utimes.
	* fhandler_disk_file.cc (fhandler_disk_file::utimens): Replace
	fhandler_disk_file::utimes.
	(fhandler_base::utimens_fs): Replace fhandler_base::utimes_fs.
	Implement tv_nsec handling according to SUSv4.
	* syscalls.cc (utimensat): New function.
	* times.cc (timespec_to_filetime): New function.
	(timeval_to_timespec): New function.
	(utimens_worker): Replace utimes_worker.
	(utimes): Convert timeval to timespec and call utimens_worker.
	(lutimes): Ditto.
	(futimens): Take over implementation from futimes.
	(futimes): Convert timeval to timespec and call futimens.
	* winsup.h (timespec_to_filetime): Declare.
	* include/cygwin/version.h: Bump API minor number.
	* posix.sgml: Add SUSv4 section.  Add futimens and utimensat to it.
@
text
@d366 1
d369 1
a369 1
#define CYGWIN_VERSION_MOUNT_REGISTRY 2
d375 3
a377 3
#define CYGWIN_INFO_CYGWIN_MOUNT_REGISTRY_NAME "mounts v2"
#define CYGWIN_INFO_CYGDRIVE_FLAGS "cygdrive flags"
#define CYGWIN_INFO_CYGDRIVE_PREFIX "cygdrive prefix"
@


1.264
log
@	* cygwin.din: Sort.
	(faccessat): Export.
	(fchmodat): Export.
	(fchownat): Export.
	(fstatat): Export.
	(futimesat): Export.
	(linkat): Export.
	(mkdirat): Export.
	(mkfifoat): Export.
	(mknodat): Export.
	(openat): Export.
	(readlinkat): Export.
	(renameat): Export.
	(symlinkat): Export.
	(unlinkat): Export.
	* path.cc (readlink): Align definition to POSIX.
	* syscalls.cc (gen_full_path_at): New static function.
	(faccessat): Implement.
	(fchmodat): Implement.
	(fchownat): Implement.
	(fstatat): Implement.
	(futimesat): Implement.
	(linkat): Implement.
	(mkdirat): Implement.
	(mkfifoat): Implement.
	(mknodat): Implement.
	(openat): Implement.
	(readlinkat): Implement.
	(renameat): Implement.
	(symlinkat): Implement.
	(unlinkat): Implement.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d334 1
d340 1
a340 1
#define CYGWIN_VERSION_API_MINOR 184
@


1.263
log
@	* cygwin.din (fmemopen): Export.
	(open_memstream): Export.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d331 3
d339 1
a339 1
#define CYGWIN_VERSION_API_MINOR 183
@


1.262
log
@	* mount.cc (mount_info::init): Remove call to from_registry.  Print
	message that fstab is missing.
	(mount_info::from_fstab): Use CYGWIN_INFO_CYGDRIVE_DEFAULT_PREFIX
	instead of constant string.
	(mount_info::read_mounts): Remove.
	(mount_info::from_registry): Remove.
	(mount_info::read_cygdrive_info_from_registry): Remove.
	* postinstall: Enable code to create fstab entries from old registry
	entries.
	* registry.cc (reg_key::reg_key): Drop CYGWIN_INFO_CYGNUS_REGISTRY_NAME
	from registry key.
	* shared_info.h (mount_info::read_mounts): Remove declaration.
	(mount_info::from_registry): Ditto.
	(mount_info::to_registry): Ditto.
	(mount_info::read_cygdrive_info_from_registry): Ditto.
	* winver.rc (CYGWIN_REGISTRY_KEY): Remove.
	(LegalCopyright): Fix to include 2008.
	(RegistryKey): Set to CYGWIN_INFO_CYGWIN_REGISTRY_NAME.
	* include/cygwin/version.h (CYGWIN_INFO_CYGNUS_REGISTRY_NAME): Remove.
@
text
@d330 1
d336 1
a336 1
#define CYGWIN_VERSION_API_MINOR 182
@


1.261
log
@	* Makefile.in (DLL_OFILES): Add kernel32.o.
	* autoload.cc (WSACloseEvent): Remove.
	(WSACreateEvent): Remove.
	* cygheap.cc (cygheap_init): Drop initializing shared_prefix.
	* cygheap.h (struct init_cygheap): Drop shared_prefix and
	shared_prefix_buf members.
	* fhandler_socket.cc (sock_shared_name): New static function.
	(search_wsa_event_slot): Convert name buffers to WCHAR.  Call
	NtCreateMutant/NtOpenMutant to create mutexes in session local
	namespace.
	(fhandler_socket::init_events): Ditto.  Fix debug output.
	(fhandler_socket::release_events): Close mutexes using NtClose.
	(fhandler_socket::dup): Ditto.
	* kernel32.cc: New file, implementing Win32 calls in a Cygwin-specific
	way.
	* mmap.cc (MapView): Make static.
	* ntdll.h: Fix status code sorting.
	(STATUS_OBJECT_NAME_EXISTS): Define.
	(SEMAPHORE_QUERY_STATE): Define.
	(CYG_SHARED_DIR_ACCESS): Define.
	(CYG_MUTANT_ACCESS): Define.
	(CYG_EVENT_ACCESS): Define.
	(CYG_SEMAPHORE_ACCESS): Define.
	(enum _PROCESSINFOCLASS): Define ProcessSessionInformation.
	(struct _PROCESS_SESSION_INFORMATION): Define.
	(NtCreateSemaphore): Declare.
	(NtOpenSemaphore): Declare.
	* flock.cc: Use CYG_xxx_ACCESS access masks where appropriate.
	* posix_ipc.cc (ipc_mutex_init): Use native functions to create mutex.
	Create in cygwin-shared subdir.
	(ipc_cond_init): Ditto for event.
	(ipc_mutex_close): Use NtClose.
	(ipc_cond_close): Ditto.
	(mq_open): Drop "cyg" prefix from mqh_uname.
	* shared.cc (CYG_SHARED_DIR_ACCESS): Drop definition here.
	(_cygwin_testing): Declare extern on file level.
	(get_shared_parent_dir): Change name of shared directory.  Add name
	to api_fatal output.
	(get_session_parent_dir): New function.
	(shared_name): Simplify.
	(shared_info::initialize): Call get_session_parent_dir.
	* shared_info.h (get_session_parent_dir): Declare.
	* smallprint.cc (__small_vswprintf): Fix bug in multibyte string
	conversion.
	* thread.cc (semaphore::semaphore): Align semaphore name to object
	names in posix IPC functions.
	* include/cygwin/version.h (CYGWIN_VERSION_SHARED_DATA): Bump.
@
text
@a366 1
#define CYGWIN_INFO_CYGNUS_REGISTRY_NAME "Cygnus Solutions"
@


1.260
log
@	* cygwin.din (wprintf): Remove.
	(_wprintf): Ditto.
	* syscalls.cc (wprintf): Ditto.
	* include/cygwin/version.h: Add FIXME comment.
@
text
@d345 1
a345 1
#define CYGWIN_VERSION_SHARED_DATA 4
@


1.259
log
@	* Fix copyright dates.
@
text
@d328 2
@


1.258
log
@	* fhandler.cc (fhandler_base::dup): Drop setting flags in the parent.

	Implement advisory file locking.
	* cygheap.h (struct init_cygheap): Add inode_list member.
	* cygwin.din (lockf): Export.
	* dcrt0.cc (child_info_spawn::handle_spawn): Call
	fixup_lockf_after_exec.
	* dtable.h (class dtable): Add fhandler_disk_file as friend class.
	* fhandler.cc (fhandler_base::close): Call del_my_locks if node is set.
	(fhandler_base::fhandler_base): Initialize node to NULL.
	(fhandler_base::fixup_after_fork): Ditto.
	* fhandler.h (class fhandler_base): Add member node.
	* fhandler_disk_file.cc (fhandler_disk_file::lock): Delete.
	* flock.cc: Implement all advisory file locking here.
	(fhandler_disk_file::lock): Implement here.
	(flock): Call fcntl with F_FLOCK bit set.  Remove test main function.
	(lockf): New function.
	* fork.cc (frok::child): Call fixup_lockf_after_fork.
	* ntdll.h (DIRECTORY_ALL_ACCESS): Define.
	(struct _OBJECT_BASIC_INFORMATION): Define.
	(enum _EVENT_TYPE): Define.
	(NtCreateDirectoryObject): Declare.
	(NtCreateEvent): Declare.
	(NtCreateMutant): Declare.
	(NtOpenEvent): Declare.
	(NtOpenMutant): Declare.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d4 1
a4 1
   2005, 2006, 2007 Red Hat, Inc.
@


1.257
log
@	* winsup.h (NT_MAX_PATH): Revert ill-advised change to 32767.
	Accommodate change throughout.

	* cygwin.din (cygwin_conv_path): Export.
	(cygwin_conv_path_list): Export.
	(cygwin_create_path): Export.
	* dcrt0.cc (dll_crt0_1): Use cygwin_conv_path.
	* dtable.cc (handle_to_fn): Ditto.  Don't expect UNICODE_STRING being
	0-terminated.
	* environ.cc (env_plist_to_posix): New helper function.
	(env_plist_to_win32): Ditto.
	(env_path_to_posix): Ditto.
	(env_path_to_win32): Ditto.
	(return_MAX_PATH): Remove.
	(conv_envvars): Use new helper functions.  Drop removed members.
	(win_env::operator =): Accommodate removal of path length functions.
	(win_env::add_cache): Accommodate new env helper function API.
	(posify): Ditto.
	* environ.h (struct win_env): Ditto. Remove path length function
	pointers since they are unused.
	* path.cc (warn_msdos): Use cygwin_conv_path.
	(getfileattr): Use new tmp_pathbuf::u_get method.
	(fillout_mntent): Ditto.
	(symlink_info::check): Ditto.
	(path_conv::check): Use sizeof (WCHAR) instead of constant 2.
	(symlink_info::check_reparse_point): Ditto.
	(conv_path_list): Get max size of target string as argument.  Call
	cygwin_conv_path as helper function.
	(cygwin_conv_path): New function.
	(cygwin_create_path): New function.
	(cygwin_conv_to_win32_path): Just call cygwin_conv_path with size set
	to MAX_PATH.
	(cygwin_conv_to_full_win32_path): Ditto.
	(cygwin_conv_to_posix_path): Ditto.
	(cygwin_conv_to_full_posix_path): Ditto.
	(conv_path_list_buf_size): Add FIXME comment.
	(env_PATH_to_posix): Rename from env_win32_to_posix_path_list.
	Add size argument as required for env helper functions.
	(cygwin_win32_to_posix_path_list): Call conv_path_list with size set to
	MAX_PATH.
	(cygwin_posix_to_win32_path_list): Ditto.
	(cygwin_conv_path_list): New function.
	(cwdstuff::get): Fix length argument in call to sys_wcstombs.
	* spawn.cc (find_exec): Use cygwin_conv_path_list.
	* tls_pbuf.h (tmp_pathbuf::u_get: New method.
	* uinfo.cc (cygheap_user::ontherange): Allocate temporary path buffers
	using tmp_pathbuf.  Use cygwin_conv_path.
	* winf.cc (av::unshift): Use cygwin_conv_path.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/cygwin.h: Comment out old cygwin32_XXX API.
	Mark old path handling API as deprecated.
	(cygwin_conv_path_t): Typedef.  Define values.
	(cygwin_conv_path): Declare.
	(cygwin_create_path): Declare.
	(cygwin_conv_path_list): Declare.
@
text
@d327 1
d333 1
a333 1
#define CYGWIN_VERSION_API_MINOR 181
@


1.256
log
@Perform whitespace cleanup throughout.
* dcrt0.cc (signal_shift_subtract): Eliminate ancient backwards compatibility.
(check_sanity_and_sync): Ditto.
* winsup.h (SIGTOMASK): Ditto.  Just use constant in signal calculation.
* include/cygwin/version: Remove backwards signal mask compatibility define.
* path.cc (symlink_info::check_sysfile): Cosmetic change.
* registry.cc (get_registry_hive_path): Remove unneeded variable.
* exceptions.cc (handle_sigsuspend): Eliminate thread signal mask and use
either main sigmask or current thread sigmask.
(set_process_mask): Ditto.
(sighold): Ditto.
(sigrelse): Ditto.
(sigset): Ditto.
(set_process_mask_delta): Ditto.
(_cygtls::call_signal_handler): Ditto.
* fhandler_process.cc (format_process_status): Ditto.
* fhandler_termios.cc (fhandler_termios::bg_check): Ditto.
* pinfo.h (class pinfo): Ditto.
* select.cc (pselect): Ditto.
* signal.cc (sigprocmask): Ditto.
(abort): Ditto.
(sigpause): Ditto.
(sigsend): Ditto.
(wait_sig): Ditto.
* thread.h (pthread::parent_tls): New member.
* thread.cc (pthread::pthread): Record parent_tls here.
(pthread::thread_init_wrapper): Initialize sigmask from parent thread.
@
text
@d326 1
d332 1
a332 1
#define CYGWIN_VERSION_API_MINOR 180
@


1.255
log
@	* Makefile.in (DLL_OFILES): Add ntea.o.
	* cygwin.din (getxattr, listxattr, removexattr, setxattr, lgetxattr,
	llistxattr, lremovexattr, lsetxattr, fgetxattr, flistxattr,
	fremovexattr, fsetxattr): Export Linux extended attribute functions.
	Sort.
	* errno.cc (errmap): Add mappings for ERROR_EAS_DIDNT_FIT,
	ERROR_EAS_NOT_SUPPORTED, ERROR_EA_LIST_INCONSISTENT,
	ERROR_EA_TABLE_FULL, ERROR_FILE_CORRUPT, ERROR_INVALID_EA_NAME.
	* fhandler.h (class fhandler_base): Declare new fgetxattr and
	fsetxattr methods.
	(class fhandler_disk_file): Ditto.
	* fhandler.cc (fhandler_base::fgetxattr): New method.
	(fhandler_base::fsetxattr): New method.
	* fhandler_disk_file.cc (fhandler_disk_file::fgetxattr): New method.
	(fhandler_disk_file::fsetxattr): New method.
	* ntdll.h (STATUS_EA_TOO_LARGE): Define.
	(STATUS_NONEXISTENT_EA_ENTRY): Define.
	(STATUS_NO_EAS_ON_FILE): Define.
	* ntea.cc (read_ea): Rewrite for long pathnames and for using with
	Linux extended attribute functions.
	(write_ea): Ditto.
	(getxattr_worker): New static function.
	(getxattr): New function.
	(lgetxattr): New function.
	(fgetxattr): New function.
	(listxattr): New function.
	(llistxattr): New function.
	(flistxattr): New function.
	(setxattr_worker): New static function.
	(setxattr): New function.
	(lsetxattr): New function.
	(fsetxattr): New function.
	(removexattr): New function.
	(lsetxattr): New function.
	(fsetxattr): New function.
	* security.h (read_ea): Change declaration according to above changes.
	(write_ea): Ditto.
	* include/cygwin/version.h: Bump API minor version.
@
text
@a64 2
#define CYGWIN_VERSION_DLL_BAD_SIGNAL_MASK	19005

d312 1
a312 1
           fopencookie.
@


1.254
log
@	* cygwin.din (_f_llrint, _f_llrintf, _f_llrintl, _f_lrint, _f_lrintf,
	_f_lrintl, _f_rint, _f_rintf, _f_rintl):  Export fast *rint* functions.
	(lrint, lrintf, rint, rintf):  Redirect exports to alias _f_ versions.
	(llrint, llrintf, llrintl, lrintl, rintl):  Add exports aliasing _f_*
	versions likewise.
	* include/cygwin/version.h (CYGWIN_VERSION_API_MINOR):  Bump.
@
text
@d325 3
d333 1
a333 1
#define CYGWIN_VERSION_API_MINOR 179
@


1.253
log
@	* cygwin.din: Export wcpcpy, wcpncpy.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d322 3
d330 1
a330 1
#define CYGWIN_VERSION_API_MINOR 178
@


1.252
log
@* cygwin/strsig.cc (__signals): New macro.
(sys_sigabbrev): New array of signal strings, patterned after linux.
(siglist): Use __signals.
* cygwin/include/cygwin/signal.h (sys_sigabbrev): Define.
* cygwin/include/cygwin/version.h: Bump API minor version to 177.

* utils/Makefile.in (kill.exe): Remove reliance on libiberty.
* utils/kill.cc (strsigno): New function patterned after libiberty but using
newly exported cygwin array.
@
text
@d321 1
d327 1
a327 1
#define CYGWIN_VERSION_API_MINOR 177
@


1.251
log
@
	* cygwin.din: Export wcstol, wcstoll, wcstoul, wcstoull, wcsxfrm.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d320 1
d326 1
a326 1
#define CYGWIN_VERSION_API_MINOR 176
@


1.250
log
@	* cygwin.din: Export fdopendir.
	* dir.cc (opendir): Call fhandler's opendir with fd set to -1.
	(fdopendir): New function.
	(seekdir64): Use dirent_info_mask.
	(rewinddir): Ditto.
	(closedir): Only release underlying file descriptor if it has been
	reserved by opendir itself.
	* fhandler.cc (fhandler_base::opendir): Accommodate new parameter.
	* fhandler.h (dirent_states): Add dirent_valid_fd and dirent_info_mask.
	(fhander_XXX::opendir): Add file descriptor parameter.  Use regparms.
	(fhandler_procnet::opendir): Drop declaration.
	* fhandler_disk_file.cc (fhandler_disk_file::opendir): Ditto.
	If called from fdopendir, use existing handle to re-open directory
	with valid flags.  Rename fd to cfd.  Use only if no valid incoming fd.
	(fhandler_cygdrive::opendir): Accommodate new parameter.
	* fhandler_process.cc (fhandler_process::opendir): Ditto.
	* fhandler_procnet.cc (fhandler_procnet::opendir): Drop definition.
	* fhandler_virtual.cc (fhandler_virtual::opendir): Accommodate new
	parameter.  Only create new file descriptor entry if called from
	opendir.  Remove duplicated setting of dir->__flags.
	* posix.sgml: Add fdopendir to list of implemented Solaris functions.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/dirent.h: Declare fdopendir.
@
text
@d319 1
d325 1
a325 1
#define CYGWIN_VERSION_API_MINOR 175
@


1.249
log
@	* include/cygwin/version.h: Fix comment typo.
@
text
@d318 1
d324 1
a324 1
#define CYGWIN_VERSION_API_MINOR 174
@


1.248
log
@	* cygwin.din: Export stpcpy, stpncpy.
	* posix.sgml: Add stpcpy and stpncpy to list of implemented
	GNU extensions.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d300 1
a300 1
      160: Export posix_fadvice, posix_fallocate.
@


1.247
log
@	* assert.cc (__assert_func): New function, to match newlib header
	change.
	* cygwin.din: Export __assert_func.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d317 1
d323 1
a323 1
#define CYGWIN_VERSION_API_MINOR 173
@


1.246
log
@	* autoload.cc (WSAIoctl): Remove.
	* cygwin.din: Export freeifaddrs, getifaddrs.
	* fhandler_socket.cc (fhandler_socket::ioctl): Drop SOCKET parameter
	from get_ifconf.
	* net.cc: Include ifaddrs.h.
	(in_are_prefix_equal): Match addresses in network byte order.
	(ip_addr_prefix): Convert address into host byte order before
	testing with IN_LOOPBACK.
	(struct ifall): Define.
	(get_xp_ifs): Replace get_xp_ifconf.  Return struct ifall array.
	(get_2k_ifs): Ditto, replace get_2k_ifconf.
	(get_nt_ifs): Ditto, replace get_nt_ifconf.
	(getifaddrs): New function.
	(freeifaddrs): New function.
	(get_ifconf): Call matching get_XX_ifs function and create
	ifc content from here.  Drop lo fake since it's now in get_nt_ifs.
	* posix.sgml: Add freeifaddrs and getifaddrs to list of implemented
	BSD functions.
	* wincap.h (wincapc::has_broken_if_oper_status): New element.
	* wincap.cc: Implement above element throughout.
	* include/ifaddrs.h: New file.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d316 1
d322 1
a322 1
#define CYGWIN_VERSION_API_MINOR 172
@


1.245
log
@	* cygwin.din: Export exp10, exp10f, pow10, pow10f, strcasestr,
	funopen, fopencookie.
	* include/cygwin/version.h: Bump API minor number.
	* posix.sgml: Minor improvements.
@
text
@d315 1
d321 1
a321 1
#define CYGWIN_VERSION_API_MINOR 171
@


1.244
log
@	* Makefile.in (DLL_OFILES): Add xsique.o.
	* cygwin.din (confstr): Make NOSIGFE.
	(insque): Export.
	(remque): Export.
	* lsearch.cc: Remove superfluous _SEARCH_PRIVATE define.
	* posix.sgml: Move insque to defined SUSv3 interfaces.  Remove
	comment for remque.
	* include/search.h: Remove _SEARCH_PRIVATE guarded definitions.
	Add struct qelem definition.  Add insque and remque declarations.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/queue.h: Remove insque/remque definitions so as not
	to collide with SUSv3 compatible declaration in search.h.
	* libc/xsique.cc: New file implementing insque and remque.
@
text
@d313 2
d320 1
a320 1
#define CYGWIN_VERSION_API_MINOR 170
@


1.243
log
@	* cygwin.din (confstr): Export.
	* posix.sgml (confstr): Move to list of implemented SUSv3 functions.
	* sysconf.cc (confstr): Implement.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d312 1
d318 1
a318 1
#define CYGWIN_VERSION_API_MINOR 169
@


1.242
log
@* cygwin.din (asnprintf, dprint, _Exit, vasnprintf, vdprintf): Export.
* include/cygwin/version.h: Bump API minor number.
@
text
@d311 1
d317 1
a317 1
#define CYGWIN_VERSION_API_MINOR 168
@


1.241
log
@	* fhandler_mailslot.cc (fhandler_mailslot::fstat): Set new stat member
	st_birthtim to useful value.
	* fhandler_process.cc (fhandler_process::fstat): Ditto.
	* fhandler_disk_file.cc (fhandler_base::fstat_by_handle): Take
	additional parameter for creation time.  Fill st_birthtim with it.
	Accomodate additional creation time parameter throughout.
	* fhandler_raw.cc (fhandler_dev_raw::fstat): Set new stat member
	st_birthtim to useful value.
	* fhandler.cc (fhandler_base::fstat): Ditto.
	* fhandler_registry.cc (fhandler_registry::fstat): Ditto.
	* include/cygwin/version.h: Bump API minor number.
	* include/cygwin/stat.h (struct __stat64): Replace st_spare4 with
	timestruc_t st_birthtim.
	(struct stat): Ditto if __CYGWIN_USE_BIG_TYPES__ is defined.
	(st_birthtime): Define if __CYGWIN_USE_BIG_TYPES__ is defined.
@
text
@d310 1
d316 1
a316 1
#define CYGWIN_VERSION_API_MINOR 167
@


1.240
log
@	* cygwin.din (sem_unlink): Export.
	* posix_ipc.cc: Include thread.h and semaphore.h.  Remove TODO
	comment.
	(ipc_names): Add max_len member.  Set to maximum length of the path
	before tacking on the prefix path.  Set prefix path for named semaphors
	to /dev/shm, as on Linux.
	(enum ipc_type_t): Change sem to semaphore to avoid name conflicts.
	(check_path): Detect empty paths.  Use ipc_names's max_len member.
	Use __small_sprintf to create full object path name.  Special case
	semaphores.
	(ipc_cond_init): Drop superfluous strcpy.
	(class ipc_flock): New class to simplify file locking in subsequent
	code.
	(struct mq_hdr): Raise size of mqh_uname to allow adding a unique
	LUID to the name.
	(mq_open): Fix formatting.  Create unique synchronization object names
	using AllocateLocallyUniqueId.
	(struct sem_finfo): New structure defining named semaphore file content.
	(sem_open): Move here.  Rework implementation to allow kernel
	persistent implementation of POSIX named semaphores.
	(_sem_close): Implement sem_close.
	(sem_close): Move here.  Just call _sem_close with do_close parameter
	set to true.
	(sem_unlink): New function.
	* pthread.cc (mangle_sem_name): Remove.
	(sem_open): Move to posix_ipc.cc.
	(sem_close): Ditto.
	* syscalls.cc (close_all_files): Call semaphore::terminate here.
	* thread.cc: Fix formatting.  Rearrange semaphore functions so that
	they are close together.
	(semaphore::semaphore): Rework to play nicely with new named semaphore
	implementation.
	(semaphore::_terminate): Call _sem_close if semaphore is a named
	semaphore.
	(semaphore::destroy): Don't destroy named semaphores.  Return EINVAL
	instead.
	(semaphore::close): Only destroy named semaphores.  Return EINVAL
	otherwise.
	(semaphore::open): Rework to play nicely with new named semaphore
	implementation.  Loop through existing semaphores to be able to
	return same sem_t pointer as a former call on the same named semaphore.
	(semaphore::getinternal): New function called from _sem_close.
	* thread.h (class List): Make mx and head public.
	(class semaphore): Fix formatting.  Align method declarations with
	implementation in thread.cc.  Add members used for named semaphores.
	(semaphore::terminate): New static method.
	* include/semaphore.h: Redefine SEM_FAILED.  Fix formatting.
	(sem_unlink): Add declaration.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d309 1
d315 1
a315 1
#define CYGWIN_VERSION_API_MINOR 166
@


1.239
log
@	* Makefile.in (DLL_OFILES): Add posix_ipc.o.
	* cygwin.din (mq_close): Export.
	(mq_getattr): Export.
	(mq_notify): Export.
	(mq_open): Export.
	(mq_receive): Export.
	(mq_send): Export.
	(mq_setattr): Export.
	(mq_timedreceive): Export.
	(mq_timedsend): Export.
	(mq_unlink): Export.
	* posix_ipc.cc: New file implementing the above functions.  Move
	shm_open and shm_unlink from syscalls.cc here.
	* sysconf.cc (sca): Set value of _SC_MQ_OPEN_MAX to MQ_OPEN_MAX,
	_SC_MQ_PRIO_MAX to MQ_PRIO_MAX, _SC_MESSAGE_PASSING to
	_POSIX_MESSAGE_PASSING.
	* include/limits.h (MQ_OPEN_MAX): Define.
	(MQ_PRIO_MAX): Define.
	* include/mqueue.h: New file.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d308 1
d314 1
a314 1
#define CYGWIN_VERSION_API_MINOR 165
@


1.238
log
@	* cygwin.din (shm_open): Export.
	(shm_unlink): Export.
	* syscalls.cc (shm_open): New function.
	(shm_unlink): New function.
	* sysconf.cc (sca): Set value of _SC_SHARED_MEMORY_OBJECTS to
	_POSIX_SHARED_MEMORY_OBJECTS.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/mman.h (shm_open): Add prototype.
	(shm_unlink): Ditto.
@
text
@d306 2
d313 1
a313 1
#define CYGWIN_VERSION_API_MINOR 164
@


1.237
log
@	* cygmalloc.h (MALLOC_FAILURE_ACTION): Define empty.
	* cygwin.din (posix_madvise): Export.
	(posix_memalign): Export.
	* fhandler.cc (fhandler_base::fpathconf): Return useful values in
	_PC_VDISABLE, _PC_SYNC_IO and _PC_SYMLINK_MAX cases.
	* malloc_wrapper.cc (malloc): Set errno here since it's not set in
	dlmalloc.c anymore.
	(realloc): Ditto.
	(calloc): Ditto.
	(memalign): Ditto.
	(valloc): Ditto.
	(posix_memalign): New function.
	* mmap.cc (posix_madvise): New function.
	* sysconf.cc (get_open_max): New function.
	(get_page_size): Ditto.
	(get_nproc_values): Ditto.
	(get_avphys): Ditto.
	(sc_type): New type.
	(sca): New array to map _SC_xxx options to sysconf return values.
	(sysconf): Reimplement using sca array.
	* include/limits.h: Add all missing values as defined by SUSv3.
	* include/pthread.h (PTHREAD_DESTRUCTOR_ITERATIONS): Move definition
	to sys/limits.h.
	(PTHREAD_KEYS_MAX): Ditto.
	* include/semaphore.h (SEM_VALUE_MAX): Ditto.
	* include/cygwin/stdlib.h (posix_memalign): Declare.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/mman.h: Add posix_madvise flags.
	(posix_madvise): Declare.
	* include/sys/termios.h (_POSIX_VDISABLE): Move definition to
	sys/limits.h.
@
text
@d305 1
d311 1
a311 1
#define CYGWIN_VERSION_API_MINOR 163
@


1.236
log
@	* autoload.cc (WSAIoctl): Define.
	(SendARP): Define.
	* cygwin.din: Export if_freenameindex, if_indextoname, if_nameindex and
	if_nametoindex.
	* fhandler_procnet.cc: Drop including wchar.h.  Drop definitions of
	GAA_FLAG_INCLUDE_ALL_INTERFACES, IP_ADAPTER_UNICAST_ADDRESS_VISTA.
	(fhandler_procnet::exists): Check for has_gaa_prefixes.  Call
	get_adapters_addresses here.
	(fhandler_procnet::readdir): Ditto.
	(prefix): Move to net.cc.
	(fhandler_procnet::fill_filebuf): Call get_adapters_addresses here.
	Simplify allocation.  Use AdapterName rather than FriendlyName as
	interface name.  Use IfIndex if available, Ipv6IfIndex otherwise.
	(in6_are_prefix_equal): Move to net.cc.
	* fhandler_socket.cc: Define old SIOCGxxx values.
	(CONV_OLD_TO_NEW_SIO): Convert old SIOCGxxx value to new one.
	(struct __old_ifreq): Define old struct ifreq.
	(fhandler_socket::ioctl): Handle old SIOCGxxx values.  Handle new
	SIOCGIFFRNDLYNAM command.  Simplify copying ifreq data to user space.
	Call get_ifconf with additional SOCKET parameter.
	* net.cc (IP_ADAPTER_UNICAST_ADDRESS_LH): Define.
	(IP_ADAPTER_ADDRESSES_LH): Define.
	(SIO_GET_INTERFACE_LIST): Define.
	(sockaddr_in6_old): Define.
	(sockaddr_gen): Define.
	(INTERFACE_INFO): Define.
	(IN_LOOPBACK): Define.
	(in_are_prefix_equal): New static function.
	(ip_addr_prefix): New function, replaces prefix function, add AF_INET
	handling.
	(GAA_FLAG_INCLUDE_ALL_INTERFACES): Define.
	(get_adapters_addresses): New function.
	(WS_IFF_xxx): Define Winsock interface flag values.
	(convert_ifr_flags): New function to convert Winsock interface flag
	values to Cygwin interface flag values.
	(get_xp_ifconf): New get_ifconf implementation for XP SP1 and above.
	(get_2k_ifconf): Fix interface index.  Fix formatting.
	(get_nt_ifconf): Fix formatting.
	(get_95_ifconf): Ditto.
	(get_ifconf): Take additional SOCKET parameter.  Call get_xp_ifconf
	on XP SP1 and above.
	(if_nametoindex): New function.
	(if_indextoname): New function.
	(if_nameindex): New function.
	(if_freenameindex): New function.
	(in6_are_prefix_equal): Moved here from fhandler_procnet.cc.
	* wincap.cc (wincap_xp): Define has_gaa_prefixes as true by default.
	(wincapc::init): Assume has_osversioninfoex by default.  Call
	GetVersionEx with OSVERSIONINFOEX first.  Call with OSVERSIONINFO only
	if that fails.  Simplify NT4 case and try to avoid strcmp.  Check XP
	Service Pack using version.wServicePackMajor to avoid strcmp.
	* include/asm/socket.h (SIOCGIFFRNDLYNAM): Define.
	* include/cygwin/if.h: Fix formatting.
	(IFF_POINTTOPOINT): Define.
	(IFF_NOARP): Define.
	(IFF_LOWER_UP): Define.
	(IFF_DORMANT): Define.
	(struct if_nameindex): Define.
	(IFRF_FRIENDLYNAMESIZ): Define.
	(struct ifreq_frndlyname): Define.
	(IFNAMSIZ): Redefine as 44.
	(IF_NAMESIZE): Define.
	(struct ifreq): Redefine ifru_flags as int.  Define ifru_data.  Pad size
	to sizeof sockaddr_in6 for further extensions.
	(ifr_data): Define.
	(ifr_frndlyname): Define.
	(if_nametoindex): Declare.
	(if_indextoname): Declare.
	(if_nameindex): Declare.
	(if_freenameindex): Declare.
	* include/cygwin/version.h: Bump API minor number.
	(CYGWIN_VERSION_CHECK_FOR_OLD_IFREQ): Define check for old vs. new
	ifreq structure.
@
text
@d4 1
a4 1
   2005, 2006 Red Hat, Inc.
d304 1
d310 1
a310 1
#define CYGWIN_VERSION_API_MINOR 162
@


1.235
log
@	* Makefile.in (DLL_OFILES): Add minires-os-if.o and minires.o.
	(SUBLIBS): Add libresolv.a.
	Add rule for libresolv.a.
	* autoload.cc: Fix return code handling for IP Helper API in case
	of being unable to load iphlpapi.dll.
	(DnsQuery_A): Define.
	(DnsRecordListFree): Define.
	* cygwin.din: Export resolver functions.
	* include/resolv.h: New header.
	* include/arpa/nameser.h: New header.
	* include/arpa/nameser_compat.h: New header.
	* include/cygwin/version.h: Bump API minor number.
	* libc/minires-os-if.c: New file.
	* libc/minires.c: New file.
	* libc/minires.h: New file.
@
text
@d97 3
d302 2
d309 1
a309 1
#define CYGWIN_VERSION_API_MINOR 161
@


1.234
log
@	* autoload.cc (NtSetInformationFile): Define.
	* cygwin.din: Export posix_fadvise and posix_fallocate.
	* fhandler.cc (fhandler_base::fadvise): New method.
	(fhandler_base::ftruncate): Add allow_truncate parameter.
	* fhandler.h (class fhandler_base): Add fadvise method.  Accomodate
	new parameter to ftruncate.
	(class fhandler_pipe): Add fadvise and ftruncate methods.
	(class fhandler_disk_file): Add fadvise method.  Accomodate new
	parameter to ftruncate.
	* fhandler_disk_file.cc (fhandler_disk_file::fadvise): New method.
	(fhandler_disk_file::ftruncate): Accomodate new allow_truncate
	parameter.  Set EOF using NtSetInformationFile on NT.
	* ntdll.h (struct _FILE_END_OF_FILE_INFORMATION): Define.
	(NtSetInformationFile): Declare.
	* pipe.cc (fhandler_pipe::fadvise): New method.
	(fhandler_pipe::ftruncate): Ditto.
	* syscalls.cc (posix_fadvise): New function.
	(posix_fallocate): Ditto.
	(ftruncate64): Accomodate second parameter to fhandler's ftruncate
	method.
	* include/fcntl.h: Add POSIX_FADV_* flags.  Add declarations of
	posix_fadvise and posix_fallocate.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d298 1
d304 1
a304 1
#define CYGWIN_VERSION_API_MINOR 160
@


1.233
log
@2006-07-25  Corinna Vinschen  <corinna@@vinschen.de>

	* include/cygwin/version.h: Bump DLL version to 1.7.0.

2006-07-25  Corinna Vinschen  <corinna@@vinschen.de>

	* select.h: Remove.
	* fhandler_socket.cc: Don't include select.h.
	* select.cc: Ditto.

2006-07-25  Corinna Vinschen  <corinna@@vinschen.de>

	* cygtls.h: Drop socket related includes.
	(struct _local_storage): Remove exitsock and exitsock_sin. Add
	select_sockevt.
	* cygtls.cc: Accomodate above change throughout.
	* fhandler.h (class fhandler_socket): Make wsock_evt public.
	* fhandler_socket.cc (fhandler_socket::fhandler_socket): Accomodate
	reordering members.
	(fhandler_socket::evaluate_events): Drop FD_CONNECT event as soon as
	it gets read once.  Never remove FD_WRITE event here.
	(fhandler_socket::wait_for_events): Wait 50 ms instead of INFINITE for
	socket events.
	(fhandler_socket::accept): Fix conditional.  Set wsock_events members
	of accepted socket to useful start values.
	(fhandler_socket::recv_internal): Always drop FD_READ/FD_OOB events from
	wsock_events after the call to WSARecvFrom.
	(fhandler_socket::send_internal): Drop FD_WRITE event from wsock_events
	if the call to WSASendTo fails with WSAEWOULDBLOCK.  Fix return value
	condition.
	* select.cc (struct socketinf): Change to accomodate using socket event
	handling.
	(peek_socket): Use event handling for peeking socket.
	(thread_socket): Ditto.
	(start_thread_socket): Ditto.
	(socket_cleanup): Same here.
	* tlsoffsets.h: Regenerate.

2006-07-20  Corinna Vinschen  <corinna@@vinschen.de>

	* fhandler.h (class fhandler_socket): Rearrange slightly to keep
	event handling methods and members together.  Drop owner status flag.
	Split wait method.  Rename event handling methods for readability.
	* fhandler_socket.cc (struct wsa_event): Add owner field.
	(LOCK_EVENTS): New macro.
	(UNLOCK_EVENTS): Ditto.
	(fhandler_socket::init_events): rename from prepare.
	(fhandler_socket::evaluate_events): First half of former wait method.
	Do everything but wait.  Allow specifiying whether or not events from
	event_mask should be erased from wsock_events->events.  Simplify
	OOB handling.  Allow sending SIGURG to any process (group).
	(fhandler_socket::wait_for_events): Second half of former wait method.
	Call evaluate_events and wait in a loop if socket is blocking.
	(fhandler_socket::release_events): Rename from release.
	(fhandler_socket::connect): Accomodate above name changes.
	(fhandler_socket::accept): Ditto.
	(fhandler_socket::recv_internal): Ditto.
	(fhandler_socket::send_internal): Ditto.
	(fhandler_socket::close): Ditto.
	(fhandler_socket::fcntl): Always set owner to given input value on
	F_SETOWN.  Handle F_GETOWN.
	* net.cc (fdsock): Accomodate above name changes.

2006-07-20  Corinna Vinschen  <corinna@@vinschen.de>

	* fhandler_socket.cc (fhandler_socket::wait): Set Winsock errno to
	WSAEWOULDBLOCK instead of WSAEINPROGRESS.

2006-07-18  Brian Ford  <Brian.Ford@@FlightSafety.com>
	    Corinna Vinschen  <corinna@@vinschen.de>

	* winsup.h (mmap_region_status): New enum.
	(mmap_is_attached_or_noreserve_page): Adjust prototype and rename
	as below.
	* mmap.cc (mmap_is_attached_or_noreserve_page):  Rename
	mmap_is_attached_or_noreserve.  Add region length parameter.
	Return enum above.
	* exceptions.cc (_cygtls::handle_exceptions): Accomodate above.
	* fhandler.cc (fhandler_base::raw_read): Call above for NOACCESS
	errors and retry on success to allow reads into untouched
	MAP_NORESERVE buffers.

2006-07-18  Corinna Vinschen  <corinna@@vinschen.de>

	* cygwin.din (posix_openpt): Export.
	* tty.cc (posix_openpt): New function.
	* include/cygwin/stdlib.h (posix_openpt): Declare.
	* include/cygwin/version.h: Bump API minor number.

2006-07-14  Corinna Vinschen  <corinna@@vinschen.de>

	* security.cc (get_token_group_sidlist): Always add the interactive
	group to the token.  Add comment.  Create logon_id group SID by
	copying it from incoming group list.
	(create_token): Add subauth_token parameter.  Use information in
	subauth_token if present.  Tweak SourceIdentifier if subauth_token
	is present for debugging purposes.
	* security.h (create_token): Add subauth_token parameter in declaration.
	* syscalls.cc (seteuid32): Call subauth first.  Call create_token
	regardless.  Use subauth token in call to create_token if subauth
	succeeded.

2006-07-13  Corinna Vinschen  <corinna@@vinschen.de>

	* include/netinet/in.h: Update copyright.

2006-07-13  Corinna Vinschen  <corinna@@vinschen.de>

	* fhandler_socket.cc (fhandler_socket::wait): Rework function so that
	WaitForMultipleObjects is really only called when necessary.

2006-07-12  Corinna Vinschen  <corinna@@vinschen.de>

	* include/netdb.h: Declare rcmd, rcmd_af, rexec, rresvport,
	rresvport_af, iruserok, iruserok_sa, ruserok.

2006-07-12  Corinna Vinschen  <corinna@@vinschen.de>

	* Makefile.in (DLL_OFILES): Drop iruserok.o.  Add rcmd.o.
	* autoload.cc (rcmd): Drop definition.
	* cygwin.din: Export bindresvport, bindresvport_sa, iruserok_sa,
	rcmd_af, rresvport_af.
	* net.cc (cygwin_rcmd): Remove.
	(last_used_bindresvport): Rename from last_used_rrecvport.
	(cygwin_bindresvport_sa): New function implementing bindresvport_sa.
	(cygwin_bindresvport): New function implementing bindresvport.
	(cygwin_rresvport): Remove.
	* include/cygwin/version.h: Bump API minor number.
	* include/netinet/in.h: Declare bindresvport and bindresvport_sa.
	* libc/iruserok.c: Remove file.
	* libc/rcmd.cc: New file implementing rcmd, rcmd_af, rresvport,
	rresvport_af, iruserok_sa, iruserok and ruserok.

2006-07-12  Corinna Vinschen  <corinna@@vinschen.de>

	* fhandler_socket.cc (fhandler_socket::getsockname): Return valid
	result for unbound sockets.

2006-07-11  Corinna Vinschen  <corinna@@vinschen.de>

	* fhandler_socket.cc (fhandler_socket::fixup_after_fork): Handle
	wsock_mtx and wsock_evt on fork, thus handling close_on_exec correctly.
	(fhandler_socket::fixup_after_exec): Drop misguided attempt to handle
	close_on_exec here.
	(fhandler_socket::dup): Call fixup_after_fork with NULL parent.
	Add comment.
	(fhandler_socket::set_close_on_exec): Handle wsock_mtx and wsock_evt.

2006-07-10  Corinna Vinschen  <corinna@@vinschen.de>

	* fhandler.h (class fhandler_socket): Add wsock_mtx, wsock_evt
	and wsock_events members.  Remove closed status flag, add listener
	status flag.  Accomodate new implementation of socket event handling
	methods.  Declare recv* and send* functions ssize_t as the POSIX
	equivalents.
	(fhandler_socket::recv_internal): Declare.
	(fhandler_socket::send_internal): Ditto.
	* fhandler_socket.cc (EVENT_MASK): Define mask of selected events.
	(fhandler_socket::fhandler_socket): Initialize new members.
	(fhandler_socket::af_local_setblocking): Don't actually set the
	socket to blocking mode.  Keep sane event selection.
	(fhandler_socket::af_local_unsetblocking): Don't actually set the
	socket to previous blocking setting, just remember it.
	(struct wsa_event): New structure to keep event data per shared
	socket.
	(NUM_SOCKS): Define number of shared sockets concurrently handled by
	all active Cygwin processes.
	(wsa_events): New shared datastructure keeping all wsa_event records.
	(socket_serial_number): New shared variable to identify shared sockets.
	(wsa_slot_mtx): Global mutex to serialize wsa_events access.
	(search_wsa_event_slot): New static function to select a new wsa_event
	slot for a new socket.
	(fhandler_socket::prepare): Rewrite.  Prepare event selection
	per new socket.
	(fhandler_socket::wait): Rewrite.  Wait for socket events in thread
	safe and multiple process safe.
	(fhandler_socket::release): Rewrite.  Close per-socket descriptor
	mutex handle and event handle.
	(fhandler_socket::dup): Duplicate wsock_mtx and wsock_evt.  Fix
	copy-paste error in debug output.
	(fhandler_socket::connect): Accomodate new event handling.
	(fhandler_socket::listen): Set listener flag on successful listen.
	(fhandler_socket::accept): Accomodate new event handling.
	(fhandler_socket::recv_internal): New inline method centralizing
	common recv code.
	(fhandler_socket::recvfrom): Call recv_internal now.
	(fhandler_socket::recvmsg): Ditto.  Streamline copying from iovec
	to WSABUF.
	(fhandler_socket::send_internal): New inline method centralizing
	common send code.
	(fhandler_socket::sendto): Call send_internal now.
	(fhandler_socket::sendmsg): Ditto.  Streamline copying from iovec
	to WSABUF.
	(fhandler_socket::close): Call release now.
	(fhandler_socket::ioctl): Never actually switch to blocking mode.
	Just keep track of the setting.
	* net.cc (fdsock): Call prepare now.
	(cygwin_connect): Revert again to event driven technique.
	(cygwin_accept): Ditto.
	* poll.cc (poll): Don't call recvfrom on a listening socket.
	Remove special case for failing recvfrom.
	* include/sys/socket.h: Declare recv* and send* functions ssize_t as
	requested by POSIX.

2006-07-07  Corinna Vinschen  <corinna@@vinschen.de>

	* net.cc (cygwin_inet_ntop): Fix data type of forth parameter.

2006-07-06  Corinna Vinschen  <corinna@@vinschen.de>

	* include/cygwin/in6.h (struct in6_addr): Fix typo.

2006-07-06  Corinna Vinschen  <corinna@@vinschen.de>

	* cygwin.din: Export in6addr_any, in6addr_loopback, freeaddrinfo,
	gai_strerror, getaddrinfo, getnameinfo.
	* fhandler_socket.cc: Include cygwin/in6.h.
	(get_inet_addr): Accomodate AF_INET6 usage.
	(fhandler_socket::connect): Ditto.
	(fhandler_socket::listen): Ditto.
	(fhandler_socket::sendto): Ditto.
	* net.cc: Include cygwin/in6.h.
	(in6addr_any): Define.
	(in6addr_loopback): Define.
	(cygwin_socket): Accomodate AF_INET6 usage.
	(socketpair): Bind socketpairs only to loopback for security.
	(inet_pton4): New static function.
	(inet_pton6): Ditto.
	(cygwin_inet_pton): New AF_INET6 aware inet_pton implementation.
	(inet_ntop4): New static function.
	(inet_ntop6): Ditto.
	(cygwin_inet_ntop): New AF_INET6 aware inet_ntop implementation.
	(ga_aistruct): New static function.
	(ga_clone): Ditto.
	(ga_echeck): Ditto.
	(ga_nsearch): Ditto.
	(ga_port): Ditto.
	(ga_serv): Ditto.
	(ga_unix): Ditto.
	(gn_ipv46): Ditto.
	(ipv4_freeaddrinfo): Ditto.
	(ipv4_getaddrinfo): Ditto.
	(ipv4_getnameinfo): Ditto.
	(gai_errmap_t): New structure holding error code - error string mapping.
	(cygwin_gai_strerror): New function implementing gai_strerror.
	(w32_to_gai_err): New static function.
	(get_ipv6_funcs): Ditto.
	(load_ipv6_funcs): Ditto.
	(cygwin_freeaddrinfo): New function implementing freeaddrinfo.
	(cygwin_getaddrinfo): New function implementing getaddrinfo.
	(cygwin_getnameinfo): New function implementing getnameinfo.
	* include/netdb.h: Include stdint.h and cygwin/socket.h.  Define
	data types and macros used by getaddrinfo and friends.  Declare
	freeaddrinfo, gai_strerror, getaddrinfo and getnameinfo.
	* include/cygwin/in.h: Add IPv6 related IPPROTOs. Remove definition
	of struct sockaddr_in6.  Include cygwin/in6.h instead.
	* include/cygwin/in6.h: New header file defining IPv6 releated
	data types and macros.
	* include/cygwin/socket.h: Enable AF_INET6 and PF_INET6.  Add
	IPv6 related socket options.
	* include/cygwin/version.h: Bump API minor number.

2006-07-06  Corinna Vinschen  <corinna@@vinschen.de>

	* autoload.cc (DsGetDcNameA): Define.
	(NetGetAnyDCName): Define.
	* security.cc: Include dsgetdc.h.
	(DsGetDcNameA): Declare.
	(DS_FORCE_REDISCOVERY): Define.
	(get_logon_server): Add bool parameter to control rediscovery of DC.
	Use DsGetDcNameA function if supported, NetGetDCName/NetGetAnyDCName
	otherwise.
	(get_server_groups): Rediscover DC if get_user_groups fails and
	try again.
	(get_reg_security): Use correct error code macro when testing
	RegGetKeySecurity return value.
	* security.h (get_logon_server): Remove default vaue from wserver
	parameter.  Add rediscovery parameter.
	* uinfo.cc (cygheap_user::env_logsrv): Accomodate rediscovery parameter
	in call to get_logon_server.
@
text
@d297 1
d303 1
a303 1
#define CYGWIN_VERSION_API_MINOR 159
@


1.232
log
@* include/cygwin/version.h: Bump DLL minor version number to 22.
@
text
@d45 2
a46 2
#define CYGWIN_VERSION_DLL_MAJOR 1005
#define CYGWIN_VERSION_DLL_MINOR 22
d292 5
d302 1
a302 1
#define CYGWIN_VERSION_API_MINOR 156
@


1.232.2.1
log
@	* include/cygwin/version.h: Bump DLL minor version number to 23.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 23
@


1.232.2.2
log
@	* include/cygwin/version.h: Bump DLL minor version number to 24.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 24
@


1.232.2.3
log
@	* include/cygwin/version.h: Bump DLL minor version number to 25.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 25
@


1.231
log
@* include/cygwin/version.h: Bump DLL minor version number to 21.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 21
@


1.231.2.1
log
@	* cygwin.din: Export in6addr_any, in6addr_loopback, freeaddrinfo,
	gai_strerror, getaddrinfo, getnameinfo.
	* fhandler_socket.cc: Include cygwin/in6.h.
	(get_inet_addr): Accomodate AF_INET6 usage.
	(fhandler_socket::connect): Ditto.
	(fhandler_socket::listen): Ditto.
	(fhandler_socket::sendto): Ditto.
	* net.cc: Include cygwin/in6.h.
	(in6addr_any): Define.
	(in6addr_loopback): Define.
	(cygwin_socket): Accomodate AF_INET6 usage.
	(socketpair): Bind socketpairs only to loopback for security.
	(inet_pton4): New static function.
	(inet_pton6): Ditto.
	(cygwin_inet_pton): New AF_INET6 aware inet_pton implementation.
	(inet_ntop4): New static function.
	(inet_ntop6): Ditto.
	(cygwin_inet_ntop): New AF_INET6 aware inet_ntop implementation.
	(ga_aistruct): New static function.
	(ga_clone): Ditto.
	(ga_echeck): Ditto.
	(ga_nsearch): Ditto.
	(ga_port): Ditto.
	(ga_serv): Ditto.
	(ga_unix): Ditto.
	(gn_ipv46): Ditto.
	(ipv4_freeaddrinfo): Ditto.
	(ipv4_getaddrinfo): Ditto.
	(ipv4_getnameinfo): Ditto.
	(gai_errmap_t): New structure holding error code - error string mapping.
	(cygwin_gai_strerror): New function implementing gai_strerror.
	(w32_to_gai_err): New static function.
	(get_ipv6_funcs): Ditto.
	(load_ipv6_funcs): Ditto.
	(cygwin_freeaddrinfo): New function implementing freeaddrinfo.
	(cygwin_getaddrinfo): New function implementing getaddrinfo.
	(cygwin_getnameinfo): New function implementing getnameinfo.
	* include/netdb.h: Include stdint.h and cygwin/socket.h.  Define
	data types and macros used by getaddrinfo and friends.  Declare
	freeaddrinfo, gai_strerror, getaddrinfo and getnameinfo.
	* include/cygwin/in.h: Add IPv6 related IPPROTOs. Remove definition
	of struct sockaddr_in6.  Include cygwin/in6.h instead.
	* include/cygwin/in6.h: New header file defining IPv6 releated
	data types and macros.
	* include/cygwin/socket.h: Enable AF_INET6 and PF_INET6.  Add
	IPv6 related socket options.
	* include/cygwin/version.h: Bump API minor number.
@
text
@a291 2
      157: Export gai_strerror, getaddrinfo, getnameinfo, freeaddrinfo,
	   in6addr_any, in6addr_loopback.
d297 1
a297 1
#define CYGWIN_VERSION_API_MINOR 157
@


1.231.2.2
log
@	* Makefile.in (DLL_OFILES): Drop iruserok.o.  Add rcmd.o.
	* autoload.cc (rcmd): Drop definition.
	* cygwin.din: Export bindresvport, bindresvport_sa, iruserok_sa,
	rcmd_af, rresvport_af.
	* net.cc (cygwin_rcmd): Remove.
	(last_used_bindresvport): Rename from last_used_rrecvport.
	(cygwin_bindresvport_sa): New function implementing bindresvport_sa.
	(cygwin_bindresvport): New function implementing bindresvport.
	(cygwin_rresvport): Remove.
	* include/cygwin/version.h: Bump API minor number.
	* include/netinet/in.h: Declare bindresvport and bindresvport_sa.
	* libc/iruserok.c: Remove file.
	* libc/rcmd.cc: New file implementing rcmd, rcmd_af, rresvport,
	rresvport_af, iruserok_sa, iruserok and ruserok.
@
text
@a293 2
      158: Export bindresvport, bindresvport_sa, iruserok_sa, rcmd_af,
	   rresvport_af.
d299 1
a299 1
#define CYGWIN_VERSION_API_MINOR 158
@


1.231.2.3
log
@	* cygwin.din (posix_openpt): Export.
	* tty.cc (posix_openpt): New function.
	* include/cygwin/stdlib.h (posix_openpt): Declare.
	* include/cygwin/version.h: Bump API minor number.
@
text
@a295 1
      159: Export posix_openpt.
d301 1
a301 1
#define CYGWIN_VERSION_API_MINOR 159
@


1.231.2.4
log
@	* Merge HEAD into cv-branch.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 22
@


1.230
log
@	* cygwin.din: Export __srget_r, __swbuf_r.
	* include/cygwin/version.h: Bump API minor number to 156.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 20
@


1.229
log
@force null checkin
@
text
@d291 1
d297 1
a297 1
#define CYGWIN_VERSION_API_MINOR 155
@


1.228
log
@	* cygwin.din: Export __isinff, __isinfd, __isnanf, __isnand.
	* include/cygwin/version.h: Bump API minor number to 155.
@
text
@@


1.227
log
@	* cygwin.din: Export sigignore and sigset.
	* exceptions.cc (sigset): New function.
	(sigignore): New function.
	* include/cygwin/signal.h (SIG_HOLD): Define.
	(sigignore): Declare.
	(sigset): Declare.
	* include/cygwin/version.h: Bump API minor number to 154.
@
text
@d290 1
d296 1
a296 1
#define CYGWIN_VERSION_API_MINOR 154
@


1.226
log
@* cygwin/version.h: Mention CW_SETUP_WINENV in comment for API minor 153.
@
text
@d289 1
d295 1
a295 1
#define CYGWIN_VERSION_API_MINOR 153
@


1.225
log
@	* cygwin.din (updwtmpx): Export.
	* syscalls.cc (updwtmpx): New function.
	* include/utmpx.h (updwtmpx): Declare.
	* include/cygwin/version.h: Bump API minor number to 153.
@
text
@d288 1
a288 1
      153: Export updwtmpx.
@


1.224
log
@	* dir.cc (readdir_worker): Add comment about writing old 32 bit d_ino.
	* include/cygwin/version.h: Bump API minor number to 152.
	(CYGWIN_VERSION_CHECK_FOR_NEEDS_D_INO): Remove.
@
text
@d288 1
d294 1
a294 1
#define CYGWIN_VERSION_API_MINOR 152
@


1.223
log
@* include/cygwin/version.h: Bump API minor number to 151.
* dir.cc (__opendir_with_d_ino): New function.
(opendir): Set flag if we should be calculating inodes.
(readdir_worker): Calculate d_ino by calling stat if the user has asked for it.
(seekdir64): Maintain all persistent flag settings.
* fhandler.h (dirent_states): Add dirent_set_d_ino.
* fhandler_disk_file.cc (fhandler_disk_file::opendir): Reflect changes to
dirent structure.
* fhandler_virtual.cc (fhandler_virtual::opendir): Ditto.
* include/sys/dirent.h (struct dirent): Coalesce two similar structures.
Remove all threads of the apparently highly confusing references to inodes.
Add support for calculating a real inode if __USE_EXPENSIVE_CYGWIN_D_INO is
defined.
@
text
@a96 3
#define CYGWIN_VERSION_CHECK_FOR_NEEDS_D_INO \
  (CYGWIN_VERSION_USER_API_VERSION_COMBINED < 147)

d279 4
a282 4
      146: Change SI_USER definition.  FIXME: Need to develop compatibility macro
           for this?
      147: Eliminate problematic d_ino from dirent structure.  unsetenv now returns
           int, as per linux.
d287 1
d293 1
a293 1
#define CYGWIN_VERSION_API_MINOR 151
@


1.222
log
@* include/cygwin/version.h: Bump DLL minor version number to 20.
@
text
@d289 1
d295 1
a295 1
#define CYGWIN_VERSION_API_MINOR 150
@


1.221
log
@	* Update copyrights.
@
text
@d46 1
a46 1
#define CYGWIN_VERSION_DLL_MINOR 19
@


1.220
log
@	* cygwin.din: Export getsubopt.
	* include/cygwin/version.h: Bump API minor version.
@
text
@d3 2
a4 1
   Copyright 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004 Red Hat, Inc.
@


1.219
log
@	* fhandler.h (fhandler_base::issymlink): New method.
	* syscalls.cc (open): Handle O_NOFOLLOW flag.
	* include/fcntl.h (_FNOFOLLOW): New define.
	(O_NOFOLLOW): Ditto.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d287 1
d293 1
a293 1
#define CYGWIN_VERSION_API_MINOR 149
@


1.218
log
@	* fhandler.cc (fhandler_base::open_9x): Handle O_SYNC and O_DIRECT
	flags.
	(fhandler_base::open): Ditto.
	* fhandler_floppy.cc (fhandler_dev_floppy::open): Don't allocate devbuf
	in O_DIRECT case.
	* fhandler_raw.cc (fhandler_dev_raw::ioctl): Don't allow buffer
	changes in O_DIRECT case.  Allow returning a buffer size 0, which
	indicates O_DIRECT.
	* fhandler_tape.cc (fhandler_dev_tape::open): Use O_SYNC flag to
	hand down the !buffer_writes case.  Don't allocate devbuf in O_DIRECT
	case.
	(fhandler_dev_tape::raw_read): Don't mess with devbuf if it's NULL.
	* include/fcntl.h: Define _FDIRECT, O_DIRECT, O_DSYNC and O_RSYNC.
	* include/cygwin/version.h: Bump API minor version.
@
text
@d286 1
d292 1
a292 1
#define CYGWIN_VERSION_API_MINOR 148
@


1.217
log
@* include/cygwin/stdlib.h: New file.
* environ.cc (unsetenv): Change to return -1 on input error.
* include/cygwin/version.h: Add more description to latest api bump.
@
text
@d285 1
d291 1
a291 1
#define CYGWIN_VERSION_API_MINOR 147
@


1.216
log
@* dir.cc (readdir_workdir): Only fill out d_ino when linked into older app.
* include/cygwin/version.h: Bump api minor number to 147, reflecting
obsolescence of d_ino.
(CYGWIN_VERSION_USER_API_VERSION_COMBINED): New convenience macro.
(CYGWIN_VERSION_CHECK_FOR_NEEDS_D_INO): New convenience macro.
@
text
@d283 2
a284 1
      147: Eliminate problematic d_ino from dirent structure.
@


1.215
log
@* cygtls.h (_cygtls::el): New field.
(_cygtls::handle_exceptions): New function declaration.
(_cygtls::handle_threadlist_exception): Ditto.
(_cygtls::init_exception_handler): Ditto.
(_cygtls::init_threadlist_exceptions): Remove arg from declaration.
* cygtls.cc (_cygtls::call2): Don't initialize exceptions here.
(_cygtls::init_thread): Do it here instead and use member function.
(_cygtls::handle_threadlist_exception): Move into _cygtls class.
(_cygtls::init_exception_handler): Ditto.  Rely on existence of 'el' memmber in
_cygtls.
(_cygtls::init_threadlist_exceptions): Ditto.
* dcrt0.cc (dll_crt0_1): Remove exception_list definition and setting since it
now commonly resides in the tls.
* exceptions.cc (init_exception_handler): Move to cygtls.cc.
(init_exceptions): Ditto.
(rtl_unwind): New, safe wrapper function for RtlUnwind.
(_cygtls::handle_exceptions): Move to _cygtls.  Call rtl_unwind to unwind
frames and eliminate copying of structures.  Put address of failing instruction
in si_addr, not the address on the stack.  Return 0 to indicate that we've
handled this exception.
* external.cc (cygwin_internal): Make CW_INIT_EXCEPTIONS a no-op.
* sigproc.cc (wait_sig): Accommodate argument change to
_cygtls::init_threadlist_exceptions.
* tlsoffsets.h: Regenerate.
* include/exceptions.h (exception_list): Add more stuff to the exception list.
Apparently windows needs this?
(init_exceptions): Remove bogus declaration.
* include/cygwin/signal.h (SI_USER): Redefine as zero as per SUSv3.
* thread.cc (pthread_kill): Set si_pid and si_uid.
* timer.cc (timer_thread): Set si_code to SI_TIMER.
@
text
@d66 3
d73 1
a73 2
  (CYGWIN_VERSION_DLL_MAKE_COMBINED (user_data->api_major, user_data->api_minor) <= \
  CYGWIN_VERSION_DLL_OLD_TERMIOS)
d79 1
a79 2
  (CYGWIN_VERSION_DLL_MAKE_COMBINED (user_data->api_major, user_data->api_minor) <= \
  20)
d82 1
a82 2
  (CYGWIN_VERSION_DLL_MAKE_COMBINED (user_data->api_major, user_data->api_minor) >= \
  36)
d85 1
a85 2
  (CYGWIN_VERSION_DLL_MAKE_COMBINED (user_data->api_major, user_data->api_minor) <= \
  28)
d88 1
a88 2
  (CYGWIN_VERSION_DLL_MAKE_COMBINED (user_data->api_major, user_data->api_minor) >= \
  79)
d91 1
a91 2
  (CYGWIN_VERSION_DLL_MAKE_COMBINED (user_data->api_major, user_data->api_minor) <= \
 138)
d94 1
a94 2
  (CYGWIN_VERSION_DLL_MAKE_COMBINED (user_data->api_major, user_data->api_minor) <= \
 138)
d96 2
a97 3
     /* We used to use the DLL major/minor to track
	non-backward-compatible interface changes to the API.  Now we
	use an API major/minor number for this purpose. */
d283 1
d289 1
a289 1
#define CYGWIN_VERSION_API_MINOR 146
@


1.214
log
@	* include/cygwin/version.h: Bump API minor version.
@
text
@d286 2
d293 1
a293 1
#define CYGWIN_VERSION_API_MINOR 145
@


1.213
log
@	* libc: Add subdirectory.
	* Makefile.in (VPATH): Add libc subdir.
	(DLL_OFILES): Add strptime.o and timelocal.o.
	* cygwin.din: Export timelocal and timegm.
	* localtime.cc: Define STD_INSPIRED unconditionally.
	* include/cygwin/time.h (timelocal): Add declaration.
	(timegm): Ditto.
	* include/cygwin/version.h: Bump API minor version.
	* libc/strptime.cc: New file.
	* libc/timelocal.cc: New file.
	* libc/timelocal.h: New file.
@
text
@d285 1
d291 1
a291 1
#define CYGWIN_VERSION_API_MINOR 144
@


1.212
log
@* cygheap.h (init_cygheap::_gtod): Remove.
* cygwin.din: Export clock_getres and clock_setres.
* hires.h (hires_ms::minperiod): Delete declaration.
(hires_ms::began_period): Ditto.
(hires_ms::prime): Make void.
(hires_ms::resolution): Just define here.
(hires_ms::usecs): Remove unneeded argument.
(gtod): Redeclare as a variable.
* timer.cc (timer_thread): Eliminate argument to gtod.usecs().
(timer_tracker::gettime): Ditto.
(timer_tracker::settime): Ditto.
* times.cc (gettimeofday): Ditto.
(hires_ms::began_period): Delete declaration.
(hires_us::prime): Remove debugging.
(hires_ms::prime): Make void.  Eliminate period stuff.
(hires_ms::usecs): Eliminate argument to gtod.usecs().
(hires_ms::resolution): New function.
(clock_getres): Ditto.
(clock_setres): Ditto.
* version.h: Bump API version to 143.
* include/cygwin/time.h: New file.
@
text
@d284 1
d290 1
a290 1
#define CYGWIN_VERSION_API_MINOR 143
@


1.211
log
@* memmem.cc: New file.
* include/cygwin/version.h: Bump API version number to 142.
* cygwin.din: Export memmem.
@
text
@d283 1
d289 1
a289 1
#define CYGWIN_VERSION_API_MINOR 142
@


1.210
log
@	* include/cygwin/version.h: Fix typo.
@
text
@d282 1
d288 1
a288 1
#define CYGWIN_VERSION_API_MINOR 141
@


1.209
log
@	* cygwin.din (futimes): Export.
	(lutimes): Export.
	* times.cc (utimes_worker): Created from utimes, add nofollow flag
	to implement utimes and lutimes.
	(utimes): Just call utimes_worker.
	(lutimes): New function.
	(futimes): Ditto.
	* include/cygwin/version.h: Bump API minor version.
@
text
@d281 1
a281 1
      140: Export futimes, lutimes.
@


1.208
log
@	* autoload.cc (NtLockVirtualMemory): Import.
	(NtUnlockVirtualMemory): Import.
	(GetProcessWorkingSetSize): Import.
	(SetProcessWorkingSetSize): Import.
	* cygwin.din (mlock): Export.
	(munlock): Export.
	* mmap.cc (mlock): New function.
	(munlock): Ditto.
	* ntdll.h (STATUS_WORKING_SET_QUOTA): Define.
	(LOCK_VM_IN_WSL): Define.
	(LOCK_VM_IN_RAM): Define.
	(NtLockVirtualMemory): Declare.
	(NtUnlockVirtualMemory): Declare.
	* sysconf.cc (sysconf): Implement _SC_MEMLOCK_RANGE.
	* wincap.h: Implement has_working_virtual_lock throughout.
	* wincap.cc: Ditto.
	* include/cygwin/version.h: Bump API minor version.
	* include/sys/mman.h (mlock): Declare,
	(munlock): Declare.
@
text
@d281 1
d287 1
a287 1
#define CYGWIN_VERSION_API_MINOR 140
@


1.207
log
@	* autoload.cc: Never load wsock32.dll. Load all wsock32 function
	from ws2_32.  Rearrange symbol order accordingly.  None of the ws2_32
	functions is optional right now.
	(wsadata): Move from net.cc here.  Define NO_COPY.
	(wsock_init): Drop unused symbols ws2_32_handle and wsock32_handle.
	(load_wsock32): Remove.
	(WSACleanup): Remove.
	* fhandler_socket.cc: Drop Winsock 1 accommodations throughout.
	(fhandler_socket::readv): Accomodate new POSIX style struct msghdr.
	(fhandler_socket::writev): Ditto.
	(fhandler_socket::recvmsg): Ditto. Handle "old" applications using
	former struct msghdr correctly.
	* net.cc: Drop Winsock 1 accommodations throughout.
	(wsadata): Move definition to autoload.cc.
	(set_socket_inheritance): Remove.
	(convert_ws1_ip_optname): New static function to convert Winsock1
	IPPROTO_IP option values into Winsock2 IPPROTO_IP option values.
	(cygwin_setsockopt): Remove wrong and incomplete cleartext printing
	of optname.  For "old" applications, convert optname from Winsock1
	to Winsock2 values before using them.  Add comment to describe the
	IP_TOS weirdness on W2K and above.
	(cygwin_getsockopt): Remove wrong and incomplete cleartext printing
	of optname.  For "old" applications, convert optname from Winsock1
	to Winsock2 values before using them.
	* select.cc (start_thread_socket): Forget about winsock2_active.
	* winsup.h (wsock32_handle): Remove declaration.
	(ws2_32_handle): Ditto.
	(netapi32_handle): Ditto.
	(wsadata): Ditto.
	(winsock2_active): Remove definition.
	* include/cygwin/socket.h: Change formatting slightly.
	(socklen_t): Move definition up in file.
	(struct msghdr): Convert to POSIX style.
	(struct cmsghdr): New type.
	(CMSG_ALIGN): New macro.
	(CMSG_LEN): Ditto.
	(CMSG_SPACE): Ditto.
	(CMSG_FIRSTHDR): Ditto.
	(CMSG_NXTHDR): Ditto.
	(CMSG_DATA): Ditto.
	(SCM_RIGHTS): Ditto.
	(struct OLD_msghdr): Define old msghdr structure for Cygwin internal
	purposes.
	(MSG_TRUNC): New macro.
	(MSG_CTRUNC): Ditto.
	(IP_OPTIONS): Redefine IPPROTO_IP option values to Winsock2 values.
	Keep Winsock1 values for Cygwin internal purposes.
	* include/cygwin/version.h: Bump API minor version.
	(CYGWIN_VERSION_CHECK_FOR_USING_ANCIENT_MSGHDR): Define to check for
	applications using old struct msghdr.
	(CYGWIN_VERSION_CHECK_FOR_USING_WINSOCK1_VALUES): Define to check for
	applications using old Winsock1 IPPROTO_IP values.
@
text
@d280 1
d286 1
a286 1
#define CYGWIN_VERSION_API_MINOR 139
@


1.206
log
@	Revert erroneous checkin.
@
text
@d91 9
d278 2
d285 1
a285 1
#define CYGWIN_VERSION_API_MINOR 138
@


1.205
log
@	* fhandler.h (class fhandler_dev_raw): Delete current_position and
	eof_detected status flag.  Delete is_eom and is_eof methods.
	Move drive_size, bytes_per_sector, eom_detected status flag, as well
	as the methods read_file, write_file, raw_read and raw_write to ...
	(class fhandler_dev_floppy): ... here. Remove is_eom and is_eof
	methods.  Add dup method.
	* fhandler_floppy.cc (IS_EOM): New macro.
	(fhandler_dev_floppy::is_eom): Remove.
	(fhandler_dev_floppy::is_eof): Remove.
	(fhandler_dev_floppy::fhandler_dev_floppy): Initialize status flags.
	(fhandler_dev_floppy::get_drive_info): Only call EX functions on
	systems supporting them and stop suffering strange delays.
	(fhandler_dev_floppy::read_file): Move here, drop setting
	current_position.
	(fhandler_dev_floppy::write_file): Move here, drop setting
	current_position.
	(fhandler_dev_floppy::open): Rearrange comment.
	(fhandler_dev_floppy::dup): New method.
	(fhandler_dev_floppy::get_current_position): New inline method.  Use
	instead of former current_position were appropriate.
	(fhandler_dev_floppy::raw_read): Move here.  Drop EOF handling.
	(fhandler_dev_floppy::raw_write): Move here.  Drop EOF handling.
	(fhandler_dev_floppy::lseek): Remove useless conditions.  Convert
	sector_aligned_offset to LARGE_INTEGER to improve SetFilePointer call.
	(fhandler_dev_floppy::ioctl): Move blocksize check in RDSETBLK case
	to here.
	* fhandler_raw.cc (fhandler_dev_raw::is_eom): Remove.
	(fhandler_dev_raw::is_eof): Remove.
	(fhandler_dev_raw::write_file): Remove.
	(fhandler_dev_raw::read_file): Remove.
	(fhandler_dev_raw::raw_read): Remove.
	(fhandler_dev_raw::raw_write): Remove.
	(fhandler_dev_raw::dup): Drop copying removed members.
	(fhandler_dev_raw::ioctl): Drop blocksize testing.
	* wincap.h: Implement has_disk_ex_ioctls throughout.
	* wincap.cc: Ditto.
	(wincap_vista): Preliminary wincaps for Windows Vista/Longhorn.
	(wincapc::init): Add Vista/Longhorn handling.
@
text
@a90 4

#define CYGWIN_VERSION_CHECK_FOR_USING_ANCIENT_MSGHDR \
  (CYGWIN_VERSION_DLL_MAKE_COMBINED (user_data->api_major, user_data->api_minor) <= \
 132)
a270 4
     /*
      133: Start using POSIX definition of struct msghdr.
     */

@


1.204
log
@Add missing ChangeLog for previous checkin.
Revert erroneous include/cygwin/version.h checkin.
@
text
@d91 4
d275 4
@


1.203
log
@* cygwin.din: Correct readdir_r typo.
@
text
@a268 1
      139: Change strerror_r to be ISO C compliant.
d274 1
a274 1
#define CYGWIN_VERSION_API_MINOR 139
@


1.202
log
@* cygerrno.h (geterrno_from_win_error): Change declaration to default to using
GetLastError and EACCESS.
* cygwin.din: Export readdir_r.
* include/cygwin/version.h: Bump API version number to 138.
* syscalls.cc (readdir_worker): New function, renamed from old readdir()
function.
(readdir): Use readdir_worker.
(readdir_r): New function.
* fhandler.h (fhandler_base::readdir): Accommodate second argument indicating
dirent buffer.
(fhandler_disk_file::readdir): Ditto.
(fhandler_cygdrive::readdir): Ditto.
(fhandler_proc::readdir): Ditto.
(fhandler_netdrive::readdir): Ditto.
(fhandler_registry::readdir): Ditto.
(fhandler_process::readdir): Ditto.
* fhandler.cc (fhandler_base::readdir): Ditto.
* fhandler_disk_file.cc (fhandler_disk_file::readdir): Ditto.
* fhandler_cygdrive.cc (fhandler_cygdrive::readdir): Ditto.
* fhandler_proc.cc (fhandler_proc::readdir): Ditto.
* fhandler_netdrive.cc (fhandler_netdrive::readdir): Ditto.
* fhandler_registry.cc (fhandler_registry::readdir): Ditto.
* fhandler_process.cc (fhandler_process::readdir): Ditto.
@
text
@d269 1
d275 1
a275 1
#define CYGWIN_VERSION_API_MINOR 138
@


1.201
log
@	* Makefile.in (DLL_OFILES): Add fts.o, ftw.o, nftw.o.
	* cygwin.din: Export fts_children, fts_close, fts_get_clientptr,
	fts_get_stream, fts_open, fts_read, fts_set, fts_set_clientptr,
	ftw, nftw.
	* fts.c: New file, imported from FreeBSD.
	* ftw.c: Ditto.
	* nftw.c: Ditto.
	* include/fts.h: Ditto.
	* include/ftw.h: Ditto.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d268 1
d274 1
a274 1
#define CYGWIN_VERSION_API_MINOR 137
@


1.200
log
@	* include/sys/termios.h: Define TIOCMBIS and TIOCMBIC.
	* fhandler.h (class fhandler_serial): Declare switch_modem_lines.
	* fhandler_serial.cc (fhandler_serial::switch_modem_lines): New
	static function to set or clear DTR and/or RTS.
	(fhandler_serial::ioctl): Use switch_modem_lines for TIOCMSET
	and new TIOCMBIS and TIOCMBIC.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d266 2
d273 1
a273 1
#define CYGWIN_VERSION_API_MINOR 136
@


1.199
log
@* fhandler.h (fhandler_base::pread): Declare new function.
(fhandler_base::pwrite): Ditto.
(fhandler_disk_file::pread): Ditto.
(fhandler_disk_file::pwrite): Ditto.
* fhandler.cc (fhandler_base::pread): Define new function.
(fhandler_base::pwrite): Ditto.
* fhandler_disk_file.cc (fhandler_base::pread): Ditto.
(fhandler_base::pwrite): Ditto.
* syscalls.cc (pread): Define new function.
(pwrite): Ditto.
* cygwin.din: Export pread, pwrite.
* include/sys/ioctl.h: Guard some _IO* declarations to avoid conflict with
socket.h.
@
text
@d265 1
d271 1
a271 1
#define CYGWIN_VERSION_API_MINOR 135
@


1.198
log
@	* cygwin.din (getline): Export.
	(getdelim): Export.
	* include/sys/stdio.h (getline): Replace macro with function prototype.
	(getdelim):  Likewise.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d264 1
d270 1
a270 1
#define CYGWIN_VERSION_API_MINOR 134
@


1.197
log
@	* cygwin.din (__getline): Export.
	(__getdelim): Export.
	* include/sys/stdio.h (getline): Define as __getline.
	(getdelim): Define as __getdelim.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d263 1
d269 1
a269 1
#define CYGWIN_VERSION_API_MINOR 133
@


1.196
log
@* include/cygwin/version.h: Bump DLL minor number to 19.
@
text
@d262 1
d268 1
a268 1
#define CYGWIN_VERSION_API_MINOR 132
@


1.195
log
@	* glob.c: (glob0): New local variable `limit`. Use in calls to glob1
	and globextend.
	(glob1): Add `limit' parameter.
	(glob2): Ditto.
	(glob3): Ditto.
	(globextend): Ditto. Implement GLOB_LIMIT handling.
	* include/glob.h (GLOB_LIMIT): New define.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 18
@


1.194
log
@	* cygwin.din (inet_pton): Export.
	(inet_ntop): Export.
	* net.cc (cygwin_inet_pton): Implement inet_pton for AF_INET for now.
	(cygwin_inet_ntop): Implement inet_ntop for AF_INET for now.
	* include/arpa/inet.h (inet_pton): Declare.
	(inet_ntop): Declare.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d261 1
d267 1
a267 1
#define CYGWIN_VERSION_API_MINOR 131
@


1.193
log
@	* cygwin.din (imaxabs): Export.
	(imaxdiv): Export.
	(llabs): Export.
	(lldiv): Export.
	(strtoimax): Export.
	(strtoumax): Export.
	* include/inttypes.h (imaxabs): Activate declaration.
	(imaxdiv): Ditto.
	(strtoimax): Ditto.
	(strtoumax): Ditto.
	* include/cygwin/version.h: Bump API minor.
@
text
@d260 1
d266 1
a266 1
#define CYGWIN_VERSION_API_MINOR 130
@


1.192
log
@* include/cygwin/version.h: Bump DLL minor number to 18.
@
text
@d259 1
d265 1
a265 1
#define CYGWIN_VERSION_API_MINOR 129
@


1.191
log
@* include/cygwin/version.h: Bump API minor number to 129.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 17
@


1.190
log
@white space and minor comment cleanup.
@
text
@d258 1
d264 1
a264 1
#define CYGWIN_VERSION_API_MINOR 128
@


1.189
log
@* include/cygwin/version.h: Bump DLL minor number to 17.
@
text
@d238 1
a238 1
           timer_settime
d242 1
a242 1
           on Linux.
d245 1
a245 1
           getlogin_r.
@


1.188
log
@	* cygwin.din (pselect): Export.
	* select.cc (pselect): New function.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/select.h: Include signal.h.  Declare pselect.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 16
@


1.187
log
@* include/cygwin/version.h: Bump DLL minor number to 16.
@
text
@d257 1
d263 1
a263 1
#define CYGWIN_VERSION_API_MINOR 127
@


1.186
log
@* fhandler.cc (fhandler::dup): Duplicate flags, too.
* fhandler.h (fhandler_fifo::owner): Eliminate.
* fhandler_disk_file.cc (fhandler_base::fstat_fs): Handle on-disk devices
better.
(fhandler_base::fstat_helper): Ditto.
* fhandler_fifo.cc (fhandler_fifo::fhandler_fifo): Don't initialize obsolete
"owner".
(fhandler_fifo::open_not_mine): Add some debugging.  Duplicate correct handle
when we own it.
(fhandler_fifo::open): Set flags from input, not from first pipe.  Flag that
fork fixup is needed.
(fhandler_fifo::dup): Set errno correctly when DuplicateHandle fails.
* pinfo.cc (commune_send): Add debugging for fifo.
* cygwin/version.h: Bump API minor version to 127 to reflect exporting of
sigrelese.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 15
@


1.185
log
@* include/cygwin/version.h: Bump DLL minor number to 15.
@
text
@d255 2
a256 1
      126: Add lsearch, lfind, timer_gettime.
d262 1
a262 1
#define CYGWIN_VERSION_API_MINOR 126
@


1.184
log
@* wininfo.h (wininfo::timer_active): Delete.
(wininfo::itv): Ditto.
(wininfo::start_time): Ditto.
(wininfo::window_started): Ditto.
(wininfo::getitimer): Ditto.
(wininfo::setitimer): Ditto.
(wininfo::wininfo): Ditto.
(wininfo::lock): New method.
(wininfo::release): Ditto.
* window.cc: Use new lock/acquire wininfo methods throughout.
(wininfo::wininfo): Delete
(wininfo::getitimer): Ditto.
(wininfo::setitimer): Ditto.
(getitimer): Ditto.
(setitimer): Ditto.
(ualarm): Ditto.
(alarm): Ditto.
(wininfo::lock): Define new function.
(wininfo::release): Ditto.
(wininfo::process): Delete WM_TIMER handling.
* timer.cc (struct timetracker): Delete it, flags.  Add it_interval,
interval_us, sleepto_us, running, init_muto(), syncthread, and gettime().
(ttstart): Make NO_COPY.
(lock_timer_tracker): New class.
(timer_tracker::timer_tracker): Distinguish ttstart case.
(timer_tracker::~timer_tracker): New destructor.  Clean out events, and reset
magic.
(timer_tracker::init_muto): New method.
(to_us): Round up as per POSIX.
(timer_thread): Reorganize to match timer_tracker::settime and
timer_tracker::gettime.  Call sig_send without wait.  Call auto_release.
(timer_tracker::settime): Reorganize logic to avoid race.  Call gettime to
recover old value.
(timer_tracker::gettime): New method.
(timer_create): Properly set errno on invalid timerid.  Use new
lock_timer_tracker method.
(timer_delete): Ditto.  Simplify code slightly.
(timer_gettime): New function.
(fixup_timers_after_fork): Reinit ttstart.
(getitimer): New implementation.
(setitimer): Ditto.
(ualarm): Ditto.
(alarm): Ditto.
* cygwin.din: Export timer_gettime.
* winsup.h: Remove has has_visible_window_station declaration.
* Makefile.in (DLL_OFILES): Add lsearch.o.
* cygthread.h (cygthread::notify_detached): New element.
(cygthread::cygthread): Take optional fourth argument signifying event to
signal on thread completion.
* cygthread.cc (cygthread::stub): Signal notify_detached event, if it exists.
(cygthread::cygthread): Initialize notify_detached from fourth argument.
(cygthread::detach): Wait for notify_detached field is present.
* lsearch.cc: New file.
* search.h: Ditto.
* include/cygwin/version.h: Bump API minor number to 126.
* cygwin.din: Export lsearch, lfind.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 14
@


1.183
log
@* include/cygwin/version.h: Change coment for most recent API version bump to
reflect new additions to the DLL and to remove change obsoleted by the previous
checkin.
@
text
@d255 1
d261 1
a261 1
#define CYGWIN_VERSION_API_MINOR 125
@


1.182
log
@	* cygwin.din (__ctype_ptr): Export.
	* include/cygwin/version.h: Bump API minor version.
@
text
@d254 1
a254 1
      125: Export __ctype_ptr.
@


1.181
log
@	* mmap.cc (mmap64): Handle MAP_AUTOGROW flag.
	(fhandler_disk_file::mmap): Ditto. Clean conditional for readability.
	* include/sys/mman.h: Add MAP_AUTOGROW flag.
	* include/cygwin/version.h: Bump API minor version.
@
text
@d254 1
d260 1
a260 1
#define CYGWIN_VERSION_API_MINOR 124
@


1.180
log
@	* cygwin.din (utmpxname): Export.
	* syscalls.cc (utmpxname): Create export alias to utmpname.
	* include/utmpx.h: Define ut_name and ut_xtime if not already defined.
	(utmpxname): Add prototype.
	* include/sys/utmp.h: Only define ut_name if not already defined.
	* include/cygwin/version.h: Bump API minor version.
@
text
@d253 1
d259 1
a259 1
#define CYGWIN_VERSION_API_MINOR 123
@


1.179
log
@* include/cygwin/version.h: Bump DLL minor number to 14.
@
text
@d252 1
d258 1
a258 1
#define CYGWIN_VERSION_API_MINOR 122
@


1.178
log
@	* cygwin.din (getpeereid): Export.
	* fhandler.h (class fhandler_socket): Add pipe and id members to
	exchange eid credentials for AF_LOCAL sockets.
	(eid_pipe_name): Declare new method.
	(getpeereid): Ditto.
	* fhandler_socket.cc (fhandler_socket::eid_pipe_name): New method.
	(fhandler_socket::fhandler_socket): Initialize sec_pipe.
	(fhandler_socket::connect): Exchange eid credentials with accepting
	socket process.
	(fhandler_socket::listen): Prepare eid credential transaction.
	(fhandler_socket::accept): Exchange eid credentials with connecting
	socket process.
	(fhandler_socket::close): Close eid credentials pipe if open.
	(fhandler_socket::getpeereid): New method.
	* net.cc (cygwin_getsockopt): Add SO_PEERCRED handling.
	(getpeereid): New function.
	* include/asm/socket.h (SO_PEERCRED): Define.
	* include/cygwin/socket.h (struct ucred): Define new type.
	* include/cygwin/version.h: Bump API minor version.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 13
@


1.177
log
@	* cygwin.din (fstatvfs): Export.
	(statvfs): Export.
	* syscalls.cc: Include sys/statvfs.h.
	(statvfs): New function.  Move statfs functionality here.
	(fstatvfs): New function.
	(statfs): Just call statvfs and copy structure.  Check validity of
	incoming struct statfs pointer.
	* include/cygwin/types.h (fsblkcnt_t): Define.
	(fsfilcnt_t): Define.
	* include/cygwin/version.h: Bump API minor version.
	* include/sys/statvfs.h: New file.
@
text
@d251 1
a251 1
      121: Export statvfs, fstatvfs.
d257 1
a257 1
#define CYGWIN_VERSION_API_MINOR 121
@


1.176
log
@	* cygwin.din (basename): Export.
	(dirname): Export.
	* path.cc (basename): New function.
	(dirname): New function.
	* include/libgen.h: New file.
	* include/cygwin/version.h: Bump API minor version.
@
text
@d251 1
d257 1
a257 1
#define CYGWIN_VERSION_API_MINOR 120
@


1.175
log
@	* include/cygwin/version.h: Fix comment.
@
text
@d250 1
d256 1
a256 1
#define CYGWIN_VERSION_API_MINOR 119
@


1.174
log
@	* cygwin.din (fdatasync): Export.
	* fhandler.cc (fhandler_base::fsync): Return with EINVAL if no
	handle is available.
	* syscalls.cc (fdatasync): Create export alias to fsync.
	* include/cygwin/version.h: Bump API minor version.
@
text
@d249 1
a249 1
      118: Export fdatasync.
@


1.173
log
@	* cygwin.din: Export getpriority and setpriority.
	* fork.cc (fork_parent): Copy parent's nice value into child.
	* spawn.cc (spawn_guts): Ditto.
	* miscfuncs.cc (winprio_to_nice): New function.
	(nice_to_winprio): Ditto.
	* pinfo.cc (pinfo_init): If parent is not a Cygwin process, set
	default nice value according to current Win32 priority class.
	* pinfo.h (class _pinfo): Add nice member.
	* syscalls.cc (setpriority): New function, only implementing
	PRIO_PROCESS for now.
	(getpriority): Ditto.
	(nice): Just call setpriority.
	* wincap.h (wincaps::has_extended_priority_class): New element.
	* wincap.cc: Implement above element throughout.
	* winsup.h: Add prototypes for winprio_to_nice and nice_to_winprio.
	* include/limits.h (NZERO): New define.
	* include/cygwin/types.h (id_t): New datatype.
	* include/cygwin/version.h: Bump API minor version.
	* include/sys/resource.h: Add PRIO_XXX defines and prototypes for
	getpriority and setpriority.
@
text
@d249 1
d255 1
a255 1
#define CYGWIN_VERSION_API_MINOR 118
@


1.172
log
@	* cygwin.din: Add utmpx symbols.
	* syscalls.cc: Include utmpx.h.  Implement utmpx functions as stubs
	to utmp functions.
	(copy_ut_to_utx): New static function.
	(pututline): Change from void to struct utmp * as on Linux.
	(setutxent): New function.
	(endutxent): New function.
	(getutxent): New function.
	(getutxid): New function.
	(getutxline): New function.
	(pututxline): New function.
	* include/utmpx.h: New file.
	* include/cygwin/utmp.h: New file.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/utmp.h: Include cygwin/utmp.h.  Move stuff common with
	utmpx functionality there.
	(pututline): Declare struct utmp *.
@
text
@d248 1
d254 1
a254 1
#define CYGWIN_VERSION_API_MINOR 117
@


1.171
log
@* include/cygwin/version.h: Bump DLL minor number to 13.
@
text
@d247 1
d253 1
a253 1
#define CYGWIN_VERSION_API_MINOR 116
@


1.170
log
@* include/cygwin/version.h: Bump DLL minor number to 12.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 12
@


1.169
log
@* include/cygwin/version.h: REALLY bump dll minor version to 11.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 11
@


1.168
log
@* winbase.h: Semi-revert previous patch as it caused strange behavior.  Use
syntax similar to that recommended in mingw-dvlpr.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 10
@


1.168.2.1
log
@Knock down version number.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 9
@


1.168.2.2
log
@* include/cygwin/version.h: Bump up dll version to 10.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 10
@


1.167
log
@* include/cygwin/version.h: Bump DLL minor number to 11.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 11
@


1.166
log
@* include/cygwin/version.h: Bump api minor version number.
* cygwin.din: Export atoll.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 10
@


1.165
log
@	* cygwin.din: Add symbols flockfile, ftrylockfile, funlockfile,
	getgrgid_r, getgrnam_r and getlogin_r.
	* grp.cc (getgrgid_r): New function.
	(getgrnam_r): Ditto.
	* syscalls.cc (flockfile): Ditto.
	(ftrylockfile): Ditto.
	(funlockfile): Ditto.
	* sysconf.cc (sysconf): Return LOGIN_NAME_MAX in case of
	_SC_LOGIN_NAME_MAX.
	* thread.cc (__cygwin_lock_trylock): Define int.  Return value from
	call to pthread_mutex_trylock.
	* uinfo.cc (getlogin_r): New function.
	* include/limits.h: Define LOGIN_NAME_MAX.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/lock.h: Add declarations for __cygwin_lock_xxx functions.
	* include/sys/stdio.h: Add define for _ftrylockfile.
@
text
@d246 1
d252 1
a252 1
#define CYGWIN_VERSION_API_MINOR 115
@


1.164
log
@	* cygwin.din: Export rand_r and ttyname_r.
	* syscalls.cc (ttyname_r): New function.
	(ttyname): Move functionality to ttyname_r.  Call it from here.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d244 2
d251 1
a251 1
#define CYGWIN_VERSION_API_MINOR 114
@


1.163
log
@	* errno.cc (errmap): Map ERROR_SHARING_VIOLATION to EBUSY,
	ERROR_EOM_OVERFLOW and ERROR_NO_DATA_DETECTED to EIO.  Add mappings
	for ERROR_NO_MEDIA_IN_DRIVE, ERROR_DEVICE_REQUIRES_CLEANING and
	ERROR_DEVICE_DOOR_OPEN.
	* fhandler.h (class fhandler_dev_raw): Drop varblkop member.
	(fhandler_dev_raw::is_eom): De-virtualize.
	(fhandler_dev_raw::is_eof): Ditto.
	(class fhandler_dev_tape): Drop lasterr and dp member.  Add mt_mtx
	member.  Drop all private methods formerly used by ioctl.
	(fhandler_dev_tape::is_rewind_device): Use get_minor for clarity.
	(fhandler_dev_tape::driveno): New method.
	(fhandler_dev_tape::drive_init): New method.
	(fhandler_dev_tape::clear): Remove method.
	(fhandler_dev_tape::is_eom): Ditto.
	(fhandler_dev_tape::is_eof): Ditto.
	(fhandler_dev_tape::write_file): Ditto.
	(fhandler_dev_tape::read_file): Ditto.
	(fhandler_dev_tape::_lock): New method.
	(fhandler_dev_tape::unlock): New method.
	(fhandler_dev_tape::raw_read): New method.
	(fhandler_dev_tape::raw_write): New method.
	* fhandler_raw.cc (fhandler_dev_raw::is_eom): New method.
	(fhandler_dev_raw::is_eof): New method.
	(fhandler_dev_raw::open): Allow setting write through option by
	using the O_TEXT flag as ... flag.
	(fhandler_dev_raw::writebuf): Remove usage of varblkop and other
	tape specific code.
	(fhandler_dev_raw::raw_read): Ditto.
	(fhandler_dev_raw::dup): Ditto.
	* fhandler_tape.cc: Rewrite tape operations entirely.  Implement
	new tape driver classes mtinfo, mtinfo_drive and mtinfo_part.
	Reduce fhandler_dev_tape methods to mostly just calling appropriate
	mtinfo_drive methods.
	(mtinfo_init): New function adding the mtinfo shared memory area.
	* mtinfo.h: New file, containing the definition of the new tape
	driver classes.
	* shared.cc: Include mtinfo.h.
	(offsets): Add entry for mtinfo shared memory area.
	(memory_init): Call mtinfo_init.
	* shared_info.h (shared_locations): Add SH_MTINFO shared location.
	* include/cygwin/mtio.h: Change and add various comments.  Add GMT_xxx
	macros for new generic flags.  Add MT_ST_xxx bitfield definitions
	for MTSETDRVBUFFER ioctl.
	* include/cygwin/version.h: Bump API minor version number.
@
text
@d243 1
d249 1
a249 1
#define CYGWIN_VERSION_API_MINOR 113
@


1.162
log
@* include/cygwin/version.h: Bump DLL minor number to 10.
@
text
@d241 2
d248 1
a248 1
#define CYGWIN_VERSION_API_MINOR 112
@


1.161
log
@* include/cygwin/version.h: Bump DLL minor number to 9.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 9
@


1.160
log
@	Fix ChangeLog dates.

	* fhandler.h (fhandler_dev_tape::tape_get_pos): Declare with extra
	parameter for partition number.
	(fhandler_dev_tape::_tape_set_pos): Ditto.
	(fhandler_dev_tape::tape_partition): New method.
	(fhandler_dev_tape::tape_set_partition): New method.
	* fhandler_tape.cc (fhandler_dev_tape::open): Call private methods
	directly instead of ioctl.
	(fhandler_dev_tape::ioctl): Use long erase on MTERASE by default.
	Don't use absolute positioning on MTSEEK.  Call tape_set_partition
	on MTSETPART, tape_partition on MTMKPART.
	(fhandler_dev_tape::tape_get_pos): Add partition number parameter.
	Prefer logical position information over absolute position information.
	Return partition number.
	(fhandler_dev_tape::_tape_set_pos): Add partition number parameter.
	Use in SetTapePosition.
	(fhandler_dev_tape::tape_set_pos): Remove special TAPE_ABSOLUTE_BLOCK
	handling.
	(fhandler_dev_tape::tape_erase): Rewind before erasing.
	(fhandler_dev_tape::tape_status): Rearrange slightly. Try to get a
	MediaType even if no tape is loaded. Store active partition in
	mt_resid as on Linux.
	(fhandler_dev_tape::tape_partition): New method.
	(fhandler_dev_tape::tape_set_partition): New method.
	* include/cygwin/mtio.h: Fix copyright. Add comment to explain
	mt_resid content.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 8
@


1.159
log
@* exceptions.cc (setup_handler): Signal event for any sigwaitinfo if it exists
to force signal to be handled.  Zero event here to prevent races.
* signal.cc (sigwaitinfo): Use local handle value for everything since signal
thread could zero event element at any time.  Detect when awaking due to thread
not in mask and set return value and errno accordingly.  Don't set signal
number to zero unless we've recognized the signal.
* sigproc.cc (sigq): Rename from sigqueue throughout.
* thread.cc (pthread::join): Handle signals received while waiting for thread
to terminate.
* cygwin.din: Export sighold, sigqueue.
* exceptions.cc (sighold): Define new function.
* signal.cc (handle_sigprocmask): Set correct errno for invalid signal.
Simplify debugging output.
(sigqueue): Define new function.
* include/cygwin/signal.h (sighold): Declare new function.
(sigqueue): Ditto.
* include/cygwin/version.h: Bump API minor version number.
* include/limits.h (TIMER_MAX): Define.
(_POSIX_TIMER_MAX): Ditto.
@
text
@d240 1
d246 1
a246 1
#define CYGWIN_VERSION_API_MINOR 111
@


1.158
log
@* cygwin.din: Make many more functions SIGFE.
* include/cygwin/version.h (CYGWIN_VERSION_SHARED_DATA): Bump.
@
text
@d239 1
d245 1
a245 1
#define CYGWIN_VERSION_API_MINOR 110
@


1.157
log
@change comment.
@
text
@d3 1
a3 1
   Copyright 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003 Red Hat, Inc.
d250 3
a252 1
	version was 0 (cygwin release 98r2). */
d254 1
a254 1
#define CYGWIN_VERSION_SHARED_DATA 3
@


1.156
log
@* dcrt0.cc (reent_data): Make global.
* cygwin.din: Reexport reent_data.
@
text
@d236 2
a237 1
      109: Export clock_gettime, sigwaitinfo, timer_create, timer_delete,
a238 1
      110: Oh well.  Someone uses reent_data.
@


1.155
log
@* include/cygwin/version.h: Bump DLL minor number to 8.
* cygmalloc.h: Make more concessions to attempts to get debugging malloc
working.
* debug.h: Ditto.
* dlmalloc.cc: Ditto.
* dlmalloc.h: Ditto.
* malloc_wrapper.cc: Ditto.
* perthread.h (perthread::create): Use calloc to ensure zeroed memory.
@
text
@d238 1
d244 1
a244 1
#define CYGWIN_VERSION_API_MINOR 109
@


1.154
log
@* sigproc.cc (sigproc_terminate): Don't close sendsig handle when execing since
we're not closing what we think we're closing.
(sig_send): Improve debugging when exiting due to no_signals_available.
* wincap.h (wincaps::cant_debug_dll_entry): New element.
* wincap.cc: Implement above element throughout.
* dcrt0.cc (initial_env): Accommodate changes necessary to allow initial
debugging for systems which do not allow debugging in dll_entry.
(dll_crt0_0): Add initial_env call back here.
* Makefile.in (install-man): Use mandir as target for installation.
* include/cygwin/version.h: Bump DLL minor number to 7 (should have been done
earlier).
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 7
@


1.153
log
@* cygwin/include/signal.h: Add copyright notice.
* cygwin.din: Make clock SIGFE.  Add clock_gettime, sigwaitinfo, timer_create,
timer_delete, timer_settime.
* include/cygwin/version.h: Reflect above additions.
* fork.cc (fork_child): Call fixup_timers_after_fork.
* signal.cc (sigwait): Remove unused variable.
* timer.cc: New file.
(clock_gettime): Define new function.
(timer_tracker): Define new struct used by timer functions.
(timer_tracker::timer_tracker): New function.
(to_us): New function.
(timer_thread): New function.
(timer_tracker::settime): New function.
(timer_create): New function.
(timer_settime): New function.
(timer_delete): New function.
(fixup_timers_after_fork): New function.
* cygthread.cc: Bump thread count.
* signal.cc (sigwaitinfo): Define new function.
(sigwait): Redefine based on sigwaitinfo.
* include/cygwin/signal.h (sigwaitinfo): Declare.
(sigwait): Ditto.
* dtable.cc (dtable::vfork_parent_restore): Avoid double close of ctty when
ctty == ctty_on_hold.
* cygtls.h (_threadinfo::threadkill): New element.
(_threadinfo::set_threadkill): Declare new function.
(_threadinfo::reset_threadkill): Declare new function.
* dcrt0.cc (dcrt0_1): Call here so that it will be possible to attach to
running process with #(*& Windows Me/9x.
(initial_env): Try to initialize strace if uninitialized.
* gendef: Don't zero signal if threadkill is set since that will happen in the
called function.
* signal.cc (sigwait): Ensure cleanup in error conditions.
* sigproc.cc (sig_send): Clear packet mask storage.
(wait_subproc): Fill in child exit code in siginfo_t structure.
* thread.cc (pthread_kill): Set threadkill flag.
* tlsoffsets.h: Regenerate.  Throughout, use siginfo_t to fill out all signal
information for "kernel" signals.
* cygtls.h (_threadinfo::set_siginfo): Declare new function.
* cygtls.cc (_threadinfo::set_siginfo): Define new function.
* dcrt0.cc (do_exit): Accommodate siginfo_t considerations.
* exceptions.cc (handle_exceptions): Ditto.
(sig_handle_tty_stop): Ditto.
(ctrl_c_handler): Use killsys() to send signal.
(sigpacket::process): Rename from sig_handle.  Use siginfo_t field from
sigpacket for everything.
(tty_min::kill_pgrp): Accommodate siginfo_t considerations.
(fhandler_termios::bg_check): Ditto.
* fhandler_tty.cc (fhandler_tty_slave::ioctl): Use killsys() to send signal.
* signal.cc (kill_worker): Rewrite to use siginfo_t second argument.
(kill_pgrp): Ditto.
(kill0): Define new function pulled from kill().
(kill): Rewrite as frontend to kill0.
(killsys): Define new function.
* sigproc.cc (sigelem): Eliminate.
(sigpacket): Move to sigproc.h.  Subsume sigelem.
(pending_signals): Use sigpacket rather than sigelem for everything.
(sig_clear): Ditto.
(wait_sig): Ditto.
(sig_send): Rewrite to use siginfo_t argument.
(sig_send): New function wratpper to sig_send with siginfo_t argument.
(wait_subproc): Accommodate siginfo_t considerations.
* thread.cc (pthread_kill): Ditto.
* sigproc.h (sigpacket): Move here.
(sigpacket::process): Declare "new" function.
(sig_handle): Eliminate declaration.
(sig_send): Declare with new paramaters.
(killsys): Declare new function.
(kill_pgrp): Declare.
* winsup.h: Move some signal-specific stuff to sigproc.h.
* include/cygwin/signal.h: Tweak some siginfo_t stuff.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 6
@


1.152
log
@* cygheap.h (init_cygheap): Play more vfork shell games and move ctty_on_hold
and open_fhs_on_hold (back) here.
* dcrt0.cc (_dll_crt0): Just set impure_ptr_ptr here and let later
initialization deal with tls.
* dtable.cc (dtable::vfork_child_fixup): Move ctty considerations here.
(dtable:vfork_parent_restore): And here.
* fork.cc (vfork): Reflect change to ctty handling.
* perthread.h (vfork_save::fhctty): Eliminate.
* cygwin.din: Make more exports NOSIGFE that will never be interrupted by a
signal.
* init.cc (dll_entry): Set stackptr to NULL to catch problems earlier.
@
text
@d236 2
d243 1
a243 1
#define CYGWIN_VERSION_API_MINOR 108
@


1.152.6.1
log
@* dcrt0.cc (reent_data): Make global.
* cygwin.din: Reexport reent_data.
* cygtls.cc (_threadinfo::remove): Don't assume that we are removing _my_tls.
* exceptions.cc (setup_handler): Improve debugging output.
(call_signal_handler_now): Remove ill-advised debugger call.
* sigproc.cc (sigcomplete_main): Delete.
(sig_send): Honor FIXME and avoid using main thread's completion event for
everything or suffer races.
(pending_signals::add): Default stored mask to current process mask rather than
mask at time of signal send.
(wait_sig): Add debugging output.
* sigproc.h (sigpacket::mask_storage): Delete.
* fhandler.cc (fhandler_base::open): Revert isfs change.
@
text
@a235 1
      109: Oh well.  Someone uses reent_data.
d241 1
a241 1
#define CYGWIN_VERSION_API_MINOR 109
@


1.152.6.2
log
@oops
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 7
@


1.152.2.1
log
@* cygwin/include/signal.h: Add copyright notice.
* cygwin.din: Make clock SIGFE.  Add clock_gettime, sigwaitinfo, timer_create,
timer_delete, timer_settime.
* include/cygwin/version.h: Reflect above additions.
* fork.cc (fork_child): Call fixup_timers_after_fork.
* signal.cc (sigwait): Remove unused variable.
* timer.cc: New file.
(clock_gettime): Define new function.
(timer_tracker): Define new struct used by timer functions.
(timer_tracker::timer_tracker): New function.
(to_us): New function.
(timer_thread): New function.
(timer_tracker::settime): New function.
(timer_create): New function.
(timer_settime): New function.
(timer_delete): New function.
(fixup_timers_after_fork): New function.
* cygthread.cc: Bump thread count.
@
text
@a235 2
      109: Export clock_gettime, sigwaitinfo, timer_create, timer_delete,
           timer_settime
d241 1
a241 1
#define CYGWIN_VERSION_API_MINOR 109
@


1.152.2.2
log
@* include/cygwin/version.h: Bump DLL minor number to 7 (should have been done
earlier).
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 7
@


1.151
log
@* cygwin.din: Make crt0 functions NOSIGFE.
* include/cygwin/version.h: Gratuitous comment change.
* lib/_cygwin_crt0_common.cc: Remove unneeded declaration.
@
text
@d37 2
a38 2
   In October 1998 (starting with Cygwin 19.6), we started a new
   means of Cygwin versioning: */
@


1.150
log
@* exceptions.cc (set_signal_mask): Redefine to not pass by address.  Report
calculated mask in debugging output.
* sigproc.h (set_signal_mask): Reflect above change in declaration.
* path.cc (mount_item::build_win32): Take path apart before feeding it to
fnmunge.  Throughout, change use of _reent_winsup()-> to _my_tls.locals.
instead.  Throughout, remove obsolete MT_SAFE/_CYG_THREAD_FAILSAFE
considerations.  Througout, add cygtls.h include.
* Makefile.in (DLL_OFILES): Add cygtls.o.  Add some more objects to the
-fomit-frame-pointer list.
* acconfig.h: Remove obsolete settings.
* config.h.in: Ditto.
* bsdlib.cc: Add cygtls.h include.
* configure.in: Remove --enable-extra-threadsafe-checking.
* configure: Regenerate.
* cygtls.h (_local_storage): New struct renamed from _winsup_t (sic).
(_threadinfo:local_clib): Add new field.
(_threadinfo::locals): Ditto.
(_threadinfo::init_thread): Accept second _reent * argument.
(_threadinfo::call): Define as regparm.
(CYGTLS_PADSIZE): Remove unnecessary slop.
(_getreent): Define as a macro.
* thread.h: Remove _CYG_THREAD_FAILSAFE and MT_SAFE stuff.
(_winsup_t): Move to cygtls.h.
(ResourceLocks::ResourceLocks): Eliminate empty constructor.
(MTinterface::reents): Eliminate.
(MTinterface::thread_self_key): Eliminate.
(MTinterface::MTinterface): Eliminate.
* dcrt0.cc: Include stdio.h for _impure_ptr initialization.
(do_global_ctors): Remove run_ctors_p (sic) considerations.  Don't call atexit
here.
(__main): Initialize destructors for user here.
(dll_crt0_1): Accept a dummy argument.  Don't call init_thread here.  Don't set
_impure_ptr here.  Call do_global_ctors after more things have been
initialized.
(_dll_crt0): Define zeros buffer as max of needed size of CYGTLS_PADSIZE so
that it can be used for two purposes while minimizing stack usage.  Initialize
_impure_ptr specifically, for speed.  Call dll_crt0_1 with buffer argument.
(cygwin_dll_init): Call dll_crt0_1 with dummy argument.
* dtable.cc (dtable::find_unused_handle): Remove call to AssertResourceOwner.
* exceptions.cc: Move _threadinfo stuff to new file.
* cygtls.cc: New file.
* gentls_offsets: Accommodate increasing complexity of cygtls.h.
* hires.h (hires_base::~hires_base): Remove.
* init.cc (dll_entry): Remove setting of reents.
* thread.cc: Remove syslog.h include.
(__getreent): Simplify to use _my_tls.
(_reent_winsup): Delete.
(AssertResourceOwner): Delete.
(MTinterface::Init): Remove setting of _clib and _winsup, with all that
entails.
(MTinterface::fixup_after_fork): Ditto.
(pthread::thread_init_wrapper): Ditto.  Also remove call to
set_tls_self_pointer.
(pthread::set_tls_self_pointer): Eliminate.
(pthread::get_tls_self_pointer): Just return _my_tls.tid;
(__reent_t::init_clib): Eliminate.
* tlsoffsets.h: Regenerate.
@
text
@d41 1
a41 1
	 the Cygwin library".  This version is used to track important
@


1.149
log
@	* Makefile.in (OBSOLETE_FUNCTIONS): Add fcntl.
	(NEW_FUNCTIONS): Add fcntl64.
	* cygwin.din: Export fcntl64.  Make fcntl being SIGFE.
	* fcntl.cc (fcntl_worker): New function.
	(fcntl64): New function.
	(_fcntl): Call fcntl_worker.  Convert 32 bit flock structure into
	64 bit flock structure and vice versa.
	* fhandler.cc (fhandler_base::lock): Change 2nd parameter to
	struct __flock64 *.
	* fhandler_disk_file.cc (fhandler_disk_file::lock): Ditto.  Rework
	to be 64 bit aware.
	* fhandler.h: Accomodate above method argument changes.
	* include/cygwin/types.h: Add struct __flock32 and __flock64.
	Define struct flock according to setting of __CYGWIN_USE_BIG_TYPES__.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d235 1
d241 1
a241 1
#define CYGWIN_VERSION_API_MINOR 107
@


1.148
log
@	* Makefile.in: (DLL_OFILES): Add flock.o.
	* cygwin.din: Export flock.
	* flock.c: New file.
	* include/sys/file.h: Include sys/cdefs.h.
	Add function prototype for flock().
	Add some comments from BSD's header for further clarity.
	(L_SET, L_CURR, L_INCR, L_XTND): Redefine as the macros
	SEEK_SET, SEEK_CUR, SEEK_CUR, & SEEK_END respectively.
	(LOCK_SH,LOCK_EX,LOCK_NB,LOCK_UN): New macros for flock().
	* include/cygwin/version.h: Bump API minor number.
@
text
@d234 1
d240 1
a240 1
#define CYGWIN_VERSION_API_MINOR 106
@


1.147
log
@Eliminate use of sigframe and sigthread throughout.
* Makefile.in (DLL_OFILES): Add sigfe.o.  Remove reliance on cygwin.def from
cygwin0.dll dependency since dependence on sigfe.o implies that.  Generate def
file on the fly using 'gendef'.
* configure.in: Don't auto-generate cygwin.def.
* configure: Regenerate.
* cygwin.din: Add SIGFE stuff where appropriate.
* dcrt0.cc (dll_crt0_1): Initialize cygwin tls early in process startup.  Set
_main_tls to address of the main thread's cygwin tls.
* debug.h: Remove now unneeded WFSO and WFMO declarations.
* exceptions.cc (_last_thread): Define.
(set_thread_state_for_signals): New function.
(reset_thread_exception_for_signals): Ditto.
(init_thread_for_signals): Ditto.
(delete_thread_for_signals): Ditto.
(capture_thread_for_signals): Ditto.
(handle_exceptions): Set return address explicitly for exceptions prior to
calling sig_send.
(interrupt_on_return): Eliminate.
(setup_handler): Add preliminary implementation for dealing with
thread-specific signals by querying _main_tls.
(signal_exit): Use cygthread::main_thread_id instead of mainthread.id.
(call_signal_handler_now): For now, just handle the main thread.
* fork.cc (vfork): Save and restore main _my_tls.
* gendef: New file.  Generates def file and sigfe.s file.
* gentls_offsets: New file.  Generates offsets for perl to use in sigfe.s.
* how-signals-work.txt: Mention that info is obsolete.
* init.cc (dll_entry): Initialize cygwin tls storage here.
* miscfuncs.cc (low_priority_sleep): Make a C function for easier calling from
asm.
* perthread.h (vfork_save::tls): New element.
* signal.cc (nanosleep): Replace previous use of
sigframe.call_signal_handler_now with straight call to call_signal_handler_now.
(abort): Ditto.
* syscalls.cc (readv): Ditto.
* termios.cc (tcsetattr): Ditto.
* wait.cc (wait4): Ditto.
* sigproc.cc (sig_dispatch_pending): Ditto.
(sig_send): Ditto.
* sigproc.h: Declare call_signal_handler_now.
* thread.cc (pthread::thread_init_wrapper): Initialize cygwin tls.  Remove
obsolete and unworking signal stuff.
* thread.h (verifyable_object::sigs): Eliminate.
(verifyable_object::sigmask): Eliminate.
(verifyable_object::sigtodo): Eliminate.
(verifyable_object::exit): Make attribute noreturn.
(verifyable_object::thread_init_wrapper): Ditto.
(pthread_null::exit): Ditto.
* winbase.h (__stackbase): Always define.
* winsup.h (low_priority_sleep): Declare as a "C" function.
* include/cygwin/version.h: Bump API version to reflect sigwait export.
* include/sys/queue.h: Protect SLIST_ENTRY from previous declaration.
* signal.cc (sigwait): Implement.
* select.cc (fhandler_base::ready_for_read): Add debugging output.
* devices.h: Define more device pointers via their storage.
* devices.in: Don't parse things like /dev/inet/tcp, as they really have no
meaning.
* devices.cc: Regenerate.
* gendevices: Set proper protection for output file.
* cygtls.h: New file.
* gendef: New file.
* gentls_offsets: New file.
* tlsoffsets.h: New file.  Autogenerated.
* config/i386/longjmp.c: Remove.  File subsumed by gendef output.
* config/i386/makefrag: Remove obsolete file.
* fhandler.cc: Remove spurious access_worker declaration.
* spawn.cc (spawnve): Make debugging output more accurate.
* cygwin-gperf: Remove.
* devices.cc: Remove.
@
text
@d233 1
d239 1
a239 1
#define CYGWIN_VERSION_API_MINOR 105
@


1.146
log
@	* cygserver.h (client_request::request_code_t): Add
	CYGSERVER_REQUEST_MSG and CYGSERVER_REQUEST_SEM.
	(admininstrator_group_sid): Add extern declaration.
	* cygserver_ipc.h: Rewrite.
	* cygserver_msg.h: New file.
	* cygserver_sem.h: New file.
	* cygserver_shm.h: More or less rewrite.
	* cygwin.din: Add msgctl, msgget, msgrcv, msgsnd, semctl, semget and
	semop.
	* msg.cc: Rewrite.
	* safe_memory.h: Remove.
	* sem.cc: Rewrite.
	* shm.cc: Rewrite.
	* include/cygwin/ipc.h: Use appropriate guard.
	(struct ipc_perm): Add seq.
	(IPCID_TO_IX): New define from BSD.
	(IPCID_TO_SEQ): Ditto.
	(IXSEQ_TO_IPCID): Ditto.
	(IPC_R): Ditto.
	(IPC_W): Ditto.
	(IPC_M): Ditto.
	* include/cygwin/msg.h: Use appropriate guard. #ifdef _KERNEL all stuff
	not explicitely defined by SUSv3. Use signed types in structs to match
	types used in BSD.
	(msgqnum_t): Define unsigned.
	(msglen_t): Ditto.
	(struct msqid_ds): Add msg_first and msg_last.
	(struct msginfo): Remove msgpool. Add msgssz and msgseg.
	* include/cygwin/sem.h: Use appropriate guard. #ifdef _KERNEL all stuff
	not explicitely defined by SUSv3. Use signed types in structs to match
	types used in BSD.
	(SEM_UNDO): Define appropriately.
	(struct semid_ds): Add sem_base.
	(struct seminfo): Add semmap and semusz.
	(SEM_A): New define from BSD.
	(SEM_R): Ditto.
	(SEM_ALLOC): Ditto.
	(union semun): Define.
	* include/cygwin/shm.h: Use appropriate guard. #ifdef _KERNEL all stuff
	not explicitely defined by SUSv3. Use signed types in structs to match
	types used in BSD.
	(SHMLBA): Define using cygwin_internal(CW_GET_SHMLBA) call.
	(struct shmid_ds): Add shm_internal.
	(struct shm_info): Rename shm_ids to used_ids as in BSD.  Add define
	for shm_ids.
	* include/cygwin/sysproto.h: New file.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/ipc.h: New file.
	* include/sys/msg.h: New file.
	* include/sys/queue.h: New file from BSD.
	* include/sys/sem.h: New file.
	* include/sys/shm.h: New file.
	* include/sys/sysproto.h: New file.
@
text
@d232 1
a232 1

d238 1
a238 1
#define CYGWIN_VERSION_API_MINOR 104
@


1.145
log
@	* bsdlib.cc (getprogname): New function.
	(setprogname): New funtion.
	* cygwin.din: Export getprogname and setprogname.
	* include/cygwin/version.h: Bumb API version number.
@
text
@d231 1
d238 1
a238 1
#define CYGWIN_VERSION_API_MINOR 103
@


1.144
log
@	* external.cc (cygwin_internal): Add CW_GET_UID_FROM_SID and
	CW_GET_GID_FROM_SID handling.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/cygwin.h (cygwin_getinfo_types): Add
	CW_GET_UID_FROM_SID and CW_GET_GID_FROM_SID.
@
text
@d230 1
d237 1
a237 1
#define CYGWIN_VERSION_API_MINOR 102
@


1.143
log
@	* bsdlib.cc (_vwarnx): New function.
	(vwarn): Ditto.
	(vwarnx): Ditto.
	(warn): Ditto.
	(warnx): Ditto.
	(verr): Ditto.
	(verrx): Ditto.
	(err): Ditto.
	(errx): Ditto.
	* cygwin.din: Export above functions.
	* include/err.h: New file.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d229 1
d236 1
a236 1
#define CYGWIN_VERSION_API_MINOR 101
@


1.142
log
@	* syscalls.cc (getshmlba): New function.
	* external.cc (cygwin_internal): Add CW_GET_SHMLBA handling.
	* mmap.cc (mmap64): Call getshmlba to evaluate granularity.
	* winsup.h (getshmlba): Add declaration.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/cygwin.h (cygwin_getinfo_types): Add CW_GET_SHMLBA.
@
text
@d228 1
d235 1
a235 1
#define CYGWIN_VERSION_API_MINOR 100
@


1.141
log
@	* external.cc (cygwin_internal): Add CW_GET_POSIX_SECURITY_ATTRIBUTE
	handling.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/cygwin.h (cygwin_getinfo_types): Add
	CW_GET_POSIX_SECURITY_ATTRIBUTE.

	* exceptions.cc (init_global_security): Move from here...
	* sec_helper.cc (init_global_security): ...to here.
@
text
@d227 1
d234 1
a234 1
#define CYGWIN_VERSION_API_MINOR 99
@


1.140
log
@	* Makefile.in (OBSOLETE_FUNCTION):  Add tmpfile.
	(NEW_FUNCTIONS): Add _tmpfile64 -> tmpfile translation.
	* cygwin.din: Export _tmpfile64
	* include/cygwin/version.h: Bump api minor number.
@
text
@d226 1
d233 1
a233 1
#define CYGWIN_VERSION_API_MINOR 98
@


1.139
log
@	* cygwin.din: Add sem_close, sem_getvalue, sem_open and sem_timedwait.
	* pthread.cc (+mangle_sem_name): New function.
	(sem_open): Ditto.
	(sem_close: Ditto.
	(sem_timedwait): Ditto.
	(sem_getvalue): Ditto.
	* thread.cc (semaphore::semaphore): Rearrange member initialization.
	Use appropriate security attribute for process shared semaphores.
	(semaphore::semaphore): New constructor for named semaphores.
	(semaphore::~semaphore): Care for semaphore name.
	(semaphore::_post): Accomodate failing ReleaseSemaphore. Use value
	returned by ReleaseSemaphore vor currentvalue.
	(semaphore::_getvalue): New method.
	(semaphore::_timedwait): Ditto.
	(semaphore::_fixup_after_fork): Rearrange. Don't fail for process
	shared semaphores.
	(semaphore::open): New method.
	(semaphore::timedwait): Ditto.
	(semaphore::post): Fix return value.  Set errno appropriately.
	(semaphore::getvalue): New method.
	* thread.h (class semaphore): Add prototypes for open, getvalue,
	timedwait, _getvalue, _timedwait.  Add prototypes for new constructor.
	Add name member.
	* include/semaphore.h: Add prototypes for sem_open, sem_close,
	sem_timedwait and sem_getvalue.
	include/cygwin/version.h: Bump API minor number.
@
text
@d225 1
d232 1
a232 1
#define CYGWIN_VERSION_API_MINOR 97
@


1.138
log
@	* external.cc (cygwin_internal): Add CW_GET_ERRNO_FROM_WINERROR
	handling.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/cygwin.h (cygwin_getinfo_types): Add
	CW_GET_ERRNO_FROM_WINERROR.
@
text
@d224 1
d231 1
a231 1
#define CYGWIN_VERSION_API_MINOR 96
@


1.137
log
@	* Makefile.in: Add $(LIBSERVER) rule.
	* cygserver.h: Moved from include/cygwin to here.
	* cygserver_ipc.h: Moved from ../cygserver to here.
	* cygserver_shm.h: Ditto.
	* cygwin.din: Add shmat, shmctl, shmdt and shmget.
	* fhandler_tty.cc (fhandler_tty_slave::open): Don't warn about handle
	dup'ing if not build with USE_SERVER.
	* shm.cc: Include cygerrno.h unconditionally.
	(shmat): Set errno to ENOSYS and return -1 if not build with
	USE_SERVER.
	(shmctl): Ditto.
	(shmdt): Ditto.
	(shmget): Ditto.
	* woutsup.h: Remove.
	* include/cygwin/cygserver_process.h: Moved to ../cygserver directory.
	* include/cygwin/cygserver_transport.h: Ditto.
	* include/cygwin/cygserver_transport_pipes.h: Ditto.
	* include/cygwin/cygserver_transport_sockets.h: Ditto.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d223 1
d230 1
a230 1
#define CYGWIN_VERSION_API_MINOR 95
@


1.136
log
@* include/cygwin/version.h: Bump DLL minor number to 6.
@
text
@d222 1
d229 1
a229 1
#define CYGWIN_VERSION_API_MINOR 94
@


1.135
log
@* Makefile.in: Make malloc_wrapper -fomit-frame-pointer.
* cygwin.din: Remove extraneous mallinfo definition.
* dcrt0.cc (quoted): Use strechr for efficiency.
* fhandler.cc (fhandler_base::write): Correctly use get_output_handle rather
than get_handle.
(fhandler_base::lseek): Use method for accessing name in debug output.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 5
@


1.134
log
@* include/cygwin/version.h: Bump DLL minor number to 5.
@
text
@d194 1
a194 1
           Export btowc and trunc.
d205 3
a207 3
           underscore.  No problems with backward compatibility since no
           official release has been made so far.  This change removes
           exported symbols like fopen64, which might confuse configure.
d221 1
a221 1
       	   optreset, __check_rhosts_file, __rcmd_errstr.
@


1.133
log
@	* Makefile.in (DLL_OFILES): Add getopt.o and iruserok.o.
	* cygwin.din: Export __check_rhosts_file, __rcmd_errstr, optarg,
	opterr, optind, optopt, optreset, getopt, getopt_long, iruserok
	and ruserok.
	* getopt.c: Moved from lib to here.  Define opt* variables as
	dllexport.
	* iruserok.c: Moved from lib to here.  Rearrange function order.
	Prefer using 64/32 bit functions.
	* syscalls.cc (shell_fp): Define as struct __sFILE64.
	(getusershell): Use fopen64 instead of fopen.
	* winsup.h: Add declarations for seteuid32, fopen64,
	cygwin_gethostbyname and cygwin_inet_addr.
	* include/getopt.h: Declare opt* variables dllimport.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 4
@


1.133.2.1
log
@* include/cygwin/version.h: Bump DLL minor number to 5.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 5
@


1.132
log
@	* Makefile.in (DLL_OFILES): Add bsdlib.o.
	* autoload.cc (RegisterServiceProcess): Add.
	* bsdlib.cc: New file.
	(daemon): New function.
	(login_tty): Ditto.
	(openpty): Ditto.
	(forkpty): Ditto.
	* cygwin.din: Export daemon, forkpty, login_tty, logwtmp, updwtmp,
	openpty and revoke.
	* syscalls.cc (updwtmp): New function, writing to wtmp exclusively.
	(logwtmp): Ditto.
	(login): Call updwtmp instead of writing to wtmp by itself.
	(logout): Ditto.
	* tty.cc (revoke): New funtion.
	* include/paths.h: Define _PATH_DEVNULL.
	* include/pty.h: New header.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/utmp.h: Declare logwtmp with const arguments.
	Declare updwtmp.
	* lib/iruserok.c: New file.
	(ruserok): New function.
	(iruserok): Ditto.
	(__ivaliduser): Ditto.
	(__icheckhost): Ditto.
@
text
@d220 2
d228 1
a228 1
#define CYGWIN_VERSION_API_MINOR 93
@


1.131
log
@	* cygwin.din: Export endusershell, getusershell and setusershell.
	* syscalls.cc (getusershell): New function.
	(setusershell): Ditto.
	(endusershell): Ditto.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d217 3
a219 1
       92: Export getusershell, setusershell, eetusershell
d226 1
a226 1
#define CYGWIN_VERSION_API_MINOR 92
@


1.130
log
@	* cygwin.din: Export argz_add argz_add_sep argz_append argz_count
	argz_create argz_create_sep argz_delete argz_extract argz_insert
	argz_next argz_replace argz_stringify envz_add envz_entry envz_get
	envz_merge envz_remove envz_strip
	* include/cygwin/version.h: Bump api minor number.
@
text
@d214 4
a217 3
         argz_create_sep argz_delete argz_extract argz_insert
         argz_next argz_replace argz_stringify envz_add envz_entry
         envz_get envz_merge envz_remove envz_strip
d224 1
a224 1
#define CYGWIN_VERSION_API_MINOR 91
@


1.129
log
@* include/cygwin/version.h: Bump DLL minor number to 4.
@
text
@d213 5
d223 1
a223 1
#define CYGWIN_VERSION_API_MINOR 90
@


1.128
log
@Touch version.h to avoid build message.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 3
@


1.127
log
@* include/cygwin/version.h: Bump DLL minor number to 3.
@
text
@@


1.126
log
@* include/cygwin/version.h: Bump DLL minor number to 2.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 2
@


1.125
log
@* cygwin.din: Export _fdopen64
* Makefile.in (NEW_FUNCTIONS): Add _fdopen64 -> fdopen translation.
* include/cygwin/version.h: Bump api minor number.
* ntdll.h: Remove (now) duplicate FILE_SYNCHRONOUS_IO_NONALERT definition.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 1
@


1.124
log
@* environ.cc (check_case_init): Use strncasematch.
* cygwin.din: Export __mempcpy.
* cygwin/version.h: Bump api minor number.
@
text
@d212 1
d218 1
a218 1
#define CYGWIN_VERSION_API_MINOR 89
@


1.123
log
@* include/cygwin/version.h: Bump DLL minor number to 1.
@
text
@d211 1
d217 1
a217 1
#define CYGWIN_VERSION_API_MINOR 88
@


1.122
log
@* fhandler_proc.cc (format_proc_stat): Use correctly sized constants for
filling in zeros on 98.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 0
@


1.121
log
@* include/cygwin/version.h: Bump DLL minor number to 1.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 1
@


1.120
log
@Throughout, remove "include <errno.h>" from files which already include
cygerrno.h.
* include/cygwin/config.h (__DYNAMIC_REENT__): Define.
* include/cygwin/version.h: Bump API minor version.
* cygwin.din: Export __getreent
* cygerrno.h: Include errno.h.  Fix places where _impure_ptr is used directly
to store the errno value.
* debug.cc (__set_errno): Ditto.
* errno.cc: Remove _RRENT_ONLY define to get errno.cc compiled.
* signal.cc: Rename _reent_clib to _REENT throughout.
* thread.h (reent_clib): Remove prototype.
* thread.cc (reent_clib): Rename reent_clib to __getreent.  Return _impure_ptr
until MTinterface is initialized.
(reent_winsup): Fix a possible SEGV when _r == NULL.  Return NULL instead.
* MTinterface::fixup_after_fork: Switch reent back to _impure_ptr to keep
signal handling running when fork is called from a thread other than the
mainthread.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 0
@


1.119
log
@	* cygwin.din: Add vsyslog.
	* fhandler.cc (fhandler_base::write): Only make file sparse if the
	seeked area is >= 128K.
	* syslog.cc (vsyslog): New function, overtaking functionality from
	syslog.
	(syslog): Just call vsyslog.
	* include/cygwin/version.h: Bump API minor.
	* include/sys/syslog.h: Add vsyslog declaration.
@
text
@d210 1
d216 1
a216 1
#define CYGWIN_VERSION_API_MINOR 87
@


1.118
log
@	* winsup/cygwin/include/cygwin/version.h: Bump API minor version.
	* winsup/cygwin/include/cygwin/types.h: Define key_t as long long.
	* winsup/cygwin/cygwin.din: Add ftok, _ftok.
	* winsup/cygwin/ipc.cc (ftok): Rework implementation.
@
text
@d209 1
d215 1
a215 1
#define CYGWIN_VERSION_API_MINOR 86
@


1.117
log
@	* Makefile.in (NEW_FUNCTIONS): All 32/64 from 0.79 API get
	leading underscore.
	* cygwin.din: Ditto.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d208 1
d214 1
a214 1
#define CYGWIN_VERSION_API_MINOR 85
@


1.116
log
@* include/cygwin/version.h: Bump DLL major number to 5.  Change DLL minor
number to 0.  Bump API minor number.
@
text
@d204 4
d213 1
a213 1
#define CYGWIN_VERSION_API_MINOR 84
@


1.115
log
@* termios.cc (setspeed): New function.
(cfsetospeed): Use setspeed to set speed.
(cfsetispeed): Use setspeed to set speed.
* autoload.cc: Add load statement for UuidCreate, and UuidCreateSequential.
* cpuid.h: New file.
* cygwin.din: Export gethostid.
* fhandler_proc.cc (cpuid): Move to cpuid.h.
(can_set_flag): Move to cpuid.h.
* syscalls.cc (gethostid): New function.
* version.h: Bump DLL minor version number to 83.
@
text
@d44 2
a45 2
#define CYGWIN_VERSION_DLL_MAJOR 1003
#define CYGWIN_VERSION_DLL_MINOR 23
d203 1
d209 1
a209 1
#define CYGWIN_VERSION_API_MINOR 83
@


1.114
log
@	* cygwin.din: Export wcscoll, wcswidth and wcwidth.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d202 1
d208 1
a208 1
#define CYGWIN_VERSION_API_MINOR 82
@


1.113
log
@	ChangeLog already commited yesterday:

	* external.cc (check_ntsec): New function.
	(cygwin_internal): Add CW_CHECK_NTSEC handling to call check_ntsec()
	from applications.
	* include/cygwin/version.h: Bump API minor number.
	* include/sys/cygwin.h (cygwin_getinfo_types): Add CW_CHECK_NTSEC.
@
text
@d201 1
d207 1
a207 1
#define CYGWIN_VERSION_API_MINOR 81
@


1.112
log
@	* include/cygwin/version.h (CYGWIN_VERSION_CHECK_FOR_USING_BIG_TYPES):
	Define.
	* glob.c (g_lstat): Use CYGWIN_VERSION_CHECK_FOR_USING_BIG_TYPES
	instead of numerical constants.
	(g_stat): Ditto.
@
text
@d200 1
d206 1
a206 1
#define CYGWIN_VERSION_API_MINOR 80
@


1.111
log
@
* cygwin.din: Add pthread_rwlock_destroy, pthread_rwlock_init,
pthread_rwlock_rdlock, pthread_rwlock_tryrdlock,
pthread_rwlock_wrlock, pthread_rwlock_trywrlock,
pthread_rwlock_unlock, pthread_rwlockattr_init,
pthread_rwlockattr_getpshared, pthread_rwlockattr_setpshared,
and pthread_rwlockattr_destroy.
* include/cygwin/version.h: Bump API minor number.
* include/pthread.h (PTHREAD_RWLOCK_INITIALIZER): Define a
reasonable value.
Add prototypes for pthread_rwlock_destroy, pthread_rwlock_init,
pthread_rwlock_rdlock, pthread_rwlock_tryrdlock,
pthread_rwlock_wrlock, pthread_rwlock_trywrlock,
pthread_rwlock_unlock, pthread_rwlockattr_init,
pthread_rwlockattr_getpshared, pthread_rwlockattr_setpshared,
and pthread_rwlockattr_destroy.
* thread.h (PTHREAD_ONCE_MAGIC): Remove superflous semicolon.
(PTHREAD_RWLOCK_MAGIC): New define.
(PTHREAD_RWLOCKATTR_MAGIC): Ditto.
(pthread_rwlockattr): New class.
(pthread_rwlock): Ditto.
(MTinterface::rwlocks): New member.
(MTinterface::MTinterface): Initialize rwlocks.
Add prototypes for __pthread_rwlock_destroy,
__pthread_rwlock_wrlock, __pthread_rwlock_trywrlock,
__pthread_rwlock_unlock, __pthread_rwlockattr_init,
__pthread_rwlockattr_getpshared, __pthread_rwlockattr_setpshared,
and __pthread_rwlockattr_destroy.
* thread.cc (MTinterface::Init): Initialize rwlock internal mutex.
(MTinterface::fixup_after_fork): Fixup rwlocks after fork.
(pthread_rwlockattr::isGoodObject): Implement.
(pthread_rwlockattr::pthread_rwlockattr): Ditto.
(pthread_rwlockattr::~pthread_rwlockattr): Ditto.
(pthread_rwlock::initMutex): Ditto.
(pthread_rwlock::pthread_rwlock): Ditto.
(pthread_rwlock::~pthread_rwlock): Ditto.
(pthread_rwlock::RdLock): Ditto.
(pthread_rwlock::TryRdLock): Ditto.
(pthread_rwlock::WrLock): Ditto.
(pthread_rwlock::TryWrLock): Ditto.
(pthread_rwlock::UnLock): Ditto.
(pthread_rwlock::addReader): Ditto.
(pthread_rwlock::removeReader): Ditto.
(pthread_rwlock::lookupReader): Ditto.
(pthread_rwlock::RdLockCleanup): Ditto.
(pthread_rwlock::WrLockCleanup): Ditto.
(pthread_rwlock::fixup_after_fork): Ditto.
(pthread_rwlock::isGoodObject): Ditto.
(pthread_rwlock::isGoodInitializer): Ditto.
(pthread_rwlock::isGoodInitializerOrObject): Ditto.
(pthread_rwlock::isGoodInitializerOrBadObject): Ditto.
(__pthread_rwlock_destroy): Ditto.
(pthread_rwlock::init): Ditto.
(__pthread_rwlock_rdlock): Ditto.
(__pthread_rwlock_tryrdlock): Ditto.
(__pthread_rwlock_wrlock): Ditto.
(__pthread_rwlock_trywrlock): Ditto.
@
text
@d87 4
@


1.110
log
@* include/cygwin/version.h: Reorganize last two api versions so that btowc and
trunc exports show up before previous bump since there has been no exported
version of the DLL with the 64 bit changes yet but 1.3.22 will have the btowc
and trunc.
@
text
@d195 1
d201 1
a201 1
#define CYGWIN_VERSION_API_MINOR 79
@


1.109
log
@* cygwin.din: Export btowc, trunc.
* include/cygwin/version.h: Reflect new exports.
* syscalls.cc (_stat): Rename to stat to avoid newlib wrapper.
* syscalls.cc (_fstat): Ditto.
* fhandler_console.cc (fhandler_console::close): Correct check for current tty.
Add debugging output when console is freed.
(set_console_state_for_spawn): Add debugging output.
* fhandler_tty.cc (fhandler_tty_slave::open): Don't decrement console open flag
when vforking.
* sigproc.cc (sigproc_terminate): Fix debugging output.
* spawn.cc (handle): Eliminate second argument.
(spawn_guts): Reflect elimination of argument change to handle.
* syscalls.cc (setsid): Add debugging output when console is freed.
* syscalls.cc (rename): Revert assumption that DELETE_ON_CLOSE works on Win9x.
@
text
@d189 3
a191 1
       78: Export acl32 aclcheck32 aclfrommode32 aclfrompbits32 aclfromtext32
a194 2
       79: Use stat and fstat rather than _stat, and _fstat.
           Export btowc and trunc
@


1.108
log
@* include/cygwin/version.h: Bump DLL minor number to 23.
@
text
@d193 2
a194 1

d200 1
a200 1
#define CYGWIN_VERSION_API_MINOR 78
@


1.107
log
@	Switch to 32/64 datatypes:
	* Makefile.in (OBSOLETE_FUNCTIONS): Add open acl aclcheck aclfrommode
	aclfrompbits aclfromtext aclsort acltomode acltopbits acltotext chown
	facl fchown fgetpos fopen freopen fseeko fsetpos fstat ftello
	ftruncate getegid geteuid getgid getgrent getgrgid getgrnam getgroups
	getpwuid getpwuid_r getuid initgroups lchown lseek lstat mknod mmap
	seekdir setegid seteuid setgid setgroups setregid setreuid setuid stat
	telldir truncate.
	(NEW_FUNCTIONS): Add _open64 acl32 aclcheck32 aclfrommode32
	aclfrompbits32 aclfromtext32 aclsort32 acltomode32 acltopbits32
	acltotext32 chown32 facl32 fchown32 fgetpos64 fopen64 freopen64
	fseeko64 fsetpos64 fstat64 ftello64 ftruncate64 getegid32 geteuid32
	getgid32 getgrent32 getgrgid32 getgrnam32 getgroups32 getpwuid32
	getpwuid_r32 getuid32 initgroups32 lchown32 lseek64 lstat64 mknod32
	mmap64 seekdir64 setegid32 seteuid32 setgid32 setgroups32 setregid32
	setreuid32 setuid32 stat64 telldir64 truncate64 to substitute the
	above.
	* cygserver_shm.h (class client_request_shm): Change uid_t and gid_t
	members to __uid32_t and __gid32_t.
	* cygwin.din: Add symbols acl32 aclcheck32 aclfrommode32
	aclfrompbits32 aclfromtext32 aclsort32 acltomode32 acltopbits32
	acltotext32 facl32 fgetpos64 fopen64 freopen64 fseeko64 fsetpos64
	_fstat64 ftello64 _lseek64 mknod32 _open64.
	* glob.c: Include perprocess.h.
	(globtilde): Call getpwuid32 and getuid32 instead of getpwuid and
	getuid.
	(g_lstat): Check for applications API version to call the appropriate
	typed gl_lstat function.
	(g_stat): Ditto for gl_stat.
	* shm.cc (client_request_shm::client_request_shm): Call geteuid32
	and getegid32 instead of geteuid and getegid throughout.
	* syscalls.cc (_open64): New alias for open.
	(_lseek64): New alias for lseek64.
	(_fstat64): New alias for fseek64.
	(mknod32): New function.
	(mknod): Calls mknod32 now.
	* winsup.h: Make function declarations for getuid32, geteuid32,
	and getpwuid32 accessible for plain C sources.  Add declarations
	for getegid32 and getpwnam.
	* include/cygwin/version.h: Bum API minor number to 78.
	* include/sys/cygwin.h: Guard C++ specific members of struct
	per_process against inclusion in plain C sources.
	* include/sys/mman.h (mman): Add guard to avoid type clash when
	compiling Cygwin.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 22
@


1.106
log
@* include/cygwin/version.h: Bump DLL minor number to 21.
@
text
@d189 5
d199 1
a199 1
#define CYGWIN_VERSION_API_MINOR 77
@


1.105
log
@* cygwin.din: Wrap atexit and exit with cygwin, thread-safe functions.
* dcrt0.cc (cygwin_atexit): New function.
(cygwin_exit): Ditto.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 21
@


1.105.2.1
log
@* include/cygwin/version.h: Bump DLL minor number to 22.
* autoload.cc (IsProcessorFeaturePresent): Add.
* fhandler_proc.cc (format_proc_cpuinfo): Add case for 9x systems.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 22
@


1.105.2.2
log
@Actually bump API number.
@
text
@a188 2
       78: Use stat and fstat rather than _stat, and _fstat.
	   Export btowc and trunc.
d194 1
a194 1
#define CYGWIN_VERSION_API_MINOR 78
@


1.104
log
@whitespace
@
text
@d188 1
d194 1
a194 1
#define CYGWIN_VERSION_API_MINOR 76
@


1.103
log
@* syslog.cc (syslog): Do not print the Windows pid.  Print the Cygwin pid as an
unsigned decimal.  On Win95 print a timestamp and attempt to lock the file up
to four times in 3 ms.
@
text
@d157 1
a157 1
           malloc_stats
@


1.102
log
@* cygwin.din: Export all appropriate newlibc libm functions.  Sort.
* include/cygwin/version.h: Bump API minor number.
@
text
@d187 1
d193 1
a193 1
#define CYGWIN_VERSION_API_MINOR 75
@


1.101
log
@* cygwin.din: Export all appropriate newlib functions.
* include/cygwin/version.h: Bump API minor number.
@
text
@d183 4
d192 1
a192 1
#define CYGWIN_VERSION_API_MINOR 74
@


1.100
log
@* include/cygwin/version.h: Bump DLL minor number.
* malloc.cc (DEFAULT_MMAP_THRESHOLD): Bump down to 16MB thanks to below
changes.
@
text
@d174 9
d188 1
a188 1
#define CYGWIN_VERSION_API_MINOR 73
@


1.99
log
@	* cygwin.din: Export setreuid32, setreuid, setregid32, setregid.
	* syscalls.cc (setreuid32): New function.
	(setreuid): Ditto.
	(setregid32): Ditto.
	(setregid): Ditto.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 20
@


1.98
log
@	* cygwin.din: Export nanosleep().
	* signal.cc (nanosleep): New function.
	(sleep): Move old functionality to nanosleep().  Call nanosleep().
	(usleep): Remove old functionality.  Call nanosleep().
	* include/cygwin/version.h: Bump API minor number.
@
text
@d173 1
d179 1
a179 1
#define CYGWIN_VERSION_API_MINOR 72
@


1.97
log
@* include/cygwin/version.h: Bump DLL minor number.
@
text
@d172 1
d178 1
a178 1
#define CYGWIN_VERSION_API_MINOR 71
@


1.96
log
@	* cygwin.din: Add strerror_r.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 19
@


1.95
log
@	Split ChangeLog, create ChangeLog-2002.
	Fix copyright dates.
@
text
@d171 1
d177 1
a177 1
#define CYGWIN_VERSION_API_MINOR 70
@


1.95.2.1
log
@trunk merge
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 20
a170 2
       71: Export strerror_r
       72: Export nanosleep
d176 1
a176 1
#define CYGWIN_VERSION_API_MINOR 72
@


1.95.2.2
log
@merge from trunk
@
text
@a172 1
       73: Export setreuid32, setreuid, setregid32, setregid
d178 1
a178 1
#define CYGWIN_VERSION_API_MINOR 73
@


1.95.2.3
log
@merge from trunk
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 21
@


1.95.2.4
log
@merge from trunk
@
text
@a173 9
       74: Export _strtold a64l hcreate hcreate_r hdestroy hdestroy_r hsearch
		  hsearch_r isblank iswalnum iswalpha iswblank iswcntrl iswctype
		  iswdigit iswgraph iswlower iswprint iswpunct iswspace iswupper
		  iswxdigit l64a mbrlen mbrtowc mbsinit mbsrtowcs mempcpy
		  on_exit setbuffer setlinebuf strndup strnlen tdelete tdestroy
		  tfind towctrans towlower towupper tsearch twalk wcrtomb wcscat
		  wcschr wcscpy wcscspn wcslcat wcslcpy wcsncat wcsncmp wcsncpy
		  wcspbrk wcsrchr wcsrtombs wcsspn wcsstr wctob wctob wctrans
		  wctype wmemchr wmemcmp wmemcpy wmemmove wmemset
d179 1
a179 1
#define CYGWIN_VERSION_API_MINOR 74
@


1.95.2.5
log
@merge from trunk
@
text
@a182 4
       75: Export exp2 exp2f fdim fdimf fma fmaf fmax fmaxf fmin fminf lrint
		  lrintf lround lroundf nearbyint nearbyintf remquo remquof
		  round roundf scalbln scalblnf sincos sincosf tgamma tgammaf
		  truncf
d188 1
a188 1
#define CYGWIN_VERSION_API_MINOR 75
@


1.95.2.6
log
@merge from trunk
@
text
@d157 1
a157 1
	   malloc_stats
@


1.95.2.7
log
@merge from trunk
@
text
@a186 2
       76: mallinfo
       77: thread-safe exit/at_exit
d192 1
a192 1
#define CYGWIN_VERSION_API_MINOR 77
@


1.95.2.8
log
@merge from trunk
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 22
@


1.95.2.9
log
@merge from trunk
@
text
@a188 5
       78: Export acl32 aclcheck32 aclfrommode32 aclfrompbits32 aclfromtext32
		  aclsort32 acltomode32 acltopbits32 acltotext32 facl32
		  fgetpos64 fopen64 freopen64 fseeko64 fsetpos64 ftello64
		  _open64 _lseek64 _fstat64 _stat64 mknod32

d194 1
a194 1
#define CYGWIN_VERSION_API_MINOR 78
@


1.95.2.10
log
@merge from trunk
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 23
d189 1
a189 3
       78: Use stat and fstat rather than _stat, and _fstat.
           Export btowc and trunc.
       79: Export acl32 aclcheck32 aclfrommode32 aclfrompbits32 aclfromtext32
d193 1
a193 1
       80: Export pthread_rwlock stuff
d199 1
a199 1
#define CYGWIN_VERSION_API_MINOR 80
@


1.95.2.11
log
@merge from trunk
@
text
@a86 4

#define CYGWIN_VERSION_CHECK_FOR_USING_BIG_TYPES \
  (CYGWIN_VERSION_DLL_MAKE_COMBINED (user_data->api_major, user_data->api_minor) >= \
  79)
@


1.95.2.12
log
@merge from trunk
@
text
@a199 1
       81: CW_CHECK_NTSEC addition to external.cc
d205 1
a205 1
#define CYGWIN_VERSION_API_MINOR 81
@


1.95.2.13
log
@merge from trunk
@
text
@d44 2
a45 2
#define CYGWIN_VERSION_DLL_MAJOR 1005
#define CYGWIN_VERSION_DLL_MINOR 0
a200 7
       82: Export wcscoll wcswidth wcwidth
       83: Export gethostid
       84: Pty open allocates invisible console.  64 bit interface
       85: Export new 32/64 functions from API 0.79 only with leading
           underscore.  No problems with backward compatibility since no
           official release has been made so far.  This change removes
           exported symbols like fopen64, which might confuse configure.
d206 1
a206 1
#define CYGWIN_VERSION_API_MINOR 85
@


1.95.2.14
log
@merge from trunk
@
text
@a207 3
       86: Export ftok
       87: Export vsyslog
       88: Export _getreent
d213 1
a213 1
#define CYGWIN_VERSION_API_MINOR 88
@


1.95.2.15
log
@merge from trunk
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 1
@


1.95.2.16
log
@merge from trunk
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 2
a210 2
       89: Export __mempcpy
       90: Export _fopen64
d216 1
a216 1
#define CYGWIN_VERSION_API_MINOR 90
@


1.95.2.17
log
@merge from trunk
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 3
@


1.95.2.18
log
@merge from trunk
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 4
@


1.95.2.19
log
@merge from trunk
@
text
@a212 8
       91: Export argz_add argz_add_sep argz_append argz_count argz_create
	   argz_create_sep argz_delete argz_extract argz_insert
	   argz_next argz_replace argz_stringify envz_add envz_entry
	   envz_get envz_merge envz_remove envz_strip
       92: Export getusershell, setusershell, endusershell
       93: Export daemon, forkpty, openpty, iruserok, ruserok, login_tty,
	   openpty, forkpty, revoke, logwtmp, updwtmp

d218 1
a218 1
#define CYGWIN_VERSION_API_MINOR 93
@


1.95.2.20
log
@merge from trunk
@
text
@a219 2
       94: Export getopt, getopt_long, optarg, opterr, optind, optopt,
       	   optreset, __check_rhosts_file, __rcmd_errstr.
d226 1
a226 1
#define CYGWIN_VERSION_API_MINOR 94
@


1.95.2.21
log
@merge from trunk
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 5
@


1.95.2.22
log
@merge from trunk
@
text
@d194 1
a194 1
	   Export btowc and trunc.
d205 3
a207 3
	   underscore.  No problems with backward compatibility since no
	   official release has been made so far.  This change removes
	   exported symbols like fopen64, which might confuse configure.
d221 1
a221 1
	   optreset, __check_rhosts_file, __rcmd_errstr.
@


1.94
log
@	* cygwin.din: add asprintf and vasprintf, as well as the reentrant
	versions and underscore variants.
	* include/cygwin/version.h: bump CYGWIN_VERSION_API_MINOR.
@
text
@d3 1
a3 1
   Copyright 1996, 1997, 1998, 1999, 2000, 2001, 2002 Red Hat, Inc.
@


1.93
log
@* include/cygwin/version.h: Bump DLL minor number.
@
text
@d170 1
d176 1
a176 1
#define CYGWIN_VERSION_API_MINOR 69
@


1.92
log
@* cygwin.din: Reflect name change from strtodf to strtof.  Export strtof.
* include/cygwin/version.h: Bump API minor number.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 18
@


1.91
log
@* netdb.cc: New file.
* Makeile.in (DLL_OFILES): Add reference to the new netdb.cc file.
* cygwin.din : Add new aliased exports for service and protocol enumerations in
netdb.cc.
@
text
@d169 1
d175 1
a175 1
#define CYGWIN_VERSION_API_MINOR 68
@


1.90
log
@* include/cygwin/version.h: Bump DLL minor number.
@
text
@d168 1
d174 1
a174 1
#define CYGWIN_VERSION_API_MINOR 67
@


1.89
log
@* cygwin.din: Export pthread_getsequence_np.
* include/cygwin/version.h: Bump API minor version.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 17
@


1.88
log
@* cygwin.din: Export nl_langinfo().
* include/cygwin/version.h: Bump API minor version.
@
text
@d167 1
d173 1
a173 1
#define CYGWIN_VERSION_API_MINOR 66
@


1.87
log
@* include/cygwin/version.h: Bump DLL minor number.
@
text
@d166 1
d172 1
a172 1
#define CYGWIN_VERSION_API_MINOR 65
@


1.86
log
@* include/cygwin/version.h: Fix comment.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 16
@


1.85
log
@* include/cygwin/version.h: Bump API_MINOR to accommodate below changes.
* cygwin.din (siginterrupt): New export.
* signal.cc (siginterrupt): New.
@
text
@d162 2
a163 2
       62: Erroneously bumped.
       63: Export pututline.
d165 1
a165 1
       65: Export fseeko, ftello
@


1.84
log
@	* cygwin.din: Export fseeko() and ftello().
	* include/cygwin/version.h: Bump API minor version.
@
text
@d165 1
d171 1
a171 1
#define CYGWIN_VERSION_API_MINOR 64
@


1.83
log
@* include/cygwin/version.h: Bump API minor number for below export.
* cygwin.din (pututline): New exported function.
* syscalls.cc (login): Use pututiline().
(setutent): Open utmp as read/write.
(endutent): Check if utmp file is open.
(utmpname): call endutent() to close current utmp file.
(getutid): Enable all cases, use strncmp() to compare ut_id fields.
(pututline): New.
* tty.cc (create_tty_master): Set ut_pid to current pid.
@
text
@d164 1
d170 1
a170 1
#define CYGWIN_VERSION_API_MINOR 63
@


1.82
log
@* include/cygwin/version.h: Bump DLL minor number.
@
text
@d163 1
d169 1
a169 1
#define CYGWIN_VERSION_API_MINOR 62
@


1.81
log
@* include/cygwin/version.h: Bump DLL minor number.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 15
@


1.81.2.1
log
@* include/cygwin/version.h: Bump API minor number for below export.
* cygwin.din (pututline): New exported function.
* syscalls.cc (login): Use pututiline().
(setutent): Open utmp as read/write.
(endutent): Check if utmp file is open.
(utmpname): call endutent() to close current utmp file.
(getutid): Enable all cases, use strncmp() to compare ut_id fields.
(pututline): New.
* tty.cc (create_tty_master): Set ut_pid to current pid.
* fhandler.h (fhandler_serial::vmin_): Declare as size_t.
* fhandler_serial.cc (fhandler_serial::raw_read): Use correct type for
minchars.
(fhandler_serial::ioctl): Set errno if the ClearCommError fails.
(fhandler_serial::tcsetattr): Use correct value for vmin_.
(fhandler_serial::tcgetattr): Ditto.
* fhandler_socket.cc (fhandler_socket::recvmsg): Call if from == NULL
WSARecvFrom with fromlen = NULL.
@
text
@a162 1
       63: Export pututline.
d168 1
a168 1
#define CYGWIN_VERSION_API_MINOR 63
@


1.80
log
@* shared.cc (shared_info::initialize): Use correct value for version
comparison.
* include/cygwin/version.h (CYGWIN_VERSION_MAGIC): Use all of a DWORD for magic
calculation.
@
text
@d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 14
@


1.79
log
@Change _function() to function() throughout.
* cygwin.din: Remove last vestiges (?) of newlib wrappers.
* cygthread.cc (cygthread::detach): Always wait for event or suffer an
apparently inavoidable race.
* dcrt0.cc (dll_crt0_1): Allocate threads after stack has been relocated.
* debub.cc (lock_debug): Don't acquire lock on exit.
* fork.cc (fork_child): Recreate mmaps before doing anything else since Windows
has a habit of using blocks of memory in the child that could previously have
been occupied by shared memory in the parent.
* mmap.cc (fhandler_disk_file::fixup_mmap_after_fork): Issue error here and
provide some details about what went wrong.
(fixup_mmaps_after_fork): Remove error message.
* shared.cc (open_shared): Move warning message so that more detail is
possible.
* sigproc.cc (sigproc_init): Initialize sync_proc_subproc to avoid a race.
(sigproc_terminate): Specifically wait for process thread to terminate.
@
text
@d233 1
a233 1
#define CYGWIN_VERSION_MAGIC(a, b) ((unsigned) (((unsigned short) a) | (unsigned short) b))
@


1.78
log
@force checkin
@
text
@d3 1
a3 1
   Copyright 1996, 1997, 1998, 1999, 2000, 2001 Red Hat, Inc.
@


1.77
log
@* include/cygwin/version.h: Bump DLL minor number.
@
text
@@


1.76
log
@	* cygwin.din: Revert exporting new wchar functions.
	* include/cygwin/version.h: Change comment for API minor 62.
@
text
@a43 2
  /* The current cygwin version is 1.3.6 */

d45 1
a45 1
#define CYGWIN_VERSION_DLL_MINOR 13
@


1.75
log
@	* cygwin.din: Add prototypes for new wchar functions in newlib.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d164 1
a164 3
       62: Export wcscat, wcschr, wcscpy, wcscspn, wcslcat, wcslcpy, wcsncat,
           wcsncmp, wcsncpy, wcspbrk, wcsrchr, wcsspn, wcsstr, wmemchr,
	   wmemcmp, wmemcpy, wmemmove, wmemset
@


1.74
log
@	* cygwin.din: Export getc_unlocked, getchar_unlocked,
	putc_unlocked, putchar_unlocked functions.
	* include/cygwin/version.h: Bump api minor.
@
text
@d164 3
d172 1
a172 1
#define CYGWIN_VERSION_API_MINOR 61
@


1.73
log
@	* fhandler_socket.cc (fhandler_socket::recvfrom): Eliminate flags
	not understood by WinSock.
	(fhandler_socket::sendto): Ditto.  If WinSock sendto() returns
	WSAESHUTDOWN, change errno to EPIPE and raise SIGPIPE if MSG_NOSIGNAL
	isn't set in flags.
	* include/cygwin/socket.h: Define MSG_WINMASK and MSG_NOSIGNAL.
	* include/cygwin/version.h: Bump API minor number.
@
text
@d162 2
d169 1
a169 1
#define CYGWIN_VERSION_API_MINOR 60
@


1.72
log
@* perthread.h (vfork_save): Add ctty, sid, pgid, exitval fields.
(vfork_save::restore_pid): New method.
(vfork_save::restore_exit): New method.
* fork.cc (vfork): Save ctty, sid, pgid and restore them when returning to
"parent".  Use exitval field if exiting but never created a new process.
* syscalls.cc (setsid): Detect when in "vfork" and force an actual fork so that
pid will be allocated (UGLY!).
(getsid): New function.
* dcrt0.cc (do_exit): Use vfork_save::restore_exit method for returning from a
vfork.
* spawn.cc (spawnve): Use vfork_save::{restore_pid,restore_exit} methods for
returning from vfork.
* cygwin.din: Export getsid.
* include/cygwin/version.h: Bump api minor number.
* malloc.cc: #ifdef sYSTRIm for when MORECORE_CANNOT_TRIM is true.
@
text
@d161 1
d167 1
a167 1
#define CYGWIN_VERSION_API_MINOR 59
@


1.71
log
@* Makefile.in: Add support for new malloc.o and renamed malloc_wrapper.o.  Use
-fomit-frame-pointer for malloc.o compilation.
* malloc_wrapper.cc: New file.  Rename from malloc.cc.  Add support for more
malloc functions.  Eliminate export_* calls.  Just use straight malloc names.
Remove unused argument from malloc lock functions.
* cygwin.din: Just export straight malloc names.  Add malloc_stats,
malloc_trim, malloc_usable_size, mallopt, memalign, valloc.
* dcrt0.cc (__cygwin_user): Eliminate export_* malloc entries.
* fork.cc (fork_parent): Remove unused argument from malloc_lock argument.
* malloc.cc: New file.  Doug Lea's malloc v2.7.1.
* cygmalloc.h: New file.
* include/cygwin/version.h: Bump API_MINOR.
* sync.h (muto::acquire): Use appropriate number for regparm attribute.
(muto::reset): Ditto.
(muto::release): Ditto.
@
text
@d160 1
d166 1
a166 1
#define CYGWIN_VERSION_API_MINOR 58
@


1.70
log
@	* security.cc: Change some formatting.
	* include/cygwin/version.h: Bump API minor version.

        * cygheap.h (class cygheap_user): Add member groups.
        * security.h (class cygsidlist): Add members type and maxcount,
        methods position, addfromgr, alloc_sids and free_sids and
        operator+= (const PSID psid). Modify contains () to call
        position () and optimize add () to use maxcount.
        (class user_groups): Create.
        Update declarations of verify_token and create_token.
        * security.cc (cygsidlist::alloc_sids): New.
        (cygsidlist::free_sids): New.
        (get_token_group_sidlist): Create from get_group_sidlist.
        (get_initgroups_sidlist): Create from get_group_sidlist.
        (get_group_sidlist): Suppress.
        (get_setgroups_sidlist): Create.
        (verify_token): Modify arguments. Add setgroups case.
        (create_token): Modify arguments. Call get_initgroups_sidlist and
        get_setgroups_sidlist as needed. Set SE_GROUP_LOGON_ID from auth_pos
        outside of the loop. Rename the various group sid lists consistently.
        * syscalls.cc (seteuid32): Modify to use cygheap->user.groups.
        (setegid32): Call cygheap->user.groups.update_pgrp.
        * grp.cc (setgroups): Create.
        (setgroups32): Create.
        * uinfo.cc (internal_getlogin): Initialize and update user.groups.pgsid.
        * cygwin.din: Add setgroups and setgroups32.
@
text
@d158 2
d165 1
a165 1
#define CYGWIN_VERSION_API_MINOR 57
@


1.69
log
@* include/cygwin/version.h: Bump API version to indicate that ntsec is on by
default now.
@
text
@d157 1
d163 1
a163 1
#define CYGWIN_VERSION_API_MINOR 56
@


1.68
log
@	* include/cygwin/version.h: Bump minor API version.
@
text
@d156 1
d162 1
a162 1
#define CYGWIN_VERSION_API_MINOR 55
@


1.67
log
@* include/cygwin/version.h: Bump DLL minor number.
@
text
@d155 1
d161 1
a161 1
#define CYGWIN_VERSION_API_MINOR 54
@


1.66
log
@	* include/cygwin/version.h: Bump API minor version.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 12
@


1.65
log
@* winsup.h: Minor cleanup.
* path.h (path_conv::[]): New operator.
* syscalls.cc (_link): Use path_conv operators rather than methods, where
appropriate.  Minor white space cleanup.
* include/cygwin/version.h: Bump DLL minor number.
* dcrt0.cc (sm): Make NO_COPY.
@
text
@d154 1
d160 1
a160 1
#define CYGWIN_VERSION_API_MINOR 53
@


1.64
log
@* cygwin.din: Add strlcat and strlcpy.
* include/cygwin/version.h: Increment API minor version number.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 11
@


1.63
log
@* cygwin.din: Add strptime.
* include/cygwin/version.h: Increment API version number.
@
text
@d153 1
d159 1
a159 1
#define CYGWIN_VERSION_API_MINOR 52
@


1.62
log
@* include/cygwin/version.h: Bump DLL minor number.
@
text
@d152 1
d158 1
a158 1
#define CYGWIN_VERSION_API_MINOR 51
@


1.61
log
@* include/cygwin/version.h: Bump DLL minor number.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 10
@


1.60
log
@* include/cygwin/version.h: Bump DLL minor number.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 9
@


1.59
log
@* include/cygwin/version.h: Bump DLL minor number.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 8
@


1.58
log
@	* include/cygwin/version.h: Bump API minor version to 51.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 7
@


1.57
log
@	* Makefile.in: Add fnmatch.o to DLL_OFILES.
	* cygwin.din: Add fnmatch export symbol.
	* fnmatch.c: New file.
	* include/fnmatch.h: Ditto.
	* include/cygwin/version.h: Bump API minor version to 50.
@
text
@d151 1
d157 1
a157 1
#define CYGWIN_VERSION_API_MINOR 50
@


1.56
log
@	* cygwin.din: Add symbols for endutent(), getutent(), getutid(),
	getutline(), setutent() and utmpname().
	* syscalls.cc (setutent): New function.
	(endutent): Ditto.
	(utmpname): Ditto.
	(getutent): Ditto.
	(getutid): Ditto.
	(getutline): Ditto.
	* include/cygwin/version.h: Bump API minor version.
@
text
@d150 1
d156 1
a156 1
#define CYGWIN_VERSION_API_MINOR 49
@


1.55
log
@* Makefile.in: Autogenerate some header files which provide magic numbers.
Force dependencies for files which depend on autogenerated headers to ensure
that they are always built.
* child_info.h (child_info): Add new fields to accommodate new magic number
header stuff.
* dcrt0.cc: Rely on "child_info_magic.h" to ensure that correct child_info
magic numbers are used.
(dll_crt0_1): Temporarily remove _cygwin_testing_magic test.
(_dll_crt0): Do more testing on magic numbers from fork_info structure.  Call
"multiple_cygwin_problem" where appropriate.
(multiple_cygwin_problem): Rename from multiple_cygwin_die.  Issue a warning or
die, as appropriate based on cygwin version/magic number mismatch.
* pinfo.cc (pinfo::exit): Don't attempt to dereference `this' if it doesn't
exist.  This can happen when a fatal error occurs early in process
initialization.
* shared.cc: Rely on "shared_info_magic.h" to accommodate that new magic number
header stuff.
(shared_info::initialize): Use new magic number stuff, for shared region.
(memory_init): Ditto, for mount table.
* shared_info.h: Accomodate new magic number stuff for shared region and mount
table.
* sigproc.cc: Rely on "child_info_magic.h" to accommodate new magic number
header stuff.
(init_child_info): Initialize new fields in child_info) to accomodate magic
numbers.
* winsup.h: Rename multiple_cygwin_die to multiple_cygwin_problem.
* include/cygwin/version.h: Define macros for manipulating version magic.
* cygmagic: New shell script for generating magic numbers.
@
text
@d149 1
d155 1
a155 1
#define CYGWIN_VERSION_API_MINOR 48
@


1.54
log
@* include/cygwin/version.h: Bump API minor version for below changes.
@
text
@d151 2
d219 2
@


1.53
log
@* path.cc (mount_info::conv_to_win32_path): Avoid returning error if cygdrive
== '/'.
(mount_info::cygdrive_win32_path): Return 0 if invalid cygdrive path.
@
text
@d148 1
d152 1
a152 1
#define CYGWIN_VERSION_API_MINOR 47
@


1.52
log
@* include/cygwin/version.h: Bump version to 1.3.6.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 6
@


1.52.2.1
log
@Bump back to 1.3.5
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 5
@


1.51
log
@* include/cygwin/version.h: Bump version to 1.3.5.
@
text
@d44 1
a44 1
  /* The current cygwin version is 1.3.5 */
d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 5
@


1.50
log
@Eliminate excess whitespace.
@
text
@d44 1
a44 1
  /* The current cygwin version is 1.3.4 */
d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 4
@


1.49
log
@        * fhandler_tape.cc (fhandler_dev_tape::tape_status): Report
        EOTWarningZoneSize in get->mt_eotwarningzonesize.
        * include/cygwin/mtio.h: Define DEFTAPE.
        (struct mtget): Add member `mt_eotwarningzonesize'. Add a comment.
        * include/cygwin/version.h: Bump API minor version to 47.
@
text
@d96 6
a101 6
        3: Export dll_noncygwin_dllcrt0.
        4: New socket ioctls, revamped ifconf support.
        5: Thread support/exports.
        6: Change in termios handling.
        7: Export scandir and alphasort.
        8: Export _ctype_, _sys_errlist, _sys_nerr.
d117 4
a120 4
           geteuid, getegid return effective uid/gid.
           getuid, getgid return real uid/gid.
           seteuid, setegid set only effective uid/gid.
           setuid, setgid set effective and real uid/gid.
d135 1
a135 1
           mrand48, nrand48, seed48, and srand48.
@


1.48
log
@        * Makefile.in: Build wincap.o.
        * wincap.cc: New file.
        * wincap.h: Ditto.
        * autoload.cc: Add dynamic load statement for `CreateHardLinkA'.
        * dcrt0.cc (os_being_run): Eliminated.
        (osname): Ditto.
        (iswinnt): Ditto.
        (set_os_type): Ditto.
        (dll_crt0_1): Call wincap.init() instead of set_os_type().
        (_dll_crt0): Ditto.
        * environ.cc (set_chunksize): New function.
        (parse_thing): `forkchunk' setting now invokes function `set_chunksize'.
        * fork.cc (chunksize): Eliminated. Moved to be member of wincap.
        * host_dependent.h: Removed.
        * syscalls.cc (_link): Try using `CreateHardLinkA' first, if available.
        * cygheap.cc, dcrt0.cc, delqueue.cc, dir.cc,
        environ.cc, fhandler.cc, fhandler.h, fhandler_console.cc,
        fhandler_mem.cc, fork.cc, mmap.cc, net.cc, pinfo.cc, pinfo.h,
        security.cc, syscalls.cc, sysconf.cc, syslog.cc, thread.cc,
        times.cc, tty.cc, uinfo.cc, uname.cc, winsup.h: Use new wincap
        capability check throughout.
        * winsup.h: Include wincap.h. Eliminate extern declarations of
        `os_being_run' and `iswinnt'. Eliminate `os_type" definition.
        * include/cygwin/version.h: Bump version to 1.3.4.
@
text
@d147 1
d151 1
a151 1
#define CYGWIN_VERSION_API_MINOR 46
@


1.48.2.1
log
@Merged changes from HEAD
@
text
@d44 1
a44 1
  /* The current cygwin version is 1.3.6 */
d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 7
d96 6
a101 6
	3: Export dll_noncygwin_dllcrt0.
	4: New socket ioctls, revamped ifconf support.
	5: Thread support/exports.
	6: Change in termios handling.
	7: Export scandir and alphasort.
	8: Export _ctype_, _sys_errlist, _sys_nerr.
d117 4
a120 4
	   geteuid, getegid return effective uid/gid.
	   getuid, getgid return real uid/gid.
	   seteuid, setegid set only effective uid/gid.
	   setuid, setgid set effective and real uid/gid.
d135 1
a135 1
	   mrand48, nrand48, seed48, and srand48.
a146 3
       47: Report EOTWarningZoneSize in struct mtget.
       48: Export "posix" regex functions
       49: Export setutent, endutent, utmpname, getutent, getutid, getutline.
a148 2
     /* Note that we forgot to bump the api for ualarm, strtoll, strtoull */

d150 1
a150 1
#define CYGWIN_VERSION_API_MINOR 49
a214 2
#define CYGWIN_VERSION_MAGIC(a, b) ((unsigned) (((unsigned short) a) | (unsigned short) b))
#define CYGWIN_VERSION_MAGIC_VERSION(a) ((unsigned) ((unsigned)a & 0xffff))
@


1.48.2.2
log
@Merged changes from HEAD
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 10
a149 2
       50: Export fnmatch.
       51: Export recvmsg, sendmsg.
d155 1
a155 1
#define CYGWIN_VERSION_API_MINOR 51
@


1.48.2.3
log
@Merged changes from HEAD
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 11
@


1.48.2.4
log
@Merged changes from HEAD
@
text
@a151 2
       52: Export strptime
       53: Export strlcat, strlcpy.
d157 1
a157 1
#define CYGWIN_VERSION_API_MINOR 53
@


1.48.2.5
log
@Merged changes from HEAD
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 12
@


1.48.2.6
log
@Merged changes from HEAD
@
text
@a153 1
       54: Export __fpclassifyd, __fpclassifyf, __signbitd, __signbitf.
d159 1
a159 1
#define CYGWIN_VERSION_API_MINOR 54
@


1.48.2.7
log
@Merged changes from HEAD
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 13
@


1.48.2.8
log
@Merged changes from HEAD
@
text
@a154 1
       55: Export fcloseall, fcloseall_r.
d160 1
a160 1
#define CYGWIN_VERSION_API_MINOR 55
@


1.48.2.9
log
@Merged changes from HEAD
@
text
@a155 1
       56: Make ntsec on by default.
d161 1
a161 1
#define CYGWIN_VERSION_API_MINOR 56
@


1.48.2.10
log
@Merged changes from HEAD
@
text
@a156 1
       57: Export setgroups.
d162 1
a162 1
#define CYGWIN_VERSION_API_MINOR 57
@


1.48.2.11
log
@Merged changes from HEAD
@
text
@a157 2
       58: Export memalign, valloc, malloc_trim, malloc_usable_size, mallopt,
           malloc_stats
d163 1
a163 1
#define CYGWIN_VERSION_API_MINOR 58
@


1.48.2.12
log
@Merged changes from HEAD
@
text
@a159 1
       59: getsid
d165 1
a165 1
#define CYGWIN_VERSION_API_MINOR 59
@


1.48.2.13
log
@Merged changes from HEAD
@
text
@a160 3
       60: MSG_NOSIGNAL
       61: Export getc_unlocked, getchar_unlocked, putc_unlocked,
	   putchar_unlocked
d166 1
a166 1
#define CYGWIN_VERSION_API_MINOR 61
@


1.48.2.14
log
@Merged changes from HEAD
@
text
@a163 3
       62: Export wcscat, wcschr, wcscpy, wcscspn, wcslcat, wcslcpy, wcsncat,
           wcsncmp, wcsncpy, wcspbrk, wcsrchr, wcsspn, wcsstr, wmemchr,
	   wmemcmp, wmemcpy, wmemmove, wmemset
d169 1
a169 1
#define CYGWIN_VERSION_API_MINOR 62
@


1.48.2.15
log
@Merged changes from HEAD
@
text
@d164 3
a166 1
       62: Erroneously bumped.
@


1.47
log
@* cygwin.din: Remove cygwin_getshared.
* shared.cc: Ditto.
* include/cygwin/version.h: Bump API minor number.
* dtable.cc (dtable::build_fhandler): Fix incorrect test for socket.
@
text
@d44 1
a44 1
  /* The current cygwin version is 1.3.1 */
d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 3
@


1.46
log
@        * include/cygwin/version.h: Bump API minor version to 45 according
        to adding the gamm*_r functions.
@
text
@d146 1
d150 1
a150 1
#define CYGWIN_VERSION_API_MINOR 45
@


1.45
log
@* cygwin.din: Add gamm*_r function exports.
@
text
@d149 1
a149 1
#define CYGWIN_VERSION_API_MINOR 44
@


1.44
log
@* cygheap.h (init_cygheap): Move heap pointers here.
* include/sys/cygwin.h (perprocess): Remove heap pointers.
* dcrt0.cc (__cygwin_user_data): Reflect obsolete perprocess stuff.
(_dll_crt0): Don't initialize heap pointers.
(cygwin_dll_init): Ditto.
(release_upto): Use heap pointers from cygheap.
* heap.h: Ditto.
* fork.cc (fork_parent): Ditto.  Don't set heap pointers in ch.
(fork_child): Remove obsolete sigproc_fixup_after_fork.
* shared.cc (memory_init): Reorganize so that cygheap initialization is called
prior to regular heap since regular heap uses cygheap now.
* sigproc.cc (proc_subproc): Eliminate zombies allocation.
(sigproc_init): Move zombies alloation here.  Don't free up array on fork, just
reuse it.
(sigproc_fixup_after_fork): Eliminate.
* sigproc.h: Ditto.
* include/cygwin/version.h: Reflect change to perprocess structure.
@
text
@d145 1
a145 1
       45: perprocess change
@


1.43
log
@        * cygwin.din: Add `dirfd'.
        * dir.cc (dirfd): New function.
        (opendir): Open a directory file descriptor and save it in
        __d_dirent->d_fd.
        (closedir): Close directory file descriptor.
        * include/cygwin/version.h: Bump API minor version to 44.
@
text
@d145 1
@


1.42
log
@* include/cygwin/version.h: Bump API version.
@
text
@d144 1
d148 1
a148 1
#define CYGWIN_VERSION_API_MINOR 43
@


1.41
log
@* cygheap.cc (cygheap_root::set): Avoid treating '/' specially.
* fhandler.cc (fhandler_base::fcntl): Only set specific O_NDELAY style flag
passed in from application.
* fhandler_socket.cc (fhandler_socket::fcntl): Ditto.
* fhandler.h: Set constant for future use.
* winsup.h: Define OLD_O_NDELAY only for old programs.
* include/cygwin/version.h: Define CYGWIN_VERSION_CHECK_FOR_OLD_O_NONBLOCK.
@
text
@d143 1
d147 1
a147 1
#define CYGWIN_VERSION_API_MINOR 42
@


1.40
log
@* cygwin.din: Export sys_errlist, sys_nerr.
* include/cygwin/version.h: Bump minor version number.
@
text
@d85 4
@


1.39
log
@Christopher Faylor <cgf@@cygnus.com>
* cygwin.din: Export __signgam.
* include/cygwin/version.h: Bump minor version number.
@
text
@d138 1
d142 1
a142 1
#define CYGWIN_VERSION_API_MINOR 41
@


1.38
log
@         * cygwin.din: Add fchdir symbols.
         * path.cc (chdir): Guard against invalid parameter.
         (fchdir): New function.
         * include/cygwin/version.h: Bump API minor version to 40.
         * uinfo.cc (internal_getlogin): Remove unused variable.
@
text
@d137 1
d141 1
a141 1
#define CYGWIN_VERSION_API_MINOR 40
@


1.37
log
@* include/cygwin/version.h: Bump minor version number.
@
text
@d136 1
d140 1
a140 1
#define CYGWIN_VERSION_API_MINOR 39
@


1.36
log
@* cygwin.din: Export asctime_r, ctime_r, gmtime_r, localtime_r
* include/cygwin/version.h: Bump CYGWIN_VERSION_API_MINOR to 39
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 2
@


1.35
log
@* include/cygwin/version.h: Bump minor version number.
* childinfo.h: Bump child structure magic number.
@
text
@d135 1
d139 1
a139 1
#define CYGWIN_VERSION_API_MINOR 38
@


1.34
log
@* include/cygwin/version.h: Bump Cygwin version and API version.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 1
@


1.33
log
@        * syscalls.cc (check_posix_perm): New static function.
        (fpathconf): Add _PC_POSIX_PERMISSIONS and _PC_POSIX_SECURITY
        support.
        (pathconf): Ditto.
        * include/cygwin/version.h: Bump API minor number to 37.
@
text
@d44 1
a44 1
  /* The current cygwin version is 1.3.0 */
d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 0
d134 1
d138 1
a138 1
#define CYGWIN_VERSION_API_MINOR 37
@


1.32
log
@* dlopen.c (dlopen): Return NULL when name is NULL (suggested by
chrisiasci@@aol.com).
* cygwin.din: Add a new, internally used export - _check_for_executable.
* dcrt0.cc (dll_crt0_1): Set _check_for_executable for older binaries.  Pass
user_data to premain functions.
* fhandler.cc (fhandler_disk_file::open): Only check for executable if the
linked program is intereested in the executable bit.
(fhandler_disk_file::check_execable_p): Delete.
* fhandler.h (executable_states): New enumeration of various states of
executable bit caring.
(fhandler_base::set_execable_p): New method.
* fhandler_termios.cc (fhandler_termios::line_edit): Flag when a signal has
been sent to the tty.  Return -1 when this is so.
* fhandler_console.cc (fhandler_console::read): Return -1 when signal sending
character encountered.
* path.cc (path_conv::check): Record when path refers to a disk device.  Move
executable extension check here.
(check_sysfile): Accomodate new EXEC path states.
(has_suffix): Remove.
(next_suffix): Remove.
(class suffix_scan): New clas.
(suffix_scan::has): New method.
(suffix_scan:next): New method.
(symlink_info::check): Use suffix_scan method to control for scanning for
suffixes.
* path.h (path_conv::exec_state): New method.
* perprocess.h: Make "C" friendly.
* include/cygwin/version.h: Define CYGWIN_VERSION_CHECK_FOR_S_IEXEC.  Bump
CYGWIN_VERSION_API_MINOR.
* include/sys/cygwin.h: Change premain declarations.
* winsup.h: Move __cplusplus test to after builtin defines.
@
text
@d133 1
d137 1
a137 1
#define CYGWIN_VERSION_API_MINOR 36
@


1.31
log
@* cygwin.din: Export rand48 functions.
* thread.cc (MTinterface::Init): Remove the initialization of `reent_data'.
* dcrt0.cc: Add the initalizer to the declaration of `reent_data'.
* include/cygwin/version.h: Bump CYGWIN_VERSION_API_MINOR to 35.
@
text
@d82 3
a84 1

d132 1
d136 1
a136 1
#define CYGWIN_VERSION_API_MINOR 35
@


1.30
log
@* include/cygwin/version.h: Bump version to 1.3.0.
@
text
@d128 2
d133 1
a133 1
#define CYGWIN_VERSION_API_MINOR 34
@


1.29
log
@* include/cygwin/version.h: Bump API version.
@
text
@d44 1
a44 1
  /* The current cygwin version is 1.1.0 */
d46 2
a47 2
#define CYGWIN_VERSION_DLL_MAJOR 1001
#define CYGWIN_VERSION_DLL_MINOR 8
@


1.28
log
@* include/cygwin/version.h: Bump API to reflect setlogmask.
@
text
@d127 1
d131 1
a131 1
#define CYGWIN_VERSION_API_MINOR 33
@


1.27
log
@Wed Jan  3 09:20:20 2001  Jason Tishler <jt@@dothill.com>

	* include/cygwin/version.h: Fix typo in CYGWIN_VERSION_DLL_COMBINED
	macro.
@
text
@d126 1
d130 1
a130 1
#define CYGWIN_VERSION_API_MINOR 32
@


1.26
log
@        * cygwin.din: Add symbols for `getrlimit' and `setrlimit'.
        * exceptions.cc (stackdump): Avoid creating stackdump when
        `rlim_core' is 0.
        * resource.cc: New global variable `rlim_core'.
        (getrlimit): New function.
        (setrlimit): Ditto.
        include/cygwin/version.h: Bump minor API version to 32 due to
        adding `getrlimit' and `setrlimit'.
        include/sys/resource.h: Add defines, types and prototypes for
        `getrlimit' and `setrlimit'.
@
text
@d3 1
a3 1
   Copyright 1996, 1997, 1998, 1999, 2000 Cygnus Solutions.
d61 1
a61 1
  CYGWIN_VERSION_DLL_MAKE_COMBINED (CYGWIN_DLL_VERSION_MAJOR, CYGWIN_DLL_VERSION_MINOR)
@


1.25
log
@* include/cygwin/version.h: Bump DLL minor version number to 8.
@
text
@d125 1
d129 1
a129 1
#define CYGWIN_VERSION_API_MINOR 31
@


1.24
log
@* include/cygwin/version.h: Bump DLL minor version number to 7.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 7
@


1.23
log
@        * include/cygwin/version.h: Bump minor API version due to adding
        inet_aton.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 6
@


1.22
log
@* environ.cc (_addenv): malloc space for setenv if cygwin1.dll is used in
conjunction with older binaries.
(environ_init): Ditto.
* external.cc (get_cygdrive_info): New function.
* external.cc (get_cygdrive_prefixes): Change to use get_cygdrive_info but toss
the user and system flags.
* external.cc (cygwin_internal): Add new CW_GET_CYGDRIVE_INFO case.
* path.cc (mount_info::get_cygdrive_prefixes): Remove method.
* path.cc (mount_info::get_cygdrive_info): New method.  Actually,
get_cygdrive_info is really an enhanced version of get_cygdrive_prefixes
renamed to get_cygdrive_info that also gets the user and system flags.
* shared_info.h (get_cygdrive_prefixes): Remove method.
* shared_info.h (get_cygdrive_info): New method.
* include/cygwin/version.h: Bump minor API version due to adding
CW_GET_CYGDRIVE_INFO to cygwin_internal.
* include/sys/cygwin.h (cygwin_getinfo_types): Add CW_GET_CYGDRIVE_INFO.
@
text
@d124 1
d128 1
a128 1
#define CYGWIN_VERSION_API_MINOR 30
@


1.21
log
@Update copyright.
@
text
@d75 1
d123 1
d127 1
a127 1
#define CYGWIN_VERSION_API_MINOR 29
@


1.20
log
@* path.cc (mount_info::read_cygdrive_info_from_registry): Use
CYGWIN_INFO_CYGDRIVE_PREFIX, CYGWIN_INFO_CYGDRIVE_DEFAULT_PREFIX, and
CYGWIN_INFO_CYGDRIVE_FLAGS.
* path.cc (mount_info::write_cygdrive_info_to_registry): Use
CYGWIN_INFO_CYGDRIVE_PREFIX and CYGWIN_INFO_CYGDRIVE_FLAGS.
* path.cc (mount_info::remove_cygdrive_info_from_registry): Ditto.
* path.cc (mount_info::get_cygdrive_prefixes): Use CYGWIN_INFO_CYGDRIVE_PREFIX.
* include/cygwin/version.h: Add CYGWIN_INFO_CYGDRIVE_FLAGS,
CYGWIN_INFO_CYGDRIVE_PREFIX, and CYGWIN_INFO_CYGDRIVE_DEFAULT_PREFIX.
@
text
@d3 1
a3 1
   Copyright 1996, 1997, 1998, 1999 Cygnus Solutions.
@


1.19
log
@* include/cygwin/version.h: Bump DLL minor version number to 6.
@
text
@d159 3
@


1.18
log
@        * cygwin.din: Add symbol hstrerror.
        * net.cc: Change meaning of member `s' of struct host_errmap.
        (set_host_errno): Fix error in loop condition.
        (hstrerror): Ditto.
        (herror): Add appropriate functionality.
        * include/netdb.h: Add declaration of hstrerror.
        * include/cygwin/version.h: Bump CYGWIN_VERSION_API_MINOR to 29.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 5
@


1.17
log
@Add comment.
@
text
@d121 1
d125 1
a125 1
#define CYGWIN_VERSION_API_MINOR 28
@


1.16
log
@* include/cygwin/version.h: Bump DLL minor version number to 5 due to all of
the changes below.  Redefine process structure to avoid a fixed size table.
Redefine pinfo/_pinfo classes.  Use these throughout.
* dcrt0.cc (dll_crt0_1): Accomodate set_myself argument change.
(__api_fatal): Accomodate _pinfo::record_death argument change.
* exceptions.cc (really_exit): Ditto.
(sig_handle_tty_stop): Use pinfo constructor to access process info.
(events_init): Don't create pinfo_mutex since it is no longer required.
* external.cc (fillout_pinfo): Use winpids class to iterate over all system
pids.
(cygwin_internal): lock_pinfo_for_update and unlock_pinfo are now noops.
* fhandler_termios.cc (fhandler_termios::set_ctty): Use pinfo constructor to
access process info.
* fork.cc (fork): Reorganize to initialize child info after the child has
started since that is when we know the child's winpid, which is necessary to
allocate the pinfo shared memory.
* mmap.cc (recreate_mmaps_after_fork): Change arg type to _pinfo.
* pinfo.cc: Rename pinfo methods to _pinfo throughout.  Eliminate pinfo_list
stuff.
(set_myself): Accept a pid argument now.  Call pinfo initializer to initialize
myself.  Detect when this is an "execed" process and create an "indirect" pid
block.
(pinfo_init): Accomodate set_myself arg change.
(procinfo): Remove.
(pinfo::lock_pinfo): Remove.
(pinfo::unlock_pinfo): Remove.
(pinfo::init): New method.  Allocates shared memory space for process pinfo
structure.
(pinfo::record_death): Don't call locking functions.
(cygwin_winpid_to_pid): Simplify by using new pinfo constructor.
(EnumProcessesW95): New function for iterating over processes on Windows 95.
(winpids::winpids): New constructor for winpids class.  Sets up a list of
process ids.
(enum_init): Initialize w95/wnt pid enumerators.
* shared.cc (shared-info::initialize): Remove pid initialization.
* shared.h: Move pinfo stuff into pinfo.h.
(class shared_info): Remove pinfo_list element.
* signal.cc (kill_worker): Use pinfo constructor to access process info.
(kill_pgrp): Ditto.  Use winpids methods to access list of processes.
* sigproc.cc: Throughout, modify to use _pinfo where appropriate.
(proc_exists (pid_t)): New function.  Determines if a process exists based on
the pid.
(proc_exists (_pinfo *p): Use new proc_exists function above.
(proc_subproc): Copy pinfo stuff around rather than _pinfo pointers.  Try to be
careful about releasing shared memory when we don't need it anymore.  Remove
pinfo locks.
(remove_zombies): Remove pinfo memory when zombie is going away.
* sigproc.h: Reflect _pinfo/pinfo changes in sigproc.cc.
* spawn.cc (spawn_guts): Eliminate pinfo *child argument.  Reorganize to only
initialize child pinfo after process has been started and we know the windows
pid.
(_spawnve): Reflect spawn_guts changes.
* syscalls.cc (setpgid): Use pinfo constructor to access process info.
(getpgid): Ditto.
(internal_getlogin): Use _pinfo.
* winsup.h: Eliminate pinfo_mutex.  Eliminate spawn_guts declaration since it
is static now.  Reflect set_myself argument change.
* include/sys/cygwin.h: Add some PID_* enums to accomodate new pinfo stuff.
* include/cygwin/version.h: Update minor version for cygdrive changes below.
@
text
@d120 1
@


1.15
log
@* include/cygwin/version.h: Bump DLL minor version number to 4.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 4
d118 2
d123 1
a123 1
#define CYGWIN_VERSION_API_MINOR 24
@


1.15.2.1
log
@* include/cygwin/version.h: Update minor version for cygdrive changes below.
@
text
@a117 1
       26: CW_GET_CYGDRIVE_PREFIXES addition to external.cc
d121 1
a121 1
#define CYGWIN_VERSION_API_MINOR 26
@


1.14
log
@* cygwin.din: Export _getmode and getmode to allow querying of binary state of
an fd.
* external.cc (cygwin_internal): Add handling of perfile_table setting.
* fhandler.cc (perfile_table): New global.
(fhandler_base::get_default_fmode): New method to return a file's default mode
based on its name.
(fhandler_base::open): Use get_default_mode method to determine a file's mode.
Record file mode in file flags.
* fhandler.h (fhandler_base): Declare get_default_fmode
* syscalls.cc (getmode): New function.
* sys/cygwin.h (__cygwin_perfile): New structure.
(cygwin_getinfo_types): Move outside of WINVER conditional.
(per_process): Move inside of WINVER conditional.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 3
@


1.13
log
@        * include/cygwin/version.h: Bump API minor version to 24.
@
text
@d117 1
@


1.12
log
@* Makefile.in: Use variables rather than configure constructs where
appropriate.
(LIBCOS): Find additional stub library stuff in their own subdirectory.
* dcrt0.cc: Convert user_data pointer to static __cygwin_user_data area.
(do_global_ctors): Check magic_bisquit for initialization.
(dll_crt0_1): First group of premain functions prior to fd initialization.  Run
second group before calling main.
(dll_crt0 ()): New function, called from new initialization code.
(dll_crt0 (per_process *uptr)): Call new dll_crt0 () function on
initialization.
* debug.cc (thread_stub): Initialize bottom of stack with per-thread info.
* environ.cc (parse_thing): Use binmode global to control CYGWIN=binmode
behavior.
* fhandler.cc (fhandler_base::open): Allow explicit setting of __fmode to
O_BINARY or O_TEXT to override disk mount settings.
* libcmain.cc: Move to lib subdirectory.
* libccrt0.cc: Ditto.
* dll_main.cc: Ditto.
* dll_entry.cc: Ditto.
* getopt.c: Ditto.
* thread.cc (thread_init_wrapper): Call ExitThread explicitly rather than
returning, as a preliminary step towards placing per thread info at the bottom
of the stack.
* winsup.h: Move per_process class to include/sys/cygwin.h.  Declare new
dll_crt0().
* include/cygwin/version.h: Bump API minor version.
* binmode.c: New file.
* textmode.c: Ditto.
* lib/_cygwin_crt0_common.cc: Ditto.
* lib/crt0.h: Ditto.
* lib/cygwin_attach_dll.c: Ditto.
* lib/cygwin_crt0.c: Ditto.
* lib/dll_entry.cc: Ditto.
* lib/dll_main.cc: Ditto.
* lib/getopt.c: Ditto.
* lib/libcmain.c: Ditto.
* lib/premain0.c: Ditto.
* lib/premain1.c: Ditto.
* lib/premain2.c: Ditto.
* lib/premain3.c: Ditto.
@
text
@d116 1
d120 1
a120 1
#define CYGWIN_VERSION_API_MINOR 23
@


1.11
log
@        * cygwin.din: Define symbols for `cygwin_logon_user' and
        `cygwin_set_impersonation_token'.
        * dcrt0.cc (dll_crt0_1): Eliminate superfluous conditional
        statements.
        Add load statements for `ImpersonateLoggedOnUser', `LogonUserA'
        and `RevertToSelf'.
        * fork.cc (fork): Care for correct impersonation of parent
        and child process.
        * security.cc (cygwin_set_impersonation_token): New function.
        (cygwin_logon_user): Ditto.
        shared.h (class pinfo): New members `orig_uid', `orig_gid',
        `real_uid' nad `real_gid'.
        spawn.cc (spawn_guts): Care for impersonation when starting
        child process in a different user context.
        * syscalls.cc (setgid): Call `setegid' now. Set real_gid.
        (setuid): Call `seteuid' now. Set real_uid.
        (seteuid): Functionality moved from setuid to here. Care for
        correct impersonation.
        (setegid): Functionality moved from setgid to here.
        * uinfo.cc (uinfo_init): Initialization of additional pinfo
        members.
        (getuid): Return real uid.
        (getgid): Return real gid.
        (geteuid): Return effective uid.
        (getegid): Return effective gid.
        include/sys/cygwin.h: Add prototypes for `cygwin_logon_user' and
        `cygwin_set_impersonation_token'.
        include/cygwin/version.h: Bumb API minor version to 22.
@
text
@d114 2
d119 1
a119 1
#define CYGWIN_VERSION_API_MINOR 22
@


1.10
log
@* include/cygwin/version.h: Bump DLL minor version number to 3.
@
text
@d109 5
d117 1
a117 1
#define CYGWIN_VERSION_API_MINOR 21
@


1.9
log
@* include/cygwin/version.h: use decimal, NOT octal
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 2
@


1.8
log
@* syscalls.cc (_cygwin_istext_for_stdio): New, for newlib
* include/cygwin/version.h: Bump API number for detect old
programs using old getc/putc macros
@
text
@d57 2
d70 1
a70 1
#define CYGWIN_VERSION_DLL_OLD_TERMIOS		00005
d79 1
a79 1
  00020)
@


1.7
log
@* include/cygwin/version.h: Bump DLL minor version number to 2.
@
text
@d73 7
d106 1
d110 1
a110 1
#define CYGWIN_VERSION_API_MINOR 20
@


1.6
log
@* shared.h: Bump PROC_MAGIC.
* include/cygwin/version.h: Bump API minor to accomodate two recent exports.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 1
@


1.5
log
@        * include/cygwin/version.h: Bump minor api to reflect export change.
@
text
@d98 1
d102 1
a102 1
#define CYGWIN_VERSION_API_MINOR 19
@


1.4
log
@Bump minor version.
@
text
@d97 1
d101 1
a101 1
#define CYGWIN_VERSION_API_MINOR 18
@


1.3
log
@Throughout use strace class in place of individual functions and variables.
* cygwin.din: Eliminate _strace_wm.
* sigproc.cc (wait_sig): Temporarily add more debugging output.
* include/cygwin/version.h: Bump minor api to reflect export change.
@
text
@d47 1
a47 1
#define CYGWIN_VERSION_DLL_MINOR 0
@


1.2
log
@Bump minor version number
@
text
@d96 1
d100 1
a100 1
#define CYGWIN_VERSION_API_MINOR 17
@


1.1
log
@Initial revision
@
text
@d95 1
d99 1
a99 1
#define CYGWIN_VERSION_API_MINOR 16
@


1.1.1.1
log
@import winsup-2000-02-17 snapshot
@
text
@@
