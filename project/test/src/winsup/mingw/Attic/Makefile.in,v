head	1.94;
access;
symbols
	cygwin-1_7_17-release:1.93
	cygwin-64bit-branch:1.93.0.2
	cygwin-1_7_16-release:1.93
	cygwin-1_7_15-release:1.93
	cygwin-1_7_14_2-release:1.93
	cygwin-1_7_14-release:1.93
	cygwin-1_7_12-release:1.93
	cygwin-1_7_11-release:1.93
	cygwin-1_7_10-release:1.93
	cygwin-1_7_9-release:1.92
	cygwin-1_7_8-release:1.92
	cygwin-1_7_7-release:1.92
	cygwin-1_7_5-release:1.92
	cygwin-1_7_4-release:1.92
	cygwin-1_7_3-release:1.92
	cygwin-1_7_2-release:1.92
	cygwin-1_7_1-release:1.90
	cv-branch-2:1.88.0.2
	cr-0x5f1:1.63.0.4
	cv-branch:1.63.0.2
	cr-0x3b58:1.58.0.2
	cr-0x9e:1.43.0.4
	cr-0x9d:1.43.0.2
	corinna-01:1.43
	cr-0x9c:1.41.0.6
	cr-0x9b:1.41.0.4
	cr-0x99:1.41
	Z-emcb-cygwin_daemon:1.41.0.2
	w32api-2_2:1.33
	mingw-runtime-2_4:1.33
	mingw-std-ns-branch:1.29.0.2
	mingw-runtime-2_0:1.24
	mingwex:1.19.0.10
	cygnus_cvs_20020108_pre:1.19
	Z-cygwin_daemon_merge-new_HEAD:1.17
	Z-cygwin_daemon_merge_HEAD:1.17
	cygwin_daemon:1.17.0.2;
locks; strict;
comment	@# @;
expand	@o@;


1.94
date	2012.11.07.16.52.13;	author cgf;	state dead;
branches;
next	1.93;

1.93
date	2011.05.23.03.02.16;	author ironhead;	state Exp;
branches;
next	1.92;

1.92
date	2010.02.17.02.41.06;	author ironhead;	state Exp;
branches;
next	1.91;

1.91
date	2010.01.25.22.58.03;	author ironhead;	state Exp;
branches;
next	1.90;

1.90
date	2009.10.29.21.53.03;	author cwilson;	state Exp;
branches;
next	1.89;

1.89
date	2009.07.27.20.27.09;	author keithmarshall;	state Exp;
branches;
next	1.88;

1.88
date	2008.10.28.23.55.39;	author keithmarshall;	state Exp;
branches;
next	1.87;

1.87
date	2008.10.12.23.58.17;	author cgf;	state Exp;
branches;
next	1.86;

1.86
date	2008.10.11.21.59.04;	author keithmarshall;	state Exp;
branches;
next	1.85;

1.85
date	2008.09.24.00.59.03;	author ironhead;	state Exp;
branches;
next	1.84;

1.84
date	2008.09.07.02.07.29;	author ironhead;	state Exp;
branches;
next	1.83;

1.83
date	2008.07.28.22.57.43;	author keithmarshall;	state Exp;
branches;
next	1.82;

1.82
date	2008.04.26.11.39.14;	author ironhead;	state Exp;
branches;
next	1.81;

1.81
date	2008.02.02.14.14.49;	author ironhead;	state Exp;
branches;
next	1.80;

1.80
date	2007.11.27.02.14.19;	author ironhead;	state Exp;
branches;
next	1.79;

1.79
date	2007.08.03.22.51.23;	author ironhead;	state Exp;
branches;
next	1.78;

1.78
date	2007.07.23.21.32.35;	author keithmarshall;	state Exp;
branches;
next	1.77;

1.77
date	2007.06.13.08.26.13;	author dannysmith;	state Exp;
branches;
next	1.76;

1.76
date	2007.06.13.07.50.18;	author dannysmith;	state Exp;
branches;
next	1.75;

1.75
date	2007.04.07.10.16.52;	author ironhead;	state Exp;
branches;
next	1.74;

1.74
date	2007.04.05.20.44.29;	author ironhead;	state Exp;
branches;
next	1.73;

1.73
date	2007.03.21.00.24.25;	author ironhead;	state Exp;
branches;
next	1.72;

1.72
date	2007.03.20.23.19.34;	author keithmarshall;	state Exp;
branches;
next	1.71;

1.71
date	2007.03.11.00.15.00;	author keithmarshall;	state Exp;
branches;
next	1.70;

1.70
date	2007.02.14.23.42.06;	author dannysmith;	state Exp;
branches;
next	1.69;

1.69
date	2006.11.25.15.55.05;	author keithmarshall;	state Exp;
branches;
next	1.68;

1.68
date	2006.11.21.09.30.13;	author dannysmith;	state Exp;
branches;
next	1.67;

1.67
date	2006.11.18.22.26.49;	author ironhead;	state Exp;
branches;
next	1.66;

1.66
date	2006.10.04.12.52.42;	author corinna;	state Exp;
branches;
next	1.65;

1.65
date	2006.09.11.16.06.35;	author cgf;	state Exp;
branches;
next	1.64;

1.64
date	2006.08.30.13.05.05;	author corinna;	state Exp;
branches;
next	1.63;

1.63
date	2006.07.03.10.32.58;	author dannysmith;	state Exp;
branches;
next	1.62;

1.62
date	2006.06.26.01.41.48;	author ironhead;	state Exp;
branches;
next	1.61;

1.61
date	2006.06.12.21.43.11;	author dannysmith;	state Exp;
branches;
next	1.60;

1.60
date	2006.02.13.13.33.07;	author earnie;	state Exp;
branches;
next	1.59;

1.59
date	2006.01.19.00.32.21;	author ironhead;	state Exp;
branches;
next	1.58;

1.58
date	2005.10.27.21.21.57;	author ironhead;	state Exp;
branches;
next	1.57;

1.57
date	2005.08.13.12.52.41;	author ironhead;	state Exp;
branches;
next	1.56;

1.56
date	2005.01.13.19.51.02;	author earnie;	state Exp;
branches;
next	1.55;

1.55
date	2005.01.03.16.32.25;	author earnie;	state Exp;
branches;
next	1.54;

1.54
date	2005.01.02.17.17.17;	author earnie;	state Exp;
branches;
next	1.53;

1.53
date	2004.09.05.13.51.33;	author earnie;	state Exp;
branches;
next	1.52;

1.52
date	2004.07.17.04.31.14;	author cgf;	state Exp;
branches;
next	1.51;

1.51
date	2004.07.15.10.40.36;	author corinna;	state Exp;
branches;
next	1.50;

1.50
date	2004.07.14.23.44.49;	author dannysmith;	state Exp;
branches;
next	1.49;

1.49
date	2004.07.13.11.23.08;	author earnie;	state Exp;
branches;
next	1.48;

1.48
date	2004.07.13.11.04.23;	author earnie;	state Exp;
branches;
next	1.47;

1.47
date	2004.04.22.16.27.00;	author earnie;	state Exp;
branches;
next	1.46;

1.46
date	2004.04.22.16.16.24;	author earnie;	state Exp;
branches;
next	1.45;

1.45
date	2004.04.19.17.01.27;	author earnie;	state Exp;
branches;
next	1.44;

1.44
date	2004.03.19.09.26.13;	author dannysmith;	state Exp;
branches;
next	1.43;

1.43
date	2003.10.10.18.25.10;	author earnie;	state Exp;
branches;
next	1.42;

1.42
date	2003.09.15.15.21.53;	author earnie;	state Exp;
branches;
next	1.41;

1.41
date	2003.06.18.13.54.46;	author earnie;	state Exp;
branches;
next	1.40;

1.40
date	2003.05.15.00.21.12;	author dannysmith;	state Exp;
branches;
next	1.39;

1.39
date	2003.05.07.03.12.17;	author earnie;	state Exp;
branches;
next	1.38;

1.38
date	2003.05.06.16.04.24;	author earnie;	state Exp;
branches;
next	1.37;

1.37
date	2003.05.05.16.04.11;	author earnie;	state Exp;
branches;
next	1.36;

1.36
date	2003.02.25.13.07.46;	author earnie;	state Exp;
branches;
next	1.35;

1.35
date	2003.02.21.21.12.29;	author earnie;	state Exp;
branches;
next	1.34;

1.34
date	2003.02.20.10.12.15;	author corinna;	state Exp;
branches;
next	1.33;

1.33
date	2003.02.08.14.58.31;	author earnie;	state Exp;
branches;
next	1.32;

1.32
date	2003.01.01.10.00.39;	author dannysmith;	state Exp;
branches;
next	1.31;

1.31
date	2002.12.20.15.40.10;	author earnie;	state Exp;
branches;
next	1.30;

1.30
date	2002.10.19.20.26.26;	author dannysmith;	state Exp;
branches;
next	1.29;

1.29
date	2002.09.05.14.27.28;	author earnie;	state Exp;
branches
	1.29.2.1;
next	1.28;

1.28
date	2002.08.28.03.57.16;	author dannysmith;	state Exp;
branches;
next	1.27;

1.27
date	2002.08.21.12.18.27;	author earnie;	state Exp;
branches;
next	1.26;

1.26
date	2002.08.20.22.56.59;	author dannysmith;	state Exp;
branches;
next	1.25;

1.25
date	2002.06.15.15.56.57;	author earnie;	state Exp;
branches;
next	1.24;

1.24
date	2002.06.15.14.06.21;	author earnie;	state Exp;
branches;
next	1.23;

1.23
date	2002.06.13.10.20.41;	author dannysmith;	state Exp;
branches;
next	1.22;

1.22
date	2002.04.09.23.47.00;	author earnie;	state Exp;
branches;
next	1.21;

1.21
date	2002.04.09.22.22.17;	author earnie;	state Exp;
branches;
next	1.20;

1.20
date	2002.03.26.22.23.23;	author dannysmith;	state Exp;
branches;
next	1.19;

1.19
date	2001.12.07.21.38.03;	author earnie;	state Exp;
branches
	1.19.10.1;
next	1.18;

1.18
date	2001.11.05.13.16.41;	author duda;	state Exp;
branches;
next	1.17;

1.17
date	2001.09.19.15.37.18;	author earnie;	state Exp;
branches;
next	1.16;

1.16
date	2001.09.17.12.38.45;	author earnie;	state Exp;
branches;
next	1.15;

1.15
date	2001.09.06.00.45.51;	author cgf;	state Exp;
branches;
next	1.14;

1.14
date	2001.09.05.23.26.38;	author cgf;	state Exp;
branches;
next	1.13;

1.13
date	2001.06.04.20.01.09;	author earnie;	state Exp;
branches;
next	1.12;

1.12
date	2001.01.31.22.17.17;	author earnie;	state Exp;
branches;
next	1.11;

1.11
date	2000.11.29.21.14.48;	author earnie;	state Exp;
branches;
next	1.10;

1.10
date	2000.11.22.23.43.23;	author earnie;	state Exp;
branches;
next	1.9;

1.9
date	2000.11.22.01.51.53;	author earnie;	state Exp;
branches;
next	1.8;

1.8
date	2000.11.21.00.00.05;	author cgf;	state Exp;
branches;
next	1.7;

1.7
date	2000.11.20.01.52.26;	author cgf;	state Exp;
branches;
next	1.6;

1.6
date	2000.06.18.01.53.10;	author cgf;	state Exp;
branches;
next	1.5;

1.5
date	2000.06.18.01.49.23;	author cgf;	state Exp;
branches;
next	1.4;

1.4
date	2000.06.17.22.28.52;	author cgf;	state Exp;
branches;
next	1.3;

1.3
date	2000.06.17.17.48.36;	author cgf;	state Exp;
branches;
next	1.2;

1.2
date	2000.03.31.04.43.46;	author khan;	state Exp;
branches;
next	1.1;

1.1
date	2000.02.17.19.38.31;	author cgf;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2000.02.17.19.38.31;	author cgf;	state Exp;
branches;
next	;

1.19.10.1
date	2002.03.22.22.43.15;	author dannysmith;	state Exp;
branches;
next	1.19.10.2;

1.19.10.2
date	2002.03.26.22.42.56;	author dannysmith;	state Exp;
branches;
next	1.19.10.3;

1.19.10.3
date	2002.04.10.22.49.09;	author dannysmith;	state Exp;
branches;
next	1.19.10.4;

1.19.10.4
date	2002.04.16.09.02.22;	author dannysmith;	state Exp;
branches;
next	1.19.10.5;

1.19.10.5
date	2002.04.17.05.37.05;	author dannysmith;	state Exp;
branches;
next	1.19.10.6;

1.19.10.6
date	2002.04.29.02.38.21;	author dannysmith;	state Exp;
branches;
next	;

1.29.2.1
date	2002.11.19.08.47.43;	author dannysmith;	state Exp;
branches;
next	1.29.2.2;

1.29.2.2
date	2003.01.26.22.37.50;	author dannysmith;	state Exp;
branches;
next	1.29.2.3;

1.29.2.3
date	2003.03.31.22.32.19;	author dannysmith;	state Exp;
branches;
next	;


desc
@@


1.94
log
@* mingw: Delete obsolete directory.
* w32api: Ditto.
@
text
@# Makefile.in for the winsup/mingw directory.
# Copyright (c) 1995-2008, 1996, 1997, 1998 Cygnus Solutions

# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.

# This makefile requires GNU make.

PACKAGE = @@PACKAGE_TARNAME@@
VERSION = @@PACKAGE_VERSION@@
CYGRELEASE = 1

VPATH = @@srcdir@@
srcdir = @@srcdir@@
top_srcdir = @@top_srcdir@@
top_builddir = @@top_builddir@@

# FIXME: I see no reason to define `objdir';
# it appears to be unused, and could be removed.
objdir = .

host_alias = @@host_alias@@
build_alias = @@build_alias@@
target_alias = @@target_alias@@
with_cross_host = @@with_cross_host@@
prefix = @@prefix@@
conf_prefix = @@prefix@@
host_os = @@host_os@@

datarootdir = @@datarootdir@@
program_transform_name = @@program_transform_name@@
exec_prefix = @@exec_prefix@@
bindir = @@bindir@@
libdir = @@libdir@@

ifneq (,$(findstring cygwin,$(target_alias)))
# 
# FIXME: What is the purpose of such logic, testing `target_alias'?
#
# Firstly, there is no code generator being built here.  The concept
# of `target' is meaningless, and there is no valid reason to expect
# that `target_alias' would be anything other than an empty string.
# Thus, the validity of such tests is extremely suspect.
#
# Secondly, the decisions being taken, on the basis of these tests,
# rightfully belong in the configure script; all this logic should be
# removed, and properly implemented in `configure.in'.
#
mandir = $(prefix)/share/man
mansection = mingw
else
mandir = @@mandir@@
mansection = 3
endif
manpage_transform = @@mingw_manpage_transform@@
ifeq ($(target_alias),$(host_alias))
ifeq ($(build_alias),$(host_alias))
tooldir:=$(exec_prefix)
else
tooldir:=$(exec_prefix)/$(target_alias)
endif
else
tooldir:=$(exec_prefix)/$(target_alias)
endif
datadir = @@datadir@@
infodir = @@infodir@@
includedir = @@includedir@@
ifneq (,$(findstring cygwin,$(target_alias)))
#
# FIXME: Doubtful use of `target_alias', again.
#
# Here we not only have a dubious test, based on `target_alias',
# but we also assign local alternatives for the standard autoconf
# installation path macros.  This should not be necessary; the
# configure script should simply assign appropriate values to
# the standard macros, which should be used herein.
#
inst_bindir:=$(tooldir)/bin
inst_includedir:=$(tooldir)/include/mingw
inst_libdir:=$(tooldir)/lib/mingw
inst_docdir:=$(tooldir)/share/doc/mingw-runtime
need-DESTDIR-compatibility = prefix exec_prefix tooldir mandir
else
ifneq (,$(with_cross_host))
#
# FIXME: What is the intended purpose of `with_cross_host'?
#
# Notwithstanding that this conforms to no known standard, and
# is completely undocumented, it does not belong here; every one
# of these settings is the prerogative of the configure script,
# and they should use standard names, as noted above.
#
inst_bindir:=$(tooldir)/bin
inst_includedir:=$(tooldir)/include
inst_libdir:=$(tooldir)/lib
inst_docdir:=$(tooldir)/share/doc/mingw-runtime
need-DESTDIR-compatibility = prefix exec_prefix tooldir mandir
else
inst_bindir:=$(bindir)
inst_includedir:=$(includedir)
inst_libdir:=$(libdir)
inst_docdir:=$(prefix)/doc/runtime
need-DESTDIR-compatibility = prefix bindir includedir libdir mandir
endif
endif

# The Mingw headers are installed under a subdirectory of
# $(tooldir)/include when configuring in Cygwin.
HEADER_SUBDIR = @@HEADER_SUBDIR@@

SHELL = /bin/sh

INSTALL = @@INSTALL@@
INSTALL_DATA = @@INSTALL_DATA@@
INSTALL_PROGRAM = @@INSTALL_PROGRAM@@
mkinstalldirs = $(SHELL) @@MKINSTALLDIRS@@

CC := @@CC@@
ifneq (,$(findstring cygwin,$(target_alias)))
#
# FIXME: What is the purpose of this hideous kludge?
#
# Again, we have a dubious use of `target_alias'.  Worse, `CC'
# should have been appropriately set by the configure script; to
# mess with it, in this fashion, should neither be necessary,
# nor accepted.
#
override CC := ${filter-out -L% -B%,${shell echo $(CC) | sed -e 's%\(-isystem\|-iwithprefixbefore\)  *[^ ]*\( \|$$\)% %g'}}
endif
# FIXME: Which is it, CC or CC_FOR_TARGET?
CC_FOR_TARGET = $(CC)
AS_FOR_TARGET = $(AS)
CFLAGS = @@CFLAGS@@
CXXFLAGS = @@CXXFLAGS@@

# compiling with Cygwin?
NO_CYGWIN := @@NO_CYGWIN@@
ifdef NO_CYGWIN
#
# FIXME: Again, this should have been resolved by `configure',
# and this kludge should be unnecessary.
#
override CC := ${NO_CYGWIN} $(firstword ${CC})
endif

# Either crtdll (CRT_ID 1) or msvcrt (CRT_ID 2).
RUNTIME = @@RUNTIME@@
CRT_ID = @@CRT_ID@@

# Needed for threading dll.
THREAD_DLL = @@THREAD_DLL@@
THREAD_DLL_VERSION = 10
THREAD_DLL_NAME = $(THREAD_DLL)$(THREAD_DLL_VERSION).dll

# Various libraries.
LIBM_A=@@LIBM_A@@

W32API_INCLUDE = @@W32API_INCLUDE@@
INCLUDES = -I$(srcdir)/include \
  -I$(srcdir)/../include \
  -nostdinc \
  -iwithprefixbefore include
ALL_CFLAGS = $(CFLAGS) $(INCLUDES) $(W32API_INCLUDE)
ALL_CXXFLAGS = $(CXXFLAGS) $(INCLUDES) -nostdinc++ $(W32API_INCLUDE)

AS = @@AS@@
AR = @@AR@@
LD = @@LD@@
AR_FLAGS = rcv
RANLIB = @@RANLIB@@
DLLTOOL = @@DLLTOOL@@
DLLTOOLFLAGS =
DLLTOOL_FOR_TARGET = $(DLLTOOL)
DLLTOOL_FLAGS = --as $(AS_FOR_TARGET)
DLLWRAP = @@DLLWRAP@@
DLLWRAP_FOR_TARGET = $(DLLWRAP)
DLLWRAP_FLAGS = --dlltool $(DLLTOOL) --as $(AS) --driver-name $(CC)
OBJCOPY = @@OBJCOPY@@
NM = @@NM@@

TAR = tar
TARFLAGS = z
TARFILEEXT = .tar.gz

SUBDIRS = mingwex profile

# FIXME: Most of these are either redundant, or should be set
# directly in the subdirectories' Makefiles, by `configure'.
FLAGS_TO_PASS:=\
	AS="$(AS)" \
	CC="$(CC)" \
	CFLAGS="$(CFLAGS) $(CFLAGS_COMMON) $(CFLAGS_CONFIG)" \
	CXXFLAGS="$(CXXFLAGS) $(CFLAGS_COMMON) $(CFLAGS_CONFIG)" \
	EXE_LDFLAGS="$(EXE_LDFLAGS)" \
	AR="$(AR)" \
	RANLIB="$(RANLIB)" \
	LD="$(LD)" \
	DLLTOOL="$(DLLTOOL)" \
	exec_prefix="$(exec_prefix)" \
	bindir="$(bindir)" \
	libdir="$(libdir)" \
	tooldir="$(tooldir)" \
	datadir="$(datadir)" \
	infodir="$(infodir)" \
	includedir="$(includedir)" \
	inst_bindir="$(inst_bindir)" \
	inst_includedir="$(inst_includedir)" \
	inst_libdir="$(inst_libdir)" \
	inst_docdir="$(inst_docdir)" \
	prefix="$(prefix)" \
	target_alias="$(target_alias)" \
	TAR="$(TAR)" \
	TARFLAGS="$(TARFLAGS)" \
	TARFILEEXT="$(TARFILEEXT)"

CRT0S = crt1.o dllcrt1.o crt2.o dllcrt2.o CRT_noglob.o crtmt.o crtst.o \
	CRT_fp8.o CRT_fp10.o txtmode.o binmode.o
MINGW_OBJS = CRTglob.o CRTfmode.o CRTinit.o  dllmain.o gccmain.o \
	     main.o crtst.o CRT_fp10.o txtmode.o \
	     pseudo-reloc.o pseudo-reloc-list.o cpu_features.o \
	     tlsmcrt.o tlsmthread.o tlssup.o tlsthrd.o

MOLD_OBJS = isascii.o iscsym.o iscsymf.o toascii.o \
	strcasecmp.o strncasecmp.o wcscmpi.o

LIBS = libcrtdll.a \
       libmsvcrt.a  libmsvcrtd.a \
       libmsvcr70.a libmsvcr70d.a \
       libmsvcr71.a libmsvcr71d.a \
       libmsvcr80.a libmsvcr80d.a \
       libmsvcr90.a libmsvcr90d.a \
       libmsvcr100.a libmsvcr100d.a \
       libmingw32.a \
       libcoldname.a \
       libmoldname.a   libmoldnamed.a \
       libmoldname70.a libmoldname70d.a \
       libmoldname71.a libmoldname71d.a \
       libmoldname80.a libmoldname80d.a \
       libmoldname90.a libmoldname90d.a \
       libmoldname100.a libmoldname100d.a \
       $(LIBM_A) \
       libmingwthrd_old.a \
       libmingwthrd.a

DLLS = $(THREAD_DLL_NAME)

INSTDOCS = CONTRIBUTORS \
	   DISCLAIMER \
	   README

SRCDIST_FILES = CRT_noglob.c CRTfmode.c CRTglob.c CRTinit.c ChangeLog \
Makefile.in README TODO config.guess config.sub configure configure.in \
aclocal.m4 crt1.c crtdll.def crtmt.c crtst.c  dllcrt1.c dllmain.c \
gccmain.c init.c install-sh jamfile main.c mkinstalldirs \
moldname.def.in msvcrt.def.in ofmt_stub.s \
mthr.c mthr_init.c tlsmcrt.c tlsmthread.c tlssup.c tlsthrd.c readme.txt \
isascii.c iscsym.c iscsymf.c toascii.c \
strcasecmp.c strncasecmp.c wcscmpi.c \
CRT_fp8.c CRT_fp10.c test_headers.c txtmode.c binmode.c pseudo-reloc.c \
pseudo-reloc-list.c cpu_features.c cpu_features.h \
DISCLAIMER CONTRIBUTORS


all_dlls_host = @@all_dlls_host@@
install_dlls_host = @@install_dlls_host@@

all: $(CRT0S) $(LIBS) $(all_dlls_host)

all_dlls_host: $(DLLS)

install_dlls_host:
	for i in $(DLLS); do \
		$(INSTALL_PROGRAM) $$i $(DESTDIR)$(inst_bindir)/$$i ; \
	done

_libm_dummy.o:
	rm -f _libm_dummy.c
	echo "static int __mingw_libm_dummy;" > _libm_dummy.c
	$(CC) -c $(ALL_CFLAGS) _libm_dummy.c
	rm -f _libm_dummy.c

libm.a: _libm_dummy.o
	$(AR) rc $@@ _libm_dummy.o
	$(RANLIB) $@@

libmingwthrd.a: crtmt.o
	$(AR) $(ARFLAGS) $@@ crtmt.o
	$(RANLIB) $@@

libmingwthrd_old.a: crtmt.o mingwthrd.def
	$(DLLTOOL) $(DLLTOOL_FLAGS) --dllname $(THREAD_DLL_NAME) \
	  --def mingwthrd.def --output-lib $@@
	$(AR) $(ARFLAGS) $@@ crtmt.o
	$(RANLIB) $@@

DLL_OFILES        = mthr.o mthr_init.o
DLL_CC_STUFF      = -B./ -shared $(MNO_CYGWIN) -Wl,--image-base,0x6FBC0000 \
		    -Wl,--entry,_DllMainCRTStartup@@12 \
                    $(DLL_OFILES) mingwthrd.def \
		    -Lmingwex

$(THREAD_DLL_NAME) mingwthrd.def: $(DLL_OFILES) Makefile $(SUBDIRS)
	$(DLLTOOL) --as $(AS) --output-def mingwthrd.def $(DLL_OFILES)
	$(CC) $(DLL_CC_STUFF) -o $(THREAD_DLL_NAME)

libmingw32.a: $(MINGW_OBJS)
	$(AR) rc $@@ $(MINGW_OBJS)
	$(RANLIB) $@@

msvcrt.def  msvcrtd.def \
msvcr70.def msvcr70d.def \
msvcr71.def msvcr71d.def \
msvcr80.def msvcr80d.def \
msvcr90.def msvcr90d.def \
msvcr100.def msvcr100d.def: msvcrt.def.in
	V=`echo $@@ | sed -e 's|[a-z]*\([0-9]*\).*|\1|'`; \
	test -z "$$V" && V=60; \
	V="0x0$${V}0"; \
	$(CC) -DRUNTIME=$(basename $(notdir $@@)) \
		-D__MSVCRT_VERSION__=$$V \
		-D__$(basename $(notdir $@@))__=1 \
		-D__MSVCRT__ -C -E -P \
		-xc-header $? > $@@

moldname-crtdll.def: moldname.def.in
	$(CC) -DRUNTIME=crtdll \
		-D__FILENAME__=moldname-crtdll.def \
		-D__CRTDLL__  -C -E -P \
		-xc-header $? > $@@

moldname-msvcrt.def: moldname.def.in
	$(CC) -DRUNTIME=msvcrt \
		-D__FILENAME__=moldname-msvcrt.def \
		-D__MSVCRT__  -C -E -P \
		-xc-header $? > $@@

libcoldname.a: moldname-crtdll.def $(MOLD_OBJS)
	$(DLLTOOL) --as $(AS) -k -U	\
		--dllname crtdll.dll	\
		--def moldname-crtdll.def	\
		--output-lib $@@
	$(AR) rc $@@ $(MOLD_OBJS)
	$(RANLIB) $@@

libmoldname.a libmoldnamed.a: moldname-msvcrt.def $(MOLD_OBJS)
	$(DLLTOOL) --as $(AS) -k -U	\
		--dllname msvcrt$(@@:libmoldname%a=%)dll \
		--def moldname-msvcrt.def	\
		--output-lib $@@
	$(AR) rc $@@ $(MOLD_OBJS)
	$(RANLIB) $@@

libmoldname70.a libmoldname70d.a \
libmoldname71.a libmoldname71d.a \
libmoldname80.a libmoldname80d.a \
libmoldname90.a libmoldname90d.a \
libmoldname100.a libmoldname100d.a: moldname-msvcrt.def $(MOLD_OBJS)
	$(DLLTOOL) --as $(AS) -k -U	\
		--dllname msvcr$(@@:libmoldname%a=%)dll  \
		--def moldname-msvcrt.def	\
		--output-lib $@@
	$(AR) rc $@@ $(MOLD_OBJS)
	$(RANLIB) $@@

# These special rules are necessary...
#
crt1.o dllcrt1.o:
	$(CC) -c -D__CRTDLL__ -U__MSVCRT__ $(ALL_CFLAGS) $< -o $@@

crt2.o dllcrt2.o:
	$(CC) -c -D__MSVCRT__ -U__CRTDLL__ $(ALL_CFLAGS) $< -o $@@

check: check-headers

TEST_H_OPTIONS = $(ALL_CFLAGS) -Wall -W -Wsystem-headers -c \
	$(srcdir)/test_headers.c -o test_headers.o

.PHONY: check-headers
check-headers: force
	@@echo "Testing runtime headers..."
	@@for lang in c c++ objective-c ; do \
		echo "$$lang ..."; \
		$(CC) -x$$lang  $(TEST_H_OPTIONS) ; \
		echo "$$lang -ansi"; \
		$(CC) -x$$lang -ansi $(TEST_H_OPTIONS) ; \
	done
	@@echo; echo "Testing runtime 8.0 headers..."
	@@for lang in c c++ objective-c ; do \
		echo "$$lang ..."; \
		$(CC) -x$$lang -Wall -D__MSVCRT_VERSION__=0x0800 $(TEST_H_OPTIONS) ; \
		echo "$$lang -ansi"; \
		$(CC) -x$$lang -Wall -D__MSVCRT_VERSION__=0x0800 -ansi $(TEST_H_OPTIONS) ; \
	done
	@@echo; echo "Testing runtime 8.0(time32) headers..."
	@@for lang in c c++ objective-c ; do \
		echo "$$lang ..."; \
		$(CC) -x$$lang -Wall -D__MSVCRT_VERSION__=0x0800 -D_USE_32BIT_TIME_T $(TEST_H_OPTIONS) ; \
		echo "$$lang -ansi"; \
		$(CC) -x$$lang -Wall -D__MSVCRT_VERSION__=0x0800 -D_USE_32BIT_TIME_T -ansi $(TEST_H_OPTIONS) ; \
	done
	@@echo; echo "Testing runtime 8.0(time32) headers..."
# specify -std=xx only for C
	@@for std in gnu89 gnu99 c89 c99 ; do \
		echo "std = $$std"; \
		$(CC) -std=$$std  $(TEST_H_OPTIONS) ; \
	done

	@@rm -f test_headers.o

clean:
	-rm -f *.o *.a *~ core a.out mingwthrd.def mingwthrd.base mingwthrd.exp
	-rm -f $(THREAD_DLL_NAME) mingwthrd_dummy.exe
	-rm -f msvcr*.def moldname-*.def
	@@$(MAKE) subdirs DO=$@@ $(FLAGS_TO_PASS)

distclean: clean
	@@$(MAKE) subdirs DO=$@@ $(FLAGS_TO_PASS)
	-rm -f config.cache config.status config.log
	-rm -f Makefile

ifdef SNAPDATE
      distdir=$(PACKAGE)-$(VERSION)-$(SNAPDATE)
else
   ifneq (,$(findstring cygwin, $(target_alias)))
      distdir=$(PACKAGE)-$(VERSION)-$(CYGRELEASE)
   else
      distdir=$(PACKAGE)-$(VERSION)-$(host_os)
   endif
endif

ifneq (,$(findstring cygwin, $(target_alias)))
#
# FIXME: Dubious use of `target_alias', yet again.
#
# Once more, the default settings for these macros could be
# more productively determined by `configure'.
#
  TARFLAGS = j
  TARFILEEXT = .tar.bz2
  dist_prefix = $(conf_prefix)
endif

dist: srcdist bindist

srcdist:
	rm -rf $(distdir)
	mkdir $(distdir)
	chmod 755 $(distdir)
	for i in $(SRCDIST_FILES); do \
		cp -p $(srcdir)/$$i $(distdir)/$$i ; \
	done
	for i in $(SUBDIRS); do \
		(cd $$i; $(MAKE) distdir=../$(distdir) dist); \
	done
#FIXME this needs to be done with SUBDIRS and Makefiles.
#
#  Maybe, but this is simpler, and adequate for now!
#  However, as more manpages are added, spanning multiple sections,
#  we'll probably need a separate Makefile to organise them.
#
	mkdir $(distdir)/include
	mkdir $(distdir)/include/sys
	cp $(srcdir)/include/*.h $(distdir)/include/
	cp $(srcdir)/include/sys/*.h $(distdir)/include/sys/
	mkdir $(distdir)/man
	cp $(srcdir)/man/*.man $(distdir)/man/
#
#end FIXME
	rm -f $(distdir)-src.tar.gz
	$(TAR) $(TARFLAGS)cf $(distdir)-src$(TARFILEEXT) $(distdir)

# Binary package structure is determined according to the
# preferred package name assigned at configure time...
#
bindist: bindist-$(PACKAGE)

# The directory structure is common to both package styles...
#
bindist-common:
	rm -rf $(distdir)
	mkdir $(distdir)
	chmod 755 $(distdir)
	$(MAKE) install prefix=$(shell pwd)/$(distdir)$(dist_prefix)
	rm -f $(distdir).tar.gz

# Current MinGW distributions prefer separate `dev' and `dll' bundles,
# and use the abbreviated `mingwrt' form for the package name...
#
DEVDIST_FILES = * --exclude=bin
DLLDIST_FILES = bin/*.dll doc/*
#
bindist-mingwrt: bindist-common
	cd $(distdir); \
	$(TAR) $(TARFLAGS)cf ../$(distdir)-dev$(TARFILEEXT) $(DEVDIST_FILES); \
	$(TAR) $(TARFLAGS)cf ../$(distdir)-dll$(TARFILEEXT) $(DLLDIST_FILES)
	rm -rf $(distdir)

# However, Cygwin maintainers continue to prefer a composite package,
# retaining the older `mingw-runtime' naming convention...
#
BINDIST_FILES = *
#
bindist-mingw-runtime: bindist-common
	cd $(distdir); \
	$(TAR) $(TARFLAGS)cf ../$(distdir)$(TARFILEEXT) $(BINDIST_FILES)
	rm -rf $(distdir)

snapshot:
	make dist SNAPDATE=$(shell date '+%Y%m%d')

info:

info-html:

install-info: info

.PHONY: $(need-DESTDIR-compatibility) fail-DESTDIR-compatibility

$(need-DESTDIR-compatibility):
	@@test -z "$(DESTDIR)" || case "$($@@)" in ?:*) \
	  $(MAKE) --no-print-directory reject="$@@" fail-DESTDIR-compatibility ;; \
	esac

fail-DESTDIR-compatibility:
	$(error DESTDIR is not supported when $(reject) contains Win32 path `$($(reject))'; \
	try `make install $(reject)=$(shell echo '$($(reject))' | sed s,:,:$(DESTDIR),) ...' instead)

install-dirs: $(need-DESTDIR-compatibility)
	$(mkinstalldirs) $(DESTDIR)$(inst_bindir)
	$(mkinstalldirs) $(DESTDIR)$(inst_includedir)
	$(mkinstalldirs) $(DESTDIR)$(inst_libdir)
	$(mkinstalldirs) $(DESTDIR)$(inst_docdir)
	$(mkinstalldirs) $(DESTDIR)$(mandir)/man$(mansection)

install: all install-dirs $(install_dlls_host)
	for i in $(LIBS); do \
		$(INSTALL_DATA) $$i $(DESTDIR)$(inst_libdir)/$$i ; \
	done
	for i in $(CRT0S); do \
		$(INSTALL_DATA) $$i $(DESTDIR)$(inst_libdir)/$$i ; \
	done
	for i in $(INSTDOCS); do \
		$(INSTALL_DATA) $(srcdir)/$$i $(DESTDIR)$(inst_docdir)/$$i ; \
	done
	for sub in . sys ; do \
		dstdir=$(DESTDIR)$(inst_includedir)/$$sub ; \
		$(mkinstalldirs) $$dstdir ; \
		for i in $(srcdir)/include/$$sub/*.h ; do \
		  $(INSTALL_DATA) $$i $$dstdir/`basename $$i` ; \
		done ; \
	done
#
# This provisional hack installs the only manpage we have at present...
# It simply CANNOT suffice, when we have more manpages to ship.
#
	$(mkinstalldirs) $(DESTDIR)$(mandir)/man$(mansection)
	$(INSTALL_DATA) $(srcdir)/man/dirname.man $(DESTDIR)$(mandir)/man$(mansection)/`\
	  echo dirname.man|sed '$(manpage_transform);s,man$$,$(mansection),'`
	$(INSTALL_DATA) $(srcdir)/man/dirname.man $(DESTDIR)$(mandir)/man$(mansection)/`\
	  echo basename.man|sed '$(manpage_transform);s,man$$,$(mansection),'`
#
# End provisional hack.
#
	@@$(MAKE) subdirs DO=$@@ $(FLAGS_TO_PASS)

subdirs: $(SUBDIRS)
$(SUBDIRS): force
	@@test -n "$(DO)" && g="$(DO)" || g=all; echo "Making \`$$g' in \`$@@'"
	@@cd $@@; $(MAKE) $(FLAGS_TO_PASS) $(DO)

force:

#
# Dependencies
#
libcrtdll.a: crtdll.def
libmsvcrt.a: msvcrt.def
libmsvcrtd.a: msvcrtd.def
CRT_noglob.o: CRT_noglob.c
CRTfmode.o: CRTfmode.c
CRTglob.o: CRTglob.c
CRTinit.o: CRTinit.c
crt1.o: crt1.c init.c
crt2.o: crt1.c init.c
crtmt.o: crtmt.c
crtst.o: crtst.c
ctype_old.o: ctype_old.c
dllcrt1.o: dllcrt1.c
dllcrt2.o: dllcrt1.c
dllmain.o: dllmain.c
main.o: main.c
oldnames.o: oldnames.c
string_old.o: string_old.c
CRT_fp8.o: CRT_fp8.c
CRT_fp10.o: CRT_fp10.c


Makefile: Makefile.in config.status configure
	$(SHELL) config.status

config.status: configure
	$(SHELL) config.status --recheck

.SUFFIXES: .y $(SUFFIXES) .cc .def .a

sym_prefix = __msvcrt

NM_LOOKUP = $(NM) $@@ | sed -n \
  -e '/:$$/h;/^[0-7][0-7]*  *T  */{s///;H;g;s/\n//p' \
  -e '}' | sed -n 's/:_'"$$key"'$$//p'

MINGW_REPL_FUNCS = printf fprintf sprintf vprintf vfprintf vsprintf

lib%.a: %.def
	$(DLLTOOL) --as=$(AS) -k --dllname $*.dll --output-lib $@@ --def $<
	for key in $(MINGW_REPL_FUNCS); do \
	  src=`$(NM_LOOKUP)`; \
	  if test -n "$$src"; then \
	    dst=`echo "$$src" | sed 's/0/4/'`; repl="$$repl $$dst"; \
	    tmpfiles="$$tmpfiles $$src $$dst"; \
	    $(AR) x $@@ $$src; \
	    $(OBJCOPY) --redefine-sym _$$key=_$(sym_prefix)_$$key \
	      --redefine-sym __imp__$$key=__imp__$(sym_prefix)_$$key \
	      $$src $$dst; \
	  fi; done; \
	test `key=_get_output_format; $(NM_LOOKUP)` || \
	  repl="$$repl ofmt_stub.o"; \
	test -n "$$repl" && $(AR) rcs $@@ $$repl; \
	$(RM) $$tmpfiles

libmsvcrt.a  libmsvcrtd.a:  ofmt_stub.o
libmsvcr70.a libmsvcr70d.a: ofmt_stub.o
libmsvcr71.a libmsvcr71d.a: ofmt_stub.o
libcrtdll.a  libcrtdlld.a:  ofmt_stub.o

.c.o:
	$(CC) -c $(ALL_CFLAGS) $< -o $@@

# $RCSfile$: end of file
@


1.93
log
@2011-05-22  A.B., Khalid  <abkhd@@users.sourceforge.net>

        * Makefile.in: Add support for msvcr100.dll.
        * msvcrt.def.in: Ditto.
@
text
@@


1.92
log
@2010-02-14  Roumen Petrov  <rumen@@users.sourceforge.net>

        Issue [2134161]: time64 functions and types for msvcrt >= 8.0
        (initial implementation)

        * new type: __time32_t

        * new structures: _finddata32_t, _finddata32i64_t, _finddata64i32_t,
        __stat32, _stat32i64, _stat64i32, __timeb32, __utimbuf32,
        __wfinddata32_t, _wfinddata32i64_t, _wfinddata64i32_t

        * new functions: _ctime32, _difftime32, _difftime64, _findfirst32
        _findfirst32i64, _findfirst64i32, _findnext32, _findnext32i64,
        _findnext64i32, _fstat32, _fstat32i64, _fstat64i32, _ftime32,
        _futime32, _gmtime32, _localtime32, _mkgmtime32, _mkgmtime64,
        _mktime32, _stat32, _stat32i64, _stat64i32, _time32, _utime32,
        _wctime32, _wfindfirst32, _wfindfirst32i64, _wfindfirst64i32,
        _wfindnext32, _wfindnext32i64, _wfindnext64i32, _wstat32,
        _wstat32i64, _wstat64i32,_wutime32

        * new define _USE_32BIT_TIME_T set 32 or 64 aliases for: time_t,
        ctime, difftime, _findfirst, _findfirsti64, _findnext, _findnexti64,
        _fstat, _fstati64, _ftime, _futime, gmtime, localtime, mktime,
        _stat, _stati64, time, _utime, _wctime, _wfindfirst, _wfindfirsti64,
        _wfindnext, _wfindnexti64, _wstat, _wstati64, _wutime
@
text
@d243 1
d251 1
d325 2
a326 1
msvcr90.def msvcr90d.def: msvcrt.def.in
d367 2
a368 1
libmoldname90.a libmoldname90d.a: moldname-msvcrt.def $(MOLD_OBJS)
@


1.91
log
@2010-01-25  Kai Tietz  <kai.tietz@@onevision.com>

        Implement TLS Callback.

        * tlsmcrt.c: New file.
        * tlsmthread.c: Ditto.
        * tlssup.c: Ditto.
        * tlsthrd.c: Ditto.
        * Makefile.in: Include new files.
        * crt1.c: Implement TLS Callback.
        * dllcrt1.c: Ditto.
        * mthr_stub.c: Remove.
@
text
@d324 3
d328 1
d394 15
@


1.90
log
@Honor DESTDIR for winsup/mingw and winsup/w32api
@
text
@d230 3
a232 2
	     main.o crtst.o mthr_stub.o CRT_fp10.o txtmode.o \
	     pseudo-reloc.o pseudo-reloc-list.o cpu_features.o
d251 1
d265 1
a265 1
mthr.c mthr_init.c mthr_stub.c readme.txt \
d295 5
a299 1
libmingwthrd.a: crtmt.o mingwthrd.def
@


1.89
log
@Convert to monolithic configuration procedure.
@
text
@d93 1
d108 1
d114 1
d280 1
a280 1
		$(INSTALL_PROGRAM) $$i $(inst_bindir)/$$i ; \
d499 17
a515 6
install-dirs:
	$(mkinstalldirs) $(inst_bindir)
	$(mkinstalldirs) $(inst_includedir)
	$(mkinstalldirs) $(inst_libdir)
	$(mkinstalldirs) $(inst_docdir)
	$(mkinstalldirs) $(mandir)/man$(mansection)
d519 1
a519 1
		$(INSTALL_DATA) $$i $(inst_libdir)/$$i ; \
d522 1
a522 1
		$(INSTALL_DATA) $$i $(inst_libdir)/$$i ; \
d525 1
a525 1
		$(INSTALL_DATA) $(srcdir)/$$i $(inst_docdir)/$$i ; \
d528 1
a528 1
		dstdir=$(inst_includedir)/$$sub ; \
d538 2
a539 2
	$(mkinstalldirs) $(mandir)/man$(mansection)
	$(INSTALL_DATA) $(srcdir)/man/dirname.man $(mandir)/man$(mansection)/`\
d541 1
a541 1
	$(INSTALL_DATA) $(srcdir)/man/dirname.man $(mandir)/man$(mansection)/`\
@


1.88
log
@Correct some binary distribution packaging defects.
@
text
@d20 1
d26 5
d39 1
a39 8
# FIXME: this needs an appropriate AC_SUBST
host_os = mingw32

ifneq (,$(findstring cygwin, $(target_alias)))
PACKAGE = mingw-runtime
else
PACKAGE = mingwrt
endif
d41 1
d46 1
d48 12
d80 9
d95 8
d128 8
d147 4
d193 1
a193 1
SUBDIRS := @@subdirs@@
d195 2
a271 1
	@@$(MAKE) subdirs DO=$@@ $(FLAGS_TO_PASS)
d310 1
a310 1
msvcrt.def msvcrtd.def \
d314 1
a314 2
msvcr90.def msvcr90d.def \
: msvcrt.def.in
d359 2
a360 1
# The special rules are necessary.
d411 6
d535 3
a537 15
	@@true

# The . is here because SUBDIRS may be empty

. $(SUBDIRS): force
	@@if [ -d ./$@@ ]; then \
	  echo "Making $(DO) in $@@..." ; \
	  if (rootme=`pwd`/ ; export rootme ; \
	    rootsrc=`cd $(srcdir); pwd`/ ; export rootsrc ; \
	    cd ./$@@; \
	    $(MAKE) $(FLAGS_TO_PASS) $(DO)) ; then true ; \
	  else exit 1 ; \
	  fi ; \
	else true ; \
	fi
d607 1
@


1.87
log
@* Makefile.in: Use a different method to invoke gcc in a cygwin-hosted
environment.
* mingwex/Makefile.in: Ditto.
* profile/Makefile.in: Ditto.
* configure.in: Record mingw front-end for building under Cygwin.
* mingwex/configure.in: Ditto.
* profile/configure.in: Ditto.
* configure: Regenerate.
* mingwex/configure: Ditto.
* profile/configure: Ditto.
@
text
@d370 1
a370 6
endif

ifneq (,$(findstring mingw, $(target_alias)))
    dist_prefix =
else
    dist_prefix = $(conf_prefix)
d402 4
d407 3
a409 2
ifneq (,$(findstring cygwin, $(target_alias)))
bindist:
d415 8
d424 2
a425 3
	$(TAR) $(TARFLAGS)cf ../$(distdir)$(TARFILEEXT) *
else
bindist:
d427 7
a433 4
	mkdir $(distdir)
	chmod 755 $(distdir)
	$(MAKE) install prefix=$(shell pwd)/$(distdir)$(dist_prefix)
	rm -f $(distdir).tar.gz
d435 2
a436 3
	$(TAR) $(TARFLAGS)cf ../$(distdir)-dev$(TARFILEEXT) * --exclude=bin; \
	$(TAR) $(TARFLAGS)cf ../$(distdir)-dll$(TARFILEEXT) bin/*.dll
endif
@


1.86
log
@Use de-facto standard Makefile goals to invoke test suite.
@
text
@d107 3
a109 5
MNO_CYGWIN = @@MNO_CYGWIN@@
ifdef MNO_CYGWIN
   subdirforlib=/mingw
else
   libdir=
d129 2
a130 2
ALL_CFLAGS = $(CFLAGS) $(INCLUDES) $(W32API_INCLUDE) $(MNO_CYGWIN)
ALL_CXXFLAGS = $(CXXFLAGS) $(INCLUDES) -nostdinc++ $(W32API_INCLUDE) $(MNO_CYGWIN)
@


1.85
log
@2008-09-23  Chris Sutcliffe  <ir0nh34d@@users.sf.net>

        * Makefile.in: Don't include host_os as part of snapshot filename.
@
text
@d192 1
a192 1
       libmsvcrt.a libmsvcrtd.a \
d199 1
a199 1
       libmoldname.a libmoldnamed.a \
d308 4
a311 1
libmoldname70.a libmoldname70d.a libmoldname71.a libmoldname71d.a libmoldname80.a libmoldname80d.a libmoldname90.a libmoldname90d.a: moldname-msvcrt.def $(MOLD_OBJS)
d326 2
d331 2
a332 2
.PHONY: test_headers
test_headers:
@


1.84
log
@2008-09-06  Chris Sutcliffe  <ir0nh34d@@users.sourceforge.net>

        * Makefile.in: Adjust to new naming standard for MinGW while maintaining old
        naming standard for Cygwin.
@
text
@d355 1
a355 1
      distdir=$(PACKAGE)-$(VERSION)-$(SNAPDATE)-$(host_os)
@


1.83
log
@	Lay foundations for new printf() function family implementation.
@
text
@a19 1
PACKAGE = mingw-runtime
d33 8
d81 1
a81 1
inst_docdir:=$(prefix)/doc/mingw-runtime
d355 1
a355 1
      distdir=$(PACKAGE)-$(VERSION)-$(SNAPDATE)
d360 1
a360 1
      distdir=$(PACKAGE)-$(VERSION)
d405 1
d414 11
@


1.82
log
@2008-04-26  Chuck Wilson  <cwilso11@@users.sourceforge.net>

        * Makefile.in: correct issues with mingw10.dll having multiple relocs.
@
text
@d139 2
d210 1
a210 1
moldname.def.in msvcrt.def.in \
d339 1
a339 1
	-rm -f moldname-*.def
d474 1
a474 1
# Dependancies
d506 29
a534 2
lib%.a:%.def
	$(DLLTOOL) --as=$(AS) -k --dllname $*.dll --output-lib lib$*.a --def $<
@


1.81
log
@2008-02-01  Brian Dessent  <brian@@dessent.net>

        * Makefile.in: Add rules to generate multiple versions of libmoldname.a for
        the different runtime versions.
@
text
@a245 7
# Using dllwrap would be so much easier, but Cygnus top-level configure
# Makefile.in etc don't pass the right variables yet.
xx_$(THREAD_DLL_NAME) xx_mingwthrd.def: mthr.o mthr_init.o
	$(DLLWRAP) $(DLLWRAP_FLAGS) -o $(THREAD_DLL_NAME) \
		--output-def mingwthrd.def \
		mthr.o mthr_init.o

d247 1
a247 1
DLL_CC_STUFF      = -B./ -mdll $(MNO_CYGWIN) -Wl,--image-base,0x6FBC0000 \
d249 1
a249 1
                    $(DLL_OFILES) \
a250 3
DLL_DLLTOOL_STUFF = --as=$(AS) --dllname $(THREAD_DLL_NAME) \
                    --def mingwthrd.def \
                    --base-file mingwthrd.base --output-exp mingwthrd.exp
d254 1
a254 8
	$(CC) -Wl,--base-file=mingwthrd.base $(DLL_CC_STUFF) \
		-o mingwthrd_dummy.exe
	$(DLLTOOL) $(DLL_DLLTOOL_STUFF)
	$(CC) -Wl,--base-file=mingwthrd.base mingwthrd.exp $(DLL_CC_STUFF) \
		-o mingwthrd_dummy.exe
	$(DLLTOOL) $(DLL_DLLTOOL_STUFF)
	$(CC) mingwthrd.exp -o $(THREAD_DLL_NAME) $(DLL_CC_STUFF)
	rm -f mingwthrd_dummy.exe
@


1.80
log
@2007-11-26  Chris Sutcliffe <ir0nh34d@@users.sourceforge.net>

        * Makefile.in: Add libmsvcr90.a and libmsvcr90d.a targets.
        * msvcrt.def.in: Add support for __msvcr90__ and __msvcr90d__ defines.
        * mingwex/math/log10f.S: Correct issue with comments.
        * mingwex/math/log10l.S: Ditto.
        * mingwex/math/log1p.S: Ditto.
        * mingwex/math/log1pf.S: Ditto.
        * mingwex/math/log1pl.S: Ditto.
        * mingwex/math/log2.S: Ditto.
        * mingwex/math/log2f.S: Ditto.
        * mingwex/math/log2l.S: Ditto.
        * mingwex/math/logf.S: Ditto.
        * mingwex/math/logl.S: Ditto.
@
text
@d2 1
a2 1
# Copyright (c) 1995, 1996, 1997, 1998 Cygnus Solutions
d191 4
d308 1
a308 1
libmoldname.a: moldname-msvcrt.def $(MOLD_OBJS)
d310 1
a310 1
		--dllname msvcrt.dll	\
d316 1
a316 1
libmoldnamed.a: moldname-msvcrt.def $(MOLD_OBJS)
d318 1
a318 1
		--dllname msvcrtd.dll	\
@


1.79
log
@2007-03-25 Chris Sutcliffe <ir0nh34d@@users.sourceforge.net>

        * include/_mingw.h: Increment version to 3.13.
        * Makefile.in: Reset CYGRELEASE to 1
@
text
@d187 1
d277 1
@


1.78
log
@* Makefile.in (SUBDIRS): Delete stray line continuation artifact,
resulting from incomplete removal of enclosing `for ...; do ...; done'
loop from compound command; (reported by Greg Chicares).
@
text
@d22 1
a22 1
CYGRELEASE = 3
@


1.77
log
@	* Makefile.in (CRT0S): Revert last change.
	* CRTfmode.c. Correct comment.
@
text
@d475 4
a478 2
	  else exit 1 ; fi ; \
	else true ; fi ; \
@


1.76
log
@	* Makefile.in (CRT0S): Add back CRTfmode.o.
@
text
@d174 1
a174 1
	CRT_fp8.o CRT_fp10.o txtmode.o binmode.o CRTfmode.o
@


1.75
log
@2007-04-07  Chris Sutcliffe  <ir0nh34d@@users.sourceforge.net>

        * Makefile.in: Removed mansuffix variable.  Changed mansection to support
        Cygwin man page location.
@
text
@d174 1
a174 1
	CRT_fp8.o CRT_fp10.o txtmode.o binmode.o
@


1.74
log
@2007-04-05  Chris Sutcliffe  <ir0nh34d@@users.sourceforge.net>

        * Makefile.in: Added mansection and mansuffix variables.  Changed mandir
  to support Cygwin man page location.
@
text
@d22 1
a22 1
CYGRELEASE = 2
a41 1
mansuffix = mingw
d44 1
a44 2
mansection = man3
mansuffix = 3
d430 1
a430 1
	$(mkinstalldirs) $(mandir)/$(mansection)
d453 5
a457 5
	$(mkinstalldirs) $(mandir)/$(mansection)
	$(INSTALL_DATA) $(srcdir)/man/dirname.man $(mandir)/$(mansection)/`\
	  echo dirname.man|sed '$(manpage_transform);s,man$$,$(mansuffix),'`
	$(INSTALL_DATA) $(srcdir)/man/dirname.man $(mandir)/$(mansection)/`\
	  echo basename.man|sed '$(manpage_transform);s,man$$,$(mansuffix),'`
@


1.73
log
@2003-03-20  Chris Sutcliffe  <ir0nh34d@@users.sourceforge.net>

        * Makefile.in: Tweak srcdist to fix build issue.
@
text
@d22 1
a22 1
CYGRELEASE = 1
d39 5
d45 3
d432 1
a432 1
	$(mkinstalldirs) $(mandir)/man3
d455 5
a459 5
	$(mkinstalldirs) $(mandir)/man3
	$(INSTALL_DATA) $(srcdir)/man/dirname.man $(mandir)/man3/`\
	  echo dirname.man|sed '$(manpage_transform);s,man$$,3,'`
	$(INSTALL_DATA) $(srcdir)/man/dirname.man $(mandir)/man3/`\
	  echo basename.man|sed '$(manpage_transform);s,man$$,3,'`
@


1.72
log
@Add --enable-mingw-manpage-transform configure option.
@
text
@d394 1
a394 1
	cp $(srcdir)/man/* $(distdir)/man/
@


1.71
log
@Add manpages for dirname and basename functions.
@
text
@d40 1
d447 5
a451 2
	$(INSTALL_DATA) $(srcdir)/man/dirname.man $(mandir)/man3
	cd $(mandir)/man3; mv dirname.man dirname.3; ln dirname.3 basename.3
@


1.70
log
@	* Makefile.in (ALL_CFLAGS): Put W32API_INCLUDE after INCLUDES.
	(ALL_CXXFLAGS): Likewise.
	* mingwex/Makefile.in (ALL_CFLAGS): Put W32API_INCLUDE after INCLUDES.
	(ALL_CXXFLAGS): Likewise.
	* profile/Makefile.in (ALL_CFLAGS): Put W32API_INCLUDE after INCLUDES.
	(ALL_CXXFLAGS): Likewise.
@
text
@d39 1
d383 5
d392 3
d423 1
d442 9
@


1.69
log
@configure.in: Update to autoconf 2.5x syntax; fix macro argument quoting;
remove invalid use of AC_ALLOCA; remove redundant use of AC_SUBST.
@
text
@d112 1
a112 1
INCLUDES+= -I$(srcdir)/include \
d116 2
a117 2
ALL_CFLAGS = $(CFLAGS) $(W32API_INCLUDE) $(INCLUDES) $(MNO_CYGWIN)
ALL_CXXFLAGS = $(CXXFLAGS) $(W32API_INCLUDE) $(INCLUDES) -nostdinc++ $(MNO_CYGWIN)
@


1.68
log
@	* Makefile.in:  Add aclocal.m4:to source release.
	* mingwex/Makefile.in: Ditto.
	* profile/Makefile.in: Ditto.
@
text
@d21 1
a21 1
VERSION = 3.11
@


1.67
log
@2006-11-18  Chris Sutcliffe  <ir0nh34d@@users.sourceforge.net>

        * Include/_mingw.h: Increment version to 3.11.
        * Makefile.in: Ditto.
@
text
@d193 1
a193 1
crt1.c crtdll.def crtmt.c crtst.c  dllcrt1.c dllmain.c \
d200 1
a200 1
pseudo-reloc-list.c cpu_features.c cpu_features.h\
@


1.66
log
@	* Makefile.in: Semi-revert semi-reversion of 2006-08-30 change, now
	correctly parenthesized.
@
text
@d21 1
a21 1
VERSION = 3.10
@


1.65
log
@* Makefile.in: Semi-revert 2006-08-30 change.
@
text
@d57 6
d68 1
@


1.64
log
@	* Makefile.in: Add with_cross_host to allow more granular checks.
	Set installation directories accordingly.  Override CC setting only
	if building a Cygwin target.
	* aclocal.m4: Regenerate.
	* configure.in: Move AC_CANONICAL_SYSTEM check up.  Add
	GCC_NO_EXECUTABLES.  Substitute with_cross_host in depending files.
	Test AC_ALLOCA only if building on a native system.
	* configure: Regenerate.
@
text
@a56 6
ifneq (,$with_cross_host)
inst_bindir:=$(tooldir)/bin
inst_includedir:=$(tooldir)/include
inst_libdir:=$(tooldir)/lib
inst_docdir:=$(tooldir)/share/doc/mingw-runtime
else
a61 1
endif
@


1.63
log
@ 	Support SSE float environment in fenv.h functions.

	* cpu_features.c: New file.
	* cpu_features.h: New file.
	* crt1.c: Include "cpu_features.h".
	(__mingw_CRTStartup): Call cpu_features_init().
	* Makefile.in (MING_OBJS): Add cpu_features.c.
	(SRCDIST_FILES): Add cpu_features.c, cpu_features.h.
	* include/fenv,h ( fenv_t;): Append  __mxcsr field.
	(__MXCSR_EXCEPT_FLAG_SHIFT): New define.
	(__MXCSR_EXCEPT_MASK_SHIFT): New define.
	(__MXCSR_ROUND_FLAG_SHIFT): New define.
	* mingwex/feclearexcept.c: Include "cpu_features.h".
	Handle SSE environment.
	* mingwex/fegetenv.c: Likewise.
	* mingwex/feholdexcept.c: Likewise.
	* mingwex/fesetenv.c: Likewise.
	* mingwex/fesetexceptflag.c: Likewise.
	* mingwex/fesetround.c: Likewise.
	* mingwex/fetestexcept.c: Likewise.
	* mingwex/feupdateenv.c: Likewise.
	* mingwex/fegetround.c: Add comment.
@
text
@d31 1
d57 6
d68 1
d82 1
d84 1
@


1.62
log
@2006-06-25  Chris Sutcliffe  <ir0nh34d@@users.sourceforge.net>

        * Include/_mingw.h: Increment version to 3.10.
        * Makefile.in: Ditto.
@
text
@d159 1
a159 1
	     pseudo-reloc.o pseudo-reloc-list.o
d190 1
a190 1
pseudo-reloc-list.c \
@


1.61
log
@	* Makefile.in (SUBDIRS): Change to lowercase for autoconf 2.59.
@
text
@d21 2
a22 2
VERSION = 3.9
CYGRELEASE = 2
d62 1
a62 1
# The Mingw headers are installed under a subdirectory of 
d115 1
a115 1
DLLTOOLFLAGS = 
d217 1
a217 1
libmingwthrd.a: crtmt.o mingwthrd.def 
d246 1
a246 1
	$(DLLTOOL) $(DLL_DLLTOOL_STUFF) 
d335 1
a335 1
	-rm -f config.cache config.status config.log 
d390 1
a390 1
snapshot: 
d456 2
a457 2
dllcrt1.o: dllcrt1.c 
dllcrt2.o: dllcrt1.c 
@


1.60
log
@2006-02-13  Earnie Boyd  <earnie@@users.sf.net>

	* Makefile.in (libmsvcr80.a): Add import lib.
	(libmsvcr80d.a): Ditto.
@
text
@d126 1
a126 1
SUBDIRS := @@SUBDIRS@@
@


1.59
log
@2006-01-18  Chris Sutcliffe  <ir0nh34d@@users.sourceforge.net>

        * Makefile.in: Bump cygwin build number.
@
text
@d168 1
d257 1
@


1.58
log
@2005-10-27  Chris Sutcliffe  <ir0nh34d@@users.sourceforge.net>

	* Include/_mingw.h: Increment version to 3.9.
	* Makefile.in: Ditto.
@
text
@d22 1
a22 1
CYGRELEASE = 1
@


1.57
log
@        * Include/_mingw.h: Increment version to 3.8.
        * Makefile.in: Ditto.
@
text
@d21 1
a21 1
VERSION = 3.8
@


1.56
log
@
	* include/_mingw.h: Increment version to 3.7.
	* Makefile.in: Ditto.
@
text
@d21 1
a21 1
VERSION = 3.7
@


1.55
log
@
	* Makefile.in (inst_docdir): For Cygwin target set to share/doc/.
@
text
@d21 1
a21 1
VERSION = 3.6
@


1.54
log
@
	* include/_mingw.h: Increment version to 3.6
	* Makefile.in: Ditto
@
text
@d54 1
a54 1
inst_docdir:=$(tooldir)/doc/mingw-runtime
@


1.53
log
@
	* include/_mingw.h: Increment minor version for 3.5 release.
	* Makefile.in: Ditto.
@
text
@d21 1
a21 1
VERSION = 3.5
@


1.52
log
@* Makefile.in (CC): Strip inappropriate include file settings from any
passed-in CC.
@
text
@d21 1
a21 1
VERSION = 3.4
@


1.51
log
@	* Makefile.in (INCLUDES): Temporarily revert previous change.
	* mingwex/Makefile,in (INCLUDES): Ditto.
	* profile/Makefile,in (INCLUDES): Ditto.
	* mingwex/Makefile,in: Drop carg.o dependency.
@
text
@d73 2
a74 1
CC = @@CC@@
@


1.50
log
@	* Makefile.in (INCLUDES): Designate $(srcdir)/../include as a
	system dir.
	* mingwex/Makefile,in (INCLUDES): Ditto.
	* profile/Makefile,in (INCLUDES): Ditto.

	* mingwex/Makefile,in: Add carg.o to libmingwex.a.
@
text
@d102 1
a102 1
  -isystem$(srcdir)/../include \
@


1.49
log
@
	* Makefile.in: Move use of --nostdinc++ as GCC3.4 refuses to use it
	for C modules.
@
text
@d102 1
a102 1
  -I$(srcdir)/../include \
@


1.48
log
@
	* include/_mingw.h: Increment minor version for 3.4 release.
	* Makefile.in: Ditto.
@
text
@d103 1
a103 1
  -nostdinc -nostdinc++ \
d106 1
a106 1
ALL_CXXFLAGS = $(CXXFLAGS) $(W32API_INCLUDE) $(INCLUDES) $(MNO_CYGWIN)
@


1.47
log
@
	CORRECTION:
	* Makefile.in (SRCDIST_FILES): Add DISCLAIMER and CONTRIBUTORS.
@
text
@d21 1
a21 1
VERSION = 3.3
@


1.46
log
@
	* DISCLAIMER: Add words about "free to use".
	* README: Modify "Win32 runtime" to "Microsoft C Runtime".
	* Makefile.in (SRCDIST_FILES): Add DISCLAIMER and README.
	(inst_docdir): New variable.
	(INSTDOCS): Ditto.
	(FLAGS_TO_PASS): Include inst_docdir.
	(install-dirs): Add inst_docdir.
	(install): Add loop for INSTDOCS.
@
text
@d175 2
a176 1
INSTDOCS = DISCLAIMER \
d189 1
a189 1
DISCLAIMER README
@


1.45
log
@
	* include/_mingw.h: Revert to primary release 3 and increment minor
	release to 3.
	* Makefile.in (VERSION): Ditto.
@
text
@d54 1
d59 1
d147 1
d175 3
d187 2
a188 1
pseudo-reloc-list.c
d399 1
d407 3
@


1.44
log
@	* msvcrt.def.in: Add stubs for msvcrt.dll (version 6.10),
	msvcr70.dll, and msvcr71.dll.
	* Makefile.in (msvcr*.def): Define preprocessor  __msvcr*__ constant
	using basename of output def file.
@
text
@d21 1
a21 1
VERSION = 4.0
@


1.43
log
@
	* include/_mingw.h: Increment version to 3.2.
	* Makefile.in: Ditto.
@
text
@d249 1
a249 1
		-D__FILENAME__=$@@ \
@


1.42
log
@
	* include/_mingw.h: Increment version to 3.2.
	* Makefile.in: Ditto.
@
text
@d21 1
a21 1
VERSION = 3.2
@


1.41
log
@
	* include/dirent.h (dirent): Make d_name and array instead of a pointer.
	* mingwex/dirent.c: Modifications througout to fill d_name array.
        * Makefile.in (LIBS): Add new MSVCRT libraries libmsvcr70 and
        libmsvcr71, including debug versions.
        (msvcr70.def, msvcr70d.def, msvcr71.def, msvcr71.def): New targets.
@
text
@d21 1
a21 1
VERSION = 3.1
@


1.40
log
@	* string_old.c: Remove, splitting into...
	* strcasecmp.c: New file.
	* strncasecmp.c: New file.
	* wscmpi.c : New file.
	* ctype_old.c: Remove, splitting into...
	* isascii.c: New file.
	* iscsym.c: New file.
	* iscsymf.c: New file.
	* toascii.c: New file.
	* Makefile.in (MOLD_OBJS): Adjust.
	(SRCDIST_FILES): Adjust.
@
text
@d160 9
a168 2
LIBS = libcrtdll.a libmsvcrt.a libmsvcrtd.a libmingw32.a \
       libcoldname.a libmoldname.a libmoldnamed.a $(LIBM_A) libmingwthrd.a
d244 4
a247 1
msvcrt.def msvcrtd.def: msvcrt.def.in
@


1.39
log
@
	* include/_mingw.h: Change version to 3.0
	* Makefile.in: Ditto.
@
text
@d156 3
a158 1
MOLD_OBJS = ctype_old.o string_old.o
d167 1
a167 1
crt1.c crtdll.def crtmt.c crtst.c ctype_old.c  dllcrt1.c dllmain.c \
d170 3
a172 1
mthr.c mthr_init.c mthr_stub.c readme.txt string_old.c \
@


1.38
log
@Uh hum, just not my day
@
text
@d21 1
a21 1
VERSION = 3.0
@


1.37
log
@
	* Makefile.in (W32API_INCLUDE): New variable.
	(ALL_CFLAGS): Include W32API_INCLUDE value.
	(ALL_CXXFLAGS): Ditto.
	* configure.in (CFLAGS): Add -D__USE_CRTIMP=1 to default values.
	(W32API_INCLUDE): Set default value.
	* configure: Regenerate.
@
text
@d98 1
a98 1
W32API_INCLUDES = @@W32API_INCLUDE@@
@


1.36
log
@
	* Makefile.in (libmsvcrt20.a): Remove target and dependencies.
	(libmsvcrt40.a): Ditto.
@
text
@d98 2
a99 1
INCLUDES = -I$(srcdir)/include -I$(srcdir)/../w32api/include \
d103 2
a104 2
ALL_CFLAGS = $(CFLAGS) $(INCLUDES) $(MNO_CYGWIN)
ALL_CXXFLAGS = $(CXXFLAGS) $(INCLUDES) $(MNO_CYGWIN)
@


1.35
log
@
	Thanks to David Frasier <davidf@@sjsoft.com> who inspired portions of
	this patch.
	* Makefile.in (libmsvcrtd.a): Add target library.
	(libmoldnamed.a): Ditto.
	(msvcrt.def, msvcrtd.def, msvcrt20.def, msvcrt40.def): Use msvcrt.def.in
	template to create.
	($(srcdir)): Remove explicit reference for depencies of object targets.
	* moldname.def, moldname-msvcrt.def, moldname-crtdll.def, msvcrt.def,
	msvcrt20.def, msvcrt40.def: Remove.
	* msvcrt.def.in: New file (Copy of previous msvcrt.def).
@
text
@d157 1
a157 2
LIBS = libcrtdll.a libmsvcrt.a libmsvcrtd.a libmsvcrt20.a libmsvcrt40.a \
       libmingw32.a \
d232 1
a232 1
msvcrt.def msvcrtd.def msvcrt20.def msvcrt40.def: msvcrt.def.in
a416 2
libmsvcrt20.a: msvcrt20.def
libmsvcrt40.a: msvcrt40.def
@


1.34
log
@	* Makefile.in: Make sure libmingwex.a from current build tree is used.
@
text
@d157 3
a159 2
LIBS = libcrtdll.a libmsvcrt.a libmsvcrt20.a libmsvcrt40.a libmingw32.a \
       libcoldname.a libmoldname.a $(LIBM_A) libmingwthrd.a
d166 3
a168 3
gccmain.c init.c install-sh jamfile main.c mkinstalldirs moldname-crtdll.def \
moldname-msvcrt.def moldname.def moldname.def.in msvcrt.def msvcrt20.def \
msvcrt40.def mthr.c mthr_init.c mthr_stub.c readme.txt string_old.c \
d233 7
a239 1
$(srcdir)/moldname-crtdll.def: moldname.def.in
d245 1
a245 1
$(srcdir)/moldname-msvcrt.def: moldname.def.in
d251 1
a251 1
libcoldname.a: $(srcdir)/moldname-crtdll.def $(MOLD_OBJS)
d254 1
a254 1
		--def $(srcdir)/moldname-crtdll.def	\
d259 1
a259 1
libmoldname.a: $(srcdir)/moldname-msvcrt.def $(MOLD_OBJS)
d262 9
a270 1
		--def $(srcdir)/moldname-msvcrt.def	\
d305 1
d308 1
a308 1
distclean:
a309 2
	-rm -f *.o *.a *~ core a.out mingwthrd.def mingwthrd.base mingwthrd.exp
	-rm -f $(THREAD_DLL_NAME)
d415 22
a436 21
libcrtdll.a: $(srcdir)/crtdll.def
libmsvcrt.a: $(srcdir)/msvcrt.def
libmsvcrt20.a: $(srcdir)/msvcrt20.def
libmsvcrt40.a: $(srcdir)/msvcrt40.def
CRT_noglob.o: $(srcdir)/CRT_noglob.c
CRTfmode.o: $(srcdir)/CRTfmode.c
CRTglob.o: $(srcdir)/CRTglob.c
CRTinit.o: $(srcdir)/CRTinit.c
crt1.o: $(srcdir)/crt1.c $(srcdir)/init.c
crt2.o: $(srcdir)/crt1.c $(srcdir)/init.c
crtmt.o: $(srcdir)/crtmt.c
crtst.o: $(srcdir)/crtst.c
ctype_old.o: $(srcdir)/ctype_old.c
dllcrt1.o: $(srcdir)/dllcrt1.c 
dllcrt2.o: $(srcdir)/dllcrt1.c 
dllmain.o: $(srcdir)/dllmain.c
main.o: $(srcdir)/main.c
oldnames.o: $(srcdir)/oldnames.c
string_old.o: $(srcdir)/string_old.c
CRT_fp8.o: $(srcdir)/CRT_fp8.c
CRT_fp10.o: $(srcdir)/CRT_fp10.c
@


1.33
log
@
	* include/_mingw.h: Change version to 3.0
	* Makefile.in: Ditto.
@
text
@d211 2
a212 1
                    $(DLL_OFILES)
d217 1
a217 1
$(THREAD_DLL_NAME) mingwthrd.def: $(DLL_OFILES) Makefile
@


1.32
log
@2003-01-01  Danny Smith  <dannysmith@@users.sourceforge.net>

	* pseudo-reloc.c (do_pseudo_reloc): Make static.
	* pseudo-reloc-list.c: New file.
	* crt1.c (_pei386_runtime_relocator): Declare.
	(__mingw_CRTStartup): Call it.
	* dllcrt1.c (_pei386_runtime_relocator): Declare.
	(DllMainCRTStartup): Call it.
	* Makefile.in: Add pseudo-reloc.o pseude-reloc-list.o to
	libmingw32.a.

2003-01-01  Egor Duda  <deo@@logos-m.ru>

	* pseudo-reloc.c: New file.
@
text
@d21 1
a21 1
VERSION = 2.4
@


1.31
log
@
	* include/_mingw.h: Increment version to 2.4.
	Makefile.in: Ditto.
@
text
@d153 2
a154 1
	     main.o crtst.o mthr_stub.o CRT_fp10.o txtmode.o
d168 3
a170 1
CRT_fp8.c CRT_fp10.c test_headers.c txtmode.c binmode.c
@


1.30
log
@	* Makefile.in (CRT0S): Add txtmode.o binmode.o.
	(MINGW_OBJS): Add txtmode.o.
	(SRCDIST_FILES): Add txtmode.c binmode.c.
	crt1.c: Don't include fcntrl.h, stdlib.h.
	(_fmode): Declare, without dllimport attribute.
	(__p__fmode): Declare access function for dll's _fmode.
	(_mingw32_init_fmode): Sync dll _fmode with staticly linked
	_fmode for app.
	* txtmode.c: New file.
	* binmode.c: New file.
	* samples/fmode/test2.c: New file.
	* samples/fmode/jamfile: Add test2.exe target.
@
text
@d21 1
a21 1
VERSION = 2.3
@


1.29
log
@
	* include/_mingw.h: Increment version to 2.3.
	Makefile.in: Ditto.
@
text
@d151 1
a151 1
	CRT_fp8.o CRT_fp10.o
d153 1
a153 1
	     main.o crtst.o mthr_stub.o CRT_fp10.o
d167 1
a167 1
CRT_fp8.c CRT_fp10.c test_headers.c
@


1.29.2.1
log
@	Merge from mingw trunk (changes since 2002-10-04).
@
text
@d151 1
a151 1
	CRT_fp8.o CRT_fp10.o txtmode.o binmode.o
d153 1
a153 1
	     main.o crtst.o mthr_stub.o CRT_fp10.o txtmode.o
d167 1
a167 1
CRT_fp8.c CRT_fp10.c test_headers.c txtmode.c binmode.c
@


1.29.2.2
log
@	Merge from mingw trunk (changes since 2002-12-10).
@
text
@d21 1
a21 1
VERSION = 2.4
d153 1
a153 2
	     main.o crtst.o mthr_stub.o CRT_fp10.o txtmode.o \
	     pseudo-reloc.o pseudo-reloc-list.o
d167 1
a167 2
CRT_fp8.c CRT_fp10.c test_headers.c txtmode.c binmode.c pseudo-reloc.c \
pseudo-reloc-list.c
@


1.29.2.3
log
@	Merge from mingw trunk (changes since 2003-01-27).
@
text
@d21 1
a21 1
VERSION = 3.0
d157 2
a158 2
LIBS = libcrtdll.a libmsvcrt.a libmsvcrtd.a libmingw32.a \
       libcoldname.a libmoldname.a libmoldnamed.a $(LIBM_A) libmingwthrd.a
d165 3
a167 3
gccmain.c init.c install-sh jamfile main.c mkinstalldirs \
moldname.def.in msvcrt.def.in \
mthr.c mthr_init.c mthr_stub.c readme.txt string_old.c \
d210 1
a210 2
                    $(DLL_OFILES) \
		    -Lmingwex
d215 1
a215 1
$(THREAD_DLL_NAME) mingwthrd.def: $(DLL_OFILES) Makefile $(SUBDIRS)
d230 1
a230 7
msvcrt.def msvcrtd.def: msvcrt.def.in
	$(CC) -DRUNTIME=$(basename $(notdir $@@)) \
		-D__FILENAME__=$@@ \
		-D__MSVCRT__ -C -E -P \
		-xc-header $? > $@@

moldname-crtdll.def: moldname.def.in
d236 1
a236 1
moldname-msvcrt.def: moldname.def.in
d242 1
a242 1
libcoldname.a: moldname-crtdll.def $(MOLD_OBJS)
d245 1
a245 1
		--def moldname-crtdll.def	\
d250 1
a250 1
libmoldname.a: moldname-msvcrt.def $(MOLD_OBJS)
d253 1
a253 9
		--def moldname-msvcrt.def	\
		--output-lib $@@
	$(AR) rc $@@ $(MOLD_OBJS)
	$(RANLIB) $@@

libmoldnamed.a: moldname-msvcrt.def $(MOLD_OBJS)
	$(DLLTOOL) --as $(AS) -k -U	\
		--dllname msvcrtd.dll	\
		--def moldname-msvcrt.def	\
a287 1
	-rm -f moldname-*.def
d290 1
a290 1
distclean: clean
d292 2
d399 21
a419 20
libcrtdll.a: crtdll.def
libmsvcrt.a: msvcrt.def
libmsvcrtd.a: msvcrtd.def
CRT_noglob.o: CRT_noglob.c
CRTfmode.o: CRTfmode.c
CRTglob.o: CRTglob.c
CRTinit.o: CRTinit.c
crt1.o: crt1.c init.c
crt2.o: crt1.c init.c
crtmt.o: crtmt.c
crtst.o: crtst.c
ctype_old.o: ctype_old.c
dllcrt1.o: dllcrt1.c 
dllcrt2.o: dllcrt1.c 
dllmain.o: dllmain.c
main.o: main.c
oldnames.o: oldnames.c
string_old.o: string_old.c
CRT_fp8.o: CRT_fp8.c
CRT_fp10.o: CRT_fp10.c
@


1.28
log
@	* test_headers.c: Don't include varargs.h.
	* Makefile.in (test_headers): Don't use -std=xx
	with -xc++. Test -std=gnu89, gnu99 also.
@
text
@d21 1
a21 1
VERSION = 2.2
@


1.27
log
@
	* include/_mingw.h: Increment version to 2.2.
	Makefile.in: Ditto.
@
text
@d263 1
a263 1
TEST_H_OPTIONS = $(ALL_CFLAGS) -Wall  -Wsystem-headers -c \
d271 3
a273 5
		$(CC) -x$$lang -std=c89 $(TEST_H_OPTIONS) ; \
		echo "$$lang c89 ..."; \
		$(CC) -x$$lang -std=c89 $(TEST_H_OPTIONS) ; \
		echo "$$lang c99..."; \
		$(CC) -x$$lang -std=c99  $(TEST_H_OPTIONS) ; \
d275 6
@


1.26
log
@	* test_headers.c : New file.
	* Makefile.in (test_headers): New target, using it,
	(SRCDIST_FILES): Distribute it.
@
text
@d21 1
a21 1
VERSION = 2.1
@


1.25
log
@
	* include/_mingw.h: Increment to version 2.1.
	* Makefile.in: Ditto.
@
text
@d167 1
a167 1
CRT_fp8.c CRT_fp10.c
d262 16
@


1.24
log
@
	* Makefile.in (conf_prefix): New variable.
	(dist_prefix): Ditto. Conditionally set to $(conf_prefix).
	(bindist): Use dist_prefix.
@
text
@d21 1
a21 1
VERSION = 2.0
@


1.23
log
@	* include/_mingw.h: Increment version to 2.0.
	* Makefile.in: Ditto.
	Merge in mingwex branch.
@
text
@d32 1
d290 6
d322 1
a322 1
	$(MAKE) install prefix=$(shell pwd)/$(distdir)
@


1.22
log
@
	* include/_mingw.h: Increment version.
	* Makefile.in: Ditto.
@
text
@d21 1
a21 1
VERSION = 1.4
d99 2
a100 1
  -nostdinc -nostdinc++
d149 4
a152 3
CRT0S = crt1.o dllcrt1.o crt2.o dllcrt2.o CRT_noglob.o crtmt.o crtst.o
MINGW_OBJS = CRTglob.o CRTfmode.o CRTinit.o dirent.o dllmain.o gccmain.o \
	     main.o crtst.o mthr_stub.o
d162 1
a162 1
crt1.c crtdll.def crtmt.c crtst.c ctype_old.c dirent.c dllcrt1.c dllmain.c \
d165 2
a166 1
msvcrt40.def mthr.c mthr_init.c mthr_stub.c readme.txt string_old.c
a384 1
dirent.o: $(srcdir)/dirent.c
d389 3
@


1.21
log
@
	* Makefile.in: Use bzip2 compression for Cygwin target.
@
text
@d21 1
a21 1
VERSION = 1.3
@


1.20
log
@	* moldname.def.in (__MSVCRT__): Replace with !(__CRTDLL).
	(wpopen): Add if !(__CRTDLL).
	* Makefile.in (moldname-msvcrt.def rule): Use -C, not -c to
	preserve comments.
	(moldname-crtdll.def rule): Likewise.
	* moldname-msvcrt.def: Regenerate.
	* moldname-crtdll.def: Regenerate.
	* include/stdio.h (wpopen):Use prototype, not a define.
	(_swnprintf): Add prototype.
	(_vswnprintf): Likewise.
	Tidy up whitespace.
	* include/wchar.h (_swnprintf): Add prototype.
	(_vswnprintf): Likewise.
	Tidy up whitespace.
@
text
@d115 1
d117 2
d143 4
a146 1
	target_alias="$(target_alias)"
d281 5
d305 1
a305 1
	$(TAR) czf $(distdir)-src.tar.gz $(distdir)
d315 1
a315 1
	$(TAR) czf ../$(distdir).tar.gz *
@


1.19
log
@	* Makefile.in: Increment VERSION.
	* include/_mingw.h: Ditto.
@
text
@d221 1
a221 1
		-D__CRTDLL__  -c -E -P \
d227 1
a227 1
		-D__MSVCRT__  -c -E -P \
@


1.19.10.1
log
@	* configure.in: Add mingwex as SUBDIRS and configdirs.
	* configure: Regenerate.
	* Makefile.in (MINGW_OBJS): Remove dirent.o.
	(SRC_DIST_FILES): Remove dirent.c.
	* dirent.c: Remove.
	* include/stdlib.h (_Exit): Add static inline
	function.
	(struct lldiv_t): Define.
	(lldiv): Add prototype.
	(llabs): Add extern inline function.
	(strtoll,strtoull): Add prototypes.
	(wcstol, wcstoul, wcstod): Group together.
	(strtof, wcstof): Add extern inline definitions.
	(atoll,lltoa,ulltoa, wtoll, lltow ulltow): Add prototypes
	and extern inline definitions.
	* include/wchar.h (fwide, wcstoll,wcstoull, wmemchr
	wmemcmp, wmemcpy, wmemmove, wmemset. mbsinit): Add
	prototypes.
	(wcstol, wcstoul,wcstod): Copy prototypes from stdlib.h.
	(wcstof): Add extern inline definition.
	* include/math.h (nan, nanf): Add prototypes.
	(NAN, INFINITE): Define constants.
	(fpclassify, isnan ,signbit): Add macros and supporting float
	and double functions.
	(isfinite, isinf, isnormal): Add macros.
	(isgreater, isless, isgreaterequal, islessequal,islessgreater):
	Add macros.
	(rint, rintf, round, roundf, trunc. truncf, fmax, fmaxf,
	fmin, fminf, fma, fmaf, log2, log2f): Add prototypes.
	(copysign, logb, nextafter, scalb): Add prototypes and
	inline stubs for underscored versions in msvcrt.dll.
	* include/inttypes.h: New file.
	* include/fenv.h: New file

	Add new mingwex subdir and files.
	* mingwex: New directory.
	* mingwex/Makefile.in: New file.
	* mingwex/configure.in: New file.
	* mingwex/configure: Generate.
	* mingwex/dirent.c: Moved here from parent dir.
	* mingwex/atoll.c: New file.
	* mingwex/feclearexcept.c: New file.
	* mingwex/fegetenv.c: New file.
	* mingwex/fegetexceptflag.c: New file.
	* mingwex/fegetround.c: New file.
	* mingwex/feholdexcept.c: New file.
	* mingwex/feraiseexcept.c: New file.
	* mingwex/fesetenv.c: New file.
	* mingwex/fesetexceptflag.c: New file.
	* mingwex/fesetround.o: New file.
	* mingwex/fetestexcept.c: New file.
	* mingwex/feupdateenv.c: New file.
	* mingwex/fma.S: New file.
	* mingwex/fmaf.S: New file.
	* mingwex/fmax.c: New file.
	* mingwex/fmaxf.c: New file.
	* mingwex/fmin.c: New file.
	* mingwex/fminf.c: New file.
	* mingwex/fp_consts.c: New file.
	* mingwex/fpclassify.c: New file.
	* mingwex/fucom.c: New file.
	* mingwex/fwide.c: New file.
	* mingwex/imaxabs.c: New file.
	* mingwex/imaxdiv.c: New file.
	* mingwex/isnan.c: New file.
	* mingwex/isnanf.c: New file.
	* mingwex/lltoa.c: New file.
	* mingwex/lltow.c: New file.
	* mingwex/log2.c: New file.
	* mingwex/log2f.c: New file.
	* mingwex/math_stubs.c: New file.
	* mingwex/mbsinit.c: New file.
	* mingwex/rint.c: New file.
	* mingwex/round.c: New file.
	* mingwex/signbit.c: New file.
	* mingwex/sitest.c: New file.
	* mingwex/strtof.c: New file.
	* mingwex/strtoimax.c: New file.
	* mingwex/strtoumax.c: New file.
	* mingwex/testwmem.c: New file.
	* mingwex/trunc.c: New file.
	* mingwex/ulltoa.c: New file.
	* mingwex/ulltow.c: New file.
	* mingwex/wcstof.c: New file.
	* mingwex/wcstoimax.c: New file.
	* mingwex/wcstoumax.c: New file.
	* mingwex/wmemchr.c: New file.
	* mingwex/wmemcmp.c: New file.
	* mingwex/wmemcpy.c: New file.
	* mingwex/wmemmove.c: New file.
	* mingwex/wmemset.c: New file.
	* mingwex/wtoll.c: New file.
@
text
@d143 1
a143 1
MINGW_OBJS = CRTglob.o CRTfmode.o CRTinit.o  dllmain.o gccmain.o \
d154 1
a154 1
crt1.c crtdll.def crtmt.c crtst.c ctype_old.c  dllcrt1.c dllmain.c \
d371 1
@


1.19.10.2
log
@	* moldname.def.in (__MSVCRT__): Replace with !(__CRTDLL).
	(wpopen): Add if !(__CRTDLL).
	* Makefile.in (moldname-msvcrt.def rule): Use -C, not -c to
	preserve comments.
	(moldname-crtdll.def rule): Likewise.
	* moldname-msvcrt.def: Regenerate.
	* moldname-crtdll.def: Regenerate.
	* include/stdio.h (wpopen):Use prototype, not a define.
	(_swnprintf): Add prototype.
	(_vswnprintf): Likewise.
	Tidy up whitespace.
	* include/wchar.h (_swnprintf): Add prototype.
	(_vswnprintf): Likewise.
	Tidy up whitespace.
@
text
@d221 1
a221 1
		-D__CRTDLL__  -C -E -P \
d227 1
a227 1
		-D__MSVCRT__  -C -E -P \
@


1.19.10.3
log
@	* include/_mingw.h: Increment version to 2.0.
	* Makefile.in: Ditto.

	Merge from trunk:
	2002-04-09  Earnie Boyd  <earnie@@users.sf.net>
	* Makefile.in: Use bzip2 compression for Cygwin target.
@
text
@d21 1
a21 1
VERSION = 2.0
d115 1
a116 4
TAR = tar
TARFLAGS = z
TARFILEEXT = .tar.gz
 
d140 1
a140 4
	target_alias="$(target_alias)" \
	TAR="$(TAR)" \
	TARFLAGS="$(TARFLAGS)" \
	TARFILEEXT="$(TARFILEEXT)"
a274 5
ifneq (,$(findstring cygwin, $(target_alias)))
  TARFLAGS = j
  TARFILEEXT = .tar.bz2
endif

d294 1
a294 1
	$(TAR) $(TARFLAGS)cf $(distdir)-src$(TARFILEEXT) $(distdir)
d304 1
a304 1
	$(TAR) $(TARFLAGS)cf ../$(distdir)$(TARFILEEXT) *
@


1.19.10.4
log
@	* CRT_fp8.c: New file.
	* CRT_fp10.c: New file.
	* crt1.c (__CRT_PC) Declare.
	(__CRT_fesetenv): New static function, using _CRT_PC.
	(__mingw_CRTStartup):Use __CRT_fesetenv instead of _fpreset.
	(_gnu_exception_handler): Likewise.
	* Makefile.in (CRT0S): Add CRT_fp10.o.
	(MINGW_OBJS): Add  CRT_fp8.o.
	(SRCDIST_FILES): Add CRT_fp8.c, CRT_fp10.c.
	Add CRT_fp8.o, CRT_fp10.o dependancies.
	* include/float.h (_fpreset): Expand comment.
	* include/fenv.h (FE_PC64_ENV): New define for Intel x87
	(extended precison) environmemt.
	(FE_PC53_ENV): New define for MSVCRT default environmemt.
	(FE_DFL_ENV): Define as FE_PC53_ENV.
	* mingwex/fesetenv.c: Use FE_PC53_ENV, FE_PC64_ENV to determine
	precision control for default environment.

	* include/math.h: Fix long comment line.
	* profile/configure.in (CRT0S): Set to both gcrt1.o and gcrt2.o
	for mingw.
	* profile/configure: Regenerate.
@
text
@d148 1
a148 2
CRT0S = crt1.o dllcrt1.o crt2.o dllcrt2.o CRT_noglob.o crtmt.o crtst.o \
	CRT_fp10.o
d150 1
a150 1
	     main.o crtst.o mthr_stub.o CRT_fp8.o
d163 1
a163 2
msvcrt40.def mthr.c mthr_init.c mthr_stub.c readme.txt string_old.c \
CRT_fp8.c CRT_fp10.c
a385 3
CRT_fp8.o: $(srcdir)/CRT_fp8.c
CRT_fp10.o: $(srcdir)/CRT_fp10.c

@


1.19.10.5
log
@	* Makefile.in (INCLUDES): Add "-iwithprefixbefore include" to
	ensure gcc include dir is searched despite -nostdinc.
	* profile/Makefile.in (INCLUDES): Likewise.
	* mingwex/Makefile.in (INCLUDES): Likewise.
	* include/stdarg.h: Replace with stub that just guards the
	real gcc system header with #ifndef RCINVOKED
	* include/varargs.h: Likewise.
	* include/stddef.h: Likewise.
	* include/stdio.h: Include stdarg.h after defining
	 __need___va_list.
	(__VALIST): Define as __gnuc_va_list if __GNUC__, else char*.
	Replace va_list with __VALIST throughout.
@
text
@d99 1
a99 2
  -nostdinc -nostdinc++ \
  -iwithprefixbefore include
@


1.19.10.6
log
@	Change FP default precison from 53 to 64-bit mantissa.
	* Makefile.in (CRT0S): Add CRT_fp8.o.
	(MINGW_OBJS): Replace CRT_fp8.o with CRT_fp10.o.
	* include/float.h: Replace standard float.h defines with
	#include_next<float.h> to use GCC's defines.
@
text
@d150 1
a150 1
	CRT_fp8.o CRT_fp10.o
d152 1
a152 1
	     main.o crtst.o mthr_stub.o CRT_fp10.o
@


1.18
log
@* Makefile.in: Delete unused executable after creating base-files.
@
text
@d21 1
a21 1
VERSION = 1.2
@


1.17
log
@
2001-09-19  Earnie Boyd  <earnie@@SF.net>

	* Makefile.in: Remove the /usr from the install target.
	(VERSION): Increment.
	include/_mingw.h: Ditto.
@
text
@d205 2
a206 1
	$(CC) -Wl,--base-file=mingwthrd.base $(DLL_CC_STUFF)
d208 2
a209 1
	$(CC) -Wl,--base-file=mingwthrd.base mingwthrd.exp $(DLL_CC_STUFF)
d212 1
d255 1
a255 1
	-rm -f $(THREAD_DLL_NAME)
@


1.16
log
@
	* Makefile.in: Increment version.
	* include/_mingw.h: Ditto.
@
text
@d21 1
a21 1
VERSION = 1.1
d50 3
a52 3
inst_bindir:=$(tooldir)/usr/bin
inst_includedir:=$(tooldir)/usr/include/mingw
inst_libdir:=$(tooldir)/usr/lib/mingw
@


1.15
log
@Revert inadvertently checked in files.
@
text
@d21 2
a22 1
VERSION = 1.0
d28 2
d37 9
a45 1
tooldir = $(exec_prefix)/$(target_alias)
d49 9
d136 3
d169 1
a169 1
		$(INSTALL_PROGRAM) $$i $(bindir)/$$i ; \
d263 1
a263 1
   distdir=$(PACKAGE)-$(VERSION)-$(SNAPDATE)
d265 5
a269 1
   distdir=$(PACKAGE)-$(VERSION)
d300 1
a300 8
#FIXME does the install process really need to install into the $(tooldir)? 
	cd $(distdir) ; \
	cd $(target_alias); \
	for i in *; do \
	   mv $$i ../; \
        done; \
	cd ..; \
	rmdir $(target_alias); \
a301 1
#end FIXME
d313 3
a315 2
	$(mkinstalldirs) $(bindir)
	$(mkinstalldirs) $(tooldir)/lib$(subdirforlib)
d319 1
a319 1
		$(INSTALL_DATA) $$i $(tooldir)/lib$(subdirforlib)/$$i ; \
d322 1
a322 1
		$(INSTALL_DATA) $$i $(tooldir)/lib/$(subdirforlib)/$$i ; \
d325 1
a325 1
		dstdir=$(tooldir)/include/$(HEADER_SUBDIR)/$$sub ; \
@


1.14
log
@* Makefile.in: Install libstdc++.a if it does not exist.
@
text
@d297 1
a297 1
install: all install-dirs $(install_dlls_host) $(tooldir)/lib$(subdirforlib)/libstdc++.a
a311 6

$(tooldir)/lib$(subdirforlib)/libstdc++.a: libstdc++.a
	@@[ -f $? ] && cp -vp $? $@@; exit 0

libstdc++.a:
	@@true
@


1.13
log
@
	* include/_mingw.h: Change version to 1.0.
	Makefile.in: Ditto.
@
text
@d297 1
a297 1
install: all install-dirs $(install_dlls_host)
d312 6
@


1.12
log
@
	* Makefile.in: Increment version to 0.5
	* include/_mingw.h: Increment minor version
@
text
@d21 1
a21 1
VERSION = 0.5
@


1.11
log
@
	* Makefile.in: eliminate the need for RUNTIME and CRT_ID.
	Always build crt1.o, dllcrt1.o, crt2.o and dllcrt2.o.
	Create a libcoldname.a for the oldname library for CRTDLL.
	Restrict libmoldname.a for the oldname library for MSVCRT.
	* configure.in: eliminate setting RUNTIME and CRT_ID variables.
	Restructure the $target_os case logic.
	Always name the MinGW thread dll helper mingwm.
	Change Cygwin's HEADER_SUBDIR value from mingw32 to mingw.
	* configure: regenerate.
@
text
@d21 1
a21 1
VERSION = 0.4
@


1.10
log
@
	* Makefile.in: Fix bindist target to distribute the correct files.
	Remove the use of SNAPSHOT variable and test SNAPDATE instead.
	Set SNAPDATE within the snapshot target on recursive call to $(MAKE).
@
text
@d119 1
a119 1
CRT0S = crt$(CRT_ID).o dllcrt$(CRT_ID).o CRT_noglob.o crtmt.o crtst.o
d125 1
a125 1
       libmoldname.a $(LIBM_A) libmingwthrd.a
d192 4
a195 4
$(srcdir)/moldname-$(RUNTIME).def: moldname.def.in
	$(CC) -DRUNTIME=$(RUNTIME) \
		-D__FILENAME__=moldname-${RUNTIME}.def \
		-D__`echo $(RUNTIME) | tr '[a-z]' '[A-Z]'`__  -c -E -P \
d198 15
a212 1
libmoldname.a: $(srcdir)/moldname-$(RUNTIME).def $(MOLD_OBJS)
d214 2
a215 2
		--dllname $(RUNTIME).dll	\
		--def $(srcdir)/moldname-$(RUNTIME).def	\
d220 4
a223 1
# The special rule is necessary.
d225 1
a225 1
	$(CC) -c -D__MSVCRT__ $(ALL_CFLAGS) $< -o $@@
@


1.9
log
@
	* Makefile.in: Add missing line continuation `\' for $(SUBDIRS) target.
	Add variables and targets to control binary and source distributions.
	Add variables and targets to control snapshot distribution.
	* profile/gmon.h: Add missing #endif for #ifndef.
	* profile/ChangeLog: Merge entries here and remove.
	* profile/Makefile.in: Add variables and targets to control
	distribution.
	* README: Add.
	* TODO: ditto.
	* config.guess: ditto.
	* config.sub: ditto.
	* mkinstalldirs: ditto.
	* install-sh: ditto.
	* configure: regenerate.
	* profile/configure: ditto.
@
text
@d108 10
a117 1
	DLLTOOL="$(DLLTOOL)"
d222 1
a222 1
ifdef SNAPSHOT
d245 1
d254 1
a254 1
	$(MAKE) install prefix=../$(distdir)
d256 10
a265 1
	cd $(distdir); $(TAR) czf ../$(distdir).tar.gz .
a266 1
SNAPDATE = $(shell date '+%Y%m%d')
d268 1
a268 1
	make dist SNAPSHOT=1
@


1.8
log
@* Makefile.in: Use a different variable name for subdirectory since the
previous one was used by the top level make.
@
text
@d20 3
d60 1
a60 1
subdirforlib=/mingw
d62 1
a62 1
libdir=
d95 1
d120 7
d130 1
a130 1
all : $(CRT0S) $(LIBS) $(all_dlls_host)
d213 39
d288 1
a288 1
	    cd ./$@@; 
@


1.7
log
@* Makefile.in: Install mingw stuff in a subdirectory if building under cygwin.
@
text
@d57 1
a57 1
libsubdir=/mingw
d210 1
a210 1
	$(mkinstalldirs) $(tooldir)/lib$(libsubdir)
d214 1
a214 1
		$(INSTALL_DATA) $$i $(tooldir)/lib$(libsubdir)/$$i ; \
d217 1
a217 1
		$(INSTALL_DATA) $$i $(tooldir)/lib/$(libsubdir)/$$i ; \
@


1.6
log
@Add comment.
@
text
@d56 5
d208 1
a208 1
install: all $(install_dlls_host)
d210 3
a212 1
	$(mkinstalldirs) $(tooldir)/lib 
d214 1
a214 1
		$(INSTALL_DATA) $$i $(tooldir)/lib/$$i ; \
d217 1
a217 1
		$(INSTALL_DATA) $$i $(tooldir)/lib/$$i ; \
@


1.5
log
@* Makefile.in (subdirs): Eliminate for loop.
@
text
@d224 2
@


1.4
log
@* Makefile.in (subdirs): Previous change did not fix problem in broken shells.
@
text
@d221 12
a232 11
subdirs: force
	@@for i in should-never-exist $(SUBDIRS); do \
	   if [ -d ./$$i ] ; then \
	     echo "Making $(DO) in $${i}..." ; \
	     if (rootme=`pwd`/ ; export rootme ; \
	       rootsrc=`cd $(srcdir); pwd`/ ; export rootsrc ; \
	       cd ./$$i; \
	       $(MAKE) $(FLAGS_TO_PASS) $(DO)) ; then true ; \
	     else exit 1 ; fi ; \
	   else true ; fi ; \
	done
@


1.3
log
@* Makefile.in: Avoid installing dll if we're cross building and the cross-host
system isn't a Windows system.
@
text
@d222 1
a222 3
	@@test -z "$(SUBDIRS)" && exit 0; \
	for i in $(SUBDIRS); do \
	   echo "Making $(DO) in $${i}..." ; \
d224 1
@


1.2
log
@2000-03-30  Mumit Khan  <khan@@xraylith.wisc.edu>

	* Makefile.in (subdirs): Workaround for broken shells.
@
text
@d111 4
a114 1
all : $(CRT0S) $(LIBS) $(DLLS)
d117 7
d203 1
a203 1
install: all
a204 3
	for i in $(DLLS); do \
		$(INSTALL_PROGRAM) $$i $(bindir)/$$i ; \
	done
@


1.1
log
@Initial revision
@
text
@d215 2
a216 1
	@@for i in $(SUBDIRS); do \
@


1.1.1.1
log
@import winsup-2000-02-17 snapshot
@
text
@@
