head	1.26;
access;
symbols
	cygwin-1_7_35-release:1.26
	cygwin-1_7_34-release:1.26
	cygwin-1_7_33-release:1.26
	cygwin-1_7_32-release:1.26
	cygwin-1_7_31-release:1.26
	cygwin-1_7_30-release:1.26
	cygwin-1_7_29-release:1.26
	cygwin-1_7_29-release-branchpoint:1.26.0.4
	cygwin-1_7_28-release:1.26
	cygwin-1_7_27-release:1.26
	cygwin-1_7_26-release:1.26
	cygwin-1_7_25-release:1.26
	cygwin-1_7_24-release:1.26
	cygwin-1_7_23-release:1.26
	cygwin-1_7_22-release:1.26
	cygwin-1_7_21-release:1.26
	cygwin-1_7_20-release:1.26
	cygwin-1_7_19-release:1.26
	cygwin-64bit-postmerge:1.26
	cygwin-64bit-premerge-branch:1.26.0.2
	cygwin-64bit-premerge:1.26
	cygwin-1_7_18-release:1.26
	cygwin-1_7_17-release:1.25
	cygwin-64bit-branch:1.25.0.2
	cygwin-1_7_16-release:1.25
	cygwin-1_7_15-release:1.25
	cygwin-1_7_14_2-release:1.25
	cygwin-1_7_14-release:1.25
	cygwin-1_7_12-release:1.25
	cygwin-1_7_11-release:1.25
	cygwin-1_7_10-release:1.25
	cygwin-1_7_9-release:1.25
	cygwin-1_7_8-release:1.25
	cygwin-1_7_7-release:1.25
	cygwin-1_7_5-release:1.25
	cygwin-1_7_4-release:1.25
	cygwin-1_7_3-release:1.25
	cygwin-1_7_2-release:1.25
	cygwin-1_7_1-release:1.25
	cv-branch-2:1.24.0.2
	cr-0x5f1:1.23.0.2
	cv-branch:1.21.0.4
	cr-0x3b58:1.21.0.2
	cr-0x9e:1.19.0.10
	cr-0x9d:1.19.0.8
	corinna-01:1.19
	cr-0x9c:1.19.0.6
	cr-0x9b:1.19.0.4
	cr-0x99:1.19
	Z-emcb-cygwin_daemon:1.19.0.2
	w32api-2_2:1.14
	mingw-runtime-2_4:1.14
	cygnus_cvs_20020108_pre:1.5
	Z-cygwin_daemon_merge-new_HEAD:1.3
	Z-cygwin_daemon_merge_HEAD:1.3
	cygwin_daemon:1.3.0.8;
locks; strict;
comment	@# @;


1.26
date	2012.11.23.14.52.07;	author cgf;	state Exp;
branches;
next	1.25;

1.25
date	2009.11.01.17.22.44;	author cgf;	state Exp;
branches
	1.25.2.1;
next	1.24;

1.24
date	2008.11.26.16.42.27;	author cgf;	state Exp;
branches;
next	1.23;

1.23
date	2006.07.23.23.28.49;	author cgf;	state Exp;
branches;
next	1.22;

1.22
date	2006.07.18.03.24.07;	author cgf;	state Exp;
branches;
next	1.21;

1.21
date	2006.01.02.06.15.57;	author cgf;	state Exp;
branches
	1.21.4.1;
next	1.20;

1.20
date	2005.06.06.21.13.31;	author cgf;	state Exp;
branches;
next	1.19;

1.19
date	2003.07.06.21.45.21;	author cgf;	state Exp;
branches;
next	1.18;

1.18
date	2003.07.06.19.25.40;	author cgf;	state Exp;
branches;
next	1.17;

1.17
date	2003.07.06.19.24.31;	author cgf;	state Exp;
branches;
next	1.16;

1.16
date	2003.03.09.19.46.29;	author cgf;	state Exp;
branches;
next	1.15;

1.15
date	2003.03.09.17.03.05;	author cgf;	state Exp;
branches;
next	1.14;

1.14
date	2003.02.08.02.56.48;	author cgf;	state Exp;
branches;
next	1.13;

1.13
date	2003.01.24.01.30.43;	author cgf;	state Exp;
branches;
next	1.12;

1.12
date	2003.01.24.01.09.38;	author cgf;	state Exp;
branches;
next	1.11;

1.11
date	2003.01.23.21.21.28;	author cgf;	state Exp;
branches;
next	1.10;

1.10
date	2003.01.23.21.14.56;	author cgf;	state Exp;
branches;
next	1.9;

1.9
date	2003.01.22.15.18.58;	author corinna;	state Exp;
branches;
next	1.8;

1.8
date	2003.01.22.03.57.52;	author cgf;	state Exp;
branches;
next	1.7;

1.7
date	2002.08.26.02.53.24;	author cgf;	state Exp;
branches;
next	1.6;

1.6
date	2002.07.04.03.08.00;	author cgf;	state Exp;
branches;
next	1.5;

1.5
date	2001.11.04.05.14.16;	author cgf;	state Exp;
branches;
next	1.4;

1.4
date	2001.11.04.05.06.23;	author cgf;	state Exp;
branches;
next	1.3;

1.3
date	2001.03.09.15.39.28;	author duda;	state Exp;
branches;
next	1.2;

1.2
date	2000.09.04.19.04.53;	author corinna;	state Exp;
branches;
next	1.1;

1.1
date	2000.09.03.03.58.16;	author cgf;	state Exp;
branches;
next	;

1.25.2.1
date	2012.11.23.15.14.39;	author corinna;	state Exp;
branches;
next	;

1.21.4.1
date	2006.07.24.11.46.28;	author corinna;	state Exp;
branches;
next	;


desc
@@


1.26
log
@cygwin/ChangeLog:
2012-11-23  Christopher Faylor  <me.cygwin2012@@cgf.cx>

	* Makefile.in: Use explicit path to mkdir.

lsaauth/ChangeLog:
2012-11-23  Christopher Faylor  <me.cygwin2012@@cgf.cx>

	* Makefile.in: Use /bin/mkdir to make directories.

testsuite/ChangeLog:
2012-11-23  Christopher Faylor  <me.cygwin2012@@cgf.cx>

	* Makefile.in: Remove old Makefile.common'isms.  Don't rely on
	in-build tools.
@
text
@# Makefile.in for Cygwin's testsuite.
# Copyright 2000, 2001, 2002, 2003, 2005, 2006, 2009, 2012 Red Hat, Inc.
#
# This file is part of Cygwin.
#
# This software is a copyrighted work licensed under the terms of the
# Cygwin license.  Please consult the file "CYGWIN_LICENSE" for
# details.

# This makefile requires GNU make.

SHELL:=@@SHELL@@
srcdir:=@@srcdir@@
objdir:=.
libltp_srcdir=$(srcdir)/libltp

VPATH:=$(srcdir):$(libltp_srcdir)/lib

target_alias:=@@target_alias@@
build_alias:=@@build_alias@@
host_alias:=@@host_alias@@

DESTDIR=
prefix:=${DESTDIR}@@prefix@@

program_transform_name:=@@program_transform_name@@
exec_prefix:=${DESTDIR}@@exec_prefix@@
bindir:=${DESTDIR}@@bindir@@
libdir:=${DESTDIR}@@libdir@@
ifeq ($(target_alias),$(host_alias))
ifeq ($(build_alias),$(host_alias))
tooldir:=$(exec_prefix)
else
tooldir:=$(exec_prefix)/$(target_alias)
endif
else
tooldir:=$(exec_prefix)/$(target_alias)
endif
datadir:=${DESTDIR}@@datadir@@
infodir:=${DESTDIR}@@infodir@@
includedir:=${DESTDIR}@@includedir@@

TESTSUP_INCLUDES:=-I$(libltp_srcdir)/include

#
# --enable options from configure
#

CC:=@@CC@@
# FIXME: Which is it, CC or CC_FOR_TARGET?
CC_FOR_TARGET:=$(CC)
ifneq (,$(CFLAGS))
  override CFLAGS+= -MD $(TESTSUP_INCLUDES)
else
  CFLAGS:=@@CFLAGS@@ -MD $(TESTSUP_INCLUDES)
endif

AR:=@@AR@@
AR_FLAGS:=qv
MINGW_FE:=$(dir ${srcdir})/utils/mingw

#
# Include common definitions for winsup directory
#
include $(srcdir)/../Makefile.common

override CC:=$(CC) $(GCC_INCLUDE)
export CC

RUNTESTFLAGS =

ifdef VERBOSE
    RUNTESTFLAGS = -v
endif

RUNTIME=$(cygwin_build)/cygwin0.dll $(cygwin_build)/libcygwin0.a

TESTSUP_LIB_NAME:=libltp.a
TESTSUP_OFILES:=${sort ${addsuffix .o,${basename ${notdir ${wildcard $(libltp_srcdir)/lib/*.c}}}}}

override ALL_CFLAGS:=${filter-out -O%,$(ALL_CFLAGS)}
override COMPILE_CC:=${filter-out -O%,$(COMPILE_CC)}
override CFLAGS:=${filter-out -O%,$(CFLAGS)}
export CFLAGS

.PHONY: all force dll_ofiles install all_target install_target install_host

.SUFFIXES:
.SUFFIXES: .c .cc .def .a .o .d

all: $(TESTSUP_LIB_NAME)

force:

install:

install_host:

clean:
	-rm -f *.o *.dll *.a *.exp junk *.bak *.base *.exe testsuite/* *.d *.dat

maintainer-clean realclean: clean
	@@echo "This command is intended for maintainers to use;"
	@@echo "it deletes files that may require special tools to rebuild."
	-rm -fr configure

# Rule to build libltp.a

$(TESTSUP_LIB_NAME): $(TESTSUP_OFILES)
	$(AR) rcv temp.a $(TESTSUP_OFILES)
	mv temp.a $(TESTSUP_LIB_NAME)

$(RUNTIME) : $(cygwin_build)/Makefile
	@@$(MAKE) --no-print-dir -C $(@@D) $(@@F)

# Rule to make stub library used by "make check"

#

# These targets are for the dejagnu testsuites. The file site.exp
# contains global variables that all the testsuites will use.

# Set to $(target_alias)/ for cross.
target_subdir = @@target_subdir@@

site.exp: ./config.status Makefile
	@@echo "Making a new config file..."
	-@@rm -f ./tmp?
	@@touch site.exp
	-@@mv site.exp site.bak
	@@echo "## these variables are automatically generated by make ##" > ./tmp0
	@@echo "# Do not edit here. If you wish to override these values" >> ./tmp0
	@@echo "# add them to the last section" >> ./tmp0
	@@echo "set rootme \"`pwd`\"" >> ./tmp0
	@@echo "set runtime_root \"\$$rootme/../cygwin\"" >> ./tmp0
	@@echo "set srcdir \"`cd ${srcdir}; pwd`\"" >> ./tmp0
	@@echo "set host_triplet $(host_canonical)" >> ./tmp0
	@@echo "set build_triplet $(build_canonical)" >> ./tmp0
	@@echo "set target_triplet $(target)" >> ./tmp0
	@@echo "set target_alias $(target_alias)" >> ./tmp0
	@@echo "set CC \"$(CC)\"" >> ./tmp0
# CFLAGS is set even though it's empty to show we reserve the right to set it.
	@@echo "set CFLAGS \"$(ALL_CFLAGS)\"" >> ./tmp0
	echo "set tmpdir $(objdir)/testsuite" >> ./tmp0
	@@echo "set ltp_includes \"$(libltp_srcdir)/include\"" >> ./tmp0
	@@echo "## All variables above are generated by configure. Do Not Edit ##" >> ./tmp0
	@@cat ./tmp0 > site.exp
	@@cat site.bak | sed \
		-e '1,/^## All variables above are.*##/ d' >> site.exp
	-@@rm -f ./tmp?

testsuite/site.exp: site.exp
	if [ -d testsuite ]; then \
	  true; \
	else \
	  mkdir testsuite; \
	fi
	rm -rf testsuite/site.exp
	cp site.exp testsuite/site.exp

# Note: we set the PATH so that we can pick up cygwin0.dll

check: $(TESTSUP_LIB_NAME) $(RUNTIME) cygrun.exe testsuite/site.exp
	cd testsuite; runtest --tool winsup $(RUNTESTFLAGS)

cygrun.o: cygrun.c
	${MINGW_FE} $(CC) $(MINGW_CFLAGS) -o $@@ -c $<

cygrun.exe : cygrun.o
	${MINGW_FE} $(CC) ${MINGW_LDFLAGS} -o $@@ $<
@


1.25
log
@* Makefile.in: Use utils mingw front-end to generate non-cygwin binary.
@
text
@d2 1
a2 1
# Copyright 2000, 2001, 2002, 2003, 2005, 2006, 2009 Red Hat, Inc.
d164 1
a164 7
	cd testsuite; \
	export EXPECT=expect ; \
	if [ -f $(bupdir2)/expect/expect ] ; then  \
	   TCL_LIBRARY=`cd .. ; cd ${srcdir}/../../tcl/library ; pwd` ; \
	    export TCL_LIBRARY ; fi ; \
	PATH=$(bupdir)/cygwin:$${PATH} ;\
	runtest --tool winsup $(RUNTESTFLAGS) ;\
@


1.25.2.1
log
@Pull in changes from HEAD
@
text
@d2 1
a2 1
# Copyright 2000, 2001, 2002, 2003, 2005, 2006, 2009, 2012 Red Hat, Inc.
d164 7
a170 1
	cd testsuite; runtest --tool winsup $(RUNTESTFLAGS)
@


1.24
log
@* Revert erroneous checkin.
@
text
@d2 1
a2 1
# Copyright 2000, 2001, 2002, 2003, 2005, 2006 Red Hat, Inc.
d60 1
d173 1
a173 1
	$(CC) $(MINGW_CFLAGS) -o $@@ -c $<
d176 1
a176 1
	$(CC) ${MINGW_LDFLAGS} -mno-cygwin -o $@@ $<
@


1.23
log
@* Makefile.in: Update copyrigh.  Remove unused stuff.
@
text
@d22 3
a24 1
prefix:=@@prefix@@
d27 3
a29 3
exec_prefix:=@@exec_prefix@@
bindir:=@@bindir@@
libdir:=@@libdir@@
d39 3
a41 3
datadir:=@@datadir@@
infodir:=@@infodir@@
includedir:=@@includedir@@
@


1.22
log
@* Makefile.in: Simplify a little.
@
text
@d2 1
a2 1
# Copyright 2000, 2001, 2002, 2003 Red Hat, Inc.
a42 3
INSTALL:=@@INSTALL@@
INSTALL_PROGRAM:=@@INSTALL_PROGRAM@@

a54 1
CXXFLAGS:=@@CXXFLAGS@@
a57 5
RANLIB:=@@RANLIB@@
LD:=@@LD@@
DLLTOOL:=@@DLLTOOL@@
WINDRES:=@@WINDRES@@
AS:=@@AS@@
a66 2
INSTALL_DATA:=$(SHELL) $(updir1)/install-sh -c

d83 1
a83 1
.PHONY: all force dll_ofiles install all_target install_target all_host install_host
a87 3
all_host=@@all_host@@
install_host=@@install_host@@

@


1.21
log
@* cygload/README: Delete.
* cygload/cygload.cc: Move to winsup.api.  Add comments from README.
* cygload/cygload.h: Move to winsup.api.
* cygload/cygload.exp: Move to winsup.api.
* Makefile.in: Remove cygload.
* winsup.api/winsup.exp: If a .exp file is detected, run it rather than using
standard compile.
* winsup.api/resethand.c (main): Use printf to print status or expect thinks
something is wrong.
@
text
@a77 8
# Setup the testing framework, if you have one
EXPECT = `if [ -f $${rootme}/../../expect/expect$(EXEEXT) ] ; then \
            echo $${rootme}/../../expect/expect$(EXEEXT) ; \
          else echo expect ; fi`

RUNTEST = `if [ -f ${srcdir}/../../dejagnu/runtest ] ; then \
	       echo ${srcdir}/../../dejagnu/runtest ; \
	    else echo runtest; fi`
d176 1
a176 1
	EXPECT=${EXPECT} ; export EXPECT ; \
d181 1
a181 1
	$(RUNTEST) --tool winsup $(RUNTESTFLAGS) ;\
@


1.21.4.1
log
@	* Merge HEAD into cv-branch.
@
text
@d2 1
a2 1
# Copyright 2000, 2001, 2002, 2003, 2005, 2006 Red Hat, Inc.
d43 3
d58 1
d62 5
d76 10
d102 1
a102 1
.PHONY: all force dll_ofiles install all_target install_target install_host
d107 3
d184 1
a184 1
	export EXPECT=expect ; \
d189 1
a189 1
	runtest --tool winsup $(RUNTESTFLAGS) ;\
@


1.20
log
@* Makefile.in: Test cygload.
* cygload: New directory.
* cygload/README: New file.
* cygload/Makefile: Ditto.
* cygload/cygload.h: Ditto.
* cygload/cygload.cc: Ditto.
* cygload/cygload.exp: Ditto.
@
text
@a189 1
	$(RUNTEST) --tool cygload $(RUNTESTFLAGS)
@


1.19
log
@update copyright
@
text
@d189 2
a190 1
	$(RUNTEST) --tool winsup $(RUNTESTFLAGS)
@


1.18
log
@* Makefile.in: Remove .dat files when cleaning.
@
text
@d2 1
a2 1
# Copyright 2000 Red Hat, Inc.
@


1.17
log
@* Makefile.in: Remove .d files when cleaning.
@
text
@d119 1
a119 1
	-rm -f *.o *.dll *.a *.exp junk *.bak *.base *.exe testsuite/* *.d
@


1.16
log
@* winsup.api/winsup.exp: Use -nostdinc when compiling.
* Makefile.in: Specifically search compiler include directory since it is now
stripped via -nostdinc.
@
text
@d119 1
a119 1
	-rm -f *.o *.dll *.a *.exp junk *.bak *.base *.exe testsuite/*
@


1.15
log
@* Makefile.in: Use "cygwin0" rather than "new-cygwin" to denote in-build-tree
version of library or dll.
* config/default.exp: Ditto.
* winsup.api/winsup.exp: Ditto.
@
text
@d73 3
d100 1
@


1.14
log
@* libltp/lib/parse_opts.c: Deal with C warnings.
* winsup.api/pthread/cancel12.c: Ditto.
* winsup.api/winsup.exp: Don't use -g3.
@
text
@d89 1
a89 1
RUNTIME=$(cygwin_build)/new-cygwin1.dll $(cygwin_build)/new-libcygwin.a
d176 1
a176 1
# Note: we set the PATH so that we can pick up new-cygwin1.dll
@


1.13
log
@* Makefile (check): Add cygrun.exe dependency.
@
text
@a58 1
export ALL_CFLAGS
d93 4
@


1.12
log
@Perform more C warning fixup on all C source files and headers.
@
text
@d175 1
a175 1
check: $(TESTSUP_LIB_NAME) $(RUNTIME) testsuite/site.exp
@


1.11
log
@* libltp/include/test.h: Fix C warnings.
* winsup.api/checksignal.c: Ditto.
* winsup.api/crlf.c: Ditto.
* winsup.api/devzero.c: Ditto.
* winsup.api/iospeed.c: Ditto.
* winsup.api/mmaptest01.c: Ditto.
* winsup.api/mmaptest02.c: Ditto.
* winsup.api/mmaptest03.c: Ditto.
* winsup.api/mmaptest04.c: Ditto.
* winsup.api/nullgetcwd.c: Ditto.
* winsup.api/sigchld.c: Ditto.
* winsup.api/signal-into-win32-api.c: Ditto.
* winsup.api/systemcall.c: Ditto.
* winsup.api/waitpid.c: Ditto.
* winsup.api/pthread/mainthreadexits.c: Ditto.
* winsup.api/pthread/test.h: Ditto.
* winsup.api/pthread/threadidafterfork.c: Ditto.
* Makefile.in: Remove cygrun.exe from RUNTIME since it is built here now.
@
text
@a52 1
#CFLAGS:=@@CFLAGS@@ -MD -Wno-write-strings $(TESTSUP_INCLUDES)
@


1.10
log
@* Makeifle.in: Use ALL_CFLAGS to build test programs so that correct libraries
and other options are used.
@
text
@d91 1
a91 1
RUNTIME=$(cygwin_build)/new-cygwin1.dll $(cygwin_build)/new-libcygwin.a cygrun.exe
a189 1

@


1.9
log
@	* cygrun.c: Move here from ../cygwin.
	* Makefile.in: Build cygrun.exe.
	* winsup.api/winsup.exp: Expect cygrun.exe in $rootme.
@
text
@d60 1
d156 1
a156 1
	@@echo "set CFLAGS \"\"" >> ./tmp0
@


1.8
log
@* Makefile.in: Find tcl library in the right place.
@
text
@d90 1
a90 1
RUNTIME=$(cygwin_build)/new-cygwin1.dll $(cygwin_build)/new-libcygwin.a $(cygwin_build)/cygrun.exe
d183 7
@


1.7
log
@* Makefile.in (RUNTEST): Use Makefile's srcdir and bupdir* macros, where
appropriate.
* winsup.api/winsup.exp: Use -nodefaultlibs when linking executable to avoid
potentially linking installed dll.
@
text
@d179 1
a179 1
	   TCL_LIBRARY=`cd .. ; cd ${srcdir}/../tcl/library ; pwd` ; \
@


1.6
log
@* Makefile.in: Eliminate unneeded Makefile recreation rule.
@
text
@d81 2
a82 2
RUNTEST = `if [ -f $${srcdir}/../../dejagnu/runtest ] ; then \
	       echo $${srcdir}/../../dejagnu/runtest ; \
a175 2
	-rootme=`pwd`; export rootme; \
	srcdir=`cd ${srcdir}; pwd` ; export srcdir ; \
d178 1
a178 1
	if [ -f $${rootme}/../expect/expect ] ; then  \
d181 1
a181 1
	PATH=$${rootme}/../cygwin:$${PATH} ;\
@


1.5
log
@* Makefile.in: Oops.  Revert previous change.  Add Makefile/Makefile.in
dependency.
@
text
@a184 5

Makefile: Makefile.in $(srcdir)/configure.in config.status
	$(SHELL) config.status
#

@


1.4
log
@* Makefile.in: Add check target.
@
text
@d103 1
a103 1
all check: $(TESTSUP_LIB_NAME)
d186 2
@


1.3
log
@* config/default.exp: Remove unneeded debugging output.
* Makefile.in: Use correct path to find dejagnu in local tree.
@
text
@d103 1
a103 1
all: $(TESTSUP_LIB_NAME)
@


1.2
log
@Patch by Egor Duda <deo@@logos-m.ru>:
*  Makefile.in: Always add libltp headers directory to headers
search path.
@
text
@d81 2
a82 2
RUNTEST = `if [ -f $${srcdir}/../dejagnu/runtest ] ; then \
	       echo $${srcdir}/../dejagnu/runtest ; \
@


1.1
log
@Importing Egor's testsuite.
@
text
@d53 6
a58 1
CFLAGS:=@@CFLAGS@@ -MD -Wno-write-strings $(TESTSUP_INCLUDES)
@

