head	1.52;
access;
symbols
	csl-arm-2003-q4:1.51
	drow-cplus-merge-20031224:1.51
	drow-cplus-merge-20031220:1.51
	carlton_dictionary-20031215-merge:1.51
	drow-cplus-merge-20031214:1.51
	carlton-dictionary-20031111-merge:1.51
	gdb_6_0-2003-10-04-release:1.48
	kettenis_sparc-20030918-branch:1.49.0.4
	kettenis_sparc-20030918-branchpoint:1.49
	carlton_dictionary-20030917-merge:1.49
	ezannoni_pie-20030916-branchpoint:1.49
	ezannoni_pie-20030916-branch:1.49.0.2
	cagney_x86i386-20030821-branch:1.48.0.4
	cagney_x86i386-20030821-branchpoint:1.48
	carlton_dictionary-20030805-merge:1.48
	carlton_dictionary-20030627-merge:1.48
	gdb_6_0-branch:1.48.0.2
	gdb_6_0-2003-06-23-branchpoint:1.48
	jimb-ppc64-linux-20030613-branch:1.47.0.2
	jimb-ppc64-linux-20030613-branchpoint:1.47
	binutils-2_14:1.44
	cagney_convert-20030606-branch:1.46.0.10
	cagney_convert-20030606-branchpoint:1.46
	cagney_writestrings-20030508-branch:1.46.0.8
	cagney_writestrings-20030508-branchpoint:1.46
	jimb-ppc64-linux-20030528-branch:1.46.0.6
	jimb-ppc64-linux-20030528-branchpoint:1.46
	carlton_dictionary-20030523-merge:1.46
	cagney_fileio-20030521-branch:1.46.0.4
	cagney_fileio-20030521-branchpoint:1.46
	kettenis_i386newframe-20030517-mergepoint:1.46
	jimb-ppc64-linux-20030509-branch:1.46.0.2
	jimb-ppc64-linux-20030509-branchpoint:1.46
	kettenis_i386newframe-20030504-mergepoint:1.44
	carlton_dictionary-20030430-merge:1.44
	binutils-2_14-branch:1.44.0.4
	binutils-2_14-branchpoint:1.44
	kettenis_i386newframe-20030419-branch:1.44.0.2
	kettenis_i386newframe-20030419-branchpoint:1.44
	carlton_dictionary-20030416-merge:1.43
	cagney_frameaddr-20030409-mergepoint:1.41
	kettenis_i386newframe-20030406-branch:1.41.0.14
	kettenis_i386newframe-20030406-branchpoint:1.41
	cagney_frameaddr-20030403-branchpoint:1.41
	cagney_frameaddr-20030403-branch:1.41.0.12
	cagney_framebase-20030330-mergepoint:1.41
	cagney_framebase-20030326-branch:1.41.0.10
	cagney_framebase-20030326-branchpoint:1.41
	cagney_lazyid-20030317-branch:1.41.0.8
	cagney_lazyid-20030317-branchpoint:1.41
	kettenis-i386newframe-20030316-mergepoint:1.41
	offbyone-20030313-branch:1.41.0.6
	offbyone-20030313-branchpoint:1.41
	kettenis-i386newframe-20030308-branch:1.41.0.4
	kettenis-i386newframe-20030308-branchpoint:1.41
	carlton_dictionary-20030305-merge:1.41
	cagney_offbyone-20030303-branch:1.41.0.2
	cagney_offbyone-20030303-branchpoint:1.41
	w32api-2_2:1.35
	mingw-runtime-2_4:1.35
	carlton_dictionary-20030207-merge:1.35
	interps-20030202-branch:1.35.0.2
	interps-20030202-branchpoint:1.35
	cagney-unwind-20030108-branch:1.32.0.16
	cagney-unwind-20030108-branchpoint:1.32
	binutils-2_13_2_1:1.32
	binutils-2_13_2:1.32
	carlton_dictionary-20021223-merge:1.32
	gdb_5_3-2002-12-12-release:1.32
	carlton_dictionary-20021115-merge:1.32
	binutils-2_13_1:1.32
	kseitz_interps-20021105-merge:1.32
	kseitz_interps-20021103-merge:1.32
	drow-cplus-merge-20021020:1.32
	drow-cplus-merge-20021025:1.32
	carlton_dictionary-20021025-merge:1.32
	carlton_dictionary-20021011-merge:1.32
	drow-cplus-branch:1.32.0.14
	drow-cplus-branchpoint:1.32
	kseitz_interps-20020930-merge:1.32
	carlton_dictionary-20020927-merge:1.32
	carlton_dictionary-branch:1.32.0.12
	carlton_dictionary-20020920-branchpoint:1.32
	sid-20020905-branchpoint:1.32
	sid-20020905-branch:1.32.0.10
	gdb_5_3-branch:1.32.0.8
	gdb_5_3-2002-09-04-branchpoint:1.32
	kseitz_interps-20020829-merge:1.32
	cagney_sysregs-20020825-branch:1.32.0.6
	cagney_sysregs-20020825-branchpoint:1.32
	readline_4_3-import-branch:1.32.0.4
	readline_4_3-import-branchpoint:1.32
	binutils-2_13:1.32
	gdb_5_2_1-2002-07-23-release:1.26
	binutils-2_13-branchpoint:1.32
	binutils-2_13-branch:1.32.0.2
	kseitz_interps-20020528-branch:1.30.0.4
	kseitz_interps-20020528-branchpoint:1.30
	cagney_regbuf-20020515-branch:1.30.0.2
	cagney_regbuf-20020515-branchpoint:1.30
	binutils-2_12_1:1.26
	jimb-macro-020506-branch:1.28.0.2
	jimb-macro-020506-branchpoint:1.28
	gdb_5_2-2002-04-29-release:1.26
	binutils-2_12:1.26
	gdb_5_2-branch:1.26.0.4
	gdb_5_2-2002-03-03-branchpoint:1.26
	binutils-2_12-branch:1.26.0.2
	binutils-2_12-branchpoint:1.26
	gdb_5_1_1-2002-01-24-release:1.13.2.1
	gdb_5_1_0_1-2002-01-03-release:1.13.2.1
	cygnus_cvs_20020108_pre:1.23
	gdb_5_1_0_1-2002-01-03-branch:1.13.2.1.0.2
	gdb_5_1_0_1-2002-01-03-branchpoint:1.13.2.1
	gdb_5_1-2001-11-21-release:1.13.2.1
	gdb_s390-2001-09-26-branch:1.13.0.4
	gdb_s390-2001-09-26-branchpoint:1.13
	gdb_5_1-2001-07-29-branch:1.13.0.2
	gdb_5_1-2001-07-29-branchpoint:1.13
	binutils-2_11_2:1.11
	binutils-2_11_1:1.11
	binutils-2_11:1.11
	x86_64versiong3:1.11
	binutils-2_11-branch:1.11.0.2
	insight-precleanup-2001-01-01:1.11
	binutils-2_10_1:1.4
	binutils-2_10:1.4
	gdb-premipsmulti-2000-06-06-branch:1.4.0.6
	gdb-premipsmulti-2000-06-06-branchpoint:1.4
	gdb_5_0-2000-05-19-release:1.4
	gdb_4_18_2-2000-05-18-release:1.4
	cygwin-1_1_1:1.4
	gdb_4_95_1-2000-05-11-snapshot:1.4
	gdb_4_95_0-2000-04-27-snapshot:1.4
	gdb_5_0-2000-04-10-branch:1.4.0.4
	gdb_5_0-2000-04-10-branchpoint:1.4
	binutils-2_10-branch:1.4.0.2
	binutils-2_10-branchpoint:1.4
	egcs_20000222:1.1.1.2
	binutils_latest_snapshot:1.51
	repo-unification-2000-02-06:1.3
	binu_ss_19990721:1.2
	binu_ss_19990602:1.2
	binu_ss_19990502:1.1.1.1
	cygnus:1.1.1;
locks; strict;
comment	@# @;


1.52
date	2004.01.10.04.10.18;	author dj;	state dead;
branches;
next	1.51;

1.51
date	2003.10.01.17.12.11;	author hjl;	state Exp;
branches;
next	1.50;

1.50
date	2003.09.25.14.26.41;	author drow;	state Exp;
branches;
next	1.49;

1.49
date	2003.08.27.21.15.13;	author drow;	state Exp;
branches;
next	1.48;

1.48
date	2003.06.19.20.05.36;	author dj;	state Exp;
branches;
next	1.47;

1.47
date	2003.06.13.01.50.48;	author dj;	state Exp;
branches;
next	1.46;

1.46
date	2003.05.07.18.06.23;	author jason;	state Exp;
branches;
next	1.45;

1.45
date	2003.05.04.23.05.58;	author dj;	state Exp;
branches;
next	1.44;

1.44
date	2003.04.16.23.09.21;	author dj;	state Exp;
branches
	1.44.2.1;
next	1.43;

1.43
date	2003.04.16.03.51.54;	author dj;	state Exp;
branches;
next	1.42;

1.42
date	2003.04.14.18.27.58;	author dj;	state Exp;
branches;
next	1.41;

1.41
date	2003.02.22.17.08.33;	author dj;	state Exp;
branches;
next	1.40;

1.40
date	2003.02.21.22.12.51;	author dj;	state Exp;
branches;
next	1.39;

1.39
date	2003.02.21.17.33.57;	author dj;	state Exp;
branches;
next	1.38;

1.38
date	2003.02.21.01.35.29;	author dj;	state Exp;
branches;
next	1.37;

1.37
date	2003.02.20.22.13.32;	author drow;	state Exp;
branches;
next	1.36;

1.36
date	2003.02.20.09.08.42;	author aoliva;	state Exp;
branches;
next	1.35;

1.35
date	2003.01.30.20.00.42;	author dj;	state Exp;
branches;
next	1.34;

1.34
date	2003.01.25.00.23.30;	author dj;	state Exp;
branches;
next	1.33;

1.33
date	2003.01.24.21.31.35;	author dj;	state Exp;
branches;
next	1.32;

1.32
date	2002.07.01.18.02.30;	author dj;	state Exp;
branches
	1.32.12.1
	1.32.14.1;
next	1.31;

1.31
date	2002.06.06.12.55.24;	author dj;	state Exp;
branches;
next	1.30;

1.30
date	2002.05.08.14.22.36;	author dj;	state Exp;
branches
	1.30.2.1
	1.30.4.1;
next	1.29;

1.29
date	2002.05.07.19.04.21;	author dj;	state Exp;
branches;
next	1.28;

1.28
date	2002.03.26.23.29.30;	author dj;	state Exp;
branches;
next	1.27;

1.27
date	2002.03.04.22.01.26;	author dj;	state Exp;
branches;
next	1.26;

1.26
date	2002.01.31.19.01.15;	author dj;	state Exp;
branches;
next	1.25;

1.25
date	2002.01.22.22.32.35;	author rth;	state Exp;
branches;
next	1.24;

1.24
date	2002.01.22.20.14.52;	author dj;	state Exp;
branches;
next	1.23;

1.23
date	2001.12.24.19.13.07;	author dj;	state Exp;
branches;
next	1.22;

1.22
date	2001.12.11.14.46.51;	author dj;	state Exp;
branches;
next	1.21;

1.21
date	2001.11.28.02.11.49;	author dj;	state Exp;
branches;
next	1.20;

1.20
date	2001.11.26.21.23.10;	author dj;	state Exp;
branches;
next	1.19;

1.19
date	2001.11.15.19.06.06;	author dj;	state Exp;
branches;
next	1.18;

1.18
date	2001.11.13.03.54.15;	author dj;	state Exp;
branches;
next	1.17;

1.17
date	2001.09.27.20.27.58;	author dj;	state Exp;
branches;
next	1.16;

1.16
date	2001.09.26.18.45.49;	author dj;	state Exp;
branches;
next	1.15;

1.15
date	2001.08.22.02.12.15;	author dj;	state Exp;
branches;
next	1.14;

1.14
date	2001.08.17.21.14.20;	author dj;	state Exp;
branches;
next	1.13;

1.13
date	2001.07.05.17.29.17;	author dj;	state Exp;
branches
	1.13.2.1;
next	1.12;

1.12
date	2001.03.06.18.27.14;	author dj;	state Exp;
branches;
next	1.11;

1.11
date	2000.12.26.22.19.44;	author dj;	state Exp;
branches;
next	1.10;

1.10
date	2000.11.29.19.17.37;	author dj;	state Exp;
branches;
next	1.9;

1.9
date	2000.09.05.18.44.54;	author dj;	state Exp;
branches;
next	1.8;

1.8
date	2000.07.23.19.20.18;	author law;	state Exp;
branches;
next	1.7;

1.7
date	2000.07.23.16.05.33;	author law;	state Exp;
branches;
next	1.6;

1.6
date	2000.06.15.20.56.25;	author hjl;	state Exp;
branches;
next	1.5;

1.5
date	2000.06.06.17.52.20;	author dj;	state Exp;
branches;
next	1.4;

1.4
date	2000.02.22.16.14.35;	author ian;	state Exp;
branches;
next	1.3;

1.3
date	99.08.05.21.15.29;	author ian;	state Exp;
branches;
next	1.2;

1.2
date	99.05.06.20.59.16;	author rth;	state Exp;
branches;
next	1.1;

1.1
date	99.05.03.07.28.54;	author rth;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	99.05.03.07.28.54;	author rth;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2000.02.22.15.59.20;	author ian;	state Exp;
branches;
next	;

1.13.2.1
date	2001.11.11.19.08.39;	author cagney;	state Exp;
branches;
next	;

1.30.2.1
date	2002.06.15.16.43.18;	author cagney;	state Exp;
branches;
next	;

1.30.4.1
date	2002.06.20.01.37.58;	author kseitz;	state Exp;
branches;
next	1.30.4.2;

1.30.4.2
date	2002.07.22.21.47.15;	author kseitz;	state Exp;
branches;
next	;

1.32.12.1
date	2003.02.07.19.18.02;	author carlton;	state Exp;
branches;
next	1.32.12.2;

1.32.12.2
date	2003.03.06.00.56.38;	author carlton;	state Exp;
branches;
next	1.32.12.3;

1.32.12.3
date	2003.04.16.19.57.04;	author carlton;	state Exp;
branches;
next	1.32.12.4;

1.32.12.4
date	2003.05.01.00.46.57;	author carlton;	state Exp;
branches;
next	1.32.12.5;

1.32.12.5
date	2003.05.23.18.40.55;	author carlton;	state Exp;
branches;
next	1.32.12.6;

1.32.12.6
date	2003.06.27.21.50.23;	author carlton;	state Exp;
branches;
next	1.32.12.7;

1.32.12.7
date	2003.09.17.21.28.56;	author carlton;	state Exp;
branches;
next	1.32.12.8;

1.32.12.8
date	2003.11.11.23.51.15;	author carlton;	state Exp;
branches;
next	1.32.12.9;

1.32.12.9
date	2004.01.26.19.11.48;	author carlton;	state dead;
branches;
next	;

1.32.14.1
date	2003.12.14.20.28.02;	author drow;	state Exp;
branches;
next	1.32.14.2;

1.32.14.2
date	2004.01.13.16.12.17;	author drow;	state dead;
branches;
next	;

1.44.2.1
date	2003.05.18.09.44.40;	author kettenis;	state Exp;
branches;
next	;


desc
@@


1.52
log
@merge from gcc
@
text
@dnl Process this file with autoconf to produce a configure script

AC_PREREQ(2.57)
AC_INIT(xmalloc.c)

# This works around the fact that libtool configuration may change LD
# for this particular configuration, but some shells, instead of
# keeping the changes in LD private, export them just because LD is
# exported.  We don't use libtool yet, but some day we might, so...
ORIGINAL_LD_FOR_MULTILIBS=$LD

dnl We use these options to decide which functions to include.
AC_ARG_WITH(target-subdir,
[  --with-target-subdir=SUBDIR      Configuring in a subdirectory for target])
AC_ARG_WITH(build-subdir,
[  --with-build-subdir=SUBDIR       Configuring in a subdirectory for build])
AC_ARG_WITH(cross-host,
[  --with-cross-host=HOST           Configuring with a cross compiler])
AC_ARG_WITH(newlib,
[  --with-newlib                    Configuring with newlib])

if test "${srcdir}" = "."; then
  if test -n "${with_build_subdir}"; then
    libiberty_topdir="${srcdir}/../.."
    with_target_subdir=
  elif test -z "${with_target_subdir}"; then
    libiberty_topdir="${srcdir}/.."
  else
    if test "${with_target_subdir}" != "."; then
      libiberty_topdir="${srcdir}/${with_multisrctop}../.."
    else
      libiberty_topdir="${srcdir}/${with_multisrctop}.."
    fi
  fi
else
  libiberty_topdir="${srcdir}/.."
fi
AC_SUBST(libiberty_topdir)
AC_CONFIG_AUX_DIR($libiberty_topdir)

dnl Very limited version of automake's enable-maintainer-mode

AC_MSG_CHECKING([whether to enable maintainer-specific portions of Makefiles])
  dnl maintainer-mode is disabled by default
  AC_ARG_ENABLE(maintainer-mode,
[  --enable-maintainer-mode
                          enable make rules and dependencies not useful
                          (and sometimes confusing) to the casual installer],
      maintainer_mode=$enableval,
      maintainer_mode=no)

AC_MSG_RESULT($maintainer_mode)

if test "$maintainer_mode" = "yes"; then
  MAINT=''
  NOTMAINT='#'
else
  MAINT='#'
  NOTMAINT=''
fi
AC_SUBST(MAINT)dnl
AC_SUBST(NOTMAINT)dnl

# Do we have a single-tree copy of texinfo?  Even if we do, we can't
# rely on it - libiberty is built before texinfo.
AC_CHECK_PROG(MAKEINFO, makeinfo, makeinfo, )
if test "x$MAKEINFO" = "x"; then
    MAKEINFO="@@echo makeinfo missing; true"
    BUILD_INFO=
else
    BUILD_INFO=info
    case "$MAKEINFO" in
      */missing\ makeinfo*)
	BUILD_INFO=
	AC_MSG_WARN([
*** Makeinfo is missing. Info documentation will not be built.])
        ;;
      *)
	case x"`$MAKEINFO --version | grep 'GNU texinfo'`" in
	  x*\ [[1-3]].* )
	    MAKEINFO="@@echo $MAKEINFO is too old, 4.0 or newer required; true"
	    BUILD_INFO=
	    AC_MSG_WARN([
*** Makeinfo is too old. Info documentation will not be built.])
	  ;;
	esac
	;;
    esac
fi
AC_SUBST(MAKEINFO)
AC_SUBST(BUILD_INFO)

AC_CHECK_PROG(PERL, perl, perl, )
if test x"$PERL" = x""; then
  HAVE_PERL='#'
else
  HAVE_PERL=''
fi
AC_SUBST(HAVE_PERL)

AC_CANONICAL_HOST

dnl When we start using automake:
dnl AM_INIT_AUTOMAKE(libiberty, 1.0)

dnl These must be called before AM_PROG_LIBTOOL, because it may want
dnl to call AC_CHECK_PROG.
AC_CHECK_TOOL(AR, ar)
AC_CHECK_TOOL(RANLIB, ranlib, :)

GCC_NO_EXECUTABLES
AC_PROG_CC
AC_PROG_CPP_WERROR

if test x$GCC = xyes; then
  ac_libiberty_warn_cflags='-W -Wall -Wtraditional -pedantic'
fi
AC_SUBST(ac_libiberty_warn_cflags)

AC_PROG_CC_C_O
# autoconf is lame and doesn't give us any substitution variable for this.
if eval "test \"`echo '$ac_cv_prog_cc_'${ac_cc}_c_o`\" = no"; then
  NO_MINUS_C_MINUS_O=yes
else
  OUTPUT_OPTION='-o $@@'
fi
AC_SUBST(NO_MINUS_C_MINUS_O)
AC_SUBST(OUTPUT_OPTION)

AC_C_CONST
AC_C_INLINE
AC_C_BIGENDIAN_CROSS

dnl When we start using libtool:
dnl Default to a non shared library.  This may be overridden by the
dnl configure option --enable-shared.
dnl AM_DISABLE_SHARED

dnl When we start using libtool:
dnl AM_PROG_LIBTOOL

dnl When we start using automake:
dnl AM_CONFIG_HEADER(config.h:config.in)
AC_CONFIG_HEADER(config.h:config.in)

dnl When we start using automake:
dnl AM_MAINTAINER_MODE
dnl AC_EXEEXT

dnl When we start using automake:
dnl AM_PROG_INSTALL
AC_PROG_INSTALL

. ${srcdir}/config.table
host_makefile_frag=${frag}
AC_SUBST_FILE(host_makefile_frag)

# It's OK to check for header files.  Although the compiler may not be
# able to link anything, it had better be able to at least compile
# something.
AC_CHECK_HEADERS(sys/file.h sys/param.h limits.h stdlib.h malloc.h string.h unistd.h strings.h sys/time.h time.h sys/resource.h sys/stat.h sys/mman.h fcntl.h alloca.h sys/pstat.h sys/sysmp.h sys/sysinfo.h machine/hal_sysinfo.h sys/table.h sys/sysctl.h sys/systemcfg.h)
AC_HEADER_SYS_WAIT
AC_HEADER_TIME

libiberty_AC_DECLARE_ERRNO

AC_CHECK_TYPE(uintptr_t, unsigned long)
# Given the above check, we always have uintptr_t or a fallback
# definition.  So define HAVE_UINTPTR_T in case any imported code
# relies on it.
AC_DEFINE(HAVE_UINTPTR_T, 1, [Define if you have the \`uintptr_t' type.])

AC_TYPE_PID_T

# This is the list of functions which libiberty will provide if they
# are not available on the host.

funcs="asprintf"
funcs="$funcs atexit"
funcs="$funcs basename"
funcs="$funcs bcmp"
funcs="$funcs bcopy"
funcs="$funcs bsearch"
funcs="$funcs bzero"
funcs="$funcs calloc"
funcs="$funcs clock"
funcs="$funcs ffs"
funcs="$funcs getcwd"
funcs="$funcs getpagesize"
funcs="$funcs index"
funcs="$funcs insque"
funcs="$funcs memchr"
funcs="$funcs memcmp"
funcs="$funcs memcpy"
funcs="$funcs memmove"
funcs="$funcs mempcpy"
funcs="$funcs memset"
funcs="$funcs mkstemps"
funcs="$funcs putenv"
funcs="$funcs random"
funcs="$funcs rename"
funcs="$funcs rindex"
funcs="$funcs setenv"
funcs="$funcs snprintf"
funcs="$funcs sigsetmask"
funcs="$funcs stpcpy"
funcs="$funcs stpncpy"
funcs="$funcs strcasecmp"
funcs="$funcs strchr"
funcs="$funcs strdup"
funcs="$funcs strncasecmp"
funcs="$funcs strrchr"
funcs="$funcs strstr"
funcs="$funcs strtod"
funcs="$funcs strtol"
funcs="$funcs strtoul"
funcs="$funcs tmpnam"
funcs="$funcs vasprintf"
funcs="$funcs vfprintf"
funcs="$funcs vprintf"
funcs="$funcs vsnprintf"
funcs="$funcs vsprintf"
funcs="$funcs waitpid"

# Also in the old function.def file: alloca, vfork, getopt.

vars="sys_errlist sys_nerr sys_siglist"

checkfuncs="getrusage on_exit psignal strerror strsignal sysconf times sbrk gettimeofday"
checkfuncs="$checkfuncs realpath canonicalize_file_name pstat_getstatic pstat_getdynamic sysmp"
checkfuncs="$checkfuncs getsysinfo table sysctl"

# These are neither executed nor required, but they help keep
# autoheader happy without adding a bunch of text to acconfig.h.
if test "x" = "y"; then
  AC_CHECK_FUNCS(asprintf atexit basename bcmp bcopy bsearch bzero calloc clock \
  getcwd getpagesize index insque mkstemps memchr memcmp memcpy \
  memmove mempcpy memset putenv random rename rindex sigsetmask \
  strcasecmp setenv stpcpy stpncpy strchr strdup strncasecmp strrchr strstr \
  strtod strtol strtoul tmpnam vasprintf vfprintf vprintf \
  vsprintf waitpid getrusage on_exit psignal strerror strsignal \
  sysconf times sbrk gettimeofday ffs snprintf vsnprintf \
  pstat_getstatic pstat_getdynamic sysmp getsysinfo table sysctl \
  realpath canonicalize_file_name)
  AC_DEFINE(HAVE_SYS_ERRLIST, 1, [Define if you have the sys_errlist variable.])
  AC_DEFINE(HAVE_SYS_NERR,    1, [Define if you have the sys_nerr variable.])
  AC_DEFINE(HAVE_SYS_SIGLIST, 1, [Define if you have the sys_siglist variable.])
fi

# For each of these functions, if the host does not provide the
# function we want to put FN.o in LIBOBJS, and if the host does
# provide the function, we want to define HAVE_FN in config.h.

setobjs=
CHECK=
target_header_dir=
if test -n "${with_target_subdir}"; then

  # We are being configured as a target library.  AC_REPLACE_FUNCS
  # may not work correctly, because the compiler may not be able to
  # link executables.  Note that we may still be being configured
  # native.

  # If we are being configured for newlib, we know which functions
  # newlib provide and which ones we will be expected to provide.

  if test "x${with_newlib}" = "xyes"; then
    AC_LIBOBJ([asprintf])
    AC_LIBOBJ([basename])
    AC_LIBOBJ([insque])
    AC_LIBOBJ([random])
    AC_LIBOBJ([strdup])
    AC_LIBOBJ([vasprintf])

    for f in $funcs; do
      case "$f" in
	asprintf | basename | insque | random | strdup | vasprintf)
	  ;;
	*)
	  n=HAVE_`echo $f | tr 'abcdefghijklmnopqrstuvwxyz' 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'`
	  AC_DEFINE_UNQUOTED($n)
	  ;;
      esac
    done

    # newlib doesnt provide any of the variables in $vars, so we
    # dont have to check them here.

    # Of the functions in $checkfuncs, newlib only has strerror.
    AC_DEFINE_NOAUTOHEADER(HAVE_STRERROR)

    setobjs=yes

  fi

  # We may wish to install the target headers somewhere.
  AC_ARG_ENABLE(install-libiberty,
  [  --enable-install-libiberty       Install headers for end users],
  enable_install_libiberty=$enableval,
  enable_install_libiberty=no)dnl
  
  # Option parsed, now set things appropriately.
  case x"$enable_install_libiberty" in
    xyes|x)
      target_header_dir=libiberty
      ;;
    xno)   
      target_header_dir=
      ;;
    *) 
      # This could be sanity-checked in various ways...
      target_header_dir="${enable_install_libiberty}"
      ;;
  esac


else

   # Not a target library, so we set things up to run the test suite.
   CHECK=check-cplus-dem

fi

AC_SUBST(CHECK)
AC_SUBST(target_header_dir)

case "${host}" in
  *-*-cygwin* | *-*-mingw*)
    AC_DEFINE_NOAUTOHEADER(HAVE_SYS_ERRLIST)
    AC_DEFINE_NOAUTOHEADER(HAVE_SYS_NERR)
    ;;
esac

if test -z "${setobjs}"; then
  case "${host}" in

  *-*-vxworks*)
    # Handle VxWorks configuration specially, since on VxWorks the
    # libraries are actually on the target board, not in the file
    # system.
    AC_LIBOBJ([basename])
    AC_LIBOBJ([getpagesize])
    AC_LIBOBJ([insque])
    AC_LIBOBJ([random])
    AC_LIBOBJ([strcasecmp])
    AC_LIBOBJ([strncasecmp])
    AC_LIBOBJ([strdup])
    AC_LIBOBJ([vfork])
    AC_LIBOBJ([waitpid])
    AC_LIBOBJ([vasprintf])
    for f in $funcs; do
      case "$f" in
	basename | getpagesize | insque | random | strcasecmp)
	  ;;
	strncasecmp | strdup | vfork | waitpid | vasprintf)
	  ;;
	*)
	  n=HAVE_`echo $f | tr 'abcdefghijklmnopqrstuvwxyz' 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'`
	  AC_DEFINE_UNQUOTED($n)
	  ;;
      esac
    done

    # VxWorks doesn't provide any of the variables in $vars, so we
    # don't have to check them here.

    # Of the functions in $checkfuncs, VxWorks only has strerror.
    AC_DEFINE_NOAUTOHEADER(HAVE_STRERROR)

    setobjs=yes
    ;;

  esac
fi

if test -z "${setobjs}"; then

  case "${host}" in

  *-*-cygwin*)
    # The Cygwin library actually uses a couple of files from
    # libiberty when it is built.  If we are building a native
    # Cygwin, and we run the tests, we will appear to have these
    # files.  However, when we go on to build winsup, we will wind up
    # with a library which does not have the files, since they should
    # have come from libiberty.

    # We handle this by removing the functions the winsup library
    # provides from our shell variables, so that they appear to be
    # missing.

    # DJ - only if we're *building* cygwin, not just building *with* cygwin
  
    if test -n "${with_target_subdir}"
    then
      funcs="`echo $funcs | sed -e 's/random//'`"
      AC_LIBOBJ([random])
      vars="`echo $vars | sed -e 's/sys_siglist//'`"
      checkfuncs="`echo $checkfuncs | sed -e 's/strsignal//' -e 's/psignal//'`"
    fi
    ;;

  *-*-mingw32*)
    # Under mingw32, sys_nerr and sys_errlist exist, but they are
    # macros, so the test below won't find them.
    libiberty_cv_var_sys_nerr=yes
    libiberty_cv_var_sys_errlist=yes
    ;;

  *-*-uwin*)
    # Under some versions of uwin, vfork is notoriously buggy and the test 
    # can hang configure; on other versions, vfork exists just as a stub.
    # FIXME: This should be removed once vfork in uwin's runtime is fixed.
    ac_cv_func_vfork_works=no
    # Under uwin 2.0+, sys_nerr and sys_errlist exist, but they are
    # macros (actually, these are imported from a DLL, but the end effect 
    # is the same), so the test below won't find them.
    libiberty_cv_var_sys_nerr=yes
    libiberty_cv_var_sys_errlist=yes
    ;;

  *-*-*vms*)
    # Under VMS, vfork works very different than on Unix. The standard test 
    # won't work, and it isn't easily adaptable. It makes more sense to
    # just force it.
    ac_cv_func_vfork_works=yes
    ;;

  esac

  # We haven't set the list of objects yet.  Use the standard autoconf
  # tests.  This will only work if the compiler works.
  AC_ISC_POSIX
  AC_REPLACE_FUNCS($funcs)
  libiberty_AC_FUNC_C_ALLOCA
  AC_FUNC_VFORK
  if test $ac_cv_func_vfork_works = no; then
    AC_LIBOBJ([vfork])
  fi
  # We only need _doprnt if we might use it to implement v*printf.
  if test $ac_cv_func_vprintf != yes \
     || test $ac_cv_func_vfprintf != yes \
     || test $ac_cv_func_vsprintf != yes; then
    AC_REPLACE_FUNCS(_doprnt)
  else
    AC_CHECK_FUNCS(_doprnt)
  fi

  for v in $vars; do
    AC_MSG_CHECKING([for $v])
    AC_CACHE_VAL(libiberty_cv_var_$v,
      [AC_TRY_LINK([int *p;], [extern int $v []; p = $v;],
		   [eval "libiberty_cv_var_$v=yes"],
		   [eval "libiberty_cv_var_$v=no"])])
    if eval "test \"`echo '$libiberty_cv_var_'$v`\" = yes"; then
      AC_MSG_RESULT(yes)
      n=HAVE_`echo $v | tr 'abcdefghijklmnopqrstuvwxyz' 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'`
      AC_DEFINE_UNQUOTED($n)
    else
      AC_MSG_RESULT(no)
    fi
  done

  # special check for _system_configuration because AIX <4.3.2 do not
  # contain the `physmem' member.
  AC_MSG_CHECKING([for external symbol _system_configuration])
  AC_TRY_COMPILE([#include <sys/systemcfg.h>],
                 [double x = _system_configuration.physmem;],
    [AC_MSG_RESULT([yes])
    AC_DEFINE(HAVE__SYSTEM_CONFIGURATION, 1,
              [Define if you have the _system_configuration variable.])],
    [AC_MSG_RESULT([no])])

  AC_CHECK_FUNCS($checkfuncs)
  libiberty_NEED_DECLARATION(canonicalize_file_name)
fi

# Figure out which version of pexecute to use.
case "${host}" in
     *-*-mingw* | *-*-winnt*)	pexecute=pex-win32.o  ;;
     *-*-msdosdjgpp*)		pexecute=pex-djgpp.o  ;;
     *-*-msdos*)		pexecute=pex-msdos.o  ;;
     *-*-os2-emx*)		pexecute=pex-os2.o    ;;
     *)				pexecute=pex-unix.o   ;;
esac
AC_SUBST(pexecute)

libiberty_AC_FUNC_STRNCMP

# Install a library built with a cross compiler in $(tooldir) rather
# than $(libdir).
if test -z "${with_cross_host}"; then
  INSTALL_DEST=libdir
else
  INSTALL_DEST=tooldir
fi
AC_SUBST(INSTALL_DEST)

# We need multilib support, but only if configuring for the target.
AC_OUTPUT(Makefile testsuite/Makefile,
[test -z "$CONFIG_HEADERS" || echo timestamp > stamp-h
if test -n "$CONFIG_FILES"; then
  if test -n "${with_build_subdir}" || test -n "${with_target_subdir}"; then
    # FIXME: We shouldn't need to set ac_file
    ac_file=Makefile
    LD="${ORIGINAL_LD_FOR_MULTILIBS}"
    . ${libiberty_topdir}/config-ml.in
  fi
fi],
srcdir=${srcdir}
host=${host}
target=${target}
with_target_subdir=${with_target_subdir}
with_build_subdir=${with_build_subdir}
with_multisubdir=${with_multisubdir}
ac_configure_args="--enable-multilib ${ac_configure_args}"
CONFIG_SHELL=${CONFIG_SHELL-/bin/sh}
ORIGINAL_LD_FOR_MULTILIBS="${ORIGINAL_LD_FOR_MULTILIBS}"
libiberty_topdir=${libiberty_topdir}
)
@


1.51
log
@2003-10-01  H.J. Lu  <hongjiu.lu@@intel.com>

	* configure.in: Check if $MAKEINFO is missing.
	* configure: Regenerated.
@
text
@@


1.50
log
@	* configure.in: Use AC_PROG_CPP_WERROR.
	* configure: Regenerated.
@
text
@d72 2
a73 3
    case x"`$MAKEINFO --version | grep 'GNU texinfo'`" in
      x*\ [[1-3]].* )
	MAKEINFO="@@echo $MAKEINFO is too old, 4.0 or newer required; true"
d76 8
d85 2
@


1.49
log
@	* aclocal.m4: Include acx.m4 and no-executables.m4.
	(libiberty_AC_FUNC_STRNCMP): Use AC_LIBOBJ.
	(LIB_AC_PROG_CC): Remove.
	* configure.in: Update AC_PREREQ to 2.57.  Use GCC_NO_EXECUTABLES.
	Use AC_PROG_CC and set ac_libiberty_warn_cflags instead of using
	LIB_AC_PROG_CC.  Use AC_LIBOBJ.  Call AC_ISC_POSIX later, only if
	performing link tests.
	* configure: Regenerated.
@
text
@d104 1
@


1.48
log
@merge from gcc
@
text
@d3 1
a3 1
AC_PREREQ(2.13)
d102 7
a108 1
LIB_AC_PROG_CC
a119 1
AC_ISC_POSIX
d258 6
a263 1
    LIBOBJS="asprintf.o basename.o insque.o random.o strdup.o vasprintf.o"
d331 10
a340 2
    LIBOBJS="basename.o getpagesize.o insque.o random.o strcasecmp.o"
    LIBOBJS="$LIBOBJS strncasecmp.o strdup.o vfork.o waitpid.o vasprintf.o"
d387 1
a387 1
      LIBOBJS="$LIBOBJS random.o"
d423 1
a423 1
  AC_PROG_CC_WORKS
d428 1
a428 1
    LIBOBJS="$LIBOBJS vfork.o"
@


1.47
log
@merge from gcc
@
text
@d146 1
a146 1
AC_CHECK_HEADERS(sys/file.h sys/param.h limits.h stdlib.h string.h unistd.h strings.h sys/time.h time.h sys/resource.h sys/stat.h sys/mman.h fcntl.h alloca.h sys/pstat.h sys/sysmp.h sys/sysinfo.h machine/hal_sysinfo.h sys/table.h sys/sysctl.h sys/systemcfg.h)
@


1.46
log
@libiberty/
        * hashtab.c (burtle_hash): New fn.
        * configure.in: Add AC_C_BIGENDIAN_CROSS.
        * aclocal.m4: Include accross.m4.
        * configure, config.in: Regenerate.
include/
        * hashtab.h (burtle_hash): Prototype.
        (burtle_hash_object): New macro.
@
text
@d212 1
a212 1
vars="sys_errlist sys_nerr sys_siglist _system_configuration"
a232 1
  AC_DEFINE(HAVE__SYSTEM_CONFIGURATION, 1, [Define if you have the _system_configuration variable.])
d435 11
@


1.45
log
@merge from gcc
@
text
@d117 1
@


1.44
log
@merge from gcc
@
text
@d220 9
a228 9
  AC_CHECK_FUNCS(asprintf atexit basename bcmp bcopy bsearch bzero calloc clock)
  AC_CHECK_FUNCS(getcwd getpagesize index insque mkstemps memchr memcmp memcpy)
  AC_CHECK_FUNCS(memmove mempcpy memset putenv random rename rindex sigsetmask)
  AC_CHECK_FUNCS(strcasecmp setenv stpcpy stpncpy strchr strdup strncasecmp strrchr strstr)
  AC_CHECK_FUNCS(strtod strtol strtoul tmpnam vasprintf vfprintf vprintf)
  AC_CHECK_FUNCS(vsprintf waitpid getrusage on_exit psignal strerror strsignal)
  AC_CHECK_FUNCS(sysconf times sbrk gettimeofday ffs snprintf vsnprintf)
  AC_CHECK_FUNCS(pstat_getstatic pstat_getdynamic sysmp getsysinfo table sysctl)
  AC_CHECK_FUNCS(realpath canonicalize_file_name)
@


1.44.2.1
log
@2003-05-18  Mark Kettenis  <kettenis@@gnu.org>

	Merge from mainline.
	* i386-tdep.h (I386_SIZEOF_GREGS, I386_SIZEOF_FREGS,
	I386_SIZEOF_XREGS): Remove defenitions.
	(IS_FP_REGNUM, IS_SSE_REGNUM): Remove definitions.
	* i386-tdep.c (i386_gdbarch_init): Don't set register_bytes,
	register_size, call_dummy_words and sizeof_call_dummy.
	* i386-linux-tdep.c (i386_linux_init_abi): Don't set register_bytes.
	* x86-64-tdep.c (x86_64_init_abi): Don't set register_bytes and
	register_size.
	(x86_64_register_bytes): Remove variable.
	(_initialize_x86_64_tdep): Remove function.

	* i386-linux-tdep.c (i386_linux_sigcontext_addr): Call read_memory
	with correct arguments.
	* config/i386/x86-64linux.mt (TDEPFILES): Add i386-linux-tdep.o.
@
text
@a116 1
AC_C_BIGENDIAN_CROSS
d220 9
a228 9
  AC_CHECK_FUNCS(asprintf atexit basename bcmp bcopy bsearch bzero calloc clock \
  getcwd getpagesize index insque mkstemps memchr memcmp memcpy \
  memmove mempcpy memset putenv random rename rindex sigsetmask \
  strcasecmp setenv stpcpy stpncpy strchr strdup strncasecmp strrchr strstr \
  strtod strtol strtoul tmpnam vasprintf vfprintf vprintf \
  vsprintf waitpid getrusage on_exit psignal strerror strsignal \
  sysconf times sbrk gettimeofday ffs snprintf vsnprintf \
  pstat_getstatic pstat_getdynamic sysmp getsysinfo table sysctl \
  realpath canonicalize_file_name)
@


1.43
log
@merge from gcc
@
text
@d188 1
d205 1
d226 1
a226 1
  AC_CHECK_FUNCS(sysconf times sbrk gettimeofday ffs)
@


1.42
log
@merge from gcc
@
text
@d180 1
d189 2
d220 2
a221 2
  AC_CHECK_FUNCS(memmove memset putenv random rename rindex sigsetmask)
  AC_CHECK_FUNCS(strcasecmp setenv strchr strdup strncasecmp strrchr strstr)
@


1.41
log
@merge from gcc
@
text
@d152 4
a155 5

if test $ac_cv_type_uintptr_t = yes
then
  AC_DEFINE(HAVE_UINTPTR_T, 1, [Define if you have the \`uintptr_t' type.])
fi
@


1.40
log
@merge from gcc
@
text
@d145 1
a145 1
AC_CHECK_HEADERS(sys/file.h sys/param.h limits.h stdlib.h string.h unistd.h strings.h sys/time.h time.h sys/resource.h sys/stat.h sys/mman.h fcntl.h alloca.h sys/pstat.h sys/sysmp.h sys/sysinfo.h machine/hal_sysinfo.h sys/table.h)
d207 1
a207 1
vars="sys_errlist sys_nerr sys_siglist"
d211 1
a211 1
checkfuncs="$checkfuncs getsysinfo table"
d223 1
a223 1
  AC_CHECK_FUNCS(pstat_getstatic pstat_getdynamic sysmp getsysinfo table)
d228 1
@


1.39
log
@merge from gcc
@
text
@d145 1
a145 1
AC_CHECK_HEADERS(sys/file.h sys/param.h limits.h stdlib.h string.h unistd.h strings.h sys/time.h time.h sys/resource.h sys/stat.h sys/mman.h fcntl.h alloca.h sys/pstat.h)
d210 2
a211 1
checkfuncs="$checkfuncs realpath canonicalize_file_name pstat_getstatic pstat_getdynamic"
d223 1
a223 1
  AC_CHECK_FUNCS(pstat_getstatic pstat_getdynamic)
@


1.38
log
@merge from gcc
@
text
@d222 1
@


1.37
log
@	* Makefile.in (CFILES): Add lrealpath.c.
	(REQUIRED_OFILES): Add lrealpath.o.
	(lrealpath.o): Add rule.
	* aclocal.m4 (libiberty_NEED_DECLARATION): Add.
	* configure.in: Add realpath and canonicalize_file_name to
	checkfuncs and AC_CHECK_FUNCS.  Use libiberty_NEED_DECLARATION
	for canonicalize_file_name.
	* lrealpath.c: New file.
	* make-relative-prefix.c: Update documentation.
	(make_relative_prefix): Simplify.  Use lbasename and lrealpath.
	* config.in: Regenerated.
	* configure: Regenerated.
	* functions.texi: Regenerated.
@
text
@d145 1
a145 1
AC_CHECK_HEADERS(sys/file.h sys/param.h limits.h stdlib.h string.h unistd.h strings.h sys/time.h time.h sys/resource.h sys/stat.h sys/mman.h fcntl.h alloca.h)
d210 1
a210 1
checkfuncs="$checkfuncs realpath canonicalize_file_name"
@


1.36
log
@* configure.in: Propagate ORIGINAL_LD_FOR_MULTILIBS to
config.status.
* configure: Rebuilt.
@
text
@d210 1
d222 1
d429 1
@


1.35
log
@merge from gcc
@
text
@d469 1
@


1.34
log
@merge from gcc
@
text
@d38 1
@


1.33
log
@merge from gcc
@
text
@a429 1
     *-*-cygwin*)		pexecute=pex-cygwin.o ;;
@


1.32
log
@merge from gcc
@
text
@d4 1
a4 1
AC_INIT(pexecute.c)
d427 11
@


1.32.14.1
log
@Merge drow-cplus-branch to:
  cvs rtag -D 2003-12-14 00:00:00 UTC drow-cplus-merge-20031214 gdb+dejagnu
@
text
@d3 2
a4 2
AC_PREREQ(2.57)
AC_INIT(xmalloc.c)
a37 1
AC_SUBST(libiberty_topdir)
d71 3
a73 2
    case "$MAKEINFO" in
      */missing\ makeinfo*)
a75 8
*** Makeinfo is missing. Info documentation will not be built.])
        ;;
      *)
	case x"`$MAKEINFO --version | grep 'GNU texinfo'`" in
	  x*\ [[1-3]].* )
	    MAKEINFO="@@echo $MAKEINFO is too old, 4.0 or newer required; true"
	    BUILD_INFO=
	    AC_MSG_WARN([
a76 2
	  ;;
	esac
d101 1
a101 8
GCC_NO_EXECUTABLES
AC_PROG_CC
AC_PROG_CPP_WERROR

if test x$GCC = xyes; then
  ac_libiberty_warn_cflags='-W -Wall -Wtraditional -pedantic'
fi
AC_SUBST(ac_libiberty_warn_cflags)
d113 1
a115 1
AC_C_BIGENDIAN_CROSS
d144 1
a144 1
AC_CHECK_HEADERS(sys/file.h sys/param.h limits.h stdlib.h malloc.h string.h unistd.h strings.h sys/time.h time.h sys/resource.h sys/stat.h sys/mman.h fcntl.h alloca.h sys/pstat.h sys/sysmp.h sys/sysinfo.h machine/hal_sysinfo.h sys/table.h sys/sysctl.h sys/systemcfg.h)
d151 5
a155 4
# Given the above check, we always have uintptr_t or a fallback
# definition.  So define HAVE_UINTPTR_T in case any imported code
# relies on it.
AC_DEFINE(HAVE_UINTPTR_T, 1, [Define if you have the \`uintptr_t' type.])
a179 1
funcs="$funcs mempcpy"
a186 1
funcs="$funcs snprintf"
a187 2
funcs="$funcs stpcpy"
funcs="$funcs stpncpy"
a200 1
funcs="$funcs vsnprintf"
a208 2
checkfuncs="$checkfuncs realpath canonicalize_file_name pstat_getstatic pstat_getdynamic sysmp"
checkfuncs="$checkfuncs getsysinfo table sysctl"
d213 7
a219 9
  AC_CHECK_FUNCS(asprintf atexit basename bcmp bcopy bsearch bzero calloc clock \
  getcwd getpagesize index insque mkstemps memchr memcmp memcpy \
  memmove mempcpy memset putenv random rename rindex sigsetmask \
  strcasecmp setenv stpcpy stpncpy strchr strdup strncasecmp strrchr strstr \
  strtod strtol strtoul tmpnam vasprintf vfprintf vprintf \
  vsprintf waitpid getrusage on_exit psignal strerror strsignal \
  sysconf times sbrk gettimeofday ffs snprintf vsnprintf \
  pstat_getstatic pstat_getdynamic sysmp getsysinfo table sysctl \
  realpath canonicalize_file_name)
d243 1
a243 6
    AC_LIBOBJ([asprintf])
    AC_LIBOBJ([basename])
    AC_LIBOBJ([insque])
    AC_LIBOBJ([random])
    AC_LIBOBJ([strdup])
    AC_LIBOBJ([vasprintf])
d311 2
a312 10
    AC_LIBOBJ([basename])
    AC_LIBOBJ([getpagesize])
    AC_LIBOBJ([insque])
    AC_LIBOBJ([random])
    AC_LIBOBJ([strcasecmp])
    AC_LIBOBJ([strncasecmp])
    AC_LIBOBJ([strdup])
    AC_LIBOBJ([vfork])
    AC_LIBOBJ([waitpid])
    AC_LIBOBJ([vasprintf])
d359 1
a359 1
      AC_LIBOBJ([random])
d395 1
a395 1
  AC_ISC_POSIX
d400 1
a400 1
    AC_LIBOBJ([vfork])
a424 11

  # special check for _system_configuration because AIX <4.3.2 do not
  # contain the `physmem' member.
  AC_MSG_CHECKING([for external symbol _system_configuration])
  AC_TRY_COMPILE([#include <sys/systemcfg.h>],
                 [double x = _system_configuration.physmem;],
    [AC_MSG_RESULT([yes])
    AC_DEFINE(HAVE__SYSTEM_CONFIGURATION, 1,
              [Define if you have the _system_configuration variable.])],
    [AC_MSG_RESULT([no])])

a425 1
  libiberty_NEED_DECLARATION(canonicalize_file_name)
a427 10
# Figure out which version of pexecute to use.
case "${host}" in
     *-*-mingw* | *-*-winnt*)	pexecute=pex-win32.o  ;;
     *-*-msdosdjgpp*)		pexecute=pex-djgpp.o  ;;
     *-*-msdos*)		pexecute=pex-msdos.o  ;;
     *-*-os2-emx*)		pexecute=pex-os2.o    ;;
     *)				pexecute=pex-unix.o   ;;
esac
AC_SUBST(pexecute)

a457 1
ORIGINAL_LD_FOR_MULTILIBS="${ORIGINAL_LD_FOR_MULTILIBS}"
@


1.32.14.2
log
@Merge mainline to branch.  GDB is broken until I update cp-names.y.
@
text
@@


1.32.12.1
log
@2003-02-07  David Carlton  <carlton@@math.stanford.edu>

	* Merge with mainline; tag is carlton_dictionary-20030207-merge.
@
text
@d4 1
a4 1
AC_INIT(xmalloc.c)
a37 1
AC_SUBST(libiberty_topdir)
a426 10

# Figure out which version of pexecute to use.
case "${host}" in
     *-*-mingw* | *-*-winnt*)	pexecute=pex-win32.o  ;;
     *-*-msdosdjgpp*)		pexecute=pex-djgpp.o  ;;
     *-*-msdos*)		pexecute=pex-msdos.o  ;;
     *-*-os2-emx*)		pexecute=pex-os2.o    ;;
     *)				pexecute=pex-unix.o   ;;
esac
AC_SUBST(pexecute)
@


1.32.12.2
log
@2003-03-05  David Carlton  <carlton@@math.stanford.edu>

	* Merge with mainline.  Tag is carlton_dictionary-20030305-merge.
@
text
@d145 1
a145 1
AC_CHECK_HEADERS(sys/file.h sys/param.h limits.h stdlib.h string.h unistd.h strings.h sys/time.h time.h sys/resource.h sys/stat.h sys/mman.h fcntl.h alloca.h sys/pstat.h sys/sysmp.h sys/sysinfo.h machine/hal_sysinfo.h sys/table.h sys/sysctl.h sys/systemcfg.h)
d207 1
a207 1
vars="sys_errlist sys_nerr sys_siglist _system_configuration"
a209 2
checkfuncs="$checkfuncs realpath canonicalize_file_name pstat_getstatic pstat_getdynamic sysmp"
checkfuncs="$checkfuncs getsysinfo table sysctl"
a220 2
  AC_CHECK_FUNCS(pstat_getstatic pstat_getdynamic sysmp getsysinfo table sysctl)
  AC_CHECK_FUNCS(realpath canonicalize_file_name)
a223 1
  AC_DEFINE(HAVE__SYSTEM_CONFIGURATION, 1, [Define if you have the _system_configuration variable.])
a426 1
  libiberty_NEED_DECLARATION(canonicalize_file_name)
a468 1
ORIGINAL_LD_FOR_MULTILIBS="${ORIGINAL_LD_FOR_MULTILIBS}"
@


1.32.12.3
log
@2003-04-16  David Carlton  <carlton@@bactrian.org>

	* Merge with mainline; tag is carlton_dictionary-20030416-merge.
@
text
@d152 5
a156 4
# Given the above check, we always have uintptr_t or a fallback
# definition.  So define HAVE_UINTPTR_T in case any imported code
# relies on it.
AC_DEFINE(HAVE_UINTPTR_T, 1, [Define if you have the \`uintptr_t' type.])
a180 1
funcs="$funcs mempcpy"
a188 2
funcs="$funcs stpcpy"
funcs="$funcs stpncpy"
d218 2
a219 2
  AC_CHECK_FUNCS(memmove mempcpy memset putenv random rename rindex sigsetmask)
  AC_CHECK_FUNCS(strcasecmp setenv stpcpy stpncpy strchr strdup strncasecmp strrchr strstr)
@


1.32.12.4
log
@2003-04-30  David Carlton  <carlton@@bactrian.org>

	* cp-namespace.c (get_namespace_objfile): Copy the namespace
	objfile's name.

	* block.h (ALL_BLOCK_SYMBOLS): Move here from dictionary.h.
	* dictionary.c: Sync up with mainline version I just posted.
	Specifically, update some commments, and:
	(dict_create_hashed): Fiddle with nsyms updating.
	(dict_create_linear): Ditto.
	(dict_lookup): Delete.
	(iterator_next_hashed): Delete FIXME comment.
	(iter_name_first_hashed): Replace 'sym' by 'sym != NULL'.
	(iter_name_next_hashed): Replate 'next' by 'next != NULL'.
	* dictionary.h: Sync up with mainline version I just posted: add
	inclusion guards, delete declaration of dict_lookup, delete
	ALL_BLOCK_SYMBOLs.

	* Merge with mainline; tag is carlton_dictionary-20030430-merge.
@
text
@a187 1
funcs="$funcs snprintf"
a203 1
funcs="$funcs vsnprintf"
d224 1
a224 1
  AC_CHECK_FUNCS(sysconf times sbrk gettimeofday ffs snprintf vsnprintf)
@


1.32.12.5
log
@2003-05-23  David Carlton  <carlton@@bactrian.org>

	* Merge with mainline; tag is carlton_dictionary-20030523-merge.
@
text
@a116 1
AC_C_BIGENDIAN_CROSS
d220 9
a228 9
  AC_CHECK_FUNCS(asprintf atexit basename bcmp bcopy bsearch bzero calloc clock \
  getcwd getpagesize index insque mkstemps memchr memcmp memcpy \
  memmove mempcpy memset putenv random rename rindex sigsetmask \
  strcasecmp setenv stpcpy stpncpy strchr strdup strncasecmp strrchr strstr \
  strtod strtol strtoul tmpnam vasprintf vfprintf vprintf \
  vsprintf waitpid getrusage on_exit psignal strerror strsignal \
  sysconf times sbrk gettimeofday ffs snprintf vsnprintf \
  pstat_getstatic pstat_getdynamic sysmp getsysinfo table sysctl \
  realpath canonicalize_file_name)
@


1.32.12.6
log
@2003-06-27  David Carlton  <carlton@@kealia.com>

	* Merge with mainline; tag is carlton_dictionary-20030627-merge.
@
text
@d146 1
a146 1
AC_CHECK_HEADERS(sys/file.h sys/param.h limits.h stdlib.h malloc.h string.h unistd.h strings.h sys/time.h time.h sys/resource.h sys/stat.h sys/mman.h fcntl.h alloca.h sys/pstat.h sys/sysmp.h sys/sysinfo.h machine/hal_sysinfo.h sys/table.h sys/sysctl.h sys/systemcfg.h)
d212 1
a212 1
vars="sys_errlist sys_nerr sys_siglist"
d233 1
a435 11

  # special check for _system_configuration because AIX <4.3.2 do not
  # contain the `physmem' member.
  AC_MSG_CHECKING([for external symbol _system_configuration])
  AC_TRY_COMPILE([#include <sys/systemcfg.h>],
                 [double x = _system_configuration.physmem;],
    [AC_MSG_RESULT([yes])
    AC_DEFINE(HAVE__SYSTEM_CONFIGURATION, 1,
              [Define if you have the _system_configuration variable.])],
    [AC_MSG_RESULT([no])])

@


1.32.12.7
log
@2003-09-17  David Carlton  <carlton@@kealia.com>

	* Merge with mainline; tag is carlton_dictionary-20030917-merge.
@
text
@d3 1
a3 1
AC_PREREQ(2.57)
d102 1
a102 7
GCC_NO_EXECUTABLES
AC_PROG_CC

if test x$GCC = xyes; then
  ac_libiberty_warn_cflags='-W -Wall -Wtraditional -pedantic'
fi
AC_SUBST(ac_libiberty_warn_cflags)
d114 1
d253 1
a253 6
    AC_LIBOBJ([asprintf])
    AC_LIBOBJ([basename])
    AC_LIBOBJ([insque])
    AC_LIBOBJ([random])
    AC_LIBOBJ([strdup])
    AC_LIBOBJ([vasprintf])
d321 2
a322 10
    AC_LIBOBJ([basename])
    AC_LIBOBJ([getpagesize])
    AC_LIBOBJ([insque])
    AC_LIBOBJ([random])
    AC_LIBOBJ([strcasecmp])
    AC_LIBOBJ([strncasecmp])
    AC_LIBOBJ([strdup])
    AC_LIBOBJ([vfork])
    AC_LIBOBJ([waitpid])
    AC_LIBOBJ([vasprintf])
d369 1
a369 1
      AC_LIBOBJ([random])
d405 1
a405 1
  AC_ISC_POSIX
d410 1
a410 1
    AC_LIBOBJ([vfork])
@


1.32.12.8
log
@2003-11-11  David Carlton  <carlton@@kealia.com>

	* Merge with mainline; tag is carlton-dictionary-20031111-merge.
@
text
@d72 3
a74 2
    case "$MAKEINFO" in
      */missing\ makeinfo*)
a76 8
*** Makeinfo is missing. Info documentation will not be built.])
        ;;
      *)
	case x"`$MAKEINFO --version | grep 'GNU texinfo'`" in
	  x*\ [[1-3]].* )
	    MAKEINFO="@@echo $MAKEINFO is too old, 4.0 or newer required; true"
	    BUILD_INFO=
	    AC_MSG_WARN([
a77 2
	  ;;
	esac
a103 1
AC_PROG_CPP_WERROR
@


1.32.12.9
log
@2004-01-26  David Carlton  <carlton@@kealia.com>

	* Merge with mainline; tag is carlton_dictionary-20040126-merge.
@
text
@@


1.31
log
@merge from gcc
@
text
@d103 10
@


1.30
log
@merge from gcc
@
text
@d404 1
a404 1
      [AC_TRY_LINK([int *p;], [extern int $v []; p = &$v;],
@


1.30.4.1
log
@Merge with mainline, kseitz_interps-20020619-merge.
@
text
@d404 1
a404 1
      [AC_TRY_LINK([int *p;], [extern int $v []; p = $v;],
@


1.30.4.2
log
@Merge w/trunk (kseitz_interps-20020722-merge).
@
text
@a102 10
AC_PROG_CC_C_O
# autoconf is lame and doesn't give us any substitution variable for this.
if eval "test \"`echo '$ac_cv_prog_cc_'${ac_cc}_c_o`\" = no"; then
  NO_MINUS_C_MINUS_O=yes
else
  OUTPUT_OPTION='-o $@@'
fi
AC_SUBST(NO_MINUS_C_MINUS_O)
AC_SUBST(OUTPUT_OPTION)

@


1.30.2.1
log
@merge from trunk
@
text
@d404 1
a404 1
      [AC_TRY_LINK([int *p;], [extern int $v []; p = $v;],
@


1.29
log
@merge from gcc
@
text
@d6 6
d436 1
@


1.28
log
@merge from gcc
@
text
@d141 2
@


1.27
log
@merge from gcc
@
text
@d8 3
a10 1
[  --with-target-subdir=SUBDIR      Configuring in a subdirectory])
d17 4
a20 1
  if test -z "${with_target_subdir}"; then
d425 1
a425 1
  if test -n "${with_target_subdir}"; then
d435 1
@


1.26
log
@merge from gcc
@
text
@d208 1
d243 21
d272 1
@


1.25
log
@        * configure.in (variable detection): Use arrays of unspecified
        size instead of plain integers.
@
text
@d252 1
a252 1
  *-*-cygwin*)
@


1.24
log
@merge from gcc
@
text
@d368 1
a368 1
      [AC_TRY_LINK([int *p;], [extern int $v; p = &$v;],
@


1.23
log
@merge from gcc
@
text
@d361 2
@


1.22
log
@merge from gcc
@
text
@d129 1
a129 3
AC_MSG_CHECKING(for uintptr_t)
AC_EGREP_HEADER(uintptr_t, sys/types.h,
                libiberty_cv_uintptr_t=yes, libiberty_cv_uintptr_t=no)
d131 1
a131 1
if test $libiberty_cv_uintptr_t = yes
a133 3
  AC_MSG_RESULT(yes)
else
  AC_MSG_RESULT(no)
@


1.21
log
@merge from gcc
@
text
@d343 7
@


1.20
log
@merge from gcc
@
text
@d135 1
a135 1
  AC_DEFINE(HAVE_UINTPTR_T)
d257 3
a259 3
  *-*-cygwin*) 
    AC_DEFINE(HAVE_SYS_ERRLIST)
    AC_DEFINE(HAVE_SYS_NERR)
d354 7
@


1.19
log
@merge from gcc
@
text
@d123 1
a123 1
AC_CHECK_HEADERS(sys/file.h sys/param.h limits.h stdlib.h string.h unistd.h strings.h sys/time.h time.h sys/resource.h sys/stat.h sys/mman.h fcntl.h)
@


1.18
log
@merge from gcc
@
text
@d129 12
@


1.17
log
@merge from gcc
@
text
@d55 2
a56 4
BUILD_INFO=info
case x"`$MAKEINFO --version | grep 'GNU texinfo'`" in
  x*\ [[1-3]].* )
    MAKEINFO="@@echo $MAKEINFO is too old, 4.0 or newer required ;true"
d58 7
a64 1
    AC_MSG_WARN([
d66 3
a68 2
    ;;
esac
@


1.16
log
@merge from gcc
@
text
@d52 13
a64 12
# Do we have a single-tree copy of texinfo?
if test -f $srcdir/../texinfo/Makefile.in; then
  MAKEINFO='$(objdir)/../texinfo/makeinfo/makeinfo'
  AC_MSG_RESULT([Using makeinfo from the unified source tree.])
else
  AC_CHECK_PROG(MAKEINFO, makeinfo, makeinfo, )
fi
if test x"$MAKEINFO" = x""; then
  BUILD_INFO=
else
  BUILD_INFO=info
fi
@


1.15
log
@merge from gcc
@
text
@d29 45
@


1.14
log
@merge from gcc
@
text
@a179 6
    case "${host}" in
      *-*-cygwin*)
	AC_DEFINE(HAVE_SYS_ERRLIST)
	;;
    esac

d192 7
@


1.13
log
@merge from gcc
@
text
@d180 6
@


1.13.2.1
log
@* configure.in: Need to set HAVE_SYS_ERRLIST and HAVE_SYS_NERR whenever
hosting on cygwin.
* configure: Regenerate.
@
text
@a192 7
case "${host}" in
  *-*-cygwin*) 
    AC_DEFINE(HAVE_SYS_ERRLIST)
    AC_DEFINE(HAVE_SYS_NERR)
    ;;
esac

@


1.12
log
@merge from gcc
@
text
@d90 1
d138 1
a138 1
  AC_CHECK_FUNCS(sysconf times sbrk gettimeofday)
@


1.11
log
@* bsearch.c: New file.
* configure.in (funcs): Add bsearch.
(AC_CHECK_FUNCS): Likewise.
* configure, config.in: Regenerate.
@
text
@d145 1
a145 2
# provide the function, we want to define HAVE_FN in config.h.  Also,
# if the host does not provide alloca, we set ALLOCA to alloca.o
a159 1
    ALLOCA="alloca.o"
d278 1
a278 22

  case "${host}" in
  *-*-interix)
    # On Interix, it wrongly concludes that the MSVC compiler supports alloca.
    # (MSVC does on Win32, not on Interix.)
    # This should be temporary.

    ac_cv_header_alloca_h=no
    ac_cv_func_alloca_works=no
    ALLOCA=alloca.o
    cat >> confdefs.h <<\EOF
#define C_ALLOCA 1
EOF
    cat >> confdefs.h <<EOF
#define STACK_DIRECTION -1
EOF
    ;;
  *)
    AC_FUNC_ALLOCA
    ;;
  esac

@


1.10
log
@* aclocal.m4 (LIB_AC_PROG_CC): Moved here from configure.in.
(AC_DEFINE_NOAUTOHEADER): New - work around bug in autoheader.
* configure.in: Call AC_C_INLINE and AC_C_CONST.  Use three
argument form of AC_DEFINE in dummy definitions block.  Use
AC_DEFINE_NOAUTOHEADER for real definitions of things defined
in dummy block.  Preload cache variables instead of bypassing
tests, where possible.
* acconfig.h: Removed.
* xmalloc.c (xmalloc_failed): New function, does error
reporting on failed allocation.
(xmalloc, xcalloc, xrealloc): Use it.
@
text
@d86 1
d131 7
a137 7
  AC_CHECK_FUNCS(asprintf atexit basename bcmp bcopy bzero calloc clock getcwd)
  AC_CHECK_FUNCS(getpagesize index insque mkstemps memchr memcmp memcpy memmove)
  AC_CHECK_FUNCS(memset putenv random rename rindex sigsetmask strcasecmp)
  AC_CHECK_FUNCS(setenv strchr strdup strncasecmp strrchr strstr strtod strtol)
  AC_CHECK_FUNCS(strtoul tmpnam vasprintf vfprintf vprintf vsprintf waitpid)
  AC_CHECK_FUNCS(getrusage on_exit psignal strerror strsignal sysconf times)
  AC_CHECK_FUNCS(sbrk gettimeofday)
@


1.9
log
@* configure.in (Cygwin): special case cygwin only when we're
building cygwin, not when we're hosting cygwin.
@
text
@a38 42
# FIXME: We temporarily define our own version of AC_PROG_CC.  This is
# copied from autoconf 2.12, but does not call AC_PROG_CC_WORKS.  We
# are probably using a cross compiler, which will not be able to fully
# link an executable.  This should really be fixed in autoconf
# itself.

AC_DEFUN(LIB_AC_PROG_CC,
[AC_BEFORE([$0], [AC_PROG_CPP])dnl
AC_PROVIDE([AC_PROG_CC])
AC_CHECK_PROG(CC, gcc, gcc)
if test -z "$CC"; then
  AC_CHECK_PROG(CC, cc, cc, , , /usr/ucb/cc)
  test -z "$CC" && AC_MSG_ERROR([no acceptable cc found in \$PATH])
fi

AC_PROG_CC_GNU

if test $ac_cv_prog_gcc = yes; then
  GCC=yes
  ac_libiberty_warn_cflags='-W -Wall -Wtraditional -pedantic'
dnl Check whether -g works, even if CFLAGS is set, in case the package
dnl plays around with CFLAGS (such as to build both debugging and
dnl normal versions of a library), tasteless as that idea is.
  ac_test_CFLAGS="${CFLAGS+set}"
  ac_save_CFLAGS="$CFLAGS"
  CFLAGS=
  AC_PROG_CC_G
  if test "$ac_test_CFLAGS" = set; then
    CFLAGS="$ac_save_CFLAGS"
  elif test $ac_cv_prog_cc_g = yes; then
    CFLAGS="-g -O2"
  else
    CFLAGS="-O2"
  fi
else
  GCC=
  ac_libiberty_warn_cflags=
  test "${CFLAGS+set}" = set || CFLAGS="-g"
fi
])
AC_SUBST(ac_libiberty_warn_cflags)

d42 2
a134 3
  AC_DEFINE(HAVE_SYS_ERRLIST)
  AC_DEFINE(HAVE_SYS_NERR)
  AC_DEFINE(HAVE_SYS_SIGLIST)
d137 3
d178 1
a178 1
    AC_DEFINE(HAVE_STRERROR)
d219 1
a219 1
    AC_DEFINE(HAVE_STRERROR)
d257 2
a258 3
    vars="`echo $vars | sed -e 's/sys_nerr//' -e 's/sys_errlist//'`"
    AC_DEFINE(HAVE_SYS_NERR)
    AC_DEFINE(HAVE_SYS_ERRLIST)
d269 2
a270 2
    AC_DEFINE(HAVE_SYS_NERR)
    AC_DEFINE(HAVE_SYS_ERRLIST)
@


1.8
log
@        * configure.in (AC_CHECK_HEADERS): Add time.h.
        (AC_HEADER_TIME): Add check.
        * configure, config.in: Regenerate.
        * getruntime.c: Portably #include <sys/time.h> and/or <time.h>.
@
text
@d283 9
a291 4
    funcs="`echo $funcs | sed -e 's/random//'`"
    LIBOBJS="$LIBOBJS random.o"
    vars="`echo $vars | sed -e 's/sys_siglist//'`"
    checkfuncs="`echo $checkfuncs | sed -e 's/strsignal//' -e 's/psignal//'`"
@


1.7
log
@	* aclocal.m4 (libiberty_AC_DECLARE_ERRNO): New macro.
	* configure.in (libiberty_AC_DECLARE_ERRNO): Add check.
	* configure, config.in: Regenerate.
	* pexecute.c, strtol.c, strtoul.c: Declare errno if necessary.
@
text
@d112 1
a112 1
AC_CHECK_HEADERS(sys/file.h sys/param.h stdlib.h string.h unistd.h strings.h sys/time.h sys/resource.h sys/stat.h sys/mman.h fcntl.h)
d114 1
@


1.6
log
@Synced with libiberty in the gcc repository.
@
text
@d115 2
@


1.5
log
@* Makefile.in: add EXTRA_INCS
* configure.in: if with-newlib, point to it for includes
rather than using the installed includes, for target builds.
If cygwin, override function list only for target builds.
* configure: regenerate
Note from DJ: I waited a week for gcc approval and got none, but
we need this patch for cygwin builds *now*.  I'll fix it later if
need be.
@
text
@d58 1
a58 1
  ac_libiberty_warn_cflags='-W -Wall -Wtraditional'
d112 1
a112 1
AC_CHECK_HEADERS(sys/file.h sys/param.h stdlib.h string.h unistd.h strings.h sys/time.h sys/resource.h sys/stat.h)
a218 5
    if test -d ${libiberty_topdir}/newlib
    then
      EXTRA_INCS="-I${libiberty_topdir}/newlib/libc/include"
    fi

a227 1
AC_SUBST(EXTRA_INCS)
d280 4
a283 9
    # DJ - only if we're *building* cygwin, not just building *with* cygwin

    if test -n "${with_target_subdir}"
    then
      funcs="`echo $funcs | sed -e 's/random//'`"
      LIBOBJS="$LIBOBJS random.o"
      vars="`echo $vars | sed -e 's/sys_siglist//'`"
      checkfuncs="`echo $checkfuncs | sed -e 's/strsignal//' -e 's/psignal//'`"
    fi
d354 2
@


1.4
log
@merge with libiberty from egcs 2000-02-22
@
text
@d219 5
d233 1
d286 9
a294 4
    funcs="`echo $funcs | sed -e 's/random//'`"
    LIBOBJS="$LIBOBJS random.o"
    vars="`echo $vars | sed -e 's/sys_siglist//'`"
    checkfuncs="`echo $checkfuncs | sed -e 's/strsignal//' -e 's/psignal//'`"
@


1.3
log
@Revert last patch to xmalloc.c, and instead bring over this patch from
egcs:
Thu Apr 15 23:00:55 1999  Mumit Khan  <khan@@xraylith.wisc.edu>

	* configure.in (checkfuncs): Check for sbrk.
	* config.in: Rebuilt.
	* configure: Likewise.
	* xmalloc.c: Use HAVE_SBRK instead of the host specific definitions.
@
text
@d3 1
a3 1
AC_PREREQ(2.12.1)
d58 1
d75 1
d79 1
d112 1
a112 1
AC_CHECK_HEADERS(sys/file.h sys/param.h stdlib.h string.h unistd.h strings.h sys/time.h sys/resource.h)
d136 1
d140 1
d162 1
a162 1
checkfuncs="getrusage on_exit psignal strerror strsignal sysconf times sbrk"
d169 2
a170 2
  AC_CHECK_FUNCS(memset random rename rindex sigsetmask strcasecmp)
  AC_CHECK_FUNCS(strchr strdup strncasecmp strrchr strstr strtod strtol)
d176 1
a176 1
  AC_CHECK_FUNCS(sbrk)
d185 1
d220 6
d228 2
d299 5
d312 22
a333 1
  AC_FUNC_ALLOCA
d365 1
a365 1
AC_OUTPUT(Makefile,
@


1.2
log
@        * configure.in (sys/resource.h): Add to AC_CHECK_HEADERS list.
        * getruntime.c: Only attempt to include sys/resource.h and
        use getrusage if both HAVE_GETRUSAGE and HAVE_SYS_RESOURCE_H
        are defined.
@
text
@d157 1
a157 1
checkfuncs="getrusage on_exit psignal strerror strsignal sysconf times"
d171 1
@


1.1
log
@Initial revision
@
text
@d109 1
a109 1
AC_CHECK_HEADERS(sys/file.h sys/param.h stdlib.h string.h unistd.h strings.h sys/time.h)
@


1.1.1.1
log
@19990502 sourceware import
@
text
@@


1.1.1.2
log
@import libiberty from egcs
@
text
@d3 1
a3 1
AC_PREREQ(2.13)
a57 1
  ac_libiberty_warn_cflags='-W -Wall -Wtraditional'
a73 1
  ac_libiberty_warn_cflags=
a76 1
AC_SUBST(ac_libiberty_warn_cflags)
d109 1
a109 1
AC_CHECK_HEADERS(sys/file.h sys/param.h stdlib.h string.h unistd.h strings.h sys/time.h sys/resource.h sys/stat.h)
a132 1
funcs="$funcs putenv"
a135 1
funcs="$funcs setenv"
d157 1
a157 1
checkfuncs="getrusage on_exit psignal strerror strsignal sysconf times sbrk gettimeofday"
d164 2
a165 2
  AC_CHECK_FUNCS(memset putenv random rename rindex sigsetmask strcasecmp)
  AC_CHECK_FUNCS(setenv strchr strdup strncasecmp strrchr strstr strtod strtol)
a170 1
  AC_CHECK_FUNCS(sbrk gettimeofday)
a178 1
CHECK=
a212 6

else

   # Not a target library, so we set things up to run the test suite.
   CHECK=check-cplus-dem

a214 2
AC_SUBST(CHECK)

a283 5
    # Under uwin 2.0+, sys_nerr and sys_errlist exist, but they are
    # macros (actually, these are imported from a DLL, but the end effect 
    # is the same), so the test below won't find them.
    AC_DEFINE(HAVE_SYS_NERR)
    AC_DEFINE(HAVE_SYS_ERRLIST)
d292 1
a292 22

  case "${host}" in
  *-*-interix)
    # On Interix, it wrongly concludes that the MSVC compiler supports alloca.
    # (MSVC does on Win32, not on Interix.)
    # This should be temporary.

    ac_cv_header_alloca_h=no
    ac_cv_func_alloca_works=no
    ALLOCA=alloca.o
    cat >> confdefs.h <<\EOF
#define C_ALLOCA 1
EOF
    cat >> confdefs.h <<EOF
#define STACK_DIRECTION -1
EOF
    ;;
  *)
    AC_FUNC_ALLOCA
    ;;
  esac

d324 1
a324 1
AC_OUTPUT(Makefile testsuite/Makefile,
@


