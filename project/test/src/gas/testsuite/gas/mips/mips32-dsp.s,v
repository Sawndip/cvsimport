head	1.4;
access;
symbols
	binutils-2_24-branch:1.4.0.2
	binutils-2_24-branchpoint:1.4
	binutils-2_21_1:1.3
	binutils-2_23_2:1.3.8.1
	binutils-2_23_1:1.3.8.1
	binutils-2_23:1.3.8.1
	binutils-2_23-branch:1.3.0.8
	binutils-2_23-branchpoint:1.3
	binutils-2_22_branch:1.3.0.6
	binutils-2_22:1.3
	binutils-2_22-branch:1.3.0.4
	binutils-2_22-branchpoint:1.3
	binutils-2_21:1.3
	binutils-2_21-branch:1.3.0.2
	binutils-2_21-branchpoint:1.3
	binutils-2_20_1:1.2
	binutils-2_20:1.2
	binutils-arc-20081103-branch:1.2.0.12
	binutils-arc-20081103-branchpoint:1.2
	binutils-2_20-branch:1.2.0.10
	binutils-2_20-branchpoint:1.2
	dje-cgen-play1-branch:1.2.0.8
	dje-cgen-play1-branchpoint:1.2
	arc-20081103-branch:1.2.0.6
	arc-20081103-branchpoint:1.2
	binutils-2_19_1:1.2
	binutils-2_19:1.2
	binutils-2_19-branch:1.2.0.4
	binutils-2_19-branchpoint:1.2
	binutils-2_18:1.2
	binutils-2_18-branch:1.2.0.2
	binutils-2_18-branchpoint:1.2
	binutils-csl-coldfire-4_1-32:1.1
	binutils-csl-sourcerygxx-4_1-32:1.1
	binutils-csl-innovasic-fido-3_4_4-33:1.1
	binutils-csl-coldfire-4_1-30:1.1
	binutils-csl-sourcerygxx-4_1-30:1.1
	binutils-csl-coldfire-4_1-28:1.1
	binutils-csl-sourcerygxx-4_1-29:1.1
	binutils-csl-sourcerygxx-4_1-28:1.1
	binutils-csl-arm-2006q3-27:1.1
	binutils-csl-sourcerygxx-4_1-27:1.1
	binutils-csl-arm-2006q3-26:1.1
	binutils-csl-sourcerygxx-4_1-26:1.1
	binutils-csl-sourcerygxx-4_1-25:1.1
	binutils-csl-sourcerygxx-4_1-24:1.1
	binutils-csl-sourcerygxx-4_1-23:1.1
	binutils-csl-sourcerygxx-4_1-21:1.1
	binutils-csl-arm-2006q3-21:1.1
	binutils-csl-sourcerygxx-4_1-22:1.1
	binutils-csl-palmsource-arm-prelinker-1_0-1:1.1
	binutils-csl-sourcerygxx-4_1-20:1.1
	binutils-csl-arm-2006q3-19:1.1
	binutils-csl-sourcerygxx-4_1-19:1.1
	binutils-csl-sourcerygxx-4_1-18:1.1
	binutils-csl-renesas-4_1-9:1.1
	binutils-csl-renesas-4_1-8:1.1
	binutils-csl-renesas-4_1-7:1.1
	binutils-csl-renesas-4_1-6:1.1
	binutils-csl-sourcerygxx-4_1-17:1.1
	binutils-csl-sourcerygxx-4_1-14:1.1
	binutils-csl-sourcerygxx-4_1-15:1.1
	binutils-csl-sourcerygxx-4_1-13:1.1
	binutils-2_17:1.1
	binutils-csl-sourcerygxx-4_1-12:1.1
	binutils-csl-sourcerygxx-3_4_4-21:1.1
	binutils-csl-sourcerygxx-4_1-9:1.1
	binutils-csl-sourcerygxx-4_1-8:1.1
	binutils-csl-sourcerygxx-4_1-7:1.1
	binutils-csl-arm-2006q1-6:1.1
	binutils-csl-sourcerygxx-4_1-6:1.1
	binutils-csl-coldfire-4_1-11:1.1
	binutils-csl-sourcerygxx-3_4_4-19:1.1
	binutils-csl-coldfire-4_1-10:1.1
	binutils-csl-sourcerygxx-4_1-5:1.1
	binutils-csl-sourcerygxx-4_1-4:1.1
	binutils-csl-morpho-4_1-4:1.1
	binutils-csl-sourcerygxx-3_4_4-17:1.1
	binutils-2_17-branch:1.1.0.4
	binutils-2_17-branchpoint:1.1
	binutils-csl-2_17-branch:1.1.0.2
	binutils-csl-2_17-branchpoint:1.1
	binutils_latest_snapshot:1.4;
locks; strict;
comment	@# @;


1.4
date	2012.07.31.21.38.53;	author macro;	state Exp;
branches;
next	1.3;

1.3
date	2010.10.25.18.11.42;	author chaoyingfu;	state Exp;
branches
	1.3.8.1;
next	1.2;

1.2
date	2006.06.05.16.28.36;	author ths;	state Exp;
branches;
next	1.1;

1.1
date	2005.08.25.18.21.47;	author chaoyingfu;	state Exp;
branches;
next	;

1.3.8.1
date	2012.09.04.14.01.39;	author gingold;	state Exp;
branches;
next	;


desc
@@


1.4
log
@	include/opcode/
	* mips.h: Document microMIPS DSP ASE usage.
	(MICROMIPSOP_MASK_DSPACC, MICROMIPSOP_SH_DSPACC): Update for
	microMIPS DSP ASE support.
	(MICROMIPSOP_MASK_DSPSFT, MICROMIPSOP_SH_DSPSFT): Likewise.
	(MICROMIPSOP_MASK_SA3, MICROMIPSOP_SH_SA3): Likewise.
	(MICROMIPSOP_MASK_SA4, MICROMIPSOP_SH_SA4): Likewise.
	(MICROMIPSOP_MASK_IMM8, MICROMIPSOP_SH_IMM8): Likewise.
	(MICROMIPSOP_MASK_IMM10, MICROMIPSOP_SH_IMM10): Likewise.
	(MICROMIPSOP_MASK_WRDSP, MICROMIPSOP_SH_WRDSP): Likewise.
	(MICROMIPSOP_MASK_BP, MICROMIPSOP_SH_BP): Likewise.

	gas/
	* config/tc-mips.c (macro_build) <'2'>: Handle microMIPS.
	(macro) <M_BALIGN>: Update error handling.
	(validate_micromips_insn) <'2', '3', '4', '5', '6'>: New cases.
	<'7', '8', '0', '@@', '^'>: Likewise.
	(mips_ip) <'2', '3', '4', '5', '6', '7', '8'>: Handle microMIPS.
	<'9'>: Fix formatting.
	<'0', '@@'>: Handle microMIPS.
	<'^'>: New case.

	gas/testsuite/
	* gas/mips/micromips@@mips32-dsp.d: New.
	* gas/mips/micromips@@mips32-dspr2.d: New.
	* gas/mips/mips32-dsp.d: Remove -mips32r2.
	* gas/mips/mips32-dspr2.d: Likewise.
	* gas/mips/mips.exp: (mips_create_arch): Use -mips64r2
	for micromips.  Use run_dump_test_arches to run dsp tests.

	opcodes/
	* micromips-opc.c (WR_a, RD_a, MOD_a): New macros.
	(DSP_VOLA): Likewise.
	(D32, D33): Likewise.
	(micromips_opcodes): Add DSP ASE instructions.
	* micromips-dis.c (print_insn_micromips) <'2', '3'>: New cases.
	<'4', '5', '6', '7', '8', '0', '^', '@@'>: Likewise.
@
text
@# source file to test assembly of MIPS DSP ASE for MIPS32 instructions

	.set noreorder
	.set nomacro
	.set noat

	.text
text_label:

	addq.ph		$0,$1,$2
	addq_s.ph	$1,$2,$3
	addq_s.w	$2,$3,$4
	addu.qb		$3,$4,$5
	addu_s.qb	$4,$5,$6
	subq.ph		$5,$6,$7
	subq_s.ph	$6,$7,$8
	subq_s.w	$7,$8,$9
	subu.qb		$8,$9,$10
	subu_s.qb	$9,$10,$11
	addsc		$10,$11,$12
	addwc		$11,$12,$13
	modsub		$12,$13,$14
	raddu.w.qb	$13,$14
	absq_s.ph	$14,$15
	absq_s.w	$15,$16
	precrq.qb.ph	$16,$17,$18
	precrq.ph.w	$17,$18,$19
	precrq_rs.ph.w	$18,$19,$20
	precrqu_s.qb.ph	$19,$20,$21
	preceq.w.phl	$20,$21
	preceq.w.phr	$21,$22
	precequ.ph.qbl	$22,$23
	precequ.ph.qbr	$23,$24
	precequ.ph.qbla	$24,$25
	precequ.ph.qbra	$25,$26
	preceu.ph.qbl	$26,$27
	preceu.ph.qbr	$27,$28
	preceu.ph.qbla	$28,$29
	preceu.ph.qbra	$29,$30
	shll.qb		$30,$31,0
	shll.qb		$30,$31,7
	shllv.qb	$31,$0,$1
	shll.ph		$0,$1,0
	shll.ph		$0,$1,15
	shllv.ph	$1,$2,$3
	shll_s.ph	$2,$3,0
	shll_s.ph	$2,$3,15
	shllv_s.ph	$3,$4,$5
	shll_s.w	$4,$5,0
	shll_s.w	$4,$5,31
	shllv_s.w	$5,$6,$7
	shrl.qb		$6,$7,0
	shrl.qb		$6,$7,7
	shrlv.qb	$7,$8,$9
	shra.ph		$8,$9,0
	shra.ph		$8,$9,15
	shrav.ph	$9,$10,$11
	shra_r.ph	$10,$11,0
	shra_r.ph	$10,$11,15
	shrav_r.ph	$11,$12,$13
	shra_r.w	$12,$13,0
	shra_r.w	$12,$13,31
	shrav_r.w	$13,$14,$15
	muleu_s.ph.qbl	$14,$15,$16
	muleu_s.ph.qbr	$15,$16,$17
	mulq_rs.ph	$16,$17,$18
	muleq_s.w.phl	$17,$18,$19
	muleq_s.w.phr	$18,$19,$20
	dpau.h.qbl	$ac0,$19,$20
	dpau.h.qbr	$ac1,$20,$21
	dpsu.h.qbl	$ac2,$21,$22
	dpsu.h.qbr	$ac3,$22,$23
	dpaq_s.w.ph	$ac0,$23,$24
	dpsq_s.w.ph	$ac1,$24,$25
	mulsaq_s.w.ph	$ac2,$25,$26
	dpaq_sa.l.w	$ac3,$26,$27
	dpsq_sa.l.w	$ac0,$27,$28
	maq_s.w.phl	$ac1,$28,$29
	maq_s.w.phr	$ac2,$29,$30
	maq_sa.w.phl	$ac3,$30,$31
	maq_sa.w.phr	$ac0,$31,$0
	bitrev		$0,$1
	insv		$1,$2
	repl.qb		$2,0
	repl.qb		$2,255
	replv.qb	$3,$4
	repl.ph		$4,-512
	repl.ph		$4,511
	replv.ph	$5,$6
	cmpu.eq.qb	$6,$7
	cmpu.lt.qb	$7,$8
	cmpu.le.qb	$8,$9
	cmpgu.eq.qb	$9,$10,$11
	cmpgu.lt.qb	$10,$11,$12
	cmpgu.le.qb	$11,$12,$13
	cmp.eq.ph	$12,$13
	cmp.lt.ph	$13,$14
	cmp.le.ph	$14,$15
	pick.qb		$15,$16,$17
	pick.ph		$16,$17,$18
	packrl.ph	$17,$18,$19
	extr.w		$18,$ac1,0
	extr.w		$18,$ac1,31
	extr_r.w	$19,$ac2,0
	extr_r.w	$19,$ac2,31
	extr_rs.w	$20,$ac3,0
	extr_rs.w	$20,$ac3,31
	extr_s.h	$21,$ac0,0
	extr_s.h	$21,$ac0,31
	extrv_s.h	$22,$ac1,$23
	extrv.w		$23,$ac2,$24
	extrv_r.w	$24,$ac3,$25
	extrv_rs.w	$25,$ac0,$26
	extp		$26,$ac1,0
	extp		$26,$ac1,31
	extpv		$27,$ac2,$28
	extpdp		$28,$ac3,0
	extpdp		$28,$ac3,31
	extpdpv		$29,$ac0,$30
	shilo		$ac1,-32
	shilo		$ac1,31
	shilov		$ac2,$30
	mthlip		$31,$ac3
	mfhi		$0,$ac0
	mflo		$1,$ac1
	mthi		$2,$ac2
	mtlo		$3,$ac3
	wrdsp		$4,0
	wrdsp		$4,63
	wrdsp		$5
	rddsp		$6,0
	rddsp		$6,63
	rddsp		$7
	lbux		$8,$9($10)
	lhx		$9,$10($11)
	lwx		$10,$11($12)
	bposge32	text_label
	nop
	madd		$ac2,$11,$12
	maddu		$ac3,$12,$13
	msub		$ac0,$13,$14
	msubu		$ac1,$14,$15
	mult		$ac3,$21,$22
	multu		$ac0,$22,$23

# Force at least 8 (non-delay-slot) zero bytes, to make 'objdump' print ...
	.align	2
	.space	8
@


1.3
log
@2010-10-25  Chao-ying Fu  <fu@@mips.com>

	* gas/mips/mips32-dsp.d, gas/mips/mips32-dsp.s: Add madd, maddu, msub,
	msubu, mult, multu.
@
text
@d147 1
@


1.3.8.1
log
@gas/
	* config/tc-mips.c (ISA_SUPPORTS_DSP_ASE): Also set if microMIPS
	mode.
	(ISA_SUPPORTS_DSPR2_ASE): Likewise.
	(macro_build) <'2'>: Handle microMIPS.
2012-07-31  Maciej W. Rozycki  <macro@@codesourcery.com>
            Chao-Ying Fu  <fu@@mips.com>
            Catherine Moore  <clm@@codesourcery.com>

gas/
	* gas/mips/micromips@@mips32-dsp.d: New test.
	* gas/mips/micromips@@mips32-dspr2.d: New test.
	* gas/mips/mips32-dsp.s: Update padding.
	* gas/mips/mips32-dspr2.s: Likewise.
	* gas/mips/mips.exp: Use run_dump_test_arches to run MIPS32 DSP
	tests.
2012-07-31  Catherine Moore  <clm@@codesourcery.com>
            Maciej W. Rozycki  <macro@@codesourcery.com>

include/
2012-07-31  Chao-Ying Fu  <fu@@mips.com>
            Catherine Moore  <clm@@codesourcery.com>
            Maciej W. Rozycki  <macro@@codesourcery.com>

opcodes/
2012-08-01  Alan Modra  <amodra@@gmail.com>

	* h8300-dis.c: Fix printf arg warnings.
	* i960-dis.c: Likewise.
	* mips-dis.c: Likewise.
	* pdp11-dis.c: Likewise.
	* sh-dis.c: Likewise.
	* v850-dis.c: Likewise.
	* configure.in: Formatting.
	* configure: Regenerate.
	* rl78-decode.c: Regenerate.
	* po/POTFILES.in: Regenerate.
@
text
@a146 1
	.align	2
@


1.2
log
@	[ gas/ChangeLog ]
	* config/tc-mips.c (macro_build): Use INSERT_OPERAND wherew
	appropriate.
	(mips16_macro_build): Use MIPS16_INSERT_OPERAND where appropriate.
	(mips_ip): Make overflowed/underflowed constant arguments in DSP
	and MT instructions a fatal error. Use INSERT_OPERAND where
	appropriate. Improve warnings for break and wait code overflows.
	Use symbolic constant of OP_MASK_COPZ.
	(mips16_ip): Use MIPS16_INSERT_OPERAND where appropriate.

	[ gas/testsuite/ChangeLog ]
	* gas/mips/mips32-dsp.d, gas/mips/mips32-dsp.s, gas/mips/mips32-mt.d,
	gas/mips/mips32-mt.s: Remove instructions with invalid arguments.
	* gas/mips/mips32-dsp.l, gas/mips/mips32-mt.l: Delete file.

	[ include/opcode/ChangeLog ]
	* mips.h: Improve description of MT flags.
@
text
@d139 6
@


1.1
log
@* gas/mips/mips.exp: Run DSP test.
* gas/mips/mips32-dsp.[sdl]: New test.
@
text
@d4 1
a39 1
	shll.qb		$30,$31,-1
a41 1
	shll.qb		$30,$31,8
a42 1
	shll.ph		$0,$1,-1
a44 1
	shll.ph		$0,$1,16
a45 1
	shll_s.ph	$2,$3,-1
a47 1
	shll_s.ph	$2,$3,16
a48 1
	shll_s.w	$4,$5,-1
a50 1
	shll_s.w	$4,$5,32
a51 1
	shrl.qb		$6,$7,-1
a53 1
	shrl.qb		$6,$7,8
a54 1
	shra.ph		$8,$9,-1
a56 1
	shra.ph		$8,$9,16
a57 1
	shra_r.ph	$10,$11,-1
a59 1
	shra_r.ph	$10,$11,16
a60 1
	shra_r.w	$12,$13,-1
a62 1
	shra_r.w	$12,$13,32
a83 1
	repl.qb		$2,-1
a85 1
	repl.qb		$2,256
a86 1
	repl.ph		$4,-513
a88 1
	repl.ph		$4,512
a101 1
	extr.w		$18,$ac1,-1
a103 2
	extr.w		$18,$ac1,32
	extr_r.w	$19,$ac2,-1
a105 2
	extr_r.w	$19,$ac2,32
	extr_rs.w	$20,$ac3,-1
a107 2
	extr_rs.w	$20,$ac3,32
	extr_s.h	$21,$ac0,-1
a109 1
	extr_s.h	$21,$ac0,32
a113 1
	extp		$26,$ac1,-1
a115 1
	extp		$26,$ac1,32
a116 1
	extpdp		$28,$ac3,-1
a118 1
	extpdp		$28,$ac3,32
a119 1
	shilo		$ac1,-33
a121 1
	shilo		$ac1,32
a127 1
	wrdsp		$4,-1
a129 1
	wrdsp		$4,64
a130 1
	rddsp		$6,-1
a132 1
	rddsp		$6,64
@

