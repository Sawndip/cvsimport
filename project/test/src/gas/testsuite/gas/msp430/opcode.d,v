head	1.3;
access;
symbols
	binutils-2_24-branch:1.3.0.2
	binutils-2_24-branchpoint:1.3
	binutils-2_21_1:1.2
	binutils-2_23_2:1.2
	binutils-2_23_1:1.2
	binutils-2_23:1.2
	binutils-2_23-branch:1.2.0.36
	binutils-2_23-branchpoint:1.2
	binutils-2_22_branch:1.2.0.34
	binutils-2_22:1.2
	binutils-2_22-branch:1.2.0.32
	binutils-2_22-branchpoint:1.2
	binutils-2_21:1.2
	binutils-2_21-branch:1.2.0.30
	binutils-2_21-branchpoint:1.2
	binutils-2_20_1:1.2
	binutils-2_20:1.2
	binutils-arc-20081103-branch:1.2.0.28
	binutils-arc-20081103-branchpoint:1.2
	binutils-2_20-branch:1.2.0.26
	binutils-2_20-branchpoint:1.2
	dje-cgen-play1-branch:1.2.0.24
	dje-cgen-play1-branchpoint:1.2
	arc-20081103-branch:1.2.0.22
	arc-20081103-branchpoint:1.2
	binutils-2_19_1:1.2
	binutils-2_19:1.2
	binutils-2_19-branch:1.2.0.20
	binutils-2_19-branchpoint:1.2
	binutils-2_18:1.2
	binutils-2_18-branch:1.2.0.18
	binutils-2_18-branchpoint:1.2
	binutils-csl-coldfire-4_1-32:1.2
	binutils-csl-sourcerygxx-4_1-32:1.2
	binutils-csl-innovasic-fido-3_4_4-33:1.2
	binutils-csl-sourcerygxx-3_4_4-32:1.2
	binutils-csl-coldfire-4_1-30:1.2
	binutils-csl-sourcerygxx-4_1-30:1.2
	binutils-csl-coldfire-4_1-28:1.2
	binutils-csl-sourcerygxx-4_1-29:1.2
	binutils-csl-sourcerygxx-4_1-28:1.2
	binutils-csl-arm-2006q3-27:1.2
	binutils-csl-sourcerygxx-4_1-27:1.2
	binutils-csl-arm-2006q3-26:1.2
	binutils-csl-sourcerygxx-4_1-26:1.2
	binutils-csl-sourcerygxx-4_1-25:1.2
	binutils-csl-sourcerygxx-4_1-24:1.2
	binutils-csl-sourcerygxx-4_1-23:1.2
	binutils-csl-sourcerygxx-4_1-21:1.2
	binutils-csl-arm-2006q3-21:1.2
	binutils-csl-sourcerygxx-4_1-22:1.2
	binutils-csl-palmsource-arm-prelinker-1_0-1:1.2
	binutils-csl-sourcerygxx-4_1-20:1.2
	binutils-csl-arm-2006q3-19:1.2
	binutils-csl-sourcerygxx-4_1-19:1.2
	binutils-csl-sourcerygxx-4_1-18:1.2
	binutils-csl-renesas-4_1-9:1.2
	binutils-csl-sourcerygxx-3_4_4-25:1.2
	binutils-csl-renesas-4_1-8:1.2
	binutils-csl-renesas-4_1-7:1.2
	binutils-csl-renesas-4_1-6:1.2
	binutils-csl-sourcerygxx-4_1-17:1.2
	binutils-csl-sourcerygxx-4_1-14:1.2
	binutils-csl-sourcerygxx-4_1-15:1.2
	binutils-csl-sourcerygxx-4_1-13:1.2
	binutils-2_17:1.2
	binutils-csl-sourcerygxx-4_1-12:1.2
	binutils-csl-sourcerygxx-3_4_4-21:1.2
	binutils-csl-wrs-linux-3_4_4-24:1.2
	binutils-csl-wrs-linux-3_4_4-23:1.2
	binutils-csl-sourcerygxx-4_1-9:1.2
	binutils-csl-sourcerygxx-4_1-8:1.2
	binutils-csl-sourcerygxx-4_1-7:1.2
	binutils-csl-arm-2006q1-6:1.2
	binutils-csl-sourcerygxx-4_1-6:1.2
	binutils-csl-wrs-linux-3_4_4-22:1.2
	binutils-csl-coldfire-4_1-11:1.2
	binutils-csl-sourcerygxx-3_4_4-19:1.2
	binutils-csl-coldfire-4_1-10:1.2
	binutils-csl-sourcerygxx-4_1-5:1.2
	binutils-csl-sourcerygxx-4_1-4:1.2
	binutils-csl-wrs-linux-3_4_4-21:1.2
	binutils-csl-morpho-4_1-4:1.2
	binutils-csl-sourcerygxx-3_4_4-17:1.2
	binutils-csl-wrs-linux-3_4_4-20:1.2
	binutils-2_17-branch:1.2.0.16
	binutils-2_17-branchpoint:1.2
	binutils-csl-2_17-branch:1.2.0.14
	binutils-csl-2_17-branchpoint:1.2
	binutils-csl-gxxpro-3_4-branch:1.2.0.12
	binutils-csl-gxxpro-3_4-branchpoint:1.2
	binutils-2_16_1:1.2
	binutils-csl-arm-2005q1b:1.2
	binutils-2_16:1.2
	binutils-csl-arm-2005q1a:1.2
	binutils-csl-arm-2005q1-branch:1.2.0.10
	binutils-csl-arm-2005q1-branchpoint:1.2
	binutils-2_16-branch:1.2.0.8
	binutils-2_16-branchpoint:1.2
	csl-arm-2004-q3d:1.2
	csl-arm-2004-q3:1.2
	binutils-2_15:1.2
	binutils-2_15-branchpoint:1.2
	csl-arm-2004-q1a:1.2
	csl-arm-2004-q1:1.2
	binutils-2_15-branch:1.2.0.6
	cagney_bfdfile-20040213-branch:1.2.0.4
	cagney_bfdfile-20040213-branchpoint:1.2
	cagney_bigcore-20040122-branch:1.2.0.2
	cagney_bigcore-20040122-branchpoint:1.2
	csl-arm-2003-q4:1.1
	binutils-2_14:1.1
	binutils-2_14-branch:1.1.0.2
	binutils-2_14-branchpoint:1.1
	binutils_latest_snapshot:1.3;
locks; strict;
comment	@# @;


1.3
date	2013.05.02.21.06.14;	author nickc;	state Exp;
branches;
next	1.2;

1.2
date	2004.01.02.17.26.11;	author nickc;	state Exp;
branches;
next	1.1;

1.1
date	2002.12.31.07.40.56;	author nickc;	state Exp;
branches;
next	;


desc
@@


1.3
log
@	* archures.c: Add some more MSP430 machine numbers.
	* config.bfd (msp430): Define targ_selvecs.
	* configure.in: Add bfd_elf32_msp430_ti_vec.
	* cpu-msp430.c: Add some more MSP430 machine numbers.
	* elf32-msp430.c Add support for MSP430X relocations.
	Add support for TI compiler generated relocations.
	Add support for sym_diff relocations.
	Add support for relaxing out of range short branches into long
	branches.
	Add support for MSP430 attribute section.
	* reloc.c: Add MSP430X relocations.
	* targets.c: Add bfd_elf32_msp430_ti_vec.
	* bfd-in2.h: Regenerate.
	* configure: Regenerate.
	* libbfd.h: Regenerate.

	* readelf.c: Add support for MSP430X architecture.

	* readelf.exp: Expect -wi test to fail for the MSP430.

	* config/tc-msp430.c: Add support for the MSP430X architecture.
	Add code to insert a NOP instruction after any instruction that
	might change the interrupt state.
	Add support for the LARGE memory model.
	Add code to initialise the .MSP430.attributes section.
	* config/tc-msp430.h: Add support for the MSP430X architecture.
	* doc/c-msp430.texi: Document the new -mL and -mN command line
	options.
	* NEWS: Mention support for the MSP430X architecture.

	* gas/all/gas.exp: Skip the DIFF1 test for the MSP430.
	Expect the FORWARD test to pass for the MSP430.
	Skip the REDEF tests for the MSP430.
	Expect the 930509A test to fail for the MSP430.
	* gas/all/sleb128-4.d: Skip for the MSP430.
	* gas/elf/elf.exp: Set target_machine to msp430 for the MSP430.
	Skip the EHOPT0 test for the MSP430.
	Skip the REDEF and EQU-RELOC tests for the MSP430.
	* gas/elf/section2.e-msp430: New file.
	* gas/lns/lns-big-delta.d: Remove expectation of 20-bit
	addresses.
	* gas/lns/lns.exp: Use alternate LNS COMMON test for the MSP430.
	* gas/msp430/msp430x.s: New test.
	* gas/msp430/msp430x.d: Expected disassembly.
	* gas/msp430/msp430.exp: Run new test.
	* gas/msp430/opcode.d: Update expected disassembly.

	* msp430.h: Add MSP430X relocs.
	Add some more MSP430 machine numbers.
	Add values used by .MSP430.attributes section.

	* msp430.h: Add patterns for MSP430X instructions.

	* Makefile.am: Add emsp430X.c
	* Makefine.in: Regenerate.
	* configure.tgt (msp430): Add msp430X emulation.
	* ldmain.c (multiple_definition): Only disable relaxation if it
	was enabled by the user.
	* ldmain.h (RELAXATION_ENABLED_BY_USER): New macro.
	* emulparams/msp430all.sh: Add support for MSP430X.
	* emultempl/generic.em: (before_parse): Enable relaxation for the
	MSP430.
	* scripttempl/msp430.sc: Reorganize sections.  Add .rodata
	section.
	* scripttempl/msp430_3.sc: Likewise.
	* NEWS: Mention support for MSP430X.

	* ld-elf/flags1.d: Expect this test to pass on the MSP430.
	* ld-elf/init-fini-arrays.d: Expect this test to fail on the
	MSP430.
	* ld-elf/merge.d: Expect this test to pass on the MSP430.
	* ld-elf/sec64k.exp: Skip these tests for the MSP430.
	* ld-gc/pr13683.d: Expect this test to fail on the MSP430.
	* ld-srec/srec.exp: Expect these tests to fail on the MSP430.
	* ld-undefined/undefined.exp: Expect the UNDEFINED LINE test to
	fail on the MSP430.

	* msp430-dis.c: Add support for MSP430X instructions.
@
text
@#objdump: -d --prefix-addresses --show-raw-insn
#name: MSP430 basic instructions

.*: +file format .*msp.*

Disassembly of section .text:
0+000 <[^>]*> 1b f3       	and	#1,	r11	;r3 As==01
0+002 <[^>]*> 3a e3       	inv	r10		;
0+004 <[^>]*> 3b e0 ff 00 	xor	#255,	r11	;#0x00ff
0+008 <[^>]*> 3c d2       	bis	#8,	r12	;r2 As==11
0+00a <[^>]*> 3d b0 10 00 	bit	#16,	r13	;#0x0010
0+00e <[^>]*> 3e c0 a0 00 	bic	#160,	r14	;#0x00a0
0+012 <[^>]*> 0f 93       	cmp	#0,	r15	;r3 As==00
0+014 <[^>]*> 1a 83       	dec	r10		;
0+016 <[^>]*> 0b 73       	sbc	r11		;
0+018 <[^>]*> 1c 53       	inc	r12		;
0+01a <[^>]*> 2d 63       	addc	#2,	r13	;r3 As==10
0+01c <[^>]*> 0e 12       	push	r14		;
0+01e <[^>]*> 3f 41       	pop	r15		;
0+020 <[^>]*> 8a 11       	sxt	r10		;
0+022 <[^>]*> 0b 11       	rra	r11		;
0+024 <[^>]*> 8c 10       	swpb	r12		;
0+026 <[^>]*> 0d 10       	rrc	r13		;
0+028 <[^>]*> 30 41       	ret			
0+02a <[^>]*> 31 40 00 00 	mov	#0,	r1	;
0+02e <[^>]*> b0 12 00 00 	call	#0		;
0+032 <[^>]*> 1e 42 00 00 	mov	&0x0000,r14	;0x0000
0+036 <[^>]*> 0f 4e       	mov	r14,	r15	;
0+038 <[^>]*> 0f 5f       	rla	r15		;
0+03a <[^>]*> 0f 7f       	subc	r15,	r15	;
0+03c <[^>]*> 3f e3       	inv	r15		;
0+03e <[^>]*> b0 12 00 00 	call	#0		;
0+042 <[^>]*> 82 4e 00 00 	mov	r14,	&0x0000	;
0+046 <[^>]*> 82 4f 00 00 	mov	r15,	&0x0000	;
0+04a <[^>]*> 1e 42 00 00 	mov	&0x0000,r14	;0x0000
0+04e <[^>]*> 0f 4e       	mov	r14,	r15	;
0+050 <[^>]*> 0f 5f       	rla	r15		;
0+052 <[^>]*> 0f 7f       	subc	r15,	r15	;
0+054 <[^>]*> 3f e3       	inv	r15		;
0+056 <[^>]*> b0 12 00 00 	call	#0		;
0+05a <[^>]*> 82 4e 00 00 	mov	r14,	&0x0000	;
0+05e <[^>]*> 82 4f 00 00 	mov	r15,	&0x0000	;
0+062 <[^>]*> 3f 40 f0 00 	mov	#240,	r15	;#0x00f0
0+066 <[^>]*> 30 40 00 00 	br	#0x0000		;
0+06a <[^>]*> 92 52 00 02 72 01 	add	&0x0200,&0x0172	;0x0200
@


1.2
log
@Catch a bug in the msp430 disassembler where an add instruction was confused
with an rla instruction.  Add a test for this to the testsuite.
@
text
@d25 2
a26 2
0+02a <[^>]*> 31 40 00 00 	mov	#0,	r1	;#0x0000
0+02e <[^>]*> b0 12 00 00 	call	#0		;#0x0000
d32 1
a32 1
0+03e <[^>]*> b0 12 00 00 	call	#0		;#0x0000
d40 1
a40 1
0+056 <[^>]*> b0 12 00 00 	call	#0		;#0x0000
@


1.1
log
@oops - omitted from previous delta
@
text
@d45 1
a45 1

@

