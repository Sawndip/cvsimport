head	1.3;
access;
symbols
	binutils-2_24-branch:1.3.0.4
	binutils-2_24-branchpoint:1.3
	binutils-2_21_1:1.2
	binutils-2_23_2:1.3
	binutils-2_23_1:1.3
	binutils-2_23:1.3
	binutils-2_23-branch:1.3.0.2
	binutils-2_23-branchpoint:1.3
	binutils-2_22_branch:1.2.0.16
	binutils-2_22:1.2
	binutils-2_22-branch:1.2.0.14
	binutils-2_22-branchpoint:1.2
	binutils-2_21:1.2
	binutils-2_21-branch:1.2.0.12
	binutils-2_21-branchpoint:1.2
	binutils-2_20_1:1.2
	binutils-2_20:1.2
	binutils-arc-20081103-branch:1.2.0.10
	binutils-arc-20081103-branchpoint:1.2
	binutils-2_20-branch:1.2.0.8
	binutils-2_20-branchpoint:1.2
	dje-cgen-play1-branch:1.2.0.6
	dje-cgen-play1-branchpoint:1.2
	arc-20081103-branch:1.2.0.4
	arc-20081103-branchpoint:1.2
	binutils-2_19_1:1.2
	binutils-2_19:1.2
	binutils-2_19-branch:1.2.0.2
	binutils-2_19-branchpoint:1.2
	binutils-2_18:1.1
	binutils-2_18-branch:1.1.0.20
	binutils-2_18-branchpoint:1.1
	binutils-csl-coldfire-4_1-32:1.1
	binutils-csl-sourcerygxx-4_1-32:1.1
	binutils-csl-innovasic-fido-3_4_4-33:1.1
	binutils-csl-sourcerygxx-3_4_4-32:1.1
	binutils-csl-coldfire-4_1-30:1.1
	binutils-csl-sourcerygxx-4_1-30:1.1
	binutils-csl-coldfire-4_1-28:1.1
	binutils-csl-sourcerygxx-4_1-29:1.1
	binutils-csl-sourcerygxx-4_1-28:1.1
	binutils-csl-arm-2006q3-27:1.1
	binutils-csl-sourcerygxx-4_1-27:1.1
	binutils-csl-arm-2006q3-26:1.1
	binutils-csl-sourcerygxx-4_1-26:1.1
	binutils-csl-sourcerygxx-4_1-25:1.1
	binutils-csl-sourcerygxx-4_1-24:1.1
	binutils-csl-sourcerygxx-4_1-23:1.1
	binutils-csl-sourcerygxx-4_1-21:1.1
	binutils-csl-arm-2006q3-21:1.1
	binutils-csl-sourcerygxx-4_1-22:1.1
	binutils-csl-palmsource-arm-prelinker-1_0-1:1.1
	binutils-csl-sourcerygxx-4_1-20:1.1
	binutils-csl-arm-2006q3-19:1.1
	binutils-csl-sourcerygxx-4_1-19:1.1
	binutils-csl-sourcerygxx-4_1-18:1.1
	binutils-csl-renesas-4_1-9:1.1
	binutils-csl-sourcerygxx-3_4_4-25:1.1
	binutils-csl-renesas-4_1-8:1.1
	binutils-csl-renesas-4_1-7:1.1
	binutils-csl-renesas-4_1-6:1.1
	binutils-csl-sourcerygxx-4_1-17:1.1
	binutils-csl-sourcerygxx-4_1-14:1.1
	binutils-csl-sourcerygxx-4_1-15:1.1
	binutils-csl-sourcerygxx-4_1-13:1.1
	binutils-2_17:1.1
	binutils-csl-sourcerygxx-4_1-12:1.1
	binutils-csl-sourcerygxx-3_4_4-21:1.1
	binutils-csl-wrs-linux-3_4_4-24:1.1
	binutils-csl-wrs-linux-3_4_4-23:1.1
	binutils-csl-sourcerygxx-4_1-9:1.1
	binutils-csl-sourcerygxx-4_1-8:1.1
	binutils-csl-sourcerygxx-4_1-7:1.1
	binutils-csl-arm-2006q1-6:1.1
	binutils-csl-sourcerygxx-4_1-6:1.1
	binutils-csl-wrs-linux-3_4_4-22:1.1
	binutils-csl-coldfire-4_1-11:1.1
	binutils-csl-sourcerygxx-3_4_4-19:1.1
	binutils-csl-coldfire-4_1-10:1.1
	binutils-csl-sourcerygxx-4_1-5:1.1
	binutils-csl-sourcerygxx-4_1-4:1.1
	binutils-csl-wrs-linux-3_4_4-21:1.1
	binutils-csl-morpho-4_1-4:1.1
	binutils-csl-sourcerygxx-3_4_4-17:1.1
	binutils-csl-wrs-linux-3_4_4-20:1.1
	binutils-2_17-branch:1.1.0.18
	binutils-2_17-branchpoint:1.1
	binutils-csl-2_17-branch:1.1.0.16
	binutils-csl-2_17-branchpoint:1.1
	binutils-csl-gxxpro-3_4-branch:1.1.0.14
	binutils-csl-gxxpro-3_4-branchpoint:1.1
	binutils-2_16_1:1.1
	binutils-csl-arm-2005q1b:1.1
	binutils-2_16:1.1
	binutils-csl-arm-2005q1a:1.1
	binutils-csl-arm-2005q1-branch:1.1.0.12
	binutils-csl-arm-2005q1-branchpoint:1.1
	binutils-2_16-branch:1.1.0.10
	binutils-2_16-branchpoint:1.1
	csl-arm-2004-q3d:1.1
	csl-arm-2004-q3:1.1
	binutils-2_15:1.1
	binutils-2_15-branchpoint:1.1
	csl-arm-2004-q1a:1.1
	csl-arm-2004-q1:1.1
	binutils-2_15-branch:1.1.0.8
	cagney_bfdfile-20040213-branch:1.1.0.6
	cagney_bfdfile-20040213-branchpoint:1.1
	cagney_bigcore-20040122-branch:1.1.0.4
	cagney_bigcore-20040122-branchpoint:1.1
	csl-arm-2003-q4:1.1
	binutils-2_14:1.1
	binutils-2_14-branch:1.1.0.2
	binutils-2_14-branchpoint:1.1
	binutils_latest_snapshot:1.3;
locks; strict;
comment	@# @;


1.3
date	2012.05.15.12.55.39;	author nickc;	state Exp;
branches;
next	1.2;

1.2
date	2008.02.22.15.33.31;	author nickc;	state Exp;
branches;
next	1.1;

1.1
date	2002.12.01.14.32.48;	author ciceron;	state Exp;
branches;
next	;


desc
@@


1.3
log
@	* config/tc-m68hc11.c: Add S12X and XGATE co-processor support.
	Add option to offset S12 addresses into XGATE memory space.
	Tweak target flags to match other tools. (i.e. -m m68hc11).
	* doc/as.texinfo: Mention new options.
	* doc/c-m68hc11.texi: Document new options.
	* NEWS: Mention new support.

	* archures.c: Add bfd_arch_m9s12x and bfd_arch_m9s12xg.
	* config.bfd: Likewise.
	* cpu-m9s12x.c: New.
	* cpu-m9s12xg.c: New.
	* elf32-m68hc12.c: Add S12X and XGATE co-processor support.
	Add option to offset S12 addresses into XGATE memory space.
	Fix carry bug in IMM16 (IMM8 low/high) relocate.
	* Makefile.am (ALL_MACHINES): Add cpu-m9s12x and cpu-m9s12xg.
	(ALL_MACHINES_CFILES): Likewise.
	* reloc.c: Add S12X relocs.
	* Makefile.in: Regenerate.
	* bfd-in2.h: Regenerate.
	* libbfd.h: Regenerate.

	* gas/m68hc11/insns9s12x.s: New
	* gas/m68hc11/insns9s12x.d: New
	* gas/m68hc11/hexprefix.s: New
	* gas/m68hc11/hexprefix.d: New
	* gas/m68hc11/9s12x-exg-sex-tfr.s: New
	* gas/m68hc11/9s12x-exg-sex-tfr.d: New
	* gas/m68hc11/insns9s12xg.s: New
	* gas/m68hc11/insns9s12xg.d: New
	* gas/m68hc11/9s12x-mov.s: New
	* gas/m68hc11/9s12x-mov.d: New
	* gas/m68hc11/m68hc11.exp: Updated
	* gas/m68hc11/*.d: Brought in line with changed objdump output.
	* gas/all/gas.exp: XFAIL all hc11/12 targets for redef2,3.
	* gas/elf/elf.exp: XFAIL all hc11/12 targets for redef.
	* gas/elf/dwarf2-1.d: Skip for hc11/12 targets.
	* gas/elf/dwarf2-2.d: Likewise.

	* ld-m68hc11/xgate-link.s: New.
	* ld-m68hc11/xgate-link.d: New.
	* ld-m68hc11/xgate-offset.s: New.
	* ld-m68hc11/xgate-offset.d: New.
	* ld-m68hc11/xgate1.s: New.
	* ld-m68hc11/xgate1.d: New.
	* ld-m68hc11/xgate2.s: New.
	* ld-m68hc11/m68hc11.exp: Updated.
	* ld-m68hc11/*.d: Brought in line with changed objdump output.
	* ld-gc/gc.exp: Update CFLAGS for m68hc11.
	* ld-plugin/plugin.exp: Likewise.
	* ld-srec/srec.exp: XFAIL for m68hc11 and m68hc12.

	* configure.in: Add S12X and XGATE co-processor support to m68hc11
	target.
	* disassemble.c: Likewise.
	* configure: Regenerate.
	* m68hc11-dis.c: Make objdump output more consistent, use hex
	instead of decimal and use 0x prefix for hex.
	* m68hc11-opc.c: Add S12X and XGATE opcodes.
	* dis-asm.h (print_insn_m9s12x): Prototype.
	(print_insn_m9s12xg): Prototype.

	* m68hc11.h (R_M68HC12_16B, R_M68HC12_PCREL_9, R_M68HC12_PCREL_10)
	R_M68HC12_HI8XG, R_M68HC12_LO8XG): New relocations.
	(E_M68HC11_XGATE_RAMOFFSET): Define.

	* m68hc11.h: Add XGate definitions.
	(struct m68hc11_opcode): Add xg_mask field.
@
text
@#objdump: -S
#as: -m68hc12 -gdwarf2
#name: 68HC12 indexed addressing mode with 5, 9 and 16-bit offsets (indexed12)
#source: indexed12.s

.*: +file format elf32\-m68hc12

Disassembly of section .text:

0+ <_main>:
;; with a 5, 9 and 16-bit offset.
;;
	.sect .text
	.globl _main
_main:
	nop
   0:	a7          	nop
;;; Global check \(1st\)
	ldab	L1\-_main,x	; Offset/const of these 2 insns must be
   1:	e6 e0 93    	ldab	0x93,X
	ldaa	#L1\-_main	; identical \(likewise for 2nd global check\)
   4:	86 93       	ldaa	#0x93
;;; Test gas relax with difference of symbols \(same section\)
	ldaa	L2\-L1,x		; \-> ldaa 2,x \(5\-bit offset\), text seg
   6:	a6 02       	ldaa	0x2,X
	adda	L1\-L2,y		; \-> adda \-2,y \(5\-bit offset\), text seg
   8:	ab 5e       	adda	0xfffe,Y

	orab	L7\-L6,sp	; \-> orab 8,sp  \(5\-bit offset\), text seg
   a:	ea 88       	orab	0x8,SP
	anda	L8\-L7,sp	; \-> anda 15,sp \(5\-bit offset\), text seg
   c:	a4 8f       	anda	0xf,SP
	eora	L7\-L8,sp	; \-> eora \-15,sp \(5\-bit offset\), text seg
   e:	a8 91       	eora	0xfff1,SP
	eorb	L7\-L9,sp	; \-> eorb \-16,sp \(5\-bit offset\), text seg
  10:	e8 90       	eorb	0xfff0,SP

	andb	L9\-L7,sp	; \-> andb 16,sp \(9\-bit offset\), text seg
  12:	e4 f0 10    	andb	0x10,SP
	staa	L7\-L10,x	; \-> staa \-17,x \(9\-bit offset\), text seg
  15:	6a e1 ef    	staa	0xffef,X
	stab	L11\-L10,y	; \-> stab 128,y \(9\-bit offset\), text seg
  18:	6b e8 80    	stab	0x80,Y
	stab	L10\-L11,y	; \-> stab \-128,y \(9\-bit offset\), text seg
  1b:	6b e9 80    	stab	0xff80,Y
	stab	L11\-L10\+1,y	; \-> stab 129,y \(9\-bit offset\), text seg
  1e:	6b e8 81    	stab	0x81,Y
	stab	L10\-L11\-1,y	; \-> stab \-129,y \(9\-bit offset\), text seg
  21:	6b e9 7f    	stab	0xff7f,Y
	stab	L11\-1\-L10,y	; \-> stab 127,y \(9\-bit offset\), text seg
  24:	6b e8 7f    	stab	0x7f,Y
	stab	L10\-1\-L11,y	; \-> stab \-129,y \(9\-bit offset\), text seg
  27:	6b e9 7f    	stab	0xff7f,Y

	tst	L12\-L10,x	; \-> tst 255,x \(9\-bit offset\), text seg
  2a:	e7 e0 ff    	tst	0xff,X
	tst	L10\-L12,x	; \-> tst \-255,x \(9\-bit offset\), text seg
  2d:	e7 e1 01    	tst	0xff01,X
	tst	L12\-L10\+1,x	; \-> tst 256,x \(16\-bit offset\), text seg
  30:	e7 e2 01 00 	tst	0x100,X
	mina	L13\-L10,x	; \-> mina 256,x \(16\-bit offset\)
  34:	18 19 e2 01 	mina	0x100,X
  38:	00 
	mina	L10\-L13,x	; \-> mina \-256,x \(9\-bit offset\)
  39:	18 19 e1 00 	mina	0xff00,X

	maxa	L14\-L10,x	; \-> maxa 257,x \(16\-bit offset\)
  3d:	18 18 e2 01 	maxa	0x101,X
  41:	01 
	maxa	L10\-L14,x	; \-> maxa \-257,x \(16\-bit offset\)
  42:	18 18 e2 fe 	maxa	0xfeff,X
  46:	ff 

;;; Test gas relax with difference of symbols \(different section\)
	ldaa	D2\-D1,x		; \-> ldaa 2,x \(5\-bit offset\), data seg
  47:	a6 02       	ldaa	0x2,X
	adda	D1\-D2,y		; \-> adda \-2,y \(5\-bit offset\), data seg
  49:	ab 5e       	adda	0xfffe,Y

	orab	D7\-D6,sp	; \-> orab 8,sp  \(5\-bit offset\), data seg
  4b:	ea 88       	orab	0x8,SP
	anda	D8\-D7,sp	; \-> anda 15,sp \(5\-bit offset\), data seg
  4d:	a4 8f       	anda	0xf,SP
	eora	D7\-D8,sp	; \-> eora \-15,sp \(5\-bit offset\), data seg
  4f:	a8 91       	eora	0xfff1,SP
	eorb	D7\-D9,sp	; \-> eorb \-16,sp \(5\-bit offset\), data seg
  51:	e8 90       	eorb	0xfff0,SP

	andb	D9\-D7,sp	; \-> andb 16,sp \(9\-bit offset\), data seg
  53:	e4 f0 10    	andb	0x10,SP
	staa	D7\-D10,x	; \-> staa \-17,x \(9\-bit offset\), data seg
  56:	6a e1 ef    	staa	0xffef,X
	stab	D11\-D10,y	; \-> stab 128,y \(9\-bit offset\), data seg
  59:	6b e8 80    	stab	0x80,Y
	stab	D10\-D11,y	; \-> stab \-128,y \(9\-bit offset\), data seg
  5c:	6b e9 80    	stab	0xff80,Y
	stab	D11\-D10\+1,y	; \-> stab 129,y \(9\-bit offset\), data seg
  5f:	6b e8 81    	stab	0x81,Y
	stab	D10\-D11\+1,y	; \-> stab \-127,y \(9\-bit offset\), data seg
  62:	6b e9 81    	stab	0xff81,Y
	stab	D11\-1\-D10,y	; \-> stab 127,y \(9\-bit offset\), data seg
  65:	6b e8 7f    	stab	0x7f,Y
	stab	D10\-1\-D11,y	; \-> stab \-129,y \(9\-bit offset\), data seg
  68:	6b e9 7f    	stab	0xff7f,Y

	tst	D12\-D10,x	; \-> tst 255,x \(9\-bit offset\), data seg
  6b:	e7 e0 ff    	tst	0xff,X
	tst	D10\-D12,x	; \-> tst \-255,x \(9\-bit offset\), data seg
  6e:	e7 e1 01    	tst	0xff01,X
	tst	D12\-D10\+1,x	; \-> tst 256,x \(16\-bit offset\), data seg
  71:	e7 e2 01 00 	tst	0x100,X
	mina	D13\-D10,x	; \-> mina 256,x \(16\-bit offset\)
  75:	18 19 e2 01 	mina	0x100,X
  79:	00 
	mina	D10\-D13,x	; \-> mina \-256,x \(9\-bit offset\)
  7a:	18 19 e1 00 	mina	0xff00,X

	maxa	D14\-D10,x	; \-> maxa 257,x \(16\-bit offset\)
  7e:	18 18 e2 01 	maxa	0x101,X
  82:	01 
	maxa	D10\-D14,x	; \-> maxa \-257,x \(16\-bit offset\)
  83:	18 18 e2 fe 	maxa	0xfeff,X
  87:	ff 

;;; Global check \(2nd\)
	ldab	L1\-_main,x
  88:	e6 e0 93    	ldab	0x93,X
	ldaa	#L1\-_main
  8b:	86 93       	ldaa	#0x93

;;; Indexed addressing with external symbol
	ldab	_external\+128,x
  8d:	e6 e2 00 80 	ldab	0x80,X
	bra	L2
  91:	20 02       	bra	0x95 <L2>

0+93 <L1>:
  93:	aa bb       	oraa	5,SP\-

0+95 <L2>:
  95:	a7          	nop
  96:	a7          	nop
  97:	a7          	nop
  98:	a7          	nop
  99:	a7          	nop
  9a:	a7          	nop
  9b:	a7          	nop
  9c:	a7          	nop

0+9d <L7>:
  9d:	a7          	nop
  9e:	a7          	nop
  9f:	a7          	nop
  a0:	a7          	nop
  a1:	a7          	nop
  a2:	a7          	nop
  a3:	a7          	nop
  a4:	a7          	nop
  a5:	a7          	nop
  a6:	a7          	nop
  a7:	a7          	nop
  a8:	a7          	nop
  a9:	a7          	nop
  aa:	a7          	nop
  ab:	a7          	nop

0+ac <L8>:
L6:
	.ds.b	8, 0xa7
L7:
	.ds.b	15, 0xa7
L8:
	nop
  ac:	a7          	nop

0+ad <L9>:
L9:
	nop
  ad:	a7          	nop

0+ae <L10>:
	...

0+12e <L11>:
	...

0+1ad <L12>:
L10:
	.skip	128
L11:
	.skip	127
L12:
	nop
 1ad:	a7          	nop

0+1ae <L13>:
L13:
	nop
 1ae:	a7          	nop

0+1af <L14>:
L14:
	rts
 1af:	3d          	rts
@


1.2
log
@* gas/m68hc11/bug-1825.d: Update to match changes in the
  information generated with source-in-disassembly listings.
  * gas/m68hc11/indexed12.d: Likewise.
  * gas/m68hc11/insns-dwarf2.d: Likewise.
  * gas/m68hc11/lbranch-dwarf2.d: Likewise.
@
text
@d20 1
a20 1
   1:	e6 e0 93    	ldab	147,X
d22 1
a22 1
   4:	86 93       	ldaa	#147
d25 1
a25 1
   6:	a6 02       	ldaa	2,X
d27 1
a27 1
   8:	ab 5e       	adda	\-2,Y
d30 1
a30 1
   a:	ea 88       	orab	8,SP
d32 1
a32 1
   c:	a4 8f       	anda	15,SP
d34 1
a34 1
   e:	a8 91       	eora	\-15,SP
d36 1
a36 1
  10:	e8 90       	eorb	\-16,SP
d39 1
a39 1
  12:	e4 f0 10    	andb	16,SP
d41 1
a41 1
  15:	6a e1 ef    	staa	\-17,X
d43 1
a43 1
  18:	6b e8 80    	stab	128,Y
d45 1
a45 1
  1b:	6b e9 80    	stab	\-128,Y
d47 1
a47 1
  1e:	6b e8 81    	stab	129,Y
d49 1
a49 1
  21:	6b e9 7f    	stab	\-129,Y
d51 1
a51 1
  24:	6b e8 7f    	stab	127,Y
d53 1
a53 1
  27:	6b e9 7f    	stab	\-129,Y
d56 1
a56 1
  2a:	e7 e0 ff    	tst	255,X
d58 1
a58 1
  2d:	e7 e1 01    	tst	\-255,X
d60 1
a60 1
  30:	e7 e2 01 00 	tst	256,X
d62 1
a62 1
  34:	18 19 e2 01 	mina	256,X
d65 1
a65 1
  39:	18 19 e1 00 	mina	\-256,X
d68 1
a68 1
  3d:	18 18 e2 01 	maxa	257,X
d71 1
a71 1
  42:	18 18 e2 fe 	maxa	\-257,X
d76 1
a76 1
  47:	a6 02       	ldaa	2,X
d78 1
a78 1
  49:	ab 5e       	adda	\-2,Y
d81 1
a81 1
  4b:	ea 88       	orab	8,SP
d83 1
a83 1
  4d:	a4 8f       	anda	15,SP
d85 1
a85 1
  4f:	a8 91       	eora	\-15,SP
d87 1
a87 1
  51:	e8 90       	eorb	\-16,SP
d90 1
a90 1
  53:	e4 f0 10    	andb	16,SP
d92 1
a92 1
  56:	6a e1 ef    	staa	\-17,X
d94 1
a94 1
  59:	6b e8 80    	stab	128,Y
d96 1
a96 1
  5c:	6b e9 80    	stab	\-128,Y
d98 1
a98 1
  5f:	6b e8 81    	stab	129,Y
d100 1
a100 1
  62:	6b e9 81    	stab	\-127,Y
d102 1
a102 1
  65:	6b e8 7f    	stab	127,Y
d104 1
a104 1
  68:	6b e9 7f    	stab	\-129,Y
d107 1
a107 1
  6b:	e7 e0 ff    	tst	255,X
d109 1
a109 1
  6e:	e7 e1 01    	tst	\-255,X
d111 1
a111 1
  71:	e7 e2 01 00 	tst	256,X
d113 1
a113 1
  75:	18 19 e2 01 	mina	256,X
d116 1
a116 1
  7a:	18 19 e1 00 	mina	\-256,X
d119 1
a119 1
  7e:	18 18 e2 01 	maxa	257,X
d122 1
a122 1
  83:	18 18 e2 fe 	maxa	\-257,X
d127 1
a127 1
  88:	e6 e0 93    	ldab	147,X
d129 1
a129 1
  8b:	86 93       	ldaa	#147
d133 1
a133 1
  8d:	e6 e2 00 80 	ldab	128,X
d135 1
a135 1
  91:	20 02       	bra	95 <L2>
@


1.1
log
@	* gas/m68hc11/m68hc11.exp: Rename from all.exp; run the new tests.
	* gas/m68hc11/all.exp: Remove.
	* gas/m68hc11/indexed12.d: New test.
	* gas/m68hc11/indexed12.s: Likewise.
	* gas/m68hc11/bug-1825.d: Likewise.
	* gas/m68hc11/bug-1825.s: Likewise.
@
text
@d11 1
a167 3
L1:
	.dc.w	0xaabb
L2:
@

