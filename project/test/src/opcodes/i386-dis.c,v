head	1.282;
access;
symbols
	sid-snapshot-20180601:1.282
	sid-snapshot-20180501:1.282
	sid-snapshot-20180401:1.282
	sid-snapshot-20180301:1.282
	sid-snapshot-20180201:1.282
	sid-snapshot-20180101:1.282
	sid-snapshot-20171201:1.282
	sid-snapshot-20171101:1.282
	sid-snapshot-20171001:1.282
	sid-snapshot-20170901:1.282
	sid-snapshot-20170801:1.282
	sid-snapshot-20170701:1.282
	sid-snapshot-20170601:1.282
	sid-snapshot-20170501:1.282
	sid-snapshot-20170401:1.282
	sid-snapshot-20170301:1.282
	sid-snapshot-20170201:1.282
	sid-snapshot-20170101:1.282
	sid-snapshot-20161201:1.282
	sid-snapshot-20161101:1.282
	sid-snapshot-20160901:1.282
	sid-snapshot-20160801:1.282
	sid-snapshot-20160701:1.282
	sid-snapshot-20160601:1.282
	sid-snapshot-20160501:1.282
	sid-snapshot-20160401:1.282
	sid-snapshot-20160301:1.282
	sid-snapshot-20160201:1.282
	sid-snapshot-20160101:1.282
	sid-snapshot-20151201:1.282
	sid-snapshot-20151101:1.282
	sid-snapshot-20151001:1.282
	sid-snapshot-20150901:1.282
	sid-snapshot-20150801:1.282
	sid-snapshot-20150701:1.282
	sid-snapshot-20150601:1.282
	sid-snapshot-20150501:1.282
	sid-snapshot-20150401:1.282
	sid-snapshot-20150301:1.282
	sid-snapshot-20150201:1.282
	sid-snapshot-20150101:1.282
	sid-snapshot-20141201:1.282
	sid-snapshot-20141101:1.282
	sid-snapshot-20141001:1.282
	sid-snapshot-20140901:1.282
	sid-snapshot-20140801:1.282
	sid-snapshot-20140701:1.282
	sid-snapshot-20140601:1.282
	sid-snapshot-20140501:1.282
	sid-snapshot-20140401:1.282
	sid-snapshot-20140301:1.282
	sid-snapshot-20140201:1.282
	sid-snapshot-20140101:1.282
	sid-snapshot-20131201:1.282
	sid-snapshot-20131101:1.282
	sid-snapshot-20131001:1.280
	binutils-2_24-branch:1.280.0.2
	binutils-2_24-branchpoint:1.280
	binutils-2_21_1:1.252
	sid-snapshot-20130901:1.280
	gdb_7_6_1-2013-08-30-release:1.275
	sid-snapshot-20130801:1.279
	sid-snapshot-20130701:1.276
	sid-snapshot-20130601:1.276
	sid-snapshot-20130501:1.276
	gdb_7_6-2013-04-26-release:1.275
	sid-snapshot-20130401:1.276
	binutils-2_23_2:1.270
	gdb_7_6-branch:1.275.0.2
	gdb_7_6-2013-03-12-branchpoint:1.275
	sid-snapshot-20130301:1.275
	sid-snapshot-20130201:1.274
	sid-snapshot-20130101:1.274
	sid-snapshot-20121201:1.274
	gdb_7_5_1-2012-11-29-release:1.269
	binutils-2_23_1:1.270
	sid-snapshot-20121101:1.274
	binutils-2_23:1.270
	sid-snapshot-20121001:1.273
	sid-snapshot-20120901:1.273
	gdb_7_5-2012-08-17-release:1.269
	sid-snapshot-20120801:1.270
	binutils-2_23-branch:1.270.0.2
	binutils-2_23-branchpoint:1.270
	gdb_7_5-branch:1.269.0.2
	gdb_7_5-2012-07-18-branchpoint:1.269
	sid-snapshot-20120701:1.268
	sid-snapshot-20120601:1.268
	sid-snapshot-20120501:1.268
	binutils-2_22_branch:1.265.0.4
	gdb_7_4_1-2012-04-26-release:1.266
	sid-snapshot-20120401:1.268
	sid-snapshot-20120301:1.268
	sid-snapshot-20120201:1.267
	gdb_7_4-2012-01-24-release:1.266
	sid-snapshot-20120101:1.266
	gdb_7_4-branch:1.266.0.2
	gdb_7_4-2011-12-13-branchpoint:1.266
	sid-snapshot-20111201:1.266
	binutils-2_22:1.265
	sid-snapshot-20111101:1.266
	sid-snapshot-20111001:1.265
	binutils-2_22-branch:1.265.0.2
	binutils-2_22-branchpoint:1.265
	gdb_7_3_1-2011-09-04-release:1.258
	sid-snapshot-20110901:1.265
	sid-snapshot-20110801:1.263
	gdb_7_3-2011-07-26-release:1.258
	sid-snapshot-20110701:1.262
	sid-snapshot-20110601:1.258
	sid-snapshot-20110501:1.258
	gdb_7_3-branch:1.258.0.2
	gdb_7_3-2011-04-01-branchpoint:1.258
	sid-snapshot-20110401:1.258
	sid-snapshot-20110301:1.258
	sid-snapshot-20110201:1.257
	sid-snapshot-20110101:1.253
	binutils-2_21:1.252
	sid-snapshot-20101201:1.252
	binutils-2_21-branch:1.252.0.2
	binutils-2_21-branchpoint:1.252
	sid-snapshot-20101101:1.252
	sid-snapshot-20101001:1.251
	binutils-2_20_1:1.198
	gdb_7_2-2010-09-02-release:1.247
	sid-snapshot-20100901:1.251
	sid-snapshot-20100801:1.248
	gdb_7_2-branch:1.247.0.2
	gdb_7_2-2010-07-07-branchpoint:1.247
	sid-snapshot-20100701:1.245
	sid-snapshot-20100601:1.245
	sid-snapshot-20100501:1.244
	sid-snapshot-20100401:1.241
	gdb_7_1-2010-03-18-release:1.240
	sid-snapshot-20100301:1.240
	gdb_7_1-branch:1.240.0.2
	gdb_7_1-2010-02-18-branchpoint:1.240
	sid-snapshot-20100201:1.238
	sid-snapshot-20100101:1.228
	gdb_7_0_1-2009-12-22-release:1.200
	sid-snapshot-20091201:1.216
	sid-snapshot-20091101:1.206
	binutils-2_20:1.198
	gdb_7_0-2009-10-06-release:1.200
	sid-snapshot-20091001:1.200
	gdb_7_0-branch:1.200.0.2
	gdb_7_0-2009-09-16-branchpoint:1.200
	arc-sim-20090309:1.175
	binutils-arc-20081103-branch:1.183.0.10
	binutils-arc-20081103-branchpoint:1.183
	binutils-2_20-branch:1.198.0.2
	binutils-2_20-branchpoint:1.198
	sid-snapshot-20090901:1.198
	sid-snapshot-20090801:1.197
	msnyder-checkpoint-072509-branch:1.197.0.2
	msnyder-checkpoint-072509-branchpoint:1.197
	sid-snapshot-20090701:1.194
	dje-cgen-play1-branch:1.194.0.2
	dje-cgen-play1-branchpoint:1.194
	sid-snapshot-20090601:1.194
	sid-snapshot-20090501:1.193
	sid-snapshot-20090401:1.193
	arc-20081103-branch:1.183.0.8
	arc-20081103-branchpoint:1.183
	arc-insight_6_8-branch:1.175.0.6
	arc-insight_6_8-branchpoint:1.175
	insight_6_8-branch:1.175.0.4
	insight_6_8-branchpoint:1.175
	sid-snapshot-20090301:1.192
	binutils-2_19_1:1.183
	sid-snapshot-20090201:1.190
	sid-snapshot-20090101:1.187
	reverse-20081226-branch:1.187.0.2
	reverse-20081226-branchpoint:1.187
	sid-snapshot-20081201:1.183
	multiprocess-20081120-branch:1.183.0.6
	multiprocess-20081120-branchpoint:1.183
	sid-snapshot-20081101:1.183
	binutils-2_19:1.183
	sid-snapshot-20081001:1.183
	reverse-20080930-branch:1.183.0.4
	reverse-20080930-branchpoint:1.183
	binutils-2_19-branch:1.183.0.2
	binutils-2_19-branchpoint:1.183
	sid-snapshot-20080901:1.183
	sid-snapshot-20080801:1.180
	reverse-20080717-branch:1.179.0.4
	reverse-20080717-branchpoint:1.179
	sid-snapshot-20080701:1.179
	msnyder-reverse-20080609-branch:1.179.0.2
	msnyder-reverse-20080609-branchpoint:1.179
	drow-reverse-20070409-branch:1.114.0.2
	drow-reverse-20070409-branchpoint:1.114
	sid-snapshot-20080601:1.179
	sid-snapshot-20080501:1.178
	sid-snapshot-20080403:1.176
	sid-snapshot-20080401:1.175
	gdb_6_8-2008-03-27-release:1.175
	sid-snapshot-20080301:1.175
	gdb_6_8-branch:1.175.0.2
	gdb_6_8-2008-02-26-branchpoint:1.175
	sid-snapshot-20080201:1.173
	sid-snapshot-20080101:1.170
	sid-snapshot-20071201:1.168
	sid-snapshot-20071101:1.168
	gdb_6_7_1-2007-10-29-release:1.141
	gdb_6_7-2007-10-10-release:1.141
	sid-snapshot-20071001:1.152
	gdb_6_7-branch:1.141.0.2
	gdb_6_7-2007-09-07-branchpoint:1.141
	binutils-2_18:1.132
	binutils-2_18-branch:1.132.0.2
	binutils-2_18-branchpoint:1.132
	insight_6_6-20070208-release:1.92
	binutils-csl-coldfire-4_1-32:1.77
	binutils-csl-sourcerygxx-4_1-32:1.77
	gdb_6_6-2006-12-18-release:1.92
	binutils-csl-innovasic-fido-3_4_4-33:1.77
	binutils-csl-sourcerygxx-3_4_4-32:1.55.2.2
	binutils-csl-coldfire-4_1-30:1.77
	binutils-csl-sourcerygxx-4_1-30:1.77
	binutils-csl-coldfire-4_1-28:1.77
	binutils-csl-sourcerygxx-4_1-29:1.77
	binutils-csl-sourcerygxx-4_1-28:1.77
	gdb_6_6-branch:1.92.0.2
	gdb_6_6-2006-11-15-branchpoint:1.92
	binutils-csl-arm-2006q3-27:1.77
	binutils-csl-sourcerygxx-4_1-27:1.77
	binutils-csl-arm-2006q3-26:1.77
	binutils-csl-sourcerygxx-4_1-26:1.77
	binutils-csl-sourcerygxx-4_1-25:1.77
	binutils-csl-sourcerygxx-4_1-24:1.77
	binutils-csl-sourcerygxx-4_1-23:1.77
	insight_6_5-20061003-release:1.78
	gdb-csl-symbian-6_4_50_20060226-12:1.75
	binutils-csl-sourcerygxx-4_1-21:1.77
	binutils-csl-arm-2006q3-21:1.77
	binutils-csl-sourcerygxx-4_1-22:1.77
	binutils-csl-palmsource-arm-prelinker-1_0-1:1.77
	binutils-csl-sourcerygxx-4_1-20:1.77
	binutils-csl-arm-2006q3-19:1.77
	binutils-csl-sourcerygxx-4_1-19:1.77
	binutils-csl-sourcerygxx-4_1-18:1.77
	binutils-csl-renesas-4_1-9:1.77
	gdb-csl-sourcerygxx-3_4_4-25:1.69
	binutils-csl-sourcerygxx-3_4_4-25:1.55.2.2
	nickrob-async-20060828-mergepoint:1.86
	gdb-csl-symbian-6_4_50_20060226-11:1.75
	binutils-csl-renesas-4_1-8:1.77
	binutils-csl-renesas-4_1-7:1.77
	binutils-csl-renesas-4_1-6:1.77
	gdb-csl-sourcerygxx-4_1-17:1.75
	binutils-csl-sourcerygxx-4_1-17:1.77
	gdb-csl-20060226-branch-local-2:1.75
	gdb-csl-sourcerygxx-4_1-14:1.75
	binutils-csl-sourcerygxx-4_1-14:1.77
	binutils-csl-sourcerygxx-4_1-15:1.77
	gdb-csl-sourcerygxx-4_1-13:1.75
	binutils-csl-sourcerygxx-4_1-13:1.77
	binutils-2_17:1.77
	gdb-csl-sourcerygxx-4_1-12:1.75
	binutils-csl-sourcerygxx-4_1-12:1.77
	gdb-csl-sourcerygxx-3_4_4-21:1.75
	binutils-csl-sourcerygxx-3_4_4-21:1.77
	gdb_6_5-20060621-release:1.78
	binutils-csl-wrs-linux-3_4_4-24:1.55
	binutils-csl-wrs-linux-3_4_4-23:1.55
	gdb-csl-sourcerygxx-4_1-9:1.75
	binutils-csl-sourcerygxx-4_1-9:1.77
	gdb-csl-sourcerygxx-4_1-8:1.75
	binutils-csl-sourcerygxx-4_1-8:1.77
	gdb-csl-sourcerygxx-4_1-7:1.75
	binutils-csl-sourcerygxx-4_1-7:1.77
	gdb-csl-arm-2006q1-6:1.75
	binutils-csl-arm-2006q1-6:1.77
	gdb-csl-sourcerygxx-4_1-6:1.75
	binutils-csl-sourcerygxx-4_1-6:1.77
	binutils-csl-wrs-linux-3_4_4-22:1.55
	gdb-csl-symbian-6_4_50_20060226-10:1.75
	gdb-csl-symbian-6_4_50_20060226-9:1.75
	gdb-csl-symbian-6_4_50_20060226-8:1.75
	gdb-csl-coldfire-4_1-11:1.75
	binutils-csl-coldfire-4_1-11:1.77
	gdb-csl-sourcerygxx-3_4_4-19:1.75
	binutils-csl-sourcerygxx-3_4_4-19:1.77
	gdb-csl-coldfire-4_1-10:1.75
	gdb_6_5-branch:1.78.0.4
	gdb_6_5-2006-05-14-branchpoint:1.78
	binutils-csl-coldfire-4_1-10:1.77
	gdb-csl-sourcerygxx-4_1-5:1.75
	binutils-csl-sourcerygxx-4_1-5:1.77
	nickrob-async-20060513-branch:1.78.0.2
	nickrob-async-20060513-branchpoint:1.78
	gdb-csl-sourcerygxx-4_1-4:1.75
	binutils-csl-sourcerygxx-4_1-4:1.77
	msnyder-reverse-20060502-branch:1.77.0.10
	msnyder-reverse-20060502-branchpoint:1.77
	binutils-csl-wrs-linux-3_4_4-21:1.55
	gdb-csl-morpho-4_1-4:1.75
	binutils-csl-morpho-4_1-4:1.77
	gdb-csl-sourcerygxx-3_4_4-17:1.75
	binutils-csl-sourcerygxx-3_4_4-17:1.77
	binutils-csl-wrs-linux-3_4_4-20:1.55
	readline_5_1-import-branch:1.77.0.8
	readline_5_1-import-branchpoint:1.77
	gdb-csl-20060226-branch-merge-to-csl-symbian-1:1.75
	binutils-2_17-branch:1.77.0.6
	binutils-2_17-branchpoint:1.77
	gdb-csl-symbian-20060226-branch:1.75.0.4
	gdb-csl-symbian-20060226-branchpoint:1.75
	gdb-csl-20060226-branch-merge-to-csl-local-1:1.75
	msnyder-reverse-20060331-branch:1.77.0.4
	msnyder-reverse-20060331-branchpoint:1.77
	binutils-csl-2_17-branch:1.77.0.2
	binutils-csl-2_17-branchpoint:1.77
	gdb-csl-available-20060303-branch:1.76.0.2
	gdb-csl-available-20060303-branchpoint:1.76
	gdb-csl-20060226-branch:1.75.0.2
	gdb-csl-20060226-branchpoint:1.75
	gdb_6_4-20051202-release:1.68
	msnyder-fork-checkpoint-branch:1.69.0.4
	msnyder-fork-checkpoint-branchpoint:1.69
	gdb-csl-gxxpro-6_3-branch:1.69.0.2
	gdb-csl-gxxpro-6_3-branchpoint:1.69
	gdb_6_4-branch:1.68.0.4
	gdb_6_4-2005-11-01-branchpoint:1.68
	gdb-csl-arm-20051020-branch:1.68.0.2
	gdb-csl-arm-20051020-branchpoint:1.68
	binutils-csl-gxxpro-3_4-branch:1.55.2.2.0.2
	binutils-csl-gxxpro-3_4-branchpoint:1.55.2.2
	binutils-2_16_1:1.55.2.2
	msnyder-tracepoint-checkpoint-branch:1.63.0.2
	msnyder-tracepoint-checkpoint-branchpoint:1.63
	gdb-csl-arm-20050325-2005-q1b:1.55
	binutils-csl-arm-2005q1b:1.55
	binutils-2_16:1.55.2.2
	gdb-csl-arm-20050325-2005-q1a:1.55
	binutils-csl-arm-2005q1a:1.55
	csl-arm-20050325-branch:1.55.0.6
	csl-arm-20050325-branchpoint:1.55
	binutils-csl-arm-2005q1-branch:1.55.0.4
	binutils-csl-arm-2005q1-branchpoint:1.55
	binutils-2_16-branch:1.55.0.2
	binutils-2_16-branchpoint:1.55
	csl-arm-2004-q3d:1.51
	gdb_6_3-20041109-release:1.50
	gdb_6_3-branch:1.50.0.2
	gdb_6_3-20041019-branchpoint:1.50
	csl-arm-2004-q3:1.50
	drow_intercu-merge-20040921:1.50
	drow_intercu-merge-20040915:1.50
	jimb-gdb_6_2-e500-branch:1.48.0.6
	jimb-gdb_6_2-e500-branchpoint:1.48
	gdb_6_2-20040730-release:1.48
	gdb_6_2-branch:1.48.0.2
	gdb_6_2-2004-07-10-gmt-branchpoint:1.48
	gdb_6_1_1-20040616-release:1.42
	binutils-2_15:1.42.6.2
	binutils-2_15-branchpoint:1.42
	csl-arm-2004-q1a:1.47
	csl-arm-2004-q1:1.47
	gdb_6_1-2004-04-05-release:1.42
	drow_intercu-merge-20040402:1.47
	drow_intercu-merge-20040327:1.47
	ezannoni_pie-20040323-branch:1.47.0.2
	ezannoni_pie-20040323-branchpoint:1.47
	cagney_tramp-20040321-mergepoint:1.47
	cagney_tramp-20040309-branch:1.42.0.12
	cagney_tramp-20040309-branchpoint:1.42
	gdb_6_1-branch:1.42.0.10
	gdb_6_1-2004-03-01-gmt-branchpoint:1.42
	drow_intercu-20040221-branch:1.42.0.8
	drow_intercu-20040221-branchpoint:1.42
	binutils-2_15-branch:1.42.0.6
	cagney_bfdfile-20040213-branch:1.42.0.4
	cagney_bfdfile-20040213-branchpoint:1.42
	drow-cplus-merge-20040208:1.42
	carlton_dictionary-20040126-merge:1.42
	cagney_bigcore-20040122-branch:1.42.0.2
	cagney_bigcore-20040122-branchpoint:1.42
	drow-cplus-merge-20040113:1.41
	csl-arm-2003-q4:1.41
	drow-cplus-merge-20031224:1.41
	drow-cplus-merge-20031220:1.41
	carlton_dictionary-20031215-merge:1.41
	drow-cplus-merge-20031214:1.41
	carlton-dictionary-20031111-merge:1.41
	gdb_6_0-2003-10-04-release:1.39
	kettenis_sparc-20030918-branch:1.41.0.4
	kettenis_sparc-20030918-branchpoint:1.41
	carlton_dictionary-20030917-merge:1.41
	ezannoni_pie-20030916-branchpoint:1.41
	ezannoni_pie-20030916-branch:1.41.0.2
	cagney_x86i386-20030821-branch:1.40.0.2
	cagney_x86i386-20030821-branchpoint:1.40
	carlton_dictionary-20030805-merge:1.40
	carlton_dictionary-20030627-merge:1.40
	gdb_6_0-branch:1.39.0.14
	gdb_6_0-2003-06-23-branchpoint:1.39
	jimb-ppc64-linux-20030613-branch:1.39.0.12
	jimb-ppc64-linux-20030613-branchpoint:1.39
	binutils-2_14:1.38.10.1
	cagney_convert-20030606-branch:1.39.0.10
	cagney_convert-20030606-branchpoint:1.39
	cagney_writestrings-20030508-branch:1.39.0.8
	cagney_writestrings-20030508-branchpoint:1.39
	jimb-ppc64-linux-20030528-branch:1.39.0.6
	jimb-ppc64-linux-20030528-branchpoint:1.39
	carlton_dictionary-20030523-merge:1.39
	cagney_fileio-20030521-branch:1.39.0.4
	cagney_fileio-20030521-branchpoint:1.39
	kettenis_i386newframe-20030517-mergepoint:1.39
	jimb-ppc64-linux-20030509-branch:1.39.0.2
	jimb-ppc64-linux-20030509-branchpoint:1.39
	kettenis_i386newframe-20030504-mergepoint:1.38
	carlton_dictionary-20030430-merge:1.38
	binutils-2_14-branch:1.38.0.10
	binutils-2_14-branchpoint:1.38
	kettenis_i386newframe-20030419-branch:1.38.0.8
	kettenis_i386newframe-20030419-branchpoint:1.38
	carlton_dictionary-20030416-merge:1.38
	cagney_frameaddr-20030409-mergepoint:1.38
	kettenis_i386newframe-20030406-branch:1.38.0.6
	kettenis_i386newframe-20030406-branchpoint:1.38
	cagney_frameaddr-20030403-branchpoint:1.38
	cagney_frameaddr-20030403-branch:1.38.0.4
	cagney_framebase-20030330-mergepoint:1.38
	cagney_framebase-20030326-branch:1.38.0.2
	cagney_framebase-20030326-branchpoint:1.38
	cagney_lazyid-20030317-branch:1.37.0.8
	cagney_lazyid-20030317-branchpoint:1.37
	kettenis-i386newframe-20030316-mergepoint:1.37
	offbyone-20030313-branch:1.37.0.6
	offbyone-20030313-branchpoint:1.37
	kettenis-i386newframe-20030308-branch:1.37.0.4
	kettenis-i386newframe-20030308-branchpoint:1.37
	carlton_dictionary-20030305-merge:1.37
	cagney_offbyone-20030303-branch:1.37.0.2
	cagney_offbyone-20030303-branchpoint:1.37
	carlton_dictionary-20030207-merge:1.37
	interps-20030202-branch:1.36.0.4
	interps-20030202-branchpoint:1.36
	cagney-unwind-20030108-branch:1.36.0.2
	cagney-unwind-20030108-branchpoint:1.36
	binutils-2_13_2_1:1.35
	binutils-2_13_2:1.35
	carlton_dictionary-20021223-merge:1.36
	gdb_5_3-2002-12-12-release:1.35
	carlton_dictionary-20021115-merge:1.35
	binutils-2_13_1:1.35
	kseitz_interps-20021105-merge:1.35
	kseitz_interps-20021103-merge:1.35
	drow-cplus-merge-20021020:1.35
	drow-cplus-merge-20021025:1.35
	carlton_dictionary-20021025-merge:1.35
	carlton_dictionary-20021011-merge:1.35
	drow-cplus-branch:1.35.0.20
	drow-cplus-branchpoint:1.35
	kseitz_interps-20020930-merge:1.35
	carlton_dictionary-20020927-merge:1.35
	carlton_dictionary-branch:1.35.0.18
	carlton_dictionary-20020920-branchpoint:1.35
	sid-20020905-branchpoint:1.35
	sid-20020905-branch:1.35.0.16
	gdb_5_3-branch:1.35.0.14
	gdb_5_3-2002-09-04-branchpoint:1.35
	kseitz_interps-20020829-merge:1.35
	cagney_sysregs-20020825-branch:1.35.0.12
	cagney_sysregs-20020825-branchpoint:1.35
	readline_4_3-import-branch:1.35.0.10
	readline_4_3-import-branchpoint:1.35
	binutils-2_13:1.35
	gdb_5_2_1-2002-07-23-release:1.34
	binutils-2_13-branchpoint:1.35
	binutils-2_13-branch:1.35.0.8
	kseitz_interps-20020528-branch:1.35.0.6
	kseitz_interps-20020528-branchpoint:1.35
	cagney_regbuf-20020515-branch:1.35.0.4
	cagney_regbuf-20020515-branchpoint:1.35
	binutils-2_12_1:1.34.2.1
	jimb-macro-020506-branch:1.35.0.2
	jimb-macro-020506-branchpoint:1.35
	gdb_5_2-2002-04-29-release:1.34
	binutils-2_12:1.34.2.1
	gdb_5_2-branch:1.34.0.4
	gdb_5_2-2002-03-03-branchpoint:1.34
	binutils-2_12-branch:1.34.0.2
	binutils-2_12-branchpoint:1.34
	gdb_5_1_1-2002-01-24-release:1.29
	gdb_5_1_0_1-2002-01-03-release:1.29
	cygnus_cvs_20020108_pre:1.34
	gdb_5_1_0_1-2002-01-03-branch:1.29.0.6
	gdb_5_1_0_1-2002-01-03-branchpoint:1.29
	gdb_5_1-2001-11-21-release:1.29
	gdb_s390-2001-09-26-branch:1.29.0.4
	gdb_s390-2001-09-26-branchpoint:1.29
	gdb_5_1-2001-07-29-branch:1.29.0.2
	gdb_5_1-2001-07-29-branchpoint:1.29
	binutils-2_11_2:1.13.2.8
	binutils-2_11_1:1.13.2.8
	binutils-2_11:1.13.2.4
	x86_64versiong3:1.15
	binutils-2_11-branch:1.13.0.2
	insight-precleanup-2001-01-01:1.10
	binutils-2_10_1:1.10
	binutils-2_10:1.10
	gdb-premipsmulti-2000-06-06-branch:1.10.0.6
	gdb-premipsmulti-2000-06-06-branchpoint:1.10
	gdb_5_0-2000-05-19-release:1.10
	gdb_4_18_2-2000-05-18-release:1.10
	gdb_4_95_1-2000-05-11-snapshot:1.10
	gdb_4_95_0-2000-04-27-snapshot:1.10
	gdb_5_0-2000-04-10-branch:1.10.0.4
	gdb_5_0-2000-04-10-branchpoint:1.10
	binutils-2_10-branch:1.10.0.2
	binutils-2_10-branchpoint:1.10
	binutils_latest_snapshot:1.282
	repo-unification-2000-02-06:1.10
	binu_ss_19990721:1.7
	binu_ss_19990602:1.3
	binu_ss_19990502:1.1.1.1
	cygnus:1.1.1;
locks; strict;
comment	@ * @;


1.282
date	2013.10.12.15.57.07;	author hjl;	state Exp;
branches;
next	1.281;

1.281
date	2013.10.11.00.58.29;	author roland;	state Exp;
branches;
next	1.280;

1.280
date	2013.08.19.15.58.52;	author hjl;	state Exp;
branches
	1.280.2.1;
next	1.279;

1.279
date	2013.07.26.17.20.24;	author hjl;	state Exp;
branches;
next	1.278;

1.278
date	2013.07.25.16.16.35;	author hjl;	state Exp;
branches;
next	1.277;

1.277
date	2013.07.24.15.47.25;	author hjl;	state Exp;
branches;
next	1.276;

1.276
date	2013.03.27.18.49.10;	author hjl;	state Exp;
branches;
next	1.275;

1.275
date	2013.02.19.19.10.30;	author hjl;	state Exp;
branches;
next	1.274;

1.274
date	2012.10.24.21.41.33;	author roland;	state Exp;
branches;
next	1.273;

1.273
date	2012.08.07.18.22.04;	author roland;	state Exp;
branches;
next	1.272;

1.272
date	2012.08.06.22.08.25;	author roland;	state Exp;
branches;
next	1.271;

1.271
date	2012.08.06.20.19.34;	author roland;	state Exp;
branches;
next	1.270;

1.270
date	2012.07.19.13.41.03;	author hjl;	state Exp;
branches;
next	1.269;

1.269
date	2012.07.16.12.58.29;	author hjl;	state Exp;
branches;
next	1.268;

1.268
date	2012.02.08.18.20.40;	author hjl;	state Exp;
branches;
next	1.267;

1.267
date	2012.01.13.22.19.27;	author hjl;	state Exp;
branches;
next	1.266;

1.266
date	2011.10.26.14.46.00;	author nickc;	state Exp;
branches;
next	1.265;

1.265
date	2011.08.02.19.58.06;	author qneill;	state Exp;
branches;
next	1.264;

1.264
date	2011.08.01.23.04.23;	author hjl;	state Exp;
branches;
next	1.263;

1.263
date	2011.07.22.20.22.38;	author hjl;	state Exp;
branches;
next	1.262;

1.262
date	2011.07.01.01.34.35;	author hjl;	state Exp;
branches;
next	1.261;

1.261
date	2011.06.30.15.44.54;	author hjl;	state Exp;
branches;
next	1.260;

1.260
date	2011.06.21.17.56.46;	author hjl;	state Exp;
branches;
next	1.259;

1.259
date	2011.06.10.21.27.39;	author hjl;	state Exp;
branches;
next	1.258;

1.258
date	2011.02.09.18.43.41;	author msnyder;	state Exp;
branches;
next	1.257;

1.257
date	2011.01.18.17.08.13;	author hjl;	state Exp;
branches;
next	1.256;

1.256
date	2011.01.17.18.40.35;	author qneill;	state Exp;
branches;
next	1.255;

1.255
date	2011.01.05.00.16.54;	author hjl;	state Exp;
branches;
next	1.254;

1.254
date	2011.01.04.20.53.32;	author hjl;	state Exp;
branches;
next	1.253;

1.253
date	2010.12.31.00.33.36;	author hjl;	state Exp;
branches;
next	1.252;

1.252
date	2010.10.02.07.04.07;	author hjl;	state Exp;
branches;
next	1.251;

1.251
date	2010.08.31.21.56.57;	author hjl;	state Exp;
branches;
next	1.250;

1.250
date	2010.08.17.20.37.26;	author hjl;	state Exp;
branches;
next	1.249;

1.249
date	2010.08.06.00.52.56;	author hjl;	state Exp;
branches;
next	1.248;

1.248
date	2010.07.28.21.54.34;	author hjl;	state Exp;
branches;
next	1.247;

1.247
date	2010.07.05.17.14.20;	author hjl;	state Exp;
branches;
next	1.246;

1.246
date	2010.07.01.21.55.01;	author hjl;	state Exp;
branches;
next	1.245;

1.245
date	2010.05.26.16.08.23;	author hjl;	state Exp;
branches;
next	1.244;

1.244
date	2010.04.16.21.37.08;	author hjl;	state Exp;
branches;
next	1.243;

1.243
date	2010.04.16.21.35.24;	author hjl;	state Exp;
branches;
next	1.242;

1.242
date	2010.04.09.14.40.18;	author nickc;	state Exp;
branches;
next	1.241;

1.241
date	2010.03.23.02.56.24;	author spop;	state Exp;
branches;
next	1.240;

1.240
date	2010.02.11.13.41.19;	author hjl;	state Exp;
branches;
next	1.239;

1.239
date	2010.02.11.05.06.14;	author spop;	state Exp;
branches;
next	1.238;

1.238
date	2010.01.28.15.33.23;	author hjl;	state Exp;
branches;
next	1.237;

1.237
date	2010.01.27.14.34.40;	author hjl;	state Exp;
branches;
next	1.236;

1.236
date	2010.01.24.23.22.43;	author hjl;	state Exp;
branches;
next	1.235;

1.235
date	2010.01.24.21.35.13;	author hjl;	state Exp;
branches;
next	1.234;

1.234
date	2010.01.24.20.39.40;	author hjl;	state Exp;
branches;
next	1.233;

1.233
date	2010.01.24.18.24.23;	author hjl;	state Exp;
branches;
next	1.232;

1.232
date	2010.01.21.17.30.12;	author hjl;	state Exp;
branches;
next	1.231;

1.231
date	2010.01.14.17.29.18;	author hjl;	state Exp;
branches;
next	1.230;

1.230
date	2010.01.13.16.06.12;	author hjl;	state Exp;
branches;
next	1.229;

1.229
date	2010.01.13.04.03.20;	author hjl;	state Exp;
branches;
next	1.228;

1.228
date	2009.12.15.23.33.51;	author hjl;	state Exp;
branches;
next	1.227;

1.227
date	2009.12.15.22.20.50;	author hjl;	state Exp;
branches;
next	1.226;

1.226
date	2009.12.15.22.13.05;	author hjl;	state Exp;
branches;
next	1.225;

1.225
date	2009.12.15.21.37.51;	author hjl;	state Exp;
branches;
next	1.224;

1.224
date	2009.12.15.18.56.09;	author hjl;	state Exp;
branches;
next	1.223;

1.223
date	2009.12.15.01.42.57;	author hjl;	state Exp;
branches;
next	1.222;

1.222
date	2009.12.14.20.22.16;	author hjl;	state Exp;
branches;
next	1.221;

1.221
date	2009.12.12.01.17.41;	author hjl;	state Exp;
branches;
next	1.220;

1.220
date	2009.12.12.00.13.11;	author hjl;	state Exp;
branches;
next	1.219;

1.219
date	2009.12.11.20.38.51;	author spop;	state Exp;
branches;
next	1.218;

1.218
date	2009.12.11.13.42.16;	author nickc;	state Exp;
branches;
next	1.217;

1.217
date	2009.12.04.07.51.41;	author hjl;	state Exp;
branches;
next	1.216;

1.216
date	2009.11.25.15.15.30;	author spop;	state Exp;
branches;
next	1.215;

1.215
date	2009.11.19.07.08.39;	author spop;	state Exp;
branches;
next	1.214;

1.214
date	2009.11.18.20.28.59;	author spop;	state Exp;
branches;
next	1.213;

1.213
date	2009.11.18.04.04.17;	author spop;	state Exp;
branches;
next	1.212;

1.212
date	2009.11.14.07.22.05;	author hjl;	state Exp;
branches;
next	1.211;

1.211
date	2009.11.13.23.13.48;	author hjl;	state Exp;
branches;
next	1.210;

1.210
date	2009.11.13.20.42.08;	author hjl;	state Exp;
branches;
next	1.209;

1.209
date	2009.11.12.02.13.06;	author hjl;	state Exp;
branches;
next	1.208;

1.208
date	2009.11.06.23.17.26;	author spop;	state Exp;
branches;
next	1.207;

1.207
date	2009.11.05.23.40.05;	author spop;	state Exp;
branches;
next	1.206;

1.206
date	2009.10.29.22.22.59;	author hjl;	state Exp;
branches;
next	1.205;

1.205
date	2009.10.20.22.18.19;	author hjl;	state Exp;
branches;
next	1.204;

1.204
date	2009.10.16.14.47.08;	author hjl;	state Exp;
branches;
next	1.203;

1.203
date	2009.10.15.22.50.09;	author hjl;	state Exp;
branches;
next	1.202;

1.202
date	2009.10.15.22.26.55;	author hjl;	state Exp;
branches;
next	1.201;

1.201
date	2009.10.13.18.44.19;	author hjl;	state Exp;
branches;
next	1.200;

1.200
date	2009.09.15.17.53.40;	author hjl;	state Exp;
branches;
next	1.199;

1.199
date	2009.09.09.17.25.31;	author hjl;	state Exp;
branches;
next	1.198;

1.198
date	2009.08.29.22.11.01;	author nickc;	state Exp;
branches;
next	1.197;

1.197
date	2009.07.25.14.58.58;	author hjl;	state Exp;
branches;
next	1.196;

1.196
date	2009.07.24.15.41.20;	author jbeulich;	state Exp;
branches;
next	1.195;

1.195
date	2009.07.06.19.34.30;	author dwarak;	state Exp;
branches;
next	1.194;

1.194
date	2009.05.22.15.57.24;	author dwarak;	state Exp;
branches;
next	1.193;

1.193
date	2009.03.27.00.28.32;	author hjl;	state Exp;
branches;
next	1.192;

1.192
date	2009.02.27.20.13.04;	author hjl;	state Exp;
branches;
next	1.191;

1.191
date	2009.02.04.16.03.31;	author hjl;	state Exp;
branches;
next	1.190;

1.190
date	2009.01.12.16.04.11;	author hjl;	state Exp;
branches;
next	1.189;

1.189
date	2009.01.06.17.15.28;	author hjl;	state Exp;
branches;
next	1.188;

1.188
date	2009.01.06.01.03.26;	author hjl;	state Exp;
branches;
next	1.187;

1.187
date	2008.12.23.15.14.15;	author hjl;	state Exp;
branches;
next	1.186;

1.186
date	2008.12.20.17.40.51;	author hjl;	state Exp;
branches;
next	1.185;

1.185
date	2008.12.18.22.47.32;	author hjl;	state Exp;
branches;
next	1.184;

1.184
date	2008.12.08.17.43.06;	author hjl;	state Exp;
branches;
next	1.183;

1.183
date	2008.08.28.15.59.32;	author jbeulich;	state Exp;
branches;
next	1.182;

1.182
date	2008.08.28.15.30.30;	author jbeulich;	state Exp;
branches;
next	1.181;

1.181
date	2008.08.20.18.38.39;	author hjl;	state Exp;
branches;
next	1.180;

1.180
date	2008.07.30.04.34.58;	author amodra;	state Exp;
branches;
next	1.179;

1.179
date	2008.05.02.16.53.40;	author hjl;	state Exp;
branches;
next	1.178;

1.178
date	2008.04.18.13.10.32;	author hjl;	state Exp;
branches;
next	1.177;

1.177
date	2008.04.07.21.29.50;	author hjl;	state Exp;
branches;
next	1.176;

1.176
date	2008.04.03.14.03.20;	author hjl;	state Exp;
branches;
next	1.175;

1.175
date	2008.02.13.13.29.31;	author jbeulich;	state Exp;
branches;
next	1.174;

1.174
date	2008.02.12.00.04.45;	author hjl;	state Exp;
branches;
next	1.173;

1.173
date	2008.01.24.15.11.35;	author hjl;	state Exp;
branches;
next	1.172;

1.172
date	2008.01.15.17.20.50;	author hjl;	state Exp;
branches;
next	1.171;

1.171
date	2008.01.10.14.52.35;	author hjl;	state Exp;
branches;
next	1.170;

1.170
date	2007.12.31.15.42.21;	author hjl;	state Exp;
branches;
next	1.169;

1.169
date	2007.12.22.14.06.31;	author hjl;	state Exp;
branches;
next	1.168;

1.168
date	2007.10.31.23.41.12;	author hjl;	state Exp;
branches;
next	1.167;

1.167
date	2007.10.26.20.48.09;	author hjl;	state Exp;
branches;
next	1.166;

1.166
date	2007.10.23.22.52.09;	author hjl;	state Exp;
branches;
next	1.165;

1.165
date	2007.10.22.19.22.01;	author hjl;	state Exp;
branches;
next	1.164;

1.164
date	2007.10.19.23.24.00;	author hjl;	state Exp;
branches;
next	1.163;

1.163
date	2007.10.15.19.13.55;	author hjl;	state Exp;
branches;
next	1.162;

1.162
date	2007.10.12.20.37.58;	author hjl;	state Exp;
branches;
next	1.161;

1.161
date	2007.10.10.22.00.24;	author hjl;	state Exp;
branches;
next	1.160;

1.160
date	2007.10.10.16.25.02;	author hjl;	state Exp;
branches;
next	1.159;

1.159
date	2007.10.08.19.22.01;	author hjl;	state Exp;
branches;
next	1.158;

1.158
date	2007.10.05.19.04.06;	author hjl;	state Exp;
branches;
next	1.157;

1.157
date	2007.10.05.16.28.16;	author hjl;	state Exp;
branches;
next	1.156;

1.156
date	2007.10.04.22.02.10;	author hjl;	state Exp;
branches;
next	1.155;

1.155
date	2007.10.04.21.02.38;	author hjl;	state Exp;
branches;
next	1.154;

1.154
date	2007.10.03.19.30.44;	author hjl;	state Exp;
branches;
next	1.153;

1.153
date	2007.10.01.22.23.20;	author hjl;	state Exp;
branches;
next	1.152;

1.152
date	2007.09.30.19.14.47;	author hjl;	state Exp;
branches;
next	1.151;

1.151
date	2007.09.29.14.43.44;	author hjl;	state Exp;
branches;
next	1.150;

1.150
date	2007.09.28.20.50.59;	author hjl;	state Exp;
branches;
next	1.149;

1.149
date	2007.09.27.21.53.28;	author hjl;	state Exp;
branches;
next	1.148;

1.148
date	2007.09.27.18.31.51;	author hjl;	state Exp;
branches;
next	1.147;

1.147
date	2007.09.26.13.42.14;	author jbeulich;	state Exp;
branches;
next	1.146;

1.146
date	2007.09.20.20.13.26;	author hjl;	state Exp;
branches;
next	1.145;

1.145
date	2007.09.20.17.38.37;	author hjl;	state Exp;
branches;
next	1.144;

1.144
date	2007.09.19.17.52.21;	author hjl;	state Exp;
branches;
next	1.143;

1.143
date	2007.09.14.18.21.08;	author meissner;	state Exp;
branches;
next	1.142;

1.142
date	2007.09.14.00.20.03;	author hjl;	state Exp;
branches;
next	1.141;

1.141
date	2007.08.31.20.55.13;	author hjl;	state Exp;
branches;
next	1.140;

1.140
date	2007.08.31.18.48.28;	author hjl;	state Exp;
branches;
next	1.139;

1.139
date	2007.08.31.14.55.10;	author hjl;	state Exp;
branches;
next	1.138;

1.138
date	2007.08.30.15.13.45;	author hjl;	state Exp;
branches;
next	1.137;

1.137
date	2007.08.30.05.01.32;	author hjl;	state Exp;
branches;
next	1.136;

1.136
date	2007.08.29.21.25.02;	author hjl;	state Exp;
branches;
next	1.135;

1.135
date	2007.08.29.17.12.47;	author hjl;	state Exp;
branches;
next	1.134;

1.134
date	2007.08.29.15.34.42;	author hjl;	state Exp;
branches;
next	1.133;

1.133
date	2007.08.28.17.36.32;	author hjl;	state Exp;
branches;
next	1.132;

1.132
date	2007.08.02.00.40.02;	author msnyder;	state Exp;
branches;
next	1.131;

1.131
date	2007.07.29.19.43.36;	author hjl;	state Exp;
branches;
next	1.130;

1.130
date	2007.07.28.23.34.13;	author hjl;	state Exp;
branches;
next	1.129;

1.129
date	2007.07.28.16.32.01;	author hjl;	state Exp;
branches;
next	1.128;

1.128
date	2007.07.16.19.16.44;	author hjl;	state Exp;
branches;
next	1.127;

1.127
date	2007.07.05.09.49.00;	author nickc;	state Exp;
branches;
next	1.126;

1.126
date	2007.06.23.14.55.18;	author hjl;	state Exp;
branches;
next	1.125;

1.125
date	2007.05.15.01.05.59;	author hjl;	state Exp;
branches;
next	1.124;

1.124
date	2007.05.07.19.01.00;	author hjl;	state Exp;
branches;
next	1.123;

1.123
date	2007.05.03.21.07.16;	author hjl;	state Exp;
branches;
next	1.122;

1.122
date	2007.05.01.12.59.24;	author hjl;	state Exp;
branches;
next	1.121;

1.121
date	2007.04.27.19.47.30;	author hjl;	state Exp;
branches;
next	1.120;

1.120
date	2007.04.27.04.22.02;	author hjl;	state Exp;
branches;
next	1.119;

1.119
date	2007.04.26.18.15.47;	author hjl;	state Exp;
branches;
next	1.118;

1.118
date	2007.04.18.16.15.55;	author hjl;	state Exp;
branches;
next	1.117;

1.117
date	2007.04.18.16.13.15;	author hjl;	state Exp;
branches;
next	1.116;

1.116
date	2007.04.13.21.57.21;	author hjl;	state Exp;
branches;
next	1.115;

1.115
date	2007.04.11.21.56.25;	author hjl;	state Exp;
branches;
next	1.114;

1.114
date	2007.03.23.16.17.20;	author hjl;	state Exp;
branches;
next	1.113;

1.113
date	2007.03.21.21.23.44;	author hjl;	state Exp;
branches;
next	1.112;

1.112
date	2007.03.21.20.45.14;	author hjl;	state Exp;
branches;
next	1.111;

1.111
date	2007.03.15.14.31.24;	author hjl;	state Exp;
branches;
next	1.110;

1.110
date	2007.03.09.23.22.31;	author hjl;	state Exp;
branches;
next	1.109;

1.109
date	2007.02.13.21.45.27;	author hjl;	state Exp;
branches;
next	1.108;

1.108
date	2007.02.13.21.29.31;	author hjl;	state Exp;
branches;
next	1.107;

1.107
date	2007.02.13.21.18.39;	author hjl;	state Exp;
branches;
next	1.106;

1.106
date	2007.02.13.20.58.17;	author hjl;	state Exp;
branches;
next	1.105;

1.105
date	2007.02.05.18.22.48;	author hjl;	state Exp;
branches;
next	1.104;

1.104
date	2007.02.03.00.55.42;	author hjl;	state Exp;
branches;
next	1.103;

1.103
date	2007.02.03.00.46.22;	author hjl;	state Exp;
branches;
next	1.102;

1.102
date	2007.02.02.15.27.04;	author hjl;	state Exp;
branches;
next	1.101;

1.101
date	2006.12.15.13.11.56;	author hjl;	state Exp;
branches;
next	1.100;

1.100
date	2006.12.14.20.13.27;	author hjl;	state Exp;
branches;
next	1.99;

1.99
date	2006.12.11.18.11.13;	author hjl;	state Exp;
branches;
next	1.98;

1.98
date	2006.12.10.02.50.53;	author hjl;	state Exp;
branches;
next	1.97;

1.97
date	2006.12.09.21.06.13;	author hjl;	state Exp;
branches;
next	1.96;

1.96
date	2006.12.04.08.53.29;	author jbeulich;	state Exp;
branches;
next	1.95;

1.95
date	2006.12.01.15.17.32;	author jbeulich;	state Exp;
branches;
next	1.94;

1.94
date	2006.12.01.15.00.12;	author jbeulich;	state Exp;
branches;
next	1.93;

1.93
date	2006.12.01.14.56.11;	author jbeulich;	state Exp;
branches;
next	1.92;

1.92
date	2006.11.10.03.54.11;	author hjl;	state Exp;
branches;
next	1.91;

1.91
date	2006.11.10.02.13.40;	author hjl;	state Exp;
branches;
next	1.90;

1.90
date	2006.10.23.22.53.29;	author meissner;	state Exp;
branches;
next	1.89;

1.89
date	2006.09.24.17.25.47;	author hjl;	state Exp;
branches;
next	1.88;

1.88
date	2006.09.23.23.10.13;	author hjl;	state Exp;
branches;
next	1.87;

1.87
date	2006.09.16.18.12.17;	author nickc;	state Exp;
branches;
next	1.86;

1.86
date	2006.08.23.14.48.49;	author hjl;	state Exp;
branches;
next	1.85;

1.85
date	2006.08.14.23.45.59;	author meissner;	state Exp;
branches;
next	1.84;

1.84
date	2006.07.18.20.25.41;	author hjl;	state Exp;
branches;
next	1.83;

1.83
date	2006.07.15.16.33.24;	author hjl;	state Exp;
branches;
next	1.82;

1.82
date	2006.07.13.22.25.48;	author meissner;	state Exp;
branches;
next	1.81;

1.81
date	2006.06.12.18.59.37;	author hjl;	state Exp;
branches;
next	1.80;

1.80
date	2006.06.12.18.55.44;	author hjl;	state Exp;
branches;
next	1.79;

1.79
date	2006.06.10.18.20.39;	author hjl;	state Exp;
branches;
next	1.78;

1.78
date	2006.05.09.16.05.40;	author hjl;	state Exp;
branches;
next	1.77;

1.77
date	2006.03.07.20.18.06;	author hjl;	state Exp;
branches;
next	1.76;

1.76
date	2006.02.27.15.35.37;	author hjl;	state Exp;
branches;
next	1.75;

1.75
date	2006.02.11.18.08.34;	author hjl;	state Exp;
branches;
next	1.74;

1.74
date	2006.02.11.17.00.59;	author hjl;	state Exp;
branches;
next	1.73;

1.73
date	2005.12.08.15.21.05;	author jbeulich;	state Exp;
branches;
next	1.72;

1.72
date	2005.12.08.11.28.11;	author jbeulich;	state Exp;
branches;
next	1.71;

1.71
date	2005.12.08.09.59.40;	author amodra;	state Exp;
branches;
next	1.70;

1.70
date	2005.12.06.12.40.57;	author hjl;	state Exp;
branches;
next	1.69;

1.69
date	2005.11.07.00.19.12;	author amodra;	state Exp;
branches;
next	1.68;

1.68
date	2005.09.28.15.34.53;	author jbeulich;	state Exp;
branches;
next	1.67;

1.67
date	2005.08.26.15.33.43;	author jbeulich;	state Exp;
branches;
next	1.66;

1.66
date	2005.07.19.04.11.18;	author hjl;	state Exp;
branches;
next	1.65;

1.65
date	2005.07.15.13.49.53;	author hjl;	state Exp;
branches;
next	1.64;

1.64
date	2005.07.05.07.16.54;	author jbeulich;	state Exp;
branches;
next	1.63;

1.63
date	2005.05.25.06.50.23;	author jbeulich;	state Exp;
branches;
next	1.62;

1.62
date	2005.05.25.06.47.58;	author jbeulich;	state Exp;
branches;
next	1.61;

1.61
date	2005.05.07.13.29.59;	author hjl;	state Exp;
branches;
next	1.60;

1.60
date	2005.05.07.07.34.28;	author nickc;	state Exp;
branches;
next	1.59;

1.59
date	2005.04.18.20.59.20;	author kettenis;	state Exp;
branches;
next	1.58;

1.58
date	2005.04.01.16.06.40;	author jbeulich;	state Exp;
branches;
next	1.57;

1.57
date	2005.04.01.16.03.40;	author jbeulich;	state Exp;
branches;
next	1.56;

1.56
date	2005.03.29.19.30.44;	author hjl;	state Exp;
branches;
next	1.55;

1.55
date	2005.03.03.11.49.48;	author amodra;	state Exp;
branches
	1.55.2.1;
next	1.54;

1.54
date	2005.03.02.08.01.32;	author jbeulich;	state Exp;
branches;
next	1.53;

1.53
date	2005.01.12.19.40.20;	author hjl;	state Exp;
branches;
next	1.52;

1.52
date	2005.01.12.19.12.52;	author hjl;	state Exp;
branches;
next	1.51;

1.51
date	2004.11.04.09.16.09;	author jbeulich;	state Exp;
branches;
next	1.50;

1.50
date	2004.07.30.12.36.38;	author mludvig;	state Exp;
branches;
next	1.49;

1.49
date	2004.07.21.16.09.43;	author nickc;	state Exp;
branches;
next	1.48;

1.48
date	2004.06.23.15.06.56;	author amodra;	state Exp;
branches;
next	1.47;

1.47
date	2004.03.12.13.38.16;	author mludvig;	state Exp;
branches;
next	1.46;

1.46
date	2004.03.12.13.06.48;	author amodra;	state Exp;
branches;
next	1.45;

1.45
date	2004.03.12.10.47.48;	author jakub;	state Exp;
branches;
next	1.44;

1.44
date	2004.03.12.10.14.29;	author mludvig;	state Exp;
branches;
next	1.43;

1.43
date	2004.03.12.07.01.36;	author amodra;	state Exp;
branches;
next	1.42;

1.42
date	2004.01.18.23.12.47;	author amodra;	state Exp;
branches
	1.42.6.1
	1.42.8.1
	1.42.12.1;
next	1.41;

1.41
date	2003.09.14.15.16.57;	author aj;	state Exp;
branches;
next	1.40;

1.40
date	2003.06.23.20.15.34;	author hjl;	state Exp;
branches;
next	1.39;

1.39
date	2003.05.09.11.36.43;	author amodra;	state Exp;
branches;
next	1.38;

1.38
date	2003.03.22.18.56.45;	author devans;	state Exp;
branches
	1.38.8.1
	1.38.10.1;
next	1.37;

1.37
date	2003.02.06.01.48.41;	author amodra;	state Exp;
branches;
next	1.36;

1.36
date	2002.11.18.16.50.03;	author kdienes;	state Exp;
branches;
next	1.35;

1.35
date	2002.03.18.20.11.49;	author hubicka;	state Exp;
branches
	1.35.18.1
	1.35.20.1;
next	1.34;

1.34
date	2001.11.14.12.01.12;	author aj;	state Exp;
branches
	1.34.2.1;
next	1.33;

1.33
date	2001.11.14.03.15.28;	author amodra;	state Exp;
branches;
next	1.32;

1.32
date	2001.11.13.01.03.55;	author amodra;	state Exp;
branches;
next	1.31;

1.31
date	2001.09.04.01.58.07;	author amodra;	state Exp;
branches;
next	1.30;

1.30
date	2001.07.29.05.00.14;	author kazu;	state Exp;
branches;
next	1.29;

1.29
date	2001.07.28.07.13.34;	author amodra;	state Exp;
branches;
next	1.28;

1.28
date	2001.07.18.13.33.12;	author amodra;	state Exp;
branches;
next	1.27;

1.27
date	2001.07.09.14.22.11;	author aj;	state Exp;
branches;
next	1.26;

1.26
date	2001.06.11.13.25.07;	author amodra;	state Exp;
branches;
next	1.25;

1.25
date	2001.06.10.14.07.12;	author amodra;	state Exp;
branches;
next	1.24;

1.24
date	2001.06.06.10.24.18;	author amodra;	state Exp;
branches;
next	1.23;

1.23
date	2001.05.12.15.19.22;	author hjl;	state Exp;
branches;
next	1.22;

1.22
date	2001.05.12.12.07.08;	author amodra;	state Exp;
branches;
next	1.21;

1.21
date	2001.05.12.09.52.37;	author amodra;	state Exp;
branches;
next	1.20;

1.20
date	2001.05.04.11.10.54;	author amodra;	state Exp;
branches;
next	1.19;

1.19
date	2001.04.06.09.27.33;	author aj;	state Exp;
branches;
next	1.18;

1.18
date	2001.03.24.06.29.16;	author amodra;	state Exp;
branches;
next	1.17;

1.17
date	2001.03.22.02.27.54;	author amodra;	state Exp;
branches;
next	1.16;

1.16
date	2001.03.13.22.58.35;	author nickc;	state Exp;
branches;
next	1.15;

1.15
date	2001.02.12.16.42.49;	author hubicka;	state Exp;
branches;
next	1.14;

1.14
date	2001.02.01.15.30.55;	author hubicka;	state Exp;
branches;
next	1.13;

1.13
date	2001.01.13.09.05.55;	author hubicka;	state Exp;
branches
	1.13.2.1;
next	1.12;

1.12
date	2001.01.10.14.14.25;	author hubicka;	state Exp;
branches;
next	1.11;

1.11
date	2001.01.05.11.11.54;	author hubicka;	state Exp;
branches;
next	1.10;

1.10
date	99.12.27.16.10.31;	author amodra;	state Exp;
branches;
next	1.9;

1.9
date	99.09.04.15.49.35;	author ian;	state Exp;
branches;
next	1.8;

1.8
date	99.08.21.12.40.39;	author amodra;	state Exp;
branches;
next	1.7;

1.7
date	99.07.11.20.04.26;	author ian;	state Exp;
branches;
next	1.6;

1.6
date	99.06.23.06.00.14;	author amodra;	state Exp;
branches;
next	1.5;

1.5
date	99.06.13.17.04.42;	author ian;	state Exp;
branches;
next	1.4;

1.4
date	99.06.13.13.56.26;	author ian;	state Exp;
branches;
next	1.3;

1.3
date	99.05.17.08.35.42;	author amodra;	state Exp;
branches;
next	1.2;

1.2
date	99.05.13.06.00.30;	author amodra;	state Exp;
branches;
next	1.1;

1.1
date	99.05.03.07.28.59;	author rth;	state Exp;
branches
	1.1.1.1;
next	;

1.280.2.1
date	2013.10.11.01.00.54;	author roland;	state Exp;
branches;
next	1.280.2.2;

1.280.2.2
date	2013.10.12.17.11.40;	author hjl;	state Exp;
branches;
next	;

1.55.2.1
date	2005.04.11.12.58.16;	author jbeulich;	state Exp;
branches;
next	1.55.2.2;

1.55.2.2
date	2005.04.11.13.06.48;	author jbeulich;	state Exp;
branches;
next	;

1.42.6.1
date	2004.03.12.10.41.21;	author mludvig;	state Exp;
branches;
next	1.42.6.2;

1.42.6.2
date	2004.03.13.12.26.46;	author amodra;	state Exp;
branches;
next	1.42.6.3;

1.42.6.3
date	2004.07.30.13.35.50;	author mludvig;	state Exp;
branches;
next	;

1.42.8.1
date	2004.03.27.17.38.12;	author drow;	state Exp;
branches;
next	1.42.8.2;

1.42.8.2
date	2004.09.16.17.01.58;	author drow;	state Exp;
branches;
next	;

1.42.12.1
date	2004.03.21.23.57.43;	author cagney;	state Exp;
branches;
next	;

1.38.8.1
date	2003.05.18.09.44.45;	author kettenis;	state Exp;
branches;
next	;

1.38.10.1
date	2003.05.09.11.39.30;	author amodra;	state Exp;
branches;
next	;

1.35.18.1
date	2002.12.23.19.39.31;	author carlton;	state Exp;
branches;
next	1.35.18.2;

1.35.18.2
date	2003.02.07.19.18.03;	author carlton;	state Exp;
branches;
next	1.35.18.3;

1.35.18.3
date	2003.04.16.19.57.05;	author carlton;	state Exp;
branches;
next	1.35.18.4;

1.35.18.4
date	2003.05.23.18.40.56;	author carlton;	state Exp;
branches;
next	1.35.18.5;

1.35.18.5
date	2003.06.27.21.50.26;	author carlton;	state Exp;
branches;
next	1.35.18.6;

1.35.18.6
date	2003.09.17.21.28.58;	author carlton;	state Exp;
branches;
next	1.35.18.7;

1.35.18.7
date	2004.01.26.19.11.50;	author carlton;	state Exp;
branches;
next	;

1.35.20.1
date	2003.12.14.20.28.06;	author drow;	state Exp;
branches;
next	1.35.20.2;

1.35.20.2
date	2004.02.09.19.44.01;	author drow;	state Exp;
branches;
next	;

1.34.2.1
date	2002.02.25.17.42.56;	author hubicka;	state Exp;
branches;
next	;

1.13.2.1
date	2001.02.01.15.43.06;	author hubicka;	state Exp;
branches;
next	1.13.2.2;

1.13.2.2
date	2001.02.12.16.40.20;	author hubicka;	state Exp;
branches;
next	1.13.2.3;

1.13.2.3
date	2001.03.22.03.42.20;	author amodra;	state Exp;
branches;
next	1.13.2.4;

1.13.2.4
date	2001.03.24.07.06.07;	author amodra;	state Exp;
branches;
next	1.13.2.5;

1.13.2.5
date	2001.05.04.11.15.50;	author amodra;	state Exp;
branches;
next	1.13.2.6;

1.13.2.6
date	2001.05.12.10.09.20;	author amodra;	state Exp;
branches;
next	1.13.2.7;

1.13.2.7
date	2001.05.12.12.12.18;	author amodra;	state Exp;
branches;
next	1.13.2.8;

1.13.2.8
date	2001.06.11.10.05.17;	author amodra;	state Exp;
branches;
next	1.13.2.9;

1.13.2.9
date	2001.09.04.01.59.07;	author amodra;	state Exp;
branches;
next	;

1.1.1.1
date	99.05.03.07.28.59;	author rth;	state Exp;
branches;
next	;


desc
@@


1.282
log
@Only allow 32-bit/64-bit registers for bndcl/bndcu/bndcn

gas/testsuite/

	* gas/i386/mpx.s: Remove bndcl/bndcu/bndcn tests with AX.
	* gas/i386/x86-64-mpx.s: Likwise.

	* gas/i386/mpx.d: Updated.
	* gas/i386/x86-64-mpx.d: Likewise.

opcodes/

	* i386-dis.c (intel_operand_size): Move v_bnd_mode alongside the
	default case.
	(OP_E_register): Move v_bnd_mode alongside m_mode.
	* i386-opc.tbl (bndcl, bndcu, bndcn): Split 32- and 64-bit variants.
	Drop Reg16 and Disp16. Add NoRex64.
	(bndmk, bndmov, bndldx, bndstx): Drop Disp16.
	* i386-tbl.h: Re-generate.
@
text
@/* Print i386 instructions for GDB, the GNU debugger.
   Copyright 1988, 1989, 1991, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
   2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013
   Free Software Foundation, Inc.

   This file is part of the GNU opcodes library.

   This library is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 3, or (at your option)
   any later version.

   It is distributed in the hope that it will be useful, but WITHOUT
   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
   or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
   License for more details.

   You should have received a copy of the GNU General Public License
   along with this program; if not, write to the Free Software
   Foundation, Inc., 51 Franklin Street - Fifth Floor, Boston,
   MA 02110-1301, USA.  */


/* 80386 instruction printer by Pace Willisson (pace@@prep.ai.mit.edu)
   July 1988
    modified by John Hassey (hassey@@dg-rtp.dg.com)
    x86-64 support added by Jan Hubicka (jh@@suse.cz)
    VIA PadLock support by Michal Ludvig (mludvig@@suse.cz).  */

/* The main tables describing the instructions is essentially a copy
   of the "Opcode Map" chapter (Appendix A) of the Intel 80386
   Programmers Manual.  Usually, there is a capital letter, followed
   by a small letter.  The capital letter tell the addressing mode,
   and the small letter tells about the operand size.  Refer to
   the Intel manual for details.  */

#include "sysdep.h"
#include "dis-asm.h"
#include "opintl.h"
#include "opcode/i386.h"
#include "libiberty.h"

#include <setjmp.h>

static int print_insn (bfd_vma, disassemble_info *);
static void dofloat (int);
static void OP_ST (int, int);
static void OP_STi (int, int);
static int putop (const char *, int);
static void oappend (const char *);
static void append_seg (void);
static void OP_indirE (int, int);
static void print_operand_value (char *, int, bfd_vma);
static void OP_E_register (int, int);
static void OP_E_memory (int, int);
static void print_displacement (char *, bfd_vma);
static void OP_E (int, int);
static void OP_G (int, int);
static bfd_vma get64 (void);
static bfd_signed_vma get32 (void);
static bfd_signed_vma get32s (void);
static int get16 (void);
static void set_op (bfd_vma, int);
static void OP_Skip_MODRM (int, int);
static void OP_REG (int, int);
static void OP_IMREG (int, int);
static void OP_I (int, int);
static void OP_I64 (int, int);
static void OP_sI (int, int);
static void OP_J (int, int);
static void OP_SEG (int, int);
static void OP_DIR (int, int);
static void OP_OFF (int, int);
static void OP_OFF64 (int, int);
static void ptr_reg (int, int);
static void OP_ESreg (int, int);
static void OP_DSreg (int, int);
static void OP_C (int, int);
static void OP_D (int, int);
static void OP_T (int, int);
static void OP_R (int, int);
static void OP_MMX (int, int);
static void OP_XMM (int, int);
static void OP_EM (int, int);
static void OP_EX (int, int);
static void OP_EMC (int,int);
static void OP_MXC (int,int);
static void OP_MS (int, int);
static void OP_XS (int, int);
static void OP_M (int, int);
static void OP_VEX (int, int);
static void OP_EX_Vex (int, int);
static void OP_EX_VexW (int, int);
static void OP_EX_VexImmW (int, int);
static void OP_XMM_Vex (int, int);
static void OP_XMM_VexW (int, int);
static void OP_Rounding (int, int);
static void OP_REG_VexI4 (int, int);
static void PCLMUL_Fixup (int, int);
static void VEXI4_Fixup (int, int);
static void VZERO_Fixup (int, int);
static void VCMP_Fixup (int, int);
static void VPCMP_Fixup (int, int);
static void OP_0f07 (int, int);
static void OP_Monitor (int, int);
static void OP_Mwait (int, int);
static void NOP_Fixup1 (int, int);
static void NOP_Fixup2 (int, int);
static void OP_3DNowSuffix (int, int);
static void CMP_Fixup (int, int);
static void BadOp (void);
static void REP_Fixup (int, int);
static void BND_Fixup (int, int);
static void HLE_Fixup1 (int, int);
static void HLE_Fixup2 (int, int);
static void HLE_Fixup3 (int, int);
static void CMPXCHG8B_Fixup (int, int);
static void XMM_Fixup (int, int);
static void CRC32_Fixup (int, int);
static void FXSAVE_Fixup (int, int);
static void OP_LWPCB_E (int, int);
static void OP_LWP_E (int, int);
static void OP_Vex_2src_1 (int, int);
static void OP_Vex_2src_2 (int, int);

static void MOVBE_Fixup (int, int);

static void OP_Mask (int, int);

struct dis_private {
  /* Points to first byte not fetched.  */
  bfd_byte *max_fetched;
  bfd_byte the_buffer[MAX_MNEM_SIZE];
  bfd_vma insn_start;
  int orig_sizeflag;
  jmp_buf bailout;
};

enum address_mode
{
  mode_16bit,
  mode_32bit,
  mode_64bit
};

enum address_mode address_mode;

/* Flags for the prefixes for the current instruction.  See below.  */
static int prefixes;

/* REX prefix the current instruction.  See below.  */
static int rex;
/* Bits of REX we've already used.  */
static int rex_used;
/* REX bits in original REX prefix ignored.  */
static int rex_ignored;
/* Mark parts used in the REX prefix.  When we are testing for
   empty prefix (for 8bit register REX extension), just mask it
   out.  Otherwise test for REX bit is excuse for existence of REX
   only in case value is nonzero.  */
#define USED_REX(value)					\
  {							\
    if (value)						\
      {							\
	if ((rex & value))				\
	  rex_used |= (value) | REX_OPCODE;		\
      }							\
    else						\
      rex_used |= REX_OPCODE;				\
  }

/* Flags for prefixes which we somehow handled when printing the
   current instruction.  */
static int used_prefixes;

/* Flags stored in PREFIXES.  */
#define PREFIX_REPZ 1
#define PREFIX_REPNZ 2
#define PREFIX_LOCK 4
#define PREFIX_CS 8
#define PREFIX_SS 0x10
#define PREFIX_DS 0x20
#define PREFIX_ES 0x40
#define PREFIX_FS 0x80
#define PREFIX_GS 0x100
#define PREFIX_DATA 0x200
#define PREFIX_ADDR 0x400
#define PREFIX_FWAIT 0x800

/* Make sure that bytes from INFO->PRIVATE_DATA->BUFFER (inclusive)
   to ADDR (exclusive) are valid.  Returns 1 for success, longjmps
   on error.  */
#define FETCH_DATA(info, addr) \
  ((addr) <= ((struct dis_private *) (info->private_data))->max_fetched \
   ? 1 : fetch_data ((info), (addr)))

static int
fetch_data (struct disassemble_info *info, bfd_byte *addr)
{
  int status;
  struct dis_private *priv = (struct dis_private *) info->private_data;
  bfd_vma start = priv->insn_start + (priv->max_fetched - priv->the_buffer);

  if (addr <= priv->the_buffer + MAX_MNEM_SIZE)
    status = (*info->read_memory_func) (start,
					priv->max_fetched,
					addr - priv->max_fetched,
					info);
  else
    status = -1;
  if (status != 0)
    {
      /* If we did manage to read at least one byte, then
	 print_insn_i386 will do something sensible.  Otherwise, print
	 an error.  We do that here because this is where we know
	 STATUS.  */
      if (priv->max_fetched == priv->the_buffer)
	(*info->memory_error_func) (status, start, info);
      longjmp (priv->bailout, 1);
    }
  else
    priv->max_fetched = addr;
  return 1;
}

#define XX { NULL, 0 }
#define Bad_Opcode NULL, { { NULL, 0 } }

#define Eb { OP_E, b_mode }
#define Ebnd { OP_E, bnd_mode }
#define EbS { OP_E, b_swap_mode }
#define Ev { OP_E, v_mode }
#define Ev_bnd { OP_E, v_bnd_mode }
#define EvS { OP_E, v_swap_mode }
#define Ed { OP_E, d_mode }
#define Edq { OP_E, dq_mode }
#define Edqw { OP_E, dqw_mode }
#define Edqb { OP_E, dqb_mode }
#define Edqd { OP_E, dqd_mode }
#define Eq { OP_E, q_mode }
#define indirEv { OP_indirE, stack_v_mode }
#define indirEp { OP_indirE, f_mode }
#define stackEv { OP_E, stack_v_mode }
#define Em { OP_E, m_mode }
#define Ew { OP_E, w_mode }
#define M { OP_M, 0 }		/* lea, lgdt, etc. */
#define Ma { OP_M, a_mode }
#define Mb { OP_M, b_mode }
#define Md { OP_M, d_mode }
#define Mo { OP_M, o_mode }
#define Mp { OP_M, f_mode }		/* 32 or 48 bit memory operand for LDS, LES etc */
#define Mq { OP_M, q_mode }
#define Mx { OP_M, x_mode }
#define Mxmm { OP_M, xmm_mode }
#define Gb { OP_G, b_mode }
#define Gbnd { OP_G, bnd_mode }
#define Gv { OP_G, v_mode }
#define Gd { OP_G, d_mode }
#define Gdq { OP_G, dq_mode }
#define Gm { OP_G, m_mode }
#define Gw { OP_G, w_mode }
#define Rd { OP_R, d_mode }
#define Rdq { OP_R, dq_mode }
#define Rm { OP_R, m_mode }
#define Ib { OP_I, b_mode }
#define sIb { OP_sI, b_mode }	/* sign extened byte */
#define sIbT { OP_sI, b_T_mode } /* sign extened byte like 'T' */
#define Iv { OP_I, v_mode }
#define sIv { OP_sI, v_mode }
#define Iq { OP_I, q_mode }
#define Iv64 { OP_I64, v_mode }
#define Iw { OP_I, w_mode }
#define I1 { OP_I, const_1_mode }
#define Jb { OP_J, b_mode }
#define Jv { OP_J, v_mode }
#define Cm { OP_C, m_mode }
#define Dm { OP_D, m_mode }
#define Td { OP_T, d_mode }
#define Skip_MODRM { OP_Skip_MODRM, 0 }

#define RMeAX { OP_REG, eAX_reg }
#define RMeBX { OP_REG, eBX_reg }
#define RMeCX { OP_REG, eCX_reg }
#define RMeDX { OP_REG, eDX_reg }
#define RMeSP { OP_REG, eSP_reg }
#define RMeBP { OP_REG, eBP_reg }
#define RMeSI { OP_REG, eSI_reg }
#define RMeDI { OP_REG, eDI_reg }
#define RMrAX { OP_REG, rAX_reg }
#define RMrBX { OP_REG, rBX_reg }
#define RMrCX { OP_REG, rCX_reg }
#define RMrDX { OP_REG, rDX_reg }
#define RMrSP { OP_REG, rSP_reg }
#define RMrBP { OP_REG, rBP_reg }
#define RMrSI { OP_REG, rSI_reg }
#define RMrDI { OP_REG, rDI_reg }
#define RMAL { OP_REG, al_reg }
#define RMCL { OP_REG, cl_reg }
#define RMDL { OP_REG, dl_reg }
#define RMBL { OP_REG, bl_reg }
#define RMAH { OP_REG, ah_reg }
#define RMCH { OP_REG, ch_reg }
#define RMDH { OP_REG, dh_reg }
#define RMBH { OP_REG, bh_reg }
#define RMAX { OP_REG, ax_reg }
#define RMDX { OP_REG, dx_reg }

#define eAX { OP_IMREG, eAX_reg }
#define eBX { OP_IMREG, eBX_reg }
#define eCX { OP_IMREG, eCX_reg }
#define eDX { OP_IMREG, eDX_reg }
#define eSP { OP_IMREG, eSP_reg }
#define eBP { OP_IMREG, eBP_reg }
#define eSI { OP_IMREG, eSI_reg }
#define eDI { OP_IMREG, eDI_reg }
#define AL { OP_IMREG, al_reg }
#define CL { OP_IMREG, cl_reg }
#define DL { OP_IMREG, dl_reg }
#define BL { OP_IMREG, bl_reg }
#define AH { OP_IMREG, ah_reg }
#define CH { OP_IMREG, ch_reg }
#define DH { OP_IMREG, dh_reg }
#define BH { OP_IMREG, bh_reg }
#define AX { OP_IMREG, ax_reg }
#define DX { OP_IMREG, dx_reg }
#define zAX { OP_IMREG, z_mode_ax_reg }
#define indirDX { OP_IMREG, indir_dx_reg }

#define Sw { OP_SEG, w_mode }
#define Sv { OP_SEG, v_mode }
#define Ap { OP_DIR, 0 }
#define Ob { OP_OFF64, b_mode }
#define Ov { OP_OFF64, v_mode }
#define Xb { OP_DSreg, eSI_reg }
#define Xv { OP_DSreg, eSI_reg }
#define Xz { OP_DSreg, eSI_reg }
#define Yb { OP_ESreg, eDI_reg }
#define Yv { OP_ESreg, eDI_reg }
#define DSBX { OP_DSreg, eBX_reg }

#define es { OP_REG, es_reg }
#define ss { OP_REG, ss_reg }
#define cs { OP_REG, cs_reg }
#define ds { OP_REG, ds_reg }
#define fs { OP_REG, fs_reg }
#define gs { OP_REG, gs_reg }

#define MX { OP_MMX, 0 }
#define XM { OP_XMM, 0 }
#define XMScalar { OP_XMM, scalar_mode }
#define XMGatherQ { OP_XMM, vex_vsib_q_w_dq_mode }
#define XMM { OP_XMM, xmm_mode }
#define XMxmmq { OP_XMM, xmmq_mode }
#define EM { OP_EM, v_mode }
#define EMS { OP_EM, v_swap_mode }
#define EMd { OP_EM, d_mode }
#define EMx { OP_EM, x_mode }
#define EXw { OP_EX, w_mode }
#define EXd { OP_EX, d_mode }
#define EXdScalar { OP_EX, d_scalar_mode }
#define EXdS { OP_EX, d_swap_mode }
#define EXdScalarS { OP_EX, d_scalar_swap_mode }
#define EXq { OP_EX, q_mode }
#define EXqScalar { OP_EX, q_scalar_mode }
#define EXqScalarS { OP_EX, q_scalar_swap_mode }
#define EXqS { OP_EX, q_swap_mode }
#define EXx { OP_EX, x_mode }
#define EXxS { OP_EX, x_swap_mode }
#define EXxmm { OP_EX, xmm_mode }
#define EXymm { OP_EX, ymm_mode }
#define EXxmmq { OP_EX, xmmq_mode }
#define EXEvexHalfBcstXmmq { OP_EX, evex_half_bcst_xmmq_mode }
#define EXxmm_mb { OP_EX, xmm_mb_mode }
#define EXxmm_mw { OP_EX, xmm_mw_mode }
#define EXxmm_md { OP_EX, xmm_md_mode }
#define EXxmm_mq { OP_EX, xmm_mq_mode }
#define EXxmm_mdq { OP_EX, xmm_mdq_mode }
#define EXxmmdw { OP_EX, xmmdw_mode }
#define EXxmmqd { OP_EX, xmmqd_mode }
#define EXymmq { OP_EX, ymmq_mode }
#define EXVexWdq { OP_EX, vex_w_dq_mode }
#define EXVexWdqScalar { OP_EX, vex_scalar_w_dq_mode }
#define EXEvexXGscat { OP_EX, evex_x_gscat_mode }
#define EXEvexXNoBcst { OP_EX, evex_x_nobcst_mode }
#define MS { OP_MS, v_mode }
#define XS { OP_XS, v_mode }
#define EMCq { OP_EMC, q_mode }
#define MXC { OP_MXC, 0 }
#define OPSUF { OP_3DNowSuffix, 0 }
#define CMP { CMP_Fixup, 0 }
#define XMM0 { XMM_Fixup, 0 }
#define FXSAVE { FXSAVE_Fixup, 0 }
#define Vex_2src_1 { OP_Vex_2src_1, 0 }
#define Vex_2src_2 { OP_Vex_2src_2, 0 }

#define Vex { OP_VEX, vex_mode }
#define VexScalar { OP_VEX, vex_scalar_mode }
#define VexGatherQ { OP_VEX, vex_vsib_q_w_dq_mode }
#define Vex128 { OP_VEX, vex128_mode }
#define Vex256 { OP_VEX, vex256_mode }
#define VexGdq { OP_VEX, dq_mode }
#define VexI4 { VEXI4_Fixup, 0}
#define EXdVex { OP_EX_Vex, d_mode }
#define EXdVexS { OP_EX_Vex, d_swap_mode }
#define EXdVexScalarS { OP_EX_Vex, d_scalar_swap_mode }
#define EXqVex { OP_EX_Vex, q_mode }
#define EXqVexS { OP_EX_Vex, q_swap_mode }
#define EXqVexScalarS { OP_EX_Vex, q_scalar_swap_mode }
#define EXVexW { OP_EX_VexW, x_mode }
#define EXdVexW { OP_EX_VexW, d_mode }
#define EXqVexW { OP_EX_VexW, q_mode }
#define EXVexImmW { OP_EX_VexImmW, x_mode }
#define XMVex { OP_XMM_Vex, 0 }
#define XMVexScalar { OP_XMM_Vex, scalar_mode }
#define XMVexW { OP_XMM_VexW, 0 }
#define XMVexI4 { OP_REG_VexI4, x_mode }
#define PCLMUL { PCLMUL_Fixup, 0 }
#define VZERO { VZERO_Fixup, 0 }
#define VCMP { VCMP_Fixup, 0 }
#define VPCMP { VPCMP_Fixup, 0 }

#define EXxEVexR { OP_Rounding, evex_rounding_mode }
#define EXxEVexS { OP_Rounding, evex_sae_mode }

#define XMask { OP_Mask, mask_mode }
#define MaskG { OP_G, mask_mode }
#define MaskE { OP_E, mask_mode }
#define MaskR { OP_R, mask_mode }
#define MaskVex { OP_VEX, mask_mode }

#define MVexVSIBDWpX { OP_M, vex_vsib_d_w_dq_mode }
#define MVexVSIBQWpX { OP_M, vex_vsib_q_w_dq_mode }

/* Used handle "rep" prefix for string instructions.  */
#define Xbr { REP_Fixup, eSI_reg }
#define Xvr { REP_Fixup, eSI_reg }
#define Ybr { REP_Fixup, eDI_reg }
#define Yvr { REP_Fixup, eDI_reg }
#define Yzr { REP_Fixup, eDI_reg }
#define indirDXr { REP_Fixup, indir_dx_reg }
#define ALr { REP_Fixup, al_reg }
#define eAXr { REP_Fixup, eAX_reg }

/* Used handle HLE prefix for lockable instructions.  */
#define Ebh1 { HLE_Fixup1, b_mode }
#define Evh1 { HLE_Fixup1, v_mode }
#define Ebh2 { HLE_Fixup2, b_mode }
#define Evh2 { HLE_Fixup2, v_mode }
#define Ebh3 { HLE_Fixup3, b_mode }
#define Evh3 { HLE_Fixup3, v_mode }

#define BND { BND_Fixup, 0 }

#define cond_jump_flag { NULL, cond_jump_mode }
#define loop_jcxz_flag { NULL, loop_jcxz_mode }

/* bits in sizeflag */
#define SUFFIX_ALWAYS 4
#define AFLAG 2
#define DFLAG 1

enum
{
  /* byte operand */
  b_mode = 1,
  /* byte operand with operand swapped */
  b_swap_mode,
  /* byte operand, sign extend like 'T' suffix */
  b_T_mode,
  /* operand size depends on prefixes */
  v_mode,
  /* operand size depends on prefixes with operand swapped */
  v_swap_mode,
  /* word operand */
  w_mode,
  /* double word operand  */
  d_mode,
  /* double word operand with operand swapped */
  d_swap_mode,
  /* quad word operand */
  q_mode,
  /* quad word operand with operand swapped */
  q_swap_mode,
  /* ten-byte operand */
  t_mode,
  /* 16-byte XMM, 32-byte YMM or 64-byte ZMM operand.  In EVEX with
     broadcast enabled.  */
  x_mode,
  /* Similar to x_mode, but with different EVEX mem shifts.  */
  evex_x_gscat_mode,
  /* Similar to x_mode, but with disabled broadcast.  */
  evex_x_nobcst_mode,
  /* Similar to x_mode, but with operands swapped and disabled broadcast
     in EVEX.  */
  x_swap_mode,
  /* 16-byte XMM operand */
  xmm_mode,
  /* XMM, XMM or YMM register operand, or quad word, xmmword or ymmword
     memory operand (depending on vector length).  Broadcast isn't
     allowed.  */
  xmmq_mode,
  /* Same as xmmq_mode, but broadcast is allowed.  */
  evex_half_bcst_xmmq_mode,
  /* XMM register or byte memory operand */
  xmm_mb_mode,
  /* XMM register or word memory operand */
  xmm_mw_mode,
  /* XMM register or double word memory operand */
  xmm_md_mode,
  /* XMM register or quad word memory operand */
  xmm_mq_mode,
  /* XMM register or double/quad word memory operand, depending on
     VEX.W.  */
  xmm_mdq_mode,
  /* 16-byte XMM, word, double word or quad word operand.  */
  xmmdw_mode,
  /* 16-byte XMM, double word, quad word operand or xmm word operand.  */
  xmmqd_mode,
  /* 32-byte YMM operand */
  ymm_mode,
  /* quad word, ymmword or zmmword memory operand.  */
  ymmq_mode,
  /* 32-byte YMM or 16-byte word operand */
  ymmxmm_mode,
  /* d_mode in 32bit, q_mode in 64bit mode.  */
  m_mode,
  /* pair of v_mode operands */
  a_mode,
  cond_jump_mode,
  loop_jcxz_mode,
  v_bnd_mode,
  /* operand size depends on REX prefixes.  */
  dq_mode,
  /* registers like dq_mode, memory like w_mode.  */
  dqw_mode,
  bnd_mode,
  /* 4- or 6-byte pointer operand */
  f_mode,
  const_1_mode,
  /* v_mode for stack-related opcodes.  */
  stack_v_mode,
  /* non-quad operand size depends on prefixes */
  z_mode,
  /* 16-byte operand */
  o_mode,
  /* registers like dq_mode, memory like b_mode.  */
  dqb_mode,
  /* registers like dq_mode, memory like d_mode.  */
  dqd_mode,
  /* normal vex mode */
  vex_mode,
  /* 128bit vex mode */
  vex128_mode,
  /* 256bit vex mode */
  vex256_mode,
  /* operand size depends on the VEX.W bit.  */
  vex_w_dq_mode,

  /* Similar to vex_w_dq_mode, with VSIB dword indices.  */
  vex_vsib_d_w_dq_mode,
  /* Similar to vex_w_dq_mode, with VSIB qword indices.  */
  vex_vsib_q_w_dq_mode,

  /* scalar, ignore vector length.  */
  scalar_mode,
  /* like d_mode, ignore vector length.  */
  d_scalar_mode,
  /* like d_swap_mode, ignore vector length.  */
  d_scalar_swap_mode,
  /* like q_mode, ignore vector length.  */
  q_scalar_mode,
  /* like q_swap_mode, ignore vector length.  */
  q_scalar_swap_mode,
  /* like vex_mode, ignore vector length.  */
  vex_scalar_mode,
  /* like vex_w_dq_mode, ignore vector length.  */
  vex_scalar_w_dq_mode,

  /* Static rounding.  */
  evex_rounding_mode,
  /* Supress all exceptions.  */
  evex_sae_mode,

  /* Mask register operand.  */
  mask_mode,

  es_reg,
  cs_reg,
  ss_reg,
  ds_reg,
  fs_reg,
  gs_reg,

  eAX_reg,
  eCX_reg,
  eDX_reg,
  eBX_reg,
  eSP_reg,
  eBP_reg,
  eSI_reg,
  eDI_reg,

  al_reg,
  cl_reg,
  dl_reg,
  bl_reg,
  ah_reg,
  ch_reg,
  dh_reg,
  bh_reg,

  ax_reg,
  cx_reg,
  dx_reg,
  bx_reg,
  sp_reg,
  bp_reg,
  si_reg,
  di_reg,

  rAX_reg,
  rCX_reg,
  rDX_reg,
  rBX_reg,
  rSP_reg,
  rBP_reg,
  rSI_reg,
  rDI_reg,

  z_mode_ax_reg,
  indir_dx_reg
};

enum
{
  FLOATCODE = 1,
  USE_REG_TABLE,
  USE_MOD_TABLE,
  USE_RM_TABLE,
  USE_PREFIX_TABLE,
  USE_X86_64_TABLE,
  USE_3BYTE_TABLE,
  USE_XOP_8F_TABLE,
  USE_VEX_C4_TABLE,
  USE_VEX_C5_TABLE,
  USE_VEX_LEN_TABLE,
  USE_VEX_W_TABLE,
  USE_EVEX_TABLE
};

#define FLOAT			NULL, { { NULL, FLOATCODE } }

#define DIS386(T, I)		NULL, { { NULL, (T)}, { NULL,  (I) } }
#define REG_TABLE(I)		DIS386 (USE_REG_TABLE, (I))
#define MOD_TABLE(I)		DIS386 (USE_MOD_TABLE, (I))
#define RM_TABLE(I)		DIS386 (USE_RM_TABLE, (I))
#define PREFIX_TABLE(I)		DIS386 (USE_PREFIX_TABLE, (I))
#define X86_64_TABLE(I)		DIS386 (USE_X86_64_TABLE, (I))
#define THREE_BYTE_TABLE(I)	DIS386 (USE_3BYTE_TABLE, (I))
#define XOP_8F_TABLE(I)		DIS386 (USE_XOP_8F_TABLE, (I))
#define VEX_C4_TABLE(I)		DIS386 (USE_VEX_C4_TABLE, (I))
#define VEX_C5_TABLE(I)		DIS386 (USE_VEX_C5_TABLE, (I))
#define VEX_LEN_TABLE(I)	DIS386 (USE_VEX_LEN_TABLE, (I))
#define VEX_W_TABLE(I)		DIS386 (USE_VEX_W_TABLE, (I))
#define EVEX_TABLE(I)		DIS386 (USE_EVEX_TABLE, (I))

enum
{
  REG_80 = 0,
  REG_81,
  REG_82,
  REG_8F,
  REG_C0,
  REG_C1,
  REG_C6,
  REG_C7,
  REG_D0,
  REG_D1,
  REG_D2,
  REG_D3,
  REG_F6,
  REG_F7,
  REG_FE,
  REG_FF,
  REG_0F00,
  REG_0F01,
  REG_0F0D,
  REG_0F18,
  REG_0F71,
  REG_0F72,
  REG_0F73,
  REG_0FA6,
  REG_0FA7,
  REG_0FAE,
  REG_0FBA,
  REG_0FC7,
  REG_VEX_0F71,
  REG_VEX_0F72,
  REG_VEX_0F73,
  REG_VEX_0FAE,
  REG_VEX_0F38F3,
  REG_XOP_LWPCB,
  REG_XOP_LWP,
  REG_XOP_TBM_01,
  REG_XOP_TBM_02,

  REG_EVEX_0F72,
  REG_EVEX_0F73,
  REG_EVEX_0F38C6,
  REG_EVEX_0F38C7
};

enum
{
  MOD_8D = 0,
  MOD_C6_REG_7,
  MOD_C7_REG_7,
  MOD_0F01_REG_0,
  MOD_0F01_REG_1,
  MOD_0F01_REG_2,
  MOD_0F01_REG_3,
  MOD_0F01_REG_7,
  MOD_0F12_PREFIX_0,
  MOD_0F13,
  MOD_0F16_PREFIX_0,
  MOD_0F17,
  MOD_0F18_REG_0,
  MOD_0F18_REG_1,
  MOD_0F18_REG_2,
  MOD_0F18_REG_3,
  MOD_0F18_REG_4,
  MOD_0F18_REG_5,
  MOD_0F18_REG_6,
  MOD_0F18_REG_7,
  MOD_0F1A_PREFIX_0,
  MOD_0F1B_PREFIX_0,
  MOD_0F1B_PREFIX_1,
  MOD_0F20,
  MOD_0F21,
  MOD_0F22,
  MOD_0F23,
  MOD_0F24,
  MOD_0F26,
  MOD_0F2B_PREFIX_0,
  MOD_0F2B_PREFIX_1,
  MOD_0F2B_PREFIX_2,
  MOD_0F2B_PREFIX_3,
  MOD_0F51,
  MOD_0F71_REG_2,
  MOD_0F71_REG_4,
  MOD_0F71_REG_6,
  MOD_0F72_REG_2,
  MOD_0F72_REG_4,
  MOD_0F72_REG_6,
  MOD_0F73_REG_2,
  MOD_0F73_REG_3,
  MOD_0F73_REG_6,
  MOD_0F73_REG_7,
  MOD_0FAE_REG_0,
  MOD_0FAE_REG_1,
  MOD_0FAE_REG_2,
  MOD_0FAE_REG_3,
  MOD_0FAE_REG_4,
  MOD_0FAE_REG_5,
  MOD_0FAE_REG_6,
  MOD_0FAE_REG_7,
  MOD_0FB2,
  MOD_0FB4,
  MOD_0FB5,
  MOD_0FC7_REG_6,
  MOD_0FC7_REG_7,
  MOD_0FD7,
  MOD_0FE7_PREFIX_2,
  MOD_0FF0_PREFIX_3,
  MOD_0F382A_PREFIX_2,
  MOD_62_32BIT,
  MOD_C4_32BIT,
  MOD_C5_32BIT,
  MOD_VEX_0F12_PREFIX_0,
  MOD_VEX_0F13,
  MOD_VEX_0F16_PREFIX_0,
  MOD_VEX_0F17,
  MOD_VEX_0F2B,
  MOD_VEX_0F50,
  MOD_VEX_0F71_REG_2,
  MOD_VEX_0F71_REG_4,
  MOD_VEX_0F71_REG_6,
  MOD_VEX_0F72_REG_2,
  MOD_VEX_0F72_REG_4,
  MOD_VEX_0F72_REG_6,
  MOD_VEX_0F73_REG_2,
  MOD_VEX_0F73_REG_3,
  MOD_VEX_0F73_REG_6,
  MOD_VEX_0F73_REG_7,
  MOD_VEX_0FAE_REG_2,
  MOD_VEX_0FAE_REG_3,
  MOD_VEX_0FD7_PREFIX_2,
  MOD_VEX_0FE7_PREFIX_2,
  MOD_VEX_0FF0_PREFIX_3,
  MOD_VEX_0F381A_PREFIX_2,
  MOD_VEX_0F382A_PREFIX_2,
  MOD_VEX_0F382C_PREFIX_2,
  MOD_VEX_0F382D_PREFIX_2,
  MOD_VEX_0F382E_PREFIX_2,
  MOD_VEX_0F382F_PREFIX_2,
  MOD_VEX_0F385A_PREFIX_2,
  MOD_VEX_0F388C_PREFIX_2,
  MOD_VEX_0F388E_PREFIX_2,

  MOD_EVEX_0F10_PREFIX_1,
  MOD_EVEX_0F10_PREFIX_3,
  MOD_EVEX_0F11_PREFIX_1,
  MOD_EVEX_0F11_PREFIX_3,
  MOD_EVEX_0F12_PREFIX_0,
  MOD_EVEX_0F16_PREFIX_0,
  MOD_EVEX_0F38C6_REG_1,
  MOD_EVEX_0F38C6_REG_2,
  MOD_EVEX_0F38C6_REG_5,
  MOD_EVEX_0F38C6_REG_6,
  MOD_EVEX_0F38C7_REG_1,
  MOD_EVEX_0F38C7_REG_2,
  MOD_EVEX_0F38C7_REG_5,
  MOD_EVEX_0F38C7_REG_6
};

enum
{
  RM_C6_REG_7 = 0,
  RM_C7_REG_7,
  RM_0F01_REG_0,
  RM_0F01_REG_1,
  RM_0F01_REG_2,
  RM_0F01_REG_3,
  RM_0F01_REG_7,
  RM_0FAE_REG_5,
  RM_0FAE_REG_6,
  RM_0FAE_REG_7
};

enum
{
  PREFIX_90 = 0,
  PREFIX_0F10,
  PREFIX_0F11,
  PREFIX_0F12,
  PREFIX_0F16,
  PREFIX_0F1A,
  PREFIX_0F1B,
  PREFIX_0F2A,
  PREFIX_0F2B,
  PREFIX_0F2C,
  PREFIX_0F2D,
  PREFIX_0F2E,
  PREFIX_0F2F,
  PREFIX_0F51,
  PREFIX_0F52,
  PREFIX_0F53,
  PREFIX_0F58,
  PREFIX_0F59,
  PREFIX_0F5A,
  PREFIX_0F5B,
  PREFIX_0F5C,
  PREFIX_0F5D,
  PREFIX_0F5E,
  PREFIX_0F5F,
  PREFIX_0F60,
  PREFIX_0F61,
  PREFIX_0F62,
  PREFIX_0F6C,
  PREFIX_0F6D,
  PREFIX_0F6F,
  PREFIX_0F70,
  PREFIX_0F73_REG_3,
  PREFIX_0F73_REG_7,
  PREFIX_0F78,
  PREFIX_0F79,
  PREFIX_0F7C,
  PREFIX_0F7D,
  PREFIX_0F7E,
  PREFIX_0F7F,
  PREFIX_0FAE_REG_0,
  PREFIX_0FAE_REG_1,
  PREFIX_0FAE_REG_2,
  PREFIX_0FAE_REG_3,
  PREFIX_0FB8,
  PREFIX_0FBC,
  PREFIX_0FBD,
  PREFIX_0FC2,
  PREFIX_0FC3,
  PREFIX_0FC7_REG_6,
  PREFIX_0FD0,
  PREFIX_0FD6,
  PREFIX_0FE6,
  PREFIX_0FE7,
  PREFIX_0FF0,
  PREFIX_0FF7,
  PREFIX_0F3810,
  PREFIX_0F3814,
  PREFIX_0F3815,
  PREFIX_0F3817,
  PREFIX_0F3820,
  PREFIX_0F3821,
  PREFIX_0F3822,
  PREFIX_0F3823,
  PREFIX_0F3824,
  PREFIX_0F3825,
  PREFIX_0F3828,
  PREFIX_0F3829,
  PREFIX_0F382A,
  PREFIX_0F382B,
  PREFIX_0F3830,
  PREFIX_0F3831,
  PREFIX_0F3832,
  PREFIX_0F3833,
  PREFIX_0F3834,
  PREFIX_0F3835,
  PREFIX_0F3837,
  PREFIX_0F3838,
  PREFIX_0F3839,
  PREFIX_0F383A,
  PREFIX_0F383B,
  PREFIX_0F383C,
  PREFIX_0F383D,
  PREFIX_0F383E,
  PREFIX_0F383F,
  PREFIX_0F3840,
  PREFIX_0F3841,
  PREFIX_0F3880,
  PREFIX_0F3881,
  PREFIX_0F3882,
  PREFIX_0F38C8,
  PREFIX_0F38C9,
  PREFIX_0F38CA,
  PREFIX_0F38CB,
  PREFIX_0F38CC,
  PREFIX_0F38CD,
  PREFIX_0F38DB,
  PREFIX_0F38DC,
  PREFIX_0F38DD,
  PREFIX_0F38DE,
  PREFIX_0F38DF,
  PREFIX_0F38F0,
  PREFIX_0F38F1,
  PREFIX_0F38F6,
  PREFIX_0F3A08,
  PREFIX_0F3A09,
  PREFIX_0F3A0A,
  PREFIX_0F3A0B,
  PREFIX_0F3A0C,
  PREFIX_0F3A0D,
  PREFIX_0F3A0E,
  PREFIX_0F3A14,
  PREFIX_0F3A15,
  PREFIX_0F3A16,
  PREFIX_0F3A17,
  PREFIX_0F3A20,
  PREFIX_0F3A21,
  PREFIX_0F3A22,
  PREFIX_0F3A40,
  PREFIX_0F3A41,
  PREFIX_0F3A42,
  PREFIX_0F3A44,
  PREFIX_0F3A60,
  PREFIX_0F3A61,
  PREFIX_0F3A62,
  PREFIX_0F3A63,
  PREFIX_0F3ACC,
  PREFIX_0F3ADF,
  PREFIX_VEX_0F10,
  PREFIX_VEX_0F11,
  PREFIX_VEX_0F12,
  PREFIX_VEX_0F16,
  PREFIX_VEX_0F2A,
  PREFIX_VEX_0F2C,
  PREFIX_VEX_0F2D,
  PREFIX_VEX_0F2E,
  PREFIX_VEX_0F2F,
  PREFIX_VEX_0F41,
  PREFIX_VEX_0F42,
  PREFIX_VEX_0F44,
  PREFIX_VEX_0F45,
  PREFIX_VEX_0F46,
  PREFIX_VEX_0F47,
  PREFIX_VEX_0F4B,
  PREFIX_VEX_0F51,
  PREFIX_VEX_0F52,
  PREFIX_VEX_0F53,
  PREFIX_VEX_0F58,
  PREFIX_VEX_0F59,
  PREFIX_VEX_0F5A,
  PREFIX_VEX_0F5B,
  PREFIX_VEX_0F5C,
  PREFIX_VEX_0F5D,
  PREFIX_VEX_0F5E,
  PREFIX_VEX_0F5F,
  PREFIX_VEX_0F60,
  PREFIX_VEX_0F61,
  PREFIX_VEX_0F62,
  PREFIX_VEX_0F63,
  PREFIX_VEX_0F64,
  PREFIX_VEX_0F65,
  PREFIX_VEX_0F66,
  PREFIX_VEX_0F67,
  PREFIX_VEX_0F68,
  PREFIX_VEX_0F69,
  PREFIX_VEX_0F6A,
  PREFIX_VEX_0F6B,
  PREFIX_VEX_0F6C,
  PREFIX_VEX_0F6D,
  PREFIX_VEX_0F6E,
  PREFIX_VEX_0F6F,
  PREFIX_VEX_0F70,
  PREFIX_VEX_0F71_REG_2,
  PREFIX_VEX_0F71_REG_4,
  PREFIX_VEX_0F71_REG_6,
  PREFIX_VEX_0F72_REG_2,
  PREFIX_VEX_0F72_REG_4,
  PREFIX_VEX_0F72_REG_6,
  PREFIX_VEX_0F73_REG_2,
  PREFIX_VEX_0F73_REG_3,
  PREFIX_VEX_0F73_REG_6,
  PREFIX_VEX_0F73_REG_7,
  PREFIX_VEX_0F74,
  PREFIX_VEX_0F75,
  PREFIX_VEX_0F76,
  PREFIX_VEX_0F77,
  PREFIX_VEX_0F7C,
  PREFIX_VEX_0F7D,
  PREFIX_VEX_0F7E,
  PREFIX_VEX_0F7F,
  PREFIX_VEX_0F90,
  PREFIX_VEX_0F91,
  PREFIX_VEX_0F92,
  PREFIX_VEX_0F93,
  PREFIX_VEX_0F98,
  PREFIX_VEX_0FC2,
  PREFIX_VEX_0FC4,
  PREFIX_VEX_0FC5,
  PREFIX_VEX_0FD0,
  PREFIX_VEX_0FD1,
  PREFIX_VEX_0FD2,
  PREFIX_VEX_0FD3,
  PREFIX_VEX_0FD4,
  PREFIX_VEX_0FD5,
  PREFIX_VEX_0FD6,
  PREFIX_VEX_0FD7,
  PREFIX_VEX_0FD8,
  PREFIX_VEX_0FD9,
  PREFIX_VEX_0FDA,
  PREFIX_VEX_0FDB,
  PREFIX_VEX_0FDC,
  PREFIX_VEX_0FDD,
  PREFIX_VEX_0FDE,
  PREFIX_VEX_0FDF,
  PREFIX_VEX_0FE0,
  PREFIX_VEX_0FE1,
  PREFIX_VEX_0FE2,
  PREFIX_VEX_0FE3,
  PREFIX_VEX_0FE4,
  PREFIX_VEX_0FE5,
  PREFIX_VEX_0FE6,
  PREFIX_VEX_0FE7,
  PREFIX_VEX_0FE8,
  PREFIX_VEX_0FE9,
  PREFIX_VEX_0FEA,
  PREFIX_VEX_0FEB,
  PREFIX_VEX_0FEC,
  PREFIX_VEX_0FED,
  PREFIX_VEX_0FEE,
  PREFIX_VEX_0FEF,
  PREFIX_VEX_0FF0,
  PREFIX_VEX_0FF1,
  PREFIX_VEX_0FF2,
  PREFIX_VEX_0FF3,
  PREFIX_VEX_0FF4,
  PREFIX_VEX_0FF5,
  PREFIX_VEX_0FF6,
  PREFIX_VEX_0FF7,
  PREFIX_VEX_0FF8,
  PREFIX_VEX_0FF9,
  PREFIX_VEX_0FFA,
  PREFIX_VEX_0FFB,
  PREFIX_VEX_0FFC,
  PREFIX_VEX_0FFD,
  PREFIX_VEX_0FFE,
  PREFIX_VEX_0F3800,
  PREFIX_VEX_0F3801,
  PREFIX_VEX_0F3802,
  PREFIX_VEX_0F3803,
  PREFIX_VEX_0F3804,
  PREFIX_VEX_0F3805,
  PREFIX_VEX_0F3806,
  PREFIX_VEX_0F3807,
  PREFIX_VEX_0F3808,
  PREFIX_VEX_0F3809,
  PREFIX_VEX_0F380A,
  PREFIX_VEX_0F380B,
  PREFIX_VEX_0F380C,
  PREFIX_VEX_0F380D,
  PREFIX_VEX_0F380E,
  PREFIX_VEX_0F380F,
  PREFIX_VEX_0F3813,
  PREFIX_VEX_0F3816,
  PREFIX_VEX_0F3817,
  PREFIX_VEX_0F3818,
  PREFIX_VEX_0F3819,
  PREFIX_VEX_0F381A,
  PREFIX_VEX_0F381C,
  PREFIX_VEX_0F381D,
  PREFIX_VEX_0F381E,
  PREFIX_VEX_0F3820,
  PREFIX_VEX_0F3821,
  PREFIX_VEX_0F3822,
  PREFIX_VEX_0F3823,
  PREFIX_VEX_0F3824,
  PREFIX_VEX_0F3825,
  PREFIX_VEX_0F3828,
  PREFIX_VEX_0F3829,
  PREFIX_VEX_0F382A,
  PREFIX_VEX_0F382B,
  PREFIX_VEX_0F382C,
  PREFIX_VEX_0F382D,
  PREFIX_VEX_0F382E,
  PREFIX_VEX_0F382F,
  PREFIX_VEX_0F3830,
  PREFIX_VEX_0F3831,
  PREFIX_VEX_0F3832,
  PREFIX_VEX_0F3833,
  PREFIX_VEX_0F3834,
  PREFIX_VEX_0F3835,
  PREFIX_VEX_0F3836,
  PREFIX_VEX_0F3837,
  PREFIX_VEX_0F3838,
  PREFIX_VEX_0F3839,
  PREFIX_VEX_0F383A,
  PREFIX_VEX_0F383B,
  PREFIX_VEX_0F383C,
  PREFIX_VEX_0F383D,
  PREFIX_VEX_0F383E,
  PREFIX_VEX_0F383F,
  PREFIX_VEX_0F3840,
  PREFIX_VEX_0F3841,
  PREFIX_VEX_0F3845,
  PREFIX_VEX_0F3846,
  PREFIX_VEX_0F3847,
  PREFIX_VEX_0F3858,
  PREFIX_VEX_0F3859,
  PREFIX_VEX_0F385A,
  PREFIX_VEX_0F3878,
  PREFIX_VEX_0F3879,
  PREFIX_VEX_0F388C,
  PREFIX_VEX_0F388E,
  PREFIX_VEX_0F3890,
  PREFIX_VEX_0F3891,
  PREFIX_VEX_0F3892,
  PREFIX_VEX_0F3893,
  PREFIX_VEX_0F3896,
  PREFIX_VEX_0F3897,
  PREFIX_VEX_0F3898,
  PREFIX_VEX_0F3899,
  PREFIX_VEX_0F389A,
  PREFIX_VEX_0F389B,
  PREFIX_VEX_0F389C,
  PREFIX_VEX_0F389D,
  PREFIX_VEX_0F389E,
  PREFIX_VEX_0F389F,
  PREFIX_VEX_0F38A6,
  PREFIX_VEX_0F38A7,
  PREFIX_VEX_0F38A8,
  PREFIX_VEX_0F38A9,
  PREFIX_VEX_0F38AA,
  PREFIX_VEX_0F38AB,
  PREFIX_VEX_0F38AC,
  PREFIX_VEX_0F38AD,
  PREFIX_VEX_0F38AE,
  PREFIX_VEX_0F38AF,
  PREFIX_VEX_0F38B6,
  PREFIX_VEX_0F38B7,
  PREFIX_VEX_0F38B8,
  PREFIX_VEX_0F38B9,
  PREFIX_VEX_0F38BA,
  PREFIX_VEX_0F38BB,
  PREFIX_VEX_0F38BC,
  PREFIX_VEX_0F38BD,
  PREFIX_VEX_0F38BE,
  PREFIX_VEX_0F38BF,
  PREFIX_VEX_0F38DB,
  PREFIX_VEX_0F38DC,
  PREFIX_VEX_0F38DD,
  PREFIX_VEX_0F38DE,
  PREFIX_VEX_0F38DF,
  PREFIX_VEX_0F38F2,
  PREFIX_VEX_0F38F3_REG_1,
  PREFIX_VEX_0F38F3_REG_2,
  PREFIX_VEX_0F38F3_REG_3,
  PREFIX_VEX_0F38F5,
  PREFIX_VEX_0F38F6,
  PREFIX_VEX_0F38F7,
  PREFIX_VEX_0F3A00,
  PREFIX_VEX_0F3A01,
  PREFIX_VEX_0F3A02,
  PREFIX_VEX_0F3A04,
  PREFIX_VEX_0F3A05,
  PREFIX_VEX_0F3A06,
  PREFIX_VEX_0F3A08,
  PREFIX_VEX_0F3A09,
  PREFIX_VEX_0F3A0A,
  PREFIX_VEX_0F3A0B,
  PREFIX_VEX_0F3A0C,
  PREFIX_VEX_0F3A0D,
  PREFIX_VEX_0F3A0E,
  PREFIX_VEX_0F3A0F,
  PREFIX_VEX_0F3A14,
  PREFIX_VEX_0F3A15,
  PREFIX_VEX_0F3A16,
  PREFIX_VEX_0F3A17,
  PREFIX_VEX_0F3A18,
  PREFIX_VEX_0F3A19,
  PREFIX_VEX_0F3A1D,
  PREFIX_VEX_0F3A20,
  PREFIX_VEX_0F3A21,
  PREFIX_VEX_0F3A22,
  PREFIX_VEX_0F3A30,
  PREFIX_VEX_0F3A32,
  PREFIX_VEX_0F3A38,
  PREFIX_VEX_0F3A39,
  PREFIX_VEX_0F3A40,
  PREFIX_VEX_0F3A41,
  PREFIX_VEX_0F3A42,
  PREFIX_VEX_0F3A44,
  PREFIX_VEX_0F3A46,
  PREFIX_VEX_0F3A48,
  PREFIX_VEX_0F3A49,
  PREFIX_VEX_0F3A4A,
  PREFIX_VEX_0F3A4B,
  PREFIX_VEX_0F3A4C,
  PREFIX_VEX_0F3A5C,
  PREFIX_VEX_0F3A5D,
  PREFIX_VEX_0F3A5E,
  PREFIX_VEX_0F3A5F,
  PREFIX_VEX_0F3A60,
  PREFIX_VEX_0F3A61,
  PREFIX_VEX_0F3A62,
  PREFIX_VEX_0F3A63,
  PREFIX_VEX_0F3A68,
  PREFIX_VEX_0F3A69,
  PREFIX_VEX_0F3A6A,
  PREFIX_VEX_0F3A6B,
  PREFIX_VEX_0F3A6C,
  PREFIX_VEX_0F3A6D,
  PREFIX_VEX_0F3A6E,
  PREFIX_VEX_0F3A6F,
  PREFIX_VEX_0F3A78,
  PREFIX_VEX_0F3A79,
  PREFIX_VEX_0F3A7A,
  PREFIX_VEX_0F3A7B,
  PREFIX_VEX_0F3A7C,
  PREFIX_VEX_0F3A7D,
  PREFIX_VEX_0F3A7E,
  PREFIX_VEX_0F3A7F,
  PREFIX_VEX_0F3ADF,
  PREFIX_VEX_0F3AF0,

  PREFIX_EVEX_0F10,
  PREFIX_EVEX_0F11,
  PREFIX_EVEX_0F12,
  PREFIX_EVEX_0F13,
  PREFIX_EVEX_0F14,
  PREFIX_EVEX_0F15,
  PREFIX_EVEX_0F16,
  PREFIX_EVEX_0F17,
  PREFIX_EVEX_0F28,
  PREFIX_EVEX_0F29,
  PREFIX_EVEX_0F2A,
  PREFIX_EVEX_0F2B,
  PREFIX_EVEX_0F2C,
  PREFIX_EVEX_0F2D,
  PREFIX_EVEX_0F2E,
  PREFIX_EVEX_0F2F,
  PREFIX_EVEX_0F51,
  PREFIX_EVEX_0F58,
  PREFIX_EVEX_0F59,
  PREFIX_EVEX_0F5A,
  PREFIX_EVEX_0F5B,
  PREFIX_EVEX_0F5C,
  PREFIX_EVEX_0F5D,
  PREFIX_EVEX_0F5E,
  PREFIX_EVEX_0F5F,
  PREFIX_EVEX_0F62,
  PREFIX_EVEX_0F66,
  PREFIX_EVEX_0F6A,
  PREFIX_EVEX_0F6C,
  PREFIX_EVEX_0F6D,
  PREFIX_EVEX_0F6E,
  PREFIX_EVEX_0F6F,
  PREFIX_EVEX_0F70,
  PREFIX_EVEX_0F72_REG_0,
  PREFIX_EVEX_0F72_REG_1,
  PREFIX_EVEX_0F72_REG_2,
  PREFIX_EVEX_0F72_REG_4,
  PREFIX_EVEX_0F72_REG_6,
  PREFIX_EVEX_0F73_REG_2,
  PREFIX_EVEX_0F73_REG_6,
  PREFIX_EVEX_0F76,
  PREFIX_EVEX_0F78,
  PREFIX_EVEX_0F79,
  PREFIX_EVEX_0F7A,
  PREFIX_EVEX_0F7B,
  PREFIX_EVEX_0F7E,
  PREFIX_EVEX_0F7F,
  PREFIX_EVEX_0FC2,
  PREFIX_EVEX_0FC6,
  PREFIX_EVEX_0FD2,
  PREFIX_EVEX_0FD3,
  PREFIX_EVEX_0FD4,
  PREFIX_EVEX_0FD6,
  PREFIX_EVEX_0FDB,
  PREFIX_EVEX_0FDF,
  PREFIX_EVEX_0FE2,
  PREFIX_EVEX_0FE6,
  PREFIX_EVEX_0FE7,
  PREFIX_EVEX_0FEB,
  PREFIX_EVEX_0FEF,
  PREFIX_EVEX_0FF2,
  PREFIX_EVEX_0FF3,
  PREFIX_EVEX_0FF4,
  PREFIX_EVEX_0FFA,
  PREFIX_EVEX_0FFB,
  PREFIX_EVEX_0FFE,
  PREFIX_EVEX_0F380C,
  PREFIX_EVEX_0F380D,
  PREFIX_EVEX_0F3811,
  PREFIX_EVEX_0F3812,
  PREFIX_EVEX_0F3813,
  PREFIX_EVEX_0F3814,
  PREFIX_EVEX_0F3815,
  PREFIX_EVEX_0F3816,
  PREFIX_EVEX_0F3818,
  PREFIX_EVEX_0F3819,
  PREFIX_EVEX_0F381A,
  PREFIX_EVEX_0F381B,
  PREFIX_EVEX_0F381E,
  PREFIX_EVEX_0F381F,
  PREFIX_EVEX_0F3821,
  PREFIX_EVEX_0F3822,
  PREFIX_EVEX_0F3823,
  PREFIX_EVEX_0F3824,
  PREFIX_EVEX_0F3825,
  PREFIX_EVEX_0F3827,
  PREFIX_EVEX_0F3828,
  PREFIX_EVEX_0F3829,
  PREFIX_EVEX_0F382A,
  PREFIX_EVEX_0F382C,
  PREFIX_EVEX_0F382D,
  PREFIX_EVEX_0F3831,
  PREFIX_EVEX_0F3832,
  PREFIX_EVEX_0F3833,
  PREFIX_EVEX_0F3834,
  PREFIX_EVEX_0F3835,
  PREFIX_EVEX_0F3836,
  PREFIX_EVEX_0F3837,
  PREFIX_EVEX_0F3839,
  PREFIX_EVEX_0F383A,
  PREFIX_EVEX_0F383B,
  PREFIX_EVEX_0F383D,
  PREFIX_EVEX_0F383F,
  PREFIX_EVEX_0F3840,
  PREFIX_EVEX_0F3842,
  PREFIX_EVEX_0F3843,
  PREFIX_EVEX_0F3844,
  PREFIX_EVEX_0F3845,
  PREFIX_EVEX_0F3846,
  PREFIX_EVEX_0F3847,
  PREFIX_EVEX_0F384C,
  PREFIX_EVEX_0F384D,
  PREFIX_EVEX_0F384E,
  PREFIX_EVEX_0F384F,
  PREFIX_EVEX_0F3858,
  PREFIX_EVEX_0F3859,
  PREFIX_EVEX_0F385A,
  PREFIX_EVEX_0F385B,
  PREFIX_EVEX_0F3864,
  PREFIX_EVEX_0F3865,
  PREFIX_EVEX_0F3876,
  PREFIX_EVEX_0F3877,
  PREFIX_EVEX_0F387C,
  PREFIX_EVEX_0F387E,
  PREFIX_EVEX_0F387F,
  PREFIX_EVEX_0F3888,
  PREFIX_EVEX_0F3889,
  PREFIX_EVEX_0F388A,
  PREFIX_EVEX_0F388B,
  PREFIX_EVEX_0F3890,
  PREFIX_EVEX_0F3891,
  PREFIX_EVEX_0F3892,
  PREFIX_EVEX_0F3893,
  PREFIX_EVEX_0F3896,
  PREFIX_EVEX_0F3897,
  PREFIX_EVEX_0F3898,
  PREFIX_EVEX_0F3899,
  PREFIX_EVEX_0F389A,
  PREFIX_EVEX_0F389B,
  PREFIX_EVEX_0F389C,
  PREFIX_EVEX_0F389D,
  PREFIX_EVEX_0F389E,
  PREFIX_EVEX_0F389F,
  PREFIX_EVEX_0F38A0,
  PREFIX_EVEX_0F38A1,
  PREFIX_EVEX_0F38A2,
  PREFIX_EVEX_0F38A3,
  PREFIX_EVEX_0F38A6,
  PREFIX_EVEX_0F38A7,
  PREFIX_EVEX_0F38A8,
  PREFIX_EVEX_0F38A9,
  PREFIX_EVEX_0F38AA,
  PREFIX_EVEX_0F38AB,
  PREFIX_EVEX_0F38AC,
  PREFIX_EVEX_0F38AD,
  PREFIX_EVEX_0F38AE,
  PREFIX_EVEX_0F38AF,
  PREFIX_EVEX_0F38B6,
  PREFIX_EVEX_0F38B7,
  PREFIX_EVEX_0F38B8,
  PREFIX_EVEX_0F38B9,
  PREFIX_EVEX_0F38BA,
  PREFIX_EVEX_0F38BB,
  PREFIX_EVEX_0F38BC,
  PREFIX_EVEX_0F38BD,
  PREFIX_EVEX_0F38BE,
  PREFIX_EVEX_0F38BF,
  PREFIX_EVEX_0F38C4,
  PREFIX_EVEX_0F38C6_REG_1,
  PREFIX_EVEX_0F38C6_REG_2,
  PREFIX_EVEX_0F38C6_REG_5,
  PREFIX_EVEX_0F38C6_REG_6,
  PREFIX_EVEX_0F38C7_REG_1,
  PREFIX_EVEX_0F38C7_REG_2,
  PREFIX_EVEX_0F38C7_REG_5,
  PREFIX_EVEX_0F38C7_REG_6,
  PREFIX_EVEX_0F38C8,
  PREFIX_EVEX_0F38CA,
  PREFIX_EVEX_0F38CB,
  PREFIX_EVEX_0F38CC,
  PREFIX_EVEX_0F38CD,

  PREFIX_EVEX_0F3A00,
  PREFIX_EVEX_0F3A01,
  PREFIX_EVEX_0F3A03,
  PREFIX_EVEX_0F3A04,
  PREFIX_EVEX_0F3A05,
  PREFIX_EVEX_0F3A08,
  PREFIX_EVEX_0F3A09,
  PREFIX_EVEX_0F3A0A,
  PREFIX_EVEX_0F3A0B,
  PREFIX_EVEX_0F3A17,
  PREFIX_EVEX_0F3A18,
  PREFIX_EVEX_0F3A19,
  PREFIX_EVEX_0F3A1A,
  PREFIX_EVEX_0F3A1B,
  PREFIX_EVEX_0F3A1D,
  PREFIX_EVEX_0F3A1E,
  PREFIX_EVEX_0F3A1F,
  PREFIX_EVEX_0F3A21,
  PREFIX_EVEX_0F3A23,
  PREFIX_EVEX_0F3A25,
  PREFIX_EVEX_0F3A26,
  PREFIX_EVEX_0F3A27,
  PREFIX_EVEX_0F3A38,
  PREFIX_EVEX_0F3A39,
  PREFIX_EVEX_0F3A3A,
  PREFIX_EVEX_0F3A3B,
  PREFIX_EVEX_0F3A43,
  PREFIX_EVEX_0F3A54,
  PREFIX_EVEX_0F3A55,
};

enum
{
  X86_64_06 = 0,
  X86_64_07,
  X86_64_0D,
  X86_64_16,
  X86_64_17,
  X86_64_1E,
  X86_64_1F,
  X86_64_27,
  X86_64_2F,
  X86_64_37,
  X86_64_3F,
  X86_64_60,
  X86_64_61,
  X86_64_62,
  X86_64_63,
  X86_64_6D,
  X86_64_6F,
  X86_64_9A,
  X86_64_C4,
  X86_64_C5,
  X86_64_CE,
  X86_64_D4,
  X86_64_D5,
  X86_64_EA,
  X86_64_0F01_REG_0,
  X86_64_0F01_REG_1,
  X86_64_0F01_REG_2,
  X86_64_0F01_REG_3
};

enum
{
  THREE_BYTE_0F38 = 0,
  THREE_BYTE_0F3A,
  THREE_BYTE_0F7A
};

enum
{
  XOP_08 = 0,
  XOP_09,
  XOP_0A
};

enum
{
  VEX_0F = 0,
  VEX_0F38,
  VEX_0F3A
};

enum
{
  EVEX_0F = 0,
  EVEX_0F38,
  EVEX_0F3A
};

enum
{
  VEX_LEN_0F10_P_1 = 0,
  VEX_LEN_0F10_P_3,
  VEX_LEN_0F11_P_1,
  VEX_LEN_0F11_P_3,
  VEX_LEN_0F12_P_0_M_0,
  VEX_LEN_0F12_P_0_M_1,
  VEX_LEN_0F12_P_2,
  VEX_LEN_0F13_M_0,
  VEX_LEN_0F16_P_0_M_0,
  VEX_LEN_0F16_P_0_M_1,
  VEX_LEN_0F16_P_2,
  VEX_LEN_0F17_M_0,
  VEX_LEN_0F2A_P_1,
  VEX_LEN_0F2A_P_3,
  VEX_LEN_0F2C_P_1,
  VEX_LEN_0F2C_P_3,
  VEX_LEN_0F2D_P_1,
  VEX_LEN_0F2D_P_3,
  VEX_LEN_0F2E_P_0,
  VEX_LEN_0F2E_P_2,
  VEX_LEN_0F2F_P_0,
  VEX_LEN_0F2F_P_2,
  VEX_LEN_0F41_P_0,
  VEX_LEN_0F42_P_0,
  VEX_LEN_0F44_P_0,
  VEX_LEN_0F45_P_0,
  VEX_LEN_0F46_P_0,
  VEX_LEN_0F47_P_0,
  VEX_LEN_0F4B_P_2,
  VEX_LEN_0F51_P_1,
  VEX_LEN_0F51_P_3,
  VEX_LEN_0F52_P_1,
  VEX_LEN_0F53_P_1,
  VEX_LEN_0F58_P_1,
  VEX_LEN_0F58_P_3,
  VEX_LEN_0F59_P_1,
  VEX_LEN_0F59_P_3,
  VEX_LEN_0F5A_P_1,
  VEX_LEN_0F5A_P_3,
  VEX_LEN_0F5C_P_1,
  VEX_LEN_0F5C_P_3,
  VEX_LEN_0F5D_P_1,
  VEX_LEN_0F5D_P_3,
  VEX_LEN_0F5E_P_1,
  VEX_LEN_0F5E_P_3,
  VEX_LEN_0F5F_P_1,
  VEX_LEN_0F5F_P_3,
  VEX_LEN_0F6E_P_2,
  VEX_LEN_0F7E_P_1,
  VEX_LEN_0F7E_P_2,
  VEX_LEN_0F90_P_0,
  VEX_LEN_0F91_P_0,
  VEX_LEN_0F92_P_0,
  VEX_LEN_0F93_P_0,
  VEX_LEN_0F98_P_0,
  VEX_LEN_0FAE_R_2_M_0,
  VEX_LEN_0FAE_R_3_M_0,
  VEX_LEN_0FC2_P_1,
  VEX_LEN_0FC2_P_3,
  VEX_LEN_0FC4_P_2,
  VEX_LEN_0FC5_P_2,
  VEX_LEN_0FD6_P_2,
  VEX_LEN_0FF7_P_2,
  VEX_LEN_0F3816_P_2,
  VEX_LEN_0F3819_P_2,
  VEX_LEN_0F381A_P_2_M_0,
  VEX_LEN_0F3836_P_2,
  VEX_LEN_0F3841_P_2,
  VEX_LEN_0F385A_P_2_M_0,
  VEX_LEN_0F38DB_P_2,
  VEX_LEN_0F38DC_P_2,
  VEX_LEN_0F38DD_P_2,
  VEX_LEN_0F38DE_P_2,
  VEX_LEN_0F38DF_P_2,
  VEX_LEN_0F38F2_P_0,
  VEX_LEN_0F38F3_R_1_P_0,
  VEX_LEN_0F38F3_R_2_P_0,
  VEX_LEN_0F38F3_R_3_P_0,
  VEX_LEN_0F38F5_P_0,
  VEX_LEN_0F38F5_P_1,
  VEX_LEN_0F38F5_P_3,
  VEX_LEN_0F38F6_P_3,
  VEX_LEN_0F38F7_P_0,
  VEX_LEN_0F38F7_P_1,
  VEX_LEN_0F38F7_P_2,
  VEX_LEN_0F38F7_P_3,
  VEX_LEN_0F3A00_P_2,
  VEX_LEN_0F3A01_P_2,
  VEX_LEN_0F3A06_P_2,
  VEX_LEN_0F3A0A_P_2,
  VEX_LEN_0F3A0B_P_2,
  VEX_LEN_0F3A14_P_2,
  VEX_LEN_0F3A15_P_2,
  VEX_LEN_0F3A16_P_2,
  VEX_LEN_0F3A17_P_2,
  VEX_LEN_0F3A18_P_2,
  VEX_LEN_0F3A19_P_2,
  VEX_LEN_0F3A20_P_2,
  VEX_LEN_0F3A21_P_2,
  VEX_LEN_0F3A22_P_2,
  VEX_LEN_0F3A30_P_2,
  VEX_LEN_0F3A32_P_2,
  VEX_LEN_0F3A38_P_2,
  VEX_LEN_0F3A39_P_2,
  VEX_LEN_0F3A41_P_2,
  VEX_LEN_0F3A44_P_2,
  VEX_LEN_0F3A46_P_2,
  VEX_LEN_0F3A60_P_2,
  VEX_LEN_0F3A61_P_2,
  VEX_LEN_0F3A62_P_2,
  VEX_LEN_0F3A63_P_2,
  VEX_LEN_0F3A6A_P_2,
  VEX_LEN_0F3A6B_P_2,
  VEX_LEN_0F3A6E_P_2,
  VEX_LEN_0F3A6F_P_2,
  VEX_LEN_0F3A7A_P_2,
  VEX_LEN_0F3A7B_P_2,
  VEX_LEN_0F3A7E_P_2,
  VEX_LEN_0F3A7F_P_2,
  VEX_LEN_0F3ADF_P_2,
  VEX_LEN_0F3AF0_P_3,
  VEX_LEN_0FXOP_08_CC,
  VEX_LEN_0FXOP_08_CD,
  VEX_LEN_0FXOP_08_CE,
  VEX_LEN_0FXOP_08_CF,
  VEX_LEN_0FXOP_08_EC,
  VEX_LEN_0FXOP_08_ED,
  VEX_LEN_0FXOP_08_EE,
  VEX_LEN_0FXOP_08_EF,
  VEX_LEN_0FXOP_09_80,
  VEX_LEN_0FXOP_09_81
};

enum
{
  VEX_W_0F10_P_0 = 0,
  VEX_W_0F10_P_1,
  VEX_W_0F10_P_2,
  VEX_W_0F10_P_3,
  VEX_W_0F11_P_0,
  VEX_W_0F11_P_1,
  VEX_W_0F11_P_2,
  VEX_W_0F11_P_3,
  VEX_W_0F12_P_0_M_0,
  VEX_W_0F12_P_0_M_1,
  VEX_W_0F12_P_1,
  VEX_W_0F12_P_2,
  VEX_W_0F12_P_3,
  VEX_W_0F13_M_0,
  VEX_W_0F14,
  VEX_W_0F15,
  VEX_W_0F16_P_0_M_0,
  VEX_W_0F16_P_0_M_1,
  VEX_W_0F16_P_1,
  VEX_W_0F16_P_2,
  VEX_W_0F17_M_0,
  VEX_W_0F28,
  VEX_W_0F29,
  VEX_W_0F2B_M_0,
  VEX_W_0F2E_P_0,
  VEX_W_0F2E_P_2,
  VEX_W_0F2F_P_0,
  VEX_W_0F2F_P_2,
  VEX_W_0F41_P_0_LEN_1,
  VEX_W_0F42_P_0_LEN_1,
  VEX_W_0F44_P_0_LEN_0,
  VEX_W_0F45_P_0_LEN_1,
  VEX_W_0F46_P_0_LEN_1,
  VEX_W_0F47_P_0_LEN_1,
  VEX_W_0F4B_P_2_LEN_1,
  VEX_W_0F50_M_0,
  VEX_W_0F51_P_0,
  VEX_W_0F51_P_1,
  VEX_W_0F51_P_2,
  VEX_W_0F51_P_3,
  VEX_W_0F52_P_0,
  VEX_W_0F52_P_1,
  VEX_W_0F53_P_0,
  VEX_W_0F53_P_1,
  VEX_W_0F58_P_0,
  VEX_W_0F58_P_1,
  VEX_W_0F58_P_2,
  VEX_W_0F58_P_3,
  VEX_W_0F59_P_0,
  VEX_W_0F59_P_1,
  VEX_W_0F59_P_2,
  VEX_W_0F59_P_3,
  VEX_W_0F5A_P_0,
  VEX_W_0F5A_P_1,
  VEX_W_0F5A_P_3,
  VEX_W_0F5B_P_0,
  VEX_W_0F5B_P_1,
  VEX_W_0F5B_P_2,
  VEX_W_0F5C_P_0,
  VEX_W_0F5C_P_1,
  VEX_W_0F5C_P_2,
  VEX_W_0F5C_P_3,
  VEX_W_0F5D_P_0,
  VEX_W_0F5D_P_1,
  VEX_W_0F5D_P_2,
  VEX_W_0F5D_P_3,
  VEX_W_0F5E_P_0,
  VEX_W_0F5E_P_1,
  VEX_W_0F5E_P_2,
  VEX_W_0F5E_P_3,
  VEX_W_0F5F_P_0,
  VEX_W_0F5F_P_1,
  VEX_W_0F5F_P_2,
  VEX_W_0F5F_P_3,
  VEX_W_0F60_P_2,
  VEX_W_0F61_P_2,
  VEX_W_0F62_P_2,
  VEX_W_0F63_P_2,
  VEX_W_0F64_P_2,
  VEX_W_0F65_P_2,
  VEX_W_0F66_P_2,
  VEX_W_0F67_P_2,
  VEX_W_0F68_P_2,
  VEX_W_0F69_P_2,
  VEX_W_0F6A_P_2,
  VEX_W_0F6B_P_2,
  VEX_W_0F6C_P_2,
  VEX_W_0F6D_P_2,
  VEX_W_0F6F_P_1,
  VEX_W_0F6F_P_2,
  VEX_W_0F70_P_1,
  VEX_W_0F70_P_2,
  VEX_W_0F70_P_3,
  VEX_W_0F71_R_2_P_2,
  VEX_W_0F71_R_4_P_2,
  VEX_W_0F71_R_6_P_2,
  VEX_W_0F72_R_2_P_2,
  VEX_W_0F72_R_4_P_2,
  VEX_W_0F72_R_6_P_2,
  VEX_W_0F73_R_2_P_2,
  VEX_W_0F73_R_3_P_2,
  VEX_W_0F73_R_6_P_2,
  VEX_W_0F73_R_7_P_2,
  VEX_W_0F74_P_2,
  VEX_W_0F75_P_2,
  VEX_W_0F76_P_2,
  VEX_W_0F77_P_0,
  VEX_W_0F7C_P_2,
  VEX_W_0F7C_P_3,
  VEX_W_0F7D_P_2,
  VEX_W_0F7D_P_3,
  VEX_W_0F7E_P_1,
  VEX_W_0F7F_P_1,
  VEX_W_0F7F_P_2,
  VEX_W_0F90_P_0_LEN_0,
  VEX_W_0F91_P_0_LEN_0,
  VEX_W_0F92_P_0_LEN_0,
  VEX_W_0F93_P_0_LEN_0,
  VEX_W_0F98_P_0_LEN_0,
  VEX_W_0FAE_R_2_M_0,
  VEX_W_0FAE_R_3_M_0,
  VEX_W_0FC2_P_0,
  VEX_W_0FC2_P_1,
  VEX_W_0FC2_P_2,
  VEX_W_0FC2_P_3,
  VEX_W_0FC4_P_2,
  VEX_W_0FC5_P_2,
  VEX_W_0FD0_P_2,
  VEX_W_0FD0_P_3,
  VEX_W_0FD1_P_2,
  VEX_W_0FD2_P_2,
  VEX_W_0FD3_P_2,
  VEX_W_0FD4_P_2,
  VEX_W_0FD5_P_2,
  VEX_W_0FD6_P_2,
  VEX_W_0FD7_P_2_M_1,
  VEX_W_0FD8_P_2,
  VEX_W_0FD9_P_2,
  VEX_W_0FDA_P_2,
  VEX_W_0FDB_P_2,
  VEX_W_0FDC_P_2,
  VEX_W_0FDD_P_2,
  VEX_W_0FDE_P_2,
  VEX_W_0FDF_P_2,
  VEX_W_0FE0_P_2,
  VEX_W_0FE1_P_2,
  VEX_W_0FE2_P_2,
  VEX_W_0FE3_P_2,
  VEX_W_0FE4_P_2,
  VEX_W_0FE5_P_2,
  VEX_W_0FE6_P_1,
  VEX_W_0FE6_P_2,
  VEX_W_0FE6_P_3,
  VEX_W_0FE7_P_2_M_0,
  VEX_W_0FE8_P_2,
  VEX_W_0FE9_P_2,
  VEX_W_0FEA_P_2,
  VEX_W_0FEB_P_2,
  VEX_W_0FEC_P_2,
  VEX_W_0FED_P_2,
  VEX_W_0FEE_P_2,
  VEX_W_0FEF_P_2,
  VEX_W_0FF0_P_3_M_0,
  VEX_W_0FF1_P_2,
  VEX_W_0FF2_P_2,
  VEX_W_0FF3_P_2,
  VEX_W_0FF4_P_2,
  VEX_W_0FF5_P_2,
  VEX_W_0FF6_P_2,
  VEX_W_0FF7_P_2,
  VEX_W_0FF8_P_2,
  VEX_W_0FF9_P_2,
  VEX_W_0FFA_P_2,
  VEX_W_0FFB_P_2,
  VEX_W_0FFC_P_2,
  VEX_W_0FFD_P_2,
  VEX_W_0FFE_P_2,
  VEX_W_0F3800_P_2,
  VEX_W_0F3801_P_2,
  VEX_W_0F3802_P_2,
  VEX_W_0F3803_P_2,
  VEX_W_0F3804_P_2,
  VEX_W_0F3805_P_2,
  VEX_W_0F3806_P_2,
  VEX_W_0F3807_P_2,
  VEX_W_0F3808_P_2,
  VEX_W_0F3809_P_2,
  VEX_W_0F380A_P_2,
  VEX_W_0F380B_P_2,
  VEX_W_0F380C_P_2,
  VEX_W_0F380D_P_2,
  VEX_W_0F380E_P_2,
  VEX_W_0F380F_P_2,
  VEX_W_0F3816_P_2,
  VEX_W_0F3817_P_2,
  VEX_W_0F3818_P_2,
  VEX_W_0F3819_P_2,
  VEX_W_0F381A_P_2_M_0,
  VEX_W_0F381C_P_2,
  VEX_W_0F381D_P_2,
  VEX_W_0F381E_P_2,
  VEX_W_0F3820_P_2,
  VEX_W_0F3821_P_2,
  VEX_W_0F3822_P_2,
  VEX_W_0F3823_P_2,
  VEX_W_0F3824_P_2,
  VEX_W_0F3825_P_2,
  VEX_W_0F3828_P_2,
  VEX_W_0F3829_P_2,
  VEX_W_0F382A_P_2_M_0,
  VEX_W_0F382B_P_2,
  VEX_W_0F382C_P_2_M_0,
  VEX_W_0F382D_P_2_M_0,
  VEX_W_0F382E_P_2_M_0,
  VEX_W_0F382F_P_2_M_0,
  VEX_W_0F3830_P_2,
  VEX_W_0F3831_P_2,
  VEX_W_0F3832_P_2,
  VEX_W_0F3833_P_2,
  VEX_W_0F3834_P_2,
  VEX_W_0F3835_P_2,
  VEX_W_0F3836_P_2,
  VEX_W_0F3837_P_2,
  VEX_W_0F3838_P_2,
  VEX_W_0F3839_P_2,
  VEX_W_0F383A_P_2,
  VEX_W_0F383B_P_2,
  VEX_W_0F383C_P_2,
  VEX_W_0F383D_P_2,
  VEX_W_0F383E_P_2,
  VEX_W_0F383F_P_2,
  VEX_W_0F3840_P_2,
  VEX_W_0F3841_P_2,
  VEX_W_0F3846_P_2,
  VEX_W_0F3858_P_2,
  VEX_W_0F3859_P_2,
  VEX_W_0F385A_P_2_M_0,
  VEX_W_0F3878_P_2,
  VEX_W_0F3879_P_2,
  VEX_W_0F38DB_P_2,
  VEX_W_0F38DC_P_2,
  VEX_W_0F38DD_P_2,
  VEX_W_0F38DE_P_2,
  VEX_W_0F38DF_P_2,
  VEX_W_0F3A00_P_2,
  VEX_W_0F3A01_P_2,
  VEX_W_0F3A02_P_2,
  VEX_W_0F3A04_P_2,
  VEX_W_0F3A05_P_2,
  VEX_W_0F3A06_P_2,
  VEX_W_0F3A08_P_2,
  VEX_W_0F3A09_P_2,
  VEX_W_0F3A0A_P_2,
  VEX_W_0F3A0B_P_2,
  VEX_W_0F3A0C_P_2,
  VEX_W_0F3A0D_P_2,
  VEX_W_0F3A0E_P_2,
  VEX_W_0F3A0F_P_2,
  VEX_W_0F3A14_P_2,
  VEX_W_0F3A15_P_2,
  VEX_W_0F3A18_P_2,
  VEX_W_0F3A19_P_2,
  VEX_W_0F3A20_P_2,
  VEX_W_0F3A21_P_2,
  VEX_W_0F3A30_P_2_LEN_0,
  VEX_W_0F3A32_P_2_LEN_0,
  VEX_W_0F3A38_P_2,
  VEX_W_0F3A39_P_2,
  VEX_W_0F3A40_P_2,
  VEX_W_0F3A41_P_2,
  VEX_W_0F3A42_P_2,
  VEX_W_0F3A44_P_2,
  VEX_W_0F3A46_P_2,
  VEX_W_0F3A48_P_2,
  VEX_W_0F3A49_P_2,
  VEX_W_0F3A4A_P_2,
  VEX_W_0F3A4B_P_2,
  VEX_W_0F3A4C_P_2,
  VEX_W_0F3A60_P_2,
  VEX_W_0F3A61_P_2,
  VEX_W_0F3A62_P_2,
  VEX_W_0F3A63_P_2,
  VEX_W_0F3ADF_P_2,

  EVEX_W_0F10_P_0,
  EVEX_W_0F10_P_1_M_0,
  EVEX_W_0F10_P_1_M_1,
  EVEX_W_0F10_P_2,
  EVEX_W_0F10_P_3_M_0,
  EVEX_W_0F10_P_3_M_1,
  EVEX_W_0F11_P_0,
  EVEX_W_0F11_P_1_M_0,
  EVEX_W_0F11_P_1_M_1,
  EVEX_W_0F11_P_2,
  EVEX_W_0F11_P_3_M_0,
  EVEX_W_0F11_P_3_M_1,
  EVEX_W_0F12_P_0_M_0,
  EVEX_W_0F12_P_0_M_1,
  EVEX_W_0F12_P_1,
  EVEX_W_0F12_P_2,
  EVEX_W_0F12_P_3,
  EVEX_W_0F13_P_0,
  EVEX_W_0F13_P_2,
  EVEX_W_0F14_P_0,
  EVEX_W_0F14_P_2,
  EVEX_W_0F15_P_0,
  EVEX_W_0F15_P_2,
  EVEX_W_0F16_P_0_M_0,
  EVEX_W_0F16_P_0_M_1,
  EVEX_W_0F16_P_1,
  EVEX_W_0F16_P_2,
  EVEX_W_0F17_P_0,
  EVEX_W_0F17_P_2,
  EVEX_W_0F28_P_0,
  EVEX_W_0F28_P_2,
  EVEX_W_0F29_P_0,
  EVEX_W_0F29_P_2,
  EVEX_W_0F2A_P_1,
  EVEX_W_0F2A_P_3,
  EVEX_W_0F2B_P_0,
  EVEX_W_0F2B_P_2,
  EVEX_W_0F2E_P_0,
  EVEX_W_0F2E_P_2,
  EVEX_W_0F2F_P_0,
  EVEX_W_0F2F_P_2,
  EVEX_W_0F51_P_0,
  EVEX_W_0F51_P_1,
  EVEX_W_0F51_P_2,
  EVEX_W_0F51_P_3,
  EVEX_W_0F58_P_0,
  EVEX_W_0F58_P_1,
  EVEX_W_0F58_P_2,
  EVEX_W_0F58_P_3,
  EVEX_W_0F59_P_0,
  EVEX_W_0F59_P_1,
  EVEX_W_0F59_P_2,
  EVEX_W_0F59_P_3,
  EVEX_W_0F5A_P_0,
  EVEX_W_0F5A_P_1,
  EVEX_W_0F5A_P_2,
  EVEX_W_0F5A_P_3,
  EVEX_W_0F5B_P_0,
  EVEX_W_0F5B_P_1,
  EVEX_W_0F5B_P_2,
  EVEX_W_0F5C_P_0,
  EVEX_W_0F5C_P_1,
  EVEX_W_0F5C_P_2,
  EVEX_W_0F5C_P_3,
  EVEX_W_0F5D_P_0,
  EVEX_W_0F5D_P_1,
  EVEX_W_0F5D_P_2,
  EVEX_W_0F5D_P_3,
  EVEX_W_0F5E_P_0,
  EVEX_W_0F5E_P_1,
  EVEX_W_0F5E_P_2,
  EVEX_W_0F5E_P_3,
  EVEX_W_0F5F_P_0,
  EVEX_W_0F5F_P_1,
  EVEX_W_0F5F_P_2,
  EVEX_W_0F5F_P_3,
  EVEX_W_0F62_P_2,
  EVEX_W_0F66_P_2,
  EVEX_W_0F6A_P_2,
  EVEX_W_0F6C_P_2,
  EVEX_W_0F6D_P_2,
  EVEX_W_0F6E_P_2,
  EVEX_W_0F6F_P_1,
  EVEX_W_0F6F_P_2,
  EVEX_W_0F70_P_2,
  EVEX_W_0F72_R_2_P_2,
  EVEX_W_0F72_R_6_P_2,
  EVEX_W_0F73_R_2_P_2,
  EVEX_W_0F73_R_6_P_2,
  EVEX_W_0F76_P_2,
  EVEX_W_0F78_P_0,
  EVEX_W_0F79_P_0,
  EVEX_W_0F7A_P_1,
  EVEX_W_0F7A_P_3,
  EVEX_W_0F7B_P_1,
  EVEX_W_0F7B_P_3,
  EVEX_W_0F7E_P_1,
  EVEX_W_0F7E_P_2,
  EVEX_W_0F7F_P_1,
  EVEX_W_0F7F_P_2,
  EVEX_W_0FC2_P_0,
  EVEX_W_0FC2_P_1,
  EVEX_W_0FC2_P_2,
  EVEX_W_0FC2_P_3,
  EVEX_W_0FC6_P_0,
  EVEX_W_0FC6_P_2,
  EVEX_W_0FD2_P_2,
  EVEX_W_0FD3_P_2,
  EVEX_W_0FD4_P_2,
  EVEX_W_0FD6_P_2,
  EVEX_W_0FE6_P_1,
  EVEX_W_0FE6_P_2,
  EVEX_W_0FE6_P_3,
  EVEX_W_0FE7_P_2,
  EVEX_W_0FF2_P_2,
  EVEX_W_0FF3_P_2,
  EVEX_W_0FF4_P_2,
  EVEX_W_0FFA_P_2,
  EVEX_W_0FFB_P_2,
  EVEX_W_0FFE_P_2,
  EVEX_W_0F380C_P_2,
  EVEX_W_0F380D_P_2,
  EVEX_W_0F3811_P_1,
  EVEX_W_0F3812_P_1,
  EVEX_W_0F3813_P_1,
  EVEX_W_0F3813_P_2,
  EVEX_W_0F3814_P_1,
  EVEX_W_0F3815_P_1,
  EVEX_W_0F3818_P_2,
  EVEX_W_0F3819_P_2,
  EVEX_W_0F381A_P_2,
  EVEX_W_0F381B_P_2,
  EVEX_W_0F381E_P_2,
  EVEX_W_0F381F_P_2,
  EVEX_W_0F3821_P_1,
  EVEX_W_0F3822_P_1,
  EVEX_W_0F3823_P_1,
  EVEX_W_0F3824_P_1,
  EVEX_W_0F3825_P_1,
  EVEX_W_0F3825_P_2,
  EVEX_W_0F3828_P_2,
  EVEX_W_0F3829_P_2,
  EVEX_W_0F382A_P_1,
  EVEX_W_0F382A_P_2,
  EVEX_W_0F3831_P_1,
  EVEX_W_0F3832_P_1,
  EVEX_W_0F3833_P_1,
  EVEX_W_0F3834_P_1,
  EVEX_W_0F3835_P_1,
  EVEX_W_0F3835_P_2,
  EVEX_W_0F3837_P_2,
  EVEX_W_0F383A_P_1,
  EVEX_W_0F3840_P_2,
  EVEX_W_0F3858_P_2,
  EVEX_W_0F3859_P_2,
  EVEX_W_0F385A_P_2,
  EVEX_W_0F385B_P_2,
  EVEX_W_0F3891_P_2,
  EVEX_W_0F3893_P_2,
  EVEX_W_0F38A1_P_2,
  EVEX_W_0F38A3_P_2,
  EVEX_W_0F38C7_R_1_P_2,
  EVEX_W_0F38C7_R_2_P_2,
  EVEX_W_0F38C7_R_5_P_2,
  EVEX_W_0F38C7_R_6_P_2,

  EVEX_W_0F3A00_P_2,
  EVEX_W_0F3A01_P_2,
  EVEX_W_0F3A04_P_2,
  EVEX_W_0F3A05_P_2,
  EVEX_W_0F3A08_P_2,
  EVEX_W_0F3A09_P_2,
  EVEX_W_0F3A0A_P_2,
  EVEX_W_0F3A0B_P_2,
  EVEX_W_0F3A18_P_2,
  EVEX_W_0F3A19_P_2,
  EVEX_W_0F3A1A_P_2,
  EVEX_W_0F3A1B_P_2,
  EVEX_W_0F3A1D_P_2,
  EVEX_W_0F3A21_P_2,
  EVEX_W_0F3A23_P_2,
  EVEX_W_0F3A38_P_2,
  EVEX_W_0F3A39_P_2,
  EVEX_W_0F3A3A_P_2,
  EVEX_W_0F3A3B_P_2,
  EVEX_W_0F3A43_P_2,
};

typedef void (*op_rtn) (int bytemode, int sizeflag);

struct dis386 {
  const char *name;
  struct
    {
      op_rtn rtn;
      int bytemode;
    } op[MAX_OPERANDS];
};

/* Upper case letters in the instruction names here are macros.
   'A' => print 'b' if no register operands or suffix_always is true
   'B' => print 'b' if suffix_always is true
   'C' => print 's' or 'l' ('w' or 'd' in Intel mode) depending on operand
	  size prefix
   'D' => print 'w' if no register operands or 'w', 'l' or 'q', if
	  suffix_always is true
   'E' => print 'e' if 32-bit form of jcxz
   'F' => print 'w' or 'l' depending on address size prefix (loop insns)
   'G' => print 'w' or 'l' depending on operand size prefix (i/o insns)
   'H' => print ",pt" or ",pn" branch hint
   'I' => honor following macro letter even in Intel mode (implemented only
	  for some of the macro letters)
   'J' => print 'l'
   'K' => print 'd' or 'q' if rex prefix is present.
   'L' => print 'l' if suffix_always is true
   'M' => print 'r' if intel_mnemonic is false.
   'N' => print 'n' if instruction has no wait "prefix"
   'O' => print 'd' or 'o' (or 'q' in Intel mode)
   'P' => print 'w', 'l' or 'q' if instruction has an operand size prefix,
	  or suffix_always is true.  print 'q' if rex prefix is present.
   'Q' => print 'w', 'l' or 'q' for memory operand or suffix_always
	  is true
   'R' => print 'w', 'l' or 'q' ('d' for 'l' and 'e' in Intel mode)
   'S' => print 'w', 'l' or 'q' if suffix_always is true
   'T' => print 'q' in 64bit mode and behave as 'P' otherwise
   'U' => print 'q' in 64bit mode and behave as 'Q' otherwise
   'V' => print 'q' in 64bit mode and behave as 'S' otherwise
   'W' => print 'b', 'w' or 'l' ('d' in Intel mode)
   'X' => print 's', 'd' depending on data16 prefix (for XMM)
   'Y' => 'q' if instruction has an REX 64bit overwrite prefix and
	  suffix_always is true.
   'Z' => print 'q' in 64bit mode and behave as 'L' otherwise
   '!' => change condition from true to false or from false to true.
   '%' => add 1 upper case letter to the macro.

   2 upper case letter macros:
   "XY" => print 'x' or 'y' if no register operands or suffix_always
	   is true.
   "XW" => print 's', 'd' depending on the VEX.W bit (for FMA)
   "LQ" => print 'l' ('d' in Intel mode) or 'q' for memory operand
	   or suffix_always is true
   "LB" => print "abs" in 64bit mode and behave as 'B' otherwise
   "LS" => print "abs" in 64bit mode and behave as 'S' otherwise
   "LV" => print "abs" for 64bit operand and behave as 'S' otherwise
   "LW" => print 'd', 'q' depending on the VEX.W bit

   Many of the above letters print nothing in Intel mode.  See "putop"
   for the details.

   Braces '{' and '}', and vertical bars '|', indicate alternative
   mnemonic strings for AT&T and Intel.  */

static const struct dis386 dis386[] = {
  /* 00 */
  { "addB",		{ Ebh1, Gb } },
  { "addS",		{ Evh1, Gv } },
  { "addB",		{ Gb, EbS } },
  { "addS",		{ Gv, EvS } },
  { "addB",		{ AL, Ib } },
  { "addS",		{ eAX, Iv } },
  { X86_64_TABLE (X86_64_06) },
  { X86_64_TABLE (X86_64_07) },
  /* 08 */
  { "orB",		{ Ebh1, Gb } },
  { "orS",		{ Evh1, Gv } },
  { "orB",		{ Gb, EbS } },
  { "orS",		{ Gv, EvS } },
  { "orB",		{ AL, Ib } },
  { "orS",		{ eAX, Iv } },
  { X86_64_TABLE (X86_64_0D) },
  { Bad_Opcode },	/* 0x0f extended opcode escape */
  /* 10 */
  { "adcB",		{ Ebh1, Gb } },
  { "adcS",		{ Evh1, Gv } },
  { "adcB",		{ Gb, EbS } },
  { "adcS",		{ Gv, EvS } },
  { "adcB",		{ AL, Ib } },
  { "adcS",		{ eAX, Iv } },
  { X86_64_TABLE (X86_64_16) },
  { X86_64_TABLE (X86_64_17) },
  /* 18 */
  { "sbbB",		{ Ebh1, Gb } },
  { "sbbS",		{ Evh1, Gv } },
  { "sbbB",		{ Gb, EbS } },
  { "sbbS",		{ Gv, EvS } },
  { "sbbB",		{ AL, Ib } },
  { "sbbS",		{ eAX, Iv } },
  { X86_64_TABLE (X86_64_1E) },
  { X86_64_TABLE (X86_64_1F) },
  /* 20 */
  { "andB",		{ Ebh1, Gb } },
  { "andS",		{ Evh1, Gv } },
  { "andB",		{ Gb, EbS } },
  { "andS",		{ Gv, EvS } },
  { "andB",		{ AL, Ib } },
  { "andS",		{ eAX, Iv } },
  { Bad_Opcode },	/* SEG ES prefix */
  { X86_64_TABLE (X86_64_27) },
  /* 28 */
  { "subB",		{ Ebh1, Gb } },
  { "subS",		{ Evh1, Gv } },
  { "subB",		{ Gb, EbS } },
  { "subS",		{ Gv, EvS } },
  { "subB",		{ AL, Ib } },
  { "subS",		{ eAX, Iv } },
  { Bad_Opcode },	/* SEG CS prefix */
  { X86_64_TABLE (X86_64_2F) },
  /* 30 */
  { "xorB",		{ Ebh1, Gb } },
  { "xorS",		{ Evh1, Gv } },
  { "xorB",		{ Gb, EbS } },
  { "xorS",		{ Gv, EvS } },
  { "xorB",		{ AL, Ib } },
  { "xorS",		{ eAX, Iv } },
  { Bad_Opcode },	/* SEG SS prefix */
  { X86_64_TABLE (X86_64_37) },
  /* 38 */
  { "cmpB",		{ Eb, Gb } },
  { "cmpS",		{ Ev, Gv } },
  { "cmpB",		{ Gb, EbS } },
  { "cmpS",		{ Gv, EvS } },
  { "cmpB",		{ AL, Ib } },
  { "cmpS",		{ eAX, Iv } },
  { Bad_Opcode },	/* SEG DS prefix */
  { X86_64_TABLE (X86_64_3F) },
  /* 40 */
  { "inc{S|}",		{ RMeAX } },
  { "inc{S|}",		{ RMeCX } },
  { "inc{S|}",		{ RMeDX } },
  { "inc{S|}",		{ RMeBX } },
  { "inc{S|}",		{ RMeSP } },
  { "inc{S|}",		{ RMeBP } },
  { "inc{S|}",		{ RMeSI } },
  { "inc{S|}",		{ RMeDI } },
  /* 48 */
  { "dec{S|}",		{ RMeAX } },
  { "dec{S|}",		{ RMeCX } },
  { "dec{S|}",		{ RMeDX } },
  { "dec{S|}",		{ RMeBX } },
  { "dec{S|}",		{ RMeSP } },
  { "dec{S|}",		{ RMeBP } },
  { "dec{S|}",		{ RMeSI } },
  { "dec{S|}",		{ RMeDI } },
  /* 50 */
  { "pushV",		{ RMrAX } },
  { "pushV",		{ RMrCX } },
  { "pushV",		{ RMrDX } },
  { "pushV",		{ RMrBX } },
  { "pushV",		{ RMrSP } },
  { "pushV",		{ RMrBP } },
  { "pushV",		{ RMrSI } },
  { "pushV",		{ RMrDI } },
  /* 58 */
  { "popV",		{ RMrAX } },
  { "popV",		{ RMrCX } },
  { "popV",		{ RMrDX } },
  { "popV",		{ RMrBX } },
  { "popV",		{ RMrSP } },
  { "popV",		{ RMrBP } },
  { "popV",		{ RMrSI } },
  { "popV",		{ RMrDI } },
  /* 60 */
  { X86_64_TABLE (X86_64_60) },
  { X86_64_TABLE (X86_64_61) },
  { X86_64_TABLE (X86_64_62) },
  { X86_64_TABLE (X86_64_63) },
  { Bad_Opcode },	/* seg fs */
  { Bad_Opcode },	/* seg gs */
  { Bad_Opcode },	/* op size prefix */
  { Bad_Opcode },	/* adr size prefix */
  /* 68 */
  { "pushT",		{ sIv } },
  { "imulS",		{ Gv, Ev, Iv } },
  { "pushT",		{ sIbT } },
  { "imulS",		{ Gv, Ev, sIb } },
  { "ins{b|}",		{ Ybr, indirDX } },
  { X86_64_TABLE (X86_64_6D) },
  { "outs{b|}",		{ indirDXr, Xb } },
  { X86_64_TABLE (X86_64_6F) },
  /* 70 */
  { "joH",		{ Jb, BND, cond_jump_flag } },
  { "jnoH",		{ Jb, BND, cond_jump_flag } },
  { "jbH",		{ Jb, BND, cond_jump_flag } },
  { "jaeH",		{ Jb, BND, cond_jump_flag } },
  { "jeH",		{ Jb, BND, cond_jump_flag } },
  { "jneH",		{ Jb, BND, cond_jump_flag } },
  { "jbeH",		{ Jb, BND, cond_jump_flag } },
  { "jaH",		{ Jb, BND, cond_jump_flag } },
  /* 78 */
  { "jsH",		{ Jb, BND, cond_jump_flag } },
  { "jnsH",		{ Jb, BND, cond_jump_flag } },
  { "jpH",		{ Jb, BND, cond_jump_flag } },
  { "jnpH",		{ Jb, BND, cond_jump_flag } },
  { "jlH",		{ Jb, BND, cond_jump_flag } },
  { "jgeH",		{ Jb, BND, cond_jump_flag } },
  { "jleH",		{ Jb, BND, cond_jump_flag } },
  { "jgH",		{ Jb, BND, cond_jump_flag } },
  /* 80 */
  { REG_TABLE (REG_80) },
  { REG_TABLE (REG_81) },
  { Bad_Opcode },
  { REG_TABLE (REG_82) },
  { "testB",		{ Eb, Gb } },
  { "testS",		{ Ev, Gv } },
  { "xchgB",		{ Ebh2, Gb } },
  { "xchgS",		{ Evh2, Gv } },
  /* 88 */
  { "movB",		{ Ebh3, Gb } },
  { "movS",		{ Evh3, Gv } },
  { "movB",		{ Gb, EbS } },
  { "movS",		{ Gv, EvS } },
  { "movD",		{ Sv, Sw } },
  { MOD_TABLE (MOD_8D) },
  { "movD",		{ Sw, Sv } },
  { REG_TABLE (REG_8F) },
  /* 90 */
  { PREFIX_TABLE (PREFIX_90) },
  { "xchgS",		{ RMeCX, eAX } },
  { "xchgS",		{ RMeDX, eAX } },
  { "xchgS",		{ RMeBX, eAX } },
  { "xchgS",		{ RMeSP, eAX } },
  { "xchgS",		{ RMeBP, eAX } },
  { "xchgS",		{ RMeSI, eAX } },
  { "xchgS",		{ RMeDI, eAX } },
  /* 98 */
  { "cW{t|}R",		{ XX } },
  { "cR{t|}O",		{ XX } },
  { X86_64_TABLE (X86_64_9A) },
  { Bad_Opcode },	/* fwait */
  { "pushfT",		{ XX } },
  { "popfT",		{ XX } },
  { "sahf",		{ XX } },
  { "lahf",		{ XX } },
  /* a0 */
  { "mov%LB",		{ AL, Ob } },
  { "mov%LS",		{ eAX, Ov } },
  { "mov%LB",		{ Ob, AL } },
  { "mov%LS",		{ Ov, eAX } },
  { "movs{b|}",		{ Ybr, Xb } },
  { "movs{R|}",		{ Yvr, Xv } },
  { "cmps{b|}",		{ Xb, Yb } },
  { "cmps{R|}",		{ Xv, Yv } },
  /* a8 */
  { "testB",		{ AL, Ib } },
  { "testS",		{ eAX, Iv } },
  { "stosB",		{ Ybr, AL } },
  { "stosS",		{ Yvr, eAX } },
  { "lodsB",		{ ALr, Xb } },
  { "lodsS",		{ eAXr, Xv } },
  { "scasB",		{ AL, Yb } },
  { "scasS",		{ eAX, Yv } },
  /* b0 */
  { "movB",		{ RMAL, Ib } },
  { "movB",		{ RMCL, Ib } },
  { "movB",		{ RMDL, Ib } },
  { "movB",		{ RMBL, Ib } },
  { "movB",		{ RMAH, Ib } },
  { "movB",		{ RMCH, Ib } },
  { "movB",		{ RMDH, Ib } },
  { "movB",		{ RMBH, Ib } },
  /* b8 */
  { "mov%LV",		{ RMeAX, Iv64 } },
  { "mov%LV",		{ RMeCX, Iv64 } },
  { "mov%LV",		{ RMeDX, Iv64 } },
  { "mov%LV",		{ RMeBX, Iv64 } },
  { "mov%LV",		{ RMeSP, Iv64 } },
  { "mov%LV",		{ RMeBP, Iv64 } },
  { "mov%LV",		{ RMeSI, Iv64 } },
  { "mov%LV",		{ RMeDI, Iv64 } },
  /* c0 */
  { REG_TABLE (REG_C0) },
  { REG_TABLE (REG_C1) },
  { "retT",		{ Iw, BND } },
  { "retT",		{ BND } },
  { X86_64_TABLE (X86_64_C4) },
  { X86_64_TABLE (X86_64_C5) },
  { REG_TABLE (REG_C6) },
  { REG_TABLE (REG_C7) },
  /* c8 */
  { "enterT",		{ Iw, Ib } },
  { "leaveT",		{ XX } },
  { "Jret{|f}P",	{ Iw } },
  { "Jret{|f}P",	{ XX } },
  { "int3",		{ XX } },
  { "int",		{ Ib } },
  { X86_64_TABLE (X86_64_CE) },
  { "iretP",		{ XX } },
  /* d0 */
  { REG_TABLE (REG_D0) },
  { REG_TABLE (REG_D1) },
  { REG_TABLE (REG_D2) },
  { REG_TABLE (REG_D3) },
  { X86_64_TABLE (X86_64_D4) },
  { X86_64_TABLE (X86_64_D5) },
  { Bad_Opcode },
  { "xlat",		{ DSBX } },
  /* d8 */
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  /* e0 */
  { "loopneFH",		{ Jb, XX, loop_jcxz_flag } },
  { "loopeFH",		{ Jb, XX, loop_jcxz_flag } },
  { "loopFH",		{ Jb, XX, loop_jcxz_flag } },
  { "jEcxzH",		{ Jb, XX, loop_jcxz_flag } },
  { "inB",		{ AL, Ib } },
  { "inG",		{ zAX, Ib } },
  { "outB",		{ Ib, AL } },
  { "outG",		{ Ib, zAX } },
  /* e8 */
  { "callT",		{ Jv, BND } },
  { "jmpT",		{ Jv, BND } },
  { X86_64_TABLE (X86_64_EA) },
  { "jmp",		{ Jb, BND } },
  { "inB",		{ AL, indirDX } },
  { "inG",		{ zAX, indirDX } },
  { "outB",		{ indirDX, AL } },
  { "outG",		{ indirDX, zAX } },
  /* f0 */
  { Bad_Opcode },	/* lock prefix */
  { "icebp",		{ XX } },
  { Bad_Opcode },	/* repne */
  { Bad_Opcode },	/* repz */
  { "hlt",		{ XX } },
  { "cmc",		{ XX } },
  { REG_TABLE (REG_F6) },
  { REG_TABLE (REG_F7) },
  /* f8 */
  { "clc",		{ XX } },
  { "stc",		{ XX } },
  { "cli",		{ XX } },
  { "sti",		{ XX } },
  { "cld",		{ XX } },
  { "std",		{ XX } },
  { REG_TABLE (REG_FE) },
  { REG_TABLE (REG_FF) },
};

static const struct dis386 dis386_twobyte[] = {
  /* 00 */
  { REG_TABLE (REG_0F00 ) },
  { REG_TABLE (REG_0F01 ) },
  { "larS",		{ Gv, Ew } },
  { "lslS",		{ Gv, Ew } },
  { Bad_Opcode },
  { "syscall",		{ XX } },
  { "clts",		{ XX } },
  { "sysretP",		{ XX } },
  /* 08 */
  { "invd",		{ XX } },
  { "wbinvd",		{ XX } },
  { Bad_Opcode },
  { "ud2",		{ XX } },
  { Bad_Opcode },
  { REG_TABLE (REG_0F0D) },
  { "femms",		{ XX } },
  { "",			{ MX, EM, OPSUF } }, /* See OP_3DNowSuffix.  */
  /* 10 */
  { PREFIX_TABLE (PREFIX_0F10) },
  { PREFIX_TABLE (PREFIX_0F11) },
  { PREFIX_TABLE (PREFIX_0F12) },
  { MOD_TABLE (MOD_0F13) },
  { "unpcklpX",		{ XM, EXx } },
  { "unpckhpX",		{ XM, EXx } },
  { PREFIX_TABLE (PREFIX_0F16) },
  { MOD_TABLE (MOD_0F17) },
  /* 18 */
  { REG_TABLE (REG_0F18) },
  { "nopQ",		{ Ev } },
  { PREFIX_TABLE (PREFIX_0F1A) },
  { PREFIX_TABLE (PREFIX_0F1B) },
  { "nopQ",		{ Ev } },
  { "nopQ",		{ Ev } },
  { "nopQ",		{ Ev } },
  { "nopQ",		{ Ev } },
  /* 20 */
  { MOD_TABLE (MOD_0F20) },
  { MOD_TABLE (MOD_0F21) },
  { MOD_TABLE (MOD_0F22) },
  { MOD_TABLE (MOD_0F23) },
  { MOD_TABLE (MOD_0F24) },
  { Bad_Opcode },
  { MOD_TABLE (MOD_0F26) },
  { Bad_Opcode },
  /* 28 */
  { "movapX",		{ XM, EXx } },
  { "movapX",		{ EXxS, XM } },
  { PREFIX_TABLE (PREFIX_0F2A) },
  { PREFIX_TABLE (PREFIX_0F2B) },
  { PREFIX_TABLE (PREFIX_0F2C) },
  { PREFIX_TABLE (PREFIX_0F2D) },
  { PREFIX_TABLE (PREFIX_0F2E) },
  { PREFIX_TABLE (PREFIX_0F2F) },
  /* 30 */
  { "wrmsr",		{ XX } },
  { "rdtsc",		{ XX } },
  { "rdmsr",		{ XX } },
  { "rdpmc",		{ XX } },
  { "sysenter",		{ XX } },
  { "sysexit",		{ XX } },
  { Bad_Opcode },
  { "getsec",		{ XX } },
  /* 38 */
  { THREE_BYTE_TABLE (THREE_BYTE_0F38) },
  { Bad_Opcode },
  { THREE_BYTE_TABLE (THREE_BYTE_0F3A) },
  { Bad_Opcode },
  { Bad_Opcode },
  { Bad_Opcode },
  { Bad_Opcode },
  { Bad_Opcode },
  /* 40 */
  { "cmovoS",		{ Gv, Ev } },
  { "cmovnoS",		{ Gv, Ev } },
  { "cmovbS",		{ Gv, Ev } },
  { "cmovaeS",		{ Gv, Ev } },
  { "cmoveS",		{ Gv, Ev } },
  { "cmovneS",		{ Gv, Ev } },
  { "cmovbeS",		{ Gv, Ev } },
  { "cmovaS",		{ Gv, Ev } },
  /* 48 */
  { "cmovsS",		{ Gv, Ev } },
  { "cmovnsS",		{ Gv, Ev } },
  { "cmovpS",		{ Gv, Ev } },
  { "cmovnpS",		{ Gv, Ev } },
  { "cmovlS",		{ Gv, Ev } },
  { "cmovgeS",		{ Gv, Ev } },
  { "cmovleS",		{ Gv, Ev } },
  { "cmovgS",		{ Gv, Ev } },
  /* 50 */
  { MOD_TABLE (MOD_0F51) },
  { PREFIX_TABLE (PREFIX_0F51) },
  { PREFIX_TABLE (PREFIX_0F52) },
  { PREFIX_TABLE (PREFIX_0F53) },
  { "andpX",		{ XM, EXx } },
  { "andnpX",		{ XM, EXx } },
  { "orpX",		{ XM, EXx } },
  { "xorpX",		{ XM, EXx } },
  /* 58 */
  { PREFIX_TABLE (PREFIX_0F58) },
  { PREFIX_TABLE (PREFIX_0F59) },
  { PREFIX_TABLE (PREFIX_0F5A) },
  { PREFIX_TABLE (PREFIX_0F5B) },
  { PREFIX_TABLE (PREFIX_0F5C) },
  { PREFIX_TABLE (PREFIX_0F5D) },
  { PREFIX_TABLE (PREFIX_0F5E) },
  { PREFIX_TABLE (PREFIX_0F5F) },
  /* 60 */
  { PREFIX_TABLE (PREFIX_0F60) },
  { PREFIX_TABLE (PREFIX_0F61) },
  { PREFIX_TABLE (PREFIX_0F62) },
  { "packsswb",		{ MX, EM } },
  { "pcmpgtb",		{ MX, EM } },
  { "pcmpgtw",		{ MX, EM } },
  { "pcmpgtd",		{ MX, EM } },
  { "packuswb",		{ MX, EM } },
  /* 68 */
  { "punpckhbw",	{ MX, EM } },
  { "punpckhwd",	{ MX, EM } },
  { "punpckhdq",	{ MX, EM } },
  { "packssdw",		{ MX, EM } },
  { PREFIX_TABLE (PREFIX_0F6C) },
  { PREFIX_TABLE (PREFIX_0F6D) },
  { "movK",		{ MX, Edq } },
  { PREFIX_TABLE (PREFIX_0F6F) },
  /* 70 */
  { PREFIX_TABLE (PREFIX_0F70) },
  { REG_TABLE (REG_0F71) },
  { REG_TABLE (REG_0F72) },
  { REG_TABLE (REG_0F73) },
  { "pcmpeqb",		{ MX, EM } },
  { "pcmpeqw",		{ MX, EM } },
  { "pcmpeqd",		{ MX, EM } },
  { "emms",		{ XX } },
  /* 78 */
  { PREFIX_TABLE (PREFIX_0F78) },
  { PREFIX_TABLE (PREFIX_0F79) },
  { THREE_BYTE_TABLE (THREE_BYTE_0F7A) },
  { Bad_Opcode },
  { PREFIX_TABLE (PREFIX_0F7C) },
  { PREFIX_TABLE (PREFIX_0F7D) },
  { PREFIX_TABLE (PREFIX_0F7E) },
  { PREFIX_TABLE (PREFIX_0F7F) },
  /* 80 */
  { "joH",		{ Jv, BND, cond_jump_flag } },
  { "jnoH",		{ Jv, BND, cond_jump_flag } },
  { "jbH",		{ Jv, BND, cond_jump_flag } },
  { "jaeH",		{ Jv, BND, cond_jump_flag } },
  { "jeH",		{ Jv, BND, cond_jump_flag } },
  { "jneH",		{ Jv, BND, cond_jump_flag } },
  { "jbeH",		{ Jv, BND, cond_jump_flag } },
  { "jaH",		{ Jv, BND, cond_jump_flag } },
  /* 88 */
  { "jsH",		{ Jv, BND, cond_jump_flag } },
  { "jnsH",		{ Jv, BND, cond_jump_flag } },
  { "jpH",		{ Jv, BND, cond_jump_flag } },
  { "jnpH",		{ Jv, BND, cond_jump_flag } },
  { "jlH",		{ Jv, BND, cond_jump_flag } },
  { "jgeH",		{ Jv, BND, cond_jump_flag } },
  { "jleH",		{ Jv, BND, cond_jump_flag } },
  { "jgH",		{ Jv, BND, cond_jump_flag } },
  /* 90 */
  { "seto",		{ Eb } },
  { "setno",		{ Eb } },
  { "setb",		{ Eb } },
  { "setae",		{ Eb } },
  { "sete",		{ Eb } },
  { "setne",		{ Eb } },
  { "setbe",		{ Eb } },
  { "seta",		{ Eb } },
  /* 98 */
  { "sets",		{ Eb } },
  { "setns",		{ Eb } },
  { "setp",		{ Eb } },
  { "setnp",		{ Eb } },
  { "setl",		{ Eb } },
  { "setge",		{ Eb } },
  { "setle",		{ Eb } },
  { "setg",		{ Eb } },
  /* a0 */
  { "pushT",		{ fs } },
  { "popT",		{ fs } },
  { "cpuid",		{ XX } },
  { "btS",		{ Ev, Gv } },
  { "shldS",		{ Ev, Gv, Ib } },
  { "shldS",		{ Ev, Gv, CL } },
  { REG_TABLE (REG_0FA6) },
  { REG_TABLE (REG_0FA7) },
  /* a8 */
  { "pushT",		{ gs } },
  { "popT",		{ gs } },
  { "rsm",		{ XX } },
  { "btsS",		{ Evh1, Gv } },
  { "shrdS",		{ Ev, Gv, Ib } },
  { "shrdS",		{ Ev, Gv, CL } },
  { REG_TABLE (REG_0FAE) },
  { "imulS",		{ Gv, Ev } },
  /* b0 */
  { "cmpxchgB",		{ Ebh1, Gb } },
  { "cmpxchgS",		{ Evh1, Gv } },
  { MOD_TABLE (MOD_0FB2) },
  { "btrS",		{ Evh1, Gv } },
  { MOD_TABLE (MOD_0FB4) },
  { MOD_TABLE (MOD_0FB5) },
  { "movz{bR|x}",	{ Gv, Eb } },
  { "movz{wR|x}",	{ Gv, Ew } }, /* yes, there really is movzww ! */
  /* b8 */
  { PREFIX_TABLE (PREFIX_0FB8) },
  { "ud1",		{ XX } },
  { REG_TABLE (REG_0FBA) },
  { "btcS",		{ Evh1, Gv } },
  { PREFIX_TABLE (PREFIX_0FBC) },
  { PREFIX_TABLE (PREFIX_0FBD) },
  { "movs{bR|x}",	{ Gv, Eb } },
  { "movs{wR|x}",	{ Gv, Ew } }, /* yes, there really is movsww ! */
  /* c0 */
  { "xaddB",		{ Ebh1, Gb } },
  { "xaddS",		{ Evh1, Gv } },
  { PREFIX_TABLE (PREFIX_0FC2) },
  { PREFIX_TABLE (PREFIX_0FC3) },
  { "pinsrw",		{ MX, Edqw, Ib } },
  { "pextrw",		{ Gdq, MS, Ib } },
  { "shufpX",		{ XM, EXx, Ib } },
  { REG_TABLE (REG_0FC7) },
  /* c8 */
  { "bswap",		{ RMeAX } },
  { "bswap",		{ RMeCX } },
  { "bswap",		{ RMeDX } },
  { "bswap",		{ RMeBX } },
  { "bswap",		{ RMeSP } },
  { "bswap",		{ RMeBP } },
  { "bswap",		{ RMeSI } },
  { "bswap",		{ RMeDI } },
  /* d0 */
  { PREFIX_TABLE (PREFIX_0FD0) },
  { "psrlw",		{ MX, EM } },
  { "psrld",		{ MX, EM } },
  { "psrlq",		{ MX, EM } },
  { "paddq",		{ MX, EM } },
  { "pmullw",		{ MX, EM } },
  { PREFIX_TABLE (PREFIX_0FD6) },
  { MOD_TABLE (MOD_0FD7) },
  /* d8 */
  { "psubusb",		{ MX, EM } },
  { "psubusw",		{ MX, EM } },
  { "pminub",		{ MX, EM } },
  { "pand",		{ MX, EM } },
  { "paddusb",		{ MX, EM } },
  { "paddusw",		{ MX, EM } },
  { "pmaxub",		{ MX, EM } },
  { "pandn",		{ MX, EM } },
  /* e0 */
  { "pavgb",		{ MX, EM } },
  { "psraw",		{ MX, EM } },
  { "psrad",		{ MX, EM } },
  { "pavgw",		{ MX, EM } },
  { "pmulhuw",		{ MX, EM } },
  { "pmulhw",		{ MX, EM } },
  { PREFIX_TABLE (PREFIX_0FE6) },
  { PREFIX_TABLE (PREFIX_0FE7) },
  /* e8 */
  { "psubsb",		{ MX, EM } },
  { "psubsw",		{ MX, EM } },
  { "pminsw",		{ MX, EM } },
  { "por",		{ MX, EM } },
  { "paddsb",		{ MX, EM } },
  { "paddsw",		{ MX, EM } },
  { "pmaxsw",		{ MX, EM } },
  { "pxor",		{ MX, EM } },
  /* f0 */
  { PREFIX_TABLE (PREFIX_0FF0) },
  { "psllw",		{ MX, EM } },
  { "pslld",		{ MX, EM } },
  { "psllq",		{ MX, EM } },
  { "pmuludq",		{ MX, EM } },
  { "pmaddwd",		{ MX, EM } },
  { "psadbw",		{ MX, EM } },
  { PREFIX_TABLE (PREFIX_0FF7) },
  /* f8 */
  { "psubb",		{ MX, EM } },
  { "psubw",		{ MX, EM } },
  { "psubd",		{ MX, EM } },
  { "psubq",		{ MX, EM } },
  { "paddb",		{ MX, EM } },
  { "paddw",		{ MX, EM } },
  { "paddd",		{ MX, EM } },
  { Bad_Opcode },
};

static const unsigned char onebyte_has_modrm[256] = {
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
  /*       -------------------------------        */
  /* 00 */ 1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0, /* 00 */
  /* 10 */ 1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0, /* 10 */
  /* 20 */ 1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0, /* 20 */
  /* 30 */ 1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0, /* 30 */
  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 40 */
  /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 50 */
  /* 60 */ 0,0,1,1,0,0,0,0,0,1,0,1,0,0,0,0, /* 60 */
  /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 70 */
  /* 80 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* 80 */
  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 90 */
  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* a0 */
  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* b0 */
  /* c0 */ 1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0, /* c0 */
  /* d0 */ 1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1, /* d0 */
  /* e0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* e0 */
  /* f0 */ 0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1  /* f0 */
  /*       -------------------------------        */
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
};

static const unsigned char twobyte_has_modrm[256] = {
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
  /*       -------------------------------        */
  /* 00 */ 1,1,1,1,0,0,0,0,0,0,0,0,0,1,0,1, /* 0f */
  /* 10 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* 1f */
  /* 20 */ 1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1, /* 2f */
  /* 30 */ 0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0, /* 3f */
  /* 40 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* 4f */
  /* 50 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* 5f */
  /* 60 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* 6f */
  /* 70 */ 1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1, /* 7f */
  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
  /* 90 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* 9f */
  /* a0 */ 0,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1, /* af */
  /* b0 */ 1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1, /* bf */
  /* c0 */ 1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0, /* cf */
  /* d0 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* df */
  /* e0 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* ef */
  /* f0 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0  /* ff */
  /*       -------------------------------        */
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
};

static char obuf[100];
static char *obufp;
static char *mnemonicendp;
static char scratchbuf[100];
static unsigned char *start_codep;
static unsigned char *insn_codep;
static unsigned char *codep;
static int last_lock_prefix;
static int last_repz_prefix;
static int last_repnz_prefix;
static int last_data_prefix;
static int last_addr_prefix;
static int last_rex_prefix;
static int last_seg_prefix;
#define MAX_CODE_LENGTH 15
/* We can up to 14 prefixes since the maximum instruction length is
   15bytes.  */
static int all_prefixes[MAX_CODE_LENGTH - 1];
static disassemble_info *the_info;
static struct
  {
    int mod;
    int reg;
    int rm;
  }
modrm;
static unsigned char need_modrm;
static struct
  {
    int scale;
    int index;
    int base;
  }
sib;
static struct
  {
    int register_specifier;
    int length;
    int prefix;
    int w;
    int evex;
    int r;
    int v;
    int mask_register_specifier;
    int zeroing;
    int ll;
    int b;
  }
vex;
static unsigned char need_vex;
static unsigned char need_vex_reg;
static unsigned char vex_w_done;

struct op
  {
    const char *name;
    unsigned int len;
  };

/* If we are accessing mod/rm/reg without need_modrm set, then the
   values are stale.  Hitting this abort likely indicates that you
   need to update onebyte_has_modrm or twobyte_has_modrm.  */
#define MODRM_CHECK  if (!need_modrm) abort ()

static const char **names64;
static const char **names32;
static const char **names16;
static const char **names8;
static const char **names8rex;
static const char **names_seg;
static const char *index64;
static const char *index32;
static const char **index16;
static const char **names_bnd;

static const char *intel_names64[] = {
  "rax", "rcx", "rdx", "rbx", "rsp", "rbp", "rsi", "rdi",
  "r8", "r9", "r10", "r11", "r12", "r13", "r14", "r15"
};
static const char *intel_names32[] = {
  "eax", "ecx", "edx", "ebx", "esp", "ebp", "esi", "edi",
  "r8d", "r9d", "r10d", "r11d", "r12d", "r13d", "r14d", "r15d"
};
static const char *intel_names16[] = {
  "ax", "cx", "dx", "bx", "sp", "bp", "si", "di",
  "r8w", "r9w", "r10w", "r11w", "r12w", "r13w", "r14w", "r15w"
};
static const char *intel_names8[] = {
  "al", "cl", "dl", "bl", "ah", "ch", "dh", "bh",
};
static const char *intel_names8rex[] = {
  "al", "cl", "dl", "bl", "spl", "bpl", "sil", "dil",
  "r8b", "r9b", "r10b", "r11b", "r12b", "r13b", "r14b", "r15b"
};
static const char *intel_names_seg[] = {
  "es", "cs", "ss", "ds", "fs", "gs", "?", "?",
};
static const char *intel_index64 = "riz";
static const char *intel_index32 = "eiz";
static const char *intel_index16[] = {
  "bx+si", "bx+di", "bp+si", "bp+di", "si", "di", "bp", "bx"
};

static const char *att_names64[] = {
  "%rax", "%rcx", "%rdx", "%rbx", "%rsp", "%rbp", "%rsi", "%rdi",
  "%r8", "%r9", "%r10", "%r11", "%r12", "%r13", "%r14", "%r15"
};
static const char *att_names32[] = {
  "%eax", "%ecx", "%edx", "%ebx", "%esp", "%ebp", "%esi", "%edi",
  "%r8d", "%r9d", "%r10d", "%r11d", "%r12d", "%r13d", "%r14d", "%r15d"
};
static const char *att_names16[] = {
  "%ax", "%cx", "%dx", "%bx", "%sp", "%bp", "%si", "%di",
  "%r8w", "%r9w", "%r10w", "%r11w", "%r12w", "%r13w", "%r14w", "%r15w"
};
static const char *att_names8[] = {
  "%al", "%cl", "%dl", "%bl", "%ah", "%ch", "%dh", "%bh",
};
static const char *att_names8rex[] = {
  "%al", "%cl", "%dl", "%bl", "%spl", "%bpl", "%sil", "%dil",
  "%r8b", "%r9b", "%r10b", "%r11b", "%r12b", "%r13b", "%r14b", "%r15b"
};
static const char *att_names_seg[] = {
  "%es", "%cs", "%ss", "%ds", "%fs", "%gs", "%?", "%?",
};
static const char *att_index64 = "%riz";
static const char *att_index32 = "%eiz";
static const char *att_index16[] = {
  "%bx,%si", "%bx,%di", "%bp,%si", "%bp,%di", "%si", "%di", "%bp", "%bx"
};

static const char **names_mm;
static const char *intel_names_mm[] = {
  "mm0", "mm1", "mm2", "mm3",
  "mm4", "mm5", "mm6", "mm7"
};
static const char *att_names_mm[] = {
  "%mm0", "%mm1", "%mm2", "%mm3",
  "%mm4", "%mm5", "%mm6", "%mm7"
};

static const char *intel_names_bnd[] = {
  "bnd0", "bnd1", "bnd2", "bnd3"
};

static const char *att_names_bnd[] = {
  "%bnd0", "%bnd1", "%bnd2", "%bnd3"
};

static const char **names_xmm;
static const char *intel_names_xmm[] = {
  "xmm0", "xmm1", "xmm2", "xmm3",
  "xmm4", "xmm5", "xmm6", "xmm7",
  "xmm8", "xmm9", "xmm10", "xmm11",
  "xmm12", "xmm13", "xmm14", "xmm15",
  "xmm16", "xmm17", "xmm18", "xmm19",
  "xmm20", "xmm21", "xmm22", "xmm23",
  "xmm24", "xmm25", "xmm26", "xmm27",
  "xmm28", "xmm29", "xmm30", "xmm31"
};
static const char *att_names_xmm[] = {
  "%xmm0", "%xmm1", "%xmm2", "%xmm3",
  "%xmm4", "%xmm5", "%xmm6", "%xmm7",
  "%xmm8", "%xmm9", "%xmm10", "%xmm11",
  "%xmm12", "%xmm13", "%xmm14", "%xmm15",
  "%xmm16", "%xmm17", "%xmm18", "%xmm19",
  "%xmm20", "%xmm21", "%xmm22", "%xmm23",
  "%xmm24", "%xmm25", "%xmm26", "%xmm27",
  "%xmm28", "%xmm29", "%xmm30", "%xmm31"
};

static const char **names_ymm;
static const char *intel_names_ymm[] = {
  "ymm0", "ymm1", "ymm2", "ymm3",
  "ymm4", "ymm5", "ymm6", "ymm7",
  "ymm8", "ymm9", "ymm10", "ymm11",
  "ymm12", "ymm13", "ymm14", "ymm15",
  "ymm16", "ymm17", "ymm18", "ymm19",
  "ymm20", "ymm21", "ymm22", "ymm23",
  "ymm24", "ymm25", "ymm26", "ymm27",
  "ymm28", "ymm29", "ymm30", "ymm31"
};
static const char *att_names_ymm[] = {
  "%ymm0", "%ymm1", "%ymm2", "%ymm3",
  "%ymm4", "%ymm5", "%ymm6", "%ymm7",
  "%ymm8", "%ymm9", "%ymm10", "%ymm11",
  "%ymm12", "%ymm13", "%ymm14", "%ymm15",
  "%ymm16", "%ymm17", "%ymm18", "%ymm19",
  "%ymm20", "%ymm21", "%ymm22", "%ymm23",
  "%ymm24", "%ymm25", "%ymm26", "%ymm27",
  "%ymm28", "%ymm29", "%ymm30", "%ymm31"
};

static const char **names_zmm;
static const char *intel_names_zmm[] = {
  "zmm0", "zmm1", "zmm2", "zmm3",
  "zmm4", "zmm5", "zmm6", "zmm7",
  "zmm8", "zmm9", "zmm10", "zmm11",
  "zmm12", "zmm13", "zmm14", "zmm15",
  "zmm16", "zmm17", "zmm18", "zmm19",
  "zmm20", "zmm21", "zmm22", "zmm23",
  "zmm24", "zmm25", "zmm26", "zmm27",
  "zmm28", "zmm29", "zmm30", "zmm31"
};
static const char *att_names_zmm[] = {
  "%zmm0", "%zmm1", "%zmm2", "%zmm3",
  "%zmm4", "%zmm5", "%zmm6", "%zmm7",
  "%zmm8", "%zmm9", "%zmm10", "%zmm11",
  "%zmm12", "%zmm13", "%zmm14", "%zmm15",
  "%zmm16", "%zmm17", "%zmm18", "%zmm19",
  "%zmm20", "%zmm21", "%zmm22", "%zmm23",
  "%zmm24", "%zmm25", "%zmm26", "%zmm27",
  "%zmm28", "%zmm29", "%zmm30", "%zmm31"
};

static const char **names_mask;
static const char *intel_names_mask[] = {
  "k0", "k1", "k2", "k3", "k4", "k5", "k6", "k7"
};
static const char *att_names_mask[] = {
  "%k0", "%k1", "%k2", "%k3", "%k4", "%k5", "%k6", "%k7"
};

static const char *names_rounding[] =
{
  "{rn-sae}",
  "{rd-sae}",
  "{ru-sae}",
  "{rz-sae}"
};

static const struct dis386 reg_table[][8] = {
  /* REG_80 */
  {
    { "addA",	{ Ebh1, Ib } },
    { "orA",	{ Ebh1, Ib } },
    { "adcA",	{ Ebh1, Ib } },
    { "sbbA",	{ Ebh1, Ib } },
    { "andA",	{ Ebh1, Ib } },
    { "subA",	{ Ebh1, Ib } },
    { "xorA",	{ Ebh1, Ib } },
    { "cmpA",	{ Eb, Ib } },
  },
  /* REG_81 */
  {
    { "addQ",	{ Evh1, Iv } },
    { "orQ",	{ Evh1, Iv } },
    { "adcQ",	{ Evh1, Iv } },
    { "sbbQ",	{ Evh1, Iv } },
    { "andQ",	{ Evh1, Iv } },
    { "subQ",	{ Evh1, Iv } },
    { "xorQ",	{ Evh1, Iv } },
    { "cmpQ",	{ Ev, Iv } },
  },
  /* REG_82 */
  {
    { "addQ",	{ Evh1, sIb } },
    { "orQ",	{ Evh1, sIb } },
    { "adcQ",	{ Evh1, sIb } },
    { "sbbQ",	{ Evh1, sIb } },
    { "andQ",	{ Evh1, sIb } },
    { "subQ",	{ Evh1, sIb } },
    { "xorQ",	{ Evh1, sIb } },
    { "cmpQ",	{ Ev, sIb } },
  },
  /* REG_8F */
  {
    { "popU",	{ stackEv } },
    { XOP_8F_TABLE (XOP_09) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { XOP_8F_TABLE (XOP_09) },
  },
  /* REG_C0 */
  {
    { "rolA",	{ Eb, Ib } },
    { "rorA",	{ Eb, Ib } },
    { "rclA",	{ Eb, Ib } },
    { "rcrA",	{ Eb, Ib } },
    { "shlA",	{ Eb, Ib } },
    { "shrA",	{ Eb, Ib } },
    { Bad_Opcode },
    { "sarA",	{ Eb, Ib } },
  },
  /* REG_C1 */
  {
    { "rolQ",	{ Ev, Ib } },
    { "rorQ",	{ Ev, Ib } },
    { "rclQ",	{ Ev, Ib } },
    { "rcrQ",	{ Ev, Ib } },
    { "shlQ",	{ Ev, Ib } },
    { "shrQ",	{ Ev, Ib } },
    { Bad_Opcode },
    { "sarQ",	{ Ev, Ib } },
  },
  /* REG_C6 */
  {
    { "movA",	{ Ebh3, Ib } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_C6_REG_7) },
  },
  /* REG_C7 */
  {
    { "movQ",	{ Evh3, Iv } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_C7_REG_7) },
  },
  /* REG_D0 */
  {
    { "rolA",	{ Eb, I1 } },
    { "rorA",	{ Eb, I1 } },
    { "rclA",	{ Eb, I1 } },
    { "rcrA",	{ Eb, I1 } },
    { "shlA",	{ Eb, I1 } },
    { "shrA",	{ Eb, I1 } },
    { Bad_Opcode },
    { "sarA",	{ Eb, I1 } },
  },
  /* REG_D1 */
  {
    { "rolQ",	{ Ev, I1 } },
    { "rorQ",	{ Ev, I1 } },
    { "rclQ",	{ Ev, I1 } },
    { "rcrQ",	{ Ev, I1 } },
    { "shlQ",	{ Ev, I1 } },
    { "shrQ",	{ Ev, I1 } },
    { Bad_Opcode },
    { "sarQ",	{ Ev, I1 } },
  },
  /* REG_D2 */
  {
    { "rolA",	{ Eb, CL } },
    { "rorA",	{ Eb, CL } },
    { "rclA",	{ Eb, CL } },
    { "rcrA",	{ Eb, CL } },
    { "shlA",	{ Eb, CL } },
    { "shrA",	{ Eb, CL } },
    { Bad_Opcode },
    { "sarA",	{ Eb, CL } },
  },
  /* REG_D3 */
  {
    { "rolQ",	{ Ev, CL } },
    { "rorQ",	{ Ev, CL } },
    { "rclQ",	{ Ev, CL } },
    { "rcrQ",	{ Ev, CL } },
    { "shlQ",	{ Ev, CL } },
    { "shrQ",	{ Ev, CL } },
    { Bad_Opcode },
    { "sarQ",	{ Ev, CL } },
  },
  /* REG_F6 */
  {
    { "testA",	{ Eb, Ib } },
    { Bad_Opcode },
    { "notA",	{ Ebh1 } },
    { "negA",	{ Ebh1 } },
    { "mulA",	{ Eb } },	/* Don't print the implicit %al register,  */
    { "imulA",	{ Eb } },	/* to distinguish these opcodes from other */
    { "divA",	{ Eb } },	/* mul/imul opcodes.  Do the same for div  */
    { "idivA",	{ Eb } },	/* and idiv for consistency.		   */
  },
  /* REG_F7 */
  {
    { "testQ",	{ Ev, Iv } },
    { Bad_Opcode },
    { "notQ",	{ Evh1 } },
    { "negQ",	{ Evh1 } },
    { "mulQ",	{ Ev } },	/* Don't print the implicit register.  */
    { "imulQ",	{ Ev } },
    { "divQ",	{ Ev } },
    { "idivQ",	{ Ev } },
  },
  /* REG_FE */
  {
    { "incA",	{ Ebh1 } },
    { "decA",	{ Ebh1 } },
  },
  /* REG_FF */
  {
    { "incQ",	{ Evh1 } },
    { "decQ",	{ Evh1 } },
    { "call{T|}", { indirEv, BND } },
    { "Jcall{T|}", { indirEp } },
    { "jmp{T|}", { indirEv, BND } },
    { "Jjmp{T|}", { indirEp } },
    { "pushU",	{ stackEv } },
    { Bad_Opcode },
  },
  /* REG_0F00 */
  {
    { "sldtD",	{ Sv } },
    { "strD",	{ Sv } },
    { "lldt",	{ Ew } },
    { "ltr",	{ Ew } },
    { "verr",	{ Ew } },
    { "verw",	{ Ew } },
    { Bad_Opcode },
    { Bad_Opcode },
  },
  /* REG_0F01 */
  {
    { MOD_TABLE (MOD_0F01_REG_0) },
    { MOD_TABLE (MOD_0F01_REG_1) },
    { MOD_TABLE (MOD_0F01_REG_2) },
    { MOD_TABLE (MOD_0F01_REG_3) },
    { "smswD",	{ Sv } },
    { Bad_Opcode },
    { "lmsw",	{ Ew } },
    { MOD_TABLE (MOD_0F01_REG_7) },
  },
  /* REG_0F0D */
  {
    { "prefetch",	{ Mb } },
    { "prefetchw",	{ Mb } },
    { "prefetchwt1",	{ Mb } },
    { "prefetch",	{ Mb } },
    { "prefetch",	{ Mb } },
    { "prefetch",	{ Mb } },
    { "prefetch",	{ Mb } },
    { "prefetch",	{ Mb } },
  },
  /* REG_0F18 */
  {
    { MOD_TABLE (MOD_0F18_REG_0) },
    { MOD_TABLE (MOD_0F18_REG_1) },
    { MOD_TABLE (MOD_0F18_REG_2) },
    { MOD_TABLE (MOD_0F18_REG_3) },
    { MOD_TABLE (MOD_0F18_REG_4) },
    { MOD_TABLE (MOD_0F18_REG_5) },
    { MOD_TABLE (MOD_0F18_REG_6) },
    { MOD_TABLE (MOD_0F18_REG_7) },
  },
  /* REG_0F71 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_0F71_REG_2) },
    { Bad_Opcode },
    { MOD_TABLE (MOD_0F71_REG_4) },
    { Bad_Opcode },
    { MOD_TABLE (MOD_0F71_REG_6) },
  },
  /* REG_0F72 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_0F72_REG_2) },
    { Bad_Opcode },
    { MOD_TABLE (MOD_0F72_REG_4) },
    { Bad_Opcode },
    { MOD_TABLE (MOD_0F72_REG_6) },
  },
  /* REG_0F73 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_0F73_REG_2) },
    { MOD_TABLE (MOD_0F73_REG_3) },
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_0F73_REG_6) },
    { MOD_TABLE (MOD_0F73_REG_7) },
  },
  /* REG_0FA6 */
  {
    { "montmul",	{ { OP_0f07, 0 } } },
    { "xsha1",		{ { OP_0f07, 0 } } },
    { "xsha256",	{ { OP_0f07, 0 } } },
  },
  /* REG_0FA7 */
  {
    { "xstore-rng",	{ { OP_0f07, 0 } } },
    { "xcrypt-ecb",	{ { OP_0f07, 0 } } },
    { "xcrypt-cbc",	{ { OP_0f07, 0 } } },
    { "xcrypt-ctr",	{ { OP_0f07, 0 } } },
    { "xcrypt-cfb",	{ { OP_0f07, 0 } } },
    { "xcrypt-ofb",	{ { OP_0f07, 0 } } },
  },
  /* REG_0FAE */
  {
    { MOD_TABLE (MOD_0FAE_REG_0) },
    { MOD_TABLE (MOD_0FAE_REG_1) },
    { MOD_TABLE (MOD_0FAE_REG_2) },
    { MOD_TABLE (MOD_0FAE_REG_3) },
    { MOD_TABLE (MOD_0FAE_REG_4) },
    { MOD_TABLE (MOD_0FAE_REG_5) },
    { MOD_TABLE (MOD_0FAE_REG_6) },
    { MOD_TABLE (MOD_0FAE_REG_7) },
  },
  /* REG_0FBA */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { "btQ",	{ Ev, Ib } },
    { "btsQ",	{ Evh1, Ib } },
    { "btrQ",	{ Evh1, Ib } },
    { "btcQ",	{ Evh1, Ib } },
  },
  /* REG_0FC7 */
  {
    { Bad_Opcode },
    { "cmpxchg8b", { { CMPXCHG8B_Fixup, q_mode } } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_0FC7_REG_6) },
    { MOD_TABLE (MOD_0FC7_REG_7) },
  },
  /* REG_VEX_0F71 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0F71_REG_2) },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0F71_REG_4) },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0F71_REG_6) },
  },
  /* REG_VEX_0F72 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0F72_REG_2) },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0F72_REG_4) },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0F72_REG_6) },
  },
  /* REG_VEX_0F73 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0F73_REG_2) },
    { MOD_TABLE (MOD_VEX_0F73_REG_3) },
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0F73_REG_6) },
    { MOD_TABLE (MOD_VEX_0F73_REG_7) },
  },
  /* REG_VEX_0FAE */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0FAE_REG_2) },
    { MOD_TABLE (MOD_VEX_0FAE_REG_3) },
  },
  /* REG_VEX_0F38F3 */
  {
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F38F3_REG_1) },
    { PREFIX_TABLE (PREFIX_VEX_0F38F3_REG_2) },
    { PREFIX_TABLE (PREFIX_VEX_0F38F3_REG_3) },
  },
  /* REG_XOP_LWPCB */
  {
    { "llwpcb", { { OP_LWPCB_E, 0 } } },
    { "slwpcb",	{ { OP_LWPCB_E, 0 } } },
  },
  /* REG_XOP_LWP */
  {
    { "lwpins", { { OP_LWP_E, 0 }, Ed, Iq } },
    { "lwpval",	{ { OP_LWP_E, 0 }, Ed, Iq } },
  },
  /* REG_XOP_TBM_01 */
  {
    { Bad_Opcode },
    { "blcfill",	{ { OP_LWP_E, 0 }, Ev } },
    { "blsfill",	{ { OP_LWP_E, 0 }, Ev } },
    { "blcs",	{ { OP_LWP_E, 0 }, Ev } },
    { "tzmsk",	{ { OP_LWP_E, 0 }, Ev } },
    { "blcic",	{ { OP_LWP_E, 0 }, Ev } },
    { "blsic",	{ { OP_LWP_E, 0 }, Ev } },
    { "t1mskc",	{ { OP_LWP_E, 0 }, Ev } },
  },
  /* REG_XOP_TBM_02 */
  {
    { Bad_Opcode },
    { "blcmsk",	{ { OP_LWP_E, 0 }, Ev } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { "blci",	{ { OP_LWP_E, 0 }, Ev } },
  },
#define NEED_REG_TABLE
#include "i386-dis-evex.h"
#undef NEED_REG_TABLE
};

static const struct dis386 prefix_table[][4] = {
  /* PREFIX_90 */
  {
    { "xchgS", { { NOP_Fixup1, eAX_reg }, { NOP_Fixup2, eAX_reg } } },
    { "pause", { XX } },
    { "xchgS", { { NOP_Fixup1, eAX_reg }, { NOP_Fixup2, eAX_reg } } },
  },

  /* PREFIX_0F10 */
  {
    { "movups",	{ XM, EXx } },
    { "movss",	{ XM, EXd } },
    { "movupd",	{ XM, EXx } },
    { "movsd",	{ XM, EXq } },
  },

  /* PREFIX_0F11 */
  {
    { "movups",	{ EXxS, XM } },
    { "movss",	{ EXdS, XM } },
    { "movupd",	{ EXxS, XM } },
    { "movsd",	{ EXqS, XM } },
  },

  /* PREFIX_0F12 */
  {
    { MOD_TABLE (MOD_0F12_PREFIX_0) },
    { "movsldup", { XM, EXx } },
    { "movlpd",	{ XM, EXq } },
    { "movddup", { XM, EXq } },
  },

  /* PREFIX_0F16 */
  {
    { MOD_TABLE (MOD_0F16_PREFIX_0) },
    { "movshdup", { XM, EXx } },
    { "movhpd",	{ XM, EXq } },
  },

  /* PREFIX_0F1A */
  {
    { MOD_TABLE (MOD_0F1A_PREFIX_0) },
    { "bndcl",  { Gbnd, Ev_bnd } },
    { "bndmov", { Gbnd, Ebnd } },
    { "bndcu",  { Gbnd, Ev_bnd } },
  },

  /* PREFIX_0F1B */
  {
    { MOD_TABLE (MOD_0F1B_PREFIX_0) },
    { MOD_TABLE (MOD_0F1B_PREFIX_1) },
    { "bndmov", { Ebnd, Gbnd } },
    { "bndcn",  { Gbnd, Ev_bnd } },
  },

  /* PREFIX_0F2A */
  {
    { "cvtpi2ps", { XM, EMCq } },
    { "cvtsi2ss%LQ", { XM, Ev } },
    { "cvtpi2pd", { XM, EMCq } },
    { "cvtsi2sd%LQ", { XM, Ev } },
  },

  /* PREFIX_0F2B */
  {
    { MOD_TABLE (MOD_0F2B_PREFIX_0) },
    { MOD_TABLE (MOD_0F2B_PREFIX_1) },
    { MOD_TABLE (MOD_0F2B_PREFIX_2) },
    { MOD_TABLE (MOD_0F2B_PREFIX_3) },
  },

  /* PREFIX_0F2C */
  {
    { "cvttps2pi", { MXC, EXq } },
    { "cvttss2siY", { Gv, EXd } },
    { "cvttpd2pi", { MXC, EXx } },
    { "cvttsd2siY", { Gv, EXq } },
  },

  /* PREFIX_0F2D */
  {
    { "cvtps2pi", { MXC, EXq } },
    { "cvtss2siY", { Gv, EXd } },
    { "cvtpd2pi", { MXC, EXx } },
    { "cvtsd2siY", { Gv, EXq } },
  },

  /* PREFIX_0F2E */
  {
    { "ucomiss",{ XM, EXd } },
    { Bad_Opcode },
    { "ucomisd",{ XM, EXq } },
  },

  /* PREFIX_0F2F */
  {
    { "comiss",	{ XM, EXd } },
    { Bad_Opcode },
    { "comisd",	{ XM, EXq } },
  },

  /* PREFIX_0F51 */
  {
    { "sqrtps", { XM, EXx } },
    { "sqrtss", { XM, EXd } },
    { "sqrtpd", { XM, EXx } },
    { "sqrtsd",	{ XM, EXq } },
  },

  /* PREFIX_0F52 */
  {
    { "rsqrtps",{ XM, EXx } },
    { "rsqrtss",{ XM, EXd } },
  },

  /* PREFIX_0F53 */
  {
    { "rcpps",	{ XM, EXx } },
    { "rcpss",	{ XM, EXd } },
  },

  /* PREFIX_0F58 */
  {
    { "addps", { XM, EXx } },
    { "addss", { XM, EXd } },
    { "addpd", { XM, EXx } },
    { "addsd", { XM, EXq } },
  },

  /* PREFIX_0F59 */
  {
    { "mulps",	{ XM, EXx } },
    { "mulss",	{ XM, EXd } },
    { "mulpd",	{ XM, EXx } },
    { "mulsd",	{ XM, EXq } },
  },

  /* PREFIX_0F5A */
  {
    { "cvtps2pd", { XM, EXq } },
    { "cvtss2sd", { XM, EXd } },
    { "cvtpd2ps", { XM, EXx } },
    { "cvtsd2ss", { XM, EXq } },
  },

  /* PREFIX_0F5B */
  {
    { "cvtdq2ps", { XM, EXx } },
    { "cvttps2dq", { XM, EXx } },
    { "cvtps2dq", { XM, EXx } },
  },

  /* PREFIX_0F5C */
  {
    { "subps",	{ XM, EXx } },
    { "subss",	{ XM, EXd } },
    { "subpd",	{ XM, EXx } },
    { "subsd",	{ XM, EXq } },
  },

  /* PREFIX_0F5D */
  {
    { "minps",	{ XM, EXx } },
    { "minss",	{ XM, EXd } },
    { "minpd",	{ XM, EXx } },
    { "minsd",	{ XM, EXq } },
  },

  /* PREFIX_0F5E */
  {
    { "divps",	{ XM, EXx } },
    { "divss",	{ XM, EXd } },
    { "divpd",	{ XM, EXx } },
    { "divsd",	{ XM, EXq } },
  },

  /* PREFIX_0F5F */
  {
    { "maxps",	{ XM, EXx } },
    { "maxss",	{ XM, EXd } },
    { "maxpd",	{ XM, EXx } },
    { "maxsd",	{ XM, EXq } },
  },

  /* PREFIX_0F60 */
  {
    { "punpcklbw",{ MX, EMd } },
    { Bad_Opcode },
    { "punpcklbw",{ MX, EMx } },
  },

  /* PREFIX_0F61 */
  {
    { "punpcklwd",{ MX, EMd } },
    { Bad_Opcode },
    { "punpcklwd",{ MX, EMx } },
  },

  /* PREFIX_0F62 */
  {
    { "punpckldq",{ MX, EMd } },
    { Bad_Opcode },
    { "punpckldq",{ MX, EMx } },
  },

  /* PREFIX_0F6C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "punpcklqdq", { XM, EXx } },
  },

  /* PREFIX_0F6D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "punpckhqdq", { XM, EXx } },
  },

  /* PREFIX_0F6F */
  {
    { "movq",	{ MX, EM } },
    { "movdqu",	{ XM, EXx } },
    { "movdqa",	{ XM, EXx } },
  },

  /* PREFIX_0F70 */
  {
    { "pshufw",	{ MX, EM, Ib } },
    { "pshufhw",{ XM, EXx, Ib } },
    { "pshufd",	{ XM, EXx, Ib } },
    { "pshuflw",{ XM, EXx, Ib } },
  },

  /* PREFIX_0F73_REG_3 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "psrldq",	{ XS, Ib } },
  },

  /* PREFIX_0F73_REG_7 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pslldq",	{ XS, Ib } },
  },

  /* PREFIX_0F78 */
  {
    {"vmread",	{ Em, Gm } },
    { Bad_Opcode },
    {"extrq",	{ XS, Ib, Ib } },
    {"insertq",	{ XM, XS, Ib, Ib } },
  },

  /* PREFIX_0F79 */
  {
    {"vmwrite",	{ Gm, Em } },
    { Bad_Opcode },
    {"extrq",	{ XM, XS } },
    {"insertq",	{ XM, XS } },
  },

  /* PREFIX_0F7C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "haddpd",	{ XM, EXx } },
    { "haddps",	{ XM, EXx } },
  },

  /* PREFIX_0F7D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "hsubpd",	{ XM, EXx } },
    { "hsubps",	{ XM, EXx } },
  },

  /* PREFIX_0F7E */
  {
    { "movK",	{ Edq, MX } },
    { "movq",	{ XM, EXq } },
    { "movK",	{ Edq, XM } },
  },

  /* PREFIX_0F7F */
  {
    { "movq",	{ EMS, MX } },
    { "movdqu",	{ EXxS, XM } },
    { "movdqa",	{ EXxS, XM } },
  },

  /* PREFIX_0FAE_REG_0 */
  {
    { Bad_Opcode },
    { "rdfsbase", { Ev } },
  },

  /* PREFIX_0FAE_REG_1 */
  {
    { Bad_Opcode },
    { "rdgsbase", { Ev } },
  },

  /* PREFIX_0FAE_REG_2 */
  {
    { Bad_Opcode },
    { "wrfsbase", { Ev } },
  },

  /* PREFIX_0FAE_REG_3 */
  {
    { Bad_Opcode },
    { "wrgsbase", { Ev } },
  },

  /* PREFIX_0FB8 */
  {
    { Bad_Opcode },
    { "popcntS", { Gv, Ev } },
  },

  /* PREFIX_0FBC */
  {
    { "bsfS",	{ Gv, Ev } },
    { "tzcntS",	{ Gv, Ev } },
    { "bsfS",	{ Gv, Ev } },
  },

  /* PREFIX_0FBD */
  {
    { "bsrS",	{ Gv, Ev } },
    { "lzcntS",	{ Gv, Ev } },
    { "bsrS",	{ Gv, Ev } },
  },

  /* PREFIX_0FC2 */
  {
    { "cmpps",	{ XM, EXx, CMP } },
    { "cmpss",	{ XM, EXd, CMP } },
    { "cmppd",	{ XM, EXx, CMP } },
    { "cmpsd",	{ XM, EXq, CMP } },
  },

  /* PREFIX_0FC3 */
  {
    { "movntiS", { Ma, Gv } },
  },

  /* PREFIX_0FC7_REG_6 */
  {
    { "vmptrld",{ Mq } },
    { "vmxon",	{ Mq } },
    { "vmclear",{ Mq } },
  },

  /* PREFIX_0FD0 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "addsubpd", { XM, EXx } },
    { "addsubps", { XM, EXx } },
  },

  /* PREFIX_0FD6 */
  {
    { Bad_Opcode },
    { "movq2dq",{ XM, MS } },
    { "movq",	{ EXqS, XM } },
    { "movdq2q",{ MX, XS } },
  },

  /* PREFIX_0FE6 */
  {
    { Bad_Opcode },
    { "cvtdq2pd", { XM, EXq } },
    { "cvttpd2dq", { XM, EXx } },
    { "cvtpd2dq", { XM, EXx } },
  },

  /* PREFIX_0FE7 */
  {
    { "movntq",	{ Mq, MX } },
    { Bad_Opcode },
    { MOD_TABLE (MOD_0FE7_PREFIX_2) },
  },

  /* PREFIX_0FF0 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_0FF0_PREFIX_3) },
  },

  /* PREFIX_0FF7 */
  {
    { "maskmovq", { MX, MS } },
    { Bad_Opcode },
    { "maskmovdqu", { XM, XS } },
  },

  /* PREFIX_0F3810 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pblendvb", { XM, EXx, XMM0 } },
  },

  /* PREFIX_0F3814 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "blendvps", { XM, EXx, XMM0 } },
  },

  /* PREFIX_0F3815 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "blendvpd", { XM, EXx, XMM0 } },
  },

  /* PREFIX_0F3817 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "ptest",  { XM, EXx } },
  },

  /* PREFIX_0F3820 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmovsxbw", { XM, EXq } },
  },

  /* PREFIX_0F3821 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmovsxbd", { XM, EXd } },
  },

  /* PREFIX_0F3822 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmovsxbq", { XM, EXw } },
  },

  /* PREFIX_0F3823 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmovsxwd", { XM, EXq } },
  },

  /* PREFIX_0F3824 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmovsxwq", { XM, EXd } },
  },

  /* PREFIX_0F3825 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmovsxdq", { XM, EXq } },
  },

  /* PREFIX_0F3828 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmuldq", { XM, EXx } },
  },

  /* PREFIX_0F3829 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pcmpeqq", { XM, EXx } },
  },

  /* PREFIX_0F382A */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_0F382A_PREFIX_2) },
  },

  /* PREFIX_0F382B */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "packusdw", { XM, EXx } },
  },

  /* PREFIX_0F3830 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmovzxbw", { XM, EXq } },
  },

  /* PREFIX_0F3831 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmovzxbd", { XM, EXd } },
  },

  /* PREFIX_0F3832 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmovzxbq", { XM, EXw } },
  },

  /* PREFIX_0F3833 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmovzxwd", { XM, EXq } },
  },

  /* PREFIX_0F3834 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmovzxwq", { XM, EXd } },
  },

  /* PREFIX_0F3835 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmovzxdq", { XM, EXq } },
  },

  /* PREFIX_0F3837 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pcmpgtq", { XM, EXx } },
  },

  /* PREFIX_0F3838 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pminsb",	{ XM, EXx } },
  },

  /* PREFIX_0F3839 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pminsd",	{ XM, EXx } },
  },

  /* PREFIX_0F383A */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pminuw",	{ XM, EXx } },
  },

  /* PREFIX_0F383B */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pminud",	{ XM, EXx } },
  },

  /* PREFIX_0F383C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmaxsb",	{ XM, EXx } },
  },

  /* PREFIX_0F383D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmaxsd",	{ XM, EXx } },
  },

  /* PREFIX_0F383E */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmaxuw", { XM, EXx } },
  },

  /* PREFIX_0F383F */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmaxud", { XM, EXx } },
  },

  /* PREFIX_0F3840 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pmulld", { XM, EXx } },
  },

  /* PREFIX_0F3841 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "phminposuw", { XM, EXx } },
  },

  /* PREFIX_0F3880 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "invept",	{ Gm, Mo } },
  },

  /* PREFIX_0F3881 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "invvpid", { Gm, Mo } },
  },

  /* PREFIX_0F3882 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "invpcid", { Gm, M } },
  },

  /* PREFIX_0F38C8 */
  {
    { "sha1nexte", { XM, EXxmm } },
  },

  /* PREFIX_0F38C9 */
  {
    { "sha1msg1", { XM, EXxmm } },
  },

  /* PREFIX_0F38CA */
  {
    { "sha1msg2", { XM, EXxmm } },
  },

  /* PREFIX_0F38CB */
  {
    { "sha256rnds2", { XM, EXxmm, XMM0 } },
  },

  /* PREFIX_0F38CC */
  {
    { "sha256msg1", { XM, EXxmm } },
  },

  /* PREFIX_0F38CD */
  {
    { "sha256msg2", { XM, EXxmm } },
  },

  /* PREFIX_0F38DB */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "aesimc", { XM, EXx } },
  },

  /* PREFIX_0F38DC */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "aesenc", { XM, EXx } },
  },

  /* PREFIX_0F38DD */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "aesenclast", { XM, EXx } },
  },

  /* PREFIX_0F38DE */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "aesdec", { XM, EXx } },
  },

  /* PREFIX_0F38DF */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "aesdeclast", { XM, EXx } },
  },

  /* PREFIX_0F38F0 */
  {
    { "movbeS",	{ Gv, { MOVBE_Fixup, v_mode } } },
    { Bad_Opcode },
    { "movbeS",	{ Gv, { MOVBE_Fixup, v_mode } } },
    { "crc32",	{ Gdq, { CRC32_Fixup, b_mode } } },
  },

  /* PREFIX_0F38F1 */
  {
    { "movbeS",	{ { MOVBE_Fixup, v_mode }, Gv } },
    { Bad_Opcode },
    { "movbeS",	{ { MOVBE_Fixup, v_mode }, Gv } },
    { "crc32",	{ Gdq, { CRC32_Fixup, v_mode } } },
  },

  /* PREFIX_0F38F6 */
  {
    { Bad_Opcode },
    { "adoxS",	{ Gdq, Edq} },
    { "adcxS",	{ Gdq, Edq} },
    { Bad_Opcode },
  },

  /* PREFIX_0F3A08 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "roundps", { XM, EXx, Ib } },
  },

  /* PREFIX_0F3A09 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "roundpd", { XM, EXx, Ib } },
  },

  /* PREFIX_0F3A0A */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "roundss", { XM, EXd, Ib } },
  },

  /* PREFIX_0F3A0B */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "roundsd", { XM, EXq, Ib } },
  },

  /* PREFIX_0F3A0C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "blendps", { XM, EXx, Ib } },
  },

  /* PREFIX_0F3A0D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "blendpd", { XM, EXx, Ib } },
  },

  /* PREFIX_0F3A0E */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pblendw", { XM, EXx, Ib } },
  },

  /* PREFIX_0F3A14 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pextrb",	{ Edqb, XM, Ib } },
  },

  /* PREFIX_0F3A15 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pextrw",	{ Edqw, XM, Ib } },
  },

  /* PREFIX_0F3A16 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pextrK",	{ Edq, XM, Ib } },
  },

  /* PREFIX_0F3A17 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "extractps", { Edqd, XM, Ib } },
  },

  /* PREFIX_0F3A20 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pinsrb",	{ XM, Edqb, Ib } },
  },

  /* PREFIX_0F3A21 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "insertps", { XM, EXd, Ib } },
  },

  /* PREFIX_0F3A22 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pinsrK",	{ XM, Edq, Ib } },
  },

  /* PREFIX_0F3A40 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "dpps",	{ XM, EXx, Ib } },
  },

  /* PREFIX_0F3A41 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "dppd",	{ XM, EXx, Ib } },
  },

  /* PREFIX_0F3A42 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "mpsadbw", { XM, EXx, Ib } },
  },

  /* PREFIX_0F3A44 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pclmulqdq", { XM, EXx, PCLMUL } },
  },

  /* PREFIX_0F3A60 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pcmpestrm", { XM, EXx, Ib } },
  },

  /* PREFIX_0F3A61 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pcmpestri", { XM, EXx, Ib } },
  },

  /* PREFIX_0F3A62 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pcmpistrm", { XM, EXx, Ib } },
  },

  /* PREFIX_0F3A63 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "pcmpistri", { XM, EXx, Ib } },
  },

  /* PREFIX_0F3ACC */
  {
    { "sha1rnds4", { XM, EXxmm, Ib } },
  },

  /* PREFIX_0F3ADF */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "aeskeygenassist", { XM, EXx, Ib } },
  },

  /* PREFIX_VEX_0F10 */
  {
    { VEX_W_TABLE (VEX_W_0F10_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F10_P_1) },
    { VEX_W_TABLE (VEX_W_0F10_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_0F10_P_3) },
  },

  /* PREFIX_VEX_0F11 */
  {
    { VEX_W_TABLE (VEX_W_0F11_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F11_P_1) },
    { VEX_W_TABLE (VEX_W_0F11_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_0F11_P_3) },
  },

  /* PREFIX_VEX_0F12 */
  {
    { MOD_TABLE (MOD_VEX_0F12_PREFIX_0) },
    { VEX_W_TABLE (VEX_W_0F12_P_1) },
    { VEX_LEN_TABLE (VEX_LEN_0F12_P_2) },
    { VEX_W_TABLE (VEX_W_0F12_P_3) },
  },

  /* PREFIX_VEX_0F16 */
  {
    { MOD_TABLE (MOD_VEX_0F16_PREFIX_0) },
    { VEX_W_TABLE (VEX_W_0F16_P_1) },
    { VEX_LEN_TABLE (VEX_LEN_0F16_P_2) },
  },

  /* PREFIX_VEX_0F2A */
  {
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F2A_P_1) },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F2A_P_3) },
  },

  /* PREFIX_VEX_0F2C */
  {
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F2C_P_1) },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F2C_P_3) },
  },

  /* PREFIX_VEX_0F2D */
  {
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F2D_P_1) },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F2D_P_3) },
  },

  /* PREFIX_VEX_0F2E */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F2E_P_0) },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F2E_P_2) },
  },

  /* PREFIX_VEX_0F2F */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F2F_P_0) },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F2F_P_2) },
  },

  /* PREFIX_VEX_0F41 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F41_P_0) },
  },

  /* PREFIX_VEX_0F42 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F42_P_0) },
  },

  /* PREFIX_VEX_0F44 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F44_P_0) },
  },

  /* PREFIX_VEX_0F45 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F45_P_0) },
  },

  /* PREFIX_VEX_0F46 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F46_P_0) },
  },

  /* PREFIX_VEX_0F47 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F47_P_0) },
  },

  /* PREFIX_VEX_0F4B */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F4B_P_2) },
  },

  /* PREFIX_VEX_0F51 */
  {
    { VEX_W_TABLE (VEX_W_0F51_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F51_P_1) },
    { VEX_W_TABLE (VEX_W_0F51_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_0F51_P_3) },
  },

  /* PREFIX_VEX_0F52 */
  {
    { VEX_W_TABLE (VEX_W_0F52_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F52_P_1) },
  },

  /* PREFIX_VEX_0F53 */
  {
    { VEX_W_TABLE (VEX_W_0F53_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F53_P_1) },
  },

  /* PREFIX_VEX_0F58 */
  {
    { VEX_W_TABLE (VEX_W_0F58_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F58_P_1) },
    { VEX_W_TABLE (VEX_W_0F58_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_0F58_P_3) },
  },

  /* PREFIX_VEX_0F59 */
  {
    { VEX_W_TABLE (VEX_W_0F59_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F59_P_1) },
    { VEX_W_TABLE (VEX_W_0F59_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_0F59_P_3) },
  },

  /* PREFIX_VEX_0F5A */
  {
    { VEX_W_TABLE (VEX_W_0F5A_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F5A_P_1) },
    { "vcvtpd2ps%XY", { XMM, EXx } },
    { VEX_LEN_TABLE (VEX_LEN_0F5A_P_3) },
  },

  /* PREFIX_VEX_0F5B */
  {
    { VEX_W_TABLE (VEX_W_0F5B_P_0) },
    { VEX_W_TABLE (VEX_W_0F5B_P_1) },
    { VEX_W_TABLE (VEX_W_0F5B_P_2) },
  },

  /* PREFIX_VEX_0F5C */
  {
    { VEX_W_TABLE (VEX_W_0F5C_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F5C_P_1) },
    { VEX_W_TABLE (VEX_W_0F5C_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_0F5C_P_3) },
  },

  /* PREFIX_VEX_0F5D */
  {
    { VEX_W_TABLE (VEX_W_0F5D_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F5D_P_1) },
    { VEX_W_TABLE (VEX_W_0F5D_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_0F5D_P_3) },
  },

  /* PREFIX_VEX_0F5E */
  {
    { VEX_W_TABLE (VEX_W_0F5E_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F5E_P_1) },
    { VEX_W_TABLE (VEX_W_0F5E_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_0F5E_P_3) },
  },

  /* PREFIX_VEX_0F5F */
  {
    { VEX_W_TABLE (VEX_W_0F5F_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F5F_P_1) },
    { VEX_W_TABLE (VEX_W_0F5F_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_0F5F_P_3) },
  },

  /* PREFIX_VEX_0F60 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F60_P_2) },
  },

  /* PREFIX_VEX_0F61 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F61_P_2) },
  },

  /* PREFIX_VEX_0F62 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F62_P_2) },
  },

  /* PREFIX_VEX_0F63 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F63_P_2) },
  },

  /* PREFIX_VEX_0F64 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F64_P_2) },
  },

  /* PREFIX_VEX_0F65 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F65_P_2) },
  },

  /* PREFIX_VEX_0F66 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F66_P_2) },
  },

  /* PREFIX_VEX_0F67 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F67_P_2) },
  },

  /* PREFIX_VEX_0F68 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F68_P_2) },
  },

  /* PREFIX_VEX_0F69 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F69_P_2) },
  },

  /* PREFIX_VEX_0F6A */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F6A_P_2) },
  },

  /* PREFIX_VEX_0F6B */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F6B_P_2) },
  },

  /* PREFIX_VEX_0F6C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F6C_P_2) },
  },

  /* PREFIX_VEX_0F6D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F6D_P_2) },
  },

  /* PREFIX_VEX_0F6E */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F6E_P_2) },
  },

  /* PREFIX_VEX_0F6F */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F6F_P_1) },
    { VEX_W_TABLE (VEX_W_0F6F_P_2) },
  },

  /* PREFIX_VEX_0F70 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F70_P_1) },
    { VEX_W_TABLE (VEX_W_0F70_P_2) },
    { VEX_W_TABLE (VEX_W_0F70_P_3) },
  },

  /* PREFIX_VEX_0F71_REG_2 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F71_R_2_P_2) },
  },

  /* PREFIX_VEX_0F71_REG_4 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F71_R_4_P_2) },
  },

  /* PREFIX_VEX_0F71_REG_6 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F71_R_6_P_2) },
  },

  /* PREFIX_VEX_0F72_REG_2 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F72_R_2_P_2) },
  },

  /* PREFIX_VEX_0F72_REG_4 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F72_R_4_P_2) },
  },

  /* PREFIX_VEX_0F72_REG_6 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F72_R_6_P_2) },
  },

  /* PREFIX_VEX_0F73_REG_2 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F73_R_2_P_2) },
  },

  /* PREFIX_VEX_0F73_REG_3 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F73_R_3_P_2) },
  },

  /* PREFIX_VEX_0F73_REG_6 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F73_R_6_P_2) },
  },

  /* PREFIX_VEX_0F73_REG_7 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F73_R_7_P_2) },
  },

  /* PREFIX_VEX_0F74 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F74_P_2) },
  },

  /* PREFIX_VEX_0F75 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F75_P_2) },
  },

  /* PREFIX_VEX_0F76 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F76_P_2) },
  },

  /* PREFIX_VEX_0F77 */
  {
    { VEX_W_TABLE (VEX_W_0F77_P_0) },
  },

  /* PREFIX_VEX_0F7C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F7C_P_2) },
    { VEX_W_TABLE (VEX_W_0F7C_P_3) },
  },

  /* PREFIX_VEX_0F7D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F7D_P_2) },
    { VEX_W_TABLE (VEX_W_0F7D_P_3) },
  },

  /* PREFIX_VEX_0F7E */
  {
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F7E_P_1) },
    { VEX_LEN_TABLE (VEX_LEN_0F7E_P_2) },
  },

  /* PREFIX_VEX_0F7F */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F7F_P_1) },
    { VEX_W_TABLE (VEX_W_0F7F_P_2) },
  },

  /* PREFIX_VEX_0F90 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F90_P_0) },
  },

  /* PREFIX_VEX_0F91 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F91_P_0) },
  },

  /* PREFIX_VEX_0F92 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F92_P_0) },
  },

  /* PREFIX_VEX_0F93 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F93_P_0) },
  },

  /* PREFIX_VEX_0F98 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F98_P_0) },
  },

  /* PREFIX_VEX_0FC2 */
  {
    { VEX_W_TABLE (VEX_W_0FC2_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0FC2_P_1) },
    { VEX_W_TABLE (VEX_W_0FC2_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_0FC2_P_3) },
  },

  /* PREFIX_VEX_0FC4 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0FC4_P_2) },
  },

  /* PREFIX_VEX_0FC5 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0FC5_P_2) },
  },

  /* PREFIX_VEX_0FD0 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FD0_P_2) },
    { VEX_W_TABLE (VEX_W_0FD0_P_3) },
  },

  /* PREFIX_VEX_0FD1 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FD1_P_2) },
  },

  /* PREFIX_VEX_0FD2 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FD2_P_2) },
  },

  /* PREFIX_VEX_0FD3 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FD3_P_2) },
  },

  /* PREFIX_VEX_0FD4 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FD4_P_2) },
  },

  /* PREFIX_VEX_0FD5 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FD5_P_2) },
  },

  /* PREFIX_VEX_0FD6 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0FD6_P_2) },
  },

  /* PREFIX_VEX_0FD7 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0FD7_PREFIX_2) },
  },

  /* PREFIX_VEX_0FD8 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FD8_P_2) },
  },

  /* PREFIX_VEX_0FD9 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FD9_P_2) },
  },

  /* PREFIX_VEX_0FDA */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FDA_P_2) },
  },

  /* PREFIX_VEX_0FDB */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FDB_P_2) },
  },

  /* PREFIX_VEX_0FDC */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FDC_P_2) },
  },

  /* PREFIX_VEX_0FDD */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FDD_P_2) },
  },

  /* PREFIX_VEX_0FDE */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FDE_P_2) },
  },

  /* PREFIX_VEX_0FDF */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FDF_P_2) },
  },

  /* PREFIX_VEX_0FE0 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FE0_P_2) },
  },

  /* PREFIX_VEX_0FE1 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FE1_P_2) },
  },

  /* PREFIX_VEX_0FE2 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FE2_P_2) },
  },

  /* PREFIX_VEX_0FE3 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FE3_P_2) },
  },

  /* PREFIX_VEX_0FE4 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FE4_P_2) },
  },

  /* PREFIX_VEX_0FE5 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FE5_P_2) },
  },

  /* PREFIX_VEX_0FE6 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FE6_P_1) },
    { VEX_W_TABLE (VEX_W_0FE6_P_2) },
    { VEX_W_TABLE (VEX_W_0FE6_P_3) },
  },

  /* PREFIX_VEX_0FE7 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0FE7_PREFIX_2) },
  },

  /* PREFIX_VEX_0FE8 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FE8_P_2) },
  },

  /* PREFIX_VEX_0FE9 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FE9_P_2) },
  },

  /* PREFIX_VEX_0FEA */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FEA_P_2) },
  },

  /* PREFIX_VEX_0FEB */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FEB_P_2) },
  },

  /* PREFIX_VEX_0FEC */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FEC_P_2) },
  },

  /* PREFIX_VEX_0FED */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FED_P_2) },
  },

  /* PREFIX_VEX_0FEE */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FEE_P_2) },
  },

  /* PREFIX_VEX_0FEF */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FEF_P_2) },
  },

  /* PREFIX_VEX_0FF0 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0FF0_PREFIX_3) },
  },

  /* PREFIX_VEX_0FF1 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FF1_P_2) },
  },

  /* PREFIX_VEX_0FF2 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FF2_P_2) },
  },

  /* PREFIX_VEX_0FF3 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FF3_P_2) },
  },

  /* PREFIX_VEX_0FF4 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FF4_P_2) },
  },

  /* PREFIX_VEX_0FF5 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FF5_P_2) },
  },

  /* PREFIX_VEX_0FF6 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FF6_P_2) },
  },

  /* PREFIX_VEX_0FF7 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0FF7_P_2) },
  },

  /* PREFIX_VEX_0FF8 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FF8_P_2) },
  },

  /* PREFIX_VEX_0FF9 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FF9_P_2) },
  },

  /* PREFIX_VEX_0FFA */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FFA_P_2) },
  },

  /* PREFIX_VEX_0FFB */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FFB_P_2) },
  },

  /* PREFIX_VEX_0FFC */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FFC_P_2) },
  },

  /* PREFIX_VEX_0FFD */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FFD_P_2) },
  },

  /* PREFIX_VEX_0FFE */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FFE_P_2) },
  },

  /* PREFIX_VEX_0F3800 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3800_P_2) },
  },

  /* PREFIX_VEX_0F3801 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3801_P_2) },
  },

  /* PREFIX_VEX_0F3802 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3802_P_2) },
  },

  /* PREFIX_VEX_0F3803 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3803_P_2) },
  },

  /* PREFIX_VEX_0F3804 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3804_P_2) },
  },

  /* PREFIX_VEX_0F3805 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3805_P_2) },
  },

  /* PREFIX_VEX_0F3806 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3806_P_2) },
  },

  /* PREFIX_VEX_0F3807 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3807_P_2) },
  },

  /* PREFIX_VEX_0F3808 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3808_P_2) },
  },

  /* PREFIX_VEX_0F3809 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3809_P_2) },
  },

  /* PREFIX_VEX_0F380A */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F380A_P_2) },
  },

  /* PREFIX_VEX_0F380B */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F380B_P_2) },
  },

  /* PREFIX_VEX_0F380C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F380C_P_2) },
  },

  /* PREFIX_VEX_0F380D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F380D_P_2) },
  },

  /* PREFIX_VEX_0F380E */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F380E_P_2) },
  },

  /* PREFIX_VEX_0F380F */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F380F_P_2) },
  },

  /* PREFIX_VEX_0F3813 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vcvtph2ps", { XM, EXxmmq } },
  },

  /* PREFIX_VEX_0F3816 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3816_P_2) },
  },

  /* PREFIX_VEX_0F3817 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3817_P_2) },
  },

  /* PREFIX_VEX_0F3818 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3818_P_2) },
  },

  /* PREFIX_VEX_0F3819 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3819_P_2) },
  },

  /* PREFIX_VEX_0F381A */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0F381A_PREFIX_2) },
  },

  /* PREFIX_VEX_0F381C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F381C_P_2) },
  },

  /* PREFIX_VEX_0F381D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F381D_P_2) },
  },

  /* PREFIX_VEX_0F381E */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F381E_P_2) },
  },

  /* PREFIX_VEX_0F3820 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3820_P_2) },
  },

  /* PREFIX_VEX_0F3821 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3821_P_2) },
  },

  /* PREFIX_VEX_0F3822 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3822_P_2) },
  },

  /* PREFIX_VEX_0F3823 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3823_P_2) },
  },

  /* PREFIX_VEX_0F3824 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3824_P_2) },
  },

  /* PREFIX_VEX_0F3825 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3825_P_2) },
  },

  /* PREFIX_VEX_0F3828 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3828_P_2) },
  },

  /* PREFIX_VEX_0F3829 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3829_P_2) },
  },

  /* PREFIX_VEX_0F382A */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0F382A_PREFIX_2) },
  },

  /* PREFIX_VEX_0F382B */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F382B_P_2) },
  },

  /* PREFIX_VEX_0F382C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
     { MOD_TABLE (MOD_VEX_0F382C_PREFIX_2) },
  },

  /* PREFIX_VEX_0F382D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
     { MOD_TABLE (MOD_VEX_0F382D_PREFIX_2) },
  },

  /* PREFIX_VEX_0F382E */
  {
    { Bad_Opcode },
    { Bad_Opcode },
     { MOD_TABLE (MOD_VEX_0F382E_PREFIX_2) },
  },

  /* PREFIX_VEX_0F382F */
  {
    { Bad_Opcode },
    { Bad_Opcode },
     { MOD_TABLE (MOD_VEX_0F382F_PREFIX_2) },
  },

  /* PREFIX_VEX_0F3830 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3830_P_2) },
  },

  /* PREFIX_VEX_0F3831 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3831_P_2) },
  },

  /* PREFIX_VEX_0F3832 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3832_P_2) },
  },

  /* PREFIX_VEX_0F3833 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3833_P_2) },
  },

  /* PREFIX_VEX_0F3834 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3834_P_2) },
  },

  /* PREFIX_VEX_0F3835 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3835_P_2) },
  },

  /* PREFIX_VEX_0F3836 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3836_P_2) },
  },

  /* PREFIX_VEX_0F3837 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3837_P_2) },
  },

  /* PREFIX_VEX_0F3838 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3838_P_2) },
  },

  /* PREFIX_VEX_0F3839 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3839_P_2) },
  },

  /* PREFIX_VEX_0F383A */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F383A_P_2) },
  },

  /* PREFIX_VEX_0F383B */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F383B_P_2) },
  },

  /* PREFIX_VEX_0F383C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F383C_P_2) },
  },

  /* PREFIX_VEX_0F383D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F383D_P_2) },
  },

  /* PREFIX_VEX_0F383E */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F383E_P_2) },
  },

  /* PREFIX_VEX_0F383F */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F383F_P_2) },
  },

  /* PREFIX_VEX_0F3840 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3840_P_2) },
  },

  /* PREFIX_VEX_0F3841 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3841_P_2) },
  },

  /* PREFIX_VEX_0F3845 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vpsrlv%LW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F3846 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3846_P_2) },
  },

  /* PREFIX_VEX_0F3847 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vpsllv%LW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F3858 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3858_P_2) },
  },

  /* PREFIX_VEX_0F3859 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3859_P_2) },
  },

  /* PREFIX_VEX_0F385A */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0F385A_PREFIX_2) },
  },

  /* PREFIX_VEX_0F3878 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3878_P_2) },
  },

  /* PREFIX_VEX_0F3879 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3879_P_2) },
  },

  /* PREFIX_VEX_0F388C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0F388C_PREFIX_2) },
  },

  /* PREFIX_VEX_0F388E */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { MOD_TABLE (MOD_VEX_0F388E_PREFIX_2) },
  },

  /* PREFIX_VEX_0F3890 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vpgatherd%LW", { XM, MVexVSIBDWpX, Vex } },
  },

  /* PREFIX_VEX_0F3891 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vpgatherq%LW", { XMGatherQ, MVexVSIBQWpX, VexGatherQ } },
  },

  /* PREFIX_VEX_0F3892 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vgatherdp%XW", { XM, MVexVSIBDWpX, Vex } },
  },

  /* PREFIX_VEX_0F3893 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vgatherqp%XW", { XMGatherQ, MVexVSIBQWpX, VexGatherQ } },
  },

  /* PREFIX_VEX_0F3896 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmaddsub132p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F3897 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmsubadd132p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F3898 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmadd132p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F3899 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmadd132s%XW", { XMScalar, VexScalar, EXVexWdqScalar } },
  },

  /* PREFIX_VEX_0F389A */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmsub132p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F389B */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmsub132s%XW", { XMScalar, VexScalar, EXVexWdqScalar } },
  },

  /* PREFIX_VEX_0F389C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmadd132p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F389D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmadd132s%XW", { XMScalar, VexScalar, EXVexWdqScalar } },
  },

  /* PREFIX_VEX_0F389E */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmsub132p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F389F */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmsub132s%XW", { XMScalar, VexScalar, EXVexWdqScalar } },
  },

  /* PREFIX_VEX_0F38A6 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmaddsub213p%XW", { XM, Vex, EXx } },
    { Bad_Opcode },
  },

  /* PREFIX_VEX_0F38A7 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmsubadd213p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F38A8 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmadd213p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F38A9 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmadd213s%XW", { XMScalar, VexScalar, EXVexWdqScalar } },
  },

  /* PREFIX_VEX_0F38AA */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmsub213p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F38AB */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmsub213s%XW", { XMScalar, VexScalar, EXVexWdqScalar } },
  },

  /* PREFIX_VEX_0F38AC */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmadd213p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F38AD */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmadd213s%XW", { XMScalar, VexScalar, EXVexWdqScalar } },
  },

  /* PREFIX_VEX_0F38AE */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmsub213p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F38AF */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmsub213s%XW", { XMScalar, VexScalar, EXVexWdqScalar } },
  },

  /* PREFIX_VEX_0F38B6 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmaddsub231p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F38B7 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmsubadd231p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F38B8 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmadd231p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F38B9 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmadd231s%XW", { XMScalar, VexScalar, EXVexWdqScalar } },
  },

  /* PREFIX_VEX_0F38BA */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmsub231p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F38BB */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmsub231s%XW", { XMScalar, VexScalar, EXVexWdqScalar } },
  },

  /* PREFIX_VEX_0F38BC */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmadd231p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F38BD */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmadd231s%XW", { XMScalar, VexScalar, EXVexWdqScalar } },
  },

  /* PREFIX_VEX_0F38BE */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmsub231p%XW", { XM, Vex, EXx } },
  },

  /* PREFIX_VEX_0F38BF */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmsub231s%XW", { XMScalar, VexScalar, EXVexWdqScalar } },
  },

  /* PREFIX_VEX_0F38DB */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F38DB_P_2) },
  },

  /* PREFIX_VEX_0F38DC */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F38DC_P_2) },
  },

  /* PREFIX_VEX_0F38DD */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F38DD_P_2) },
  },

  /* PREFIX_VEX_0F38DE */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F38DE_P_2) },
  },

  /* PREFIX_VEX_0F38DF */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F38DF_P_2) },
  },

  /* PREFIX_VEX_0F38F2 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F38F2_P_0) },
  },

  /* PREFIX_VEX_0F38F3_REG_1 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F38F3_R_1_P_0) },
  },

  /* PREFIX_VEX_0F38F3_REG_2 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F38F3_R_2_P_0) },
  },

  /* PREFIX_VEX_0F38F3_REG_3 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F38F3_R_3_P_0) },
  },

  /* PREFIX_VEX_0F38F5 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F38F5_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F38F5_P_1) },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F38F5_P_3) },
  },

  /* PREFIX_VEX_0F38F6 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F38F6_P_3) },
  },

  /* PREFIX_VEX_0F38F7 */
  {
    { VEX_LEN_TABLE (VEX_LEN_0F38F7_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F38F7_P_1) },
    { VEX_LEN_TABLE (VEX_LEN_0F38F7_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_0F38F7_P_3) },
  },

  /* PREFIX_VEX_0F3A00 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A00_P_2) },
  },

  /* PREFIX_VEX_0F3A01 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A01_P_2) },
  },

  /* PREFIX_VEX_0F3A02 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A02_P_2) },
  },

  /* PREFIX_VEX_0F3A04 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A04_P_2) },
  },

  /* PREFIX_VEX_0F3A05 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A05_P_2) },
  },

  /* PREFIX_VEX_0F3A06 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A06_P_2) },
  },

  /* PREFIX_VEX_0F3A08 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A08_P_2) },
  },

  /* PREFIX_VEX_0F3A09 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A09_P_2) },
  },

  /* PREFIX_VEX_0F3A0A */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A0A_P_2) },
  },

  /* PREFIX_VEX_0F3A0B */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A0B_P_2) },
  },

  /* PREFIX_VEX_0F3A0C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A0C_P_2) },
  },

  /* PREFIX_VEX_0F3A0D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A0D_P_2) },
  },

  /* PREFIX_VEX_0F3A0E */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A0E_P_2) },
  },

  /* PREFIX_VEX_0F3A0F */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A0F_P_2) },
  },

  /* PREFIX_VEX_0F3A14 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A14_P_2) },
  },

  /* PREFIX_VEX_0F3A15 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A15_P_2) },
  },

  /* PREFIX_VEX_0F3A16 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A16_P_2) },
  },

  /* PREFIX_VEX_0F3A17 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A17_P_2) },
  },

  /* PREFIX_VEX_0F3A18 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A18_P_2) },
  },

  /* PREFIX_VEX_0F3A19 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A19_P_2) },
  },

  /* PREFIX_VEX_0F3A1D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vcvtps2ph", { EXxmmq, XM, Ib } },
  },

  /* PREFIX_VEX_0F3A20 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A20_P_2) },
  },

  /* PREFIX_VEX_0F3A21 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A21_P_2) },
  },

  /* PREFIX_VEX_0F3A22 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A22_P_2) },
  },

  /* PREFIX_VEX_0F3A30 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A30_P_2) },
  },

  /* PREFIX_VEX_0F3A32 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A32_P_2) },
  },

  /* PREFIX_VEX_0F3A38 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A38_P_2) },
  },

  /* PREFIX_VEX_0F3A39 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A39_P_2) },
  },

  /* PREFIX_VEX_0F3A40 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A40_P_2) },
  },

  /* PREFIX_VEX_0F3A41 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A41_P_2) },
  },

  /* PREFIX_VEX_0F3A42 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A42_P_2) },
  },

  /* PREFIX_VEX_0F3A44 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A44_P_2) },
  },

  /* PREFIX_VEX_0F3A46 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A46_P_2) },
  },

  /* PREFIX_VEX_0F3A48 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A48_P_2) },
  },

  /* PREFIX_VEX_0F3A49 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A49_P_2) },
  },

  /* PREFIX_VEX_0F3A4A */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A4A_P_2) },
  },

  /* PREFIX_VEX_0F3A4B */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A4B_P_2) },
  },

  /* PREFIX_VEX_0F3A4C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A4C_P_2) },
  },

  /* PREFIX_VEX_0F3A5C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmaddsubps", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
  },

  /* PREFIX_VEX_0F3A5D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmaddsubpd", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
  },

  /* PREFIX_VEX_0F3A5E */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmsubaddps", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
  },

  /* PREFIX_VEX_0F3A5F */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmsubaddpd", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
  },

  /* PREFIX_VEX_0F3A60 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A60_P_2) },
    { Bad_Opcode },
  },

  /* PREFIX_VEX_0F3A61 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A61_P_2) },
  },

  /* PREFIX_VEX_0F3A62 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A62_P_2) },
  },

  /* PREFIX_VEX_0F3A63 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A63_P_2) },
  },

  /* PREFIX_VEX_0F3A68 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmaddps", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
  },

  /* PREFIX_VEX_0F3A69 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmaddpd", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
  },

  /* PREFIX_VEX_0F3A6A */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A6A_P_2) },
  },

  /* PREFIX_VEX_0F3A6B */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A6B_P_2) },
  },

  /* PREFIX_VEX_0F3A6C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmsubps", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
  },

  /* PREFIX_VEX_0F3A6D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfmsubpd", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
  },

  /* PREFIX_VEX_0F3A6E */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A6E_P_2) },
  },

  /* PREFIX_VEX_0F3A6F */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A6F_P_2) },
  },

  /* PREFIX_VEX_0F3A78 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmaddps", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
  },

  /* PREFIX_VEX_0F3A79 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmaddpd", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
  },

  /* PREFIX_VEX_0F3A7A */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A7A_P_2) },
  },

  /* PREFIX_VEX_0F3A7B */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A7B_P_2) },
  },

  /* PREFIX_VEX_0F3A7C */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmsubps", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    { Bad_Opcode },
  },

  /* PREFIX_VEX_0F3A7D */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { "vfnmsubpd", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
  },

  /* PREFIX_VEX_0F3A7E */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A7E_P_2) },
  },

  /* PREFIX_VEX_0F3A7F */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3A7F_P_2) },
  },

  /* PREFIX_VEX_0F3ADF */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3ADF_P_2) },
  },

  /* PREFIX_VEX_0F3AF0 */
  {
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0F3AF0_P_3) },
  },

#define NEED_PREFIX_TABLE
#include "i386-dis-evex.h"
#undef NEED_PREFIX_TABLE
};

static const struct dis386 x86_64_table[][2] = {
  /* X86_64_06 */
  {
    { "pushP", { es } },
  },

  /* X86_64_07 */
  {
    { "popP", { es } },
  },

  /* X86_64_0D */
  {
    { "pushP", { cs } },
  },

  /* X86_64_16 */
  {
    { "pushP", { ss } },
  },

  /* X86_64_17 */
  {
    { "popP", { ss } },
  },

  /* X86_64_1E */
  {
    { "pushP", { ds } },
  },

  /* X86_64_1F */
  {
    { "popP", { ds } },
  },

  /* X86_64_27 */
  {
    { "daa", { XX } },
  },

  /* X86_64_2F */
  {
    { "das", { XX } },
  },

  /* X86_64_37 */
  {
    { "aaa", { XX } },
  },

  /* X86_64_3F */
  {
    { "aas", { XX } },
  },

  /* X86_64_60 */
  {
    { "pushaP", { XX } },
  },

  /* X86_64_61 */
  {
    { "popaP", { XX } },
  },

  /* X86_64_62 */
  {
    { MOD_TABLE (MOD_62_32BIT) },
    { EVEX_TABLE (EVEX_0F) },
  },

  /* X86_64_63 */
  {
    { "arpl", { Ew, Gw } },
    { "movs{lq|xd}", { Gv, Ed } },
  },

  /* X86_64_6D */
  {
    { "ins{R|}", { Yzr, indirDX } },
    { "ins{G|}", { Yzr, indirDX } },
  },

  /* X86_64_6F */
  {
    { "outs{R|}", { indirDXr, Xz } },
    { "outs{G|}", { indirDXr, Xz } },
  },

  /* X86_64_9A */
  {
    { "Jcall{T|}", { Ap } },
  },

  /* X86_64_C4 */
  {
    { MOD_TABLE (MOD_C4_32BIT) },
    { VEX_C4_TABLE (VEX_0F) },
  },

  /* X86_64_C5 */
  {
    { MOD_TABLE (MOD_C5_32BIT) },
    { VEX_C5_TABLE (VEX_0F) },
  },

  /* X86_64_CE */
  {
    { "into", { XX } },
  },

  /* X86_64_D4 */
  {
    { "aam", { Ib } },
  },

  /* X86_64_D5 */
  {
    { "aad", { Ib } },
  },

  /* X86_64_EA */
  {
    { "Jjmp{T|}", { Ap } },
  },

  /* X86_64_0F01_REG_0 */
  {
    { "sgdt{Q|IQ}", { M } },
    { "sgdt", { M } },
  },

  /* X86_64_0F01_REG_1 */
  {
    { "sidt{Q|IQ}", { M } },
    { "sidt", { M } },
  },

  /* X86_64_0F01_REG_2 */
  {
    { "lgdt{Q|Q}", { M } },
    { "lgdt", { M } },
  },

  /* X86_64_0F01_REG_3 */
  {
    { "lidt{Q|Q}", { M } },
    { "lidt", { M } },
  },
};

static const struct dis386 three_byte_table[][256] = {

  /* THREE_BYTE_0F38 */
  {
    /* 00 */
    { "pshufb",		{ MX, EM } },
    { "phaddw",		{ MX, EM } },
    { "phaddd",		{ MX, EM } },
    { "phaddsw",	{ MX, EM } },
    { "pmaddubsw",	{ MX, EM } },
    { "phsubw",		{ MX, EM } },
    { "phsubd",		{ MX, EM } },
    { "phsubsw",	{ MX, EM } },
    /* 08 */
    { "psignb",		{ MX, EM } },
    { "psignw",		{ MX, EM } },
    { "psignd",		{ MX, EM } },
    { "pmulhrsw",	{ MX, EM } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 10 */
    { PREFIX_TABLE (PREFIX_0F3810) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_0F3814) },
    { PREFIX_TABLE (PREFIX_0F3815) },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_0F3817) },
    /* 18 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { "pabsb",		{ MX, EM } },
    { "pabsw",		{ MX, EM } },
    { "pabsd",		{ MX, EM } },
    { Bad_Opcode },
    /* 20 */
    { PREFIX_TABLE (PREFIX_0F3820) },
    { PREFIX_TABLE (PREFIX_0F3821) },
    { PREFIX_TABLE (PREFIX_0F3822) },
    { PREFIX_TABLE (PREFIX_0F3823) },
    { PREFIX_TABLE (PREFIX_0F3824) },
    { PREFIX_TABLE (PREFIX_0F3825) },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 28 */
    { PREFIX_TABLE (PREFIX_0F3828) },
    { PREFIX_TABLE (PREFIX_0F3829) },
    { PREFIX_TABLE (PREFIX_0F382A) },
    { PREFIX_TABLE (PREFIX_0F382B) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 30 */
    { PREFIX_TABLE (PREFIX_0F3830) },
    { PREFIX_TABLE (PREFIX_0F3831) },
    { PREFIX_TABLE (PREFIX_0F3832) },
    { PREFIX_TABLE (PREFIX_0F3833) },
    { PREFIX_TABLE (PREFIX_0F3834) },
    { PREFIX_TABLE (PREFIX_0F3835) },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_0F3837) },
    /* 38 */
    { PREFIX_TABLE (PREFIX_0F3838) },
    { PREFIX_TABLE (PREFIX_0F3839) },
    { PREFIX_TABLE (PREFIX_0F383A) },
    { PREFIX_TABLE (PREFIX_0F383B) },
    { PREFIX_TABLE (PREFIX_0F383C) },
    { PREFIX_TABLE (PREFIX_0F383D) },
    { PREFIX_TABLE (PREFIX_0F383E) },
    { PREFIX_TABLE (PREFIX_0F383F) },
    /* 40 */
    { PREFIX_TABLE (PREFIX_0F3840) },
    { PREFIX_TABLE (PREFIX_0F3841) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 48 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 50 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 58 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 60 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 68 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 70 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 78 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 80 */
    { PREFIX_TABLE (PREFIX_0F3880) },
    { PREFIX_TABLE (PREFIX_0F3881) },
    { PREFIX_TABLE (PREFIX_0F3882) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 88 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 90 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 98 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* a0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* a8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* b0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* b8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c8 */
    { PREFIX_TABLE (PREFIX_0F38C8) },
    { PREFIX_TABLE (PREFIX_0F38C9) },
    { PREFIX_TABLE (PREFIX_0F38CA) },
    { PREFIX_TABLE (PREFIX_0F38CB) },
    { PREFIX_TABLE (PREFIX_0F38CC) },
    { PREFIX_TABLE (PREFIX_0F38CD) },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_0F38DB) },
    { PREFIX_TABLE (PREFIX_0F38DC) },
    { PREFIX_TABLE (PREFIX_0F38DD) },
    { PREFIX_TABLE (PREFIX_0F38DE) },
    { PREFIX_TABLE (PREFIX_0F38DF) },
    /* e0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* e8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* f0 */
    { PREFIX_TABLE (PREFIX_0F38F0) },
    { PREFIX_TABLE (PREFIX_0F38F1) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_0F38F6) },
    { Bad_Opcode },
    /* f8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
  },
  /* THREE_BYTE_0F3A */
  {
    /* 00 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 08 */
    { PREFIX_TABLE (PREFIX_0F3A08) },
    { PREFIX_TABLE (PREFIX_0F3A09) },
    { PREFIX_TABLE (PREFIX_0F3A0A) },
    { PREFIX_TABLE (PREFIX_0F3A0B) },
    { PREFIX_TABLE (PREFIX_0F3A0C) },
    { PREFIX_TABLE (PREFIX_0F3A0D) },
    { PREFIX_TABLE (PREFIX_0F3A0E) },
    { "palignr",	{ MX, EM, Ib } },
    /* 10 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_0F3A14) },
    { PREFIX_TABLE (PREFIX_0F3A15) },
    { PREFIX_TABLE (PREFIX_0F3A16) },
    { PREFIX_TABLE (PREFIX_0F3A17) },
    /* 18 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 20 */
    { PREFIX_TABLE (PREFIX_0F3A20) },
    { PREFIX_TABLE (PREFIX_0F3A21) },
    { PREFIX_TABLE (PREFIX_0F3A22) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 28 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 30 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 38 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 40 */
    { PREFIX_TABLE (PREFIX_0F3A40) },
    { PREFIX_TABLE (PREFIX_0F3A41) },
    { PREFIX_TABLE (PREFIX_0F3A42) },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_0F3A44) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 48 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 50 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 58 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 60 */
    { PREFIX_TABLE (PREFIX_0F3A60) },
    { PREFIX_TABLE (PREFIX_0F3A61) },
    { PREFIX_TABLE (PREFIX_0F3A62) },
    { PREFIX_TABLE (PREFIX_0F3A63) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 68 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 70 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 78 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 80 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 88 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 90 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 98 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* a0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* a8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* b0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* b8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_0F3ACC) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_0F3ADF) },
    /* e0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* e8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* f0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* f8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
  },

  /* THREE_BYTE_0F7A */
  {
    /* 00 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 08 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 10 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 18 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 20 */
    { "ptest",		{ XX } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 28 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 30 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 38 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 40 */
    { Bad_Opcode },
    { "phaddbw",	{ XM, EXq } },
    { "phaddbd",	{ XM, EXq } },
    { "phaddbq",	{ XM, EXq } },
    { Bad_Opcode },
    { Bad_Opcode },
    { "phaddwd",	{ XM, EXq } },
    { "phaddwq",	{ XM, EXq } },
    /* 48 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { "phadddq",	{ XM, EXq } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 50 */
    { Bad_Opcode },
    { "phaddubw",	{ XM, EXq } },
    { "phaddubd",	{ XM, EXq } },
    { "phaddubq",	{ XM, EXq } },
    { Bad_Opcode },
    { Bad_Opcode },
    { "phadduwd",	{ XM, EXq } },
    { "phadduwq",	{ XM, EXq } },
    /* 58 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { "phaddudq",	{ XM, EXq } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 60 */
    { Bad_Opcode },
    { "phsubbw",	{ XM, EXq } },
    { "phsubbd",	{ XM, EXq } },
    { "phsubbq",	{ XM, EXq } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 68 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 70 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 78 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 80 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 88 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 90 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 98 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* a0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* a8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* b0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* b8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* e0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* e8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* f0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* f8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
  },
};

static const struct dis386 xop_table[][256] = {
  /* XOP_08 */
  {
    /* 00 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 08 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 10 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 18 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 20 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 28 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 30 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 38 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 40 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 48 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 50 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 58 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 60 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 68 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 70 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 78 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 80 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { "vpmacssww", 	{ XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    { "vpmacsswd", 	{ XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    { "vpmacssdql", 	{ XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    /* 88 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { "vpmacssdd", 	{ XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    { "vpmacssdqh", 	{ XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    /* 90 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { "vpmacsww", 	{ XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    { "vpmacswd", 	{ XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    { "vpmacsdql", 	{ XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    /* 98 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { "vpmacsdd", 	{ XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    { "vpmacsdqh", 	{ XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    /* a0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { "vpcmov", 	{ XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    { "vpperm", 	{ XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    { Bad_Opcode },
    { Bad_Opcode },
    { "vpmadcsswd", 	{ XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    { Bad_Opcode },
    /* a8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* b0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { "vpmadcswd", 	{ XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
    { Bad_Opcode },
    /* b8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c0 */
    { "vprotb", 	{ XM, Vex_2src_1, Ib } },
    { "vprotw", 	{ XM, Vex_2src_1, Ib } },
    { "vprotd", 	{ XM, Vex_2src_1, Ib } },
    { "vprotq", 	{ XM, Vex_2src_1, Ib } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0FXOP_08_CC) },
    { VEX_LEN_TABLE (VEX_LEN_0FXOP_08_CD) },
    { VEX_LEN_TABLE (VEX_LEN_0FXOP_08_CE) },
    { VEX_LEN_TABLE (VEX_LEN_0FXOP_08_CF) },
    /* d0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* e0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* e8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { VEX_LEN_TABLE (VEX_LEN_0FXOP_08_EC) },
    { VEX_LEN_TABLE (VEX_LEN_0FXOP_08_ED) },
    { VEX_LEN_TABLE (VEX_LEN_0FXOP_08_EE) },
    { VEX_LEN_TABLE (VEX_LEN_0FXOP_08_EF) },
    /* f0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* f8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
  },
  /* XOP_09 */
  {
    /* 00 */
    { Bad_Opcode },
    { REG_TABLE (REG_XOP_TBM_01) },
    { REG_TABLE (REG_XOP_TBM_02) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 08 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 10 */
    { Bad_Opcode },
    { Bad_Opcode },
    { REG_TABLE (REG_XOP_LWPCB) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 18 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 20 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 28 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 30 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 38 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 40 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 48 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 50 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 58 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 60 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 68 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 70 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 78 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 80 */
    { VEX_LEN_TABLE (VEX_LEN_0FXOP_09_80) },
    { VEX_LEN_TABLE (VEX_LEN_0FXOP_09_81) },
    { "vfrczss", 	{ XM, EXd } },
    { "vfrczsd", 	{ XM, EXq } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 88 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 90 */
    { "vprotb",		{ XM, Vex_2src_1, Vex_2src_2 } },
    { "vprotw",		{ XM, Vex_2src_1, Vex_2src_2 } },
    { "vprotd",		{ XM, Vex_2src_1, Vex_2src_2 } },
    { "vprotq",		{ XM, Vex_2src_1, Vex_2src_2 } },
    { "vpshlb",		{ XM, Vex_2src_1, Vex_2src_2 } },
    { "vpshlw",		{ XM, Vex_2src_1, Vex_2src_2 } },
    { "vpshld",		{ XM, Vex_2src_1, Vex_2src_2 } },
    { "vpshlq",		{ XM, Vex_2src_1, Vex_2src_2 } },
    /* 98 */
    { "vpshab",		{ XM, Vex_2src_1, Vex_2src_2 } },
    { "vpshaw",		{ XM, Vex_2src_1, Vex_2src_2 } },
    { "vpshad",		{ XM, Vex_2src_1, Vex_2src_2 } },
    { "vpshaq",		{ XM, Vex_2src_1, Vex_2src_2 } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* a0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* a8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* b0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* b8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c0 */
    { Bad_Opcode },
    { "vphaddbw",	{ XM, EXxmm } },
    { "vphaddbd",	{ XM, EXxmm } },
    { "vphaddbq",	{ XM, EXxmm } },
    { Bad_Opcode },
    { Bad_Opcode },
    { "vphaddwd",	{ XM, EXxmm } },
    { "vphaddwq",	{ XM, EXxmm } },
    /* c8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { "vphadddq",	{ XM, EXxmm } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d0 */
    { Bad_Opcode },
    { "vphaddubw",	{ XM, EXxmm } },
    { "vphaddubd",	{ XM, EXxmm } },
    { "vphaddubq",	{ XM, EXxmm } },
    { Bad_Opcode },
    { Bad_Opcode },
    { "vphadduwd",	{ XM, EXxmm } },
    { "vphadduwq",	{ XM, EXxmm } },
    /* d8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { "vphaddudq",	{ XM, EXxmm } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* e0 */
    { Bad_Opcode },
    { "vphsubbw",	{ XM, EXxmm } },
    { "vphsubwd",	{ XM, EXxmm } },
    { "vphsubdq",	{ XM, EXxmm } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* e8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* f0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* f8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
  },
  /* XOP_0A */
  {
    /* 00 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 08 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 10 */
    { "bextr",	{ Gv, Ev, Iq } },
    { Bad_Opcode },
    { REG_TABLE (REG_XOP_LWP) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 18 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 20 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 28 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 30 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 38 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 40 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 48 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 50 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 58 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 60 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 68 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 70 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 78 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 80 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 88 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 90 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 98 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* a0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* a8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* b0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* b8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* e0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* e8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* f0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* f8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
  },
};

static const struct dis386 vex_table[][256] = {
  /* VEX_0F */
  {
    /* 00 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 08 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 10 */
    { PREFIX_TABLE (PREFIX_VEX_0F10) },
    { PREFIX_TABLE (PREFIX_VEX_0F11) },
    { PREFIX_TABLE (PREFIX_VEX_0F12) },
    { MOD_TABLE (MOD_VEX_0F13) },
    { VEX_W_TABLE (VEX_W_0F14) },
    { VEX_W_TABLE (VEX_W_0F15) },
    { PREFIX_TABLE (PREFIX_VEX_0F16) },
    { MOD_TABLE (MOD_VEX_0F17) },
    /* 18 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 20 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 28 */
    { VEX_W_TABLE (VEX_W_0F28) },
    { VEX_W_TABLE (VEX_W_0F29) },
    { PREFIX_TABLE (PREFIX_VEX_0F2A) },
    { MOD_TABLE (MOD_VEX_0F2B) },
    { PREFIX_TABLE (PREFIX_VEX_0F2C) },
    { PREFIX_TABLE (PREFIX_VEX_0F2D) },
    { PREFIX_TABLE (PREFIX_VEX_0F2E) },
    { PREFIX_TABLE (PREFIX_VEX_0F2F) },
    /* 30 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 38 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 40 */
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F41) },
    { PREFIX_TABLE (PREFIX_VEX_0F42) },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F44) },
    { PREFIX_TABLE (PREFIX_VEX_0F45) },
    { PREFIX_TABLE (PREFIX_VEX_0F46) },
    { PREFIX_TABLE (PREFIX_VEX_0F47) },
    /* 48 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F4B) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 50 */
    { MOD_TABLE (MOD_VEX_0F50) },
    { PREFIX_TABLE (PREFIX_VEX_0F51) },
    { PREFIX_TABLE (PREFIX_VEX_0F52) },
    { PREFIX_TABLE (PREFIX_VEX_0F53) },
    { "vandpX",		{ XM, Vex, EXx } },
    { "vandnpX",	{ XM, Vex, EXx } },
    { "vorpX",		{ XM, Vex, EXx } },
    { "vxorpX",		{ XM, Vex, EXx } },
    /* 58 */
    { PREFIX_TABLE (PREFIX_VEX_0F58) },
    { PREFIX_TABLE (PREFIX_VEX_0F59) },
    { PREFIX_TABLE (PREFIX_VEX_0F5A) },
    { PREFIX_TABLE (PREFIX_VEX_0F5B) },
    { PREFIX_TABLE (PREFIX_VEX_0F5C) },
    { PREFIX_TABLE (PREFIX_VEX_0F5D) },
    { PREFIX_TABLE (PREFIX_VEX_0F5E) },
    { PREFIX_TABLE (PREFIX_VEX_0F5F) },
    /* 60 */
    { PREFIX_TABLE (PREFIX_VEX_0F60) },
    { PREFIX_TABLE (PREFIX_VEX_0F61) },
    { PREFIX_TABLE (PREFIX_VEX_0F62) },
    { PREFIX_TABLE (PREFIX_VEX_0F63) },
    { PREFIX_TABLE (PREFIX_VEX_0F64) },
    { PREFIX_TABLE (PREFIX_VEX_0F65) },
    { PREFIX_TABLE (PREFIX_VEX_0F66) },
    { PREFIX_TABLE (PREFIX_VEX_0F67) },
    /* 68 */
    { PREFIX_TABLE (PREFIX_VEX_0F68) },
    { PREFIX_TABLE (PREFIX_VEX_0F69) },
    { PREFIX_TABLE (PREFIX_VEX_0F6A) },
    { PREFIX_TABLE (PREFIX_VEX_0F6B) },
    { PREFIX_TABLE (PREFIX_VEX_0F6C) },
    { PREFIX_TABLE (PREFIX_VEX_0F6D) },
    { PREFIX_TABLE (PREFIX_VEX_0F6E) },
    { PREFIX_TABLE (PREFIX_VEX_0F6F) },
    /* 70 */
    { PREFIX_TABLE (PREFIX_VEX_0F70) },
    { REG_TABLE (REG_VEX_0F71) },
    { REG_TABLE (REG_VEX_0F72) },
    { REG_TABLE (REG_VEX_0F73) },
    { PREFIX_TABLE (PREFIX_VEX_0F74) },
    { PREFIX_TABLE (PREFIX_VEX_0F75) },
    { PREFIX_TABLE (PREFIX_VEX_0F76) },
    { PREFIX_TABLE (PREFIX_VEX_0F77) },
    /* 78 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F7C) },
    { PREFIX_TABLE (PREFIX_VEX_0F7D) },
    { PREFIX_TABLE (PREFIX_VEX_0F7E) },
    { PREFIX_TABLE (PREFIX_VEX_0F7F) },
    /* 80 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 88 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 90 */
    { PREFIX_TABLE (PREFIX_VEX_0F90) },
    { PREFIX_TABLE (PREFIX_VEX_0F91) },
    { PREFIX_TABLE (PREFIX_VEX_0F92) },
    { PREFIX_TABLE (PREFIX_VEX_0F93) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 98 */
    { PREFIX_TABLE (PREFIX_VEX_0F98) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* a0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* a8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { REG_TABLE (REG_VEX_0FAE) },
    { Bad_Opcode },
    /* b0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* b8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0FC2) },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0FC4) },
    { PREFIX_TABLE (PREFIX_VEX_0FC5) },
    { "vshufpX",	{ XM, Vex, EXx, Ib } },
    { Bad_Opcode },
    /* c8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d0 */
    { PREFIX_TABLE (PREFIX_VEX_0FD0) },
    { PREFIX_TABLE (PREFIX_VEX_0FD1) },
    { PREFIX_TABLE (PREFIX_VEX_0FD2) },
    { PREFIX_TABLE (PREFIX_VEX_0FD3) },
    { PREFIX_TABLE (PREFIX_VEX_0FD4) },
    { PREFIX_TABLE (PREFIX_VEX_0FD5) },
    { PREFIX_TABLE (PREFIX_VEX_0FD6) },
    { PREFIX_TABLE (PREFIX_VEX_0FD7) },
    /* d8 */
    { PREFIX_TABLE (PREFIX_VEX_0FD8) },
    { PREFIX_TABLE (PREFIX_VEX_0FD9) },
    { PREFIX_TABLE (PREFIX_VEX_0FDA) },
    { PREFIX_TABLE (PREFIX_VEX_0FDB) },
    { PREFIX_TABLE (PREFIX_VEX_0FDC) },
    { PREFIX_TABLE (PREFIX_VEX_0FDD) },
    { PREFIX_TABLE (PREFIX_VEX_0FDE) },
    { PREFIX_TABLE (PREFIX_VEX_0FDF) },
    /* e0 */
    { PREFIX_TABLE (PREFIX_VEX_0FE0) },
    { PREFIX_TABLE (PREFIX_VEX_0FE1) },
    { PREFIX_TABLE (PREFIX_VEX_0FE2) },
    { PREFIX_TABLE (PREFIX_VEX_0FE3) },
    { PREFIX_TABLE (PREFIX_VEX_0FE4) },
    { PREFIX_TABLE (PREFIX_VEX_0FE5) },
    { PREFIX_TABLE (PREFIX_VEX_0FE6) },
    { PREFIX_TABLE (PREFIX_VEX_0FE7) },
    /* e8 */
    { PREFIX_TABLE (PREFIX_VEX_0FE8) },
    { PREFIX_TABLE (PREFIX_VEX_0FE9) },
    { PREFIX_TABLE (PREFIX_VEX_0FEA) },
    { PREFIX_TABLE (PREFIX_VEX_0FEB) },
    { PREFIX_TABLE (PREFIX_VEX_0FEC) },
    { PREFIX_TABLE (PREFIX_VEX_0FED) },
    { PREFIX_TABLE (PREFIX_VEX_0FEE) },
    { PREFIX_TABLE (PREFIX_VEX_0FEF) },
    /* f0 */
    { PREFIX_TABLE (PREFIX_VEX_0FF0) },
    { PREFIX_TABLE (PREFIX_VEX_0FF1) },
    { PREFIX_TABLE (PREFIX_VEX_0FF2) },
    { PREFIX_TABLE (PREFIX_VEX_0FF3) },
    { PREFIX_TABLE (PREFIX_VEX_0FF4) },
    { PREFIX_TABLE (PREFIX_VEX_0FF5) },
    { PREFIX_TABLE (PREFIX_VEX_0FF6) },
    { PREFIX_TABLE (PREFIX_VEX_0FF7) },
    /* f8 */
    { PREFIX_TABLE (PREFIX_VEX_0FF8) },
    { PREFIX_TABLE (PREFIX_VEX_0FF9) },
    { PREFIX_TABLE (PREFIX_VEX_0FFA) },
    { PREFIX_TABLE (PREFIX_VEX_0FFB) },
    { PREFIX_TABLE (PREFIX_VEX_0FFC) },
    { PREFIX_TABLE (PREFIX_VEX_0FFD) },
    { PREFIX_TABLE (PREFIX_VEX_0FFE) },
    { Bad_Opcode },
  },
  /* VEX_0F38 */
  {
    /* 00 */
    { PREFIX_TABLE (PREFIX_VEX_0F3800) },
    { PREFIX_TABLE (PREFIX_VEX_0F3801) },
    { PREFIX_TABLE (PREFIX_VEX_0F3802) },
    { PREFIX_TABLE (PREFIX_VEX_0F3803) },
    { PREFIX_TABLE (PREFIX_VEX_0F3804) },
    { PREFIX_TABLE (PREFIX_VEX_0F3805) },
    { PREFIX_TABLE (PREFIX_VEX_0F3806) },
    { PREFIX_TABLE (PREFIX_VEX_0F3807) },
    /* 08 */
    { PREFIX_TABLE (PREFIX_VEX_0F3808) },
    { PREFIX_TABLE (PREFIX_VEX_0F3809) },
    { PREFIX_TABLE (PREFIX_VEX_0F380A) },
    { PREFIX_TABLE (PREFIX_VEX_0F380B) },
    { PREFIX_TABLE (PREFIX_VEX_0F380C) },
    { PREFIX_TABLE (PREFIX_VEX_0F380D) },
    { PREFIX_TABLE (PREFIX_VEX_0F380E) },
    { PREFIX_TABLE (PREFIX_VEX_0F380F) },
    /* 10 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F3813) },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F3816) },
    { PREFIX_TABLE (PREFIX_VEX_0F3817) },
    /* 18 */
    { PREFIX_TABLE (PREFIX_VEX_0F3818) },
    { PREFIX_TABLE (PREFIX_VEX_0F3819) },
    { PREFIX_TABLE (PREFIX_VEX_0F381A) },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F381C) },
    { PREFIX_TABLE (PREFIX_VEX_0F381D) },
    { PREFIX_TABLE (PREFIX_VEX_0F381E) },
    { Bad_Opcode },
    /* 20 */
    { PREFIX_TABLE (PREFIX_VEX_0F3820) },
    { PREFIX_TABLE (PREFIX_VEX_0F3821) },
    { PREFIX_TABLE (PREFIX_VEX_0F3822) },
    { PREFIX_TABLE (PREFIX_VEX_0F3823) },
    { PREFIX_TABLE (PREFIX_VEX_0F3824) },
    { PREFIX_TABLE (PREFIX_VEX_0F3825) },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 28 */
    { PREFIX_TABLE (PREFIX_VEX_0F3828) },
    { PREFIX_TABLE (PREFIX_VEX_0F3829) },
    { PREFIX_TABLE (PREFIX_VEX_0F382A) },
    { PREFIX_TABLE (PREFIX_VEX_0F382B) },
    { PREFIX_TABLE (PREFIX_VEX_0F382C) },
    { PREFIX_TABLE (PREFIX_VEX_0F382D) },
    { PREFIX_TABLE (PREFIX_VEX_0F382E) },
    { PREFIX_TABLE (PREFIX_VEX_0F382F) },
    /* 30 */
    { PREFIX_TABLE (PREFIX_VEX_0F3830) },
    { PREFIX_TABLE (PREFIX_VEX_0F3831) },
    { PREFIX_TABLE (PREFIX_VEX_0F3832) },
    { PREFIX_TABLE (PREFIX_VEX_0F3833) },
    { PREFIX_TABLE (PREFIX_VEX_0F3834) },
    { PREFIX_TABLE (PREFIX_VEX_0F3835) },
    { PREFIX_TABLE (PREFIX_VEX_0F3836) },
    { PREFIX_TABLE (PREFIX_VEX_0F3837) },
    /* 38 */
    { PREFIX_TABLE (PREFIX_VEX_0F3838) },
    { PREFIX_TABLE (PREFIX_VEX_0F3839) },
    { PREFIX_TABLE (PREFIX_VEX_0F383A) },
    { PREFIX_TABLE (PREFIX_VEX_0F383B) },
    { PREFIX_TABLE (PREFIX_VEX_0F383C) },
    { PREFIX_TABLE (PREFIX_VEX_0F383D) },
    { PREFIX_TABLE (PREFIX_VEX_0F383E) },
    { PREFIX_TABLE (PREFIX_VEX_0F383F) },
    /* 40 */
    { PREFIX_TABLE (PREFIX_VEX_0F3840) },
    { PREFIX_TABLE (PREFIX_VEX_0F3841) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F3845) },
    { PREFIX_TABLE (PREFIX_VEX_0F3846) },
    { PREFIX_TABLE (PREFIX_VEX_0F3847) },
    /* 48 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 50 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 58 */
    { PREFIX_TABLE (PREFIX_VEX_0F3858) },
    { PREFIX_TABLE (PREFIX_VEX_0F3859) },
    { PREFIX_TABLE (PREFIX_VEX_0F385A) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 60 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 68 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 70 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 78 */
    { PREFIX_TABLE (PREFIX_VEX_0F3878) },
    { PREFIX_TABLE (PREFIX_VEX_0F3879) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 80 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 88 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F388C) },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F388E) },
    { Bad_Opcode },
    /* 90 */
    { PREFIX_TABLE (PREFIX_VEX_0F3890) },
    { PREFIX_TABLE (PREFIX_VEX_0F3891) },
    { PREFIX_TABLE (PREFIX_VEX_0F3892) },
    { PREFIX_TABLE (PREFIX_VEX_0F3893) },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F3896) },
    { PREFIX_TABLE (PREFIX_VEX_0F3897) },
    /* 98 */
    { PREFIX_TABLE (PREFIX_VEX_0F3898) },
    { PREFIX_TABLE (PREFIX_VEX_0F3899) },
    { PREFIX_TABLE (PREFIX_VEX_0F389A) },
    { PREFIX_TABLE (PREFIX_VEX_0F389B) },
    { PREFIX_TABLE (PREFIX_VEX_0F389C) },
    { PREFIX_TABLE (PREFIX_VEX_0F389D) },
    { PREFIX_TABLE (PREFIX_VEX_0F389E) },
    { PREFIX_TABLE (PREFIX_VEX_0F389F) },
    /* a0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F38A6) },
    { PREFIX_TABLE (PREFIX_VEX_0F38A7) },
    /* a8 */
    { PREFIX_TABLE (PREFIX_VEX_0F38A8) },
    { PREFIX_TABLE (PREFIX_VEX_0F38A9) },
    { PREFIX_TABLE (PREFIX_VEX_0F38AA) },
    { PREFIX_TABLE (PREFIX_VEX_0F38AB) },
    { PREFIX_TABLE (PREFIX_VEX_0F38AC) },
    { PREFIX_TABLE (PREFIX_VEX_0F38AD) },
    { PREFIX_TABLE (PREFIX_VEX_0F38AE) },
    { PREFIX_TABLE (PREFIX_VEX_0F38AF) },
    /* b0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F38B6) },
    { PREFIX_TABLE (PREFIX_VEX_0F38B7) },
    /* b8 */
    { PREFIX_TABLE (PREFIX_VEX_0F38B8) },
    { PREFIX_TABLE (PREFIX_VEX_0F38B9) },
    { PREFIX_TABLE (PREFIX_VEX_0F38BA) },
    { PREFIX_TABLE (PREFIX_VEX_0F38BB) },
    { PREFIX_TABLE (PREFIX_VEX_0F38BC) },
    { PREFIX_TABLE (PREFIX_VEX_0F38BD) },
    { PREFIX_TABLE (PREFIX_VEX_0F38BE) },
    { PREFIX_TABLE (PREFIX_VEX_0F38BF) },
    /* c0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F38DB) },
    { PREFIX_TABLE (PREFIX_VEX_0F38DC) },
    { PREFIX_TABLE (PREFIX_VEX_0F38DD) },
    { PREFIX_TABLE (PREFIX_VEX_0F38DE) },
    { PREFIX_TABLE (PREFIX_VEX_0F38DF) },
    /* e0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* e8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* f0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F38F2) },
    { REG_TABLE (REG_VEX_0F38F3) },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F38F5) },
    { PREFIX_TABLE (PREFIX_VEX_0F38F6) },
    { PREFIX_TABLE (PREFIX_VEX_0F38F7) },
    /* f8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
  },
  /* VEX_0F3A */
  {
    /* 00 */
    { PREFIX_TABLE (PREFIX_VEX_0F3A00) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A01) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A02) },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F3A04) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A05) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A06) },
    { Bad_Opcode },
    /* 08 */
    { PREFIX_TABLE (PREFIX_VEX_0F3A08) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A09) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A0A) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A0B) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A0C) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A0D) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A0E) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A0F) },
    /* 10 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F3A14) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A15) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A16) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A17) },
    /* 18 */
    { PREFIX_TABLE (PREFIX_VEX_0F3A18) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A19) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F3A1D) },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 20 */
    { PREFIX_TABLE (PREFIX_VEX_0F3A20) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A21) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A22) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 28 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 30 */
    { PREFIX_TABLE (PREFIX_VEX_0F3A30) },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F3A32) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 38 */
    { PREFIX_TABLE (PREFIX_VEX_0F3A38) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A39) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 40 */
    { PREFIX_TABLE (PREFIX_VEX_0F3A40) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A41) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A42) },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F3A44) },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F3A46) },
    { Bad_Opcode },
    /* 48 */
    { PREFIX_TABLE (PREFIX_VEX_0F3A48) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A49) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A4A) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A4B) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A4C) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 50 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 58 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F3A5C) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A5D) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A5E) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A5F) },
    /* 60 */
    { PREFIX_TABLE (PREFIX_VEX_0F3A60) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A61) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A62) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A63) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 68 */
    { PREFIX_TABLE (PREFIX_VEX_0F3A68) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A69) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A6A) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A6B) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A6C) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A6D) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A6E) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A6F) },
    /* 70 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 78 */
    { PREFIX_TABLE (PREFIX_VEX_0F3A78) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A79) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A7A) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A7B) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A7C) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A7D) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A7E) },
    { PREFIX_TABLE (PREFIX_VEX_0F3A7F) },
    /* 80 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 88 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 90 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* 98 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* a0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* a8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* b0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* b8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* c8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* d8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F3ADF) },
    /* e0 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* e8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* f0 */
    { PREFIX_TABLE (PREFIX_VEX_0F3AF0) },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    /* f8 */
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
  },
};

#define NEED_OPCODE_TABLE
#include "i386-dis-evex.h"
#undef NEED_OPCODE_TABLE
static const struct dis386 vex_len_table[][2] = {
  /* VEX_LEN_0F10_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0F10_P_1) },
    { VEX_W_TABLE (VEX_W_0F10_P_1) },
  },

  /* VEX_LEN_0F10_P_3 */
  {
    { VEX_W_TABLE (VEX_W_0F10_P_3) },
    { VEX_W_TABLE (VEX_W_0F10_P_3) },
  },

  /* VEX_LEN_0F11_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0F11_P_1) },
    { VEX_W_TABLE (VEX_W_0F11_P_1) },
  },

  /* VEX_LEN_0F11_P_3 */
  {
    { VEX_W_TABLE (VEX_W_0F11_P_3) },
    { VEX_W_TABLE (VEX_W_0F11_P_3) },
  },

  /* VEX_LEN_0F12_P_0_M_0 */
  {
    { VEX_W_TABLE (VEX_W_0F12_P_0_M_0) },
  },

  /* VEX_LEN_0F12_P_0_M_1 */
  {
    { VEX_W_TABLE (VEX_W_0F12_P_0_M_1) },
  },

  /* VEX_LEN_0F12_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F12_P_2) },
  },

  /* VEX_LEN_0F13_M_0 */
  {
    { VEX_W_TABLE (VEX_W_0F13_M_0) },
  },

  /* VEX_LEN_0F16_P_0_M_0 */
  {
    { VEX_W_TABLE (VEX_W_0F16_P_0_M_0) },
  },

  /* VEX_LEN_0F16_P_0_M_1 */
  {
    { VEX_W_TABLE (VEX_W_0F16_P_0_M_1) },
  },

  /* VEX_LEN_0F16_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F16_P_2) },
  },

  /* VEX_LEN_0F17_M_0 */
  {
    { VEX_W_TABLE (VEX_W_0F17_M_0) },
  },

  /* VEX_LEN_0F2A_P_1 */
  {
    { "vcvtsi2ss%LQ",	{ XMScalar, VexScalar, Ev } },
    { "vcvtsi2ss%LQ",	{ XMScalar, VexScalar, Ev } },
  },

  /* VEX_LEN_0F2A_P_3 */
  {
    { "vcvtsi2sd%LQ",	{ XMScalar, VexScalar, Ev } },
    { "vcvtsi2sd%LQ",	{ XMScalar, VexScalar, Ev } },
  },

  /* VEX_LEN_0F2C_P_1 */
  {
    { "vcvttss2siY",	{ Gv, EXdScalar } },
    { "vcvttss2siY",	{ Gv, EXdScalar } },
  },

  /* VEX_LEN_0F2C_P_3 */
  {
    { "vcvttsd2siY",	{ Gv, EXqScalar } },
    { "vcvttsd2siY",	{ Gv, EXqScalar } },
  },

  /* VEX_LEN_0F2D_P_1 */
  {
    { "vcvtss2siY",	{ Gv, EXdScalar } },
    { "vcvtss2siY",	{ Gv, EXdScalar } },
  },

  /* VEX_LEN_0F2D_P_3 */
  {
    { "vcvtsd2siY",	{ Gv, EXqScalar } },
    { "vcvtsd2siY",	{ Gv, EXqScalar } },
  },

  /* VEX_LEN_0F2E_P_0 */
  {
    { VEX_W_TABLE (VEX_W_0F2E_P_0) },
    { VEX_W_TABLE (VEX_W_0F2E_P_0) },
  },

  /* VEX_LEN_0F2E_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F2E_P_2) },
    { VEX_W_TABLE (VEX_W_0F2E_P_2) },
  },

  /* VEX_LEN_0F2F_P_0 */
  {
    { VEX_W_TABLE (VEX_W_0F2F_P_0) },
    { VEX_W_TABLE (VEX_W_0F2F_P_0) },
  },

  /* VEX_LEN_0F2F_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F2F_P_2) },
    { VEX_W_TABLE (VEX_W_0F2F_P_2) },
  },

  /* VEX_LEN_0F41_P_0 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F41_P_0_LEN_1) },
  },
  /* VEX_LEN_0F42_P_0 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F42_P_0_LEN_1) },
  },
  /* VEX_LEN_0F44_P_0 */
  {
    { VEX_W_TABLE (VEX_W_0F44_P_0_LEN_0) },
  },
  /* VEX_LEN_0F45_P_0 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F45_P_0_LEN_1) },
  },
  /* VEX_LEN_0F46_P_0 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F46_P_0_LEN_1) },
  },
  /* VEX_LEN_0F47_P_0 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F47_P_0_LEN_1) },
  },
  /* VEX_LEN_0F4B_P_2 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F4B_P_2_LEN_1) },
  },

  /* VEX_LEN_0F51_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0F51_P_1) },
    { VEX_W_TABLE (VEX_W_0F51_P_1) },
  },

  /* VEX_LEN_0F51_P_3 */
  {
    { VEX_W_TABLE (VEX_W_0F51_P_3) },
    { VEX_W_TABLE (VEX_W_0F51_P_3) },
  },

  /* VEX_LEN_0F52_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0F52_P_1) },
    { VEX_W_TABLE (VEX_W_0F52_P_1) },
  },

  /* VEX_LEN_0F53_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0F53_P_1) },
    { VEX_W_TABLE (VEX_W_0F53_P_1) },
  },

  /* VEX_LEN_0F58_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0F58_P_1) },
    { VEX_W_TABLE (VEX_W_0F58_P_1) },
  },

  /* VEX_LEN_0F58_P_3 */
  {
    { VEX_W_TABLE (VEX_W_0F58_P_3) },
    { VEX_W_TABLE (VEX_W_0F58_P_3) },
  },

  /* VEX_LEN_0F59_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0F59_P_1) },
    { VEX_W_TABLE (VEX_W_0F59_P_1) },
  },

  /* VEX_LEN_0F59_P_3 */
  {
    { VEX_W_TABLE (VEX_W_0F59_P_3) },
    { VEX_W_TABLE (VEX_W_0F59_P_3) },
  },

  /* VEX_LEN_0F5A_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0F5A_P_1) },
    { VEX_W_TABLE (VEX_W_0F5A_P_1) },
  },

  /* VEX_LEN_0F5A_P_3 */
  {
    { VEX_W_TABLE (VEX_W_0F5A_P_3) },
    { VEX_W_TABLE (VEX_W_0F5A_P_3) },
  },

  /* VEX_LEN_0F5C_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0F5C_P_1) },
    { VEX_W_TABLE (VEX_W_0F5C_P_1) },
  },

  /* VEX_LEN_0F5C_P_3 */
  {
    { VEX_W_TABLE (VEX_W_0F5C_P_3) },
    { VEX_W_TABLE (VEX_W_0F5C_P_3) },
  },

  /* VEX_LEN_0F5D_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0F5D_P_1) },
    { VEX_W_TABLE (VEX_W_0F5D_P_1) },
  },

  /* VEX_LEN_0F5D_P_3 */
  {
    { VEX_W_TABLE (VEX_W_0F5D_P_3) },
    { VEX_W_TABLE (VEX_W_0F5D_P_3) },
  },

  /* VEX_LEN_0F5E_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0F5E_P_1) },
    { VEX_W_TABLE (VEX_W_0F5E_P_1) },
  },

  /* VEX_LEN_0F5E_P_3 */
  {
    { VEX_W_TABLE (VEX_W_0F5E_P_3) },
    { VEX_W_TABLE (VEX_W_0F5E_P_3) },
  },

  /* VEX_LEN_0F5F_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0F5F_P_1) },
    { VEX_W_TABLE (VEX_W_0F5F_P_1) },
  },

  /* VEX_LEN_0F5F_P_3 */
  {
    { VEX_W_TABLE (VEX_W_0F5F_P_3) },
    { VEX_W_TABLE (VEX_W_0F5F_P_3) },
  },

  /* VEX_LEN_0F6E_P_2 */
  {
    { "vmovK",		{ XMScalar, Edq } },
    { "vmovK",		{ XMScalar, Edq } },
  },

  /* VEX_LEN_0F7E_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0F7E_P_1) },
    { VEX_W_TABLE (VEX_W_0F7E_P_1) },
  },

  /* VEX_LEN_0F7E_P_2 */
  {
    { "vmovK",		{ Edq, XMScalar } },
    { "vmovK",		{ Edq, XMScalar } },
  },

  /* VEX_LEN_0F90_P_0 */
  {
    { VEX_W_TABLE (VEX_W_0F90_P_0_LEN_0) },
  },

  /* VEX_LEN_0F91_P_0 */
  {
    { VEX_W_TABLE (VEX_W_0F91_P_0_LEN_0) },
  },

  /* VEX_LEN_0F92_P_0 */
  {
    { VEX_W_TABLE (VEX_W_0F92_P_0_LEN_0) },
  },

  /* VEX_LEN_0F93_P_0 */
  {
    { VEX_W_TABLE (VEX_W_0F93_P_0_LEN_0) },
  },

  /* VEX_LEN_0F98_P_0 */
  {
    { VEX_W_TABLE (VEX_W_0F98_P_0_LEN_0) },
  },

  /* VEX_LEN_0FAE_R_2_M_0 */
  {
    { VEX_W_TABLE (VEX_W_0FAE_R_2_M_0) },
  },

  /* VEX_LEN_0FAE_R_3_M_0 */
  {
    { VEX_W_TABLE (VEX_W_0FAE_R_3_M_0) },
  },

  /* VEX_LEN_0FC2_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0FC2_P_1) },
    { VEX_W_TABLE (VEX_W_0FC2_P_1) },
  },

  /* VEX_LEN_0FC2_P_3 */
  {
    { VEX_W_TABLE (VEX_W_0FC2_P_3) },
    { VEX_W_TABLE (VEX_W_0FC2_P_3) },
  },

  /* VEX_LEN_0FC4_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FC4_P_2) },
  },

  /* VEX_LEN_0FC5_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FC5_P_2) },
  },

  /* VEX_LEN_0FD6_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FD6_P_2) },
    { VEX_W_TABLE (VEX_W_0FD6_P_2) },
  },

  /* VEX_LEN_0FF7_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FF7_P_2) },
  },

  /* VEX_LEN_0F3816_P_2 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3816_P_2) },
  },

  /* VEX_LEN_0F3819_P_2 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3819_P_2) },
  },

  /* VEX_LEN_0F381A_P_2_M_0 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F381A_P_2_M_0) },
  },

  /* VEX_LEN_0F3836_P_2 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3836_P_2) },
  },

  /* VEX_LEN_0F3841_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3841_P_2) },
  },

  /* VEX_LEN_0F385A_P_2_M_0 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F385A_P_2_M_0) },
  },

  /* VEX_LEN_0F38DB_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F38DB_P_2) },
  },

  /* VEX_LEN_0F38DC_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F38DC_P_2) },
  },

  /* VEX_LEN_0F38DD_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F38DD_P_2) },
  },

  /* VEX_LEN_0F38DE_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F38DE_P_2) },
  },

  /* VEX_LEN_0F38DF_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F38DF_P_2) },
  },

  /* VEX_LEN_0F38F2_P_0 */
  {
    { "andnS",		{ Gdq, VexGdq, Edq } },
  },

  /* VEX_LEN_0F38F3_R_1_P_0 */
  {
    { "blsrS",		{ VexGdq, Edq } },
  },

  /* VEX_LEN_0F38F3_R_2_P_0 */
  {
    { "blsmskS",	{ VexGdq, Edq } },
  },

  /* VEX_LEN_0F38F3_R_3_P_0 */
  {
    { "blsiS",		{ VexGdq, Edq } },
  },

  /* VEX_LEN_0F38F5_P_0 */
  {
    { "bzhiS",		{ Gdq, Edq, VexGdq } },
  },

  /* VEX_LEN_0F38F5_P_1 */
  {
    { "pextS",		{ Gdq, VexGdq, Edq } },
  },

  /* VEX_LEN_0F38F5_P_3 */
  {
    { "pdepS",		{ Gdq, VexGdq, Edq } },
  },

  /* VEX_LEN_0F38F6_P_3 */
  {
    { "mulxS",		{ Gdq, VexGdq, Edq } },
  },

  /* VEX_LEN_0F38F7_P_0 */
  {
    { "bextrS",		{ Gdq, Edq, VexGdq } },
  },

  /* VEX_LEN_0F38F7_P_1 */
  {
    { "sarxS",		{ Gdq, Edq, VexGdq } },
  },

  /* VEX_LEN_0F38F7_P_2 */
  {
    { "shlxS",		{ Gdq, Edq, VexGdq } },
  },

  /* VEX_LEN_0F38F7_P_3 */
  {
    { "shrxS",		{ Gdq, Edq, VexGdq } },
  },

  /* VEX_LEN_0F3A00_P_2 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A00_P_2) },
  },

  /* VEX_LEN_0F3A01_P_2 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A01_P_2) },
  },

  /* VEX_LEN_0F3A06_P_2 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A06_P_2) },
  },

  /* VEX_LEN_0F3A0A_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A0A_P_2) },
    { VEX_W_TABLE (VEX_W_0F3A0A_P_2) },
  },

  /* VEX_LEN_0F3A0B_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A0B_P_2) },
    { VEX_W_TABLE (VEX_W_0F3A0B_P_2) },
  },

  /* VEX_LEN_0F3A14_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A14_P_2) },
  },

  /* VEX_LEN_0F3A15_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A15_P_2) },
  },

  /* VEX_LEN_0F3A16_P_2  */
  {
    { "vpextrK",	{ Edq, XM, Ib } },
  },

  /* VEX_LEN_0F3A17_P_2 */
  {
    { "vextractps",	{ Edqd, XM, Ib } },
  },

  /* VEX_LEN_0F3A18_P_2 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A18_P_2) },
  },

  /* VEX_LEN_0F3A19_P_2 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A19_P_2) },
  },

  /* VEX_LEN_0F3A20_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A20_P_2) },
  },

  /* VEX_LEN_0F3A21_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A21_P_2) },
  },

  /* VEX_LEN_0F3A22_P_2 */
  {
    { "vpinsrK",	{ XM, Vex128, Edq, Ib } },
  },

  /* VEX_LEN_0F3A30_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A30_P_2_LEN_0) },
  },

  /* VEX_LEN_0F3A32_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A32_P_2_LEN_0) },
  },

  /* VEX_LEN_0F3A38_P_2 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A38_P_2) },
  },

  /* VEX_LEN_0F3A39_P_2 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A39_P_2) },
  },

  /* VEX_LEN_0F3A41_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A41_P_2) },
  },

  /* VEX_LEN_0F3A44_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A44_P_2) },
  },

  /* VEX_LEN_0F3A46_P_2 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3A46_P_2) },
  },

  /* VEX_LEN_0F3A60_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A60_P_2) },
  },

  /* VEX_LEN_0F3A61_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A61_P_2) },
  },

  /* VEX_LEN_0F3A62_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A62_P_2) },
  },

  /* VEX_LEN_0F3A63_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A63_P_2) },
  },

  /* VEX_LEN_0F3A6A_P_2 */
  {
    { "vfmaddss",	{ XMVexW, Vex128, EXdVexW, EXdVexW, VexI4 } },
  },

  /* VEX_LEN_0F3A6B_P_2 */
  {
    { "vfmaddsd",	{ XMVexW, Vex128, EXqVexW, EXqVexW, VexI4 } },
  },

  /* VEX_LEN_0F3A6E_P_2 */
  {
    { "vfmsubss",	{ XMVexW, Vex128, EXdVexW, EXdVexW, VexI4 } },
  },

  /* VEX_LEN_0F3A6F_P_2 */
  {
    { "vfmsubsd",	{ XMVexW, Vex128, EXqVexW, EXqVexW, VexI4 } },
  },

  /* VEX_LEN_0F3A7A_P_2 */
  {
    { "vfnmaddss",	{ XMVexW, Vex128, EXdVexW, EXdVexW, VexI4 } },
  },

  /* VEX_LEN_0F3A7B_P_2 */
  {
    { "vfnmaddsd",	{ XMVexW, Vex128, EXqVexW, EXqVexW, VexI4 } },
  },

  /* VEX_LEN_0F3A7E_P_2 */
  {
    { "vfnmsubss",	{ XMVexW, Vex128, EXdVexW, EXdVexW, VexI4 } },
  },

  /* VEX_LEN_0F3A7F_P_2 */
  {
    { "vfnmsubsd",	{ XMVexW, Vex128, EXqVexW, EXqVexW, VexI4 } },
  },

  /* VEX_LEN_0F3ADF_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3ADF_P_2) },
  },

  /* VEX_LEN_0F3AF0_P_3 */
  {
    { "rorxS",		{ Gdq, Edq, Ib } },
  },

  /* VEX_LEN_0FXOP_08_CC */
  {
     { "vpcomb",	{ XM, Vex128, EXx, Ib } },
  },

  /* VEX_LEN_0FXOP_08_CD */
  {
     { "vpcomw",	{ XM, Vex128, EXx, Ib } },
  },

  /* VEX_LEN_0FXOP_08_CE */
  {
     { "vpcomd",	{ XM, Vex128, EXx, Ib } },
  },

  /* VEX_LEN_0FXOP_08_CF */
  {
     { "vpcomq",	{ XM, Vex128, EXx, Ib } },
  },

  /* VEX_LEN_0FXOP_08_EC */
  {
     { "vpcomub",	{ XM, Vex128, EXx, Ib } },
  },

  /* VEX_LEN_0FXOP_08_ED */
  {
     { "vpcomuw",	{ XM, Vex128, EXx, Ib } },
  },

  /* VEX_LEN_0FXOP_08_EE */
  {
     { "vpcomud",	{ XM, Vex128, EXx, Ib } },
  },

  /* VEX_LEN_0FXOP_08_EF */
  {
     { "vpcomuq",	{ XM, Vex128, EXx, Ib } },
  },

  /* VEX_LEN_0FXOP_09_80 */
  {
    { "vfrczps",	{ XM, EXxmm } },
    { "vfrczps",	{ XM, EXymmq } },
  },

  /* VEX_LEN_0FXOP_09_81 */
  {
    { "vfrczpd",	{ XM, EXxmm } },
    { "vfrczpd",	{ XM, EXymmq } },
  },
};

static const struct dis386 vex_w_table[][2] = {
  {
    /* VEX_W_0F10_P_0 */
    { "vmovups",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F10_P_1 */
    { "vmovss",		{ XMVexScalar, VexScalar, EXdScalar } },
  },
  {
    /* VEX_W_0F10_P_2 */
    { "vmovupd",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F10_P_3 */
    { "vmovsd",		{ XMVexScalar, VexScalar, EXqScalar } },
  },
  {
    /* VEX_W_0F11_P_0 */
    { "vmovups",	{ EXxS, XM } },
  },
  {
    /* VEX_W_0F11_P_1 */
    { "vmovss",		{ EXdVexScalarS, VexScalar, XMScalar } },
  },
  {
    /* VEX_W_0F11_P_2 */
    { "vmovupd",	{ EXxS, XM } },
  },
  {
    /* VEX_W_0F11_P_3 */
    { "vmovsd",		{ EXqVexScalarS, VexScalar, XMScalar } },
  },
  {
    /* VEX_W_0F12_P_0_M_0 */
    { "vmovlps",	{ XM, Vex128, EXq } },
  },
  {
    /* VEX_W_0F12_P_0_M_1 */
    { "vmovhlps",	{ XM, Vex128, EXq } },
  },
  {
    /* VEX_W_0F12_P_1 */
    { "vmovsldup",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F12_P_2 */
    { "vmovlpd",	{ XM, Vex128, EXq } },
  },
  {
    /* VEX_W_0F12_P_3 */
    { "vmovddup",	{ XM, EXymmq } },
  },
  {
    /* VEX_W_0F13_M_0 */
    { "vmovlpX",	{ EXq, XM } },
  },
  {
    /* VEX_W_0F14 */
    { "vunpcklpX",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F15 */
    { "vunpckhpX",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F16_P_0_M_0 */
    { "vmovhps",	{ XM, Vex128, EXq } },
  },
  {
    /* VEX_W_0F16_P_0_M_1 */
    { "vmovlhps",	{ XM, Vex128, EXq } },
  },
  {
    /* VEX_W_0F16_P_1 */
    { "vmovshdup",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F16_P_2 */
    { "vmovhpd",	{ XM, Vex128, EXq } },
  },
  {
    /* VEX_W_0F17_M_0 */
    { "vmovhpX",	{ EXq, XM } },
  },
  {
    /* VEX_W_0F28 */
    { "vmovapX",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F29 */
    { "vmovapX",	{ EXxS, XM } },
  },
  {
    /* VEX_W_0F2B_M_0 */
    { "vmovntpX",	{ Mx, XM } },
  },
  {
    /* VEX_W_0F2E_P_0 */
    { "vucomiss",	{ XMScalar, EXdScalar } },
  },
  {
    /* VEX_W_0F2E_P_2 */
    { "vucomisd",	{ XMScalar, EXqScalar } },
  },
  {
    /* VEX_W_0F2F_P_0 */
    { "vcomiss",	{ XMScalar, EXdScalar } },
  },
  {
    /* VEX_W_0F2F_P_2 */
    { "vcomisd",	{ XMScalar, EXqScalar } },
  },
  {
    /* VEX_W_0F41_P_0_LEN_1 */
    { "kandw",          { MaskG, MaskVex, MaskR } },
  },
  {
    /* VEX_W_0F42_P_0_LEN_1 */
    { "kandnw",         { MaskG, MaskVex, MaskR } },
  },
  {
    /* VEX_W_0F44_P_0_LEN_0 */
    { "knotw",		{ MaskG, MaskR } },
  },
  {
    /* VEX_W_0F45_P_0_LEN_1 */
    { "korw",           { MaskG, MaskVex, MaskR } },
  },
  {
    /* VEX_W_0F46_P_0_LEN_1 */
    { "kxnorw",         { MaskG, MaskVex, MaskR } },
  },
  {
    /* VEX_W_0F47_P_0_LEN_1 */
    { "kxorw",          { MaskG, MaskVex, MaskR } },
  },
  {
    /* VEX_W_0F4B_P_2_LEN_1 */
    { "kunpckbw",	{ MaskG, MaskVex, MaskR } },
  },
  {
    /* VEX_W_0F50_M_0 */
    { "vmovmskpX",	{ Gdq, XS } },
  },
  {
    /* VEX_W_0F51_P_0 */
    { "vsqrtps",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F51_P_1 */
    { "vsqrtss",	{ XMScalar, VexScalar, EXdScalar } },
  },
  {
    /* VEX_W_0F51_P_2  */
    { "vsqrtpd",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F51_P_3 */
    { "vsqrtsd",	{ XMScalar, VexScalar, EXqScalar } },
  },
  {
    /* VEX_W_0F52_P_0 */
    { "vrsqrtps",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F52_P_1 */
    { "vrsqrtss",	{ XMScalar, VexScalar, EXdScalar } },
  },
  {
    /* VEX_W_0F53_P_0  */
    { "vrcpps",		{ XM, EXx } },
  },
  {
    /* VEX_W_0F53_P_1  */
    { "vrcpss",		{ XMScalar, VexScalar, EXdScalar } },
  },
  {
    /* VEX_W_0F58_P_0  */
    { "vaddps",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F58_P_1  */
    { "vaddss",		{ XMScalar, VexScalar, EXdScalar } },
  },
  {
    /* VEX_W_0F58_P_2  */
    { "vaddpd",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F58_P_3  */
    { "vaddsd",		{ XMScalar, VexScalar, EXqScalar } },
  },
  {
    /* VEX_W_0F59_P_0  */
    { "vmulps",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F59_P_1  */
    { "vmulss",		{ XMScalar, VexScalar, EXdScalar } },
  },
  {
    /* VEX_W_0F59_P_2  */
    { "vmulpd",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F59_P_3  */
    { "vmulsd",		{ XMScalar, VexScalar, EXqScalar } },
  },
  {
    /* VEX_W_0F5A_P_0  */
    { "vcvtps2pd",	{ XM, EXxmmq } },
  },
  {
    /* VEX_W_0F5A_P_1  */
    { "vcvtss2sd",	{ XMScalar, VexScalar, EXdScalar } },
  },
  {
    /* VEX_W_0F5A_P_3  */
    { "vcvtsd2ss",	{ XMScalar, VexScalar, EXqScalar } },
  },
  {
    /* VEX_W_0F5B_P_0  */
    { "vcvtdq2ps",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F5B_P_1  */
    { "vcvttps2dq",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F5B_P_2  */
    { "vcvtps2dq",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F5C_P_0  */
    { "vsubps",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F5C_P_1  */
    { "vsubss",		{ XMScalar, VexScalar, EXdScalar } },
  },
  {
    /* VEX_W_0F5C_P_2  */
    { "vsubpd",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F5C_P_3  */
    { "vsubsd",		{ XMScalar, VexScalar, EXqScalar } },
  },
  {
    /* VEX_W_0F5D_P_0  */
    { "vminps",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F5D_P_1  */
    { "vminss",		{ XMScalar, VexScalar, EXdScalar } },
  },
  {
    /* VEX_W_0F5D_P_2  */
    { "vminpd",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F5D_P_3  */
    { "vminsd",		{ XMScalar, VexScalar, EXqScalar } },
  },
  {
    /* VEX_W_0F5E_P_0  */
    { "vdivps",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F5E_P_1  */
    { "vdivss",		{ XMScalar, VexScalar, EXdScalar } },
  },
  {
    /* VEX_W_0F5E_P_2  */
    { "vdivpd",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F5E_P_3  */
    { "vdivsd",		{ XMScalar, VexScalar, EXqScalar } },
  },
  {
    /* VEX_W_0F5F_P_0  */
    { "vmaxps",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F5F_P_1  */
    { "vmaxss",		{ XMScalar, VexScalar, EXdScalar } },
  },
  {
    /* VEX_W_0F5F_P_2  */
    { "vmaxpd",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F5F_P_3  */
    { "vmaxsd",		{ XMScalar, VexScalar, EXqScalar } },
  },
  {
    /* VEX_W_0F60_P_2  */
    { "vpunpcklbw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F61_P_2  */
    { "vpunpcklwd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F62_P_2  */
    { "vpunpckldq",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F63_P_2  */
    { "vpacksswb",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F64_P_2  */
    { "vpcmpgtb",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F65_P_2  */
    { "vpcmpgtw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F66_P_2  */
    { "vpcmpgtd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F67_P_2  */
    { "vpackuswb",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F68_P_2  */
    { "vpunpckhbw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F69_P_2  */
    { "vpunpckhwd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F6A_P_2  */
    { "vpunpckhdq",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F6B_P_2  */
    { "vpackssdw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F6C_P_2  */
    { "vpunpcklqdq",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F6D_P_2  */
    { "vpunpckhqdq",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F6F_P_1  */
    { "vmovdqu",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F6F_P_2  */
    { "vmovdqa",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F70_P_1 */
    { "vpshufhw",	{ XM, EXx, Ib } },
  },
  {
    /* VEX_W_0F70_P_2 */
    { "vpshufd",	{ XM, EXx, Ib } },
  },
  {
    /* VEX_W_0F70_P_3 */
    { "vpshuflw",	{ XM, EXx, Ib } },
  },
  {
    /* VEX_W_0F71_R_2_P_2  */
    { "vpsrlw",		{ Vex, XS, Ib } },
  },
  {
    /* VEX_W_0F71_R_4_P_2  */
    { "vpsraw",		{ Vex, XS, Ib } },
  },
  {
    /* VEX_W_0F71_R_6_P_2  */
    { "vpsllw",		{ Vex, XS, Ib } },
  },
  {
    /* VEX_W_0F72_R_2_P_2  */
    { "vpsrld",		{ Vex, XS, Ib } },
  },
  {
    /* VEX_W_0F72_R_4_P_2  */
    { "vpsrad",		{ Vex, XS, Ib } },
  },
  {
    /* VEX_W_0F72_R_6_P_2  */
    { "vpslld",		{ Vex, XS, Ib } },
  },
  {
    /* VEX_W_0F73_R_2_P_2  */
    { "vpsrlq",		{ Vex, XS, Ib } },
  },
  {
    /* VEX_W_0F73_R_3_P_2  */
    { "vpsrldq",	{ Vex, XS, Ib } },
  },
  {
    /* VEX_W_0F73_R_6_P_2  */
    { "vpsllq",		{ Vex, XS, Ib } },
  },
  {
    /* VEX_W_0F73_R_7_P_2  */
    { "vpslldq",	{ Vex, XS, Ib } },
  },
  {
    /* VEX_W_0F74_P_2 */
    { "vpcmpeqb",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F75_P_2 */
    { "vpcmpeqw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F76_P_2 */
    { "vpcmpeqd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F77_P_0 */
    { "",		{ VZERO } },
  },
  {
    /* VEX_W_0F7C_P_2 */
    { "vhaddpd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F7C_P_3 */
    { "vhaddps",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F7D_P_2 */
    { "vhsubpd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F7D_P_3 */
    { "vhsubps",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F7E_P_1 */
    { "vmovq",		{ XMScalar, EXqScalar } },
  },
  {
    /* VEX_W_0F7F_P_1 */
    { "vmovdqu",	{ EXxS, XM } },
  },
  {
    /* VEX_W_0F7F_P_2 */
    { "vmovdqa",	{ EXxS, XM } },
  },
  {
    /* VEX_W_0F90_P_0_LEN_0 */
    { "kmovw",		{ MaskG, MaskE } },
  },
  {
    /* VEX_W_0F91_P_0_LEN_0 */
    { "kmovw",		{ Ew, MaskG } },
  },
  {
    /* VEX_W_0F92_P_0_LEN_0 */
    { "kmovw",		{ MaskG, Rdq } },
  },
  {
    /* VEX_W_0F93_P_0_LEN_0 */
    { "kmovw",		{ Gdq, MaskR } },
  },
  {
    /* VEX_W_0F98_P_0_LEN_0 */
    { "kortestw",	{ MaskG, MaskR } },
  },
  {
    /* VEX_W_0FAE_R_2_M_0 */
    { "vldmxcsr",	{ Md } },
  },
  {
    /* VEX_W_0FAE_R_3_M_0 */
    { "vstmxcsr",	{ Md } },
  },
  {
    /* VEX_W_0FC2_P_0 */
    { "vcmpps",		{ XM, Vex, EXx, VCMP } },
  },
  {
    /* VEX_W_0FC2_P_1 */
    { "vcmpss",		{ XMScalar, VexScalar, EXdScalar, VCMP } },
  },
  {
    /* VEX_W_0FC2_P_2 */
    { "vcmppd",		{ XM, Vex, EXx, VCMP } },
  },
  {
    /* VEX_W_0FC2_P_3 */
    { "vcmpsd",		{ XMScalar, VexScalar, EXqScalar, VCMP } },
  },
  {
    /* VEX_W_0FC4_P_2 */
    { "vpinsrw",	{ XM, Vex128, Edqw, Ib } },
  },
  {
    /* VEX_W_0FC5_P_2 */
    { "vpextrw",	{ Gdq, XS, Ib } },
  },
  {
    /* VEX_W_0FD0_P_2 */
    { "vaddsubpd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FD0_P_3 */
    { "vaddsubps",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FD1_P_2 */
    { "vpsrlw",		{ XM, Vex, EXxmm } },
  },
  {
    /* VEX_W_0FD2_P_2 */
    { "vpsrld",		{ XM, Vex, EXxmm } },
  },
  {
    /* VEX_W_0FD3_P_2 */
    { "vpsrlq",		{ XM, Vex, EXxmm } },
  },
  {
    /* VEX_W_0FD4_P_2 */
    { "vpaddq",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FD5_P_2 */
    { "vpmullw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FD6_P_2 */
    { "vmovq",		{ EXqScalarS, XMScalar } },
  },
  {
    /* VEX_W_0FD7_P_2_M_1 */
    { "vpmovmskb",	{ Gdq, XS } },
  },
  {
    /* VEX_W_0FD8_P_2 */
    { "vpsubusb",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FD9_P_2 */
    { "vpsubusw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FDA_P_2 */
    { "vpminub",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FDB_P_2 */
    { "vpand",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FDC_P_2 */
    { "vpaddusb",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FDD_P_2 */
    { "vpaddusw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FDE_P_2 */
    { "vpmaxub",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FDF_P_2 */
    { "vpandn",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FE0_P_2  */
    { "vpavgb",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FE1_P_2  */
    { "vpsraw",		{ XM, Vex, EXxmm } },
  },
  {
    /* VEX_W_0FE2_P_2  */
    { "vpsrad",		{ XM, Vex, EXxmm } },
  },
  {
    /* VEX_W_0FE3_P_2  */
    { "vpavgw",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FE4_P_2  */
    { "vpmulhuw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FE5_P_2  */
    { "vpmulhw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FE6_P_1  */
    { "vcvtdq2pd",	{ XM, EXxmmq } },
  },
  {
    /* VEX_W_0FE6_P_2  */
    { "vcvttpd2dq%XY",	{ XMM, EXx } },
  },
  {
    /* VEX_W_0FE6_P_3  */
    { "vcvtpd2dq%XY",	{ XMM, EXx } },
  },
  {
    /* VEX_W_0FE7_P_2_M_0 */
    { "vmovntdq",	{ Mx, XM } },
  },
  {
    /* VEX_W_0FE8_P_2  */
    { "vpsubsb",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FE9_P_2  */
    { "vpsubsw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FEA_P_2  */
    { "vpminsw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FEB_P_2  */
    { "vpor",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FEC_P_2  */
    { "vpaddsb",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FED_P_2  */
    { "vpaddsw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FEE_P_2  */
    { "vpmaxsw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FEF_P_2  */
    { "vpxor",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FF0_P_3_M_0 */
    { "vlddqu",		{ XM, M } },
  },
  {
    /* VEX_W_0FF1_P_2 */
    { "vpsllw",		{ XM, Vex, EXxmm } },
  },
  {
    /* VEX_W_0FF2_P_2 */
    { "vpslld",		{ XM, Vex, EXxmm } },
  },
  {
    /* VEX_W_0FF3_P_2 */
    { "vpsllq",		{ XM, Vex, EXxmm } },
  },
  {
    /* VEX_W_0FF4_P_2 */
    { "vpmuludq",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FF5_P_2 */
    { "vpmaddwd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FF6_P_2 */
    { "vpsadbw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FF7_P_2 */
    { "vmaskmovdqu",	{ XM, XS } },
  },
  {
    /* VEX_W_0FF8_P_2 */
    { "vpsubb",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FF9_P_2 */
    { "vpsubw",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FFA_P_2 */
    { "vpsubd",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FFB_P_2 */
    { "vpsubq",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FFC_P_2 */
    { "vpaddb",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FFD_P_2 */
    { "vpaddw",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0FFE_P_2 */
    { "vpaddd",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3800_P_2  */
    { "vpshufb",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3801_P_2  */
    { "vphaddw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3802_P_2  */
    { "vphaddd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3803_P_2  */
    { "vphaddsw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3804_P_2  */
    { "vpmaddubsw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3805_P_2  */
    { "vphsubw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3806_P_2  */
    { "vphsubd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3807_P_2  */
    { "vphsubsw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3808_P_2  */
    { "vpsignb",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3809_P_2  */
    { "vpsignw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F380A_P_2  */
    { "vpsignd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F380B_P_2  */
    { "vpmulhrsw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F380C_P_2  */
    { "vpermilps",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F380D_P_2  */
    { "vpermilpd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F380E_P_2  */
    { "vtestps",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F380F_P_2  */
    { "vtestpd",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F3816_P_2  */
    { "vpermps",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3817_P_2 */
    { "vptest",		{ XM, EXx } },
  },
  {
    /* VEX_W_0F3818_P_2 */
    { "vbroadcastss",	{ XM, EXxmm_md } },
  },
  {
    /* VEX_W_0F3819_P_2 */
    { "vbroadcastsd",	{ XM, EXxmm_mq } },
  },
  {
    /* VEX_W_0F381A_P_2_M_0 */
    { "vbroadcastf128",	{ XM, Mxmm } },
  },
  {
    /* VEX_W_0F381C_P_2 */
    { "vpabsb",		{ XM, EXx } },
  },
  {
    /* VEX_W_0F381D_P_2 */
    { "vpabsw",		{ XM, EXx } },
  },
  {
    /* VEX_W_0F381E_P_2 */
    { "vpabsd",		{ XM, EXx } },
  },
  {
    /* VEX_W_0F3820_P_2 */
    { "vpmovsxbw",	{ XM, EXxmmq } },
  },
  {
    /* VEX_W_0F3821_P_2 */
    { "vpmovsxbd",	{ XM, EXxmmqd } },
  },
  {
    /* VEX_W_0F3822_P_2 */
    { "vpmovsxbq",	{ XM, EXxmmdw } },
  },
  {
    /* VEX_W_0F3823_P_2 */
    { "vpmovsxwd",	{ XM, EXxmmq } },
  },
  {
    /* VEX_W_0F3824_P_2 */
    { "vpmovsxwq",	{ XM, EXxmmqd } },
  },
  {
    /* VEX_W_0F3825_P_2 */
    { "vpmovsxdq",	{ XM, EXxmmq } },
  },
  {
    /* VEX_W_0F3828_P_2 */
    { "vpmuldq",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3829_P_2 */
    { "vpcmpeqq",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F382A_P_2_M_0 */
    { "vmovntdqa",	{ XM, Mx } },
  },
  {
    /* VEX_W_0F382B_P_2 */
    { "vpackusdw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F382C_P_2_M_0 */
    { "vmaskmovps",	{ XM, Vex, Mx } },
  },
  {
    /* VEX_W_0F382D_P_2_M_0 */
    { "vmaskmovpd",	{ XM, Vex, Mx } },
  },
  {
    /* VEX_W_0F382E_P_2_M_0 */
    { "vmaskmovps",	{ Mx, Vex, XM } },
  },
  {
    /* VEX_W_0F382F_P_2_M_0 */
    { "vmaskmovpd",	{ Mx, Vex, XM } },
  },
  {
    /* VEX_W_0F3830_P_2 */
    { "vpmovzxbw",	{ XM, EXxmmq } },
  },
  {
    /* VEX_W_0F3831_P_2 */
    { "vpmovzxbd",	{ XM, EXxmmqd } },
  },
  {
    /* VEX_W_0F3832_P_2 */
    { "vpmovzxbq",	{ XM, EXxmmdw } },
  },
  {
    /* VEX_W_0F3833_P_2 */
    { "vpmovzxwd",	{ XM, EXxmmq } },
  },
  {
    /* VEX_W_0F3834_P_2 */
    { "vpmovzxwq",	{ XM, EXxmmqd } },
  },
  {
    /* VEX_W_0F3835_P_2 */
    { "vpmovzxdq",	{ XM, EXxmmq } },
  },
  {
    /* VEX_W_0F3836_P_2  */
    { "vpermd",		{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3837_P_2 */
    { "vpcmpgtq",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3838_P_2 */
    { "vpminsb",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3839_P_2 */
    { "vpminsd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F383A_P_2 */
    { "vpminuw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F383B_P_2 */
    { "vpminud",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F383C_P_2 */
    { "vpmaxsb",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F383D_P_2 */
    { "vpmaxsd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F383E_P_2 */
    { "vpmaxuw",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F383F_P_2 */
    { "vpmaxud",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3840_P_2 */
    { "vpmulld",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3841_P_2 */
    { "vphminposuw",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F3846_P_2 */
    { "vpsravd",	{ XM, Vex, EXx } },
  },
  {
    /* VEX_W_0F3858_P_2 */
    { "vpbroadcastd", { XM, EXxmm_md } },
  },
  {
    /* VEX_W_0F3859_P_2 */
    { "vpbroadcastq",	{ XM, EXxmm_mq } },
  },
  {
    /* VEX_W_0F385A_P_2_M_0 */
    { "vbroadcasti128", { XM, Mxmm } },
  },
  {
    /* VEX_W_0F3878_P_2 */
    { "vpbroadcastb",	{ XM, EXxmm_mb } },
  },
  {
    /* VEX_W_0F3879_P_2 */
    { "vpbroadcastw",	{ XM, EXxmm_mw } },
  },
  {
    /* VEX_W_0F38DB_P_2 */
    { "vaesimc",	{ XM, EXx } },
  },
  {
    /* VEX_W_0F38DC_P_2 */
    { "vaesenc",	{ XM, Vex128, EXx } },
  },
  {
    /* VEX_W_0F38DD_P_2 */
    { "vaesenclast",	{ XM, Vex128, EXx } },
  },
  {
    /* VEX_W_0F38DE_P_2 */
    { "vaesdec",	{ XM, Vex128, EXx } },
  },
  {
    /* VEX_W_0F38DF_P_2 */
    { "vaesdeclast",	{ XM, Vex128, EXx } },
  },
  {
    /* VEX_W_0F3A00_P_2 */
    { Bad_Opcode },
    { "vpermq",		{ XM, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A01_P_2 */
    { Bad_Opcode },
    { "vpermpd",	{ XM, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A02_P_2 */
    { "vpblendd",	{ XM, Vex, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A04_P_2 */
    { "vpermilps",	{ XM, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A05_P_2 */
    { "vpermilpd",	{ XM, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A06_P_2 */
    { "vperm2f128",	{ XM, Vex256, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A08_P_2 */
    { "vroundps",	{ XM, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A09_P_2 */
    { "vroundpd",	{ XM, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A0A_P_2 */
    { "vroundss",	{ XMScalar, VexScalar, EXdScalar, Ib } },
  },
  {
    /* VEX_W_0F3A0B_P_2 */
    { "vroundsd",	{ XMScalar, VexScalar, EXqScalar, Ib } },
  },
  {
    /* VEX_W_0F3A0C_P_2 */
    { "vblendps",	{ XM, Vex, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A0D_P_2 */
    { "vblendpd",	{ XM, Vex, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A0E_P_2 */
    { "vpblendw",	{ XM, Vex, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A0F_P_2 */
    { "vpalignr",	{ XM, Vex, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A14_P_2 */
    { "vpextrb",	{ Edqb, XM, Ib } },
  },
  {
    /* VEX_W_0F3A15_P_2 */
    { "vpextrw",	{ Edqw, XM, Ib } },
  },
  {
    /* VEX_W_0F3A18_P_2 */
    { "vinsertf128",	{ XM, Vex256, EXxmm, Ib } },
  },
  {
    /* VEX_W_0F3A19_P_2 */
    { "vextractf128",	{ EXxmm, XM, Ib } },
  },
  {
    /* VEX_W_0F3A20_P_2 */
    { "vpinsrb",	{ XM, Vex128, Edqb, Ib } },
  },
  {
    /* VEX_W_0F3A21_P_2 */
    { "vinsertps",	{ XM, Vex128, EXd, Ib } },
  },
  {
    /* VEX_W_0F3A30_P_2 */
    { Bad_Opcode },
    { "kshiftrw",	{ MaskG, MaskR, Ib } },
  },
  {
    /* VEX_W_0F3A32_P_2 */
    { Bad_Opcode },
    { "kshiftlw",	{ MaskG, MaskR, Ib } },
  },
  {
    /* VEX_W_0F3A38_P_2 */
    { "vinserti128",	{ XM, Vex256, EXxmm, Ib } },
  },
  {
    /* VEX_W_0F3A39_P_2 */
    { "vextracti128",	{ EXxmm, XM, Ib } },
  },
  {
    /* VEX_W_0F3A40_P_2 */
    { "vdpps",		{ XM, Vex, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A41_P_2 */
    { "vdppd",		{ XM, Vex128, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A42_P_2 */
    { "vmpsadbw",	{ XM, Vex, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A44_P_2 */
    { "vpclmulqdq",	{ XM, Vex128, EXx, PCLMUL } },
  },
  {
    /* VEX_W_0F3A46_P_2 */
    { "vperm2i128",	{ XM, Vex256, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A48_P_2 */
    { "vpermil2ps",	{ XMVexW, Vex, EXVexImmW, EXVexImmW, EXVexImmW } },
    { "vpermil2ps",	{ XMVexW, Vex, EXVexImmW, EXVexImmW, EXVexImmW } },
  },
  {
    /* VEX_W_0F3A49_P_2 */
    { "vpermil2pd",	{ XMVexW, Vex, EXVexImmW, EXVexImmW, EXVexImmW } },
    { "vpermil2pd",	{ XMVexW, Vex, EXVexImmW, EXVexImmW, EXVexImmW } },
  },
  {
    /* VEX_W_0F3A4A_P_2 */
    { "vblendvps",	{ XM, Vex, EXx, XMVexI4 } },
  },
  {
    /* VEX_W_0F3A4B_P_2 */
    { "vblendvpd",	{ XM, Vex, EXx, XMVexI4 } },
  },
  {
    /* VEX_W_0F3A4C_P_2 */
    { "vpblendvb",	{ XM, Vex, EXx, XMVexI4 } },
  },
  {
    /* VEX_W_0F3A60_P_2 */
    { "vpcmpestrm",	{ XM, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A61_P_2 */
    { "vpcmpestri",	{ XM, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A62_P_2 */
    { "vpcmpistrm",	{ XM, EXx, Ib } },
  },
  {
    /* VEX_W_0F3A63_P_2 */
    { "vpcmpistri",	{ XM, EXx, Ib } },
  },
  {
    /* VEX_W_0F3ADF_P_2 */
    { "vaeskeygenassist", { XM, EXx, Ib } },
  },
#define NEED_VEX_W_TABLE
#include "i386-dis-evex.h"
#undef NEED_VEX_W_TABLE
};

static const struct dis386 mod_table[][2] = {
  {
    /* MOD_8D */
    { "leaS",		{ Gv, M } },
  },
  {
    /* MOD_C6_REG_7 */
    { Bad_Opcode },
    { RM_TABLE (RM_C6_REG_7) },
  },
  {
    /* MOD_C7_REG_7 */
    { Bad_Opcode },
    { RM_TABLE (RM_C7_REG_7) },
  },
  {
    /* MOD_0F01_REG_0 */
    { X86_64_TABLE (X86_64_0F01_REG_0) },
    { RM_TABLE (RM_0F01_REG_0) },
  },
  {
    /* MOD_0F01_REG_1 */
    { X86_64_TABLE (X86_64_0F01_REG_1) },
    { RM_TABLE (RM_0F01_REG_1) },
  },
  {
    /* MOD_0F01_REG_2 */
    { X86_64_TABLE (X86_64_0F01_REG_2) },
    { RM_TABLE (RM_0F01_REG_2) },
  },
  {
    /* MOD_0F01_REG_3 */
    { X86_64_TABLE (X86_64_0F01_REG_3) },
    { RM_TABLE (RM_0F01_REG_3) },
  },
  {
    /* MOD_0F01_REG_7 */
    { "invlpg",		{ Mb } },
    { RM_TABLE (RM_0F01_REG_7) },
  },
  {
    /* MOD_0F12_PREFIX_0 */
    { "movlps",		{ XM, EXq } },
    { "movhlps",	{ XM, EXq } },
  },
  {
    /* MOD_0F13 */
    { "movlpX",		{ EXq, XM } },
  },
  {
    /* MOD_0F16_PREFIX_0 */
    { "movhps",		{ XM, EXq } },
    { "movlhps",	{ XM, EXq } },
  },
  {
    /* MOD_0F17 */
    { "movhpX",		{ EXq, XM } },
  },
  {
    /* MOD_0F18_REG_0 */
    { "prefetchnta",	{ Mb } },
  },
  {
    /* MOD_0F18_REG_1 */
    { "prefetcht0",	{ Mb } },
  },
  {
    /* MOD_0F18_REG_2 */
    { "prefetcht1",	{ Mb } },
  },
  {
    /* MOD_0F18_REG_3 */
    { "prefetcht2",	{ Mb } },
  },
  {
    /* MOD_0F18_REG_4 */
    { "nop/reserved",	{ Mb } },
  },
  {
    /* MOD_0F18_REG_5 */
    { "nop/reserved",	{ Mb } },
  },
  {
    /* MOD_0F18_REG_6 */
    { "nop/reserved",	{ Mb } },
  },
  {
    /* MOD_0F18_REG_7 */
    { "nop/reserved",	{ Mb } },
  },
  {
    /* MOD_0F1A_PREFIX_0 */
    { "bndldx",		{ Gbnd, Ev_bnd } },
    { "nopQ",		{ Ev } },
  },
  {
    /* MOD_0F1B_PREFIX_0 */
    { "bndstx",		{ Ev_bnd, Gbnd } },
    { "nopQ",		{ Ev } },
  },
  {
    /* MOD_0F1B_PREFIX_1 */
    { "bndmk",		{ Gbnd, Ev_bnd } },
    { "nopQ",		{ Ev } },
  },
  {
    /* MOD_0F20 */
    { Bad_Opcode },
    { "movZ",		{ Rm, Cm } },
  },
  {
    /* MOD_0F21 */
    { Bad_Opcode },
    { "movZ",		{ Rm, Dm } },
  },
  {
    /* MOD_0F22 */
    { Bad_Opcode },
    { "movZ",		{ Cm, Rm } },
  },
  {
    /* MOD_0F23 */
    { Bad_Opcode },
    { "movZ",		{ Dm, Rm } },
  },
  {
    /* MOD_0F24 */
    { Bad_Opcode },
    { "movL",		{ Rd, Td } },
  },
  {
    /* MOD_0F26 */
    { Bad_Opcode },
    { "movL",		{ Td, Rd } },
  },
  {
    /* MOD_0F2B_PREFIX_0 */
    {"movntps",		{ Mx, XM } },
  },
  {
    /* MOD_0F2B_PREFIX_1 */
    {"movntss",		{ Md, XM } },
  },
  {
    /* MOD_0F2B_PREFIX_2 */
    {"movntpd",		{ Mx, XM } },
  },
  {
    /* MOD_0F2B_PREFIX_3 */
    {"movntsd",		{ Mq, XM } },
  },
  {
    /* MOD_0F51 */
    { Bad_Opcode },
    { "movmskpX",	{ Gdq, XS } },
  },
  {
    /* MOD_0F71_REG_2 */
    { Bad_Opcode },
    { "psrlw",		{ MS, Ib } },
  },
  {
    /* MOD_0F71_REG_4 */
    { Bad_Opcode },
    { "psraw",		{ MS, Ib } },
  },
  {
    /* MOD_0F71_REG_6 */
    { Bad_Opcode },
    { "psllw",		{ MS, Ib } },
  },
  {
    /* MOD_0F72_REG_2 */
    { Bad_Opcode },
    { "psrld",		{ MS, Ib } },
  },
  {
    /* MOD_0F72_REG_4 */
    { Bad_Opcode },
    { "psrad",		{ MS, Ib } },
  },
  {
    /* MOD_0F72_REG_6 */
    { Bad_Opcode },
    { "pslld",		{ MS, Ib } },
  },
  {
    /* MOD_0F73_REG_2 */
    { Bad_Opcode },
    { "psrlq",		{ MS, Ib } },
  },
  {
    /* MOD_0F73_REG_3 */
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_0F73_REG_3) },
  },
  {
    /* MOD_0F73_REG_6 */
    { Bad_Opcode },
    { "psllq",		{ MS, Ib } },
  },
  {
    /* MOD_0F73_REG_7 */
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_0F73_REG_7) },
  },
  {
    /* MOD_0FAE_REG_0 */
    { "fxsave",		{ FXSAVE } },
    { PREFIX_TABLE (PREFIX_0FAE_REG_0) },
  },
  {
    /* MOD_0FAE_REG_1 */
    { "fxrstor",	{ FXSAVE } },
    { PREFIX_TABLE (PREFIX_0FAE_REG_1) },
  },
  {
    /* MOD_0FAE_REG_2 */
    { "ldmxcsr",	{ Md } },
    { PREFIX_TABLE (PREFIX_0FAE_REG_2) },
  },
  {
    /* MOD_0FAE_REG_3 */
    { "stmxcsr",	{ Md } },
    { PREFIX_TABLE (PREFIX_0FAE_REG_3) },
  },
  {
    /* MOD_0FAE_REG_4 */
    { "xsave",		{ FXSAVE } },
  },
  {
    /* MOD_0FAE_REG_5 */
    { "xrstor",		{ FXSAVE } },
    { RM_TABLE (RM_0FAE_REG_5) },
  },
  {
    /* MOD_0FAE_REG_6 */
    { "xsaveopt",	{ FXSAVE } },
    { RM_TABLE (RM_0FAE_REG_6) },
  },
  {
    /* MOD_0FAE_REG_7 */
    { "clflush",	{ Mb } },
    { RM_TABLE (RM_0FAE_REG_7) },
  },
  {
    /* MOD_0FB2 */
    { "lssS",		{ Gv, Mp } },
  },
  {
    /* MOD_0FB4 */
    { "lfsS",		{ Gv, Mp } },
  },
  {
    /* MOD_0FB5 */
    { "lgsS",		{ Gv, Mp } },
  },
  {
    /* MOD_0FC7_REG_6 */
    { PREFIX_TABLE (PREFIX_0FC7_REG_6) },
    { "rdrand",		{ Ev } },
  },
  {
    /* MOD_0FC7_REG_7 */
    { "vmptrst",	{ Mq } },
    { "rdseed",		{ Ev } },
  },
  {
    /* MOD_0FD7 */
    { Bad_Opcode },
    { "pmovmskb",	{ Gdq, MS } },
  },
  {
    /* MOD_0FE7_PREFIX_2 */
    { "movntdq",	{ Mx, XM } },
  },
  {
    /* MOD_0FF0_PREFIX_3 */
    { "lddqu",		{ XM, M } },
  },
  {
    /* MOD_0F382A_PREFIX_2 */
    { "movntdqa",	{ XM, Mx } },
  },
  {
    /* MOD_62_32BIT */
    { "bound{S|}",	{ Gv, Ma } },
    { EVEX_TABLE (EVEX_0F) },
  },
  {
    /* MOD_C4_32BIT */
    { "lesS",		{ Gv, Mp } },
    { VEX_C4_TABLE (VEX_0F) },
  },
  {
    /* MOD_C5_32BIT */
    { "ldsS",		{ Gv, Mp } },
    { VEX_C5_TABLE (VEX_0F) },
  },
  {
    /* MOD_VEX_0F12_PREFIX_0 */
    { VEX_LEN_TABLE (VEX_LEN_0F12_P_0_M_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F12_P_0_M_1) },
  },
  {
    /* MOD_VEX_0F13 */
    { VEX_LEN_TABLE (VEX_LEN_0F13_M_0) },
  },
  {
    /* MOD_VEX_0F16_PREFIX_0 */
    { VEX_LEN_TABLE (VEX_LEN_0F16_P_0_M_0) },
    { VEX_LEN_TABLE (VEX_LEN_0F16_P_0_M_1) },
  },
  {
    /* MOD_VEX_0F17 */
    { VEX_LEN_TABLE (VEX_LEN_0F17_M_0) },
  },
  {
    /* MOD_VEX_0F2B */
    { VEX_W_TABLE (VEX_W_0F2B_M_0) },
  },
  {
    /* MOD_VEX_0F50 */
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F50_M_0) },
  },
  {
    /* MOD_VEX_0F71_REG_2 */
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F71_REG_2) },
  },
  {
    /* MOD_VEX_0F71_REG_4 */
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F71_REG_4) },
  },
  {
    /* MOD_VEX_0F71_REG_6 */
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F71_REG_6) },
  },
  {
    /* MOD_VEX_0F72_REG_2 */
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F72_REG_2) },
  },
  {
    /* MOD_VEX_0F72_REG_4 */
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F72_REG_4) },
  },
  {
    /* MOD_VEX_0F72_REG_6 */
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F72_REG_6) },
  },
  {
    /* MOD_VEX_0F73_REG_2 */
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F73_REG_2) },
  },
  {
    /* MOD_VEX_0F73_REG_3 */
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F73_REG_3) },
  },
  {
    /* MOD_VEX_0F73_REG_6 */
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F73_REG_6) },
  },
  {
    /* MOD_VEX_0F73_REG_7 */
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_0F73_REG_7) },
  },
  {
    /* MOD_VEX_0FAE_REG_2 */
    { VEX_LEN_TABLE (VEX_LEN_0FAE_R_2_M_0) },
  },
  {
    /* MOD_VEX_0FAE_REG_3 */
    { VEX_LEN_TABLE (VEX_LEN_0FAE_R_3_M_0) },
  },
  {
    /* MOD_VEX_0FD7_PREFIX_2 */
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0FD7_P_2_M_1) },
  },
  {
    /* MOD_VEX_0FE7_PREFIX_2 */
    { VEX_W_TABLE (VEX_W_0FE7_P_2_M_0) },
  },
  {
    /* MOD_VEX_0FF0_PREFIX_3 */
    { VEX_W_TABLE (VEX_W_0FF0_P_3_M_0) },
  },
  {
    /* MOD_VEX_0F381A_PREFIX_2 */
    { VEX_LEN_TABLE (VEX_LEN_0F381A_P_2_M_0) },
  },
  {
    /* MOD_VEX_0F382A_PREFIX_2 */
    { VEX_W_TABLE (VEX_W_0F382A_P_2_M_0) },
  },
  {
    /* MOD_VEX_0F382C_PREFIX_2 */
    { VEX_W_TABLE (VEX_W_0F382C_P_2_M_0) },
  },
  {
    /* MOD_VEX_0F382D_PREFIX_2 */
    { VEX_W_TABLE (VEX_W_0F382D_P_2_M_0) },
  },
  {
    /* MOD_VEX_0F382E_PREFIX_2 */
    { VEX_W_TABLE (VEX_W_0F382E_P_2_M_0) },
  },
  {
    /* MOD_VEX_0F382F_PREFIX_2 */
    { VEX_W_TABLE (VEX_W_0F382F_P_2_M_0) },
  },
  {
    /* MOD_VEX_0F385A_PREFIX_2 */
    { VEX_LEN_TABLE (VEX_LEN_0F385A_P_2_M_0) },
  },
  {
    /* MOD_VEX_0F388C_PREFIX_2 */
    { "vpmaskmov%LW",	{ XM, Vex, Mx } },
  },
  {
    /* MOD_VEX_0F388E_PREFIX_2 */
    { "vpmaskmov%LW",	{ Mx, Vex, XM } },
  },
#define NEED_MOD_TABLE
#include "i386-dis-evex.h"
#undef NEED_MOD_TABLE
};

static const struct dis386 rm_table[][8] = {
  {
    /* RM_C6_REG_7 */
    { "xabort",		{ Skip_MODRM, Ib } },
  },
  {
    /* RM_C7_REG_7 */
    { "xbeginT",	{ Skip_MODRM, Jv } },
  },
  {
    /* RM_0F01_REG_0 */
    { Bad_Opcode },
    { "vmcall",		{ Skip_MODRM } },
    { "vmlaunch",	{ Skip_MODRM } },
    { "vmresume",	{ Skip_MODRM } },
    { "vmxoff",		{ Skip_MODRM } },
  },
  {
    /* RM_0F01_REG_1 */
    { "monitor",	{ { OP_Monitor, 0 } } },
    { "mwait",		{ { OP_Mwait, 0 } } },
    { "clac",		{ Skip_MODRM } },
    { "stac",		{ Skip_MODRM } },
  },
  {
    /* RM_0F01_REG_2 */
    { "xgetbv",		{ Skip_MODRM } },
    { "xsetbv",		{ Skip_MODRM } },
    { Bad_Opcode },
    { Bad_Opcode },
    { "vmfunc",		{ Skip_MODRM } },
    { "xend",		{ Skip_MODRM } },
    { "xtest",		{ Skip_MODRM } },
    { Bad_Opcode },
  },
  {
    /* RM_0F01_REG_3 */
    { "vmrun",		{ Skip_MODRM } },
    { "vmmcall",	{ Skip_MODRM } },
    { "vmload",		{ Skip_MODRM } },
    { "vmsave",		{ Skip_MODRM } },
    { "stgi",		{ Skip_MODRM } },
    { "clgi",		{ Skip_MODRM } },
    { "skinit",		{ Skip_MODRM } },
    { "invlpga",	{ Skip_MODRM } },
  },
  {
    /* RM_0F01_REG_7 */
    { "swapgs",		{ Skip_MODRM } },
    { "rdtscp",		{ Skip_MODRM } },
  },
  {
    /* RM_0FAE_REG_5 */
    { "lfence",		{ Skip_MODRM } },
  },
  {
    /* RM_0FAE_REG_6 */
    { "mfence",		{ Skip_MODRM } },
  },
  {
    /* RM_0FAE_REG_7 */
    { "sfence",		{ Skip_MODRM } },
  },
};

#define INTERNAL_DISASSEMBLER_ERROR _("<internal disassembler error>")

/* We use the high bit to indicate different name for the same
   prefix.  */
#define ADDR16_PREFIX	(0x67 | 0x100)
#define ADDR32_PREFIX	(0x67 | 0x200)
#define DATA16_PREFIX	(0x66 | 0x100)
#define DATA32_PREFIX	(0x66 | 0x200)
#define REP_PREFIX	(0xf3 | 0x100)
#define XACQUIRE_PREFIX	(0xf2 | 0x200)
#define XRELEASE_PREFIX	(0xf3 | 0x400)
#define BND_PREFIX	(0xf2 | 0x400)

static int
ckprefix (void)
{
  int newrex, i, length;
  rex = 0;
  rex_ignored = 0;
  prefixes = 0;
  used_prefixes = 0;
  rex_used = 0;
  last_lock_prefix = -1;
  last_repz_prefix = -1;
  last_repnz_prefix = -1;
  last_data_prefix = -1;
  last_addr_prefix = -1;
  last_rex_prefix = -1;
  last_seg_prefix = -1;
  for (i = 0; i < (int) ARRAY_SIZE (all_prefixes); i++)
    all_prefixes[i] = 0;
  i = 0;
  length = 0;
  /* The maximum instruction length is 15bytes.  */
  while (length < MAX_CODE_LENGTH - 1)
    {
      FETCH_DATA (the_info, codep + 1);
      newrex = 0;
      switch (*codep)
	{
	/* REX prefixes family.  */
	case 0x40:
	case 0x41:
	case 0x42:
	case 0x43:
	case 0x44:
	case 0x45:
	case 0x46:
	case 0x47:
	case 0x48:
	case 0x49:
	case 0x4a:
	case 0x4b:
	case 0x4c:
	case 0x4d:
	case 0x4e:
	case 0x4f:
	  if (address_mode == mode_64bit)
	    newrex = *codep;
	  else
	    return 1;
	  last_rex_prefix = i;
	  break;
	case 0xf3:
	  prefixes |= PREFIX_REPZ;
	  last_repz_prefix = i;
	  break;
	case 0xf2:
	  prefixes |= PREFIX_REPNZ;
	  last_repnz_prefix = i;
	  break;
	case 0xf0:
	  prefixes |= PREFIX_LOCK;
	  last_lock_prefix = i;
	  break;
	case 0x2e:
	  prefixes |= PREFIX_CS;
	  last_seg_prefix = i;
	  break;
	case 0x36:
	  prefixes |= PREFIX_SS;
	  last_seg_prefix = i;
	  break;
	case 0x3e:
	  prefixes |= PREFIX_DS;
	  last_seg_prefix = i;
	  break;
	case 0x26:
	  prefixes |= PREFIX_ES;
	  last_seg_prefix = i;
	  break;
	case 0x64:
	  prefixes |= PREFIX_FS;
	  last_seg_prefix = i;
	  break;
	case 0x65:
	  prefixes |= PREFIX_GS;
	  last_seg_prefix = i;
	  break;
	case 0x66:
	  prefixes |= PREFIX_DATA;
	  last_data_prefix = i;
	  break;
	case 0x67:
	  prefixes |= PREFIX_ADDR;
	  last_addr_prefix = i;
	  break;
	case FWAIT_OPCODE:
	  /* fwait is really an instruction.  If there are prefixes
	     before the fwait, they belong to the fwait, *not* to the
	     following instruction.  */
	  if (prefixes || rex)
	    {
	      prefixes |= PREFIX_FWAIT;
	      codep++;
	      /* This ensures that the previous REX prefixes are noticed
		 as unused prefixes, as in the return case below.  */
	      rex_used = rex;
	      return 1;
	    }
	  prefixes = PREFIX_FWAIT;
	  break;
	default:
	  return 1;
	}
      /* Rex is ignored when followed by another prefix.  */
      if (rex)
	{
	  rex_used = rex;
	  return 1;
	}
      if (*codep != FWAIT_OPCODE)
	all_prefixes[i++] = *codep;
      rex = newrex;
      codep++;
      length++;
    }
  return 0;
}

static int
seg_prefix (int pref)
{
  switch (pref)
    {
    case 0x2e:
      return PREFIX_CS;
    case 0x36:
      return PREFIX_SS;
    case 0x3e:
      return PREFIX_DS;
    case 0x26:
      return PREFIX_ES;
    case 0x64:
      return PREFIX_FS;
    case 0x65:
      return PREFIX_GS;
    default:
      return 0;
    }
}

/* Return the name of the prefix byte PREF, or NULL if PREF is not a
   prefix byte.  */

static const char *
prefix_name (int pref, int sizeflag)
{
  static const char *rexes [16] =
    {
      "rex",		/* 0x40 */
      "rex.B",		/* 0x41 */
      "rex.X",		/* 0x42 */
      "rex.XB",		/* 0x43 */
      "rex.R",		/* 0x44 */
      "rex.RB",		/* 0x45 */
      "rex.RX",		/* 0x46 */
      "rex.RXB",	/* 0x47 */
      "rex.W",		/* 0x48 */
      "rex.WB",		/* 0x49 */
      "rex.WX",		/* 0x4a */
      "rex.WXB",	/* 0x4b */
      "rex.WR",		/* 0x4c */
      "rex.WRB",	/* 0x4d */
      "rex.WRX",	/* 0x4e */
      "rex.WRXB",	/* 0x4f */
    };

  switch (pref)
    {
    /* REX prefixes family.  */
    case 0x40:
    case 0x41:
    case 0x42:
    case 0x43:
    case 0x44:
    case 0x45:
    case 0x46:
    case 0x47:
    case 0x48:
    case 0x49:
    case 0x4a:
    case 0x4b:
    case 0x4c:
    case 0x4d:
    case 0x4e:
    case 0x4f:
      return rexes [pref - 0x40];
    case 0xf3:
      return "repz";
    case 0xf2:
      return "repnz";
    case 0xf0:
      return "lock";
    case 0x2e:
      return "cs";
    case 0x36:
      return "ss";
    case 0x3e:
      return "ds";
    case 0x26:
      return "es";
    case 0x64:
      return "fs";
    case 0x65:
      return "gs";
    case 0x66:
      return (sizeflag & DFLAG) ? "data16" : "data32";
    case 0x67:
      if (address_mode == mode_64bit)
	return (sizeflag & AFLAG) ? "addr32" : "addr64";
      else
	return (sizeflag & AFLAG) ? "addr16" : "addr32";
    case FWAIT_OPCODE:
      return "fwait";
    case ADDR16_PREFIX:
      return "addr16";
    case ADDR32_PREFIX:
      return "addr32";
    case DATA16_PREFIX:
      return "data16";
    case DATA32_PREFIX:
      return "data32";
    case REP_PREFIX:
      return "rep";
    case XACQUIRE_PREFIX:
      return "xacquire";
    case XRELEASE_PREFIX:
      return "xrelease";
    case BND_PREFIX:
      return "bnd";
    default:
      return NULL;
    }
}

static char op_out[MAX_OPERANDS][100];
static int op_ad, op_index[MAX_OPERANDS];
static int two_source_ops;
static bfd_vma op_address[MAX_OPERANDS];
static bfd_vma op_riprel[MAX_OPERANDS];
static bfd_vma start_pc;

/*
 *   On the 386's of 1988, the maximum length of an instruction is 15 bytes.
 *   (see topic "Redundant prefixes" in the "Differences from 8086"
 *   section of the "Virtual 8086 Mode" chapter.)
 * 'pc' should be the address of this instruction, it will
 *   be used to print the target address if this is a relative jump or call
 * The function returns the length of this instruction in bytes.
 */

static char intel_syntax;
static char intel_mnemonic = !SYSV386_COMPAT;
static char open_char;
static char close_char;
static char separator_char;
static char scale_char;

/* Here for backwards compatibility.  When gdb stops using
   print_insn_i386_att and print_insn_i386_intel these functions can
   disappear, and print_insn_i386 be merged into print_insn.  */
int
print_insn_i386_att (bfd_vma pc, disassemble_info *info)
{
  intel_syntax = 0;

  return print_insn (pc, info);
}

int
print_insn_i386_intel (bfd_vma pc, disassemble_info *info)
{
  intel_syntax = 1;

  return print_insn (pc, info);
}

int
print_insn_i386 (bfd_vma pc, disassemble_info *info)
{
  intel_syntax = -1;

  return print_insn (pc, info);
}

void
print_i386_disassembler_options (FILE *stream)
{
  fprintf (stream, _("\n\
The following i386/x86-64 specific disassembler options are supported for use\n\
with the -M switch (multiple options should be separated by commas):\n"));

  fprintf (stream, _("  x86-64      Disassemble in 64bit mode\n"));
  fprintf (stream, _("  i386        Disassemble in 32bit mode\n"));
  fprintf (stream, _("  i8086       Disassemble in 16bit mode\n"));
  fprintf (stream, _("  att         Display instruction in AT&T syntax\n"));
  fprintf (stream, _("  intel       Display instruction in Intel syntax\n"));
  fprintf (stream, _("  att-mnemonic\n"
		     "              Display instruction in AT&T mnemonic\n"));
  fprintf (stream, _("  intel-mnemonic\n"
		     "              Display instruction in Intel mnemonic\n"));
  fprintf (stream, _("  addr64      Assume 64bit address size\n"));
  fprintf (stream, _("  addr32      Assume 32bit address size\n"));
  fprintf (stream, _("  addr16      Assume 16bit address size\n"));
  fprintf (stream, _("  data32      Assume 32bit data size\n"));
  fprintf (stream, _("  data16      Assume 16bit data size\n"));
  fprintf (stream, _("  suffix      Always display instruction suffix in AT&T syntax\n"));
}

/* Bad opcode.  */
static const struct dis386 bad_opcode = { "(bad)", { XX } };

/* Get a pointer to struct dis386 with a valid name.  */

static const struct dis386 *
get_valid_dis386 (const struct dis386 *dp, disassemble_info *info)
{
  int vindex, vex_table_index;

  if (dp->name != NULL)
    return dp;

  switch (dp->op[0].bytemode)
    {
    case USE_REG_TABLE:
      dp = &reg_table[dp->op[1].bytemode][modrm.reg];
      break;

    case USE_MOD_TABLE:
      vindex = modrm.mod == 0x3 ? 1 : 0;
      dp = &mod_table[dp->op[1].bytemode][vindex];
      break;

    case USE_RM_TABLE:
      dp = &rm_table[dp->op[1].bytemode][modrm.rm];
      break;

    case USE_PREFIX_TABLE:
      if (need_vex)
	{
	  /* The prefix in VEX is implicit.  */
	  switch (vex.prefix)
	    {
	    case 0:
	      vindex = 0;
	      break;
	    case REPE_PREFIX_OPCODE:
	      vindex = 1;
	      break;
	    case DATA_PREFIX_OPCODE:
	      vindex = 2;
	      break;
	    case REPNE_PREFIX_OPCODE:
	      vindex = 3;
	      break;
	    default:
	      abort ();
	      break;
	    }
	}
      else
	{
	  vindex = 0;
	  used_prefixes |= (prefixes & PREFIX_REPZ);
	  if (prefixes & PREFIX_REPZ)
	    {
	      vindex = 1;
	      all_prefixes[last_repz_prefix] = 0;
	    }
	  else
	    {
	      /* We should check PREFIX_REPNZ and PREFIX_REPZ before
		 PREFIX_DATA.  */
	      used_prefixes |= (prefixes & PREFIX_REPNZ);
	      if (prefixes & PREFIX_REPNZ)
		{
		  vindex = 3;
		  all_prefixes[last_repnz_prefix] = 0;
		}
	      else
		{
		  used_prefixes |= (prefixes & PREFIX_DATA);
		  if (prefixes & PREFIX_DATA)
		    {
		      vindex = 2;
		      all_prefixes[last_data_prefix] = 0;
		    }
		}
	    }
	}
      dp = &prefix_table[dp->op[1].bytemode][vindex];
      break;

    case USE_X86_64_TABLE:
      vindex = address_mode == mode_64bit ? 1 : 0;
      dp = &x86_64_table[dp->op[1].bytemode][vindex];
      break;

    case USE_3BYTE_TABLE:
      FETCH_DATA (info, codep + 2);
      vindex = *codep++;
      dp = &three_byte_table[dp->op[1].bytemode][vindex];
      modrm.mod = (*codep >> 6) & 3;
      modrm.reg = (*codep >> 3) & 7;
      modrm.rm = *codep & 7;
      break;

    case USE_VEX_LEN_TABLE:
      if (!need_vex)
	abort ();

      switch (vex.length)
	{
	case 128:
	  vindex = 0;
	  break;
	case 256:
	  vindex = 1;
	  break;
	default:
	  abort ();
	  break;
	}

      dp = &vex_len_table[dp->op[1].bytemode][vindex];
      break;

    case USE_XOP_8F_TABLE:
      FETCH_DATA (info, codep + 3);
      /* All bits in the REX prefix are ignored.  */
      rex_ignored = rex;
      rex = ~(*codep >> 5) & 0x7;

      /* VEX_TABLE_INDEX is the mmmmm part of the XOP byte 1 "RCB.mmmmm".  */
      switch ((*codep & 0x1f))
	{
	default:
	  dp = &bad_opcode;
	  return dp;
	case 0x8:
	  vex_table_index = XOP_08;
	  break;
	case 0x9:
	  vex_table_index = XOP_09;
	  break;
	case 0xa:
	  vex_table_index = XOP_0A;
	  break;
	}
      codep++;
      vex.w = *codep & 0x80;
      if (vex.w && address_mode == mode_64bit)
	rex |= REX_W;

      vex.register_specifier = (~(*codep >> 3)) & 0xf;
      if (address_mode != mode_64bit
	  && vex.register_specifier > 0x7)
	{
	  dp = &bad_opcode;
	  return dp;
	}

      vex.length = (*codep & 0x4) ? 256 : 128;
      switch ((*codep & 0x3))
	{
	case 0:
	  vex.prefix = 0;
	  break;
	case 1:
	  vex.prefix = DATA_PREFIX_OPCODE;
	  break;
	case 2:
	  vex.prefix = REPE_PREFIX_OPCODE;
	  break;
	case 3:
	  vex.prefix = REPNE_PREFIX_OPCODE;
	  break;
	}
      need_vex = 1;
      need_vex_reg = 1;
      codep++;
      vindex = *codep++;
      dp = &xop_table[vex_table_index][vindex];

      FETCH_DATA (info, codep + 1);
      modrm.mod = (*codep >> 6) & 3;
      modrm.reg = (*codep >> 3) & 7;
      modrm.rm = *codep & 7;
      break;

    case USE_VEX_C4_TABLE:
      /* VEX prefix.  */
      FETCH_DATA (info, codep + 3);
      /* All bits in the REX prefix are ignored.  */
      rex_ignored = rex;
      rex = ~(*codep >> 5) & 0x7;
      switch ((*codep & 0x1f))
	{
	default:
	  dp = &bad_opcode;
	  return dp;
	case 0x1:
	  vex_table_index = VEX_0F;
	  break;
	case 0x2:
	  vex_table_index = VEX_0F38;
	  break;
	case 0x3:
	  vex_table_index = VEX_0F3A;
	  break;
	}
      codep++;
      vex.w = *codep & 0x80;
      if (vex.w && address_mode == mode_64bit)
	rex |= REX_W;

      vex.register_specifier = (~(*codep >> 3)) & 0xf;
      if (address_mode != mode_64bit
	  && vex.register_specifier > 0x7)
	{
	  dp = &bad_opcode;
	  return dp;
	}

      vex.length = (*codep & 0x4) ? 256 : 128;
      switch ((*codep & 0x3))
	{
	case 0:
	  vex.prefix = 0;
	  break;
	case 1:
	  vex.prefix = DATA_PREFIX_OPCODE;
	  break;
	case 2:
	  vex.prefix = REPE_PREFIX_OPCODE;
	  break;
	case 3:
	  vex.prefix = REPNE_PREFIX_OPCODE;
	  break;
	}
      need_vex = 1;
      need_vex_reg = 1;
      codep++;
      vindex = *codep++;
      dp = &vex_table[vex_table_index][vindex];
      /* There is no MODRM byte for VEX [82|77].  */
      if (vindex != 0x77 && vindex != 0x82)
	{
	  FETCH_DATA (info, codep + 1);
	  modrm.mod = (*codep >> 6) & 3;
	  modrm.reg = (*codep >> 3) & 7;
	  modrm.rm = *codep & 7;
	}
      break;

    case USE_VEX_C5_TABLE:
      /* VEX prefix.  */
      FETCH_DATA (info, codep + 2);
      /* All bits in the REX prefix are ignored.  */
      rex_ignored = rex;
      rex = (*codep & 0x80) ? 0 : REX_R;

      vex.register_specifier = (~(*codep >> 3)) & 0xf;
      if (address_mode != mode_64bit
	  && vex.register_specifier > 0x7)
	{
	  dp = &bad_opcode;
	  return dp;
	}

      vex.w = 0;

      vex.length = (*codep & 0x4) ? 256 : 128;
      switch ((*codep & 0x3))
	{
	case 0:
	  vex.prefix = 0;
	  break;
	case 1:
	  vex.prefix = DATA_PREFIX_OPCODE;
	  break;
	case 2:
	  vex.prefix = REPE_PREFIX_OPCODE;
	  break;
	case 3:
	  vex.prefix = REPNE_PREFIX_OPCODE;
	  break;
	}
      need_vex = 1;
      need_vex_reg = 1;
      codep++;
      vindex = *codep++;
      dp = &vex_table[dp->op[1].bytemode][vindex];
      /* There is no MODRM byte for VEX [82|77].  */
      if (vindex != 0x77 && vindex != 0x82)
	{
	  FETCH_DATA (info, codep + 1);
	  modrm.mod = (*codep >> 6) & 3;
	  modrm.reg = (*codep >> 3) & 7;
	  modrm.rm = *codep & 7;
	}
      break;

    case USE_VEX_W_TABLE:
      if (!need_vex)
	abort ();

      dp = &vex_w_table[dp->op[1].bytemode][vex.w ? 1 : 0];
      break;

    case USE_EVEX_TABLE:
      two_source_ops = 0;
      /* EVEX prefix.  */
      vex.evex = 1;
      FETCH_DATA (info, codep + 4);
      /* All bits in the REX prefix are ignored.  */
      rex_ignored = rex;
      /* The first byte after 0x62.  */
      rex = ~(*codep >> 5) & 0x7;
      vex.r = *codep & 0x10;
      switch ((*codep & 0xf))
	{
	default:
	  return &bad_opcode;
	case 0x1:
	  vex_table_index = EVEX_0F;
	  break;
	case 0x2:
	  vex_table_index = EVEX_0F38;
	  break;
	case 0x3:
	  vex_table_index = EVEX_0F3A;
	  break;
	}

      /* The second byte after 0x62.  */
      codep++;
      vex.w = *codep & 0x80;
      if (vex.w && address_mode == mode_64bit)
	rex |= REX_W;

      vex.register_specifier = (~(*codep >> 3)) & 0xf;
      if (address_mode != mode_64bit)
	{
	  /* In 16/32-bit mode silently ignore following bits.  */
	  rex &= ~REX_B;
	  vex.r = 1;
	  vex.v = 1;
	  vex.register_specifier &= 0x7;
	}

      /* The U bit.  */
      if (!(*codep & 0x4))
	return &bad_opcode;

      switch ((*codep & 0x3))
	{
	case 0:
	  vex.prefix = 0;
	  break;
	case 1:
	  vex.prefix = DATA_PREFIX_OPCODE;
	  break;
	case 2:
	  vex.prefix = REPE_PREFIX_OPCODE;
	  break;
	case 3:
	  vex.prefix = REPNE_PREFIX_OPCODE;
	  break;
	}

      /* The third byte after 0x62.  */
      codep++;

      /* Remember the static rounding bits.  */
      vex.ll = (*codep >> 5) & 3;
      vex.b = (*codep & 0x10) != 0;

      vex.v = *codep & 0x8;
      vex.mask_register_specifier = *codep & 0x7;
      vex.zeroing = *codep & 0x80;

      need_vex = 1;
      need_vex_reg = 1;
      codep++;
      vindex = *codep++;
      dp = &evex_table[vex_table_index][vindex];
      FETCH_DATA (info, codep + 1);
      modrm.mod = (*codep >> 6) & 3;
      modrm.reg = (*codep >> 3) & 7;
      modrm.rm = *codep & 7;

      /* Set vector length.  */
      if (modrm.mod == 3 && vex.b)
	vex.length = 512;
      else
	{
	  switch (vex.ll)
	    {
	    case 0x0:
	      vex.length = 128;
	      break;
	    case 0x1:
	      vex.length = 256;
	      break;
	    case 0x2:
	      vex.length = 512;
	      break;
	    default:
	      return &bad_opcode;
	    }
	}
      break;

    case 0:
      dp = &bad_opcode;
      break;

    default:
      abort ();
    }

  if (dp->name != NULL)
    return dp;
  else
    return get_valid_dis386 (dp, info);
}

static void
get_sib (disassemble_info *info, int sizeflag)
{
  /* If modrm.mod == 3, operand must be register.  */
  if (need_modrm
      && ((sizeflag & AFLAG) || address_mode == mode_64bit)
      && modrm.mod != 3
      && modrm.rm == 4)
    {
      FETCH_DATA (info, codep + 2);
      sib.index = (codep [1] >> 3) & 7;
      sib.scale = (codep [1] >> 6) & 3;
      sib.base = codep [1] & 7;
    }
}

static int
print_insn (bfd_vma pc, disassemble_info *info)
{
  const struct dis386 *dp;
  int i;
  char *op_txt[MAX_OPERANDS];
  int needcomma;
  int sizeflag;
  const char *p;
  struct dis_private priv;
  int prefix_length;
  int default_prefixes;

  priv.orig_sizeflag = AFLAG | DFLAG;
  if ((info->mach & bfd_mach_i386_i386) != 0)
    address_mode = mode_32bit;
  else if (info->mach == bfd_mach_i386_i8086)
    {
      address_mode = mode_16bit;
      priv.orig_sizeflag = 0;
    }
  else
    address_mode = mode_64bit;

  if (intel_syntax == (char) -1)
    intel_syntax = (info->mach & bfd_mach_i386_intel_syntax) != 0;

  for (p = info->disassembler_options; p != NULL; )
    {
      if (CONST_STRNEQ (p, "x86-64"))
	{
	  address_mode = mode_64bit;
	  priv.orig_sizeflag = AFLAG | DFLAG;
	}
      else if (CONST_STRNEQ (p, "i386"))
	{
	  address_mode = mode_32bit;
	  priv.orig_sizeflag = AFLAG | DFLAG;
	}
      else if (CONST_STRNEQ (p, "i8086"))
	{
	  address_mode = mode_16bit;
	  priv.orig_sizeflag = 0;
	}
      else if (CONST_STRNEQ (p, "intel"))
	{
	  intel_syntax = 1;
	  if (CONST_STRNEQ (p + 5, "-mnemonic"))
	    intel_mnemonic = 1;
	}
      else if (CONST_STRNEQ (p, "att"))
	{
	  intel_syntax = 0;
	  if (CONST_STRNEQ (p + 3, "-mnemonic"))
	    intel_mnemonic = 0;
	}
      else if (CONST_STRNEQ (p, "addr"))
	{
	  if (address_mode == mode_64bit)
	    {
	      if (p[4] == '3' && p[5] == '2')
		priv.orig_sizeflag &= ~AFLAG;
	      else if (p[4] == '6' && p[5] == '4')
		priv.orig_sizeflag |= AFLAG;
	    }
	  else
	    {
	      if (p[4] == '1' && p[5] == '6')
		priv.orig_sizeflag &= ~AFLAG;
	      else if (p[4] == '3' && p[5] == '2')
		priv.orig_sizeflag |= AFLAG;
	    }
	}
      else if (CONST_STRNEQ (p, "data"))
	{
	  if (p[4] == '1' && p[5] == '6')
	    priv.orig_sizeflag &= ~DFLAG;
	  else if (p[4] == '3' && p[5] == '2')
	    priv.orig_sizeflag |= DFLAG;
	}
      else if (CONST_STRNEQ (p, "suffix"))
	priv.orig_sizeflag |= SUFFIX_ALWAYS;

      p = strchr (p, ',');
      if (p != NULL)
	p++;
    }

  if (intel_syntax)
    {
      names64 = intel_names64;
      names32 = intel_names32;
      names16 = intel_names16;
      names8 = intel_names8;
      names8rex = intel_names8rex;
      names_seg = intel_names_seg;
      names_mm = intel_names_mm;
      names_bnd = intel_names_bnd;
      names_xmm = intel_names_xmm;
      names_ymm = intel_names_ymm;
      names_zmm = intel_names_zmm;
      index64 = intel_index64;
      index32 = intel_index32;
      names_mask = intel_names_mask;
      index16 = intel_index16;
      open_char = '[';
      close_char = ']';
      separator_char = '+';
      scale_char = '*';
    }
  else
    {
      names64 = att_names64;
      names32 = att_names32;
      names16 = att_names16;
      names8 = att_names8;
      names8rex = att_names8rex;
      names_seg = att_names_seg;
      names_mm = att_names_mm;
      names_bnd = att_names_bnd;
      names_xmm = att_names_xmm;
      names_ymm = att_names_ymm;
      names_zmm = att_names_zmm;
      index64 = att_index64;
      index32 = att_index32;
      names_mask = att_names_mask;
      index16 = att_index16;
      open_char = '(';
      close_char =  ')';
      separator_char = ',';
      scale_char = ',';
    }

  /* The output looks better if we put 7 bytes on a line, since that
     puts most long word instructions on a single line.  Use 8 bytes
     for Intel L1OM.  */
  if ((info->mach & bfd_mach_l1om) != 0)
    info->bytes_per_line = 8;
  else
    info->bytes_per_line = 7;

  info->private_data = &priv;
  priv.max_fetched = priv.the_buffer;
  priv.insn_start = pc;

  obuf[0] = 0;
  for (i = 0; i < MAX_OPERANDS; ++i)
    {
      op_out[i][0] = 0;
      op_index[i] = -1;
    }

  the_info = info;
  start_pc = pc;
  start_codep = priv.the_buffer;
  codep = priv.the_buffer;

  if (setjmp (priv.bailout) != 0)
    {
      const char *name;

      /* Getting here means we tried for data but didn't get it.  That
	 means we have an incomplete instruction of some sort.  Just
	 print the first byte as a prefix or a .byte pseudo-op.  */
      if (codep > priv.the_buffer)
	{
	  name = prefix_name (priv.the_buffer[0], priv.orig_sizeflag);
	  if (name != NULL)
	    (*info->fprintf_func) (info->stream, "%s", name);
	  else
	    {
	      /* Just print the first byte as a .byte instruction.  */
	      (*info->fprintf_func) (info->stream, ".byte 0x%x",
				     (unsigned int) priv.the_buffer[0]);
	    }

	  return 1;
	}

      return -1;
    }

  obufp = obuf;
  sizeflag = priv.orig_sizeflag;

  if (!ckprefix () || rex_used)
    {
      /* Too many prefixes or unused REX prefixes.  */
      for (i = 0;
	   i < (int) ARRAY_SIZE (all_prefixes) && all_prefixes[i];
	   i++)
	(*info->fprintf_func) (info->stream, "%s%s",
			       i == 0 ? "" : " ",
			       prefix_name (all_prefixes[i], sizeflag));
      return i;
    }

  insn_codep = codep;

  FETCH_DATA (info, codep + 1);
  two_source_ops = (*codep == 0x62) || (*codep == 0xc8);

  if (((prefixes & PREFIX_FWAIT)
       && ((*codep < 0xd8) || (*codep > 0xdf))))
    {
      (*info->fprintf_func) (info->stream, "fwait");
      return 1;
    }

  if (*codep == 0x0f)
    {
      unsigned char threebyte;
      FETCH_DATA (info, codep + 2);
      threebyte = *++codep;
      dp = &dis386_twobyte[threebyte];
      need_modrm = twobyte_has_modrm[*codep];
      codep++;
    }
  else
    {
      dp = &dis386[*codep];
      need_modrm = onebyte_has_modrm[*codep];
      codep++;
    }

  if ((prefixes & PREFIX_REPZ))
    used_prefixes |= PREFIX_REPZ;
  if ((prefixes & PREFIX_REPNZ))
    used_prefixes |= PREFIX_REPNZ;
  if ((prefixes & PREFIX_LOCK))
    used_prefixes |= PREFIX_LOCK;

  default_prefixes = 0;
  if (prefixes & PREFIX_ADDR)
    {
      sizeflag ^= AFLAG;
      if (dp->op[2].bytemode != loop_jcxz_mode || intel_syntax)
	{
	  if ((sizeflag & AFLAG) || address_mode == mode_64bit)
	    all_prefixes[last_addr_prefix] = ADDR32_PREFIX;
	  else
	    all_prefixes[last_addr_prefix] = ADDR16_PREFIX;
	  default_prefixes |= PREFIX_ADDR;
	}
    }

  if ((prefixes & PREFIX_DATA))
    {
      sizeflag ^= DFLAG;
      if (dp->op[2].bytemode == cond_jump_mode
	  && dp->op[0].bytemode == v_mode
	  && !intel_syntax)
	{
	  if (sizeflag & DFLAG)
	    all_prefixes[last_data_prefix] = DATA32_PREFIX;
	  else
	    all_prefixes[last_data_prefix] = DATA16_PREFIX;
	  default_prefixes |= PREFIX_DATA;
	}
      else if (rex & REX_W)
	{
	  /* REX_W will override PREFIX_DATA.  */
	  default_prefixes |= PREFIX_DATA;
	}
    }

  if (need_modrm)
    {
      FETCH_DATA (info, codep + 1);
      modrm.mod = (*codep >> 6) & 3;
      modrm.reg = (*codep >> 3) & 7;
      modrm.rm = *codep & 7;
    }

  need_vex = 0;
  need_vex_reg = 0;
  vex_w_done = 0;
  vex.evex = 0;

  if (dp->name == NULL && dp->op[0].bytemode == FLOATCODE)
    {
      get_sib (info, sizeflag);
      dofloat (sizeflag);
    }
  else
    {
      dp = get_valid_dis386 (dp, info);
      if (dp != NULL && putop (dp->name, sizeflag) == 0)
	{
	  get_sib (info, sizeflag);
	  for (i = 0; i < MAX_OPERANDS; ++i)
	    {
	      obufp = op_out[i];
	      op_ad = MAX_OPERANDS - 1 - i;
	      if (dp->op[i].rtn)
		(*dp->op[i].rtn) (dp->op[i].bytemode, sizeflag);
	      /* For EVEX instruction after the last operand masking
		 should be printed.  */
	      if (i == 0 && vex.evex)
		{
		  /* Don't print {%k0}.  */
		  if (vex.mask_register_specifier)
		    {
		      oappend ("{");
		      oappend (names_mask[vex.mask_register_specifier]);
		      oappend ("}");
		    }
		  if (vex.zeroing)
		    oappend ("{z}");
		}
	    }
	}
    }

  /* See if any prefixes were not used.  If so, print the first one
     separately.  If we don't do this, we'll wind up printing an
     instruction stream which does not precisely correspond to the
     bytes we are disassembling.  */
  if ((prefixes & ~(used_prefixes | default_prefixes)) != 0)
    {
      for (i = 0; i < (int) ARRAY_SIZE (all_prefixes); i++)
	if (all_prefixes[i])
	  {
	    const char *name;
	    name = prefix_name (all_prefixes[i], priv.orig_sizeflag);
	    if (name == NULL)
	      name = INTERNAL_DISASSEMBLER_ERROR;
	    (*info->fprintf_func) (info->stream, "%s", name);
	    return 1;
	  }
    }

  /* Check if the REX prefix is used.  */
  if (rex_ignored == 0 && (rex ^ rex_used) == 0)
    all_prefixes[last_rex_prefix] = 0;

  /* Check if the SEG prefix is used.  */
  if ((prefixes & (PREFIX_CS | PREFIX_SS | PREFIX_DS | PREFIX_ES
		   | PREFIX_FS | PREFIX_GS)) != 0
      && (used_prefixes
	  & seg_prefix (all_prefixes[last_seg_prefix])) != 0)
    all_prefixes[last_seg_prefix] = 0;

  /* Check if the ADDR prefix is used.  */
  if ((prefixes & PREFIX_ADDR) != 0
      && (used_prefixes & PREFIX_ADDR) != 0)
    all_prefixes[last_addr_prefix] = 0;

  /* Check if the DATA prefix is used.  */
  if ((prefixes & PREFIX_DATA) != 0
      && (used_prefixes & PREFIX_DATA) != 0)
    all_prefixes[last_data_prefix] = 0;

  prefix_length = 0;
  for (i = 0; i < (int) ARRAY_SIZE (all_prefixes); i++)
    if (all_prefixes[i])
      {
	const char *name;
	name = prefix_name (all_prefixes[i], sizeflag);
	if (name == NULL)
	  abort ();
	prefix_length += strlen (name) + 1;
	(*info->fprintf_func) (info->stream, "%s ", name);
      }

  /* Check maximum code length.  */
  if ((codep - start_codep) > MAX_CODE_LENGTH)
    {
      (*info->fprintf_func) (info->stream, "(bad)");
      return MAX_CODE_LENGTH;
    }

  obufp = mnemonicendp;
  for (i = strlen (obuf) + prefix_length; i < 6; i++)
    oappend (" ");
  oappend (" ");
  (*info->fprintf_func) (info->stream, "%s", obuf);

  /* The enter and bound instructions are printed with operands in the same
     order as the intel book; everything else is printed in reverse order.  */
  if (intel_syntax || two_source_ops)
    {
      bfd_vma riprel;

      for (i = 0; i < MAX_OPERANDS; ++i)
	op_txt[i] = op_out[i];

      for (i = 0; i < (MAX_OPERANDS >> 1); ++i)
	{
	  op_ad = op_index[i];
	  op_index[i] = op_index[MAX_OPERANDS - 1 - i];
	  op_index[MAX_OPERANDS - 1 - i] = op_ad;
	  riprel = op_riprel[i];
	  op_riprel[i] = op_riprel [MAX_OPERANDS - 1 - i];
	  op_riprel[MAX_OPERANDS - 1 - i] = riprel;
	}
    }
  else
    {
      for (i = 0; i < MAX_OPERANDS; ++i)
	op_txt[MAX_OPERANDS - 1 - i] = op_out[i];
    }

  needcomma = 0;
  for (i = 0; i < MAX_OPERANDS; ++i)
    if (*op_txt[i])
      {
	if (needcomma)
	  (*info->fprintf_func) (info->stream, ",");
	if (op_index[i] != -1 && !op_riprel[i])
	  (*info->print_address_func) ((bfd_vma) op_address[op_index[i]], info);
	else
	  (*info->fprintf_func) (info->stream, "%s", op_txt[i]);
	needcomma = 1;
      }

  for (i = 0; i < MAX_OPERANDS; i++)
    if (op_index[i] != -1 && op_riprel[i])
      {
	(*info->fprintf_func) (info->stream, "        # ");
	(*info->print_address_func) ((bfd_vma) (start_pc + codep - start_codep
						+ op_address[op_index[i]]), info);
	break;
      }
  return codep - priv.the_buffer;
}

static const char *float_mem[] = {
  /* d8 */
  "fadd{s|}",
  "fmul{s|}",
  "fcom{s|}",
  "fcomp{s|}",
  "fsub{s|}",
  "fsubr{s|}",
  "fdiv{s|}",
  "fdivr{s|}",
  /* d9 */
  "fld{s|}",
  "(bad)",
  "fst{s|}",
  "fstp{s|}",
  "fldenvIC",
  "fldcw",
  "fNstenvIC",
  "fNstcw",
  /* da */
  "fiadd{l|}",
  "fimul{l|}",
  "ficom{l|}",
  "ficomp{l|}",
  "fisub{l|}",
  "fisubr{l|}",
  "fidiv{l|}",
  "fidivr{l|}",
  /* db */
  "fild{l|}",
  "fisttp{l|}",
  "fist{l|}",
  "fistp{l|}",
  "(bad)",
  "fld{t||t|}",
  "(bad)",
  "fstp{t||t|}",
  /* dc */
  "fadd{l|}",
  "fmul{l|}",
  "fcom{l|}",
  "fcomp{l|}",
  "fsub{l|}",
  "fsubr{l|}",
  "fdiv{l|}",
  "fdivr{l|}",
  /* dd */
  "fld{l|}",
  "fisttp{ll|}",
  "fst{l||}",
  "fstp{l|}",
  "frstorIC",
  "(bad)",
  "fNsaveIC",
  "fNstsw",
  /* de */
  "fiadd",
  "fimul",
  "ficom",
  "ficomp",
  "fisub",
  "fisubr",
  "fidiv",
  "fidivr",
  /* df */
  "fild",
  "fisttp",
  "fist",
  "fistp",
  "fbld",
  "fild{ll|}",
  "fbstp",
  "fistp{ll|}",
};

static const unsigned char float_mem_mode[] = {
  /* d8 */
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  /* d9 */
  d_mode,
  0,
  d_mode,
  d_mode,
  0,
  w_mode,
  0,
  w_mode,
  /* da */
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  /* db */
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  0,
  t_mode,
  0,
  t_mode,
  /* dc */
  q_mode,
  q_mode,
  q_mode,
  q_mode,
  q_mode,
  q_mode,
  q_mode,
  q_mode,
  /* dd */
  q_mode,
  q_mode,
  q_mode,
  q_mode,
  0,
  0,
  0,
  w_mode,
  /* de */
  w_mode,
  w_mode,
  w_mode,
  w_mode,
  w_mode,
  w_mode,
  w_mode,
  w_mode,
  /* df */
  w_mode,
  w_mode,
  w_mode,
  w_mode,
  t_mode,
  q_mode,
  t_mode,
  q_mode
};

#define ST { OP_ST, 0 }
#define STi { OP_STi, 0 }

#define FGRPd9_2 NULL, { { NULL, 0 } }
#define FGRPd9_4 NULL, { { NULL, 1 } }
#define FGRPd9_5 NULL, { { NULL, 2 } }
#define FGRPd9_6 NULL, { { NULL, 3 } }
#define FGRPd9_7 NULL, { { NULL, 4 } }
#define FGRPda_5 NULL, { { NULL, 5 } }
#define FGRPdb_4 NULL, { { NULL, 6 } }
#define FGRPde_3 NULL, { { NULL, 7 } }
#define FGRPdf_4 NULL, { { NULL, 8 } }

static const struct dis386 float_reg[][8] = {
  /* d8 */
  {
    { "fadd",	{ ST, STi } },
    { "fmul",	{ ST, STi } },
    { "fcom",	{ STi } },
    { "fcomp",	{ STi } },
    { "fsub",	{ ST, STi } },
    { "fsubr",	{ ST, STi } },
    { "fdiv",	{ ST, STi } },
    { "fdivr",	{ ST, STi } },
  },
  /* d9 */
  {
    { "fld",	{ STi } },
    { "fxch",	{ STi } },
    { FGRPd9_2 },
    { Bad_Opcode },
    { FGRPd9_4 },
    { FGRPd9_5 },
    { FGRPd9_6 },
    { FGRPd9_7 },
  },
  /* da */
  {
    { "fcmovb",	{ ST, STi } },
    { "fcmove",	{ ST, STi } },
    { "fcmovbe",{ ST, STi } },
    { "fcmovu",	{ ST, STi } },
    { Bad_Opcode },
    { FGRPda_5 },
    { Bad_Opcode },
    { Bad_Opcode },
  },
  /* db */
  {
    { "fcmovnb",{ ST, STi } },
    { "fcmovne",{ ST, STi } },
    { "fcmovnbe",{ ST, STi } },
    { "fcmovnu",{ ST, STi } },
    { FGRPdb_4 },
    { "fucomi",	{ ST, STi } },
    { "fcomi",	{ ST, STi } },
    { Bad_Opcode },
  },
  /* dc */
  {
    { "fadd",	{ STi, ST } },
    { "fmul",	{ STi, ST } },
    { Bad_Opcode },
    { Bad_Opcode },
    { "fsub!M",	{ STi, ST } },
    { "fsubM",	{ STi, ST } },
    { "fdiv!M",	{ STi, ST } },
    { "fdivM",	{ STi, ST } },
  },
  /* dd */
  {
    { "ffree",	{ STi } },
    { Bad_Opcode },
    { "fst",	{ STi } },
    { "fstp",	{ STi } },
    { "fucom",	{ STi } },
    { "fucomp",	{ STi } },
    { Bad_Opcode },
    { Bad_Opcode },
  },
  /* de */
  {
    { "faddp",	{ STi, ST } },
    { "fmulp",	{ STi, ST } },
    { Bad_Opcode },
    { FGRPde_3 },
    { "fsub!Mp", { STi, ST } },
    { "fsubMp",	{ STi, ST } },
    { "fdiv!Mp", { STi, ST } },
    { "fdivMp",	{ STi, ST } },
  },
  /* df */
  {
    { "ffreep",	{ STi } },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { FGRPdf_4 },
    { "fucomip", { ST, STi } },
    { "fcomip", { ST, STi } },
    { Bad_Opcode },
  },
};

static char *fgrps[][8] = {
  /* d9_2  0 */
  {
    "fnop","(bad)","(bad)","(bad)","(bad)","(bad)","(bad)","(bad)",
  },

  /* d9_4  1 */
  {
    "fchs","fabs","(bad)","(bad)","ftst","fxam","(bad)","(bad)",
  },

  /* d9_5  2 */
  {
    "fld1","fldl2t","fldl2e","fldpi","fldlg2","fldln2","fldz","(bad)",
  },

  /* d9_6  3 */
  {
    "f2xm1","fyl2x","fptan","fpatan","fxtract","fprem1","fdecstp","fincstp",
  },

  /* d9_7  4 */
  {
    "fprem","fyl2xp1","fsqrt","fsincos","frndint","fscale","fsin","fcos",
  },

  /* da_5  5 */
  {
    "(bad)","fucompp","(bad)","(bad)","(bad)","(bad)","(bad)","(bad)",
  },

  /* db_4  6 */
  {
    "fNeni(8087 only)","fNdisi(8087 only)","fNclex","fNinit",
    "fNsetpm(287 only)","frstpm(287 only)","(bad)","(bad)",
  },

  /* de_3  7 */
  {
    "(bad)","fcompp","(bad)","(bad)","(bad)","(bad)","(bad)","(bad)",
  },

  /* df_4  8 */
  {
    "fNstsw","(bad)","(bad)","(bad)","(bad)","(bad)","(bad)","(bad)",
  },
};

static void
swap_operand (void)
{
  mnemonicendp[0] = '.';
  mnemonicendp[1] = 's';
  mnemonicendp += 2;
}

static void
OP_Skip_MODRM (int bytemode ATTRIBUTE_UNUSED,
	       int sizeflag ATTRIBUTE_UNUSED)
{
  /* Skip mod/rm byte.  */
  MODRM_CHECK;
  codep++;
}

static void
dofloat (int sizeflag)
{
  const struct dis386 *dp;
  unsigned char floatop;

  floatop = codep[-1];

  if (modrm.mod != 3)
    {
      int fp_indx = (floatop - 0xd8) * 8 + modrm.reg;

      putop (float_mem[fp_indx], sizeflag);
      obufp = op_out[0];
      op_ad = 2;
      OP_E (float_mem_mode[fp_indx], sizeflag);
      return;
    }
  /* Skip mod/rm byte.  */
  MODRM_CHECK;
  codep++;

  dp = &float_reg[floatop - 0xd8][modrm.reg];
  if (dp->name == NULL)
    {
      putop (fgrps[dp->op[0].bytemode][modrm.rm], sizeflag);

      /* Instruction fnstsw is only one with strange arg.  */
      if (floatop == 0xdf && codep[-1] == 0xe0)
	strcpy (op_out[0], names16[0]);
    }
  else
    {
      putop (dp->name, sizeflag);

      obufp = op_out[0];
      op_ad = 2;
      if (dp->op[0].rtn)
	(*dp->op[0].rtn) (dp->op[0].bytemode, sizeflag);

      obufp = op_out[1];
      op_ad = 1;
      if (dp->op[1].rtn)
	(*dp->op[1].rtn) (dp->op[1].bytemode, sizeflag);
    }
}

/* Like oappend (below), but S is a string starting with '%'.
   In Intel syntax, the '%' is elided.  */
static void
oappend_maybe_intel (const char *s)
{
  oappend (s + intel_syntax);
}

static void
OP_ST (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  oappend_maybe_intel ("%st");
}

static void
OP_STi (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  sprintf (scratchbuf, "%%st(%d)", modrm.rm);
  oappend_maybe_intel (scratchbuf);
}

/* Capital letters in template are macros.  */
static int
putop (const char *in_template, int sizeflag)
{
  const char *p;
  int alt = 0;
  int cond = 1;
  unsigned int l = 0, len = 1;
  char last[4];

#define SAVE_LAST(c)			\
  if (l < len && l < sizeof (last))	\
    last[l++] = c;			\
  else					\
    abort ();

  for (p = in_template; *p; p++)
    {
      switch (*p)
	{
	default:
	  *obufp++ = *p;
	  break;
	case '%':
	  len++;
	  break;
	case '!':
	  cond = 0;
	  break;
	case '{':
	  alt = 0;
	  if (intel_syntax)
	    {
	      while (*++p != '|')
		if (*p == '}' || *p == '\0')
		  abort ();
	    }
	  /* Fall through.  */
	case 'I':
	  alt = 1;
	  continue;
	case '|':
	  while (*++p != '}')
	    {
	      if (*p == '\0')
		abort ();
	    }
	  break;
	case '}':
	  break;
	case 'A':
	  if (intel_syntax)
	    break;
	  if (modrm.mod != 3 || (sizeflag & SUFFIX_ALWAYS))
	    *obufp++ = 'b';
	  break;
	case 'B':
	  if (l == 0 && len == 1)
	    {
case_B:
	      if (intel_syntax)
		break;
	      if (sizeflag & SUFFIX_ALWAYS)
		*obufp++ = 'b';
	    }
	  else
	    {
	      if (l != 1
		  || len != 2
		  || last[0] != 'L')
		{
		  SAVE_LAST (*p);
		  break;
		}

	      if (address_mode == mode_64bit
		  && !(prefixes & PREFIX_ADDR))
		{
		  *obufp++ = 'a';
		  *obufp++ = 'b';
		  *obufp++ = 's';
		}

	      goto case_B;
	    }
	  break;
	case 'C':
	  if (intel_syntax && !alt)
	    break;
	  if ((prefixes & PREFIX_DATA) || (sizeflag & SUFFIX_ALWAYS))
	    {
	      if (sizeflag & DFLAG)
		*obufp++ = intel_syntax ? 'd' : 'l';
	      else
		*obufp++ = intel_syntax ? 'w' : 's';
	      used_prefixes |= (prefixes & PREFIX_DATA);
	    }
	  break;
	case 'D':
	  if (intel_syntax || !(sizeflag & SUFFIX_ALWAYS))
	    break;
	  USED_REX (REX_W);
	  if (modrm.mod == 3)
	    {
	      if (rex & REX_W)
		*obufp++ = 'q';
	      else
		{
		  if (sizeflag & DFLAG)
		    *obufp++ = intel_syntax ? 'd' : 'l';
		  else
		    *obufp++ = 'w';
		  used_prefixes |= (prefixes & PREFIX_DATA);
		}
	    }
	  else
	    *obufp++ = 'w';
	  break;
	case 'E':		/* For jcxz/jecxz */
	  if (address_mode == mode_64bit)
	    {
	      if (sizeflag & AFLAG)
		*obufp++ = 'r';
	      else
		*obufp++ = 'e';
	    }
	  else
	    if (sizeflag & AFLAG)
	      *obufp++ = 'e';
	  used_prefixes |= (prefixes & PREFIX_ADDR);
	  break;
	case 'F':
	  if (intel_syntax)
	    break;
	  if ((prefixes & PREFIX_ADDR) || (sizeflag & SUFFIX_ALWAYS))
	    {
	      if (sizeflag & AFLAG)
		*obufp++ = address_mode == mode_64bit ? 'q' : 'l';
	      else
		*obufp++ = address_mode == mode_64bit ? 'l' : 'w';
	      used_prefixes |= (prefixes & PREFIX_ADDR);
	    }
	  break;
	case 'G':
	  if (intel_syntax || (obufp[-1] != 's' && !(sizeflag & SUFFIX_ALWAYS)))
	    break;
	  if ((rex & REX_W) || (sizeflag & DFLAG))
	    *obufp++ = 'l';
	  else
	    *obufp++ = 'w';
	  if (!(rex & REX_W))
	    used_prefixes |= (prefixes & PREFIX_DATA);
	  break;
	case 'H':
	  if (intel_syntax)
	    break;
	  if ((prefixes & (PREFIX_CS | PREFIX_DS)) == PREFIX_CS
	      || (prefixes & (PREFIX_CS | PREFIX_DS)) == PREFIX_DS)
	    {
	      used_prefixes |= prefixes & (PREFIX_CS | PREFIX_DS);
	      *obufp++ = ',';
	      *obufp++ = 'p';
	      if (prefixes & PREFIX_DS)
		*obufp++ = 't';
	      else
		*obufp++ = 'n';
	    }
	  break;
	case 'J':
	  if (intel_syntax)
	    break;
	  *obufp++ = 'l';
	  break;
	case 'K':
	  USED_REX (REX_W);
	  if (rex & REX_W)
	    *obufp++ = 'q';
	  else
	    *obufp++ = 'd';
	  break;
	case 'Z':
	  if (intel_syntax)
	    break;
	  if (address_mode == mode_64bit && (sizeflag & SUFFIX_ALWAYS))
	    {
	      *obufp++ = 'q';
	      break;
	    }
	  /* Fall through.  */
	  goto case_L;
	case 'L':
	  if (l != 0 || len != 1)
	    {
	      SAVE_LAST (*p);
	      break;
	    }
case_L:
	  if (intel_syntax)
	    break;
	  if (sizeflag & SUFFIX_ALWAYS)
	    *obufp++ = 'l';
	  break;
	case 'M':
	  if (intel_mnemonic != cond)
	    *obufp++ = 'r';
	  break;
	case 'N':
	  if ((prefixes & PREFIX_FWAIT) == 0)
	    *obufp++ = 'n';
	  else
	    used_prefixes |= PREFIX_FWAIT;
	  break;
	case 'O':
	  USED_REX (REX_W);
	  if (rex & REX_W)
	    *obufp++ = 'o';
	  else if (intel_syntax && (sizeflag & DFLAG))
	    *obufp++ = 'q';
	  else
	    *obufp++ = 'd';
	  if (!(rex & REX_W))
	    used_prefixes |= (prefixes & PREFIX_DATA);
	  break;
	case 'T':
	  if (!intel_syntax
	      && address_mode == mode_64bit
	      && ((sizeflag & DFLAG) || (rex & REX_W)))
	    {
	      *obufp++ = 'q';
	      break;
	    }
	  /* Fall through.  */
	case 'P':
	  if (intel_syntax)
	    {
	      if ((rex & REX_W) == 0
		  && (prefixes & PREFIX_DATA))
		{
		  if ((sizeflag & DFLAG) == 0)
		    *obufp++ = 'w';
		   used_prefixes |= (prefixes & PREFIX_DATA);
		}
	      break;
	    }
	  if ((prefixes & PREFIX_DATA)
	      || (rex & REX_W)
	      || (sizeflag & SUFFIX_ALWAYS))
	    {
	      USED_REX (REX_W);
	      if (rex & REX_W)
		*obufp++ = 'q';
	      else
		{
		   if (sizeflag & DFLAG)
		      *obufp++ = 'l';
		   else
		     *obufp++ = 'w';
		   used_prefixes |= (prefixes & PREFIX_DATA);
		}
	    }
	  break;
	case 'U':
	  if (intel_syntax)
	    break;
	  if (address_mode == mode_64bit
	      && ((sizeflag & DFLAG) || (rex & REX_W)))
	    {
	      if (modrm.mod != 3 || (sizeflag & SUFFIX_ALWAYS))
		*obufp++ = 'q';
	      break;
	    }
	  /* Fall through.  */
	  goto case_Q;
	case 'Q':
	  if (l == 0 && len == 1)
	    {
case_Q:
	      if (intel_syntax && !alt)
		break;
	      USED_REX (REX_W);
	      if (modrm.mod != 3 || (sizeflag & SUFFIX_ALWAYS))
		{
		  if (rex & REX_W)
		    *obufp++ = 'q';
		  else
		    {
		      if (sizeflag & DFLAG)
			*obufp++ = intel_syntax ? 'd' : 'l';
		      else
			*obufp++ = 'w';
		      used_prefixes |= (prefixes & PREFIX_DATA);
		    }
		}
	    }
	  else
	    {
	      if (l != 1 || len != 2 || last[0] != 'L')
		{
		  SAVE_LAST (*p);
		  break;
		}
	      if (intel_syntax
		  || (modrm.mod == 3 && !(sizeflag & SUFFIX_ALWAYS)))
		break;
	      if ((rex & REX_W))
		{
		  USED_REX (REX_W);
		  *obufp++ = 'q';
		}
	      else
		*obufp++ = 'l';
	    }
	  break;
	case 'R':
	  USED_REX (REX_W);
	  if (rex & REX_W)
	    *obufp++ = 'q';
	  else if (sizeflag & DFLAG)
	    {
	      if (intel_syntax)
		  *obufp++ = 'd';
	      else
		  *obufp++ = 'l';
	    }
	  else
	    *obufp++ = 'w';
	  if (intel_syntax && !p[1]
	      && ((rex & REX_W) || (sizeflag & DFLAG)))
	    *obufp++ = 'e';
	  if (!(rex & REX_W))
	    used_prefixes |= (prefixes & PREFIX_DATA);
	  break;
	case 'V':
	  if (l == 0 && len == 1)
	    {
	      if (intel_syntax)
		break;
	      if (address_mode == mode_64bit
		  && ((sizeflag & DFLAG) || (rex & REX_W)))
		{
		  if (sizeflag & SUFFIX_ALWAYS)
		    *obufp++ = 'q';
		  break;
		}
	    }
	  else
	    {
	      if (l != 1
		  || len != 2
		  || last[0] != 'L')
		{
		  SAVE_LAST (*p);
		  break;
		}

	      if (rex & REX_W)
		{
		  *obufp++ = 'a';
		  *obufp++ = 'b';
		  *obufp++ = 's';
		}
	    }
	  /* Fall through.  */
	  goto case_S;
	case 'S':
	  if (l == 0 && len == 1)
	    {
case_S:
	      if (intel_syntax)
		break;
	      if (sizeflag & SUFFIX_ALWAYS)
		{
		  if (rex & REX_W)
		    *obufp++ = 'q';
		  else
		    {
		      if (sizeflag & DFLAG)
			*obufp++ = 'l';
		      else
			*obufp++ = 'w';
		      used_prefixes |= (prefixes & PREFIX_DATA);
		    }
		}
	    }
	  else
	    {
	      if (l != 1
		  || len != 2
		  || last[0] != 'L')
		{
		  SAVE_LAST (*p);
		  break;
		}

	      if (address_mode == mode_64bit
		  && !(prefixes & PREFIX_ADDR))
		{
		  *obufp++ = 'a';
		  *obufp++ = 'b';
		  *obufp++ = 's';
		}

	      goto case_S;
	    }
	  break;
	case 'X':
	  if (l != 0 || len != 1)
	    {
	      SAVE_LAST (*p);
	      break;
	    }
	  if (need_vex && vex.prefix)
	    {
	      if (vex.prefix == DATA_PREFIX_OPCODE)
		*obufp++ = 'd';
	      else
		*obufp++ = 's';
	    }
	  else
	    {
	      if (prefixes & PREFIX_DATA)
		*obufp++ = 'd';
	      else
		*obufp++ = 's';
	      used_prefixes |= (prefixes & PREFIX_DATA);
	    }
	  break;
	case 'Y':
	  if (l == 0 && len == 1)
	    {
	      if (intel_syntax || !(sizeflag & SUFFIX_ALWAYS))
		break;
	      if (rex & REX_W)
		{
		  USED_REX (REX_W);
		  *obufp++ = 'q';
		}
	      break;
	    }
	  else
	    {
	      if (l != 1 || len != 2 || last[0] != 'X')
		{
		  SAVE_LAST (*p);
		  break;
		}
	      if (!need_vex)
		abort ();
	      if (intel_syntax
		  || (modrm.mod == 3 && !(sizeflag & SUFFIX_ALWAYS)))
		break;
	      switch (vex.length)
		{
		case 128:
		  *obufp++ = 'x';
		  break;
		case 256:
		  *obufp++ = 'y';
		  break;
		default:
		  abort ();
		}
	    }
	  break;
	case 'W':
	  if (l == 0 && len == 1)
	    {
	      /* operand size flag for cwtl, cbtw */
	      USED_REX (REX_W);
	      if (rex & REX_W)
		{
		  if (intel_syntax)
		    *obufp++ = 'd';
		  else
		    *obufp++ = 'l';
		}
	      else if (sizeflag & DFLAG)
		*obufp++ = 'w';
	      else
		*obufp++ = 'b';
	      if (!(rex & REX_W))
		used_prefixes |= (prefixes & PREFIX_DATA);
	    }
	  else
	    {
	      if (l != 1
		  || len != 2
		  || (last[0] != 'X'
		      && last[0] != 'L'))
		{
		  SAVE_LAST (*p);
		  break;
		}
	      if (!need_vex)
		abort ();
	      if (last[0] == 'X')
		*obufp++ = vex.w ? 'd': 's';
	      else
		*obufp++ = vex.w ? 'q': 'd';
	    }
	  break;
	}
      alt = 0;
    }
  *obufp = 0;
  mnemonicendp = obufp;
  return 0;
}

static void
oappend (const char *s)
{
  obufp = stpcpy (obufp, s);
}

static void
append_seg (void)
{
  if (prefixes & PREFIX_CS)
    {
      used_prefixes |= PREFIX_CS;
      oappend_maybe_intel ("%cs:");
    }
  if (prefixes & PREFIX_DS)
    {
      used_prefixes |= PREFIX_DS;
      oappend_maybe_intel ("%ds:");
    }
  if (prefixes & PREFIX_SS)
    {
      used_prefixes |= PREFIX_SS;
      oappend_maybe_intel ("%ss:");
    }
  if (prefixes & PREFIX_ES)
    {
      used_prefixes |= PREFIX_ES;
      oappend_maybe_intel ("%es:");
    }
  if (prefixes & PREFIX_FS)
    {
      used_prefixes |= PREFIX_FS;
      oappend_maybe_intel ("%fs:");
    }
  if (prefixes & PREFIX_GS)
    {
      used_prefixes |= PREFIX_GS;
      oappend_maybe_intel ("%gs:");
    }
}

static void
OP_indirE (int bytemode, int sizeflag)
{
  if (!intel_syntax)
    oappend ("*");
  OP_E (bytemode, sizeflag);
}

static void
print_operand_value (char *buf, int hex, bfd_vma disp)
{
  if (address_mode == mode_64bit)
    {
      if (hex)
	{
	  char tmp[30];
	  int i;
	  buf[0] = '0';
	  buf[1] = 'x';
	  sprintf_vma (tmp, disp);
	  for (i = 0; tmp[i] == '0' && tmp[i + 1]; i++);
	  strcpy (buf + 2, tmp + i);
	}
      else
	{
	  bfd_signed_vma v = disp;
	  char tmp[30];
	  int i;
	  if (v < 0)
	    {
	      *(buf++) = '-';
	      v = -disp;
	      /* Check for possible overflow on 0x8000000000000000.  */
	      if (v < 0)
		{
		  strcpy (buf, "9223372036854775808");
		  return;
		}
	    }
	  if (!v)
	    {
	      strcpy (buf, "0");
	      return;
	    }

	  i = 0;
	  tmp[29] = 0;
	  while (v)
	    {
	      tmp[28 - i] = (v % 10) + '0';
	      v /= 10;
	      i++;
	    }
	  strcpy (buf, tmp + 29 - i);
	}
    }
  else
    {
      if (hex)
	sprintf (buf, "0x%x", (unsigned int) disp);
      else
	sprintf (buf, "%d", (int) disp);
    }
}

/* Put DISP in BUF as signed hex number.  */

static void
print_displacement (char *buf, bfd_vma disp)
{
  bfd_signed_vma val = disp;
  char tmp[30];
  int i, j = 0;

  if (val < 0)
    {
      buf[j++] = '-';
      val = -disp;

      /* Check for possible overflow.  */
      if (val < 0)
	{
	  switch (address_mode)
	    {
	    case mode_64bit:
	      strcpy (buf + j, "0x8000000000000000");
	      break;
	    case mode_32bit:
	      strcpy (buf + j, "0x80000000");
	      break;
	    case mode_16bit:
	      strcpy (buf + j, "0x8000");
	      break;
	    }
	  return;
	}
    }

  buf[j++] = '0';
  buf[j++] = 'x';

  sprintf_vma (tmp, (bfd_vma) val);
  for (i = 0; tmp[i] == '0'; i++)
    continue;
  if (tmp[i] == '\0')
    i--;
  strcpy (buf + j, tmp + i);
}

static void
intel_operand_size (int bytemode, int sizeflag)
{
  if (vex.evex
      && vex.b
      && (bytemode == x_mode
	  || bytemode == evex_half_bcst_xmmq_mode))
    {
      if (vex.w)
	oappend ("QWORD PTR ");
      else
	oappend ("DWORD PTR ");
      return;
    }
  switch (bytemode)
    {
    case b_mode:
    case b_swap_mode:
    case dqb_mode:
      oappend ("BYTE PTR ");
      break;
    case w_mode:
    case dqw_mode:
      oappend ("WORD PTR ");
      break;
    case stack_v_mode:
      if (address_mode == mode_64bit && ((sizeflag & DFLAG) || (rex & REX_W)))
	{
	  oappend ("QWORD PTR ");
	  break;
	}
      /* FALLTHRU */
    case v_mode:
    case v_swap_mode:
    case dq_mode:
      USED_REX (REX_W);
      if (rex & REX_W)
	oappend ("QWORD PTR ");
      else
	{
	  if ((sizeflag & DFLAG) || bytemode == dq_mode)
	    oappend ("DWORD PTR ");
	  else
	    oappend ("WORD PTR ");
	  used_prefixes |= (prefixes & PREFIX_DATA);
	}
      break;
    case z_mode:
      if ((rex & REX_W) || (sizeflag & DFLAG))
	*obufp++ = 'D';
      oappend ("WORD PTR ");
      if (!(rex & REX_W))
	used_prefixes |= (prefixes & PREFIX_DATA);
      break;
    case a_mode:
      if (sizeflag & DFLAG)
	oappend ("QWORD PTR ");
      else
	oappend ("DWORD PTR ");
      used_prefixes |= (prefixes & PREFIX_DATA);
      break;
    case d_mode:
    case d_scalar_mode:
    case d_scalar_swap_mode:
    case d_swap_mode:
    case dqd_mode:
      oappend ("DWORD PTR ");
      break;
    case q_mode:
    case q_scalar_mode:
    case q_scalar_swap_mode:
    case q_swap_mode:
      oappend ("QWORD PTR ");
      break;
    case m_mode:
      if (address_mode == mode_64bit)
	oappend ("QWORD PTR ");
      else
	oappend ("DWORD PTR ");
      break;
    case f_mode:
      if (sizeflag & DFLAG)
	oappend ("FWORD PTR ");
      else
	oappend ("DWORD PTR ");
      used_prefixes |= (prefixes & PREFIX_DATA);
      break;
    case t_mode:
      oappend ("TBYTE PTR ");
      break;
    case x_mode:
    case x_swap_mode:
    case evex_x_gscat_mode:
    case evex_x_nobcst_mode:
      if (need_vex)
	{
	  switch (vex.length)
	    {
	    case 128:
	      oappend ("XMMWORD PTR ");
	      break;
	    case 256:
	      oappend ("YMMWORD PTR ");
	      break;
	    case 512:
	      oappend ("ZMMWORD PTR ");
	      break;
	    default:
	      abort ();
	    }
	}
      else
	oappend ("XMMWORD PTR ");
      break;
    case xmm_mode:
      oappend ("XMMWORD PTR ");
      break;
    case ymm_mode:
      oappend ("YMMWORD PTR ");
      break;
    case xmmq_mode:
    case evex_half_bcst_xmmq_mode:
      if (!need_vex)
	abort ();

      switch (vex.length)
	{
	case 128:
	  oappend ("QWORD PTR ");
	  break;
	case 256:
	  oappend ("XMMWORD PTR ");
	  break;
	case 512:
	  oappend ("YMMWORD PTR ");
	  break;
	default:
	  abort ();
	}
      break;
    case xmm_mb_mode:
      if (!need_vex)
	abort ();

      switch (vex.length)
	{
	case 128:
	case 256:
	case 512:
	  oappend ("BYTE PTR ");
	  break;
	default:
	  abort ();
	}
      break;
    case xmm_mw_mode:
      if (!need_vex)
	abort ();

      switch (vex.length)
	{
	case 128:
	case 256:
	case 512:
	  oappend ("WORD PTR ");
	  break;
	default:
	  abort ();
	}
      break;
    case xmm_md_mode:
      if (!need_vex)
	abort ();

      switch (vex.length)
	{
	case 128:
	case 256:
	case 512:
	  oappend ("DWORD PTR ");
	  break;
	default:
	  abort ();
	}
      break;
    case xmm_mq_mode:
      if (!need_vex)
	abort ();

      switch (vex.length)
	{
	case 128:
	case 256:
	case 512:
	  oappend ("QWORD PTR ");
	  break;
	default:
	  abort ();
	}
      break;
    case xmmdw_mode:
      if (!need_vex)
	abort ();

      switch (vex.length)
	{
	case 128:
	  oappend ("WORD PTR ");
	  break;
	case 256:
	  oappend ("DWORD PTR ");
	  break;
	case 512:
	  oappend ("QWORD PTR ");
	  break;
	default:
	  abort ();
	}
      break;
    case xmmqd_mode:
      if (!need_vex)
	abort ();

      switch (vex.length)
	{
	case 128:
	  oappend ("DWORD PTR ");
	  break;
	case 256:
	  oappend ("QWORD PTR ");
	  break;
	case 512:
	  oappend ("XMMWORD PTR ");
	  break;
	default:
	  abort ();
	}
      break;
    case ymmq_mode:
      if (!need_vex)
	abort ();

      switch (vex.length)
	{
	case 128:
	  oappend ("QWORD PTR ");
	  break;
	case 256:
	  oappend ("YMMWORD PTR ");
	  break;
	case 512:
	  oappend ("ZMMWORD PTR ");
	  break;
	default:
	  abort ();
	}
      break;
    case ymmxmm_mode:
      if (!need_vex)
	abort ();

      switch (vex.length)
	{
	case 128:
	case 256:
	  oappend ("XMMWORD PTR ");
	  break;
	default:
	  abort ();
	}
      break;
    case o_mode:
      oappend ("OWORD PTR ");
      break;
    case xmm_mdq_mode:
    case vex_w_dq_mode:
    case vex_scalar_w_dq_mode:
      if (!need_vex)
	abort ();

      if (vex.w)
	oappend ("QWORD PTR ");
      else
	oappend ("DWORD PTR ");
      break;
    case vex_vsib_d_w_dq_mode:
    case vex_vsib_q_w_dq_mode:
      if (!need_vex)
	abort ();

      if (!vex.evex)
	{
	  if (vex.w)
	    oappend ("QWORD PTR ");
	  else
	    oappend ("DWORD PTR ");
	}
      else
	{
	  if (vex.length != 512)
	    abort ();
	  oappend ("ZMMWORD PTR ");
	}
      break;
    case mask_mode:
      if (!need_vex)
	abort ();
      /* Currently the only instructions, which allows either mask or
	 memory operand, are AVX512's KMOVW instructions.  They need
	 Word-sized operand.  */
      if (vex.w || vex.length != 128)
	abort ();
      oappend ("WORD PTR ");
      break;
    case v_bnd_mode:
    default:
      break;
    }
}

static void
OP_E_register (int bytemode, int sizeflag)
{
  int reg = modrm.rm;
  const char **names;

  USED_REX (REX_B);
  if ((rex & REX_B))
    reg += 8;

  if ((sizeflag & SUFFIX_ALWAYS)
      && (bytemode == b_swap_mode || bytemode == v_swap_mode))
    swap_operand ();

  switch (bytemode)
    {
    case b_mode:
    case b_swap_mode:
      USED_REX (0);
      if (rex)
	names = names8rex;
      else
	names = names8;
      break;
    case w_mode:
      names = names16;
      break;
    case d_mode:
      names = names32;
      break;
    case q_mode:
      names = names64;
      break;
    case m_mode:
    case v_bnd_mode:
      names = address_mode == mode_64bit ? names64 : names32;
      break;
    case bnd_mode:
      names = names_bnd;
      break;
    case stack_v_mode:
      if (address_mode == mode_64bit && ((sizeflag & DFLAG) || (rex & REX_W)))
	{
	  names = names64;
	  break;
	}
      bytemode = v_mode;
      /* FALLTHRU */
    case v_mode:
    case v_swap_mode:
    case dq_mode:
    case dqb_mode:
    case dqd_mode:
    case dqw_mode:
      USED_REX (REX_W);
      if (rex & REX_W)
	names = names64;
      else
	{
	  if ((sizeflag & DFLAG)
	      || (bytemode != v_mode
		  && bytemode != v_swap_mode))
	    names = names32;
	  else
	    names = names16;
	  used_prefixes |= (prefixes & PREFIX_DATA);
	}
      break;
    case mask_mode:
      names = names_mask;
      break;
    case 0:
      return;
    default:
      oappend (INTERNAL_DISASSEMBLER_ERROR);
      return;
    }
  oappend (names[reg]);
}

static void
OP_E_memory (int bytemode, int sizeflag)
{
  bfd_vma disp = 0;
  int add = (rex & REX_B) ? 8 : 0;
  int riprel = 0;
  int shift;

  if (vex.evex)
    {
      /* In EVEX, if operand doesn't allow broadcast, vex.b should be 0.  */
      if (vex.b
	  && bytemode != x_mode
	  && bytemode != evex_half_bcst_xmmq_mode)
	{
	  BadOp ();
	  return;
	}
      switch (bytemode)
	{
	case vex_vsib_d_w_dq_mode:
	case evex_x_gscat_mode:
	case xmm_mdq_mode:
	  shift = vex.w ? 3 : 2;
	  break;
	case vex_vsib_q_w_dq_mode:
	  shift = 3;
	  break;
	case x_mode:
	case evex_half_bcst_xmmq_mode:
	  if (vex.b)
	    {
	      shift = vex.w ? 3 : 2;
	      break;
	    }
	  /* Fall through if vex.b == 0.  */
	case xmmqd_mode:
	case xmmdw_mode:
	case xmmq_mode:
	case ymmq_mode:
	case evex_x_nobcst_mode:
	case x_swap_mode:
	  switch (vex.length)
	    {
	    case 128:
	      shift = 4;
	      break;
	    case 256:
	      shift = 5;
	      break;
	    case 512:
	      shift = 6;
	      break;
	    default:
	      abort ();
	    }
	  break;
	case ymm_mode:
	  shift = 5;
	  break;
	case xmm_mode:
	  shift = 4;
	  break;
	case xmm_mq_mode:
	case q_mode:
	case q_scalar_mode:
	case q_swap_mode:
	case q_scalar_swap_mode:
	  shift = 3;
	  break;
	case dqd_mode:
	case xmm_md_mode:
	case d_mode:
	case d_scalar_mode:
	case d_swap_mode:
	case d_scalar_swap_mode:
	  shift = 2;
	  break;
	case xmm_mw_mode:
	  shift = 1;
	  break;
	case xmm_mb_mode:
	  shift = 0;
	  break;
	default:
	  abort ();
	}
      /* Make necessary corrections to shift for modes that need it.
	 For these modes we currently have shift 4, 5 or 6 depending on
	 vex.length (it corresponds to xmmword, ymmword or zmmword
	 operand).  We might want to make it 3, 4 or 5 (e.g. for
	 xmmq_mode).  In case of broadcast enabled the corrections
	 aren't needed, as element size is always 32 or 64 bits.  */
      if (bytemode == xmmq_mode
	  || (bytemode == evex_half_bcst_xmmq_mode
	      && !vex.b))
	shift -= 1;
      else if (bytemode == xmmqd_mode)
	shift -= 2;
      else if (bytemode == xmmdw_mode)
	shift -= 3;
    }
  else
    shift = 0;

  USED_REX (REX_B);
  if (intel_syntax)
    intel_operand_size (bytemode, sizeflag);
  append_seg ();

  if ((sizeflag & AFLAG) || address_mode == mode_64bit)
    {
      /* 32/64 bit address mode */
      int havedisp;
      int havesib;
      int havebase;
      int haveindex;
      int needindex;
      int base, rbase;
      int vindex = 0;
      int scale = 0;
      int addr32flag = !((sizeflag & AFLAG)
			 || bytemode == v_bnd_mode
			 || bytemode == bnd_mode);
      const char **indexes64 = names64;
      const char **indexes32 = names32;

      havesib = 0;
      havebase = 1;
      haveindex = 0;
      base = modrm.rm;

      if (base == 4)
	{
	  havesib = 1;
	  vindex = sib.index;
	  USED_REX (REX_X);
	  if (rex & REX_X)
	    vindex += 8;
	  switch (bytemode)
	    {
	    case vex_vsib_d_w_dq_mode:
	    case vex_vsib_q_w_dq_mode:
	      if (!need_vex)
		abort ();
	      if (vex.evex)
		{
		  if (!vex.v)
		    vindex += 16;
		}

	      haveindex = 1;
	      switch (vex.length)
		{
		case 128:
		  indexes64 = indexes32 = names_xmm;
		  break;
		case 256:
		  if (!vex.w || bytemode == vex_vsib_q_w_dq_mode)
		    indexes64 = indexes32 = names_ymm;
		  else
		    indexes64 = indexes32 = names_xmm;
		  break;
		case 512:
		  if (!vex.w || bytemode == vex_vsib_q_w_dq_mode)
		    indexes64 = indexes32 = names_zmm;
		  else
		    indexes64 = indexes32 = names_ymm;
		  break;
		default:
		  abort ();
		}
	      break;
	    default:
	      haveindex = vindex != 4;
	      break;
	    }
	  scale = sib.scale;
	  base = sib.base;
	  codep++;
	}
      rbase = base + add;

      switch (modrm.mod)
	{
	case 0:
	  if (base == 5)
	    {
	      havebase = 0;
	      if (address_mode == mode_64bit && !havesib)
		riprel = 1;
	      disp = get32s ();
	    }
	  break;
	case 1:
	  FETCH_DATA (the_info, codep + 1);
	  disp = *codep++;
	  if ((disp & 0x80) != 0)
	    disp -= 0x100;
	  if (vex.evex && shift > 0)
	    disp <<= shift;
	  break;
	case 2:
	  disp = get32s ();
	  break;
	}

      /* In 32bit mode, we need index register to tell [offset] from
	 [eiz*1 + offset].  */
      needindex = (havesib
		   && !havebase
		   && !haveindex
		   && address_mode == mode_32bit);
      havedisp = (havebase
		  || needindex
		  || (havesib && (haveindex || scale != 0)));

      if (!intel_syntax)
	if (modrm.mod != 0 || base == 5)
	  {
	    if (havedisp || riprel)
	      print_displacement (scratchbuf, disp);
	    else
	      print_operand_value (scratchbuf, 1, disp);
	    oappend (scratchbuf);
	    if (riprel)
	      {
		set_op (disp, 1);
		oappend (sizeflag & AFLAG ? "(%rip)" : "(%eip)");
	      }
	  }

      if ((havebase || haveindex || riprel)
	  && (bytemode != v_bnd_mode)
	  && (bytemode != bnd_mode))
	used_prefixes |= PREFIX_ADDR;

      if (havedisp || (intel_syntax && riprel))
	{
	  *obufp++ = open_char;
	  if (intel_syntax && riprel)
	    {
	      set_op (disp, 1);
	      oappend (sizeflag & AFLAG ? "rip" : "eip");
	    }
	  *obufp = '\0';
	  if (havebase)
	    oappend (address_mode == mode_64bit && !addr32flag
		     ? names64[rbase] : names32[rbase]);
	  if (havesib)
	    {
	      /* ESP/RSP won't allow index.  If base isn't ESP/RSP,
		 print index to tell base + index from base.  */
	      if (scale != 0
		  || needindex
		  || haveindex
		  || (havebase && base != ESP_REG_NUM))
		{
		  if (!intel_syntax || havebase)
		    {
		      *obufp++ = separator_char;
		      *obufp = '\0';
		    }
		  if (haveindex)
		    oappend (address_mode == mode_64bit && !addr32flag
			     ? indexes64[vindex] : indexes32[vindex]);
		  else
		    oappend (address_mode == mode_64bit && !addr32flag
			     ? index64 : index32);

		  *obufp++ = scale_char;
		  *obufp = '\0';
		  sprintf (scratchbuf, "%d", 1 << scale);
		  oappend (scratchbuf);
		}
	    }
	  if (intel_syntax
	      && (disp || modrm.mod != 0 || base == 5))
	    {
	      if (!havedisp || (bfd_signed_vma) disp >= 0)
		{
		  *obufp++ = '+';
		  *obufp = '\0';
		}
	      else if (modrm.mod != 1 && disp != -disp)
		{
		  *obufp++ = '-';
		  *obufp = '\0';
		  disp = - (bfd_signed_vma) disp;
		}

	      if (havedisp)
		print_displacement (scratchbuf, disp);
	      else
		print_operand_value (scratchbuf, 1, disp);
	      oappend (scratchbuf);
	    }

	  *obufp++ = close_char;
	  *obufp = '\0';
	}
      else if (intel_syntax)
	{
	  if (modrm.mod != 0 || base == 5)
	    {
	      if (prefixes & (PREFIX_CS | PREFIX_SS | PREFIX_DS
			      | PREFIX_ES | PREFIX_FS | PREFIX_GS))
		;
	      else
		{
		  oappend (names_seg[ds_reg - es_reg]);
		  oappend (":");
		}
	      print_operand_value (scratchbuf, 1, disp);
	      oappend (scratchbuf);
	    }
	}
    }
  else
    {
      /* 16 bit address mode */
      used_prefixes |= prefixes & PREFIX_ADDR;
      switch (modrm.mod)
	{
	case 0:
	  if (modrm.rm == 6)
	    {
	      disp = get16 ();
	      if ((disp & 0x8000) != 0)
		disp -= 0x10000;
	    }
	  break;
	case 1:
	  FETCH_DATA (the_info, codep + 1);
	  disp = *codep++;
	  if ((disp & 0x80) != 0)
	    disp -= 0x100;
	  break;
	case 2:
	  disp = get16 ();
	  if ((disp & 0x8000) != 0)
	    disp -= 0x10000;
	  break;
	}

      if (!intel_syntax)
	if (modrm.mod != 0 || modrm.rm == 6)
	  {
	    print_displacement (scratchbuf, disp);
	    oappend (scratchbuf);
	  }

      if (modrm.mod != 0 || modrm.rm != 6)
	{
	  *obufp++ = open_char;
	  *obufp = '\0';
	  oappend (index16[modrm.rm]);
	  if (intel_syntax
	      && (disp || modrm.mod != 0 || modrm.rm == 6))
	    {
	      if ((bfd_signed_vma) disp >= 0)
		{
		  *obufp++ = '+';
		  *obufp = '\0';
		}
	      else if (modrm.mod != 1)
		{
		  *obufp++ = '-';
		  *obufp = '\0';
		  disp = - (bfd_signed_vma) disp;
		}

	      print_displacement (scratchbuf, disp);
	      oappend (scratchbuf);
	    }

	  *obufp++ = close_char;
	  *obufp = '\0';
	}
      else if (intel_syntax)
	{
	  if (prefixes & (PREFIX_CS | PREFIX_SS | PREFIX_DS
			  | PREFIX_ES | PREFIX_FS | PREFIX_GS))
	    ;
	  else
	    {
	      oappend (names_seg[ds_reg - es_reg]);
	      oappend (":");
	    }
	  print_operand_value (scratchbuf, 1, disp & 0xffff);
	  oappend (scratchbuf);
	}
    }
  if (vex.evex && vex.b
      && (bytemode == x_mode
	  || bytemode == evex_half_bcst_xmmq_mode))
    {
      if (vex.w || bytemode == evex_half_bcst_xmmq_mode)
	oappend ("{1to8}");
      else
	oappend ("{1to16}");
    }
}

static void
OP_E (int bytemode, int sizeflag)
{
  /* Skip mod/rm byte.  */
  MODRM_CHECK;
  codep++;

  if (modrm.mod == 3)
    OP_E_register (bytemode, sizeflag);
  else
    OP_E_memory (bytemode, sizeflag);
}

static void
OP_G (int bytemode, int sizeflag)
{
  int add = 0;
  USED_REX (REX_R);
  if (rex & REX_R)
    add += 8;
  switch (bytemode)
    {
    case b_mode:
      USED_REX (0);
      if (rex)
	oappend (names8rex[modrm.reg + add]);
      else
	oappend (names8[modrm.reg + add]);
      break;
    case w_mode:
      oappend (names16[modrm.reg + add]);
      break;
    case d_mode:
      oappend (names32[modrm.reg + add]);
      break;
    case q_mode:
      oappend (names64[modrm.reg + add]);
      break;
    case bnd_mode:
      oappend (names_bnd[modrm.reg]);
      break;
    case v_mode:
    case dq_mode:
    case dqb_mode:
    case dqd_mode:
    case dqw_mode:
      USED_REX (REX_W);
      if (rex & REX_W)
	oappend (names64[modrm.reg + add]);
      else
	{
	  if ((sizeflag & DFLAG) || bytemode != v_mode)
	    oappend (names32[modrm.reg + add]);
	  else
	    oappend (names16[modrm.reg + add]);
	  used_prefixes |= (prefixes & PREFIX_DATA);
	}
      break;
    case m_mode:
      if (address_mode == mode_64bit)
	oappend (names64[modrm.reg + add]);
      else
	oappend (names32[modrm.reg + add]);
      break;
    case mask_mode:
      oappend (names_mask[modrm.reg + add]);
      break;
    default:
      oappend (INTERNAL_DISASSEMBLER_ERROR);
      break;
    }
}

static bfd_vma
get64 (void)
{
  bfd_vma x;
#ifdef BFD64
  unsigned int a;
  unsigned int b;

  FETCH_DATA (the_info, codep + 8);
  a = *codep++ & 0xff;
  a |= (*codep++ & 0xff) << 8;
  a |= (*codep++ & 0xff) << 16;
  a |= (*codep++ & 0xff) << 24;
  b = *codep++ & 0xff;
  b |= (*codep++ & 0xff) << 8;
  b |= (*codep++ & 0xff) << 16;
  b |= (*codep++ & 0xff) << 24;
  x = a + ((bfd_vma) b << 32);
#else
  abort ();
  x = 0;
#endif
  return x;
}

static bfd_signed_vma
get32 (void)
{
  bfd_signed_vma x = 0;

  FETCH_DATA (the_info, codep + 4);
  x = *codep++ & (bfd_signed_vma) 0xff;
  x |= (*codep++ & (bfd_signed_vma) 0xff) << 8;
  x |= (*codep++ & (bfd_signed_vma) 0xff) << 16;
  x |= (*codep++ & (bfd_signed_vma) 0xff) << 24;
  return x;
}

static bfd_signed_vma
get32s (void)
{
  bfd_signed_vma x = 0;

  FETCH_DATA (the_info, codep + 4);
  x = *codep++ & (bfd_signed_vma) 0xff;
  x |= (*codep++ & (bfd_signed_vma) 0xff) << 8;
  x |= (*codep++ & (bfd_signed_vma) 0xff) << 16;
  x |= (*codep++ & (bfd_signed_vma) 0xff) << 24;

  x = (x ^ ((bfd_signed_vma) 1 << 31)) - ((bfd_signed_vma) 1 << 31);

  return x;
}

static int
get16 (void)
{
  int x = 0;

  FETCH_DATA (the_info, codep + 2);
  x = *codep++ & 0xff;
  x |= (*codep++ & 0xff) << 8;
  return x;
}

static void
set_op (bfd_vma op, int riprel)
{
  op_index[op_ad] = op_ad;
  if (address_mode == mode_64bit)
    {
      op_address[op_ad] = op;
      op_riprel[op_ad] = riprel;
    }
  else
    {
      /* Mask to get a 32-bit address.  */
      op_address[op_ad] = op & 0xffffffff;
      op_riprel[op_ad] = riprel & 0xffffffff;
    }
}

static void
OP_REG (int code, int sizeflag)
{
  const char *s;
  int add;

  switch (code)
    {
    case es_reg: case ss_reg: case cs_reg:
    case ds_reg: case fs_reg: case gs_reg:
      oappend (names_seg[code - es_reg]);
      return;
    }

  USED_REX (REX_B);
  if (rex & REX_B)
    add = 8;
  else
    add = 0;

  switch (code)
    {
    case ax_reg: case cx_reg: case dx_reg: case bx_reg:
    case sp_reg: case bp_reg: case si_reg: case di_reg:
      s = names16[code - ax_reg + add];
      break;
    case al_reg: case ah_reg: case cl_reg: case ch_reg:
    case dl_reg: case dh_reg: case bl_reg: case bh_reg:
      USED_REX (0);
      if (rex)
	s = names8rex[code - al_reg + add];
      else
	s = names8[code - al_reg];
      break;
    case rAX_reg: case rCX_reg: case rDX_reg: case rBX_reg:
    case rSP_reg: case rBP_reg: case rSI_reg: case rDI_reg:
      if (address_mode == mode_64bit
	  && ((sizeflag & DFLAG) || (rex & REX_W)))
	{
	  s = names64[code - rAX_reg + add];
	  break;
	}
      code += eAX_reg - rAX_reg;
      /* Fall through.  */
    case eAX_reg: case eCX_reg: case eDX_reg: case eBX_reg:
    case eSP_reg: case eBP_reg: case eSI_reg: case eDI_reg:
      USED_REX (REX_W);
      if (rex & REX_W)
	s = names64[code - eAX_reg + add];
      else
	{
	  if (sizeflag & DFLAG)
	    s = names32[code - eAX_reg + add];
	  else
	    s = names16[code - eAX_reg + add];
	  used_prefixes |= (prefixes & PREFIX_DATA);
	}
      break;
    default:
      s = INTERNAL_DISASSEMBLER_ERROR;
      break;
    }
  oappend (s);
}

static void
OP_IMREG (int code, int sizeflag)
{
  const char *s;

  switch (code)
    {
    case indir_dx_reg:
      if (intel_syntax)
	s = "dx";
      else
	s = "(%dx)";
      break;
    case ax_reg: case cx_reg: case dx_reg: case bx_reg:
    case sp_reg: case bp_reg: case si_reg: case di_reg:
      s = names16[code - ax_reg];
      break;
    case es_reg: case ss_reg: case cs_reg:
    case ds_reg: case fs_reg: case gs_reg:
      s = names_seg[code - es_reg];
      break;
    case al_reg: case ah_reg: case cl_reg: case ch_reg:
    case dl_reg: case dh_reg: case bl_reg: case bh_reg:
      USED_REX (0);
      if (rex)
	s = names8rex[code - al_reg];
      else
	s = names8[code - al_reg];
      break;
    case eAX_reg: case eCX_reg: case eDX_reg: case eBX_reg:
    case eSP_reg: case eBP_reg: case eSI_reg: case eDI_reg:
      USED_REX (REX_W);
      if (rex & REX_W)
	s = names64[code - eAX_reg];
      else
	{
	  if (sizeflag & DFLAG)
	    s = names32[code - eAX_reg];
	  else
	    s = names16[code - eAX_reg];
	  used_prefixes |= (prefixes & PREFIX_DATA);
	}
      break;
    case z_mode_ax_reg:
      if ((rex & REX_W) || (sizeflag & DFLAG))
	s = *names32;
      else
	s = *names16;
      if (!(rex & REX_W))
	used_prefixes |= (prefixes & PREFIX_DATA);
      break;
    default:
      s = INTERNAL_DISASSEMBLER_ERROR;
      break;
    }
  oappend (s);
}

static void
OP_I (int bytemode, int sizeflag)
{
  bfd_signed_vma op;
  bfd_signed_vma mask = -1;

  switch (bytemode)
    {
    case b_mode:
      FETCH_DATA (the_info, codep + 1);
      op = *codep++;
      mask = 0xff;
      break;
    case q_mode:
      if (address_mode == mode_64bit)
	{
	  op = get32s ();
	  break;
	}
      /* Fall through.  */
    case v_mode:
      USED_REX (REX_W);
      if (rex & REX_W)
	op = get32s ();
      else
	{
	  if (sizeflag & DFLAG)
	    {
	      op = get32 ();
	      mask = 0xffffffff;
	    }
	  else
	    {
	      op = get16 ();
	      mask = 0xfffff;
	    }
	  used_prefixes |= (prefixes & PREFIX_DATA);
	}
      break;
    case w_mode:
      mask = 0xfffff;
      op = get16 ();
      break;
    case const_1_mode:
      if (intel_syntax)
	oappend ("1");
      return;
    default:
      oappend (INTERNAL_DISASSEMBLER_ERROR);
      return;
    }

  op &= mask;
  scratchbuf[0] = '$';
  print_operand_value (scratchbuf + 1, 1, op);
  oappend_maybe_intel (scratchbuf);
  scratchbuf[0] = '\0';
}

static void
OP_I64 (int bytemode, int sizeflag)
{
  bfd_signed_vma op;
  bfd_signed_vma mask = -1;

  if (address_mode != mode_64bit)
    {
      OP_I (bytemode, sizeflag);
      return;
    }

  switch (bytemode)
    {
    case b_mode:
      FETCH_DATA (the_info, codep + 1);
      op = *codep++;
      mask = 0xff;
      break;
    case v_mode:
      USED_REX (REX_W);
      if (rex & REX_W)
	op = get64 ();
      else
	{
	  if (sizeflag & DFLAG)
	    {
	      op = get32 ();
	      mask = 0xffffffff;
	    }
	  else
	    {
	      op = get16 ();
	      mask = 0xfffff;
	    }
	  used_prefixes |= (prefixes & PREFIX_DATA);
	}
      break;
    case w_mode:
      mask = 0xfffff;
      op = get16 ();
      break;
    default:
      oappend (INTERNAL_DISASSEMBLER_ERROR);
      return;
    }

  op &= mask;
  scratchbuf[0] = '$';
  print_operand_value (scratchbuf + 1, 1, op);
  oappend_maybe_intel (scratchbuf);
  scratchbuf[0] = '\0';
}

static void
OP_sI (int bytemode, int sizeflag)
{
  bfd_signed_vma op;

  switch (bytemode)
    {
    case b_mode:
    case b_T_mode:
      FETCH_DATA (the_info, codep + 1);
      op = *codep++;
      if ((op & 0x80) != 0)
	op -= 0x100;
      if (bytemode == b_T_mode)
	{
	  if (address_mode != mode_64bit
	      || !((sizeflag & DFLAG) || (rex & REX_W)))
	    {
	      /* The operand-size prefix is overridden by a REX prefix.  */
	      if ((sizeflag & DFLAG) || (rex & REX_W))
		op &= 0xffffffff;
	      else
		op &= 0xffff;
	  }
	}
      else
	{
	  if (!(rex & REX_W))
	    {
	      if (sizeflag & DFLAG)
		op &= 0xffffffff;
	      else
		op &= 0xffff;
	    }
	}
      break;
    case v_mode:
      /* The operand-size prefix is overridden by a REX prefix.  */
      if ((sizeflag & DFLAG) || (rex & REX_W))
	op = get32s ();
      else
	op = get16 ();
      break;
    default:
      oappend (INTERNAL_DISASSEMBLER_ERROR);
      return;
    }

  scratchbuf[0] = '$';
  print_operand_value (scratchbuf + 1, 1, op);
  oappend_maybe_intel (scratchbuf);
}

static void
OP_J (int bytemode, int sizeflag)
{
  bfd_vma disp;
  bfd_vma mask = -1;
  bfd_vma segment = 0;

  switch (bytemode)
    {
    case b_mode:
      FETCH_DATA (the_info, codep + 1);
      disp = *codep++;
      if ((disp & 0x80) != 0)
	disp -= 0x100;
      break;
    case v_mode:
      USED_REX (REX_W);
      if ((sizeflag & DFLAG) || (rex & REX_W))
	disp = get32s ();
      else
	{
	  disp = get16 ();
	  if ((disp & 0x8000) != 0)
	    disp -= 0x10000;
	  /* In 16bit mode, address is wrapped around at 64k within
	     the same segment.  Otherwise, a data16 prefix on a jump
	     instruction means that the pc is masked to 16 bits after
	     the displacement is added!  */
	  mask = 0xffff;
	  if ((prefixes & PREFIX_DATA) == 0)
	    segment = ((start_pc + codep - start_codep)
		       & ~((bfd_vma) 0xffff));
	}
      if (!(rex & REX_W))
	used_prefixes |= (prefixes & PREFIX_DATA);
      break;
    default:
      oappend (INTERNAL_DISASSEMBLER_ERROR);
      return;
    }
  disp = ((start_pc + (codep - start_codep) + disp) & mask) | segment;
  set_op (disp, 0);
  print_operand_value (scratchbuf, 1, disp);
  oappend (scratchbuf);
}

static void
OP_SEG (int bytemode, int sizeflag)
{
  if (bytemode == w_mode)
    oappend (names_seg[modrm.reg]);
  else
    OP_E (modrm.mod == 3 ? bytemode : w_mode, sizeflag);
}

static void
OP_DIR (int dummy ATTRIBUTE_UNUSED, int sizeflag)
{
  int seg, offset;

  if (sizeflag & DFLAG)
    {
      offset = get32 ();
      seg = get16 ();
    }
  else
    {
      offset = get16 ();
      seg = get16 ();
    }
  used_prefixes |= (prefixes & PREFIX_DATA);
  if (intel_syntax)
    sprintf (scratchbuf, "0x%x:0x%x", seg, offset);
  else
    sprintf (scratchbuf, "$0x%x,$0x%x", seg, offset);
  oappend (scratchbuf);
}

static void
OP_OFF (int bytemode, int sizeflag)
{
  bfd_vma off;

  if (intel_syntax && (sizeflag & SUFFIX_ALWAYS))
    intel_operand_size (bytemode, sizeflag);
  append_seg ();

  if ((sizeflag & AFLAG) || address_mode == mode_64bit)
    off = get32 ();
  else
    off = get16 ();

  if (intel_syntax)
    {
      if (!(prefixes & (PREFIX_CS | PREFIX_SS | PREFIX_DS
			| PREFIX_ES | PREFIX_FS | PREFIX_GS)))
	{
	  oappend (names_seg[ds_reg - es_reg]);
	  oappend (":");
	}
    }
  print_operand_value (scratchbuf, 1, off);
  oappend (scratchbuf);
}

static void
OP_OFF64 (int bytemode, int sizeflag)
{
  bfd_vma off;

  if (address_mode != mode_64bit
      || (prefixes & PREFIX_ADDR))
    {
      OP_OFF (bytemode, sizeflag);
      return;
    }

  if (intel_syntax && (sizeflag & SUFFIX_ALWAYS))
    intel_operand_size (bytemode, sizeflag);
  append_seg ();

  off = get64 ();

  if (intel_syntax)
    {
      if (!(prefixes & (PREFIX_CS | PREFIX_SS | PREFIX_DS
			| PREFIX_ES | PREFIX_FS | PREFIX_GS)))
	{
	  oappend (names_seg[ds_reg - es_reg]);
	  oappend (":");
	}
    }
  print_operand_value (scratchbuf, 1, off);
  oappend (scratchbuf);
}

static void
ptr_reg (int code, int sizeflag)
{
  const char *s;

  *obufp++ = open_char;
  used_prefixes |= (prefixes & PREFIX_ADDR);
  if (address_mode == mode_64bit)
    {
      if (!(sizeflag & AFLAG))
	s = names32[code - eAX_reg];
      else
	s = names64[code - eAX_reg];
    }
  else if (sizeflag & AFLAG)
    s = names32[code - eAX_reg];
  else
    s = names16[code - eAX_reg];
  oappend (s);
  *obufp++ = close_char;
  *obufp = 0;
}

static void
OP_ESreg (int code, int sizeflag)
{
  if (intel_syntax)
    {
      switch (codep[-1])
	{
	case 0x6d:	/* insw/insl */
	  intel_operand_size (z_mode, sizeflag);
	  break;
	case 0xa5:	/* movsw/movsl/movsq */
	case 0xa7:	/* cmpsw/cmpsl/cmpsq */
	case 0xab:	/* stosw/stosl */
	case 0xaf:	/* scasw/scasl */
	  intel_operand_size (v_mode, sizeflag);
	  break;
	default:
	  intel_operand_size (b_mode, sizeflag);
	}
    }
  oappend_maybe_intel ("%es:");
  ptr_reg (code, sizeflag);
}

static void
OP_DSreg (int code, int sizeflag)
{
  if (intel_syntax)
    {
      switch (codep[-1])
	{
	case 0x6f:	/* outsw/outsl */
	  intel_operand_size (z_mode, sizeflag);
	  break;
	case 0xa5:	/* movsw/movsl/movsq */
	case 0xa7:	/* cmpsw/cmpsl/cmpsq */
	case 0xad:	/* lodsw/lodsl/lodsq */
	  intel_operand_size (v_mode, sizeflag);
	  break;
	default:
	  intel_operand_size (b_mode, sizeflag);
	}
    }
  if ((prefixes
       & (PREFIX_CS
	  | PREFIX_DS
	  | PREFIX_SS
	  | PREFIX_ES
	  | PREFIX_FS
	  | PREFIX_GS)) == 0)
    prefixes |= PREFIX_DS;
  append_seg ();
  ptr_reg (code, sizeflag);
}

static void
OP_C (int dummy ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  int add;
  if (rex & REX_R)
    {
      USED_REX (REX_R);
      add = 8;
    }
  else if (address_mode != mode_64bit && (prefixes & PREFIX_LOCK))
    {
      all_prefixes[last_lock_prefix] = 0;
      used_prefixes |= PREFIX_LOCK;
      add = 8;
    }
  else
    add = 0;
  sprintf (scratchbuf, "%%cr%d", modrm.reg + add);
  oappend_maybe_intel (scratchbuf);
}

static void
OP_D (int dummy ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  int add;
  USED_REX (REX_R);
  if (rex & REX_R)
    add = 8;
  else
    add = 0;
  if (intel_syntax)
    sprintf (scratchbuf, "db%d", modrm.reg + add);
  else
    sprintf (scratchbuf, "%%db%d", modrm.reg + add);
  oappend (scratchbuf);
}

static void
OP_T (int dummy ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  sprintf (scratchbuf, "%%tr%d", modrm.reg);
  oappend_maybe_intel (scratchbuf);
}

static void
OP_R (int bytemode, int sizeflag)
{
  if (modrm.mod == 3)
    OP_E (bytemode, sizeflag);
  else
    BadOp ();
}

static void
OP_MMX (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  int reg = modrm.reg;
  const char **names;

  used_prefixes |= (prefixes & PREFIX_DATA);
  if (prefixes & PREFIX_DATA)
    {
      names = names_xmm;
      USED_REX (REX_R);
      if (rex & REX_R)
	reg += 8;
    }
  else
    names = names_mm;
  oappend (names[reg]);
}

static void
OP_XMM (int bytemode, int sizeflag ATTRIBUTE_UNUSED)
{
  int reg = modrm.reg;
  const char **names;

  USED_REX (REX_R);
  if (rex & REX_R)
    reg += 8;
  if (vex.evex)
    {
      if (!vex.r)
	reg += 16;
    }

  if (need_vex
      && bytemode != xmm_mode
      && bytemode != xmmq_mode
      && bytemode != evex_half_bcst_xmmq_mode
      && bytemode != ymm_mode
      && bytemode != scalar_mode)
    {
      switch (vex.length)
	{
	case 128:
	  names = names_xmm;
	  break;
	case 256:
	  if (vex.w || bytemode != vex_vsib_q_w_dq_mode)
	    names = names_ymm;
	  else
	    names = names_xmm;
	  break;
	case 512:
	  names = names_zmm;
	  break;
	default:
	  abort ();
	}
    }
  else if (bytemode == xmmq_mode
	   || bytemode == evex_half_bcst_xmmq_mode)
    {
      switch (vex.length)
	{
	case 128:
	case 256:
	  names = names_xmm;
	  break;
	case 512:
	  names = names_ymm;
	  break;
	default:
	  abort ();
	}
    }
  else if (bytemode == ymm_mode)
    names = names_ymm;
  else
    names = names_xmm;
  oappend (names[reg]);
}

static void
OP_EM (int bytemode, int sizeflag)
{
  int reg;
  const char **names;

  if (modrm.mod != 3)
    {
      if (intel_syntax
	  && (bytemode == v_mode || bytemode == v_swap_mode))
	{
	  bytemode = (prefixes & PREFIX_DATA) ? x_mode : q_mode;
	  used_prefixes |= (prefixes & PREFIX_DATA);
	}
      OP_E (bytemode, sizeflag);
      return;
    }

  if ((sizeflag & SUFFIX_ALWAYS) && bytemode == v_swap_mode)
    swap_operand ();

  /* Skip mod/rm byte.  */
  MODRM_CHECK;
  codep++;
  used_prefixes |= (prefixes & PREFIX_DATA);
  reg = modrm.rm;
  if (prefixes & PREFIX_DATA)
    {
      names = names_xmm;
      USED_REX (REX_B);
      if (rex & REX_B)
	reg += 8;
    }
  else
    names = names_mm;
  oappend (names[reg]);
}

/* cvt* are the only instructions in sse2 which have
   both SSE and MMX operands and also have 0x66 prefix
   in their opcode. 0x66 was originally used to differentiate
   between SSE and MMX instruction(operands). So we have to handle the
   cvt* separately using OP_EMC and OP_MXC */
static void
OP_EMC (int bytemode, int sizeflag)
{
  if (modrm.mod != 3)
    {
      if (intel_syntax && bytemode == v_mode)
	{
	  bytemode = (prefixes & PREFIX_DATA) ? x_mode : q_mode;
	  used_prefixes |= (prefixes & PREFIX_DATA);
	}
      OP_E (bytemode, sizeflag);
      return;
    }

  /* Skip mod/rm byte.  */
  MODRM_CHECK;
  codep++;
  used_prefixes |= (prefixes & PREFIX_DATA);
  oappend (names_mm[modrm.rm]);
}

static void
OP_MXC (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  used_prefixes |= (prefixes & PREFIX_DATA);
  oappend (names_mm[modrm.reg]);
}

static void
OP_EX (int bytemode, int sizeflag)
{
  int reg;
  const char **names;

  /* Skip mod/rm byte.  */
  MODRM_CHECK;
  codep++;

  if (modrm.mod != 3)
    {
      OP_E_memory (bytemode, sizeflag);
      return;
    }

  reg = modrm.rm;
  USED_REX (REX_B);
  if (rex & REX_B)
    reg += 8;
  if (vex.evex)
    {
      USED_REX (REX_X);
      if ((rex & REX_X))
	reg += 16;
    }

  if ((sizeflag & SUFFIX_ALWAYS)
      && (bytemode == x_swap_mode
	  || bytemode == d_swap_mode
	  || bytemode == d_scalar_swap_mode
	  || bytemode == q_swap_mode
	  || bytemode == q_scalar_swap_mode))
    swap_operand ();

  if (need_vex
      && bytemode != xmm_mode
      && bytemode != xmmdw_mode
      && bytemode != xmmqd_mode
      && bytemode != xmm_mb_mode
      && bytemode != xmm_mw_mode
      && bytemode != xmm_md_mode
      && bytemode != xmm_mq_mode
      && bytemode != xmm_mdq_mode
      && bytemode != xmmq_mode
      && bytemode != evex_half_bcst_xmmq_mode
      && bytemode != ymm_mode
      && bytemode != d_scalar_mode
      && bytemode != d_scalar_swap_mode
      && bytemode != q_scalar_mode
      && bytemode != q_scalar_swap_mode
      && bytemode != vex_scalar_w_dq_mode)
    {
      switch (vex.length)
	{
	case 128:
	  names = names_xmm;
	  break;
	case 256:
	  names = names_ymm;
	  break;
	case 512:
	  names = names_zmm;
	  break;
	default:
	  abort ();
	}
    }
  else if (bytemode == xmmq_mode
	   || bytemode == evex_half_bcst_xmmq_mode)
    {
      switch (vex.length)
	{
	case 128:
	case 256:
	  names = names_xmm;
	  break;
	case 512:
	  names = names_ymm;
	  break;
	default:
	  abort ();
	}
    }
  else if (bytemode == ymm_mode)
    names = names_ymm;
  else
    names = names_xmm;
  oappend (names[reg]);
}

static void
OP_MS (int bytemode, int sizeflag)
{
  if (modrm.mod == 3)
    OP_EM (bytemode, sizeflag);
  else
    BadOp ();
}

static void
OP_XS (int bytemode, int sizeflag)
{
  if (modrm.mod == 3)
    OP_EX (bytemode, sizeflag);
  else
    BadOp ();
}

static void
OP_M (int bytemode, int sizeflag)
{
  if (modrm.mod == 3)
    /* bad bound,lea,lds,les,lfs,lgs,lss,cmpxchg8b,vmptrst modrm */
    BadOp ();
  else
    OP_E (bytemode, sizeflag);
}

static void
OP_0f07 (int bytemode, int sizeflag)
{
  if (modrm.mod != 3 || modrm.rm != 0)
    BadOp ();
  else
    OP_E (bytemode, sizeflag);
}

/* NOP is an alias of "xchg %ax,%ax" in 16bit mode, "xchg %eax,%eax" in
   32bit mode and "xchg %rax,%rax" in 64bit mode.  */

static void
NOP_Fixup1 (int bytemode, int sizeflag)
{
  if ((prefixes & PREFIX_DATA) != 0
      || (rex != 0
	  && rex != 0x48
	  && address_mode == mode_64bit))
    OP_REG (bytemode, sizeflag);
  else
    strcpy (obuf, "nop");
}

static void
NOP_Fixup2 (int bytemode, int sizeflag)
{
  if ((prefixes & PREFIX_DATA) != 0
      || (rex != 0
	  && rex != 0x48
	  && address_mode == mode_64bit))
    OP_IMREG (bytemode, sizeflag);
}

static const char *const Suffix3DNow[] = {
/* 00 */	NULL,		NULL,		NULL,		NULL,
/* 04 */	NULL,		NULL,		NULL,		NULL,
/* 08 */	NULL,		NULL,		NULL,		NULL,
/* 0C */	"pi2fw",	"pi2fd",	NULL,		NULL,
/* 10 */	NULL,		NULL,		NULL,		NULL,
/* 14 */	NULL,		NULL,		NULL,		NULL,
/* 18 */	NULL,		NULL,		NULL,		NULL,
/* 1C */	"pf2iw",	"pf2id",	NULL,		NULL,
/* 20 */	NULL,		NULL,		NULL,		NULL,
/* 24 */	NULL,		NULL,		NULL,		NULL,
/* 28 */	NULL,		NULL,		NULL,		NULL,
/* 2C */	NULL,		NULL,		NULL,		NULL,
/* 30 */	NULL,		NULL,		NULL,		NULL,
/* 34 */	NULL,		NULL,		NULL,		NULL,
/* 38 */	NULL,		NULL,		NULL,		NULL,
/* 3C */	NULL,		NULL,		NULL,		NULL,
/* 40 */	NULL,		NULL,		NULL,		NULL,
/* 44 */	NULL,		NULL,		NULL,		NULL,
/* 48 */	NULL,		NULL,		NULL,		NULL,
/* 4C */	NULL,		NULL,		NULL,		NULL,
/* 50 */	NULL,		NULL,		NULL,		NULL,
/* 54 */	NULL,		NULL,		NULL,		NULL,
/* 58 */	NULL,		NULL,		NULL,		NULL,
/* 5C */	NULL,		NULL,		NULL,		NULL,
/* 60 */	NULL,		NULL,		NULL,		NULL,
/* 64 */	NULL,		NULL,		NULL,		NULL,
/* 68 */	NULL,		NULL,		NULL,		NULL,
/* 6C */	NULL,		NULL,		NULL,		NULL,
/* 70 */	NULL,		NULL,		NULL,		NULL,
/* 74 */	NULL,		NULL,		NULL,		NULL,
/* 78 */	NULL,		NULL,		NULL,		NULL,
/* 7C */	NULL,		NULL,		NULL,		NULL,
/* 80 */	NULL,		NULL,		NULL,		NULL,
/* 84 */	NULL,		NULL,		NULL,		NULL,
/* 88 */	NULL,		NULL,		"pfnacc",	NULL,
/* 8C */	NULL,		NULL,		"pfpnacc",	NULL,
/* 90 */	"pfcmpge",	NULL,		NULL,		NULL,
/* 94 */	"pfmin",	NULL,		"pfrcp",	"pfrsqrt",
/* 98 */	NULL,		NULL,		"pfsub",	NULL,
/* 9C */	NULL,		NULL,		"pfadd",	NULL,
/* A0 */	"pfcmpgt",	NULL,		NULL,		NULL,
/* A4 */	"pfmax",	NULL,		"pfrcpit1",	"pfrsqit1",
/* A8 */	NULL,		NULL,		"pfsubr",	NULL,
/* AC */	NULL,		NULL,		"pfacc",	NULL,
/* B0 */	"pfcmpeq",	NULL,		NULL,		NULL,
/* B4 */	"pfmul",	NULL,		"pfrcpit2",	"pmulhrw",
/* B8 */	NULL,		NULL,		NULL,		"pswapd",
/* BC */	NULL,		NULL,		NULL,		"pavgusb",
/* C0 */	NULL,		NULL,		NULL,		NULL,
/* C4 */	NULL,		NULL,		NULL,		NULL,
/* C8 */	NULL,		NULL,		NULL,		NULL,
/* CC */	NULL,		NULL,		NULL,		NULL,
/* D0 */	NULL,		NULL,		NULL,		NULL,
/* D4 */	NULL,		NULL,		NULL,		NULL,
/* D8 */	NULL,		NULL,		NULL,		NULL,
/* DC */	NULL,		NULL,		NULL,		NULL,
/* E0 */	NULL,		NULL,		NULL,		NULL,
/* E4 */	NULL,		NULL,		NULL,		NULL,
/* E8 */	NULL,		NULL,		NULL,		NULL,
/* EC */	NULL,		NULL,		NULL,		NULL,
/* F0 */	NULL,		NULL,		NULL,		NULL,
/* F4 */	NULL,		NULL,		NULL,		NULL,
/* F8 */	NULL,		NULL,		NULL,		NULL,
/* FC */	NULL,		NULL,		NULL,		NULL,
};

static void
OP_3DNowSuffix (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  const char *mnemonic;

  FETCH_DATA (the_info, codep + 1);
  /* AMD 3DNow! instructions are specified by an opcode suffix in the
     place where an 8-bit immediate would normally go.  ie. the last
     byte of the instruction.  */
  obufp = mnemonicendp;
  mnemonic = Suffix3DNow[*codep++ & 0xff];
  if (mnemonic)
    oappend (mnemonic);
  else
    {
      /* Since a variable sized modrm/sib chunk is between the start
	 of the opcode (0x0f0f) and the opcode suffix, we need to do
	 all the modrm processing first, and don't know until now that
	 we have a bad opcode.  This necessitates some cleaning up.  */
      op_out[0][0] = '\0';
      op_out[1][0] = '\0';
      BadOp ();
    }
  mnemonicendp = obufp;
}

static struct op simd_cmp_op[] =
{
  { STRING_COMMA_LEN ("eq") },
  { STRING_COMMA_LEN ("lt") },
  { STRING_COMMA_LEN ("le") },
  { STRING_COMMA_LEN ("unord") },
  { STRING_COMMA_LEN ("neq") },
  { STRING_COMMA_LEN ("nlt") },
  { STRING_COMMA_LEN ("nle") },
  { STRING_COMMA_LEN ("ord") }
};

static void
CMP_Fixup (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  unsigned int cmp_type;

  FETCH_DATA (the_info, codep + 1);
  cmp_type = *codep++ & 0xff;
  if (cmp_type < ARRAY_SIZE (simd_cmp_op))
    {
      char suffix [3];
      char *p = mnemonicendp - 2;
      suffix[0] = p[0];
      suffix[1] = p[1];
      suffix[2] = '\0';
      sprintf (p, "%s%s", simd_cmp_op[cmp_type].name, suffix);
      mnemonicendp += simd_cmp_op[cmp_type].len;
    }
  else
    {
      /* We have a reserved extension byte.  Output it directly.  */
      scratchbuf[0] = '$';
      print_operand_value (scratchbuf + 1, 1, cmp_type);
      oappend_maybe_intel (scratchbuf);
      scratchbuf[0] = '\0';
    }
}

static void
OP_Mwait (int bytemode ATTRIBUTE_UNUSED,
	  int sizeflag ATTRIBUTE_UNUSED)
{
  /* mwait %eax,%ecx  */
  if (!intel_syntax)
    {
      const char **names = (address_mode == mode_64bit
			    ? names64 : names32);
      strcpy (op_out[0], names[0]);
      strcpy (op_out[1], names[1]);
      two_source_ops = 1;
    }
  /* Skip mod/rm byte.  */
  MODRM_CHECK;
  codep++;
}

static void
OP_Monitor (int bytemode ATTRIBUTE_UNUSED,
	    int sizeflag ATTRIBUTE_UNUSED)
{
  /* monitor %eax,%ecx,%edx"  */
  if (!intel_syntax)
    {
      const char **op1_names;
      const char **names = (address_mode == mode_64bit
			    ? names64 : names32);

      if (!(prefixes & PREFIX_ADDR))
	op1_names = (address_mode == mode_16bit
		     ? names16 : names);
      else
	{
	  /* Remove "addr16/addr32".  */
	  all_prefixes[last_addr_prefix] = 0;
	  op1_names = (address_mode != mode_32bit
		       ? names32 : names16);
	  used_prefixes |= PREFIX_ADDR;
	}
      strcpy (op_out[0], op1_names[0]);
      strcpy (op_out[1], names[1]);
      strcpy (op_out[2], names[2]);
      two_source_ops = 1;
    }
  /* Skip mod/rm byte.  */
  MODRM_CHECK;
  codep++;
}

static void
BadOp (void)
{
  /* Throw away prefixes and 1st. opcode byte.  */
  codep = insn_codep + 1;
  oappend ("(bad)");
}

static void
REP_Fixup (int bytemode, int sizeflag)
{
  /* The 0xf3 prefix should be displayed as "rep" for ins, outs, movs,
     lods and stos.  */
  if (prefixes & PREFIX_REPZ)
    all_prefixes[last_repz_prefix] = REP_PREFIX;

  switch (bytemode)
    {
    case al_reg:
    case eAX_reg:
    case indir_dx_reg:
      OP_IMREG (bytemode, sizeflag);
      break;
    case eDI_reg:
      OP_ESreg (bytemode, sizeflag);
      break;
    case eSI_reg:
      OP_DSreg (bytemode, sizeflag);
      break;
    default:
      abort ();
      break;
    }
}

/* For BND-prefixed instructions 0xF2 prefix should be displayed as
   "bnd".  */

static void
BND_Fixup (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  if (prefixes & PREFIX_REPNZ)
    all_prefixes[last_repnz_prefix] = BND_PREFIX;
}

/* Similar to OP_E.  But the 0xf2/0xf3 prefixes should be displayed as
   "xacquire"/"xrelease" for memory operand if there is a LOCK prefix.
 */

static void
HLE_Fixup1 (int bytemode, int sizeflag)
{
  if (modrm.mod != 3
      && (prefixes & PREFIX_LOCK) != 0)
    {
      if (prefixes & PREFIX_REPZ)
	all_prefixes[last_repz_prefix] = XRELEASE_PREFIX;
      if (prefixes & PREFIX_REPNZ)
	all_prefixes[last_repnz_prefix] = XACQUIRE_PREFIX;
    }

  OP_E (bytemode, sizeflag);
}

/* Similar to OP_E.  But the 0xf2/0xf3 prefixes should be displayed as
   "xacquire"/"xrelease" for memory operand.  No check for LOCK prefix.
 */

static void
HLE_Fixup2 (int bytemode, int sizeflag)
{
  if (modrm.mod != 3)
    {
      if (prefixes & PREFIX_REPZ)
	all_prefixes[last_repz_prefix] = XRELEASE_PREFIX;
      if (prefixes & PREFIX_REPNZ)
	all_prefixes[last_repnz_prefix] = XACQUIRE_PREFIX;
    }

  OP_E (bytemode, sizeflag);
}

/* Similar to OP_E.  But the 0xf3 prefixes should be displayed as
   "xrelease" for memory operand.  No check for LOCK prefix.   */

static void
HLE_Fixup3 (int bytemode, int sizeflag)
{
  if (modrm.mod != 3
      && last_repz_prefix > last_repnz_prefix
      && (prefixes & PREFIX_REPZ) != 0)
    all_prefixes[last_repz_prefix] = XRELEASE_PREFIX;

  OP_E (bytemode, sizeflag);
}

static void
CMPXCHG8B_Fixup (int bytemode, int sizeflag)
{
  USED_REX (REX_W);
  if (rex & REX_W)
    {
      /* Change cmpxchg8b to cmpxchg16b.  */
      char *p = mnemonicendp - 2;
      mnemonicendp = stpcpy (p, "16b");
      bytemode = o_mode;
    }
  else if ((prefixes & PREFIX_LOCK) != 0)
    {
      if (prefixes & PREFIX_REPZ)
	all_prefixes[last_repz_prefix] = XRELEASE_PREFIX;
      if (prefixes & PREFIX_REPNZ)
	all_prefixes[last_repnz_prefix] = XACQUIRE_PREFIX;
    }

  OP_M (bytemode, sizeflag);
}

static void
XMM_Fixup (int reg, int sizeflag ATTRIBUTE_UNUSED)
{
  const char **names;

  if (need_vex)
    {
      switch (vex.length)
	{
	case 128:
	  names = names_xmm;
	  break;
	case 256:
	  names = names_ymm;
	  break;
	default:
	  abort ();
	}
    }
  else
    names = names_xmm;
  oappend (names[reg]);
}

static void
CRC32_Fixup (int bytemode, int sizeflag)
{
  /* Add proper suffix to "crc32".  */
  char *p = mnemonicendp;

  switch (bytemode)
    {
    case b_mode:
      if (intel_syntax)
	goto skip;

      *p++ = 'b';
      break;
    case v_mode:
      if (intel_syntax)
	goto skip;

      USED_REX (REX_W);
      if (rex & REX_W)
	*p++ = 'q';
      else
	{
	  if (sizeflag & DFLAG)
	    *p++ = 'l';
	  else
	    *p++ = 'w';
	  used_prefixes |= (prefixes & PREFIX_DATA);
	}
      break;
    default:
      oappend (INTERNAL_DISASSEMBLER_ERROR);
      break;
    }
  mnemonicendp = p;
  *p = '\0';

skip:
  if (modrm.mod == 3)
    {
      int add;

      /* Skip mod/rm byte.  */
      MODRM_CHECK;
      codep++;

      USED_REX (REX_B);
      add = (rex & REX_B) ? 8 : 0;
      if (bytemode == b_mode)
	{
	  USED_REX (0);
	  if (rex)
	    oappend (names8rex[modrm.rm + add]);
	  else
	    oappend (names8[modrm.rm + add]);
	}
      else
	{
	  USED_REX (REX_W);
	  if (rex & REX_W)
	    oappend (names64[modrm.rm + add]);
	  else if ((prefixes & PREFIX_DATA))
	    oappend (names16[modrm.rm + add]);
	  else
	    oappend (names32[modrm.rm + add]);
	}
    }
  else
    OP_E (bytemode, sizeflag);
}

static void
FXSAVE_Fixup (int bytemode, int sizeflag)
{
  /* Add proper suffix to "fxsave" and "fxrstor".  */
  USED_REX (REX_W);
  if (rex & REX_W)
    {
      char *p = mnemonicendp;
      *p++ = '6';
      *p++ = '4';
      *p = '\0';
      mnemonicendp = p;
    }
  OP_M (bytemode, sizeflag);
}

/* Display the destination register operand for instructions with
   VEX. */

static void
OP_VEX (int bytemode, int sizeflag ATTRIBUTE_UNUSED)
{
  int reg;
  const char **names;

  if (!need_vex)
    abort ();

  if (!need_vex_reg)
    return;

  reg = vex.register_specifier;
  if (vex.evex)
    {
      if (!vex.v)
	reg += 16;
    }

  if (bytemode == vex_scalar_mode)
    {
      oappend (names_xmm[reg]);
      return;
    }

  switch (vex.length)
    {
    case 128:
      switch (bytemode)
	{
	case vex_mode:
	case vex128_mode:
	case vex_vsib_q_w_dq_mode:
	  names = names_xmm;
	  break;
	case dq_mode:
	  if (vex.w)
	    names = names64;
	  else
	    names = names32;
	  break;
	case mask_mode:
	  names = names_mask;
	  break;
	default:
	  abort ();
	  return;
	}
      break;
    case 256:
      switch (bytemode)
	{
	case vex_mode:
	case vex256_mode:
	  names = names_ymm;
	  break;
	case vex_vsib_q_w_dq_mode:
	  names = vex.w ? names_ymm : names_xmm;
	  break;
	case mask_mode:
	  names = names_mask;
	  break;
	default:
	  abort ();
	  return;
	}
      break;
    case 512:
      names = names_zmm;
      break;
    default:
      abort ();
      break;
    }
  oappend (names[reg]);
}

/* Get the VEX immediate byte without moving codep.  */

static unsigned char
get_vex_imm8 (int sizeflag, int opnum)
{
  int bytes_before_imm = 0;

  if (modrm.mod != 3)
    {
      /* There are SIB/displacement bytes.  */
      if ((sizeflag & AFLAG) || address_mode == mode_64bit)
	{
	  /* 32/64 bit address mode */
	  int base = modrm.rm;

	  /* Check SIB byte.  */
	  if (base == 4)
	    {
	      FETCH_DATA (the_info, codep + 1);
	      base = *codep & 7;
	      /* When decoding the third source, don't increase
		 bytes_before_imm as this has already been incremented
		 by one in OP_E_memory while decoding the second
		 source operand.  */
	      if (opnum == 0)
		bytes_before_imm++;
	    }

	  /* Don't increase bytes_before_imm when decoding the third source,
	     it has already been incremented by OP_E_memory while decoding
	     the second source operand.  */
	  if (opnum == 0)
	    {
	      switch (modrm.mod)
		{
		  case 0:
		    /* When modrm.rm == 5 or modrm.rm == 4 and base in
		       SIB == 5, there is a 4 byte displacement.  */
		    if (base != 5)
		      /* No displacement. */
		      break;
		  case 2:
		    /* 4 byte displacement.  */
		    bytes_before_imm += 4;
		    break;
		  case 1:
		    /* 1 byte displacement.  */
		    bytes_before_imm++;
		    break;
		}
	    }
	}
      else
	{
	  /* 16 bit address mode */
	  /* Don't increase bytes_before_imm when decoding the third source,
	     it has already been incremented by OP_E_memory while decoding
	     the second source operand.  */
	  if (opnum == 0)
	    {
	      switch (modrm.mod)
		{
		case 0:
		  /* When modrm.rm == 6, there is a 2 byte displacement.  */
		  if (modrm.rm != 6)
		    /* No displacement. */
		    break;
		case 2:
		  /* 2 byte displacement.  */
		  bytes_before_imm += 2;
		  break;
		case 1:
		  /* 1 byte displacement: when decoding the third source,
		     don't increase bytes_before_imm as this has already
		     been incremented by one in OP_E_memory while decoding
		     the second source operand.  */
		  if (opnum == 0)
		    bytes_before_imm++;

		  break;
		}
	    }
	}
    }

  FETCH_DATA (the_info, codep + bytes_before_imm + 1);
  return codep [bytes_before_imm];
}

static void
OP_EX_VexReg (int bytemode, int sizeflag, int reg)
{
  const char **names;

  if (reg == -1 && modrm.mod != 3)
    {
      OP_E_memory (bytemode, sizeflag);
      return;
    }
  else
    {
      if (reg == -1)
	{
	  reg = modrm.rm;
	  USED_REX (REX_B);
	  if (rex & REX_B)
	    reg += 8;
	}
      else if (reg > 7 && address_mode != mode_64bit)
	BadOp ();
    }

  switch (vex.length)
    {
    case 128:
      names = names_xmm;
      break;
    case 256:
      names = names_ymm;
      break;
    default:
      abort ();
    }
  oappend (names[reg]);
}

static void
OP_EX_VexImmW (int bytemode, int sizeflag)
{
  int reg = -1;
  static unsigned char vex_imm8;

  if (vex_w_done == 0)
    {
      vex_w_done = 1;

      /* Skip mod/rm byte.  */
      MODRM_CHECK;
      codep++;

      vex_imm8 = get_vex_imm8 (sizeflag, 0);

      if (vex.w)
	  reg = vex_imm8 >> 4;

      OP_EX_VexReg (bytemode, sizeflag, reg);
    }
  else if (vex_w_done == 1)
    {
      vex_w_done = 2;

      if (!vex.w)
	  reg = vex_imm8 >> 4;

      OP_EX_VexReg (bytemode, sizeflag, reg);
    }
  else
    {
      /* Output the imm8 directly.  */
      scratchbuf[0] = '$';
      print_operand_value (scratchbuf + 1, 1, vex_imm8 & 0xf);
      oappend_maybe_intel (scratchbuf);
      scratchbuf[0] = '\0';
      codep++;
    }
}

static void
OP_Vex_2src (int bytemode, int sizeflag)
{
  if (modrm.mod == 3)
    {
      int reg = modrm.rm;
      USED_REX (REX_B);
      if (rex & REX_B)
	reg += 8;
      oappend (names_xmm[reg]);
    }
  else
    {
      if (intel_syntax
	  && (bytemode == v_mode || bytemode == v_swap_mode))
	{
	  bytemode = (prefixes & PREFIX_DATA) ? x_mode : q_mode;
	  used_prefixes |= (prefixes & PREFIX_DATA);
	}
      OP_E (bytemode, sizeflag);
    }
}

static void
OP_Vex_2src_1 (int bytemode, int sizeflag)
{
  if (modrm.mod == 3)
    {
      /* Skip mod/rm byte.   */
      MODRM_CHECK;
      codep++;
    }

  if (vex.w)
    oappend (names_xmm[vex.register_specifier]);
  else
    OP_Vex_2src (bytemode, sizeflag);
}

static void
OP_Vex_2src_2 (int bytemode, int sizeflag)
{
  if (vex.w)
    OP_Vex_2src (bytemode, sizeflag);
  else
    oappend (names_xmm[vex.register_specifier]);
}

static void
OP_EX_VexW (int bytemode, int sizeflag)
{
  int reg = -1;

  if (!vex_w_done)
    {
      vex_w_done = 1;

      /* Skip mod/rm byte.  */
      MODRM_CHECK;
      codep++;

      if (vex.w)
	reg = get_vex_imm8 (sizeflag, 0) >> 4;
    }
  else
    {
      if (!vex.w)
	reg = get_vex_imm8 (sizeflag, 1) >> 4;
    }

  OP_EX_VexReg (bytemode, sizeflag, reg);
}

static void
VEXI4_Fixup (int bytemode ATTRIBUTE_UNUSED,
	     int sizeflag ATTRIBUTE_UNUSED)
{
  /* Skip the immediate byte and check for invalid bits.  */
  FETCH_DATA (the_info, codep + 1);
  if (*codep++ & 0xf)
    BadOp ();
}

static void
OP_REG_VexI4 (int bytemode, int sizeflag ATTRIBUTE_UNUSED)
{
  int reg;
  const char **names;

  FETCH_DATA (the_info, codep + 1);
  reg = *codep++;

  if (bytemode != x_mode)
    abort ();

  if (reg & 0xf)
      BadOp ();

  reg >>= 4;
  if (reg > 7 && address_mode != mode_64bit)
    BadOp ();

  switch (vex.length)
    {
    case 128:
      names = names_xmm;
      break;
    case 256:
      names = names_ymm;
      break;
    default:
      abort ();
    }
  oappend (names[reg]);
}

static void
OP_XMM_VexW (int bytemode, int sizeflag)
{
  /* Turn off the REX.W bit since it is used for swapping operands
     now.  */
  rex &= ~REX_W;
  OP_XMM (bytemode, sizeflag);
}

static void
OP_EX_Vex (int bytemode, int sizeflag)
{
  if (modrm.mod != 3)
    {
      if (vex.register_specifier != 0)
	BadOp ();
      need_vex_reg = 0;
    }
  OP_EX (bytemode, sizeflag);
}

static void
OP_XMM_Vex (int bytemode, int sizeflag)
{
  if (modrm.mod != 3)
    {
      if (vex.register_specifier != 0)
	BadOp ();
      need_vex_reg = 0;
    }
  OP_XMM (bytemode, sizeflag);
}

static void
VZERO_Fixup (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  switch (vex.length)
    {
    case 128:
      mnemonicendp = stpcpy (obuf, "vzeroupper");
      break;
    case 256:
      mnemonicendp = stpcpy (obuf, "vzeroall");
      break;
    default:
      abort ();
    }
}

static struct op vex_cmp_op[] =
{
  { STRING_COMMA_LEN ("eq") },
  { STRING_COMMA_LEN ("lt") },
  { STRING_COMMA_LEN ("le") },
  { STRING_COMMA_LEN ("unord") },
  { STRING_COMMA_LEN ("neq") },
  { STRING_COMMA_LEN ("nlt") },
  { STRING_COMMA_LEN ("nle") },
  { STRING_COMMA_LEN ("ord") },
  { STRING_COMMA_LEN ("eq_uq") },
  { STRING_COMMA_LEN ("nge") },
  { STRING_COMMA_LEN ("ngt") },
  { STRING_COMMA_LEN ("false") },
  { STRING_COMMA_LEN ("neq_oq") },
  { STRING_COMMA_LEN ("ge") },
  { STRING_COMMA_LEN ("gt") },
  { STRING_COMMA_LEN ("true") },
  { STRING_COMMA_LEN ("eq_os") },
  { STRING_COMMA_LEN ("lt_oq") },
  { STRING_COMMA_LEN ("le_oq") },
  { STRING_COMMA_LEN ("unord_s") },
  { STRING_COMMA_LEN ("neq_us") },
  { STRING_COMMA_LEN ("nlt_uq") },
  { STRING_COMMA_LEN ("nle_uq") },
  { STRING_COMMA_LEN ("ord_s") },
  { STRING_COMMA_LEN ("eq_us") },
  { STRING_COMMA_LEN ("nge_uq") },
  { STRING_COMMA_LEN ("ngt_uq") },
  { STRING_COMMA_LEN ("false_os") },
  { STRING_COMMA_LEN ("neq_os") },
  { STRING_COMMA_LEN ("ge_oq") },
  { STRING_COMMA_LEN ("gt_oq") },
  { STRING_COMMA_LEN ("true_us") },
};

static void
VCMP_Fixup (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  unsigned int cmp_type;

  FETCH_DATA (the_info, codep + 1);
  cmp_type = *codep++ & 0xff;
  if (cmp_type < ARRAY_SIZE (vex_cmp_op))
    {
      char suffix [3];
      char *p = mnemonicendp - 2;
      suffix[0] = p[0];
      suffix[1] = p[1];
      suffix[2] = '\0';
      sprintf (p, "%s%s", vex_cmp_op[cmp_type].name, suffix);
      mnemonicendp += vex_cmp_op[cmp_type].len;
    }
  else
    {
      /* We have a reserved extension byte.  Output it directly.  */
      scratchbuf[0] = '$';
      print_operand_value (scratchbuf + 1, 1, cmp_type);
      oappend_maybe_intel (scratchbuf);
      scratchbuf[0] = '\0';
    }
}

static void
VPCMP_Fixup (int bytemode ATTRIBUTE_UNUSED,
	     int sizeflag ATTRIBUTE_UNUSED)
{
  unsigned int cmp_type;

  if (!vex.evex)
    abort ();

  FETCH_DATA (the_info, codep + 1);
  cmp_type = *codep++ & 0xff;
  /* There are aliases for immediates 0, 1, 2, 4, 5, 6.
     If it's the case, print suffix, otherwise - print the immediate.  */
  if (cmp_type < ARRAY_SIZE (simd_cmp_op)
      && cmp_type != 3
      && cmp_type != 7)
    {
      char suffix [3];
      char *p = mnemonicendp - 2;

      /* vpcmp* can have both one- and two-lettered suffix.  */
      if (p[0] == 'p')
	{
	  p++;
	  suffix[0] = p[0];
	  suffix[1] = '\0';
	}
      else
	{
	  suffix[0] = p[0];
	  suffix[1] = p[1];
	  suffix[2] = '\0';
	}

      sprintf (p, "%s%s", simd_cmp_op[cmp_type].name, suffix);
      mnemonicendp += simd_cmp_op[cmp_type].len;
    }
  else
    {
      /* We have a reserved extension byte.  Output it directly.  */
      scratchbuf[0] = '$';
      print_operand_value (scratchbuf + 1, 1, cmp_type);
      oappend_maybe_intel (scratchbuf);
      scratchbuf[0] = '\0';
    }
}

static const struct op pclmul_op[] =
{
  { STRING_COMMA_LEN ("lql") },
  { STRING_COMMA_LEN ("hql") },
  { STRING_COMMA_LEN ("lqh") },
  { STRING_COMMA_LEN ("hqh") }
};

static void
PCLMUL_Fixup (int bytemode ATTRIBUTE_UNUSED,
	      int sizeflag ATTRIBUTE_UNUSED)
{
  unsigned int pclmul_type;

  FETCH_DATA (the_info, codep + 1);
  pclmul_type = *codep++ & 0xff;
  switch (pclmul_type)
    {
    case 0x10:
      pclmul_type = 2;
      break;
    case 0x11:
      pclmul_type = 3;
      break;
    default:
      break;
    }
  if (pclmul_type < ARRAY_SIZE (pclmul_op))
    {
      char suffix [4];
      char *p = mnemonicendp - 3;
      suffix[0] = p[0];
      suffix[1] = p[1];
      suffix[2] = p[2];
      suffix[3] = '\0';
      sprintf (p, "%s%s", pclmul_op[pclmul_type].name, suffix);
      mnemonicendp += pclmul_op[pclmul_type].len;
    }
  else
    {
      /* We have a reserved extension byte.  Output it directly.  */
      scratchbuf[0] = '$';
      print_operand_value (scratchbuf + 1, 1, pclmul_type);
      oappend_maybe_intel (scratchbuf);
      scratchbuf[0] = '\0';
    }
}

static void
MOVBE_Fixup (int bytemode, int sizeflag)
{
  /* Add proper suffix to "movbe".  */
  char *p = mnemonicendp;

  switch (bytemode)
    {
    case v_mode:
      if (intel_syntax)
	goto skip;

      USED_REX (REX_W);
      if (sizeflag & SUFFIX_ALWAYS)
	{
	  if (rex & REX_W)
	    *p++ = 'q';
	  else
	    {
	      if (sizeflag & DFLAG)
		*p++ = 'l';
	      else
		*p++ = 'w';
	      used_prefixes |= (prefixes & PREFIX_DATA);
	    }
	}
      break;
    default:
      oappend (INTERNAL_DISASSEMBLER_ERROR);
      break;
    }
  mnemonicendp = p;
  *p = '\0';

skip:
  OP_M (bytemode, sizeflag);
}

static void
OP_LWPCB_E (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  int reg;
  const char **names;

  /* Skip mod/rm byte.  */
  MODRM_CHECK;
  codep++;

  if (vex.w)
    names = names64;
  else
    names = names32;

  reg = modrm.rm;
  USED_REX (REX_B);
  if (rex & REX_B)
    reg += 8;

  oappend (names[reg]);
}

static void
OP_LWP_E (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  const char **names;

  if (vex.w)
    names = names64;
  else
    names = names32;

  oappend (names[vex.register_specifier]);
}

static void
OP_Mask (int bytemode, int sizeflag ATTRIBUTE_UNUSED)
{
  if (!vex.evex
      || bytemode != mask_mode)
    abort ();

  USED_REX (REX_R);
  if ((rex & REX_R) != 0 || !vex.r)
    {
      BadOp ();
      return;
    }

  oappend (names_mask [modrm.reg]);
}

static void
OP_Rounding (int bytemode, int sizeflag ATTRIBUTE_UNUSED)
{
  if (!vex.evex
      || (bytemode != evex_rounding_mode
	  && bytemode != evex_sae_mode))
    abort ();
  if (modrm.mod == 3 && vex.b)
    switch (bytemode)
      {
      case evex_rounding_mode:
	oappend (names_rounding[vex.ll]);
	break;
      case evex_sae_mode:
	oappend ("{sae}");
	break;
      default:
	break;
      }
}
@


1.281
log
@opcodes/
	* i386-dis.c (oappend_maybe_intel): New function.
	(OP_ST, OP_STi, append_seg, OP_I, OP_I64, OP_sI, OP_ESreg): Use it.
	(OP_C, OP_T, CMP_Fixup, OP_EX_VexImmW): Likewise.
	(VCMP_Fixup, VPCMP_Fixup, PCLMUL_Fixup): Likewise.
@
text
@a13810 1
    case v_bnd_mode:
d14092 1
d14132 1
a14146 1
    case v_bnd_mode:
@


1.280
log
@Remove PREFIX_EVEX_0F3A3E and PREFIX_EVEX_0F3A3F

	* i386-dis.c (PREFIX_EVEX_0F3A3E): Removed.
	(PREFIX_EVEX_0F3A3F): Likewise.
	* i386-dis-evex.h (evex_table): Updated.
@
text
@d3 1
a3 1
   2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012
d13098 8
d13109 1
a13109 1
  oappend ("%st" + intel_syntax);
d13116 1
a13116 1
  oappend (scratchbuf + intel_syntax);
d13640 1
a13640 1
      oappend ("%cs:" + intel_syntax);
d13645 1
a13645 1
      oappend ("%ds:" + intel_syntax);
d13650 1
a13650 1
      oappend ("%ss:" + intel_syntax);
d13655 1
a13655 1
      oappend ("%es:" + intel_syntax);
d13660 1
a13660 1
      oappend ("%fs:" + intel_syntax);
d13665 1
a13665 1
      oappend ("%gs:" + intel_syntax);
d14915 1
a14915 1
  oappend (scratchbuf + intel_syntax);
d14969 1
a14969 1
  oappend (scratchbuf + intel_syntax);
d15023 1
a15023 1
  oappend (scratchbuf + intel_syntax);
d15205 1
a15205 1
  oappend ("%es:" + intel_syntax);
d15258 1
a15258 1
  oappend (scratchbuf + intel_syntax);
d15281 1
a15281 1
  oappend (scratchbuf + intel_syntax);
d15726 1
a15726 1
      oappend (scratchbuf + intel_syntax);
d16251 1
a16251 1
      oappend (scratchbuf + intel_syntax);
d16480 1
a16480 1
      oappend (scratchbuf + intel_syntax);
d16527 1
a16527 1
      oappend (scratchbuf + intel_syntax);
d16575 1
a16575 1
      oappend (scratchbuf + intel_syntax);
@


1.280.2.1
log
@opcodes/
	* i386-dis.c (oappend_maybe_intel): New function.
	(OP_ST, OP_STi, append_seg, OP_I, OP_I64, OP_sI, OP_ESreg): Use it.
	(OP_C, OP_T, CMP_Fixup, OP_EX_VexImmW): Likewise.
	(VCMP_Fixup, VPCMP_Fixup, PCLMUL_Fixup): Likewise.
@
text
@d3 1
a3 1
   2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013
a13097 8
/* Like oappend (below), but S is a string starting with '%'.
   In Intel syntax, the '%' is elided.  */
static void
oappend_maybe_intel (const char *s)
{
  oappend (s + intel_syntax);
}

d13101 1
a13101 1
  oappend_maybe_intel ("%st");
d13108 1
a13108 1
  oappend_maybe_intel (scratchbuf);
d13632 1
a13632 1
      oappend_maybe_intel ("%cs:");
d13637 1
a13637 1
      oappend_maybe_intel ("%ds:");
d13642 1
a13642 1
      oappend_maybe_intel ("%ss:");
d13647 1
a13647 1
      oappend_maybe_intel ("%es:");
d13652 1
a13652 1
      oappend_maybe_intel ("%fs:");
d13657 1
a13657 1
      oappend_maybe_intel ("%gs:");
d14907 1
a14907 1
  oappend_maybe_intel (scratchbuf);
d14961 1
a14961 1
  oappend_maybe_intel (scratchbuf);
d15015 1
a15015 1
  oappend_maybe_intel (scratchbuf);
d15197 1
a15197 1
  oappend_maybe_intel ("%es:");
d15250 1
a15250 1
  oappend_maybe_intel (scratchbuf);
d15273 1
a15273 1
  oappend_maybe_intel (scratchbuf);
d15718 1
a15718 1
      oappend_maybe_intel (scratchbuf);
d16243 1
a16243 1
      oappend_maybe_intel (scratchbuf);
d16472 1
a16472 1
      oappend_maybe_intel (scratchbuf);
d16519 1
a16519 1
      oappend_maybe_intel (scratchbuf);
d16567 1
a16567 1
      oappend_maybe_intel (scratchbuf);
@


1.280.2.2
log
@Only allow 32-bit/64-bit registers for bndcl/bndcu/bndcn

gcc/

	PR target/58690
	* config/i386/i386.c (ix86_copy_addr_to_reg): New function.
	(ix86_expand_movmem): Replace copy_addr_to_reg with
	ix86_copy_addr_to_reg.
	(ix86_expand_setmem): Likewise.

gcc/testsuite/

	PR target/58690
	* gcc.target/i386/pr58690.c: New test
@
text
@d13811 1
a14092 1
    case v_bnd_mode:
a14131 1
    case v_bnd_mode:
d14146 1
@


1.279
log
@Add Intel AVX-512 support

binutils/

2013-07-26  Sergey Guriev  <sergey.s.guriev@@intel.com>
	    Alexander Ivchenko  <alexander.ivchenko@@intel.com>
	    Maxim Kuznetsov  <maxim.kuznetsov@@intel.com>
	    Sergey Lega  <sergey.s.lega@@intel.com>
	    Anna Tikhonova  <anna.tikhonova@@intel.com>
	    Ilya Tocar  <ilya.tocar@@intel.com>
	    Andrey Turetskiy  <andrey.turetskiy@@intel.com>
	    Ilya Verbin  <ilya.verbin@@intel.com>
	    Kirill Yukhin  <kirill.yukhin@@intel.com>
	    Michael Zolotukhin  <michael.v.zolotukhin@@intel.com>

	* dwarf.c (dwarf_regnames_i386): Add k0-k7 registers and
	numeration in comments.
	(dwarf_regnames_x86_64): Add xmm16-31 and k0-k7 registers to
	dwarf table.

gas/

2013-07-26  Sergey Guriev  <sergey.s.guriev@@intel.com>
	    Alexander Ivchenko  <alexander.ivchenko@@intel.com>
	    Maxim Kuznetsov  <maxim.kuznetsov@@intel.com>
	    Sergey Lega  <sergey.s.lega@@intel.com>
	    Anna Tikhonova  <anna.tikhonova@@intel.com>
	    Ilya Tocar  <ilya.tocar@@intel.com>
	    Andrey Turetskiy  <andrey.turetskiy@@intel.com>
	    Ilya Verbin  <ilya.verbin@@intel.com>
	    Kirill Yukhin  <kirill.yukhin@@intel.com>
	    Michael Zolotukhin  <michael.v.zolotukhin@@intel.com>

	* config/tc-i386-intel.c (O_zmmword_ptr): New.
	(i386_types): Add zmmword.
	(i386_intel_simplify_register): Allow regzmm.
	(i386_intel_simplify): Handle zmmwords.
	(i386_intel_operand): Handle RC/SAE, vector operations and
	zmmwords.
	* config/tc-i386.c (ZMMWORD_MNEM_SUFFIX): New.
	(struct RC_Operation): New.
	(struct Mask_Operation): New.
	(struct Broadcast_Operation): New.
	(vex_prefix): Size of bytes increased to 4 to support EVEX
	encoding.
	(enum i386_error): Add new error codes: unsupported_broadcast,
	broadcast_not_on_src_operand, broadcast_needed,
	unsupported_masking, mask_not_on_destination, no_default_mask,
	unsupported_rc_sae, rc_sae_operand_not_last_imm,
	invalid_register_operand, try_vector_disp8.
	(struct _i386_insn): Add new fields vrex, need_vrex, mask,
	rounding, broadcast, memshift.
	(struct RC_name): New.
	(RC_NamesTable): New.
	(evexlig): New.
	(evexwig): New.
	(extra_symbol_chars): Add '{'.
	(cpu_arch): Add AVX512F, AVX512CD, AVX512ER and AVX512PF.
	(i386_operand_type): Add regzmm, regmask and vec_disp8.
	(match_mem_size): Handle zmmwords.
	(operand_type_match): Handle zmm-registers.
	(mode_from_disp_size): Handle vec_disp8.
	(fits_in_vec_disp8): New.
	(md_begin): Handle {} properly.
	(type_names): Add "rZMM", "Mask reg" and "Vector d8".
	(build_vex_prefix): Handle vrex.
	(build_evex_prefix): New.
	(process_immext): Adjust to properly handle EVEX.
	(md_assemble): Add EVEX encoding support.
	(swap_2_operands): Correctly handle operands with masking,
	broadcasting or RC/SAE.
	(check_VecOperands): Support EVEX features.
	(VEX_check_operands): Properly handle 16 upper [xyz]mm registers.
	(match_template): Support regzmm and handle new error codes.
	(process_suffix): Handle zmmwords and zmm-registers.
	(check_byte_reg): Extend to zmm-registers.
	(process_operands): Extend to zmm-registers.
	(build_modrm_byte): Handle EVEX.
	(output_insn): Adjust to properly handle EVEX case.
	(disp_size): Handle vec_disp8.
	(output_disp): Support compressed disp8*N evex feature.
	(output_imm): Handle RC/SAE immediates properly.
	(check_VecOperations): New.
	(i386_immediate): Handle EVEX features.
	(i386_index_check): Handle zmmwords and zmm-registers.
	(RC_SAE_immediate): New.
	(i386_att_operand): Handle EVEX features.
	(parse_real_register): Add a check for ZMM/Mask registers.
	(OPTION_MEVEXLIG): New.
	(OPTION_MEVEXWIG): New.
	(md_longopts): Add mevexlig and mevexwig.
	(md_parse_option): Handle mevexlig and mevexwig options.
	(md_show_usage): Add description for mevexlig and mevexwig.
	* doc/c-i386.texi: Document avx512f/.avx512f, avx512cd/.avx512cd,
	avx512er/.avx512er, avx512pf/.avx512pf, mevexlig and mevexwig.

gas/testsuite/

2013-07-26  Sergey Guriev  <sergey.s.guriev@@intel.com>
	    Alexander Ivchenko  <alexander.ivchenko@@intel.com>
	    Maxim Kuznetsov  <maxim.kuznetsov@@intel.com>
	    Sergey Lega  <sergey.s.lega@@intel.com>
	    Anna Tikhonova  <anna.tikhonova@@intel.com>
	    Ilya Tocar  <ilya.tocar@@intel.com>
	    Andrey Turetskiy  <andrey.turetskiy@@intel.com>
	    Ilya Verbin  <ilya.verbin@@intel.com>
	    Kirill Yukhin  <kirill.yukhin@@intel.com>
	    Michael Zolotukhin  <michael.v.zolotukhin@@intel.com>

	* gas/cfi/cfi-i386.s: Add tests for k0-k7.
	* gas/cfi/cfi-i386.d: Change to reflect above mentioned changes.
	* gas/cfi/cfi-x86_64.s: Add tests for xmm16-31, k0-7.
	* gas/cfi/cfi-x86_64.d: Change to reflect above mentioned changes.
	* gas/i386/ilp32/cfi/cfi-x86_64.d: Ditto.
	* gas/i386/intel-regs.s: Add tests for zmm0 and xmm16 registers.
	* gas/i386/intel-regs.d: Change correspondingly.
	* gas/i386/prefetch-intel.d: Reflect implementation of prefetchwt1.
	* gas/i386/prefetch.d: Ditto.
	* gas/i386/x86-64-prefetch-intel.d: Ditto.
	* gas/i386/x86-64-prefetch.d: Ditto.
	* gas/i386/avx512f-intel.d: New.
	* gas/i386/avx512f-nondef.d: New.
	* gas/i386/avx512f-nondef.s: New.
	* gas/i386/avx512f-opts-intel.d: New.
	* gas/i386/avx512f-opts.d: New.
	* gas/i386/avx512f-opts.s: New.
	* gas/i386/avx512f.d: New.
	* gas/i386/avx512f.s: New.
	* gas/i386/avx512cd-intel.d: New.
	* gas/i386/avx512cd.d: New.
	* gas/i386/avx512cd.s: New.
	* gas/i386/avx512er-intel.d: New.
	* gas/i386/avx512er.d: New.
	* gas/i386/avx512er.s: New.
	* gas/i386/avx512pf-intel.d: New.
	* gas/i386/avx512pf.d: New.
	* gas/i386/avx512pf.s: New.
	* gas/i386/evex-lig.s: New.
	* gas/i386/evex-lig256-intel.d: New.
	* gas/i386/evex-lig256.d: New.
	* gas/i386/evex-lig512-intel.d: New.
	* gas/i386/evex-lig512.d: New.
	* gas/i386/evex-wig.s: New.
	* gas/i386/evex-wig1-intel.d: New.
	* gas/i386/evex-wig1.d: New.
	* gas/i386/inval-avx512f.l: New.
	* gas/i386/inval-avx512f.s: New.
	* gas/i386/x86-64-avx512f-intel.d: New.
	* gas/i386/x86-64-avx512f-nondef.d: New.
	* gas/i386/x86-64-avx512f-nondef.s: New.
	* gas/i386/x86-64-avx512f-opts-intel.d: New.
	* gas/i386/x86-64-avx512f-opts.d: New.
	* gas/i386/x86-64-avx512f-opts.s: New.
	* gas/i386/x86-64-avx512f.d: New.
	* gas/i386/x86-64-avx512f.s: New.
	* gas/i386/x86-64-avx512cd-intel.d: New.
	* gas/i386/x86-64-avx512cd.d: New.
	* gas/i386/x86-64-avx512cd.s: New.
	* gas/i386/x86-64-avx512er-intel.d: New.
	* gas/i386/x86-64-avx512er.d: New.
	* gas/i386/x86-64-avx512er.s: New.
	* gas/i386/x86-64-avx512pf-intel.d: New.
	* gas/i386/x86-64-avx512pf.d: New.
	* gas/i386/x86-64-avx512pf.s: New.
	* gas/i386/x86-64-evex-lig.s: New.
	* gas/i386/x86-64-evex-lig256-intel.d: New.
	* gas/i386/x86-64-evex-lig256.d: New.
	* gas/i386/x86-64-evex-lig512-intel.d: New.
	* gas/i386/x86-64-evex-lig512.d: New.
	* gas/i386/x86-64-evex-wig.s: New.
	* gas/i386/x86-64-evex-wig1-intel.d: New.
	* gas/i386/x86-64-evex-wig1.d: New.
	* gas/i386/x86-64-inval-avx512f.l: New.
	* gas/i386/x86-64-inval-avx512f.s: New.
	* gas/i386/i386.exp: Run new AVX-512 tests.

opcodes/

2013-07-26  Sergey Guriev  <sergey.s.guriev@@intel.com>
	    Alexander Ivchenko  <alexander.ivchenko@@intel.com>
	    Maxim Kuznetsov  <maxim.kuznetsov@@intel.com>
	    Sergey Lega  <sergey.s.lega@@intel.com>
	    Anna Tikhonova  <anna.tikhonova@@intel.com>
	    Ilya Tocar  <ilya.tocar@@intel.com>
	    Andrey Turetskiy  <andrey.turetskiy@@intel.com>
	    Ilya Verbin  <ilya.verbin@@intel.com>
	    Kirill Yukhin  <kirill.yukhin@@intel.com>
	    Michael Zolotukhin  <michael.v.zolotukhin@@intel.com>

	* i386-dis-evex.h: New.
	* i386-dis.c (OP_Rounding): New.
	(VPCMP_Fixup): New.
	(OP_Mask): New.
	(Rdq): New.
	(XMxmmq): New.
	(EXdScalarS): New.
	(EXymm): New.
	(EXEvexHalfBcstXmmq): New.
	(EXxmm_mdq): New.
	(EXEvexXGscat): New.
	(EXEvexXNoBcst): New.
	(VPCMP): New.
	(EXxEVexR): New.
	(EXxEVexS): New.
	(XMask): New.
	(MaskG): New.
	(MaskE): New.
	(MaskR): New.
	(MaskVex): New.
	(modes enum): Add evex_x_gscat_mode, evex_x_nobcst_mode,
	evex_half_bcst_xmmq_mode, xmm_mdq_mode, ymm_mode,
	evex_rounding_mode, evex_sae_mode, mask_mode.
	(USE_EVEX_TABLE): New.
	(EVEX_TABLE): New.
	(EVEX enum): New.
	(REG enum): Add REG_EVEX_0F72, REG_EVEX_0F73, REG_EVEX_0F38C6,
	REG_EVEX_0F38C7.
	(MOD enum): Add MOD_EVEX_0F10_PREFIX_1, MOD_EVEX_0F10_PREFIX_3,
	MOD_EVEX_0F11_PREFIX_1, MOD_EVEX_0F11_PREFIX_3,
	MOD_EVEX_0F12_PREFIX_0, MOD_EVEX_0F16_PREFIX_0, MOD_EVEX_0F38C6_REG_1,
	MOD_EVEX_0F38C6_REG_2, MOD_EVEX_0F38C6_REG_5, MOD_EVEX_0F38C6_REG_6,
	MOD_EVEX_0F38C7_REG_1, MOD_EVEX_0F38C7_REG_2,  MOD_EVEX_0F38C7_REG_5,
	MOD_EVEX_0F38C7_REG_6.
	(PREFIX enum): Add PREFIX_VEX_0F41, PREFIX_VEX_0F42, PREFIX_VEX_0F44,
	PREFIX_VEX_0F45, PREFIX_VEX_0F46, PREFIX_VEX_0F47, PREFIX_VEX_0F4B,
	PREFIX_VEX_0F90, PREFIX_VEX_0F91, PREFIX_VEX_0F92, PREFIX_VEX_0F93,
	PREFIX_VEX_0F98, PREFIX_VEX_0F3A30, PREFIX_VEX_0F3A32,
	PREFIX_VEX_0F3AF0, PREFIX_EVEX_0F10, PREFIX_EVEX_0F11,
	PREFIX_EVEX_0F12, PREFIX_EVEX_0F13, PREFIX_EVEX_0F14,
	PREFIX_EVEX_0F15, PREFIX_EVEX_0F16, PREFIX_EVEX_0F17,
	PREFIX_EVEX_0F28, PREFIX_EVEX_0F29, PREFIX_EVEX_0F2A,
	PREFIX_EVEX_0F2B, PREFIX_EVEX_0F2C, PREFIX_EVEX_0F2D,
	PREFIX_EVEX_0F2E, PREFIX_EVEX_0F2F, PREFIX_EVEX_0F51,
	PREFIX_EVEX_0F58, PREFIX_EVEX_0F59, PREFIX_EVEX_0F5A,
	PREFIX_EVEX_0F5B, PREFIX_EVEX_0F5C, PREFIX_EVEX_0F5D,
	PREFIX_EVEX_0F5E, PREFIX_EVEX_0F5F, PREFIX_EVEX_0F62,
	PREFIX_EVEX_0F66, PREFIX_EVEX_0F6A, PREFIX_EVEX_0F6C,
	PREFIX_EVEX_0F6D, PREFIX_EVEX_0F6E, PREFIX_EVEX_0F6F,
	PREFIX_EVEX_0F70, PREFIX_EVEX_0F72_REG_0, PREFIX_EVEX_0F72_REG_1,
	PREFIX_EVEX_0F72_REG_2, PREFIX_EVEX_0F72_REG_4,
	PREFIX_EVEX_0F72_REG_6, PREFIX_EVEX_0F73_REG_2,
	PREFIX_EVEX_0F73_REG_6, PREFIX_EVEX_0F76, PREFIX_EVEX_0F78,
	PREFIX_EVEX_0F79, PREFIX_EVEX_0F7A, PREFIX_EVEX_0F7B,
	PREFIX_EVEX_0F7E, PREFIX_EVEX_0F7F, PREFIX_EVEX_0FC2,
	PREFIX_EVEX_0FC6, PREFIX_EVEX_0FD2, PREFIX_EVEX_0FD3,
	PREFIX_EVEX_0FD4, PREFIX_EVEX_0FD6, PREFIX_EVEX_0FDB,
	PREFIX_EVEX_0FDF, PREFIX_EVEX_0FE2, PREFIX_EVEX_0FE6 PREFIX_EVEX_0FE7,
	PREFIX_EVEX_0FEB, PREFIX_EVEX_0FEF, PREFIX_EVEX_0FF2,
	PREFIX_EVEX_0FF3, PREFIX_EVEX_0FF4, PREFIX_EVEX_0FFA, PREFIX_EVEX_0FFB,
	PREFIX_EVEX_0FFE, PREFIX_EVEX_0F380C, PREFIX_EVEX_0F380D,
	PREFIX_EVEX_0F3811, PREFIX_EVEX_0F3812, PREFIX_EVEX_0F3813,
	PREFIX_EVEX_0F3814, PREFIX_EVEX_0F3815, PREFIX_EVEX_0F3816,
	PREFIX_EVEX_0F3818, PREFIX_EVEX_0F3819, PREFIX_EVEX_0F381A,
	PREFIX_EVEX_0F381B, PREFIX_EVEX_0F381E, PREFIX_EVEX_0F381F,
	PREFIX_EVEX_0F3821, PREFIX_EVEX_0F3822, PREFIX_EVEX_0F3823,
	PREFIX_EVEX_0F3824, PREFIX_EVEX_0F3825, PREFIX_EVEX_0F3827,
	PREFIX_EVEX_0F3828, PREFIX_EVEX_0F3829, PREFIX_EVEX_0F382A,
	PREFIX_EVEX_0F382C, PREFIX_EVEX_0F382D, PREFIX_EVEX_0F3831,
	PREFIX_EVEX_0F3832, PREFIX_EVEX_0F3833, PREFIX_EVEX_0F3834,
	PREFIX_EVEX_0F3835, PREFIX_EVEX_0F3836, PREFIX_EVEX_0F3837,
	PREFIX_EVEX_0F3839, PREFIX_EVEX_0F383A, PREFIX_EVEX_0F383B,
	PREFIX_EVEX_0F383D, PREFIX_EVEX_0F383F, PREFIX_EVEX_0F3840,
	PREFIX_EVEX_0F3842, PREFIX_EVEX_0F3843, PREFIX_EVEX_0F3844,
	PREFIX_EVEX_0F3845, PREFIX_EVEX_0F3846, PREFIX_EVEX_0F3847,
	PREFIX_EVEX_0F384C, PREFIX_EVEX_0F384D, PREFIX_EVEX_0F384E,
	PREFIX_EVEX_0F384F, PREFIX_EVEX_0F3858, PREFIX_EVEX_0F3859,
	PREFIX_EVEX_0F385A, PREFIX_EVEX_0F385B, PREFIX_EVEX_0F3864,
	PREFIX_EVEX_0F3865, PREFIX_EVEX_0F3876, PREFIX_EVEX_0F3877,
	PREFIX_EVEX_0F387C, PREFIX_EVEX_0F387E, PREFIX_EVEX_0F387F,
	PREFIX_EVEX_0F3888, PREFIX_EVEX_0F3889, PREFIX_EVEX_0F388A,
	PREFIX_EVEX_0F388B, PREFIX_EVEX_0F3890, PREFIX_EVEX_0F3891,
	PREFIX_EVEX_0F3892, PREFIX_EVEX_0F3893, PREFIX_EVEX_0F3896,
	PREFIX_EVEX_0F3897, PREFIX_EVEX_0F3898, PREFIX_EVEX_0F3899,
	PREFIX_EVEX_0F389A, PREFIX_EVEX_0F389B, PREFIX_EVEX_0F389C,
	PREFIX_EVEX_0F389D, PREFIX_EVEX_0F389E, PREFIX_EVEX_0F389F,
	PREFIX_EVEX_0F38A0, PREFIX_EVEX_0F38A1, PREFIX_EVEX_0F38A2,
	PREFIX_EVEX_0F38A3, PREFIX_EVEX_0F38A6, PREFIX_EVEX_0F38A7,
	PREFIX_EVEX_0F38A8, PREFIX_EVEX_0F38A9, PREFIX_EVEX_0F38AA,
	PREFIX_EVEX_0F38AB, PREFIX_EVEX_0F38AC, PREFIX_EVEX_0F38AD,
	PREFIX_EVEX_0F38AE, PREFIX_EVEX_0F38AF, PREFIX_EVEX_0F38B6,
	PREFIX_EVEX_0F38B7, PREFIX_EVEX_0F38B8, PREFIX_EVEX_0F38B9,
	PREFIX_EVEX_0F38BA, PREFIX_EVEX_0F38BB, PREFIX_EVEX_0F38BC,
	PREFIX_EVEX_0F38BD, PREFIX_EVEX_0F38BE, PREFIX_EVEX_0F38BF,
	PREFIX_EVEX_0F38C4, PREFIX_EVEX_0F38C6_REG_1,
	PREFIX_EVEX_0F38C6_REG_2, PREFIX_EVEX_0F38C6_REG_5,
	PREFIX_EVEX_0F38C6_REG_6, PREFIX_EVEX_0F38C7_REG_1,
	PREFIX_EVEX_0F38C7_REG_2, PREFIX_EVEX_0F38C7_REG_5,
	PREFIX_EVEX_0F38C7_REG_6, PREFIX_EVEX_0F38C8, PREFIX_EVEX_0F38CA,
	PREFIX_EVEX_0F38CB, PREFIX_EVEX_0F38CC, PREFIX_EVEX_0F38CD,
	PREFIX_EVEX_0F3A00,  PREFIX_EVEX_0F3A01, PREFIX_EVEX_0F3A03,
	PREFIX_EVEX_0F3A04, PREFIX_EVEX_0F3A05, PREFIX_EVEX_0F3A08,
	PREFIX_EVEX_0F3A09, PREFIX_EVEX_0F3A0A, PREFIX_EVEX_0F3A0B,
	PREFIX_EVEX_0F3A17, PREFIX_EVEX_0F3A18, PREFIX_EVEX_0F3A19,
	PREFIX_EVEX_0F3A1A, PREFIX_EVEX_0F3A1B, PREFIX_EVEX_0F3A1D,
	PREFIX_EVEX_0F3A1E, PREFIX_EVEX_0F3A1F, PREFIX_EVEX_0F3A21,
	PREFIX_EVEX_0F3A23, PREFIX_EVEX_0F3A25, PREFIX_EVEX_0F3A26,
	PREFIX_EVEX_0F3A27, PREFIX_EVEX_0F3A38, PREFIX_EVEX_0F3A39,
	PREFIX_EVEX_0F3A3A, PREFIX_EVEX_0F3A3B, PREFIX_EVEX_0F3A3E,
	PREFIX_EVEX_0F3A3F, PREFIX_EVEX_0F3A43, PREFIX_EVEX_0F3A54,
	PREFIX_EVEX_0F3A55.
	(VEX_LEN enum): Add VEX_LEN_0F41_P_0, VEX_LEN_0F42_P_0, VEX_LEN_0F44_P_0,
	VEX_LEN_0F45_P_0, VEX_LEN_0F46_P_0, VEX_LEN_0F47_P_0,
	VEX_LEN_0F4B_P_2, VEX_LEN_0F90_P_0, VEX_LEN_0F91_P_0,
	VEX_LEN_0F92_P_0, VEX_LEN_0F93_P_0, VEX_LEN_0F98_P_0,
	VEX_LEN_0F3A30_P_2, VEX_LEN_0F3A32_P_2, VEX_W_0F41_P_0_LEN_1,
	VEX_W_0F42_P_0_LEN_1, VEX_W_0F44_P_0_LEN_0, VEX_W_0F45_P_0_LEN_1,
	VEX_W_0F46_P_0_LEN_1, VEX_W_0F47_P_0_LEN_1, VEX_W_0F4B_P_2_LEN_1,
	VEX_W_0F90_P_0_LEN_0, VEX_W_0F91_P_0_LEN_0, VEX_W_0F92_P_0_LEN_0,
	VEX_W_0F93_P_0_LEN_0, VEX_W_0F98_P_0_LEN_0, VEX_W_0F3A30_P_2_LEN_0,
	VEX_W_0F3A32_P_2_LEN_0.
	(VEX_W enum): Add EVEX_W_0F10_P_0, EVEX_W_0F10_P_1_M_0,
	EVEX_W_0F10_P_1_M_1, EVEX_W_0F10_P_2, EVEX_W_0F10_P_3_M_0,
	EVEX_W_0F10_P_3_M_1, EVEX_W_0F11_P_0, EVEX_W_0F11_P_1_M_0,
	EVEX_W_0F11_P_1_M_1, EVEX_W_0F11_P_2, EVEX_W_0F11_P_3_M_0,
	EVEX_W_0F11_P_3_M_1, EVEX_W_0F12_P_0_M_0, EVEX_W_0F12_P_0_M_1,
	EVEX_W_0F12_P_1, EVEX_W_0F12_P_2, EVEX_W_0F12_P_3, EVEX_W_0F13_P_0,
	EVEX_W_0F13_P_2, EVEX_W_0F14_P_0, EVEX_W_0F14_P_2, EVEX_W_0F15_P_0,
	EVEX_W_0F15_P_2, EVEX_W_0F16_P_0_M_0, EVEX_W_0F16_P_0_M_1,
	EVEX_W_0F16_P_1, EVEX_W_0F16_P_2, EVEX_W_0F17_P_0, EVEX_W_0F17_P_2,
	EVEX_W_0F28_P_0, EVEX_W_0F28_P_2, EVEX_W_0F29_P_0, EVEX_W_0F29_P_2,
	EVEX_W_0F2A_P_1, EVEX_W_0F2A_P_3, EVEX_W_0F2B_P_0, EVEX_W_0F2B_P_2,
	EVEX_W_0F2E_P_0, EVEX_W_0F2E_P_2, EVEX_W_0F2F_P_0, EVEX_W_0F2F_P_2,
	EVEX_W_0F51_P_0, EVEX_W_0F51_P_1, EVEX_W_0F51_P_2, EVEX_W_0F51_P_3,
	EVEX_W_0F58_P_0, EVEX_W_0F58_P_1, EVEX_W_0F58_P_2, EVEX_W_0F58_P_3,
	EVEX_W_0F59_P_0, EVEX_W_0F59_P_1, EVEX_W_0F59_P_2, EVEX_W_0F59_P_3,
	EVEX_W_0F5A_P_0, EVEX_W_0F5A_P_1, EVEX_W_0F5A_P_2, EVEX_W_0F5A_P_3,
	EVEX_W_0F5B_P_0, EVEX_W_0F5B_P_1, EVEX_W_0F5B_P_2, EVEX_W_0F5C_P_0,
	EVEX_W_0F5C_P_1, EVEX_W_0F5C_P_2, EVEX_W_0F5C_P_3, EVEX_W_0F5D_P_0,
	EVEX_W_0F5D_P_1, EVEX_W_0F5D_P_2, EVEX_W_0F5D_P_3, EVEX_W_0F5E_P_0,
	EVEX_W_0F5E_P_1, EVEX_W_0F5E_P_2, EVEX_W_0F5E_P_3, EVEX_W_0F5F_P_0,
	EVEX_W_0F5F_P_1, EVEX_W_0F5F_P_2, EVEX_W_0F5F_P_3, EVEX_W_0F62_P_2,
	EVEX_W_0F66_P_2, EVEX_W_0F6A_P_2, EVEX_W_0F6C_P_2, EVEX_W_0F6D_P_2,
	EVEX_W_0F6E_P_2, EVEX_W_0F6F_P_1, EVEX_W_0F6F_P_2, EVEX_W_0F70_P_2,
	EVEX_W_0F72_R_2_P_2, EVEX_W_0F72_R_6_P_2, EVEX_W_0F73_R_2_P_2,
	EVEX_W_0F73_R_6_P_2, EVEX_W_0F76_P_2, EVEX_W_0F78_P_0,
	EVEX_W_0F79_P_0, EVEX_W_0F7A_P_1, EVEX_W_0F7A_P_3, EVEX_W_0F7B_P_1,
	EVEX_W_0F7B_P_3, EVEX_W_0F7E_P_1, EVEX_W_0F7E_P_2, EVEX_W_0F7F_P_1,
	EVEX_W_0F7F_P_2, EVEX_W_0FC2_P_0, EVEX_W_0FC2_P_1, EVEX_W_0FC2_P_2,
	EVEX_W_0FC2_P_3, EVEX_W_0FC6_P_0, EVEX_W_0FC6_P_2, EVEX_W_0FD2_P_2,
	EVEX_W_0FD3_P_2, EVEX_W_0FD4_P_2, EVEX_W_0FD6_P_2, EVEX_W_0FE6_P_1,
	EVEX_W_0FE6_P_2, EVEX_W_0FE6_P_3, EVEX_W_0FE7_P_2, EVEX_W_0FF2_P_2,
	EVEX_W_0FF3_P_2, EVEX_W_0FF4_P_2, EVEX_W_0FFA_P_2, EVEX_W_0FFB_P_2,
	EVEX_W_0FFE_P_2, EVEX_W_0F380C_P_2, EVEX_W_0F380D_P_2,
	EVEX_W_0F3811_P_1, EVEX_W_0F3812_P_1, EVEX_W_0F3813_P_1,
	EVEX_W_0F3813_P_2, EVEX_W_0F3814_P_1, EVEX_W_0F3815_P_1,
	EVEX_W_0F3818_P_2, EVEX_W_0F3819_P_2, EVEX_W_0F381A_P_2,
	EVEX_W_0F381B_P_2, EVEX_W_0F381E_P_2, EVEX_W_0F381F_P_2,
	EVEX_W_0F3821_P_1, EVEX_W_0F3822_P_1, EVEX_W_0F3823_P_1,
	EVEX_W_0F3824_P_1, EVEX_W_0F3825_P_1, EVEX_W_0F3825_P_2,
	EVEX_W_0F3828_P_2, EVEX_W_0F3829_P_2, EVEX_W_0F382A_P_1,
	EVEX_W_0F382A_P_2, EVEX_W_0F3831_P_1, EVEX_W_0F3832_P_1,
	EVEX_W_0F3833_P_1, EVEX_W_0F3834_P_1, EVEX_W_0F3835_P_1,
	EVEX_W_0F3835_P_2, EVEX_W_0F3837_P_2, EVEX_W_0F383A_P_1,
	EVEX_W_0F3840_P_2, EVEX_W_0F3858_P_2, EVEX_W_0F3859_P_2,
	EVEX_W_0F385A_P_2, EVEX_W_0F385B_P_2, EVEX_W_0F3891_P_2,
	EVEX_W_0F3893_P_2, EVEX_W_0F38A1_P_2, EVEX_W_0F38A3_P_2,
	EVEX_W_0F38C7_R_1_P_2, EVEX_W_0F38C7_R_2_P_2, EVEX_W_0F38C7_R_5_P_2,
	EVEX_W_0F38C7_R_6_P_2, EVEX_W_0F3A00_P_2, EVEX_W_0F3A01_P_2,
	EVEX_W_0F3A04_P_2, EVEX_W_0F3A05_P_2, EVEX_W_0F3A08_P_2,
	EVEX_W_0F3A09_P_2, EVEX_W_0F3A0A_P_2, EVEX_W_0F3A0B_P_2,
	EVEX_W_0F3A18_P_2, EVEX_W_0F3A19_P_2, EVEX_W_0F3A1A_P_2,
	EVEX_W_0F3A1B_P_2, EVEX_W_0F3A1D_P_2, EVEX_W_0F3A21_P_2,
	EVEX_W_0F3A23_P_2, EVEX_W_0F3A38_P_2, EVEX_W_0F3A39_P_2,
	EVEX_W_0F3A3A_P_2, EVEX_W_0F3A3B_P_2, EVEX_W_0F3A43_P_2.
	(struct vex): Add fields evex, r, v, mask_register_specifier,
	zeroing, ll, b.
	(intel_names_xmm): Add upper 16 registers.
	(att_names_xmm): Ditto.
	(intel_names_ymm): Ditto.
	(att_names_ymm): Ditto.
	(names_zmm): New.
	(intel_names_zmm): Ditto.
	(att_names_zmm): Ditto.
	(names_mask): Ditto.
	(intel_names_mask): Ditto.
	(att_names_mask): Ditto.
	(names_rounding): Ditto.
	(names_broadcast): Ditto.
	(x86_64_table): Add escape to evex-table.
	(reg_table): Include reg_table evex-entries from
	i386-dis-evex.h.  Fix prefetchwt1 instruction.
	(prefix_table): Add entries for new instructions.
	(vex_table): Ditto.
	(vex_len_table): Ditto.
	(vex_w_table): Ditto.
	(mod_table): Ditto.
	(get_valid_dis386): Properly handle new instructions.
	(print_insn): Handle zmm and mask registers, print mask operand.
	(intel_operand_size): Support EVEX, new modes and sizes.
	(OP_E_register): Handle new modes.
	(OP_E_memory): Ditto.
	(OP_G): Ditto.
	(OP_XMM): Ditto.
	(OP_EX): Ditto.
	(OP_VEX): Ditto.
	* i386-gen.c (cpu_flag_init): Update CPU_ANY_SSE_FLAGS and
	CPU_ANY_AVX_FLAGS.  Add CPU_AVX512F_FLAGS, CPU_AVX512CD_FLAGS,
	CPU_AVX512ER_FLAGS and CPU_AVX512PF_FLAGS.
	(cpu_flags): Add CpuAVX512F, CpuAVX512CD, CpuAVX512ER,
	CpuAVX512PF and CpuVREX.
	(operand_type_init): Add OPERAND_TYPE_REGZMM,
	OPERAND_TYPE_REGMASK and OPERAND_TYPE_VEC_DISP8.
	(opcode_modifiers): Add EVex, Masking, VecESize, Broadcast,
	StaticRounding, SAE, Disp8MemShift, NoDefMask.
	(operand_types): Add RegZMM, RegMask, Vec_Disp8, Zmmword.
	* i386-init.h: Regenerate.
	* i386-opc.h (CpuAVX512F): New.
	(CpuAVX512CD): New.
	(CpuAVX512ER): New.
	(CpuAVX512PF): New.
	(CpuVREX): New.
	(i386_cpu_flags): Add cpuavx512f, cpuavx512cd, cpuavx512er,
	cpuavx512pf and cpuvrex fields.
	(VecSIB): Add VecSIB512.
	(EVex): New.
	(Masking): New.
	(VecESize): New.
	(Broadcast): New.
	(StaticRounding): New.
	(SAE): New.
	(Disp8MemShift): New.
	(NoDefMask): New.
	(i386_opcode_modifier): Add evex, masking, vecesize, broadcast,
	staticrounding, sae, disp8memshift and nodefmask.
	(RegZMM): New.
	(Zmmword): Ditto.
	(Vec_Disp8): Ditto.
	(i386_operand_type): Add regzmm, regmask, zmmword and vec_disp8
	fields.
	(RegVRex): New.
	* i386-opc.tbl: Add AVX512 instructions.
	* i386-reg.tbl: Add 16 upper XMM and YMM registers, 32 new ZMM
	registers, mask registers.
	* i386-tbl.h: Regenerate.
@
text
@a1471 2
  PREFIX_EVEX_0F3A3E,
  PREFIX_EVEX_0F3A3F,
@


1.278
log
@Support Intel SHA

gas/

2013-07-25  Michael Zolotukhin  <michael.v.zolotukhin@@intel.com>

	* config/tc-i386.c (cpu_arch): Add .sha.
	* doc/c-i386.texi: Document sha/.sha.

gas/testsuite/

2013-07-25  Michael Zolotukhin  <michael.v.zolotukhin@@intel.com>

	* gas/i386/sha.d: New.
	* gas/i386/sha.s: New.
	* gas/i386/x86-64-sha.d: New.
	* gas/i386/x86-64-sha.s: New.
	* gas/i386/i386.exp: Run new SHA tests.

opcodes/

2013-07-25  Michael Zolotukhin  <michael.v.zolotukhin@@intel.com>

	* i386-dis.c (PREFIX enum): Add PREFIX_0F38C8, PREFIX_0F38C9,
	PREFIX_0F38CA, PREFIX_0F38CB, PREFIX_0F38CC, PREFIX_0F38CD,
	PREFIX_0F3ACC.
	(prefix_table): Updated.
	(three_byte_table): Likewise.
	* i386-gen.c (cpu_flag_init): Add CPU_SHA_FLAGS.
	(cpu_flags): Add CpuSHA.
	(i386_cpu_flags): Add cpusha.
	* i386-init.h: Regenerate.
	* i386-opc.h (CpuSHA): New.
	(CpuUnused): Restored.
	(i386_cpu_flags): Add cpusha.
	* i386-opc.tbl: Add SHA instructions.
	* i386-tbl.h: Regenerate.
@
text
@d97 1
d103 1
d128 2
d263 1
d353 1
d362 1
d370 1
d372 1
d377 1
d383 2
d420 10
d486 2
a487 1
  /* 16-byte XMM or 32-byte YMM operand */
d489 6
a494 1
  /* 16-byte XMM or 32-byte YMM operand with operand swapped */
d498 3
a500 1
  /* 16-byte XMM or quad word operand */
d502 2
d512 4
a515 1
  /* 16-byte XMM, word or double word operand  */
d517 1
a517 1
  /* 16-byte XMM, double word or quad word operand */
d519 3
a521 1
  /* 32-byte YMM or quad word operand */
d579 8
d647 2
a648 1
  USE_VEX_W_TABLE
d665 1
d705 6
a710 1
  REG_XOP_TBM_02
d809 15
d978 7
d1031 5
d1223 2
d1262 215
a1476 1
  PREFIX_VEX_0F3AF0
d1534 7
d1563 7
d1591 5
d1641 2
d1704 7
d1790 5
d1940 2
d1958 188
a2145 1
  VEX_W_0F3ADF_P_2
d2880 7
d2994 5
a2998 1
  "xmm12", "xmm13", "xmm14", "xmm15"
d3004 5
a3008 1
  "%xmm12", "%xmm13", "%xmm14", "%xmm15"
d3016 5
a3020 1
  "ymm12", "ymm13", "ymm14", "ymm15"
d3026 43
a3068 1
  "%ymm12", "%ymm13", "%ymm14", "%ymm15"
d3266 1
a3266 1
    { "prefetch",	{ Mb } },
d3439 3
d4410 37
d4776 25
d6110 14
d6392 4
d6467 1
d8381 2
d8384 4
a8387 6
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
d8392 1
a8392 1
    { Bad_Opcode },
d8470 4
a8473 4
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
d8479 1
a8479 1
    { Bad_Opcode },
d8944 1
d8946 1
a8946 2
    { Bad_Opcode },
    { Bad_Opcode },
d9180 3
d9308 35
d9469 25
d9734 10
d10009 28
d10353 20
d10955 10
d11034 3
d11326 1
d11472 3
d12054 1
d12119 1
d12173 104
d12407 1
d12410 1
d12429 1
d12432 1
d12584 1
d12603 14
d13775 11
d13865 2
d13877 3
d13890 3
d13894 1
d13906 3
d13921 1
d13936 1
d13951 1
d13966 1
d13985 3
d14004 3
d14023 3
d14047 1
a14049 2
    case vex_vsib_d_w_dq_mode:
    case vex_vsib_q_w_dq_mode:
d14058 29
d14160 3
d14178 98
d14317 5
d14335 6
d14371 2
d14565 9
d14640 3
d15315 6
d15323 3
d15339 3
d15346 18
d15460 6
d15483 1
d15485 2
d15501 3
d15508 18
d16020 6
d16048 3
d16066 3
d16074 3
d16479 47
d16647 38
@


1.277
log
@Support Intel MPX

gas/

2013-07-24  Anna Tikhonova  <anna.tikhonova@@intel.com>
	    Kirill Yukhin  <kirill.yukhin@@intel.com>
	    Michael Zolotukhin  <michael.v.zolotukhin@@intel.com>

	* config/tc-i386.c (BND_PREFIX): New.
	(struct _i386_insn): Add new field bnd_prefix.
	(add_bnd_prefix): New.
	(cpu_arch): Add MPX.
	(i386_operand_type): Add regbnd.
	(md_assemble): Handle BND prefixes.
	(parse_insn): Likewise.
	(output_branch): Likewise.
	(output_jump): Likewise.
	(build_modrm_byte): Handle regbnd.
	(OPTION_MADD_BND_PREFIX): New.
	(md_longopts): Add entry for 'madd-bnd-prefix'.
	(md_parse_option): Handle madd-bnd-prefix option.
	(md_show_usage): Add description for madd-bnd-prefix
	option.
	* doc/c-i386.texi: Document mpx/.mpx and -madd-bnd-prefix.

gas/testsuite/

2013-07-24  Anna Tikhonova  <anna.tikhonova@@intel.com>
	    Kirill Yukhin  <kirill.yukhin@@intel.com>
	    Michael Zolotukhin  <michael.v.zolotukhin@@intel.com>

	* gas/i386/mpx-add-bnd-prefix.s: New.
	* gas/i386/mpx-add-bnd-prefix.d: New.
	* gas/i386/mpx-inval-1.l: New.
	* gas/i386/mpx-inval-1.s: New.
	* gas/i386/mpx.d: New.
	* gas/i386/mpx.s: New.
	* gas/i386/x86-64-mpx-add-bnd-prefix.d: New.
	* gas/i386/x86-64-mpx-add-bnd-prefix.s: New.
	* gas/i386/x86-64-mpx-addr32.d: New.
	* gas/i386/x86-64-mpx-addr32.s: New.
	* gas/i386/x86-64-mpx-inval-1.l: New.
	* gas/i386/x86-64-mpx-inval-1.s: New.
	* gas/i386/x86-64-mpx-inval-2.l: New.
	* gas/i386/x86-64-mpx-inval-2.s: New.
	* gas/i386/x86-64-mpx.d: New.
	* gas/i386/x86-64-mpx.s: New.
	* gas/i386/nops.d: Adjust to MPX changes.
	* gas/i386/nops.s: Likewise.
	* gas/i386/x86-64-nops.d: Likewise.
	* gas/i386/x86-64-nops.s: Likewise.
	* gas/i386/ilp32/x86-64-nops.d: Likewise.
	* gas/i386/i386.exp: Run new MPX tests.

include/opcode/

2013-07-24  Anna Tikhonova  <anna.tikhonova@@intel.com>
	    Kirill Yukhin  <kirill.yukhin@@intel.com>
	    Michael Zolotukhin  <michael.v.zolotukhin@@intel.com>

	* i386.h (BND_PREFIX_OPCODE): New.

opcodes/

2013-07-24  Anna Tikhonova  <anna.tikhonova@@intel.com>
	    Kirill Yukhin  <kirill.yukhin@@intel.com>
	    Michael Zolotukhin  <michael.v.zolotukhin@@intel.com>

	* i386-dis.c (BND_Fixup): New.
	(Ebnd): New.
	(Ev_bnd): New.
	(Gbnd): New.
	(BND): New.
	(v_bnd_mode): New.
	(bnd_mode): New.
	(MOD enum): Add new entries.
	(PREFIX enum): Likewise.
	(dis tables): Replace XX with BND for near branch and call
	instructions.
	(prefix_table): Add new entries.
	(mod_table): Likewise.
	(names_bnd): New.
	(intel_names_bnd): New.
	(att_names_bnd): New.
	(BND_PREFIX): New.
	(prefix_name): Handle BND_PREFIX.
	(print_insn): Initialize names_bnd.
	(intel_operand_size): Handle new modes.
	(OP_E_register): Likewise.
	(OP_E_memory): Likewise.
	(OP_G): Likewise.
	* i386-gen.c (cpu_flag_init): Add CpuMPX.
	(cpu_flags): Add CpuMPX.
	(operand_type_init): Add RegBND.
	(opcode_modifiers): Add BNDPrefixOk.
	(operand_types): Add RegBND.
	* i386-init.h: Regenerate.
	* i386-opc.h (CpuMPX): New.
	(CpuUnused): Comment out.
	(i386_cpu_flags): Add cpumpx.
	(BNDPrefixOk): New.
	(i386_opcode_modifier): Add bndprefixok.
	(RegBND): New.
	(i386_operand_type): Add regbnd.
	* i386-opc.tbl: Add BNDPrefixOk to near jumps, calls and rets.
	Add MPX instructions and bnd prefix.
	* i386-reg.tbl: Add bnd0-bnd3 registers.
	* i386-tbl.h: Regenerate.
@
text
@d864 6
d900 1
d3505 30
d3748 5
d6118 6
a6123 6
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
d6413 1
a6413 1
    { Bad_Opcode },
@


1.276
log
@Properly check address mode for SIB

gas/testsuite/

	* gas/i386/addr32.s: Add an SIB test.
	* gas/i386/addr32.d: Updated.

opcodes/

	* i386-dis.c (get_sib): Add the sizeflag argument.  Properly
	check address mode.
	(print_insn): Pass sizeflag to get_sib.
@
text
@d111 1
d226 1
d229 1
d252 1
d430 2
d494 1
d499 1
d683 3
d780 2
d1816 8
a1823 8
  { "joH",		{ Jb, XX, cond_jump_flag } },
  { "jnoH",		{ Jb, XX, cond_jump_flag } },
  { "jbH",		{ Jb, XX, cond_jump_flag } },
  { "jaeH",		{ Jb, XX, cond_jump_flag } },
  { "jeH",		{ Jb, XX, cond_jump_flag } },
  { "jneH",		{ Jb, XX, cond_jump_flag } },
  { "jbeH",		{ Jb, XX, cond_jump_flag } },
  { "jaH",		{ Jb, XX, cond_jump_flag } },
d1825 8
a1832 8
  { "jsH",		{ Jb, XX, cond_jump_flag } },
  { "jnsH",		{ Jb, XX, cond_jump_flag } },
  { "jpH",		{ Jb, XX, cond_jump_flag } },
  { "jnpH",		{ Jb, XX, cond_jump_flag } },
  { "jlH",		{ Jb, XX, cond_jump_flag } },
  { "jgeH",		{ Jb, XX, cond_jump_flag } },
  { "jleH",		{ Jb, XX, cond_jump_flag } },
  { "jgH",		{ Jb, XX, cond_jump_flag } },
d1908 2
a1909 2
  { "retT",		{ Iw } },
  { "retT",		{ XX } },
d1951 2
a1952 2
  { "callT",		{ Jv } },
  { "jmpT",		{ Jv } },
d1954 1
a1954 1
  { "jmp",		{ Jb } },
d2010 2
a2011 2
  { "nopQ",		{ Ev } },
  { "nopQ",		{ Ev } },
d2125 8
a2132 8
  { "joH",		{ Jv, XX, cond_jump_flag } },
  { "jnoH",		{ Jv, XX, cond_jump_flag } },
  { "jbH",		{ Jv, XX, cond_jump_flag } },
  { "jaeH",		{ Jv, XX, cond_jump_flag } },
  { "jeH",		{ Jv, XX, cond_jump_flag } },
  { "jneH",		{ Jv, XX, cond_jump_flag } },
  { "jbeH",		{ Jv, XX, cond_jump_flag } },
  { "jaH",		{ Jv, XX, cond_jump_flag } },
d2134 8
a2141 8
  { "jsH",		{ Jv, XX, cond_jump_flag } },
  { "jnsH",		{ Jv, XX, cond_jump_flag } },
  { "jpH",		{ Jv, XX, cond_jump_flag } },
  { "jnpH",		{ Jv, XX, cond_jump_flag } },
  { "jlH",		{ Jv, XX, cond_jump_flag } },
  { "jgeH",		{ Jv, XX, cond_jump_flag } },
  { "jleH",		{ Jv, XX, cond_jump_flag } },
  { "jgH",		{ Jv, XX, cond_jump_flag } },
d2382 1
d2450 8
d2648 1
a2648 1
    { "call{T|}", { indirEv } },
d2650 1
a2650 1
    { "jmp{T|}", { indirEv } },
d2895 16
d10292 15
d10711 1
d10949 2
d11456 1
d11476 1
d12827 1
d13097 3
d13109 1
d13161 3
d13259 3
a13261 1
      if (havebase || haveindex || riprel)
d13274 1
a13274 1
	    oappend (address_mode == mode_64bit && (sizeflag & AFLAG)
d13291 1
a13291 2
		    oappend (address_mode == mode_64bit
			     && (sizeflag & AFLAG)
d13294 1
a13294 2
		    oappend (address_mode == mode_64bit
			     && (sizeflag & AFLAG)
d13460 3
d14593 10
@


1.275
log
@Implement Intel SMAP instructions

gas/

	PR gas/15159
	* config/tc-i386.c (cpu_arch): Add ".smap".

	* doc/c-i386.texi: Document smap.

gas/testsuite/

	PR gas/15159
	* gas/i386/i386.exp: Run smap and x86-64-smap.

	* gas/i386/smap.d: New file.
	* gas/i386/smap.s: likewise.
	* gas/i386/x86-64-smap.d: likewise.

opcodes/

	PR gas/15159
	* i386-dis.c (rm_table): Add clac and stac to RM_0F01_REG_1.

	* i386-gen.c (cpu_flag_init): Add CPU_SMAP_FLAGS.
	(cpu_flags): Add CpuSMAP.

	* i386-opc.h (CpuSMAP): New.
	(i386_cpu_flags): Add cpusmap.

	* i386-opc.tbl: Add clac and stac.

	* i386-init.h: Regenerated.
	* i386-tbl.h: Likewise.
@
text
@d11288 1
a11288 1
get_sib (disassemble_info *info)
d11292 1
a11292 1
      && address_mode != mode_16bit
d11577 1
a11577 1
      get_sib (info);
d11585 1
a11585 1
	  get_sib (info);
@


1.274
log
@gas/testsuite/
	* gas/i386/rex.s: Add test of REX prefix before fsave (i.e. fwait).
	* gas/i386/rex.d: Update.

opcodes/
	* i386-dis.c (ckprefix): When bailing out for fwait with prefixes,
	set rex_used to rex.
@
text
@d10603 2
@


1.273
log
@gas/testsuite/
	* gas/i386/prefetch.s: New file.
	* gas/i386/prefetch.d: New file.
	* gas/i386/prefetch-intel.d: New file.
	* gas/i386/x86-64-prefetch.d: New file.
	* gas/i386/x86-64-prefetch-intel.d: New file.
	* gas/i386/i386.exp: Run them.

opcodes/
	* i386-dis.c (reg_table): Fill out REG_0F0D table with
	AMD-reserved cases as "prefetch".
	(MOD_0F18_REG_4, MOD_0F18_REG_5): New enum constants.
	(MOD_0F18_REG_6, MOD_0F18_REG_7): Likewise.
	(reg_table): Use those under REG_0F18.
	(mod_table): Add those cases as "nop/reserved".
@
text
@d10759 3
d11487 1
a11487 1
                               i == 0 ? "" : " ",
d11582 1
a11582 1
        {
d11665 1
a11665 1
        op_txt[i] = op_out[i];
d11669 3
a11671 3
          op_ad = op_index[i];
          op_index[i] = op_index[MAX_OPERANDS - 1 - i];
          op_index[MAX_OPERANDS - 1 - i] = op_ad;
d11680 1
a11680 1
        op_txt[MAX_OPERANDS - 1 - i] = op_out[i];
d12351 1
a12351 1
              && ((sizeflag & DFLAG) || (rex & REX_W)))
d12424 1
a12424 1
                  && ((sizeflag & DFLAG) || (rex & REX_W)))
d13540 1
a13540 1
          && ((sizeflag & DFLAG) || (rex & REX_W)))
d13671 1
a13671 1
        oappend ("1");
d13757 2
a13758 2
              /* The operand-size prefix is overridden by a REX prefix.  */
              if ((sizeflag & DFLAG) || (rex & REX_W))
d14124 1
a14124 1
 	}
d14163 1
a14163 1
 	}
d14782 1
a14782 1
        {
d14784 1
a14784 1
          int base = modrm.rm;
d14787 36
a14822 36
          if (base == 4)
            {
              FETCH_DATA (the_info, codep + 1);
              base = *codep & 7;
              /* When decoding the third source, don't increase
                 bytes_before_imm as this has already been incremented
                 by one in OP_E_memory while decoding the second
                 source operand.  */
              if (opnum == 0)
                bytes_before_imm++;
            }

          /* Don't increase bytes_before_imm when decoding the third source,
             it has already been incremented by OP_E_memory while decoding
             the second source operand.  */
          if (opnum == 0)
            {
              switch (modrm.mod)
                {
                  case 0:
                    /* When modrm.rm == 5 or modrm.rm == 4 and base in
                       SIB == 5, there is a 4 byte displacement.  */
                    if (base != 5)
                      /* No displacement. */
                      break;
                  case 2:
                    /* 4 byte displacement.  */
                    bytes_before_imm += 4;
                    break;
                  case 1:
                    /* 1 byte displacement.  */
                    bytes_before_imm++;
                    break;
                }
            }
        }
d14826 5
a14830 5
          /* Don't increase bytes_before_imm when decoding the third source,
             it has already been incremented by OP_E_memory while decoding
             the second source operand.  */
          if (opnum == 0)
            {
@


1.272
log
@gas/testsuite/
	* gas/i386/x86-64-stack.s: Add cases for push segment register.
	* gas/i386/x86-64-stack.d: Updated.
	* gas/i386/x86-64-stack-suffix.d: Updated.
	* gas/i386/x86-64-stack-intel.d: Updated.
	* gas/i386/ilp32/x86-64-stack.d: Updated.
	* gas/i386/ilp32/x86-64-stack-suffix.d: Updated.
	* gas/i386/ilp32/x86-64-stack-intel.d: Updated.

opcodes/
	* i386-dis.c (print_insn): Print spaces between multiple excess
	prefixes.  Return actual number of excess prefixes consumed,
	not always one.

	* i386-dis.c (OP_REG): Ignore REX_B for segment register cases.
@
text
@d671 4
d2659 6
d2672 4
d10238 16
@


1.271
log
@gas/testsuite/
	* gas/i386/x86-64-stack.s: Add cases for push immediate.
	* gas/testsuite/gas/i386/ilp32/x86-64-stack-intel.d: Updated.
	* gas/testsuite/gas/i386/ilp32/x86-64-stack-suffix.d: Updated.
	* gas/testsuite/gas/i386/ilp32/x86-64-stack.d: Updated.
	* gas/testsuite/gas/i386/x86-64-stack-intel.d: Updated.
	* gas/testsuite/gas/i386/x86-64-stack-suffix.d: Updated.
	* gas/testsuite/gas/i386/x86-64-stack.d: Updated.

opcodes/
	* i386-dis.c (OP_sI): In b_T_mode and v_mode, REX_W trumps DFLAG.
	(putop): For 'T', 'U', and 'V', treat REX_W like DFLAG.
	(intel_operand_size): For stack_v_mode, treat REX_W like DFLAG.
	(OP_E_register): Likewise.
	(OP_REG): For low 8 whole registers, treat REX_W like DFLAG.
@
text
@d11453 2
a11454 1
	(*info->fprintf_func) (info->stream, "%s",
d11456 1
a11456 1
      return 1;
d13475 9
a13495 4
    case es_reg: case ss_reg: case cs_reg:
    case ds_reg: case fs_reg: case gs_reg:
      s = names_seg[code - es_reg + add];
      break;
@


1.270
log
@Use vex_len_table in xop_table

	PR binutils/14355
	* i386-dis.c (VEX_LEN_0FXOP_08_CC): New.
	(VEX_LEN_0FXOP_08_CD): Likewise.
	(VEX_LEN_0FXOP_08_CE): Likewise.
	(VEX_LEN_0FXOP_08_CF): Likewise.
	(VEX_LEN_0FXOP_08_EC): Likewise.
	(VEX_LEN_0FXOP_08_ED): Likewise.
	(VEX_LEN_0FXOP_08_EE): Likewise.
	(VEX_LEN_0FXOP_08_EF): Likewise.
	(xop_table): Fix entries for vpcomb, vpcomw, vpcomd, vpcomq,
	vpcomub, vpcomuw, vpcomud, vpcomuq.
	(vex_len_table): Add entries for VEX_LEN_0FXOP_08_CC,
	VEX_LEN_0FXOP_08_CD, VEX_LEN_0FXOP_08_CE, VEX_LEN_0FXOP_08_CF,
	VEX_LEN_0FXOP_08_EC, VEX_LEN_0FXOP_08_ED, VEX_LEN_0FXOP_08_EE,
	VEX_LEN_0FXOP_08_EF.
@
text
@d3 1
a3 1
   2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011
d260 1
a260 1
#define sIv { OP_sI, v_mode } 
d2893 1
a2893 1
    { "ucomiss",{ XM, EXd } }, 
d2895 1
a2895 1
    { "ucomisd",{ XM, EXq } }, 
d3486 1
a3486 1
    { "crc32",	{ Gdq, { CRC32_Fixup, b_mode } } },	
d3494 1
a3494 1
    { "crc32",	{ Gdq, { CRC32_Fixup, v_mode } } },	
d9165 1
a9165 1
    { "vucomiss",	{ XMScalar, EXdScalar } }, 
d9169 1
a9169 1
    { "vucomisd",	{ XMScalar, EXqScalar } }, 
d10245 1
a10245 1
    { Bad_Opcode },    
d10990 1
a10990 1
      else 
d12278 1
a12278 1
	      && (sizeflag & DFLAG))
d12316 2
a12317 1
	  if (address_mode == mode_64bit && (sizeflag & DFLAG))
d12389 2
a12390 1
	      if (address_mode == mode_64bit && (sizeflag & DFLAG))
d12726 1
a12726 1
      if (address_mode == mode_64bit && (sizeflag & DFLAG))
d13003 1
a13003 1
      if (address_mode == mode_64bit && (sizeflag & DFLAG))
d13021 1
a13021 1
	  if ((sizeflag & DFLAG) 
d13088 1
a13088 1
		  indexes64 = indexes32 = names_xmm; 
d13092 1
a13092 1
		    indexes64 = indexes32 = names_ymm; 
d13094 1
a13094 1
		    indexes64 = indexes32 = names_xmm; 
d13187 1
a13187 1
		    oappend (address_mode == mode_64bit 
d13191 1
a13191 1
		    oappend (address_mode == mode_64bit 
d13500 2
a13501 1
      if (address_mode == mode_64bit && (sizeflag & DFLAG))
d13716 1
a13716 1
	      || !(sizeflag & DFLAG))
d13718 2
a13719 1
	      if (sizeflag & DFLAG)
d13737 2
a13738 1
      if (sizeflag & DFLAG)
d14167 1
a14167 1
	  || bytemode == d_scalar_swap_mode 
d14182 1
a14182 1
      && bytemode != d_scalar_swap_mode 
d14601 1
a14601 1
      else 
d15153 1
a15153 1
    } 
a15247 1

@


1.269
log
@Implement RDRSEED, ADX and PRFCHW instructions

gas/

	* config/tc-i386.c: Add ADX, RDSEED and PRFCHW asm directives.
	* doc/c-i386.texi: Document the new directives.

gas/testsuite/

	* gas/i386/i386.exp: Run adx, rdseed and prefetchw tests.
	* gas/i386/x86-64-arch-2.s: Use prefetchw as 3dnow and Prfchw tests.
	* gas/i386/arch-10.s: Likewise.
	* gas/i386/arch-10-1.l: Changed correspondingly.
	* gas/i386/arch-10-2.l: Likewise.
	* gas/i386/arch-10-3.l: Likewise.
	* gas/i386/arch-10-4.l: Likewise.
	* gas/i386/arch-10.d: Likewise.
	* gas/i386/arch-10-lzcnt.d: Likewise.
	* gas/i386/x86-64-arch-2.d: Likewise.
	* gas/i386/x86-64-arch-2-lzcnt.d: Likewise.
	* gas/i386/ilp32/x86-64-arch-2.d: Likewise.
	* gas/i386/arch-10-prefetchw.d: New file.
	* gas/i386/x86-64-arch-2-prefetchw.d: Likewise.
	* gas/i386/rdseed.s: Likewise.
	* gas/i386/rdseed.d: Likewise.
	* gas/i386/rdseed-intel.d: Likewise.
	* gas/i386/adx.s: Likewise.
	* gas/i386/adx.d: Likewise.
	* gas/i386/adx-intel.d: Likewise.
	* gas/i386/x86-64-rdseed.s: Likewise.
	* gas/i386/x86-64-rdseed.d: Likewise.
	* gas/i386/x86-64-rdseed-intel.d: Likewise.
	* gas/i386/x86-64-adx.s: Likewise.
	* gas/i386/x86-64-adx.d: Likewise.
	* gas/i386/x86-64-adx-intel.d: Likewise.

opcodes/

	* i386-dis.c (PREFIX_0F38F6): New.
	(prefix_table): Add adcx, adox instructions.
	(three_byte_table): Use PREFIX_0F38F6.
	(mod_table): Add rdseed instruction.
	* i386-gen.c (cpu_flag_init): Add CpuADX, CpuRDSEED, CpuPRFCHW.
	(cpu_flags): Likewise.
	* i386-opc.h: Add CpuADX, CpuRDSEED, CpuPRFCHW.
	(i386_cpu_flags): Add fields cpurdseed, cpuadx, cpuprfchw.
	* i386-opc.tbl: Add instrcutions adcx, adox, rdseed. Extend
	prefetchw.
	* i386-tbl.h: Regenerate.
	* i386-init.h: Likewise.
@
text
@d1322 8
d6905 4
a6908 4
    { "vpcomb", 	{ XM, Vex128, EXx, Ib } },
    { "vpcomw", 	{ XM, Vex128, EXx, Ib } },
    { "vpcomd", 	{ XM, Vex128, EXx, Ib } },
    { "vpcomq", 	{ XM, Vex128, EXx, Ib } },
d6941 4
a6944 4
    { "vpcomub",	{ XM, Vex128, EXx, Ib } },
    { "vpcomuw",	{ XM, Vex128, EXx, Ib } },
    { "vpcomud",	{ XM, Vex128, EXx, Ib } },
    { "vpcomuq",	{ XM, Vex128, EXx, Ib } },
d9013 40
@


1.268
log
@Implement Intel Transactional Synchronization Extensions

gas/

2012-02-08  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c (HLE_PREFIX): New.
	(check_hle): Likewise.
	(_i386_insn): Add have_hle.
	(cpu_arch): Add .hle and .rtm.
	(md_assemble): Call check_hle if i.have_hle isn't zero.
	(parse_insn): Set i.have_hle to 1 for HLE prefix.
	(output_jump): Support up to 2 byte opcode.

	* doc/c-i386.texi: Document hle/.hle and rtm/.rtm.

gas/testsuite/

2012-02-08  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/hle-intel.d: New.
	* gas/i386/hle.d: Likewise.
	* gas/i386/hle.s: Likewise.
	* gas/i386/hlebad.l: Likewise.
	* gas/i386/hlebad.s: Likewise.
	* gas/i386/rtm-intel.d: Likewise.
	* gas/i386/rtm.d: Likewise.
	* gas/i386/rtm.s: Likewise.
	* gas/i386/x86-64-hle-intel.d: Likewise.
	* gas/i386/x86-64-hle.d: Likewise.
	* gas/i386/x86-64-hle.s: Likewise.
	* gas/i386/x86-64-hlebad.l: Likewise.
	* gas/i386/x86-64-hlebad.s: Likewise.
	* gas/i386/x86-64-rtm-intel.d: Likewise.
	* gas/i386/x86-64-rtm.d: Likewise.
	* gas/i386/x86-64-rtm.s: Likewise.

	* gas/i386/i386.exp: Run hle, hle-intel, hlebad x86-64-hle, rtm,
	rtm-intel, x86-64-hle-intel, x86-64-hlebad, x86-64-rtm and
	x86-64-rtm-intel.

include/opcode/

2012-02-08  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386.h (XACQUIRE_PREFIX_OPCODE): New.
	(XRELEASE_PREFIX_OPCODE): Likewise.

opcodes/

2012-02-08  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (HLE_Fixup1): New.
	(HLE_Fixup2): Likewise.
	(HLE_Fixup3): Likewise.
	(Ebh1): Likewise.
	(Evh1): Likewise.
	(Ebh2): Likewise.
	(Evh2): Likewise.
	(Ebh3): Likewise.
	(Evh3): Likewise.
	(MOD_C6_REG_7): Likewise.
	(MOD_C7_REG_7): Likewise.
	(RM_C6_REG_7): Likewise.
	(RM_C7_REG_7): Likewise.
	(XACQUIRE_PREFIX): Likewise.
	(XRELEASE_PREFIX): Likewise.
	(dis386): Use Ebh1/Evh1 on add, adc, and, btc, btr, bts,
	cmpxchg, dec, inc, neg, not, or, sbb, sub, xor and xadd. Use
	Ebh2/Evh2 on xchg.  Use Ebh3/Evh3 on mov.
	(reg_table): Use Ebh1/Evh1 on add, adc, and, dec, inc, neg,
	not, or, sbb, sub and xor.  Use Ebh3/Evh3 on mov.  Use
	MOD_C6_REG_7 and MOD_C7_REG_7.
	(mod_table): Add MOD_C6_REG_7 and MOD_C7_REG_7.
	(rm_table): Add RM_C6_REG_7 and RM_C7_REG_7.  Add xend and
	xtest.
	(prefix_name): Handle XACQUIRE_PREFIX and XRELEASE_PREFIX.
	(CMPXCHG8B_Fixup): Handle HLE prefix on cmpxchg8b.

	* i386-gen.c (cpu_flag_init): Add CPU_HLE_FLAGS and
	CPU_RTM_FLAGS.
	(cpu_flags): Add CpuHLE and CpuRTM.
	(opcode_modifiers): Add HLEPrefixOk.

	* i386-opc.h (CpuHLE): New.
	(CpuRTM): Likewise.
	(HLEPrefixOk): Likewise.
	(i386_cpu_flags): Add cpuhle and cpurtm.
	(i386_opcode_modifier): Add hleprefixok.

	* i386-opc.tbl: Add HLEPrefixOk=3 to mov.  Add HLEPrefixOk to
	add, adc, and, btc, btr, bts, cmpxchg, dec, inc, neg, not, or,
	sbb, sub, xor and xadd.  Add HLEPrefixOk=2 to xchg with memory
	operand.  Add xacquire, xrelease, xabort, xbegin, xend and
	xtest.
	* i386-init.h: Regenerated.
	* i386-tbl.h: Likewise.
@
text
@d854 1
d3489 8
d6067 1
a6067 1
    { Bad_Opcode },
d10335 1
@


1.267
log
@Add vmfunc

gas/

2012-01-13  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c (cpu_arch): Add ".vmfunc".

	* doc/c-i386.texi: Document vmfunc.

gas/testsuite/

2012-01-13  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run vmfunc and x86-64-vmfunc.

	* gas/i386/vmfunc.d: New.
	* gas/i386/vmfunc.s: Likewise.
	* gas/i386/x86-64-vmfunc.d: Likewise.

opcodes/

2012-01-13  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (mod_table): Add vmfunc.

	* i386-gen.c (cpu_flag_init): Add CPU_VMFUNC_FLAGS.
	(cpu_flags): CpuVMFUNC.

	* i386-opc.h (CpuVMFUNC): New.
	(i386_cpu_flags): Add cpuvmfunc.

	* i386-opc.tbl: Add vmfunc.
	* i386-init.h: Regenerated.
	* i386-tbl.h: Likewise.
@
text
@d111 3
d418 8
d656 2
d746 3
a748 1
  RM_0F01_REG_0 = 0,
d1664 2
a1665 2
  { "addB",		{ Eb, Gb } },
  { "addS",		{ Ev, Gv } },
d1673 2
a1674 2
  { "orB",		{ Eb, Gb } },
  { "orS",		{ Ev, Gv } },
d1682 2
a1683 2
  { "adcB",		{ Eb, Gb } },
  { "adcS",		{ Ev, Gv } },
d1691 2
a1692 2
  { "sbbB",		{ Eb, Gb } },
  { "sbbS",		{ Ev, Gv } },
d1700 2
a1701 2
  { "andB",		{ Eb, Gb } },
  { "andS",		{ Ev, Gv } },
d1709 2
a1710 2
  { "subB",		{ Eb, Gb } },
  { "subS",		{ Ev, Gv } },
d1718 2
a1719 2
  { "xorB",		{ Eb, Gb } },
  { "xorS",		{ Ev, Gv } },
d1814 2
a1815 2
  { "xchgB",		{ Eb, Gb } },
  { "xchgS",		{ Ev, Gv } },
d1817 2
a1818 2
  { "movB",		{ Eb, Gb } },
  { "movS",		{ Ev, Gv } },
d2147 1
a2147 1
  { "btsS",		{ Ev, Gv } },
d2153 2
a2154 2
  { "cmpxchgB",		{ Eb, Gb } },
  { "cmpxchgS",		{ Ev, Gv } },
d2156 1
a2156 1
  { "btrS",		{ Ev, Gv } },
d2165 1
a2165 1
  { "btcS",		{ Ev, Gv } },
d2171 2
a2172 2
  { "xaddB",		{ Eb, Gb } },
  { "xaddS",		{ Ev, Gv } },
d2454 7
a2460 7
    { "addA",	{ Eb, Ib } },
    { "orA",	{ Eb, Ib } },
    { "adcA",	{ Eb, Ib } },
    { "sbbA",	{ Eb, Ib } },
    { "andA",	{ Eb, Ib } },
    { "subA",	{ Eb, Ib } },
    { "xorA",	{ Eb, Ib } },
d2465 7
a2471 7
    { "addQ",	{ Ev, Iv } },
    { "orQ",	{ Ev, Iv } },
    { "adcQ",	{ Ev, Iv } },
    { "sbbQ",	{ Ev, Iv } },
    { "andQ",	{ Ev, Iv } },
    { "subQ",	{ Ev, Iv } },
    { "xorQ",	{ Ev, Iv } },
d2476 7
a2482 7
    { "addQ",	{ Ev, sIb } },
    { "orQ",	{ Ev, sIb } },
    { "adcQ",	{ Ev, sIb } },
    { "sbbQ",	{ Ev, sIb } },
    { "andQ",	{ Ev, sIb } },
    { "subQ",	{ Ev, sIb } },
    { "xorQ",	{ Ev, sIb } },
d2518 8
a2525 1
    { "movA",	{ Eb, Ib } },
d2529 8
a2536 1
    { "movQ",	{ Ev, Iv } },
d2586 2
a2587 2
    { "notA",	{ Eb } },
    { "negA",	{ Eb } },
d2597 2
a2598 2
    { "notQ",	{ Ev } },
    { "negQ",	{ Ev } },
d2606 2
a2607 2
    { "incA",	{ Eb } },
    { "decA",	{ Eb } },
d2611 2
a2612 2
    { "incQ",	{ Ev } },
    { "decQ",	{ Ev } },
d2718 3
a2720 3
    { "btsQ",	{ Ev, Ib } },
    { "btrQ",	{ Ev, Ib } },
    { "btcQ",	{ Ev, Ib } },
d10098 10
d10496 8
d10523 3
d10566 2
d10798 4
d14420 51
d14482 8
@


1.266
log
@	PR binutils/13348
	* i386-dis.c (print_insn): Fix testing of array subscript.
@
text
@d10473 3
@


1.265
log
@opcodes/

2011-08-02  Quentin Neill  <quentin.neill@@amd.com>

       * i386-dis.c (xop_table): Remove spurious bextr insn.
@
text
@d11334 1
a11334 1
	   all_prefixes[i] && i < (int) ARRAY_SIZE (all_prefixes);
@


1.264
log
@Check R_X86_64_32 overflow and allow R_X86_64_64 for x32.

bfd/

2011-08-01  H.J. Lu  <hongjiu.lu@@intel.com>

	PR ld/13048
	* archures.c (bfd_mach_i386_intel_syntax): New.
	(bfd_mach_i386_i8086): Updated.
	(bfd_mach_i386_i386): Likewise.
	(bfd_mach_x86_64): Likewise.
	(bfd_mach_x64_32): Likewise.
	(bfd_mach_i386_i386_intel_syntax): Likewise.
	(bfd_mach_x86_64_intel_syntax): Likewise.
	(bfd_mach_x64_32_intel_syntax): Likewise.
	(bfd_mach_l1om): Likewise.
	(bfd_mach_l1om_intel_syntax): Likewise.
	(bfd_mach_k1om): Likewise.
	(bfd_mach_k1om_intel_syntax): Likewise.

	* bfd-in2.h: Regenerated.

	* cpu-i386.c (bfd_i386_compatible): Check mach instead of
	bits_per_address.
	(bfd_x64_32_arch_intel_syntax): Set bits_per_address to 64.
	(bfd_x64_32_arch): Likewise.

	* elf64-x86-64.c: Include "libiberty.h".
	(x86_64_elf_howto_table): Append x32 R_X86_64_32.
	(elf_x86_64_rtype_to_howto): Support x32 R_X86_64_32.
	(elf_x86_64_reloc_type_lookup): Likewise.
	(elf_x86_64_reloc_name_lookup): Likewise.
	(elf_x86_64_relocate_section): Likewise.
	(elf_x86_64_check_relocs): Allow R_X86_64_64 relocations for x32.

gas/

2011-08-01  H.J. Lu  <hongjiu.lu@@intel.com>

	PR ld/13048
	* config/tc-i386.c (handle_quad): Removed.
	(md_pseudo_table): Remove "quad".
	(tc_gen_reloc): Don't check BFD_RELOC_64 for disallow_64bit_reloc.
	(x86_dwarf2_addr_size): New.

	* config/tc-i386.h (x86_dwarf2_addr_size): New.
	(DWARF2_ADDR_SIZE): Likewise.

gas/testsuite/

2011-08-01  H.J. Lu  <hongjiu.lu@@intel.com>

	PR ld/13048
	* gas/i386/ilp32/ilp32.exp: Don't run inval.

	* gas/i386/ilp32/inval.l: Removed.
	* gas/i386/ilp32/inval.s: Likewise.

	* gas/i386/ilp32/quad.d: Expect R_X86_64_64 instead of
	R_X86_64_32.

	* gas/i386/ilp32/x86-64-pcrel.s: Add tests for movabs.
	* gas/i386/ilp32/x86-64-pcrel.d: Updated.

ld/testsuite/

2011-08-01  H.J. Lu  <hongjiu.lu@@intel.com>

	PR ld/13048
	* ld-x86-64/ilp32-6.d: New.
	* ld-x86-64/ilp32-6.s: Likewise.
	* ld-x86-64/ilp32-7.d: Likewise.
	* ld-x86-64/ilp32-7.s: Likewise.
	* ld-x86-64/ilp32-8.d: Likewise.
	* ld-x86-64/ilp32-8.s: Likewise.
	* ld-x86-64/ilp32-9.d: Likewise.
	* ld-x86-64/ilp32-9.s: Likewise.

	* ld-x86-64/x86-64.exp: Run ilp32-6, ilp32-7, ilp32-8 and ilp32-9.

opcodes/

2011-08-01  H.J. Lu  <hongjiu.lu@@intel.com>

	PR ld/13048
	* i386-dis.c (print_insn): Optimize info->mach check.
@
text
@d6648 1
a6648 1
    { "bextr",	{ Gv, Ev, Iq } },
@


1.263
log
@Add initial Intel K1OM support.

bfd/

2011-07-22  H.J. Lu  <hongjiu.lu@@intel.com>

	* Makefile.am (ALL_MACHINES): Add cpu-k1om.lo.
	(ALL_MACHINES_CFILES): Add cpu-k1om.c.
	* Makefile.in: Regenerated.

	* archures.c (bfd_architecture): Add bfd_arch_k1om.
	(bfd_k1om_arch): New.
	(bfd_archures_list): Add &bfd_k1om_arch.
	* bfd-in2.h: Regenerated.

	* config.bfd (targ64_selvecs): Add bfd_elf64_k1om_vec if
	bfd_elf64_x86_64_vec is supported.  Add bfd_elf64_k1om_freebsd_vec
	if bfd_elf64_x86_64_freebsd_vec is supported.
	(targ_selvecs): Likewise.

	* configure.in: Support bfd_elf64_k1om_vec and
	bfd_elf64_k1om_freebsd_vec.
	* configure: Regenerated.

	* cpu-k1om.c: New.

	* elf64-x86-64.c (elf64_k1om_elf_object_p): New.
	(bfd_elf64_k1om_vec): Likewise.
	(bfd_elf64_k1om_freebsd_vec): Likewise.

	* targets.c (bfd_elf64_k1om_vec): New.
	(bfd_elf64_k1om_freebsd_vec): Likewise.
	(_bfd_target_vector): Add bfd_elf64_k1om_vec and
	bfd_elf64_k1om_freebsd_vec.

binutils/

2011-07-22  H.J. Lu  <hongjiu.lu@@intel.com>

	* dwarf.c (init_dwarf_regnames): Handle EM_K1OM.

	* elfedit.c (elf_machine): Support EM_K1OM.
	(elf_class): Likewise.

	* readelf.c (guess_is_rela): Handle EM_K1OM.
	(dump_relocations): Likewise.
	(get_machine_name): Likewise.
	(get_section_type_name): Likewise.
	(get_elf_section_flags): Likewise.
	(process_section_headers): Likewise.
	(get_symbol_index_type): Likewise.
	(is_32bit_abs_reloc): Likewise.
	(is_32bit_pcrel_reloc): Likewise.
	(is_64bit_abs_reloc): Likewise.
	(is_64bit_pcrel_reloc): Likewise.
	(is_none_reloc): Likewise.

	* doc/binutils.texi: Mention K1OM for elfedit.

binutils/testsuite/

2011-07-22  H.J. Lu  <hongjiu.lu@@intel.com>

	* binutils-all/elfedit.exp: Run elfedit-4.

	* binutils-all/elfedit-4.d: New.

gas/

2011-07-22  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c (cpu_arch): Add k1om.
	(i386_align_code): Handle PROCESSOR_K1OM.
	(check_cpu_arch_compatible): Check EM_K1OM.
	(i386_arch): Handle Intel K1OM.
	(i386_mach): Return bfd_mach_k1om for Intel K1OM.
	(i386_target_format): Return ELF_TARGET_K1OM_FORMAT for Intel
	K1OM.

	* config/tc-i386.h (ELF_TARGET_K1OM_FORMAT): New.
	(processor_type): Add PROCESSOR_K1OM.

	* doc/c-i386.texi: Document k1om.

gas/testsuite/

2011-07-22  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/k1om.d: New.
	* gas/i386/k1om-inval.l: Likewise.
	* gas/i386/k1om-inval.s: Likewise.

	* gas/i386/i386.exp: Run k1om-inval and k1om.

include/elf/

2011-07-22  H.J. Lu  <hongjiu.lu@@intel.com>

	* common.h (EM_K1OM): New.

ld/

2011-07-22  H.J. Lu  <hongjiu.lu@@intel.com>

	* Makefile.am (ALL_64_EMULATIONS): Add eelf_k1om.o and
	eelf_k1om_fbsd.o
	(eelf_k1om.c): New.
	(eelf_k1om_fbsd.c): Likewise.
	* Makefile.in: Regenerated.

	* configure.tgt (targ64_extra_emuls): Add elf_k1om if elf_x86_64
	is supported.  Add elf_k1om_fbsd if elf_x86_64_fbsd is supported.
	(targ_extra_emuls): Likewise.

	* emulparams/elf_k1om.sh: New.
	* emulparams/elf_k1om_fbsd.sh: Likewise.

ld/testsuite/

2011-07-22  H.J. Lu  <hongjiu.lu@@intel.com>

	* ld-x86-64/abs-k1om.d: New.
	* ld-x86-64/protected2-k1om.d: Likewise.
	* ld-x86-64/protected3-k1om.d: Likewise.

	* ld-x86-64/x86-64.exp: Run abs-k1om, protected2-k1om and
	protected3-k1om.

opcodes/

2011-07-22  H.J. Lu  <hongjiu.lu@@intel.com>

	* configure.in: Handle bfd_k1om_arch.
	* configure: Regenerated.

	* disassemble.c (disassembler): Handle bfd_k1om_arch.

	* i386-dis.c (print_insn): Handle bfd_mach_k1om and
	bfd_mach_k1om_intel_syntax.

	* i386-gen.c (cpu_flag_init): Set CPU_UNKNOWN_FLAGS to
	~(CpuL1OM|CpuK1OM).  Add CPU_K1OM_FLAGS.
	(cpu_flags): Add CpuK1OM.

	* i386-opc.h (CpuK1OM): New.
	(i386_cpu_flags): Add cpuk1om.

	* i386-init.h: Regenerated.
	* i386-tbl.h: Likewise.
@
text
@d11164 9
a11172 8
  if (info->mach == bfd_mach_x86_64_intel_syntax
      || info->mach == bfd_mach_x86_64
      || info->mach == bfd_mach_x64_32_intel_syntax
      || info->mach == bfd_mach_x64_32
      || info->mach == bfd_mach_l1om
      || info->mach == bfd_mach_l1om_intel_syntax
      || info->mach == bfd_mach_k1om
      || info->mach == bfd_mach_k1om_intel_syntax)
a11173 2
  else
    address_mode = mode_32bit;
d11176 1
a11176 21
    intel_syntax = (info->mach == bfd_mach_i386_i386_intel_syntax
		    || info->mach == bfd_mach_x86_64_intel_syntax
		    || info->mach == bfd_mach_x64_32_intel_syntax
		    || info->mach == bfd_mach_l1om_intel_syntax
		    || info->mach == bfd_mach_k1om_intel_syntax);

  if (info->mach == bfd_mach_i386_i386
      || info->mach == bfd_mach_x86_64
      || info->mach == bfd_mach_x64_32
      || info->mach == bfd_mach_l1om
      || info->mach == bfd_mach_k1om
      || info->mach == bfd_mach_i386_i386_intel_syntax
      || info->mach == bfd_mach_x86_64_intel_syntax
      || info->mach == bfd_mach_x64_32_intel_syntax
      || info->mach == bfd_mach_l1om_intel_syntax
      || info->mach == bfd_mach_k1om_intel_syntax)
    priv.orig_sizeflag = AFLAG | DFLAG;
  else if (info->mach == bfd_mach_i386_i8086)
    priv.orig_sizeflag = 0;
  else
    abort ();
d11281 1
a11281 2
  if (info->mach == bfd_mach_l1om
      || info->mach == bfd_mach_l1om_intel_syntax)
@


1.262
log
@Update rorxS.

2011-06-30  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (vex_len_table): Update rorxS.
@
text
@d11169 3
a11171 1
      || info->mach == bfd_mach_l1om_intel_syntax)
d11180 2
a11181 1
		    || info->mach == bfd_mach_l1om_intel_syntax);
d11187 1
d11191 2
a11192 1
      || info->mach == bfd_mach_l1om_intel_syntax)
@


1.261
log
@Fix rorx in BMI2.

gas/testsuite/

2011-06-30  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (June, 2011)
	* gas/i386/bmi2.s: Correct rorx tests.
	* gas/i386/x86-64-bmi2.s: Likewise.

	* gas/i386/bmi2-intel.d: Updated.
	* gas/i386/bmi2.d: Likewise.
	* gas/i386/x86-64-bmi2-intel.d: Likewise.
	* gas/i386/x86-64-bmi2.d: Likewise.

opcodes/

2011-06-30  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (June, 2011)
	* i386-dis.c (vex_len_table): Correct rorxS.

	* i386-opc.tbl: Correct rorx.
	* i386-tbl.h: Regenerated.
@
text
@d8964 1
a8964 1
    { "rorxS",		{ Gv, Ev, Ib } },
@


1.260
log
@Re-indent prefix_table.

2011-06-21  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (prefix_table): Re-indent PREFIX_VEX_0F388C and
	PREFIX_VEX_0F388E.
@
text
@d8964 1
a8964 1
    { "rorxS",		{ Gdq, VexGdq, Edq, Ib } },
@


1.259
log
@Support AVX Programming Reference (June, 2011).

gas/

2011-06-10  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (June, 2011)
	* config/tc-i386.c (i386_error): Add invalid_vsib_address and
	unsupported_vector_index_register.
	(cpu_arch): Add .avx2, .bmi2, .lzcnt and .invpcid.
	(check_VecOperands): New.
	(match_template): Call check_VecOperands.  Handle
	invalid_vsib_address and unsupported_vector_index_register.
	(build_modrm_byte): Support VecSIB.  Check register-only source
	operand when two source operands are swapped.
	(i386_index_check): Allow Xmm/Ymm index registers.

	* doc/c-i386.texi: Document avx2/.avx2, bmi2/.bmi2, lzcnt/.lzcnt
	and invpcid./invpcid.

gas/testsuite/

2011-06-10  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (June, 2011)
	* gas/i386/arch-10-1.l: Updated.
	* gas/i386/arch-10-2.l: Likewise.
	* gas/i386/arch-10-3.l: Likewise.
	* gas/i386/arch-10-4.l: Likewise.

	* gas/i386/arch-10.s: Add LZCNT to comments.
	* gas/i386/x86-64-arch-2.s: Likewise.

	* gas/i386/arch-10-lzcnt.d: New.
	* gas/i386/avx-gather-intel.d: Likewise.
	* gas/i386/avx-gather.d: Likewise.
	* gas/i386/avx-gather.s: Likewise.
	* gas/i386/avx2-intel.d: Likewise.
	* gas/i386/avx2.d: Likewise.
	* gas/i386/avx2.s: Likewise
	* gas/i386/avx256int-intel.d: Likewise.
	* gas/i386/avx256int.d: Likewise.
	* gas/i386/avx256int.s: Likewise.
	* gas/i386/bmi2-intel.d: Likewise.
	* gas/i386/bmi2.d: Likewise.
	* gas/i386/bmi2.s: Likewise.
	* gas/i386/inval-invpcid.l:Likewise.
	* gas/i386/inval-invpcid.s: Likewise.
	* gas/i386/invpcid-intel.d: Likewise.
	* gas/i386/invpcid.d: Likewise.
	* gas/i386/invpcid.s: Likewise.
	* gas/i386/x86-64-arch-2-lzcnt.d: Likewise.
	* gas/i386/x86-64-avx-gather-intel.d: Likewise.
	* gas/i386/x86-64-avx-gather.d: Likewise.
	* gas/i386/x86-64-avx-gather.s: Likewise.
	* gas/i386/x86-64-avx2-intel.d: Likewise.
	* gas/i386/x86-64-avx2.d: Likewise.
	* gas/i386/x86-64-avx2.s: Likewise.
	* gas/i386/x86-64-avx256int-intel.d: Likewise.
	* gas/i386/x86-64-avx256int.d: Likewise.
	* gas/i386/x86-64-avx256int.s: Likewise.
	* gas/i386/x86-64-bmi2-intel.d: Likewise.
	* gas/i386/x86-64-bmi2.d: Likewise.
	* gas/i386/x86-64-bmi2.s: Likewise.
	* gas/i386/x86-64-inval-invpcid.l: Likewise.
	* gas/i386/x86-64-inval-invpcid.s: Likewise.
	* gas/i386/x86-64-invpcid-intel.d: Likewise.
	* gas/i386/x86-64-invpcid.d: Likewise.
	* gas/i386/x86-64-invpcid.s: Likewise.

opcodes/

2011-06-10  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (June, 2011)
	* i386-dis.c (XMGatherQ): New.
	* i386-dis.c (EXxmm_mb): New.
	(EXxmm_mb): Likewise.
	(EXxmm_mw): Likewise.
	(EXxmm_md): Likewise.
	(EXxmm_mq): Likewise.
	(EXxmmdw): Likewise.
	(EXxmmqd): Likewise.
	(VexGatherQ): Likewise.
	(MVexVSIBDWpX): Likewise.
	(MVexVSIBQWpX): Likewise.
	(xmm_mb_mode): Likewise.
	(xmm_mw_mode): Likewise.
	(xmm_md_mode): Likewise.
	(xmm_mq_mode): Likewise.
	(xmmdw_mode): Likewise.
	(xmmqd_mode): Likewise.
	(ymmxmm_mode): Likewise.
	(vex_vsib_d_w_dq_mode): Likewise.
	(vex_vsib_q_w_dq_mode): Likewise.
	(MOD_VEX_0F385A_PREFIX_2): Likewise.
	(MOD_VEX_0F388C_PREFIX_2): Likewise.
	(MOD_VEX_0F388E_PREFIX_2): Likewise.
	(PREFIX_0F3882): Likewise.
	(PREFIX_VEX_0F3816): Likewise.
	(PREFIX_VEX_0F3836): Likewise.
	(PREFIX_VEX_0F3845): Likewise.
	(PREFIX_VEX_0F3846): Likewise.
	(PREFIX_VEX_0F3847): Likewise.
	(PREFIX_VEX_0F3858): Likewise.
	(PREFIX_VEX_0F3859): Likewise.
	(PREFIX_VEX_0F385A): Likewise.
	(PREFIX_VEX_0F3878): Likewise.
	(PREFIX_VEX_0F3879): Likewise.
	(PREFIX_VEX_0F388C): Likewise.
	(PREFIX_VEX_0F388E): Likewise.
	(PREFIX_VEX_0F3890..PREFIX_VEX_0F3893): Likewise.
	(PREFIX_VEX_0F38F5): Likewise.
	(PREFIX_VEX_0F38F6): Likewise.
	(PREFIX_VEX_0F3A00): Likewise.
	(PREFIX_VEX_0F3A01): Likewise.
	(PREFIX_VEX_0F3A02): Likewise.
	(PREFIX_VEX_0F3A38): Likewise.
	(PREFIX_VEX_0F3A39): Likewise.
	(PREFIX_VEX_0F3A46): Likewise.
	(PREFIX_VEX_0F3AF0): Likewise.
	(VEX_LEN_0F3816_P_2): Likewise.
	(VEX_LEN_0F3819_P_2): Likewise.
	(VEX_LEN_0F3836_P_2): Likewise.
	(VEX_LEN_0F385A_P_2_M_0): Likewise.
	(VEX_LEN_0F38F5_P_0): Likewise.
	(VEX_LEN_0F38F5_P_1): Likewise.
	(VEX_LEN_0F38F5_P_3): Likewise.
	(VEX_LEN_0F38F6_P_3): Likewise.
	(VEX_LEN_0F38F7_P_1): Likewise.
	(VEX_LEN_0F38F7_P_2): Likewise.
	(VEX_LEN_0F38F7_P_3): Likewise.
	(VEX_LEN_0F3A00_P_2): Likewise.
	(VEX_LEN_0F3A01_P_2): Likewise.
	(VEX_LEN_0F3A38_P_2): Likewise.
	(VEX_LEN_0F3A39_P_2): Likewise.
	(VEX_LEN_0F3A46_P_2): Likewise.
	(VEX_LEN_0F3AF0_P_3): Likewise.
	(VEX_W_0F3816_P_2): Likewise.
	(VEX_W_0F3818_P_2): Likewise.
	(VEX_W_0F3819_P_2): Likewise.
	(VEX_W_0F3836_P_2): Likewise.
	(VEX_W_0F3846_P_2): Likewise.
	(VEX_W_0F3858_P_2): Likewise.
	(VEX_W_0F3859_P_2): Likewise.
	(VEX_W_0F385A_P_2_M_0): Likewise.
	(VEX_W_0F3878_P_2): Likewise.
	(VEX_W_0F3879_P_2): Likewise.
	(VEX_W_0F3A00_P_2): Likewise.
	(VEX_W_0F3A01_P_2): Likewise.
	(VEX_W_0F3A02_P_2): Likewise.
	(VEX_W_0F3A38_P_2): Likewise.
	(VEX_W_0F3A39_P_2): Likewise.
	(VEX_W_0F3A46_P_2): Likewise.
	(MOD_VEX_0F3818_PREFIX_2): Removed.
	(MOD_VEX_0F3819_PREFIX_2): Likewise.
	(VEX_LEN_0F60_P_2..VEX_LEN_0F6D_P_2): Likewise.
	(VEX_LEN_0F70_P_1..VEX_LEN_0F76_P_2): Likewise.
	(VEX_LEN_0FD1_P_2..VEX_LEN_0FD5_P_2): Likewise.
	(VEX_LEN_0FD7_P_2_M_1..VEX_LEN_0F3819_P_2_M_0): Likewise.
	(VEX_LEN_0F381C_P_2..VEX_LEN_0F3840_P_2): Likewise.
	(VEX_LEN_0F3A0E_P_2): Likewise.
	(VEX_LEN_0F3A0F_P_2): Likewise.
	(VEX_LEN_0F3A42_P_2): Likewise.
	(VEX_LEN_0F3A4C_P_2): Likewise.
	(VEX_W_0F3818_P_2_M_0): Likewise.
	(VEX_W_0F3819_P_2_M_0): Likewise.
	(prefix_table): Updated.
	(three_byte_table): Likewise.
	(vex_table): Likewise.
	(vex_len_table): Likewise.
	(vex_w_table): Likewise.
	(mod_table): Likewise.
	(putop): Handle "LW".
	(intel_operand_size): Handle xmm_mb_mode, xmm_mw_mode,
	xmm_md_mode, xmm_mq_mode, xmmdw_mode, xmmqd_mode, ymmxmm_mode,
	vex_vsib_d_w_dq_mode, vex_vsib_q_w_dq_mode.
	(OP_EX): Likewise.
	(OP_E_memory): Handle vex_vsib_d_w_dq_mode and
	vex_vsib_q_w_dq_mode.
	(OP_XMM): Handle vex_vsib_q_w_dq_mode.
	(OP_VEX): Likewise.

	* i386-gen.c (cpu_flag_init): Add CpuAVX2 to CPU_ANY_SSE_FLAGS
	and CPU_ANY_AVX_FLAGS.  Add CPU_BMI2_FLAGS, CPU_LZCNT_FLAGS,
	CPU_INVPCID_FLAGS and CPU_AVX2_FLAGS.
	(cpu_flags): Add CpuAVX2, CpuBMI2, CpuLZCNT and CpuINVPCID.
	(opcode_modifiers): Add VecSIB.

	* i386-opc.h (CpuAVX2): New.
	(CpuBMI2): Likewise.
	(CpuLZCNT): Likewise.
	(CpuINVPCID): Likewise.
	(VecSIB128): Likewise.
	(VecSIB256): Likewise.
	(VecSIB): Likewise.
	(i386_cpu_flags): Add cpuavx2, cpubmi2, cpulzcnt and cpuinvpcid.
	(i386_opcode_modifier): Add vecsib.

	* i386-opc.tbl: Add invpcid, AVX2 and BMI2 instructions.
	* i386-init.h: Regenerated.
	* i386-tbl.h: Likewise.
@
text
@d4831 1
a4831 1
     { MOD_TABLE (MOD_VEX_0F388C_PREFIX_2) },
d4838 1
a4838 1
     { MOD_TABLE (MOD_VEX_0F388E_PREFIX_2) },
@


1.258
log
@2011-02-09  Michael Snyder  <msnyder@@vmware.com>

	* i386-dis.c (OP_J): Parenthesize expression to prevent
	truncated addresses.
	(print_insn): Fix indentation off-by-one.
@
text
@d339 1
d357 6
d379 1
d402 3
d455 12
d469 2
d503 5
a719 2
  MOD_VEX_0F3818_PREFIX_2,
  MOD_VEX_0F3819_PREFIX_2,
d725 4
a728 1
  MOD_VEX_0F382F_PREFIX_2
d831 1
d984 1
d1012 1
d1024 14
d1077 2
d1080 3
d1104 2
d1110 1
d1140 2
a1141 1
  PREFIX_VEX_0F3ADF
a1238 14
  VEX_LEN_0F60_P_2,
  VEX_LEN_0F61_P_2,
  VEX_LEN_0F62_P_2,
  VEX_LEN_0F63_P_2,
  VEX_LEN_0F64_P_2,
  VEX_LEN_0F65_P_2,
  VEX_LEN_0F66_P_2,
  VEX_LEN_0F67_P_2,
  VEX_LEN_0F68_P_2,
  VEX_LEN_0F69_P_2,
  VEX_LEN_0F6A_P_2,
  VEX_LEN_0F6B_P_2,
  VEX_LEN_0F6C_P_2,
  VEX_LEN_0F6D_P_2,
a1239 16
  VEX_LEN_0F70_P_1,
  VEX_LEN_0F70_P_2,
  VEX_LEN_0F70_P_3,
  VEX_LEN_0F71_R_2_P_2,
  VEX_LEN_0F71_R_4_P_2,
  VEX_LEN_0F71_R_6_P_2,
  VEX_LEN_0F72_R_2_P_2,
  VEX_LEN_0F72_R_4_P_2,
  VEX_LEN_0F72_R_6_P_2,
  VEX_LEN_0F73_R_2_P_2,
  VEX_LEN_0F73_R_3_P_2,
  VEX_LEN_0F73_R_6_P_2,
  VEX_LEN_0F73_R_7_P_2,
  VEX_LEN_0F74_P_2,
  VEX_LEN_0F75_P_2,
  VEX_LEN_0F76_P_2,
a1247 5
  VEX_LEN_0FD1_P_2,
  VEX_LEN_0FD2_P_2,
  VEX_LEN_0FD3_P_2,
  VEX_LEN_0FD4_P_2,
  VEX_LEN_0FD5_P_2,
a1248 29
  VEX_LEN_0FD7_P_2_M_1,
  VEX_LEN_0FD8_P_2,
  VEX_LEN_0FD9_P_2,
  VEX_LEN_0FDA_P_2,
  VEX_LEN_0FDB_P_2,
  VEX_LEN_0FDC_P_2,
  VEX_LEN_0FDD_P_2,
  VEX_LEN_0FDE_P_2,
  VEX_LEN_0FDF_P_2,
  VEX_LEN_0FE0_P_2,
  VEX_LEN_0FE1_P_2,
  VEX_LEN_0FE2_P_2,
  VEX_LEN_0FE3_P_2,
  VEX_LEN_0FE4_P_2,
  VEX_LEN_0FE5_P_2,
  VEX_LEN_0FE8_P_2,
  VEX_LEN_0FE9_P_2,
  VEX_LEN_0FEA_P_2,
  VEX_LEN_0FEB_P_2,
  VEX_LEN_0FEC_P_2,
  VEX_LEN_0FED_P_2,
  VEX_LEN_0FEE_P_2,
  VEX_LEN_0FEF_P_2,
  VEX_LEN_0FF1_P_2,
  VEX_LEN_0FF2_P_2,
  VEX_LEN_0FF3_P_2,
  VEX_LEN_0FF4_P_2,
  VEX_LEN_0FF5_P_2,
  VEX_LEN_0FF6_P_2,
d1250 2
a1251 20
  VEX_LEN_0FF8_P_2,
  VEX_LEN_0FF9_P_2,
  VEX_LEN_0FFA_P_2,
  VEX_LEN_0FFB_P_2,
  VEX_LEN_0FFC_P_2,
  VEX_LEN_0FFD_P_2,
  VEX_LEN_0FFE_P_2,
  VEX_LEN_0F3800_P_2,
  VEX_LEN_0F3801_P_2,
  VEX_LEN_0F3802_P_2,
  VEX_LEN_0F3803_P_2,
  VEX_LEN_0F3804_P_2,
  VEX_LEN_0F3805_P_2,
  VEX_LEN_0F3806_P_2,
  VEX_LEN_0F3807_P_2,
  VEX_LEN_0F3808_P_2,
  VEX_LEN_0F3809_P_2,
  VEX_LEN_0F380A_P_2,
  VEX_LEN_0F380B_P_2,
  VEX_LEN_0F3819_P_2_M_0,
d1253 1
a1253 29
  VEX_LEN_0F381C_P_2,
  VEX_LEN_0F381D_P_2,
  VEX_LEN_0F381E_P_2,
  VEX_LEN_0F3820_P_2,
  VEX_LEN_0F3821_P_2,
  VEX_LEN_0F3822_P_2,
  VEX_LEN_0F3823_P_2,
  VEX_LEN_0F3824_P_2,
  VEX_LEN_0F3825_P_2,
  VEX_LEN_0F3828_P_2,
  VEX_LEN_0F3829_P_2,
  VEX_LEN_0F382A_P_2_M_0,
  VEX_LEN_0F382B_P_2,
  VEX_LEN_0F3830_P_2,
  VEX_LEN_0F3831_P_2,
  VEX_LEN_0F3832_P_2,
  VEX_LEN_0F3833_P_2,
  VEX_LEN_0F3834_P_2,
  VEX_LEN_0F3835_P_2,
  VEX_LEN_0F3837_P_2,
  VEX_LEN_0F3838_P_2,
  VEX_LEN_0F3839_P_2,
  VEX_LEN_0F383A_P_2,
  VEX_LEN_0F383B_P_2,
  VEX_LEN_0F383C_P_2,
  VEX_LEN_0F383D_P_2,
  VEX_LEN_0F383E_P_2,
  VEX_LEN_0F383F_P_2,
  VEX_LEN_0F3840_P_2,
d1255 1
d1265 4
d1270 5
a1277 2
  VEX_LEN_0F3A0E_P_2,
  VEX_LEN_0F3A0F_P_2,
d1287 2
a1289 1
  VEX_LEN_0F3A42_P_2,
d1291 1
a1291 1
  VEX_LEN_0F3A4C_P_2,
d1305 1
d1493 1
d1495 2
a1496 2
  VEX_W_0F3818_P_2_M_0,
  VEX_W_0F3819_P_2_M_0,
d1521 1
d1533 6
d1544 3
d1564 2
d1570 1
d1639 1
d3401 7
d3776 1
a3776 1
    { VEX_LEN_TABLE (VEX_LEN_0F60_P_2) },
d3783 1
a3783 1
    { VEX_LEN_TABLE (VEX_LEN_0F61_P_2) },
d3790 1
a3790 1
    { VEX_LEN_TABLE (VEX_LEN_0F62_P_2) },
d3797 1
a3797 1
    { VEX_LEN_TABLE (VEX_LEN_0F63_P_2) },
d3804 1
a3804 1
    { VEX_LEN_TABLE (VEX_LEN_0F64_P_2) },
d3811 1
a3811 1
    { VEX_LEN_TABLE (VEX_LEN_0F65_P_2) },
d3818 1
a3818 1
    { VEX_LEN_TABLE (VEX_LEN_0F66_P_2) },
d3825 1
a3825 1
    { VEX_LEN_TABLE (VEX_LEN_0F67_P_2) },
d3832 1
a3832 1
    { VEX_LEN_TABLE (VEX_LEN_0F68_P_2) },
d3839 1
a3839 1
    { VEX_LEN_TABLE (VEX_LEN_0F69_P_2) },
d3846 1
a3846 1
    { VEX_LEN_TABLE (VEX_LEN_0F6A_P_2) },
d3853 1
a3853 1
    { VEX_LEN_TABLE (VEX_LEN_0F6B_P_2) },
d3860 1
a3860 1
    { VEX_LEN_TABLE (VEX_LEN_0F6C_P_2) },
d3867 1
a3867 1
    { VEX_LEN_TABLE (VEX_LEN_0F6D_P_2) },
d3887 3
a3889 3
    { VEX_LEN_TABLE (VEX_LEN_0F70_P_1) },
    { VEX_LEN_TABLE (VEX_LEN_0F70_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_0F70_P_3) },
d3896 1
a3896 1
    { VEX_LEN_TABLE (VEX_LEN_0F71_R_2_P_2) },
d3903 1
a3903 1
    { VEX_LEN_TABLE (VEX_LEN_0F71_R_4_P_2) },
d3910 1
a3910 1
    { VEX_LEN_TABLE (VEX_LEN_0F71_R_6_P_2) },
d3917 1
a3917 1
    { VEX_LEN_TABLE (VEX_LEN_0F72_R_2_P_2) },
d3924 1
a3924 1
    { VEX_LEN_TABLE (VEX_LEN_0F72_R_4_P_2) },
d3931 1
a3931 1
    { VEX_LEN_TABLE (VEX_LEN_0F72_R_6_P_2) },
d3938 1
a3938 1
    { VEX_LEN_TABLE (VEX_LEN_0F73_R_2_P_2) },
d3945 1
a3945 1
    { VEX_LEN_TABLE (VEX_LEN_0F73_R_3_P_2) },
d3952 1
a3952 1
    { VEX_LEN_TABLE (VEX_LEN_0F73_R_6_P_2) },
d3959 1
a3959 1
    { VEX_LEN_TABLE (VEX_LEN_0F73_R_7_P_2) },
d3966 1
a3966 1
    { VEX_LEN_TABLE (VEX_LEN_0F74_P_2) },
d3973 1
a3973 1
    { VEX_LEN_TABLE (VEX_LEN_0F75_P_2) },
d3980 1
a3980 1
    { VEX_LEN_TABLE (VEX_LEN_0F76_P_2) },
d4052 1
a4052 1
    { VEX_LEN_TABLE (VEX_LEN_0FD1_P_2) },
d4059 1
a4059 1
    { VEX_LEN_TABLE (VEX_LEN_0FD2_P_2) },
d4066 1
a4066 1
    { VEX_LEN_TABLE (VEX_LEN_0FD3_P_2) },
d4073 1
a4073 1
    { VEX_LEN_TABLE (VEX_LEN_0FD4_P_2) },
d4080 1
a4080 1
    { VEX_LEN_TABLE (VEX_LEN_0FD5_P_2) },
d4101 1
a4101 1
    { VEX_LEN_TABLE (VEX_LEN_0FD8_P_2) },
d4108 1
a4108 1
    { VEX_LEN_TABLE (VEX_LEN_0FD9_P_2) },
d4115 1
a4115 1
    { VEX_LEN_TABLE (VEX_LEN_0FDA_P_2) },
d4122 1
a4122 1
    { VEX_LEN_TABLE (VEX_LEN_0FDB_P_2) },
d4129 1
a4129 1
    { VEX_LEN_TABLE (VEX_LEN_0FDC_P_2) },
d4136 1
a4136 1
    { VEX_LEN_TABLE (VEX_LEN_0FDD_P_2) },
d4143 1
a4143 1
    { VEX_LEN_TABLE (VEX_LEN_0FDE_P_2) },
d4150 1
a4150 1
    { VEX_LEN_TABLE (VEX_LEN_0FDF_P_2) },
d4157 1
a4157 1
    { VEX_LEN_TABLE (VEX_LEN_0FE0_P_2) },
d4164 1
a4164 1
    { VEX_LEN_TABLE (VEX_LEN_0FE1_P_2) },
d4171 1
a4171 1
    { VEX_LEN_TABLE (VEX_LEN_0FE2_P_2) },
d4178 1
a4178 1
    { VEX_LEN_TABLE (VEX_LEN_0FE3_P_2) },
d4185 1
a4185 1
    { VEX_LEN_TABLE (VEX_LEN_0FE4_P_2) },
d4192 1
a4192 1
    { VEX_LEN_TABLE (VEX_LEN_0FE5_P_2) },
d4214 1
a4214 1
    { VEX_LEN_TABLE (VEX_LEN_0FE8_P_2) },
d4221 1
a4221 1
    { VEX_LEN_TABLE (VEX_LEN_0FE9_P_2) },
d4228 1
a4228 1
    { VEX_LEN_TABLE (VEX_LEN_0FEA_P_2) },
d4235 1
a4235 1
    { VEX_LEN_TABLE (VEX_LEN_0FEB_P_2) },
d4242 1
a4242 1
    { VEX_LEN_TABLE (VEX_LEN_0FEC_P_2) },
d4249 1
a4249 1
    { VEX_LEN_TABLE (VEX_LEN_0FED_P_2) },
d4256 1
a4256 1
    { VEX_LEN_TABLE (VEX_LEN_0FEE_P_2) },
d4263 1
a4263 1
    { VEX_LEN_TABLE (VEX_LEN_0FEF_P_2) },
d4278 1
a4278 1
    { VEX_LEN_TABLE (VEX_LEN_0FF1_P_2) },
d4285 1
a4285 1
    { VEX_LEN_TABLE (VEX_LEN_0FF2_P_2) },
d4292 1
a4292 1
    { VEX_LEN_TABLE (VEX_LEN_0FF3_P_2) },
d4299 1
a4299 1
    { VEX_LEN_TABLE (VEX_LEN_0FF4_P_2) },
d4306 1
a4306 1
    { VEX_LEN_TABLE (VEX_LEN_0FF5_P_2) },
d4313 1
a4313 1
    { VEX_LEN_TABLE (VEX_LEN_0FF6_P_2) },
d4327 1
a4327 1
    { VEX_LEN_TABLE (VEX_LEN_0FF8_P_2) },
d4334 1
a4334 1
    { VEX_LEN_TABLE (VEX_LEN_0FF9_P_2) },
d4341 1
a4341 1
    { VEX_LEN_TABLE (VEX_LEN_0FFA_P_2) },
d4348 1
a4348 1
    { VEX_LEN_TABLE (VEX_LEN_0FFB_P_2) },
d4355 1
a4355 1
    { VEX_LEN_TABLE (VEX_LEN_0FFC_P_2) },
d4362 1
a4362 1
    { VEX_LEN_TABLE (VEX_LEN_0FFD_P_2) },
d4369 1
a4369 1
    { VEX_LEN_TABLE (VEX_LEN_0FFE_P_2) },
d4376 1
a4376 1
    { VEX_LEN_TABLE (VEX_LEN_0F3800_P_2) },
d4383 1
a4383 1
    { VEX_LEN_TABLE (VEX_LEN_0F3801_P_2) },
d4390 1
a4390 1
    { VEX_LEN_TABLE (VEX_LEN_0F3802_P_2) },
d4397 1
a4397 1
    { VEX_LEN_TABLE (VEX_LEN_0F3803_P_2) },
d4404 1
a4404 1
    { VEX_LEN_TABLE (VEX_LEN_0F3804_P_2) },
d4411 1
a4411 1
    { VEX_LEN_TABLE (VEX_LEN_0F3805_P_2) },
d4418 1
a4418 1
    { VEX_LEN_TABLE (VEX_LEN_0F3806_P_2) },
d4425 1
a4425 1
    { VEX_LEN_TABLE (VEX_LEN_0F3807_P_2) },
d4432 1
a4432 1
    { VEX_LEN_TABLE (VEX_LEN_0F3808_P_2) },
d4439 1
a4439 1
    { VEX_LEN_TABLE (VEX_LEN_0F3809_P_2) },
d4446 1
a4446 1
    { VEX_LEN_TABLE (VEX_LEN_0F380A_P_2) },
d4453 1
a4453 1
    { VEX_LEN_TABLE (VEX_LEN_0F380B_P_2) },
d4491 7
d4509 1
a4509 1
    { MOD_TABLE (MOD_VEX_0F3818_PREFIX_2) },
d4516 1
a4516 1
    { MOD_TABLE (MOD_VEX_0F3819_PREFIX_2) },
d4530 1
a4530 1
    { VEX_LEN_TABLE (VEX_LEN_0F381C_P_2) },
d4537 1
a4537 1
    { VEX_LEN_TABLE (VEX_LEN_0F381D_P_2) },
d4544 1
a4544 1
    { VEX_LEN_TABLE (VEX_LEN_0F381E_P_2) },
d4551 1
a4551 1
    { VEX_LEN_TABLE (VEX_LEN_0F3820_P_2) },
d4558 1
a4558 1
    { VEX_LEN_TABLE (VEX_LEN_0F3821_P_2) },
d4565 1
a4565 1
    { VEX_LEN_TABLE (VEX_LEN_0F3822_P_2) },
d4572 1
a4572 1
    { VEX_LEN_TABLE (VEX_LEN_0F3823_P_2) },
d4579 1
a4579 1
    { VEX_LEN_TABLE (VEX_LEN_0F3824_P_2) },
d4586 1
a4586 1
    { VEX_LEN_TABLE (VEX_LEN_0F3825_P_2) },
d4593 1
a4593 1
    { VEX_LEN_TABLE (VEX_LEN_0F3828_P_2) },
d4600 1
a4600 1
    { VEX_LEN_TABLE (VEX_LEN_0F3829_P_2) },
d4614 1
a4614 1
    { VEX_LEN_TABLE (VEX_LEN_0F382B_P_2) },
d4649 1
a4649 1
    { VEX_LEN_TABLE (VEX_LEN_0F3830_P_2) },
d4656 1
a4656 1
    { VEX_LEN_TABLE (VEX_LEN_0F3831_P_2) },
d4663 1
a4663 1
    { VEX_LEN_TABLE (VEX_LEN_0F3832_P_2) },
d4670 1
a4670 1
    { VEX_LEN_TABLE (VEX_LEN_0F3833_P_2) },
d4677 1
a4677 1
    { VEX_LEN_TABLE (VEX_LEN_0F3834_P_2) },
d4684 8
a4691 1
    { VEX_LEN_TABLE (VEX_LEN_0F3835_P_2) },
d4698 1
a4698 1
    { VEX_LEN_TABLE (VEX_LEN_0F3837_P_2) },
d4705 1
a4705 1
    { VEX_LEN_TABLE (VEX_LEN_0F3838_P_2) },
d4712 1
a4712 1
    { VEX_LEN_TABLE (VEX_LEN_0F3839_P_2) },
d4719 1
a4719 1
    { VEX_LEN_TABLE (VEX_LEN_0F383A_P_2) },
d4726 1
a4726 1
    { VEX_LEN_TABLE (VEX_LEN_0F383B_P_2) },
d4733 1
a4733 1
    { VEX_LEN_TABLE (VEX_LEN_0F383C_P_2) },
d4740 1
a4740 1
    { VEX_LEN_TABLE (VEX_LEN_0F383D_P_2) },
d4747 1
a4747 1
    { VEX_LEN_TABLE (VEX_LEN_0F383E_P_2) },
d4754 1
a4754 1
    { VEX_LEN_TABLE (VEX_LEN_0F383F_P_2) },
d4761 1
a4761 1
    { VEX_LEN_TABLE (VEX_LEN_0F3840_P_2) },
d4771 98
d5135 16
d5154 24
d5247 1
a5247 1
    { VEX_LEN_TABLE (VEX_LEN_0F3A0E_P_2) },
d5254 1
a5254 1
    { VEX_LEN_TABLE (VEX_LEN_0F3A0F_P_2) },
d5327 14
d5359 1
a5359 1
    { VEX_LEN_TABLE (VEX_LEN_0F3A42_P_2) },
d5369 7
d5408 1
a5408 1
    { VEX_LEN_TABLE (VEX_LEN_0F3A4C_P_2) },
d5587 8
d5899 1
a5899 1
    { Bad_Opcode },
d7821 1
a7821 1
    { Bad_Opcode },
d7857 1
a7857 1
    { Bad_Opcode },
d7874 3
a7876 3
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
d7896 3
a7898 3
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
d7932 2
a7933 2
    { Bad_Opcode },
    { Bad_Opcode },
d7954 1
d7956 1
a7956 2
    { Bad_Opcode },
    { Bad_Opcode },
d7959 4
a7962 4
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
d8072 2
a8073 2
    { Bad_Opcode },
    { Bad_Opcode },
d8088 3
a8090 3
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
d8151 2
a8152 2
    { Bad_Opcode },
    { Bad_Opcode },
d8166 1
a8166 1
    { Bad_Opcode },
d8358 1
a8358 1
    { Bad_Opcode },
a8610 70
  /* VEX_LEN_0F60_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F60_P_2) },
  },

  /* VEX_LEN_0F61_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F61_P_2) },
  },

  /* VEX_LEN_0F62_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F62_P_2) },
  },

  /* VEX_LEN_0F63_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F63_P_2) },
  },

  /* VEX_LEN_0F64_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F64_P_2) },
  },

  /* VEX_LEN_0F65_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F65_P_2) },
  },

  /* VEX_LEN_0F66_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F66_P_2) },
  },

  /* VEX_LEN_0F67_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F67_P_2) },
  },

  /* VEX_LEN_0F68_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F68_P_2) },
  },

  /* VEX_LEN_0F69_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F69_P_2) },
  },

  /* VEX_LEN_0F6A_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F6A_P_2) },
  },

  /* VEX_LEN_0F6B_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F6B_P_2) },
  },

  /* VEX_LEN_0F6C_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F6C_P_2) },
  },

  /* VEX_LEN_0F6D_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F6D_P_2) },
  },

a8616 80
  /* VEX_LEN_0F70_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0F70_P_1) },
  },

  /* VEX_LEN_0F70_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F70_P_2) },
  },

  /* VEX_LEN_0F70_P_3 */
  {
    { VEX_W_TABLE (VEX_W_0F70_P_3) },
  },

  /* VEX_LEN_0F71_R_2_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F71_R_2_P_2) },
  },

  /* VEX_LEN_0F71_R_4_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F71_R_4_P_2) },
  },

  /* VEX_LEN_0F71_R_6_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F71_R_6_P_2) },
  },

  /* VEX_LEN_0F72_R_2_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F72_R_2_P_2) },
  },

  /* VEX_LEN_0F72_R_4_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F72_R_4_P_2) },
  },

  /* VEX_LEN_0F72_R_6_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F72_R_6_P_2) },
  },

  /* VEX_LEN_0F73_R_2_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F73_R_2_P_2) },
  },

  /* VEX_LEN_0F73_R_3_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F73_R_3_P_2) },
  },

  /* VEX_LEN_0F73_R_6_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F73_R_6_P_2) },
  },

  /* VEX_LEN_0F73_R_7_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F73_R_7_P_2) },
  },

  /* VEX_LEN_0F74_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F74_P_2) },
  },

  /* VEX_LEN_0F75_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F75_P_2) },
  },

  /* VEX_LEN_0F76_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F76_P_2) },
  },

d8629 1
a8629 406
  /* VEX_LEN_0FAE_R_2_M_0 */
  {
    { VEX_W_TABLE (VEX_W_0FAE_R_2_M_0) },
  },

  /* VEX_LEN_0FAE_R_3_M_0 */
  {
    { VEX_W_TABLE (VEX_W_0FAE_R_3_M_0) },
  },

  /* VEX_LEN_0FC2_P_1 */
  {
    { VEX_W_TABLE (VEX_W_0FC2_P_1) },
    { VEX_W_TABLE (VEX_W_0FC2_P_1) },
  },

  /* VEX_LEN_0FC2_P_3 */
  {
    { VEX_W_TABLE (VEX_W_0FC2_P_3) },
    { VEX_W_TABLE (VEX_W_0FC2_P_3) },
  },

  /* VEX_LEN_0FC4_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FC4_P_2) },
  },

  /* VEX_LEN_0FC5_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FC5_P_2) },
  },

  /* VEX_LEN_0FD1_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FD1_P_2) },
  },

  /* VEX_LEN_0FD2_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FD2_P_2) },
  },

  /* VEX_LEN_0FD3_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FD3_P_2) },
  },

  /* VEX_LEN_0FD4_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FD4_P_2) },
  },

  /* VEX_LEN_0FD5_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FD5_P_2) },
  },

  /* VEX_LEN_0FD6_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FD6_P_2) },
    { VEX_W_TABLE (VEX_W_0FD6_P_2) },
  },

  /* VEX_LEN_0FD7_P_2_M_1 */
  {
    { VEX_W_TABLE (VEX_W_0FD7_P_2_M_1) },
  },

  /* VEX_LEN_0FD8_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FD8_P_2) },
  },

  /* VEX_LEN_0FD9_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FD9_P_2) },
  },

  /* VEX_LEN_0FDA_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FDA_P_2) },
  },

  /* VEX_LEN_0FDB_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FDB_P_2) },
  },

  /* VEX_LEN_0FDC_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FDC_P_2) },
  },

  /* VEX_LEN_0FDD_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FDD_P_2) },
  },

  /* VEX_LEN_0FDE_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FDE_P_2) },
  },

  /* VEX_LEN_0FDF_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FDF_P_2) },
  },

  /* VEX_LEN_0FE0_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FE0_P_2) },
  },

  /* VEX_LEN_0FE1_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FE1_P_2) },
  },

  /* VEX_LEN_0FE2_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FE2_P_2) },
  },

  /* VEX_LEN_0FE3_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FE3_P_2) },
  },

  /* VEX_LEN_0FE4_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FE4_P_2) },
  },

  /* VEX_LEN_0FE5_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FE5_P_2) },
  },

  /* VEX_LEN_0FE8_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FE8_P_2) },
  },

  /* VEX_LEN_0FE9_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FE9_P_2) },
  },

  /* VEX_LEN_0FEA_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FEA_P_2) },
  },

  /* VEX_LEN_0FEB_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FEB_P_2) },
  },

  /* VEX_LEN_0FEC_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FEC_P_2) },
  },

  /* VEX_LEN_0FED_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FED_P_2) },
  },

  /* VEX_LEN_0FEE_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FEE_P_2) },
  },

  /* VEX_LEN_0FEF_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FEF_P_2) },
  },

  /* VEX_LEN_0FF1_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FF1_P_2) },
  },

  /* VEX_LEN_0FF2_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FF2_P_2) },
  },

  /* VEX_LEN_0FF3_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FF3_P_2) },
  },

  /* VEX_LEN_0FF4_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FF4_P_2) },
  },

  /* VEX_LEN_0FF5_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FF5_P_2) },
  },

  /* VEX_LEN_0FF6_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FF6_P_2) },
  },

  /* VEX_LEN_0FF7_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FF7_P_2) },
  },

  /* VEX_LEN_0FF8_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FF8_P_2) },
  },

  /* VEX_LEN_0FF9_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FF9_P_2) },
  },

  /* VEX_LEN_0FFA_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FFA_P_2) },
  },

  /* VEX_LEN_0FFB_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FFB_P_2) },
  },

  /* VEX_LEN_0FFC_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FFC_P_2) },
  },

  /* VEX_LEN_0FFD_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FFD_P_2) },
  },

  /* VEX_LEN_0FFE_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0FFE_P_2) },
  },

  /* VEX_LEN_0F3800_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3800_P_2) },
  },

  /* VEX_LEN_0F3801_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3801_P_2) },
  },

  /* VEX_LEN_0F3802_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3802_P_2) },
  },

  /* VEX_LEN_0F3803_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3803_P_2) },
  },

  /* VEX_LEN_0F3804_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3804_P_2) },
  },

  /* VEX_LEN_0F3805_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3805_P_2) },
  },

  /* VEX_LEN_0F3806_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3806_P_2) },
  },

  /* VEX_LEN_0F3807_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3807_P_2) },
  },

  /* VEX_LEN_0F3808_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3808_P_2) },
  },

  /* VEX_LEN_0F3809_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3809_P_2) },
  },

  /* VEX_LEN_0F380A_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F380A_P_2) },
  },

  /* VEX_LEN_0F380B_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F380B_P_2) },
  },

  /* VEX_LEN_0F3819_P_2_M_0 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F3819_P_2_M_0) },
  },

  /* VEX_LEN_0F381A_P_2_M_0 */
  {
    { Bad_Opcode },
    { VEX_W_TABLE (VEX_W_0F381A_P_2_M_0) },
  },

  /* VEX_LEN_0F381C_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F381C_P_2) },
  },

  /* VEX_LEN_0F381D_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F381D_P_2) },
  },

  /* VEX_LEN_0F381E_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F381E_P_2) },
  },

  /* VEX_LEN_0F3820_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3820_P_2) },
  },

  /* VEX_LEN_0F3821_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3821_P_2) },
  },

  /* VEX_LEN_0F3822_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3822_P_2) },
  },

  /* VEX_LEN_0F3823_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3823_P_2) },
  },

  /* VEX_LEN_0F3824_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3824_P_2) },
  },

  /* VEX_LEN_0F3825_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3825_P_2) },
  },

  /* VEX_LEN_0F3828_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3828_P_2) },
  },

  /* VEX_LEN_0F3829_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3829_P_2) },
  },

  /* VEX_LEN_0F382A_P_2_M_0 */
  {
    { VEX_W_TABLE (VEX_W_0F382A_P_2_M_0) },
  },

  /* VEX_LEN_0F382B_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F382B_P_2) },
  },

  /* VEX_LEN_0F3830_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3830_P_2) },
  },

  /* VEX_LEN_0F3831_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3831_P_2) },
  },

  /* VEX_LEN_0F3832_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3832_P_2) },
  },

  /* VEX_LEN_0F3833_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3833_P_2) },
  },

  /* VEX_LEN_0F3834_P_2 */
d8631 1
a8631 1
    { VEX_W_TABLE (VEX_W_0F3834_P_2) },
d8634 1
a8634 1
  /* VEX_LEN_0F3835_P_2 */
d8636 1
a8636 1
    { VEX_W_TABLE (VEX_W_0F3835_P_2) },
d8639 1
a8639 1
  /* VEX_LEN_0F3837_P_2 */
d8641 2
a8642 1
    { VEX_W_TABLE (VEX_W_0F3837_P_2) },
d8645 1
a8645 1
  /* VEX_LEN_0F3838_P_2 */
d8647 2
a8648 1
    { VEX_W_TABLE (VEX_W_0F3838_P_2) },
d8651 1
a8651 1
  /* VEX_LEN_0F3839_P_2 */
d8653 1
a8653 1
    { VEX_W_TABLE (VEX_W_0F3839_P_2) },
d8656 1
a8656 1
  /* VEX_LEN_0F383A_P_2 */
d8658 1
a8658 1
    { VEX_W_TABLE (VEX_W_0F383A_P_2) },
d8661 1
a8661 1
  /* VEX_LEN_0F383B_P_2 */
d8663 2
a8664 1
    { VEX_W_TABLE (VEX_W_0F383B_P_2) },
d8667 1
a8667 1
  /* VEX_LEN_0F383C_P_2 */
d8669 1
a8669 1
    { VEX_W_TABLE (VEX_W_0F383C_P_2) },
d8672 1
a8672 1
  /* VEX_LEN_0F383D_P_2 */
d8674 2
a8675 1
    { VEX_W_TABLE (VEX_W_0F383D_P_2) },
d8678 1
a8678 1
  /* VEX_LEN_0F383E_P_2 */
d8680 2
a8681 1
    { VEX_W_TABLE (VEX_W_0F383E_P_2) },
d8684 1
a8684 1
  /* VEX_LEN_0F383F_P_2 */
d8686 2
a8687 1
    { VEX_W_TABLE (VEX_W_0F383F_P_2) },
d8690 1
a8690 1
  /* VEX_LEN_0F3840_P_2 */
d8692 2
a8693 1
    { VEX_W_TABLE (VEX_W_0F3840_P_2) },
d8701 6
d8752 20
d8777 27
a8821 10
  /* VEX_LEN_0F3A0E_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A0E_P_2) },
  },

  /* VEX_LEN_0F3A0F_P_2 */
  {
    { VEX_W_TABLE (VEX_W_0F3A0F_P_2) },
  },

d8869 7
a8875 1
  /* VEX_LEN_0F3A41_P_2 */
d8877 2
a8878 1
    { VEX_W_TABLE (VEX_W_0F3A41_P_2) },
d8881 1
a8881 1
  /* VEX_LEN_0F3A42_P_2 */
d8883 1
a8883 1
    { VEX_W_TABLE (VEX_W_0F3A42_P_2) },
d8891 1
a8891 1
  /* VEX_LEN_0F3A4C_P_2 */
d8893 2
a8894 1
    { VEX_W_TABLE (VEX_W_0F3A4C_P_2) },
d8962 5
d9251 1
a9251 1
    { "vpunpcklbw",	{ XM, Vex128, EXx } },
d9255 1
a9255 1
    { "vpunpcklwd",	{ XM, Vex128, EXx } },
d9259 1
a9259 1
    { "vpunpckldq",	{ XM, Vex128, EXx } },
d9263 1
a9263 1
    { "vpacksswb",	{ XM, Vex128, EXx } },
d9267 1
a9267 1
    { "vpcmpgtb",	{ XM, Vex128, EXx } },
d9271 1
a9271 1
    { "vpcmpgtw",	{ XM, Vex128, EXx } },
d9275 1
a9275 1
    { "vpcmpgtd",	{ XM, Vex128, EXx } },
d9279 1
a9279 1
    { "vpackuswb",	{ XM, Vex128, EXx } },
d9283 1
a9283 1
    { "vpunpckhbw",	{ XM, Vex128, EXx } },
d9287 1
a9287 1
    { "vpunpckhwd",	{ XM, Vex128, EXx } },
d9291 1
a9291 1
    { "vpunpckhdq",	{ XM, Vex128, EXx } },
d9295 1
a9295 1
    { "vpackssdw",	{ XM, Vex128, EXx } },
d9299 1
a9299 1
    { "vpunpcklqdq",	{ XM, Vex128, EXx } },
d9303 1
a9303 1
    { "vpunpckhqdq",	{ XM, Vex128, EXx } },
d9327 1
a9327 1
    { "vpsrlw",		{ Vex128, XS, Ib } },
d9331 1
a9331 1
    { "vpsraw",		{ Vex128, XS, Ib } },
d9335 1
a9335 1
    { "vpsllw",		{ Vex128, XS, Ib } },
d9339 1
a9339 1
    { "vpsrld",		{ Vex128, XS, Ib } },
d9343 1
a9343 1
    { "vpsrad",		{ Vex128, XS, Ib } },
d9347 1
a9347 1
    { "vpslld",		{ Vex128, XS, Ib } },
d9351 1
a9351 1
    { "vpsrlq",		{ Vex128, XS, Ib } },
d9355 1
a9355 1
    { "vpsrldq",	{ Vex128, XS, Ib } },
d9359 1
a9359 1
    { "vpsllq",		{ Vex128, XS, Ib } },
d9363 1
a9363 1
    { "vpslldq",	{ Vex128, XS, Ib } },
d9367 1
a9367 1
    { "vpcmpeqb",	{ XM, Vex128, EXx } },
d9371 1
a9371 1
    { "vpcmpeqw",	{ XM, Vex128, EXx } },
d9375 1
a9375 1
    { "vpcmpeqd",	{ XM, Vex128, EXx } },
d9451 1
a9451 1
    { "vpsrlw",		{ XM, Vex128, EXx } },
d9455 1
a9455 1
    { "vpsrld",		{ XM, Vex128, EXx } },
d9459 1
a9459 1
    { "vpsrlq",		{ XM, Vex128, EXx } },
d9463 1
a9463 1
    { "vpaddq",		{ XM, Vex128, EXx } },
d9467 1
a9467 1
    { "vpmullw",	{ XM, Vex128, EXx } },
d9479 1
a9479 1
    { "vpsubusb",	{ XM, Vex128, EXx } },
d9483 1
a9483 1
    { "vpsubusw",	{ XM, Vex128, EXx } },
d9487 1
a9487 1
    { "vpminub",	{ XM, Vex128, EXx } },
d9491 1
a9491 1
    { "vpand",		{ XM, Vex128, EXx } },
d9495 1
a9495 1
    { "vpaddusb",	{ XM, Vex128, EXx } },
d9499 1
a9499 1
    { "vpaddusw",	{ XM, Vex128, EXx } },
d9503 1
a9503 1
    { "vpmaxub",	{ XM, Vex128, EXx } },
d9507 1
a9507 1
    { "vpandn",		{ XM, Vex128, EXx } },
d9511 1
a9511 1
    { "vpavgb",		{ XM, Vex128, EXx } },
d9515 1
a9515 1
    { "vpsraw",		{ XM, Vex128, EXx } },
d9519 1
a9519 1
    { "vpsrad",		{ XM, Vex128, EXx } },
d9523 1
a9523 1
    { "vpavgw",		{ XM, Vex128, EXx } },
d9527 1
a9527 1
    { "vpmulhuw",	{ XM, Vex128, EXx } },
d9531 1
a9531 1
    { "vpmulhw",	{ XM, Vex128, EXx } },
d9551 1
a9551 1
    { "vpsubsb",	{ XM, Vex128, EXx } },
d9555 1
a9555 1
    { "vpsubsw",	{ XM, Vex128, EXx } },
d9559 1
a9559 1
    { "vpminsw",	{ XM, Vex128, EXx } },
d9563 1
a9563 1
    { "vpor",		{ XM, Vex128, EXx } },
d9567 1
a9567 1
    { "vpaddsb",	{ XM, Vex128, EXx } },
d9571 1
a9571 1
    { "vpaddsw",	{ XM, Vex128, EXx } },
d9575 1
a9575 1
    { "vpmaxsw",	{ XM, Vex128, EXx } },
d9579 1
a9579 1
    { "vpxor",		{ XM, Vex128, EXx } },
d9587 1
a9587 1
    { "vpsllw",		{ XM, Vex128, EXx } },
d9591 1
a9591 1
    { "vpslld",		{ XM, Vex128, EXx } },
d9595 1
a9595 1
    { "vpsllq",		{ XM, Vex128, EXx } },
d9599 1
a9599 1
    { "vpmuludq",	{ XM, Vex128, EXx } },
d9603 1
a9603 1
    { "vpmaddwd",	{ XM, Vex128, EXx } },
d9607 1
a9607 1
    { "vpsadbw",	{ XM, Vex128, EXx } },
d9615 1
a9615 1
    { "vpsubb",		{ XM, Vex128, EXx } },
d9619 1
a9619 1
    { "vpsubw",		{ XM, Vex128, EXx } },
d9623 1
a9623 1
    { "vpsubd",		{ XM, Vex128, EXx } },
d9627 1
a9627 1
    { "vpsubq",		{ XM, Vex128, EXx } },
d9631 1
a9631 1
    { "vpaddb",		{ XM, Vex128, EXx } },
d9635 1
a9635 1
    { "vpaddw",		{ XM, Vex128, EXx } },
d9639 1
a9639 1
    { "vpaddd",		{ XM, Vex128, EXx } },
d9643 1
a9643 1
    { "vpshufb",	{ XM, Vex128, EXx } },
d9647 1
a9647 1
    { "vphaddw",	{ XM, Vex128, EXx } },
d9651 1
a9651 1
    { "vphaddd",	{ XM, Vex128, EXx } },
d9655 1
a9655 1
    { "vphaddsw",	{ XM, Vex128, EXx } },
d9659 1
a9659 1
    { "vpmaddubsw",	{ XM, Vex128, EXx } },
d9663 1
a9663 1
    { "vphsubw",	{ XM, Vex128, EXx } },
d9667 1
a9667 1
    { "vphsubd",	{ XM, Vex128, EXx } },
d9671 1
a9671 1
    { "vphsubsw",	{ XM, Vex128, EXx } },
d9675 1
a9675 1
    { "vpsignb",	{ XM, Vex128, EXx } },
d9679 1
a9679 1
    { "vpsignw",	{ XM, Vex128, EXx } },
d9683 1
a9683 1
    { "vpsignd",	{ XM, Vex128, EXx } },
d9687 1
a9687 1
    { "vpmulhrsw",	{ XM, Vex128, EXx } },
d9706 4
d9714 2
a9715 2
    /* VEX_W_0F3818_P_2_M_0 */
    { "vbroadcastss",	{ XM, Md } },
d9718 2
a9719 2
    /* VEX_W_0F3819_P_2_M_0 */
    { "vbroadcastsd",	{ XM, Mq } },
d9739 1
a9739 1
    { "vpmovsxbw",	{ XM, EXq } },
d9743 1
a9743 1
    { "vpmovsxbd",	{ XM, EXd } },
d9747 1
a9747 1
    { "vpmovsxbq",	{ XM, EXw } },
d9751 1
a9751 1
    { "vpmovsxwd",	{ XM, EXq } },
d9755 1
a9755 1
    { "vpmovsxwq",	{ XM, EXd } },
d9759 1
a9759 1
    { "vpmovsxdq",	{ XM, EXq } },
d9763 1
a9763 1
    { "vpmuldq",	{ XM, Vex128, EXx } },
d9767 1
a9767 1
    { "vpcmpeqq",	{ XM, Vex128, EXx } },
d9775 1
a9775 1
    { "vpackusdw",	{ XM, Vex128, EXx } },
d9795 1
a9795 1
    { "vpmovzxbw",	{ XM, EXq } },
d9799 1
a9799 1
    { "vpmovzxbd",	{ XM, EXd } },
d9803 1
a9803 1
    { "vpmovzxbq",	{ XM, EXw } },
d9807 1
a9807 1
    { "vpmovzxwd",	{ XM, EXq } },
d9811 1
a9811 1
    { "vpmovzxwq",	{ XM, EXd } },
d9815 5
a9819 1
    { "vpmovzxdq",	{ XM, EXq } },
d9823 1
a9823 1
    { "vpcmpgtq",	{ XM, Vex128, EXx } },
d9827 1
a9827 1
    { "vpminsb",	{ XM, Vex128, EXx } },
d9831 1
a9831 1
    { "vpminsd",	{ XM, Vex128, EXx } },
d9835 1
a9835 1
    { "vpminuw",	{ XM, Vex128, EXx } },
d9839 1
a9839 1
    { "vpminud",	{ XM, Vex128, EXx } },
d9843 1
a9843 1
    { "vpmaxsb",	{ XM, Vex128, EXx } },
d9847 1
a9847 1
    { "vpmaxsd",	{ XM, Vex128, EXx } },
d9851 1
a9851 1
    { "vpmaxuw",	{ XM, Vex128, EXx } },
d9855 1
a9855 1
    { "vpmaxud",	{ XM, Vex128, EXx } },
d9859 1
a9859 1
    { "vpmulld",	{ XM, Vex128, EXx } },
d9866 24
d9910 14
d9961 1
a9961 1
    { "vpblendw",	{ XM, Vex128, EXx, Ib } },
d9965 1
a9965 1
    { "vpalignr",	{ XM, Vex128, EXx, Ib } },
d9992 8
d10009 1
a10009 1
    { "vmpsadbw",	{ XM, Vex128, EXx, Ib } },
d10016 4
d10039 1
a10039 1
    { "vpblendvb",	{ XM, Vex128, EXx, XMVexI4 } },
d10407 1
a10407 1
    { VEX_LEN_TABLE (VEX_LEN_0FD7_P_2_M_1) },
a10417 8
    /* MOD_VEX_0F3818_PREFIX_2 */
    { VEX_W_TABLE (VEX_W_0F3818_P_2_M_0) },
  },
  {
    /* MOD_VEX_0F3819_PREFIX_2 */
    { VEX_LEN_TABLE (VEX_LEN_0F3819_P_2_M_0) },
  },
  {
d10423 1
a10423 1
    { VEX_LEN_TABLE (VEX_LEN_0F382A_P_2_M_0) },
d10441 12
d12435 4
a12438 1
	      if (l != 1 || len != 2 || last[0] != 'X')
d12445 4
a12448 1
	      *obufp++ = vex.w ? 'd': 's';
d12726 88
d12830 14
d12849 2
d12960 2
a12971 2
	  scale = sib.scale;
	  base = sib.base;
d12975 29
a13003 1
	  haveindex = vindex != 4;
d13087 1
a13087 1
			     ? names64[vindex] : names32[vindex]);
d13953 4
a13956 1
	  names = names_ymm;
d14069 6
d14532 1
d14551 4
a14559 2

      names = names_ymm;
@


1.257
log
@Properly sign-extend byte.

gas/testsuite/

2011-01-18  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/intel.d: Updated.
	* gas/i386/opcode-intel.d: Likewise.
	* gas/i386/opcode-suffix.d: Likewise.
	* gas/i386/opcode.d: Likewise.

opcodes/

2011-01-18  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (sIbT): New.
	(b_T_mode): Likewise.
	(dis386): Replace sIb with sIbT on "pushT".
	(x86_64_table): Replace sIb with Ib on "aam" and "aad".
	(OP_sI): Handle b_T_mode.  Properly sign-extend byte.
@
text
@d3 1
a3 1
   2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010
d11705 3
a11707 3
   need_vex = 0;
   need_vex_reg = 0;
   vex_w_done = 0;
d13820 1
a13820 1
  disp = ((start_pc + codep - start_codep + disp) & mask) | segment;
@


1.256
log
@Add support for TBM instructions.

gas/

2011-01-17  Quentin Neill  <quentin.neill@@amd.com>

	* config/tc-i386.c (cpu_arch): Add CPU_TBM_FLAGS.

	* doc/c-i386.texi (i386-TBM): New section.

opcodes/

2011-01-17  Quentin Neill  <quentin.neill@@amd.com>

	* i386-dis.c (REG_XOP_TBM_01): New.
	(REG_XOP_TBM_02): New.
	(reg_table): Add REG_XOP_TBM_01 and REG_XOP_TBM_02 tables.
	(xop_table): Redirect to REG_XOP_TBM_01 and REG_XOP_TBM_02
	entries, and add bextr instruction.

	* i386-gen.c (cpu_flag_init): Add CPU_TBM_FLAGS, CpuTBM.
	(cpu_flags): Add CpuTBM.

	* i386-opc.h (CpuTBM) New.
	(i386_cpu_flags): Add bit cputbm.

	* i386-opc.tbl: Add bextr, blcfill, blci, blcic, blcmsk,
	blcs, blsfill, blsic, t1mskc, and tzmsk.

	* i386-init.h: Regenerated.
	* i386-tbl.h: Regenerated

gas/testsuite

2011-01-17  Quentin Neill  <quentin.neill@@amd.com>

	* gas/i386/tbm.s: New.
	* gas/i386/tbm.d: New.
	* gas/i386/tbm-intel.d: New.
	* gas/i386/x86-64-tbm.s: New.
	* gas/i386/x86-64-tbm.d: New.
	* gas/i386/x86-64-tbm-intel.d: New.
	* gas/i386/arch-10.d: Add tbm flag and TBM instruction pattern.
	* gas/i386/arch-10.s: Add a TBM instruction.
	* gas/i386/arch-10-1.l: Add TBM instruction pattern.
	* gas/i386/arch-10-2.l: Likewise.
	* gas/i386/arch-10-3.l: Likewise.
	* gas/i386/arch-10-4.l: Likewise.
	* gas/i386/x86-64-arch-2.s: Likewise.
	* gas/i386/x86-64-arch-2.d: Likewise.
@
text
@d255 1
d418 2
d1796 1
a1796 1
  { "pushT",		{ sIb } },
d5550 1
a5550 1
    { "aam", { sIb } },
d5555 1
a5555 1
    { "aad", { sIb } },
d13737 1
d13742 21
@


1.255
log
@Implement BMI instructions.
@
text
@d604 3
a606 1
  REG_XOP_LWP
d2784 21
d6485 1
a6485 1
    { Bad_Opcode },
d6759 2
a6760 2
    { Bad_Opcode },
    { Bad_Opcode },
d7067 1
a7067 1
    { Bad_Opcode },
@


1.254
log
@Add VexGdq.

2011-01-04  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (VexGdq): New.
	(OP_VEX): Handle dq_mode.
@
text
@d602 1
d751 1
d1020 5
d1308 5
d2174 1
a2174 1
  { "bsfS",		{ Gv, Ev } },
d2765 7
d3092 7
d4998 25
d7883 2
d7888 1
a7888 3
    { Bad_Opcode },
    { Bad_Opcode },
    { Bad_Opcode },
d9088 25
@


1.253
log
@Add x86-64 ILP32 support.

bfd/

2010-12-30  H.J. Lu  <hongjiu.lu@@intel.com>

	* archures.c (bfd_mach_x64_32): New.
	(bfd_mach_x64_32_intel_syntax): Likewise.
	* bfd-in2.h: Regenerated.

	* config.bfd (targ64_selvecs): Add bfd_elf32_x86_64_vec for
	i[3-7]86-*-linux-*.
	(targ_selvecs): Add bfd_elf32_x86_64_vec for x86_64-*-linux-*.

	* configure.in: Support bfd_elf32_x86_64_vec.
	* configure: Regenerated.

	* cpu-i386.c (bfd_x64_32_arch_intel_syntax): New.
	(bfd_x64_32_arch): Likewise.

	* elf-bfd.h (elf_append_rela): New prototype.
	(elf_append_rel): Likewise.
	(elf64_r_info): Likewise.
	(elf32_r_info): Likewise.
	(elf64_r_sym): Likewise.
	(elf32_r_sym): Likewise.

	* elf64-x86-64.c (ABI_64_P): New.
	(elf_x86_64_info_to_howto): Replace ELF64_R_TYPE with
	ELF32_R_TYPE.  Replace ELF64_ST_TYPE with ELF_ST_TYPE.
	(elf_x86_64_check_tls_transition):Likewise.
	(elf_x86_64_check_relocs): Likewise.
	(elf_x86_64_gc_mark_hook):Likewise.
	(elf_x86_64_gc_sweep_hook): Likewise.
	(elf_x86_64_relocate_section): Likewise.
	(elf_x86_64_reloc_type_class): Likewise.
	(ELF_DYNAMIC_INTERPRETER): Renamed to ...
	(ELF64_DYNAMIC_INTERPRETER): This.
	(ELF32_DYNAMIC_INTERPRETER): New.
	(elf_x86_64_link_hash_table): Add r_info, r_sym, swap_reloca_out,
	dynamic_interpreter and dynamic_interpreter_size.
	(elf_x86_64_get_local_sym_hash): Replace ELF64_R_SYM with
	htab->r_sym.  Replace ELF64_R_INFO with htab->r_info.
	(elf_x86_64_get_local_sym_hash): Likewise.
	(elf_x86_64_check_tls_transition):Likewise.
	(elf_x86_64_check_relocs): Likewise.
	(elf_x86_64_gc_mark_hook):Likewise.
	(elf_x86_64_gc_sweep_hook): Likewise.
	(elf_x86_64_relocate_section): Likewise.
	(elf_x86_64_finish_dynamic_symbol): Likewise.
	(elf_x86_64_finish_local_dynamic_symbol): Likewise.
	(elf_x86_64_link_hash_table_create): Initialize r_info, r_sym,
	swap_reloca_out, dynamic_interpreter and dynamic_interpreter_size.
	(elf_x86_64_check_relocs): Check ABI_64_P when requesting for
	PIC.
	(elf_x86_64_relocate_section): Likewise.
	(elf64_x86_64_adjust_dynamic_symbol): Replace sizeof
	(Elf64_External_Rela) with bed->s->sizeof_rela.
	(elf64_x86_64_allocate_dynrelocs): Likewise.
	(elf64_x86_64_size_dynamic_sections): Likewise.
	(elf64_x86_64_finish_dynamic_symbol): Likewise.
	(elf64_x86_64_append_rela): Removed.
	(elf32_x86_64_elf_object_p): New.
	Add bfd_elf32_x86_64_vec.

	* elf64-x86-64.c (elf64_x86_64_xxx): Renamed to ...
	(elf_x86_64_xxx): This.

	* elflink.c (bfd_elf_final_link): Check ELF file class on error.
	(elf_append_rela): New.
	(elf_append_rel): Likewise.
	(elf64_r_info): Likewise.
	(elf32_r_info): Likewise.
	(elf64_r_sym): Likewise.
	(elf32_r_sym): Likewise.

	* targets.c (bfd_elf32_x86_64_vec): New.
	(_bfd_target_vector): Add bfd_elf32_x86_64_vec.

gas/

2010-12-30  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c (x86_elf_abi): New.
	(i386_mach): Return bfd_mach_x64_32 for ILP32.
	(OPTION_N32): Likewise.
	(md_longopts): Add "n32" for ELF.
	(md_parse_option): Handle OPTION_N32.
	(md_show_usage): Add --n32.
	(i386_target_format): Update and check x86_elf_abi.

	* config/tc-i386.h (ELF_TARGET_FORMAT32): New.

	* doc/as.texinfo: Document --n32.
	* doc/c-i386.texi: Likewise.

gas/testsuite/

2010-12-30  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/ilp32/lns/ilp32.exp: New.
	* gas/i386/ilp32/lns/lns-common-1.d: Likewise.
	* gas/i386/ilp32/lns/lns-duplicate.d: Likewise.

	* gas/i386/ilp32/cfi/cfi-common-1.d: New.
	* gas/i386/ilp32/cfi/cfi-common-2.d: Likewise.
	* gas/i386/ilp32/cfi/cfi-common-3.d: Likewise.
	* gas/i386/ilp32/cfi/cfi-common-4.d: Likewise.
	* gas/i386/ilp32/cfi/cfi-common-5.d: Likewise.
	* gas/i386/ilp32/cfi/cfi-common-6.d: Likewise.
	* gas/i386/ilp32/cfi/cfi-common-7.d: Likewise.
	* gas/i386/ilp32/cfi/cfi-x86_64.d: Likewise.
	* gas/i386/ilp32/cfi/ilp32.exp: Likewise.
	* gas/i386/ilp32/elf/ehopt0.d: Likewise.
	* gas/i386/ilp32/elf/equ-reloc.d: Likewise.
	* gas/i386/ilp32/elf/file.d: Likewise.
	* gas/i386/ilp32/elf/group0a.d: Likewise.
	* gas/i386/ilp32/elf/group0b.d: Likewise.
	* gas/i386/ilp32/elf/group1a.d: Likewise.
	* gas/i386/ilp32/elf/group1b.d: Likewise.
	* gas/i386/ilp32/elf/ifunc-1.d: Likewise.
	* gas/i386/ilp32/elf/ilp32.exp: Likewise.
	* gas/i386/ilp32/elf/redef.d: Likewise.
	* gas/i386/ilp32/elf/section0.d: Likewise.
	* gas/i386/ilp32/elf/section1.d: Likewise.
	* gas/i386/ilp32/elf/section3.d: Likewise.
	* gas/i386/ilp32/elf/section4.d: Likewise.
	* gas/i386/ilp32/elf/section6.d: Likewise.
	* gas/i386/ilp32/elf/section7.d: Likewise.
	* gas/i386/ilp32/elf/struct.d: Likewise.
	* gas/i386/ilp32/elf/symtab.d: Likewise.
	* gas/i386/ilp32/elf/symver.d: Likewise.

	* gas/i386/ilp32/ilp32.exp: New.
	* gas/i386/ilp32/immed64.d: Likewise.
	* gas/i386/ilp32/mixed-mode-reloc64.d: Likewise.
	* gas/i386/ilp32/reloc64.d: Likewise.
	* gas/i386/ilp32/rex.d: Likewise.
	* gas/i386/ilp32/rexw.d: Likewise.
	* gas/i386/ilp32/svme64.d: Likewise.
	* gas/i386/ilp32/x86-64-addr32.d: Likewise.
	* gas/i386/ilp32/x86-64-addr32-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-aes.d: Likewise.
	* gas/i386/ilp32/x86-64-aes-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-amdfam10.d: Likewise.
	* gas/i386/ilp32/x86-64-arch-1.d: Likewise.
	* gas/i386/ilp32/x86-64-arch-2.d: Likewise.
	* gas/i386/ilp32/x86-64-avx.d: Likewise.
	* gas/i386/ilp32/x86-64-avx-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-avx-swap.d: Likewise.
	* gas/i386/ilp32/x86-64-avx-swap-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-branch.d: Likewise.
	* gas/i386/ilp32/x86-64-cbw.d: Likewise.
	* gas/i386/ilp32/x86-64-cbw-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-clmul.d: Likewise.
	* gas/i386/ilp32/x86-64-clmul-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-crc32.d: Likewise.
	* gas/i386/ilp32/x86-64-crc32-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-crx.d: Likewise.
	* gas/i386/ilp32/x86-64-crx-suffix.d: Likewise.
	* gas/i386/ilp32/x86-64.d: Likewise.
	* gas/i386/ilp32/x86-64-disp.d: Likewise.
	* gas/i386/ilp32/x86-64-disp-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-drx.d: Likewise.
	* gas/i386/ilp32/x86-64-drx-suffix.d: Likewise.
	* gas/i386/ilp32/x86-64-ept.d: Likewise.
	* gas/i386/ilp32/x86-64-ept-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-fma4.d: Likewise.
	* gas/i386/ilp32/x86-64-fma.d: Likewise.
	* gas/i386/ilp32/x86-64-fma-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-gidt.d: Likewise.
	* gas/i386/ilp32/x86-64-ifunc.d: Likewise.
	* gas/i386/ilp32/x86-64-intel64.d: Likewise.
	* gas/i386/ilp32/x86-64-io.d: Likewise.
	* gas/i386/ilp32/x86-64-io-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-io-suffix.d: Likewise.
	* gas/i386/ilp32/x86-64-localpic.d: Likewise.
	* gas/i386/ilp32/x86-64-mem.d: Likewise.
	* gas/i386/ilp32/x86-64-mem-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-movbe.d: Likewise.
	* gas/i386/ilp32/x86-64-movbe-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-nops-1-core2.d: Likewise.
	* gas/i386/ilp32/x86-64-nops-1.d: Likewise.
	* gas/i386/ilp32/x86-64-nops-1-k8.d: Likewise.
	* gas/i386/ilp32/x86-64-nops-1-nocona.d: Likewise.
	* gas/i386/ilp32/x86-64-nops-1-pentium.d: Likewise.
	* gas/i386/ilp32/x86-64-nops-2.d: Likewise.
	* gas/i386/ilp32/x86-64-nops-3.d: Likewise.
	* gas/i386/ilp32/x86-64-nops-4-core2.d: Likewise.
	* gas/i386/ilp32/x86-64-nops-4.d: Likewise.
	* gas/i386/ilp32/x86-64-nops-4-k8.d: Likewise.
	* gas/i386/ilp32/x86-64-nops-5.d: Likewise.
	* gas/i386/ilp32/x86-64-nops-5-k8.d: Likewise.
	* gas/i386/ilp32/x86-64-nops.d: Likewise.
	* gas/i386/ilp32/x86-64-opcode.d: Likewise.
	* gas/i386/ilp32/x86-64-opcode-inval.d: Likewise.
	* gas/i386/ilp32/x86-64-opcode-inval-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-opts.d: Likewise.
	* gas/i386/ilp32/x86-64-opts-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-pcrel.d: Likewise.
	* gas/i386/ilp32/x86-64-reg.d: Likewise.
	* gas/i386/ilp32/x86-64-reg-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-rep.d: Likewise.
	* gas/i386/ilp32/x86-64-rep-suffix.d: Likewise.
	* gas/i386/ilp32/x86-64-rip.d: Likewise.
	* gas/i386/ilp32/x86-64-rip-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-sib.d: Likewise.
	* gas/i386/ilp32/x86-64-sib-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-simd.d: Likewise.
	* gas/i386/ilp32/x86-64-simd-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-simd-suffix.d: Likewise.
	* gas/i386/ilp32/x86-64-sse2avx.d: Likewise.
	* gas/i386/ilp32/x86-64-sse2avx-opts.d: Likewise.
	* gas/i386/ilp32/x86-64-sse2avx-opts-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-sse3.d: Likewise.
	* gas/i386/ilp32/x86-64-sse4_1.d: Likewise.
	* gas/i386/ilp32/x86-64-sse4_1-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-sse4_2.d: Likewise.
	* gas/i386/ilp32/x86-64-sse4_2-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-sse-check.d: Likewise.
	* gas/i386/ilp32/x86-64-sse-check-none.d: Likewise.
	* gas/i386/ilp32/x86-64-sse-check-warn.d: Likewise.
	* gas/i386/ilp32/x86-64-sse-noavx.d: Likewise.
	* gas/i386/ilp32/x86-64-ssse3.d: Likewise.
	* gas/i386/ilp32/x86-64-stack.d: Likewise.
	* gas/i386/ilp32/x86-64-stack-intel.d: Likewise.
	* gas/i386/ilp32/x86-64-stack-suffix.d: Likewise.
	* gas/i386/ilp32/x86-64-unwind.d: Likewise.
	* gas/i386/ilp32/x86-64-vmx.d: Likewise.
	* gas/i386/ilp32/x86-64-xsave.d: Likewise.
	* gas/i386/ilp32/x86-64-xsave-intel.d: Likewise.

ld/

2010-12-30  H.J. Lu  <hongjiu.lu@@intel.com>

	* emulparams/elf32_x86_64.sh: New.

	* configure.tgt (targ64_extra_emuls): Add elf32_x86_64 for
	i[3-7]86-*-linux-*.
	(targ_extra_libpath): Likewise.
	(targ_extra_emuls): Add elf32_x86_64 for x86_64-*-linux-*.
	(targ_extra_libpath): Likewise.

	* Makefile.am (ALL_64_EMULATION_SOURCES): Add eelf32_x86_64.c.
	(eelf32_x86_64.c): New.
	* Makefile.in: Regenerated.

opcodes/

2010-12-30  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (print_insn): Support bfd_mach_x64_32 and
	bfd_mach_x64_32_intel_syntax.
@
text
@d373 1
d14531 7
a14542 2

      names = names_xmm;
@


1.252
log
@Remove duplicated RMAL.

2010-10-02  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/12076
	* i386-dis.c (RMAL): Remove duplicate.
@
text
@d11333 2
d11344 1
d11349 1
d11353 1
@


1.251
log
@Fix "pushw imm16" for x86-64 disassembler.

gas/testsuite/

2010-08-31  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/11960
	* gas/i386/opcode-intel.d: Updated.
	* gas/i386/x86-64-opcode.d: Likewise.

	* gas/i386/x86-64-opcode.s: Add a "pushw imm16" test.

opcodes/

2010-08-31  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/11960
	* i386-dis.c (sIv): New.
	(dis386): Replace Iq with sIv on "pushT".
	(reg_table): Replace T with {T|} on callT, JcallT, jmpT and JjmpT.
	(x86_64_table): Replace {T|}/{P|} with P.
	(putop): Add 'w' to 'T'/'P' if needed for Intel syntax.
	(OP_sI): Update v_mode.  Remove w_mode.
@
text
@a284 1
#define RMAL { OP_REG, al_reg }
@


1.250
log
@Replace Eb with Mb on prefetch and prefetchw.

2010-08-17  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (reg_table): Replace Eb with Mb on prefetch and
	prefetchw.
@
text
@d256 1
d1777 1
a1777 1
  { "pushT",		{ Iq } },
d2595 4
a2598 4
    { "callT",	{ indirEv } },
    { "JcallT",	{ indirEp } },
    { "jmpT",	{ indirEv } },
    { "JjmpT",	{ indirEp } },
d5363 1
a5363 1
    { "push{T|}", { es } },
d5368 1
a5368 1
    { "pop{T|}", { es } },
d5373 1
a5373 1
    { "push{T|}", { cs } },
d5378 1
a5378 1
    { "push{T|}", { ss } },
d5383 1
a5383 1
    { "pop{T|}", { ss } },
d5388 1
a5388 1
    { "push{T|}", { ds } },
d5393 1
a5393 1
    { "pop{T|}", { ds } },
d5418 1
a5418 1
    { "pusha{P|}", { XX } },
d5423 1
a5423 1
    { "popa{P|}", { XX } },
d12339 3
a12341 3
	  if (intel_syntax)
	    break;
	  if (address_mode == mode_64bit && (sizeflag & DFLAG))
d12349 10
a12358 1
	    break;
d13636 1
a13636 2
      USED_REX (REX_W);
      if (rex & REX_W)
d13639 1
a13639 18
	{
	  if (sizeflag & DFLAG)
	    {
	      op = get32s ();
	    }
	  else
	    {
	      op = get16 ();
	      if ((op & 0x8000) != 0)
		op -= 0x10000;
	    }
	  used_prefixes |= (prefixes & PREFIX_DATA);
	}
      break;
    case w_mode:
      op = get16 ();
      if ((op & 0x8000) != 0)
	op -= 0x10000;
@


1.249
log
@Add ud1 to x86.

gas/testsuite/

2010-08-05  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run arch-4.

	* gas/i386/arch-4.d: New.
	* gas/i386/arch-4.s: Likewise.

	* gas/i386/intel.d: Replace ud2a/ud2b with ud2/ud1.
	* gas/i386/opcode-intel.d: Likewise.
	* gas/i386/opcode-suffix.d: Likewise.
	* gas/i386/opcode.d: Likewise.

opcodes/

2010-08-05  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (dis386_twobyte): Replace ud2a/ud2b with ud2/ud1.

	* i386-opc.tbl: Add ud1.  Remove Cpu686 from ud2/ud2a/ud2b.
	* i386-tbl.h: Regenerated.
@
text
@d2625 2
a2626 2
    { "prefetch",	{ Eb } },
    { "prefetchw",	{ Eb } },
@


1.248
log
@Add 0F to VEX opcode enums.

2010-07-28  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c: Add 0F to VEX opcode enums.
@
text
@d1962 1
a1962 1
  { "ud2a",		{ XX } },
d2158 1
a2158 1
  { "ud2b",		{ XX } },
@


1.247
log
@Replace rdrnd with rdrand.

gas/testsuite/

2010-07-05  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (June, 2010)
	* gas/i386/rdrnd.s: Replace rdrnd with rdrand.
	* gas/i386/rdrnd-intel.d: Likewise.
	* gas/i386/rdrnd.d: Likewise.
	* gas/i386/x86-64-rdrnd-intel.d: Likewise.
	* gas/i386/x86-64-rdrnd.d: Likewise.
	* gas/i386/x86-64-rdrnd.s: Likewise.

opcodes/

2010-07-05  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (June, 2010)
	* i386-dis.c (mod_table): Replace rdrnd with rdrand.
	* i386-opc.tbl: Likewise.
	* i386-tbl.h: Regenerated.
@
text
@d597 4
a600 4
  REG_VEX_71,
  REG_VEX_72,
  REG_VEX_73,
  REG_VEX_AE,
d662 29
a690 29
  MOD_VEX_12_PREFIX_0,
  MOD_VEX_13,
  MOD_VEX_16_PREFIX_0,
  MOD_VEX_17,
  MOD_VEX_2B,
  MOD_VEX_50,
  MOD_VEX_71_REG_2,
  MOD_VEX_71_REG_4,
  MOD_VEX_71_REG_6,
  MOD_VEX_72_REG_2,
  MOD_VEX_72_REG_4,
  MOD_VEX_72_REG_6,
  MOD_VEX_73_REG_2,
  MOD_VEX_73_REG_3,
  MOD_VEX_73_REG_6,
  MOD_VEX_73_REG_7,
  MOD_VEX_AE_REG_2,
  MOD_VEX_AE_REG_3,
  MOD_VEX_D7_PREFIX_2,
  MOD_VEX_E7_PREFIX_2,
  MOD_VEX_F0_PREFIX_3,
  MOD_VEX_3818_PREFIX_2,
  MOD_VEX_3819_PREFIX_2,
  MOD_VEX_381A_PREFIX_2,
  MOD_VEX_382A_PREFIX_2,
  MOD_VEX_382C_PREFIX_2,
  MOD_VEX_382D_PREFIX_2,
  MOD_VEX_382E_PREFIX_2,
  MOD_VEX_382F_PREFIX_2
d822 250
a1071 250
  PREFIX_VEX_10,
  PREFIX_VEX_11,
  PREFIX_VEX_12,
  PREFIX_VEX_16,
  PREFIX_VEX_2A,
  PREFIX_VEX_2C,
  PREFIX_VEX_2D,
  PREFIX_VEX_2E,
  PREFIX_VEX_2F,
  PREFIX_VEX_51,
  PREFIX_VEX_52,
  PREFIX_VEX_53,
  PREFIX_VEX_58,
  PREFIX_VEX_59,
  PREFIX_VEX_5A,
  PREFIX_VEX_5B,
  PREFIX_VEX_5C,
  PREFIX_VEX_5D,
  PREFIX_VEX_5E,
  PREFIX_VEX_5F,
  PREFIX_VEX_60,
  PREFIX_VEX_61,
  PREFIX_VEX_62,
  PREFIX_VEX_63,
  PREFIX_VEX_64,
  PREFIX_VEX_65,
  PREFIX_VEX_66,
  PREFIX_VEX_67,
  PREFIX_VEX_68,
  PREFIX_VEX_69,
  PREFIX_VEX_6A,
  PREFIX_VEX_6B,
  PREFIX_VEX_6C,
  PREFIX_VEX_6D,
  PREFIX_VEX_6E,
  PREFIX_VEX_6F,
  PREFIX_VEX_70,
  PREFIX_VEX_71_REG_2,
  PREFIX_VEX_71_REG_4,
  PREFIX_VEX_71_REG_6,
  PREFIX_VEX_72_REG_2,
  PREFIX_VEX_72_REG_4,
  PREFIX_VEX_72_REG_6,
  PREFIX_VEX_73_REG_2,
  PREFIX_VEX_73_REG_3,
  PREFIX_VEX_73_REG_6,
  PREFIX_VEX_73_REG_7,
  PREFIX_VEX_74,
  PREFIX_VEX_75,
  PREFIX_VEX_76,
  PREFIX_VEX_77,
  PREFIX_VEX_7C,
  PREFIX_VEX_7D,
  PREFIX_VEX_7E,
  PREFIX_VEX_7F,
  PREFIX_VEX_C2,
  PREFIX_VEX_C4,
  PREFIX_VEX_C5,
  PREFIX_VEX_D0,
  PREFIX_VEX_D1,
  PREFIX_VEX_D2,
  PREFIX_VEX_D3,
  PREFIX_VEX_D4,
  PREFIX_VEX_D5,
  PREFIX_VEX_D6,
  PREFIX_VEX_D7,
  PREFIX_VEX_D8,
  PREFIX_VEX_D9,
  PREFIX_VEX_DA,
  PREFIX_VEX_DB,
  PREFIX_VEX_DC,
  PREFIX_VEX_DD,
  PREFIX_VEX_DE,
  PREFIX_VEX_DF,
  PREFIX_VEX_E0,
  PREFIX_VEX_E1,
  PREFIX_VEX_E2,
  PREFIX_VEX_E3,
  PREFIX_VEX_E4,
  PREFIX_VEX_E5,
  PREFIX_VEX_E6,
  PREFIX_VEX_E7,
  PREFIX_VEX_E8,
  PREFIX_VEX_E9,
  PREFIX_VEX_EA,
  PREFIX_VEX_EB,
  PREFIX_VEX_EC,
  PREFIX_VEX_ED,
  PREFIX_VEX_EE,
  PREFIX_VEX_EF,
  PREFIX_VEX_F0,
  PREFIX_VEX_F1,
  PREFIX_VEX_F2,
  PREFIX_VEX_F3,
  PREFIX_VEX_F4,
  PREFIX_VEX_F5,
  PREFIX_VEX_F6,
  PREFIX_VEX_F7,
  PREFIX_VEX_F8,
  PREFIX_VEX_F9,
  PREFIX_VEX_FA,
  PREFIX_VEX_FB,
  PREFIX_VEX_FC,
  PREFIX_VEX_FD,
  PREFIX_VEX_FE,
  PREFIX_VEX_3800,
  PREFIX_VEX_3801,
  PREFIX_VEX_3802,
  PREFIX_VEX_3803,
  PREFIX_VEX_3804,
  PREFIX_VEX_3805,
  PREFIX_VEX_3806,
  PREFIX_VEX_3807,
  PREFIX_VEX_3808,
  PREFIX_VEX_3809,
  PREFIX_VEX_380A,
  PREFIX_VEX_380B,
  PREFIX_VEX_380C,
  PREFIX_VEX_380D,
  PREFIX_VEX_380E,
  PREFIX_VEX_380F,
  PREFIX_VEX_3813,
  PREFIX_VEX_3817,
  PREFIX_VEX_3818,
  PREFIX_VEX_3819,
  PREFIX_VEX_381A,
  PREFIX_VEX_381C,
  PREFIX_VEX_381D,
  PREFIX_VEX_381E,
  PREFIX_VEX_3820,
  PREFIX_VEX_3821,
  PREFIX_VEX_3822,
  PREFIX_VEX_3823,
  PREFIX_VEX_3824,
  PREFIX_VEX_3825,
  PREFIX_VEX_3828,
  PREFIX_VEX_3829,
  PREFIX_VEX_382A,
  PREFIX_VEX_382B,
  PREFIX_VEX_382C,
  PREFIX_VEX_382D,
  PREFIX_VEX_382E,
  PREFIX_VEX_382F,
  PREFIX_VEX_3830,
  PREFIX_VEX_3831,
  PREFIX_VEX_3832,
  PREFIX_VEX_3833,
  PREFIX_VEX_3834,
  PREFIX_VEX_3835,
  PREFIX_VEX_3837,
  PREFIX_VEX_3838,
  PREFIX_VEX_3839,
  PREFIX_VEX_383A,
  PREFIX_VEX_383B,
  PREFIX_VEX_383C,
  PREFIX_VEX_383D,
  PREFIX_VEX_383E,
  PREFIX_VEX_383F,
  PREFIX_VEX_3840,
  PREFIX_VEX_3841,
  PREFIX_VEX_3896,
  PREFIX_VEX_3897,
  PREFIX_VEX_3898,
  PREFIX_VEX_3899,
  PREFIX_VEX_389A,
  PREFIX_VEX_389B,
  PREFIX_VEX_389C,
  PREFIX_VEX_389D,
  PREFIX_VEX_389E,
  PREFIX_VEX_389F,
  PREFIX_VEX_38A6,
  PREFIX_VEX_38A7,
  PREFIX_VEX_38A8,
  PREFIX_VEX_38A9,
  PREFIX_VEX_38AA,
  PREFIX_VEX_38AB,
  PREFIX_VEX_38AC,
  PREFIX_VEX_38AD,
  PREFIX_VEX_38AE,
  PREFIX_VEX_38AF,
  PREFIX_VEX_38B6,
  PREFIX_VEX_38B7,
  PREFIX_VEX_38B8,
  PREFIX_VEX_38B9,
  PREFIX_VEX_38BA,
  PREFIX_VEX_38BB,
  PREFIX_VEX_38BC,
  PREFIX_VEX_38BD,
  PREFIX_VEX_38BE,
  PREFIX_VEX_38BF,
  PREFIX_VEX_38DB,
  PREFIX_VEX_38DC,
  PREFIX_VEX_38DD,
  PREFIX_VEX_38DE,
  PREFIX_VEX_38DF,
  PREFIX_VEX_3A04,
  PREFIX_VEX_3A05,
  PREFIX_VEX_3A06,
  PREFIX_VEX_3A08,
  PREFIX_VEX_3A09,
  PREFIX_VEX_3A0A,
  PREFIX_VEX_3A0B,
  PREFIX_VEX_3A0C,
  PREFIX_VEX_3A0D,
  PREFIX_VEX_3A0E,
  PREFIX_VEX_3A0F,
  PREFIX_VEX_3A14,
  PREFIX_VEX_3A15,
  PREFIX_VEX_3A16,
  PREFIX_VEX_3A17,
  PREFIX_VEX_3A18,
  PREFIX_VEX_3A19,
  PREFIX_VEX_3A1D,
  PREFIX_VEX_3A20,
  PREFIX_VEX_3A21,
  PREFIX_VEX_3A22,
  PREFIX_VEX_3A40,
  PREFIX_VEX_3A41,
  PREFIX_VEX_3A42,
  PREFIX_VEX_3A44,
  PREFIX_VEX_3A48,
  PREFIX_VEX_3A49,
  PREFIX_VEX_3A4A,
  PREFIX_VEX_3A4B,
  PREFIX_VEX_3A4C,
  PREFIX_VEX_3A5C,
  PREFIX_VEX_3A5D,
  PREFIX_VEX_3A5E,
  PREFIX_VEX_3A5F,
  PREFIX_VEX_3A60,
  PREFIX_VEX_3A61,
  PREFIX_VEX_3A62,
  PREFIX_VEX_3A63,
  PREFIX_VEX_3A68,
  PREFIX_VEX_3A69,
  PREFIX_VEX_3A6A,
  PREFIX_VEX_3A6B,
  PREFIX_VEX_3A6C,
  PREFIX_VEX_3A6D,
  PREFIX_VEX_3A6E,
  PREFIX_VEX_3A6F,
  PREFIX_VEX_3A78,
  PREFIX_VEX_3A79,
  PREFIX_VEX_3A7A,
  PREFIX_VEX_3A7B,
  PREFIX_VEX_3A7C,
  PREFIX_VEX_3A7D,
  PREFIX_VEX_3A7E,
  PREFIX_VEX_3A7F,
  PREFIX_VEX_3ADF
d1129 204
a1332 204
  VEX_LEN_10_P_1 = 0,
  VEX_LEN_10_P_3,
  VEX_LEN_11_P_1,
  VEX_LEN_11_P_3,
  VEX_LEN_12_P_0_M_0,
  VEX_LEN_12_P_0_M_1,
  VEX_LEN_12_P_2,
  VEX_LEN_13_M_0,
  VEX_LEN_16_P_0_M_0,
  VEX_LEN_16_P_0_M_1,
  VEX_LEN_16_P_2,
  VEX_LEN_17_M_0,
  VEX_LEN_2A_P_1,
  VEX_LEN_2A_P_3,
  VEX_LEN_2C_P_1,
  VEX_LEN_2C_P_3,
  VEX_LEN_2D_P_1,
  VEX_LEN_2D_P_3,
  VEX_LEN_2E_P_0,
  VEX_LEN_2E_P_2,
  VEX_LEN_2F_P_0,
  VEX_LEN_2F_P_2,
  VEX_LEN_51_P_1,
  VEX_LEN_51_P_3,
  VEX_LEN_52_P_1,
  VEX_LEN_53_P_1,
  VEX_LEN_58_P_1,
  VEX_LEN_58_P_3,
  VEX_LEN_59_P_1,
  VEX_LEN_59_P_3,
  VEX_LEN_5A_P_1,
  VEX_LEN_5A_P_3,
  VEX_LEN_5C_P_1,
  VEX_LEN_5C_P_3,
  VEX_LEN_5D_P_1,
  VEX_LEN_5D_P_3,
  VEX_LEN_5E_P_1,
  VEX_LEN_5E_P_3,
  VEX_LEN_5F_P_1,
  VEX_LEN_5F_P_3,
  VEX_LEN_60_P_2,
  VEX_LEN_61_P_2,
  VEX_LEN_62_P_2,
  VEX_LEN_63_P_2,
  VEX_LEN_64_P_2,
  VEX_LEN_65_P_2,
  VEX_LEN_66_P_2,
  VEX_LEN_67_P_2,
  VEX_LEN_68_P_2,
  VEX_LEN_69_P_2,
  VEX_LEN_6A_P_2,
  VEX_LEN_6B_P_2,
  VEX_LEN_6C_P_2,
  VEX_LEN_6D_P_2,
  VEX_LEN_6E_P_2,
  VEX_LEN_70_P_1,
  VEX_LEN_70_P_2,
  VEX_LEN_70_P_3,
  VEX_LEN_71_R_2_P_2,
  VEX_LEN_71_R_4_P_2,
  VEX_LEN_71_R_6_P_2,
  VEX_LEN_72_R_2_P_2,
  VEX_LEN_72_R_4_P_2,
  VEX_LEN_72_R_6_P_2,
  VEX_LEN_73_R_2_P_2,
  VEX_LEN_73_R_3_P_2,
  VEX_LEN_73_R_6_P_2,
  VEX_LEN_73_R_7_P_2,
  VEX_LEN_74_P_2,
  VEX_LEN_75_P_2,
  VEX_LEN_76_P_2,
  VEX_LEN_7E_P_1,
  VEX_LEN_7E_P_2,
  VEX_LEN_AE_R_2_M_0,
  VEX_LEN_AE_R_3_M_0,
  VEX_LEN_C2_P_1,
  VEX_LEN_C2_P_3,
  VEX_LEN_C4_P_2,
  VEX_LEN_C5_P_2,
  VEX_LEN_D1_P_2,
  VEX_LEN_D2_P_2,
  VEX_LEN_D3_P_2,
  VEX_LEN_D4_P_2,
  VEX_LEN_D5_P_2,
  VEX_LEN_D6_P_2,
  VEX_LEN_D7_P_2_M_1,
  VEX_LEN_D8_P_2,
  VEX_LEN_D9_P_2,
  VEX_LEN_DA_P_2,
  VEX_LEN_DB_P_2,
  VEX_LEN_DC_P_2,
  VEX_LEN_DD_P_2,
  VEX_LEN_DE_P_2,
  VEX_LEN_DF_P_2,
  VEX_LEN_E0_P_2,
  VEX_LEN_E1_P_2,
  VEX_LEN_E2_P_2,
  VEX_LEN_E3_P_2,
  VEX_LEN_E4_P_2,
  VEX_LEN_E5_P_2,
  VEX_LEN_E8_P_2,
  VEX_LEN_E9_P_2,
  VEX_LEN_EA_P_2,
  VEX_LEN_EB_P_2,
  VEX_LEN_EC_P_2,
  VEX_LEN_ED_P_2,
  VEX_LEN_EE_P_2,
  VEX_LEN_EF_P_2,
  VEX_LEN_F1_P_2,
  VEX_LEN_F2_P_2,
  VEX_LEN_F3_P_2,
  VEX_LEN_F4_P_2,
  VEX_LEN_F5_P_2,
  VEX_LEN_F6_P_2,
  VEX_LEN_F7_P_2,
  VEX_LEN_F8_P_2,
  VEX_LEN_F9_P_2,
  VEX_LEN_FA_P_2,
  VEX_LEN_FB_P_2,
  VEX_LEN_FC_P_2,
  VEX_LEN_FD_P_2,
  VEX_LEN_FE_P_2,
  VEX_LEN_3800_P_2,
  VEX_LEN_3801_P_2,
  VEX_LEN_3802_P_2,
  VEX_LEN_3803_P_2,
  VEX_LEN_3804_P_2,
  VEX_LEN_3805_P_2,
  VEX_LEN_3806_P_2,
  VEX_LEN_3807_P_2,
  VEX_LEN_3808_P_2,
  VEX_LEN_3809_P_2,
  VEX_LEN_380A_P_2,
  VEX_LEN_380B_P_2,
  VEX_LEN_3819_P_2_M_0,
  VEX_LEN_381A_P_2_M_0,
  VEX_LEN_381C_P_2,
  VEX_LEN_381D_P_2,
  VEX_LEN_381E_P_2,
  VEX_LEN_3820_P_2,
  VEX_LEN_3821_P_2,
  VEX_LEN_3822_P_2,
  VEX_LEN_3823_P_2,
  VEX_LEN_3824_P_2,
  VEX_LEN_3825_P_2,
  VEX_LEN_3828_P_2,
  VEX_LEN_3829_P_2,
  VEX_LEN_382A_P_2_M_0,
  VEX_LEN_382B_P_2,
  VEX_LEN_3830_P_2,
  VEX_LEN_3831_P_2,
  VEX_LEN_3832_P_2,
  VEX_LEN_3833_P_2,
  VEX_LEN_3834_P_2,
  VEX_LEN_3835_P_2,
  VEX_LEN_3837_P_2,
  VEX_LEN_3838_P_2,
  VEX_LEN_3839_P_2,
  VEX_LEN_383A_P_2,
  VEX_LEN_383B_P_2,
  VEX_LEN_383C_P_2,
  VEX_LEN_383D_P_2,
  VEX_LEN_383E_P_2,
  VEX_LEN_383F_P_2,
  VEX_LEN_3840_P_2,
  VEX_LEN_3841_P_2,
  VEX_LEN_38DB_P_2,
  VEX_LEN_38DC_P_2,
  VEX_LEN_38DD_P_2,
  VEX_LEN_38DE_P_2,
  VEX_LEN_38DF_P_2,
  VEX_LEN_3A06_P_2,
  VEX_LEN_3A0A_P_2,
  VEX_LEN_3A0B_P_2,
  VEX_LEN_3A0E_P_2,
  VEX_LEN_3A0F_P_2,
  VEX_LEN_3A14_P_2,
  VEX_LEN_3A15_P_2,
  VEX_LEN_3A16_P_2,
  VEX_LEN_3A17_P_2,
  VEX_LEN_3A18_P_2,
  VEX_LEN_3A19_P_2,
  VEX_LEN_3A20_P_2,
  VEX_LEN_3A21_P_2,
  VEX_LEN_3A22_P_2,
  VEX_LEN_3A41_P_2,
  VEX_LEN_3A42_P_2,
  VEX_LEN_3A44_P_2,
  VEX_LEN_3A4C_P_2,
  VEX_LEN_3A60_P_2,
  VEX_LEN_3A61_P_2,
  VEX_LEN_3A62_P_2,
  VEX_LEN_3A63_P_2,
  VEX_LEN_3A6A_P_2,
  VEX_LEN_3A6B_P_2,
  VEX_LEN_3A6E_P_2,
  VEX_LEN_3A6F_P_2,
  VEX_LEN_3A7A_P_2,
  VEX_LEN_3A7B_P_2,
  VEX_LEN_3A7E_P_2,
  VEX_LEN_3A7F_P_2,
  VEX_LEN_3ADF_P_2,
  VEX_LEN_XOP_09_80,
  VEX_LEN_XOP_09_81
d1337 255
a1591 255
  VEX_W_10_P_0 = 0,
  VEX_W_10_P_1,
  VEX_W_10_P_2,
  VEX_W_10_P_3,
  VEX_W_11_P_0,
  VEX_W_11_P_1,
  VEX_W_11_P_2,
  VEX_W_11_P_3,
  VEX_W_12_P_0_M_0,
  VEX_W_12_P_0_M_1,
  VEX_W_12_P_1,
  VEX_W_12_P_2,
  VEX_W_12_P_3,
  VEX_W_13_M_0,
  VEX_W_14,
  VEX_W_15,
  VEX_W_16_P_0_M_0,
  VEX_W_16_P_0_M_1,
  VEX_W_16_P_1,
  VEX_W_16_P_2,
  VEX_W_17_M_0,
  VEX_W_28,
  VEX_W_29,
  VEX_W_2B_M_0,
  VEX_W_2E_P_0,
  VEX_W_2E_P_2,
  VEX_W_2F_P_0,
  VEX_W_2F_P_2,
  VEX_W_50_M_0,
  VEX_W_51_P_0,
  VEX_W_51_P_1,
  VEX_W_51_P_2,
  VEX_W_51_P_3,
  VEX_W_52_P_0,
  VEX_W_52_P_1,
  VEX_W_53_P_0,
  VEX_W_53_P_1,
  VEX_W_58_P_0,
  VEX_W_58_P_1,
  VEX_W_58_P_2,
  VEX_W_58_P_3,
  VEX_W_59_P_0,
  VEX_W_59_P_1,
  VEX_W_59_P_2,
  VEX_W_59_P_3,
  VEX_W_5A_P_0,
  VEX_W_5A_P_1,
  VEX_W_5A_P_3,
  VEX_W_5B_P_0,
  VEX_W_5B_P_1,
  VEX_W_5B_P_2,
  VEX_W_5C_P_0,
  VEX_W_5C_P_1,
  VEX_W_5C_P_2,
  VEX_W_5C_P_3,
  VEX_W_5D_P_0,
  VEX_W_5D_P_1,
  VEX_W_5D_P_2,
  VEX_W_5D_P_3,
  VEX_W_5E_P_0,
  VEX_W_5E_P_1,
  VEX_W_5E_P_2,
  VEX_W_5E_P_3,
  VEX_W_5F_P_0,
  VEX_W_5F_P_1,
  VEX_W_5F_P_2,
  VEX_W_5F_P_3,
  VEX_W_60_P_2,
  VEX_W_61_P_2,
  VEX_W_62_P_2,
  VEX_W_63_P_2,
  VEX_W_64_P_2,
  VEX_W_65_P_2,
  VEX_W_66_P_2,
  VEX_W_67_P_2,
  VEX_W_68_P_2,
  VEX_W_69_P_2,
  VEX_W_6A_P_2,
  VEX_W_6B_P_2,
  VEX_W_6C_P_2,
  VEX_W_6D_P_2,
  VEX_W_6F_P_1,
  VEX_W_6F_P_2,
  VEX_W_70_P_1,
  VEX_W_70_P_2,
  VEX_W_70_P_3,
  VEX_W_71_R_2_P_2,
  VEX_W_71_R_4_P_2,
  VEX_W_71_R_6_P_2,
  VEX_W_72_R_2_P_2,
  VEX_W_72_R_4_P_2,
  VEX_W_72_R_6_P_2,
  VEX_W_73_R_2_P_2,
  VEX_W_73_R_3_P_2,
  VEX_W_73_R_6_P_2,
  VEX_W_73_R_7_P_2,
  VEX_W_74_P_2,
  VEX_W_75_P_2,
  VEX_W_76_P_2,
  VEX_W_77_P_0,
  VEX_W_7C_P_2,
  VEX_W_7C_P_3,
  VEX_W_7D_P_2,
  VEX_W_7D_P_3,
  VEX_W_7E_P_1,
  VEX_W_7F_P_1,
  VEX_W_7F_P_2,
  VEX_W_AE_R_2_M_0,
  VEX_W_AE_R_3_M_0,
  VEX_W_C2_P_0,
  VEX_W_C2_P_1,
  VEX_W_C2_P_2,
  VEX_W_C2_P_3,
  VEX_W_C4_P_2,
  VEX_W_C5_P_2,
  VEX_W_D0_P_2,
  VEX_W_D0_P_3,
  VEX_W_D1_P_2,
  VEX_W_D2_P_2,
  VEX_W_D3_P_2,
  VEX_W_D4_P_2,
  VEX_W_D5_P_2,
  VEX_W_D6_P_2,
  VEX_W_D7_P_2_M_1,
  VEX_W_D8_P_2,
  VEX_W_D9_P_2,
  VEX_W_DA_P_2,
  VEX_W_DB_P_2,
  VEX_W_DC_P_2,
  VEX_W_DD_P_2,
  VEX_W_DE_P_2,
  VEX_W_DF_P_2,
  VEX_W_E0_P_2,
  VEX_W_E1_P_2,
  VEX_W_E2_P_2,
  VEX_W_E3_P_2,
  VEX_W_E4_P_2,
  VEX_W_E5_P_2,
  VEX_W_E6_P_1,
  VEX_W_E6_P_2,
  VEX_W_E6_P_3,
  VEX_W_E7_P_2_M_0,
  VEX_W_E8_P_2,
  VEX_W_E9_P_2,
  VEX_W_EA_P_2,
  VEX_W_EB_P_2,
  VEX_W_EC_P_2,
  VEX_W_ED_P_2,
  VEX_W_EE_P_2,
  VEX_W_EF_P_2,
  VEX_W_F0_P_3_M_0,
  VEX_W_F1_P_2,
  VEX_W_F2_P_2,
  VEX_W_F3_P_2,
  VEX_W_F4_P_2,
  VEX_W_F5_P_2,
  VEX_W_F6_P_2,
  VEX_W_F7_P_2,
  VEX_W_F8_P_2,
  VEX_W_F9_P_2,
  VEX_W_FA_P_2,
  VEX_W_FB_P_2,
  VEX_W_FC_P_2,
  VEX_W_FD_P_2,
  VEX_W_FE_P_2,
  VEX_W_3800_P_2,
  VEX_W_3801_P_2,
  VEX_W_3802_P_2,
  VEX_W_3803_P_2,
  VEX_W_3804_P_2,
  VEX_W_3805_P_2,
  VEX_W_3806_P_2,
  VEX_W_3807_P_2,
  VEX_W_3808_P_2,
  VEX_W_3809_P_2,
  VEX_W_380A_P_2,
  VEX_W_380B_P_2,
  VEX_W_380C_P_2,
  VEX_W_380D_P_2,
  VEX_W_380E_P_2,
  VEX_W_380F_P_2,
  VEX_W_3817_P_2,
  VEX_W_3818_P_2_M_0,
  VEX_W_3819_P_2_M_0,
  VEX_W_381A_P_2_M_0,
  VEX_W_381C_P_2,
  VEX_W_381D_P_2,
  VEX_W_381E_P_2,
  VEX_W_3820_P_2,
  VEX_W_3821_P_2,
  VEX_W_3822_P_2,
  VEX_W_3823_P_2,
  VEX_W_3824_P_2,
  VEX_W_3825_P_2,
  VEX_W_3828_P_2,
  VEX_W_3829_P_2,
  VEX_W_382A_P_2_M_0,
  VEX_W_382B_P_2,
  VEX_W_382C_P_2_M_0,
  VEX_W_382D_P_2_M_0,
  VEX_W_382E_P_2_M_0,
  VEX_W_382F_P_2_M_0,
  VEX_W_3830_P_2,
  VEX_W_3831_P_2,
  VEX_W_3832_P_2,
  VEX_W_3833_P_2,
  VEX_W_3834_P_2,
  VEX_W_3835_P_2,
  VEX_W_3837_P_2,
  VEX_W_3838_P_2,
  VEX_W_3839_P_2,
  VEX_W_383A_P_2,
  VEX_W_383B_P_2,
  VEX_W_383C_P_2,
  VEX_W_383D_P_2,
  VEX_W_383E_P_2,
  VEX_W_383F_P_2,
  VEX_W_3840_P_2,
  VEX_W_3841_P_2,
  VEX_W_38DB_P_2,
  VEX_W_38DC_P_2,
  VEX_W_38DD_P_2,
  VEX_W_38DE_P_2,
  VEX_W_38DF_P_2,
  VEX_W_3A04_P_2,
  VEX_W_3A05_P_2,
  VEX_W_3A06_P_2,
  VEX_W_3A08_P_2,
  VEX_W_3A09_P_2,
  VEX_W_3A0A_P_2,
  VEX_W_3A0B_P_2,
  VEX_W_3A0C_P_2,
  VEX_W_3A0D_P_2,
  VEX_W_3A0E_P_2,
  VEX_W_3A0F_P_2,
  VEX_W_3A14_P_2,
  VEX_W_3A15_P_2,
  VEX_W_3A18_P_2,
  VEX_W_3A19_P_2,
  VEX_W_3A20_P_2,
  VEX_W_3A21_P_2,
  VEX_W_3A40_P_2,
  VEX_W_3A41_P_2,
  VEX_W_3A42_P_2,
  VEX_W_3A44_P_2,
  VEX_W_3A48_P_2,
  VEX_W_3A49_P_2,
  VEX_W_3A4A_P_2,
  VEX_W_3A4B_P_2,
  VEX_W_3A4C_P_2,
  VEX_W_3A60_P_2,
  VEX_W_3A61_P_2,
  VEX_W_3A62_P_2,
  VEX_W_3A63_P_2,
  VEX_W_3ADF_P_2
d2714 1
a2714 1
  /* REG_VEX_71 */
d2718 1
a2718 1
    { MOD_TABLE (MOD_VEX_71_REG_2) },
d2720 1
a2720 1
    { MOD_TABLE (MOD_VEX_71_REG_4) },
d2722 1
a2722 1
    { MOD_TABLE (MOD_VEX_71_REG_6) },
d2724 1
a2724 1
  /* REG_VEX_72 */
d2728 1
a2728 1
    { MOD_TABLE (MOD_VEX_72_REG_2) },
d2730 1
a2730 1
    { MOD_TABLE (MOD_VEX_72_REG_4) },
d2732 1
a2732 1
    { MOD_TABLE (MOD_VEX_72_REG_6) },
d2734 1
a2734 1
  /* REG_VEX_73 */
d2738 2
a2739 2
    { MOD_TABLE (MOD_VEX_73_REG_2) },
    { MOD_TABLE (MOD_VEX_73_REG_3) },
d2742 2
a2743 2
    { MOD_TABLE (MOD_VEX_73_REG_6) },
    { MOD_TABLE (MOD_VEX_73_REG_7) },
d2745 1
a2745 1
  /* REG_VEX_AE */
d2749 2
a2750 2
    { MOD_TABLE (MOD_VEX_AE_REG_2) },
    { MOD_TABLE (MOD_VEX_AE_REG_3) },
d3588 1
a3588 1
  /* PREFIX_VEX_10 */
d3590 4
a3593 4
    { VEX_W_TABLE (VEX_W_10_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_10_P_1) },
    { VEX_W_TABLE (VEX_W_10_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_10_P_3) },
d3596 1
a3596 1
  /* PREFIX_VEX_11 */
d3598 4
a3601 4
    { VEX_W_TABLE (VEX_W_11_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_11_P_1) },
    { VEX_W_TABLE (VEX_W_11_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_11_P_3) },
d3604 1
a3604 1
  /* PREFIX_VEX_12 */
d3606 4
a3609 4
    { MOD_TABLE (MOD_VEX_12_PREFIX_0) },
    { VEX_W_TABLE (VEX_W_12_P_1) },
    { VEX_LEN_TABLE (VEX_LEN_12_P_2) },
    { VEX_W_TABLE (VEX_W_12_P_3) },
d3612 1
a3612 1
  /* PREFIX_VEX_16 */
d3614 3
a3616 3
    { MOD_TABLE (MOD_VEX_16_PREFIX_0) },
    { VEX_W_TABLE (VEX_W_16_P_1) },
    { VEX_LEN_TABLE (VEX_LEN_16_P_2) },
d3619 1
a3619 1
  /* PREFIX_VEX_2A */
d3622 1
a3622 1
    { VEX_LEN_TABLE (VEX_LEN_2A_P_1) },
d3624 1
a3624 1
    { VEX_LEN_TABLE (VEX_LEN_2A_P_3) },
d3627 1
a3627 1
  /* PREFIX_VEX_2C */
d3630 1
a3630 1
    { VEX_LEN_TABLE (VEX_LEN_2C_P_1) },
d3632 1
a3632 1
    { VEX_LEN_TABLE (VEX_LEN_2C_P_3) },
d3635 1
a3635 1
  /* PREFIX_VEX_2D */
d3638 1
a3638 1
    { VEX_LEN_TABLE (VEX_LEN_2D_P_1) },
d3640 1
a3640 1
    { VEX_LEN_TABLE (VEX_LEN_2D_P_3) },
d3643 1
a3643 1
  /* PREFIX_VEX_2E */
d3645 1
a3645 1
    { VEX_LEN_TABLE (VEX_LEN_2E_P_0) },
d3647 1
a3647 1
    { VEX_LEN_TABLE (VEX_LEN_2E_P_2) },
d3650 1
a3650 1
  /* PREFIX_VEX_2F */
d3652 1
a3652 1
    { VEX_LEN_TABLE (VEX_LEN_2F_P_0) },
d3654 1
a3654 1
    { VEX_LEN_TABLE (VEX_LEN_2F_P_2) },
d3657 1
a3657 1
  /* PREFIX_VEX_51 */
d3659 4
a3662 4
    { VEX_W_TABLE (VEX_W_51_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_51_P_1) },
    { VEX_W_TABLE (VEX_W_51_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_51_P_3) },
d3665 1
a3665 1
  /* PREFIX_VEX_52 */
d3667 2
a3668 2
    { VEX_W_TABLE (VEX_W_52_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_52_P_1) },
d3671 1
a3671 1
  /* PREFIX_VEX_53 */
d3673 2
a3674 2
    { VEX_W_TABLE (VEX_W_53_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_53_P_1) },
d3677 1
a3677 1
  /* PREFIX_VEX_58 */
d3679 4
a3682 4
    { VEX_W_TABLE (VEX_W_58_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_58_P_1) },
    { VEX_W_TABLE (VEX_W_58_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_58_P_3) },
d3685 1
a3685 1
  /* PREFIX_VEX_59 */
d3687 4
a3690 4
    { VEX_W_TABLE (VEX_W_59_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_59_P_1) },
    { VEX_W_TABLE (VEX_W_59_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_59_P_3) },
d3693 1
a3693 1
  /* PREFIX_VEX_5A */
d3695 2
a3696 2
    { VEX_W_TABLE (VEX_W_5A_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_5A_P_1) },
d3698 1
a3698 1
    { VEX_LEN_TABLE (VEX_LEN_5A_P_3) },
d3701 1
a3701 1
  /* PREFIX_VEX_5B */
d3703 3
a3705 3
    { VEX_W_TABLE (VEX_W_5B_P_0) },
    { VEX_W_TABLE (VEX_W_5B_P_1) },
    { VEX_W_TABLE (VEX_W_5B_P_2) },
d3708 1
a3708 1
  /* PREFIX_VEX_5C */
d3710 4
a3713 4
    { VEX_W_TABLE (VEX_W_5C_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_5C_P_1) },
    { VEX_W_TABLE (VEX_W_5C_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_5C_P_3) },
d3716 1
a3716 1
  /* PREFIX_VEX_5D */
d3718 4
a3721 4
    { VEX_W_TABLE (VEX_W_5D_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_5D_P_1) },
    { VEX_W_TABLE (VEX_W_5D_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_5D_P_3) },
d3724 1
a3724 1
  /* PREFIX_VEX_5E */
d3726 4
a3729 4
    { VEX_W_TABLE (VEX_W_5E_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_5E_P_1) },
    { VEX_W_TABLE (VEX_W_5E_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_5E_P_3) },
d3732 1
a3732 1
  /* PREFIX_VEX_5F */
d3734 4
a3737 4
    { VEX_W_TABLE (VEX_W_5F_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_5F_P_1) },
    { VEX_W_TABLE (VEX_W_5F_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_5F_P_3) },
d3740 1
a3740 1
  /* PREFIX_VEX_60 */
d3744 1
a3744 1
    { VEX_LEN_TABLE (VEX_LEN_60_P_2) },
d3747 1
a3747 1
  /* PREFIX_VEX_61 */
d3751 1
a3751 1
    { VEX_LEN_TABLE (VEX_LEN_61_P_2) },
d3754 1
a3754 1
  /* PREFIX_VEX_62 */
d3758 1
a3758 1
    { VEX_LEN_TABLE (VEX_LEN_62_P_2) },
d3761 1
a3761 1
  /* PREFIX_VEX_63 */
d3765 1
a3765 1
    { VEX_LEN_TABLE (VEX_LEN_63_P_2) },
d3768 1
a3768 1
  /* PREFIX_VEX_64 */
d3772 1
a3772 1
    { VEX_LEN_TABLE (VEX_LEN_64_P_2) },
d3775 1
a3775 1
  /* PREFIX_VEX_65 */
d3779 1
a3779 1
    { VEX_LEN_TABLE (VEX_LEN_65_P_2) },
d3782 1
a3782 1
  /* PREFIX_VEX_66 */
d3786 1
a3786 1
    { VEX_LEN_TABLE (VEX_LEN_66_P_2) },
d3789 1
a3789 1
  /* PREFIX_VEX_67 */
d3793 1
a3793 1
    { VEX_LEN_TABLE (VEX_LEN_67_P_2) },
d3796 1
a3796 1
  /* PREFIX_VEX_68 */
d3800 1
a3800 1
    { VEX_LEN_TABLE (VEX_LEN_68_P_2) },
d3803 1
a3803 1
  /* PREFIX_VEX_69 */
d3807 1
a3807 1
    { VEX_LEN_TABLE (VEX_LEN_69_P_2) },
d3810 1
a3810 1
  /* PREFIX_VEX_6A */
d3814 1
a3814 1
    { VEX_LEN_TABLE (VEX_LEN_6A_P_2) },
d3817 1
a3817 1
  /* PREFIX_VEX_6B */
d3821 1
a3821 1
    { VEX_LEN_TABLE (VEX_LEN_6B_P_2) },
d3824 1
a3824 1
  /* PREFIX_VEX_6C */
d3828 1
a3828 1
    { VEX_LEN_TABLE (VEX_LEN_6C_P_2) },
d3831 1
a3831 1
  /* PREFIX_VEX_6D */
d3835 1
a3835 1
    { VEX_LEN_TABLE (VEX_LEN_6D_P_2) },
d3838 1
a3838 1
  /* PREFIX_VEX_6E */
d3842 1
a3842 1
    { VEX_LEN_TABLE (VEX_LEN_6E_P_2) },
d3845 1
a3845 1
  /* PREFIX_VEX_6F */
d3848 2
a3849 2
    { VEX_W_TABLE (VEX_W_6F_P_1) },
    { VEX_W_TABLE (VEX_W_6F_P_2) },
d3852 1
a3852 1
  /* PREFIX_VEX_70 */
d3855 3
a3857 3
    { VEX_LEN_TABLE (VEX_LEN_70_P_1) },
    { VEX_LEN_TABLE (VEX_LEN_70_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_70_P_3) },
d3860 1
a3860 1
  /* PREFIX_VEX_71_REG_2 */
d3864 1
a3864 1
    { VEX_LEN_TABLE (VEX_LEN_71_R_2_P_2) },
d3867 1
a3867 1
  /* PREFIX_VEX_71_REG_4 */
d3871 1
a3871 1
    { VEX_LEN_TABLE (VEX_LEN_71_R_4_P_2) },
d3874 1
a3874 1
  /* PREFIX_VEX_71_REG_6 */
d3878 1
a3878 1
    { VEX_LEN_TABLE (VEX_LEN_71_R_6_P_2) },
d3881 1
a3881 1
  /* PREFIX_VEX_72_REG_2 */
d3885 1
a3885 1
    { VEX_LEN_TABLE (VEX_LEN_72_R_2_P_2) },
d3888 1
a3888 1
  /* PREFIX_VEX_72_REG_4 */
d3892 1
a3892 1
    { VEX_LEN_TABLE (VEX_LEN_72_R_4_P_2) },
d3895 1
a3895 1
  /* PREFIX_VEX_72_REG_6 */
d3899 1
a3899 1
    { VEX_LEN_TABLE (VEX_LEN_72_R_6_P_2) },
d3902 1
a3902 1
  /* PREFIX_VEX_73_REG_2 */
d3906 1
a3906 1
    { VEX_LEN_TABLE (VEX_LEN_73_R_2_P_2) },
d3909 1
a3909 1
  /* PREFIX_VEX_73_REG_3 */
d3913 1
a3913 1
    { VEX_LEN_TABLE (VEX_LEN_73_R_3_P_2) },
d3916 1
a3916 1
  /* PREFIX_VEX_73_REG_6 */
d3920 1
a3920 1
    { VEX_LEN_TABLE (VEX_LEN_73_R_6_P_2) },
d3923 1
a3923 1
  /* PREFIX_VEX_73_REG_7 */
d3927 1
a3927 1
    { VEX_LEN_TABLE (VEX_LEN_73_R_7_P_2) },
d3930 1
a3930 1
  /* PREFIX_VEX_74 */
d3934 1
a3934 1
    { VEX_LEN_TABLE (VEX_LEN_74_P_2) },
d3937 1
a3937 1
  /* PREFIX_VEX_75 */
d3941 1
a3941 1
    { VEX_LEN_TABLE (VEX_LEN_75_P_2) },
d3944 1
a3944 1
  /* PREFIX_VEX_76 */
d3948 1
a3948 1
    { VEX_LEN_TABLE (VEX_LEN_76_P_2) },
d3951 1
a3951 1
  /* PREFIX_VEX_77 */
d3953 1
a3953 1
    { VEX_W_TABLE (VEX_W_77_P_0) },
d3956 1
a3956 1
  /* PREFIX_VEX_7C */
d3960 2
a3961 2
    { VEX_W_TABLE (VEX_W_7C_P_2) },
    { VEX_W_TABLE (VEX_W_7C_P_3) },
d3964 1
a3964 1
  /* PREFIX_VEX_7D */
d3968 2
a3969 2
    { VEX_W_TABLE (VEX_W_7D_P_2) },
    { VEX_W_TABLE (VEX_W_7D_P_3) },
d3972 1
a3972 1
  /* PREFIX_VEX_7E */
d3975 2
a3976 2
    { VEX_LEN_TABLE (VEX_LEN_7E_P_1) },
    { VEX_LEN_TABLE (VEX_LEN_7E_P_2) },
d3979 1
a3979 1
  /* PREFIX_VEX_7F */
d3982 2
a3983 2
    { VEX_W_TABLE (VEX_W_7F_P_1) },
    { VEX_W_TABLE (VEX_W_7F_P_2) },
d3986 1
a3986 1
  /* PREFIX_VEX_C2 */
d3988 4
a3991 4
    { VEX_W_TABLE (VEX_W_C2_P_0) },
    { VEX_LEN_TABLE (VEX_LEN_C2_P_1) },
    { VEX_W_TABLE (VEX_W_C2_P_2) },
    { VEX_LEN_TABLE (VEX_LEN_C2_P_3) },
d3994 1
a3994 1
  /* PREFIX_VEX_C4 */
d3998 1
a3998 1
    { VEX_LEN_TABLE (VEX_LEN_C4_P_2) },
d4001 1
a4001 1
  /* PREFIX_VEX_C5 */
d4005 1
a4005 1
    { VEX_LEN_TABLE (VEX_LEN_C5_P_2) },
d4008 1
a4008 1
  /* PREFIX_VEX_D0 */
d4012 2
a4013 2
    { VEX_W_TABLE (VEX_W_D0_P_2) },
    { VEX_W_TABLE (VEX_W_D0_P_3) },
d4016 1
a4016 1
  /* PREFIX_VEX_D1 */
d4020 1
a4020 1
    { VEX_LEN_TABLE (VEX_LEN_D1_P_2) },
d4023 1
a4023 1
  /* PREFIX_VEX_D2 */
d4027 1
a4027 1
    { VEX_LEN_TABLE (VEX_LEN_D2_P_2) },
d4030 1
a4030 1
  /* PREFIX_VEX_D3 */
d4034 1
a4034 1
    { VEX_LEN_TABLE (VEX_LEN_D3_P_2) },
d4037 1
a4037 1
  /* PREFIX_VEX_D4 */
d4041 1
a4041 1
    { VEX_LEN_TABLE (VEX_LEN_D4_P_2) },
d4044 1
a4044 1
  /* PREFIX_VEX_D5 */
d4048 1
a4048 1
    { VEX_LEN_TABLE (VEX_LEN_D5_P_2) },
d4051 1
a4051 1
  /* PREFIX_VEX_D6 */
d4055 1
a4055 1
    { VEX_LEN_TABLE (VEX_LEN_D6_P_2) },
d4058 1
a4058 1
  /* PREFIX_VEX_D7 */
d4062 1
a4062 1
    { MOD_TABLE (MOD_VEX_D7_PREFIX_2) },
d4065 1
a4065 1
  /* PREFIX_VEX_D8 */
d4069 1
a4069 1
    { VEX_LEN_TABLE (VEX_LEN_D8_P_2) },
d4072 1
a4072 1
  /* PREFIX_VEX_D9 */
d4076 1
a4076 1
    { VEX_LEN_TABLE (VEX_LEN_D9_P_2) },
d4079 1
a4079 1
  /* PREFIX_VEX_DA */
d4083 1
a4083 1
    { VEX_LEN_TABLE (VEX_LEN_DA_P_2) },
d4086 1
a4086 1
  /* PREFIX_VEX_DB */
d4090 1
a4090 1
    { VEX_LEN_TABLE (VEX_LEN_DB_P_2) },
d4093 1
a4093 1
  /* PREFIX_VEX_DC */
d4097 1
a4097 1
    { VEX_LEN_TABLE (VEX_LEN_DC_P_2) },
d4100 1
a4100 1
  /* PREFIX_VEX_DD */
d4104 1
a4104 1
    { VEX_LEN_TABLE (VEX_LEN_DD_P_2) },
d4107 1
a4107 1
  /* PREFIX_VEX_DE */
d4111 1
a4111 1
    { VEX_LEN_TABLE (VEX_LEN_DE_P_2) },
d4114 1
a4114 1
  /* PREFIX_VEX_DF */
d4118 1
a4118 1
    { VEX_LEN_TABLE (VEX_LEN_DF_P_2) },
d4121 1
a4121 1
  /* PREFIX_VEX_E0 */
d4125 1
a4125 1
    { VEX_LEN_TABLE (VEX_LEN_E0_P_2) },
d4128 1
a4128 1
  /* PREFIX_VEX_E1 */
d4132 1
a4132 1
    { VEX_LEN_TABLE (VEX_LEN_E1_P_2) },
d4135 1
a4135 1
  /* PREFIX_VEX_E2 */
d4139 1
a4139 1
    { VEX_LEN_TABLE (VEX_LEN_E2_P_2) },
d4142 1
a4142 1
  /* PREFIX_VEX_E3 */
d4146 1
a4146 1
    { VEX_LEN_TABLE (VEX_LEN_E3_P_2) },
d4149 1
a4149 1
  /* PREFIX_VEX_E4 */
d4153 1
a4153 1
    { VEX_LEN_TABLE (VEX_LEN_E4_P_2) },
d4156 1
a4156 1
  /* PREFIX_VEX_E5 */
d4160 1
a4160 1
    { VEX_LEN_TABLE (VEX_LEN_E5_P_2) },
d4163 1
a4163 1
  /* PREFIX_VEX_E6 */
d4166 3
a4168 3
    { VEX_W_TABLE (VEX_W_E6_P_1) },
    { VEX_W_TABLE (VEX_W_E6_P_2) },
    { VEX_W_TABLE (VEX_W_E6_P_3) },
d4171 1
a4171 1
  /* PREFIX_VEX_E7 */
d4175 1
a4175 1
    { MOD_TABLE (MOD_VEX_E7_PREFIX_2) },
d4178 1
a4178 1
  /* PREFIX_VEX_E8 */
d4182 1
a4182 1
    { VEX_LEN_TABLE (VEX_LEN_E8_P_2) },
d4185 1
a4185 1
  /* PREFIX_VEX_E9 */
d4189 1
a4189 1
    { VEX_LEN_TABLE (VEX_LEN_E9_P_2) },
d4192 1
a4192 1
  /* PREFIX_VEX_EA */
d4196 1
a4196 1
    { VEX_LEN_TABLE (VEX_LEN_EA_P_2) },
d4199 1
a4199 1
  /* PREFIX_VEX_EB */
d4203 1
a4203 1
    { VEX_LEN_TABLE (VEX_LEN_EB_P_2) },
d4206 1
a4206 1
  /* PREFIX_VEX_EC */
d4210 1
a4210 1
    { VEX_LEN_TABLE (VEX_LEN_EC_P_2) },
d4213 1
a4213 1
  /* PREFIX_VEX_ED */
d4217 1
a4217 1
    { VEX_LEN_TABLE (VEX_LEN_ED_P_2) },
d4220 1
a4220 1
  /* PREFIX_VEX_EE */
d4224 1
a4224 1
    { VEX_LEN_TABLE (VEX_LEN_EE_P_2) },
d4227 1
a4227 1
  /* PREFIX_VEX_EF */
d4231 1
a4231 1
    { VEX_LEN_TABLE (VEX_LEN_EF_P_2) },
d4234 1
a4234 1
  /* PREFIX_VEX_F0 */
d4239 1
a4239 1
    { MOD_TABLE (MOD_VEX_F0_PREFIX_3) },
d4242 1
a4242 1
  /* PREFIX_VEX_F1 */
d4246 1
a4246 1
    { VEX_LEN_TABLE (VEX_LEN_F1_P_2) },
d4249 1
a4249 1
  /* PREFIX_VEX_F2 */
d4253 1
a4253 1
    { VEX_LEN_TABLE (VEX_LEN_F2_P_2) },
d4256 1
a4256 1
  /* PREFIX_VEX_F3 */
d4260 1
a4260 1
    { VEX_LEN_TABLE (VEX_LEN_F3_P_2) },
d4263 1
a4263 1
  /* PREFIX_VEX_F4 */
d4267 1
a4267 1
    { VEX_LEN_TABLE (VEX_LEN_F4_P_2) },
d4270 1
a4270 1
  /* PREFIX_VEX_F5 */
d4274 1
a4274 1
    { VEX_LEN_TABLE (VEX_LEN_F5_P_2) },
d4277 1
a4277 1
  /* PREFIX_VEX_F6 */
d4281 1
a4281 1
    { VEX_LEN_TABLE (VEX_LEN_F6_P_2) },
d4284 1
a4284 1
  /* PREFIX_VEX_F7 */
d4288 1
a4288 1
    { VEX_LEN_TABLE (VEX_LEN_F7_P_2) },
d4291 1
a4291 1
  /* PREFIX_VEX_F8 */
d4295 1
a4295 1
    { VEX_LEN_TABLE (VEX_LEN_F8_P_2) },
d4298 1
a4298 1
  /* PREFIX_VEX_F9 */
d4302 1
a4302 1
    { VEX_LEN_TABLE (VEX_LEN_F9_P_2) },
d4305 1
a4305 1
  /* PREFIX_VEX_FA */
d4309 1
a4309 1
    { VEX_LEN_TABLE (VEX_LEN_FA_P_2) },
d4312 1
a4312 1
  /* PREFIX_VEX_FB */
d4316 1
a4316 1
    { VEX_LEN_TABLE (VEX_LEN_FB_P_2) },
d4319 1
a4319 1
  /* PREFIX_VEX_FC */
d4323 1
a4323 1
    { VEX_LEN_TABLE (VEX_LEN_FC_P_2) },
d4326 1
a4326 1
  /* PREFIX_VEX_FD */
d4330 1
a4330 1
    { VEX_LEN_TABLE (VEX_LEN_FD_P_2) },
d4333 1
a4333 1
  /* PREFIX_VEX_FE */
d4337 1
a4337 1
    { VEX_LEN_TABLE (VEX_LEN_FE_P_2) },
d4340 1
a4340 1
  /* PREFIX_VEX_3800 */
d4344 1
a4344 1
    { VEX_LEN_TABLE (VEX_LEN_3800_P_2) },
d4347 1
a4347 1
  /* PREFIX_VEX_3801 */
d4351 1
a4351 1
    { VEX_LEN_TABLE (VEX_LEN_3801_P_2) },
d4354 1
a4354 1
  /* PREFIX_VEX_3802 */
d4358 1
a4358 1
    { VEX_LEN_TABLE (VEX_LEN_3802_P_2) },
d4361 1
a4361 1
  /* PREFIX_VEX_3803 */
d4365 1
a4365 1
    { VEX_LEN_TABLE (VEX_LEN_3803_P_2) },
d4368 1
a4368 1
  /* PREFIX_VEX_3804 */
d4372 1
a4372 1
    { VEX_LEN_TABLE (VEX_LEN_3804_P_2) },
d4375 1
a4375 1
  /* PREFIX_VEX_3805 */
d4379 1
a4379 1
    { VEX_LEN_TABLE (VEX_LEN_3805_P_2) },
d4382 1
a4382 1
  /* PREFIX_VEX_3806 */
d4386 1
a4386 1
    { VEX_LEN_TABLE (VEX_LEN_3806_P_2) },
d4389 1
a4389 1
  /* PREFIX_VEX_3807 */
d4393 1
a4393 1
    { VEX_LEN_TABLE (VEX_LEN_3807_P_2) },
d4396 1
a4396 1
  /* PREFIX_VEX_3808 */
d4400 1
a4400 1
    { VEX_LEN_TABLE (VEX_LEN_3808_P_2) },
d4403 1
a4403 1
  /* PREFIX_VEX_3809 */
d4407 1
a4407 1
    { VEX_LEN_TABLE (VEX_LEN_3809_P_2) },
d4410 1
a4410 1
  /* PREFIX_VEX_380A */
d4414 1
a4414 1
    { VEX_LEN_TABLE (VEX_LEN_380A_P_2) },
d4417 1
a4417 1
  /* PREFIX_VEX_380B */
d4421 1
a4421 1
    { VEX_LEN_TABLE (VEX_LEN_380B_P_2) },
d4424 1
a4424 1
  /* PREFIX_VEX_380C */
d4428 1
a4428 1
    { VEX_W_TABLE (VEX_W_380C_P_2) },
d4431 1
a4431 1
  /* PREFIX_VEX_380D */
d4435 1
a4435 1
    { VEX_W_TABLE (VEX_W_380D_P_2) },
d4438 1
a4438 1
  /* PREFIX_VEX_380E */
d4442 1
a4442 1
    { VEX_W_TABLE (VEX_W_380E_P_2) },
d4445 1
a4445 1
  /* PREFIX_VEX_380F */
d4449 1
a4449 1
    { VEX_W_TABLE (VEX_W_380F_P_2) },
d4452 1
a4452 1
  /* PREFIX_VEX_3813 */
d4459 1
a4459 1
  /* PREFIX_VEX_3817 */
d4463 1
a4463 1
    { VEX_W_TABLE (VEX_W_3817_P_2) },
d4466 1
a4466 1
  /* PREFIX_VEX_3818 */
d4470 1
a4470 1
    { MOD_TABLE (MOD_VEX_3818_PREFIX_2) },
d4473 1
a4473 1
  /* PREFIX_VEX_3819 */
d4477 1
a4477 1
    { MOD_TABLE (MOD_VEX_3819_PREFIX_2) },
d4480 1
a4480 1
  /* PREFIX_VEX_381A */
d4484 1
a4484 1
    { MOD_TABLE (MOD_VEX_381A_PREFIX_2) },
d4487 1
a4487 1
  /* PREFIX_VEX_381C */
d4491 1
a4491 1
    { VEX_LEN_TABLE (VEX_LEN_381C_P_2) },
d4494 1
a4494 1
  /* PREFIX_VEX_381D */
d4498 1
a4498 1
    { VEX_LEN_TABLE (VEX_LEN_381D_P_2) },
d4501 1
a4501 1
  /* PREFIX_VEX_381E */
d4505 1
a4505 1
    { VEX_LEN_TABLE (VEX_LEN_381E_P_2) },
d4508 1
a4508 1
  /* PREFIX_VEX_3820 */
d4512 1
a4512 1
    { VEX_LEN_TABLE (VEX_LEN_3820_P_2) },
d4515 1
a4515 1
  /* PREFIX_VEX_3821 */
d4519 1
a4519 1
    { VEX_LEN_TABLE (VEX_LEN_3821_P_2) },
d4522 1
a4522 1
  /* PREFIX_VEX_3822 */
d4526 1
a4526 1
    { VEX_LEN_TABLE (VEX_LEN_3822_P_2) },
d4529 1
a4529 1
  /* PREFIX_VEX_3823 */
d4533 1
a4533 1
    { VEX_LEN_TABLE (VEX_LEN_3823_P_2) },
d4536 1
a4536 1
  /* PREFIX_VEX_3824 */
d4540 1
a4540 1
    { VEX_LEN_TABLE (VEX_LEN_3824_P_2) },
d4543 1
a4543 1
  /* PREFIX_VEX_3825 */
d4547 1
a4547 1
    { VEX_LEN_TABLE (VEX_LEN_3825_P_2) },
d4550 1
a4550 1
  /* PREFIX_VEX_3828 */
d4554 1
a4554 1
    { VEX_LEN_TABLE (VEX_LEN_3828_P_2) },
d4557 1
a4557 1
  /* PREFIX_VEX_3829 */
d4561 1
a4561 1
    { VEX_LEN_TABLE (VEX_LEN_3829_P_2) },
d4564 1
a4564 1
  /* PREFIX_VEX_382A */
d4568 1
a4568 1
    { MOD_TABLE (MOD_VEX_382A_PREFIX_2) },
d4571 1
a4571 1
  /* PREFIX_VEX_382B */
d4575 1
a4575 1
    { VEX_LEN_TABLE (VEX_LEN_382B_P_2) },
d4578 1
a4578 1
  /* PREFIX_VEX_382C */
d4582 1
a4582 1
     { MOD_TABLE (MOD_VEX_382C_PREFIX_2) },
d4585 1
a4585 1
  /* PREFIX_VEX_382D */
d4589 1
a4589 1
     { MOD_TABLE (MOD_VEX_382D_PREFIX_2) },
d4592 1
a4592 1
  /* PREFIX_VEX_382E */
d4596 1
a4596 1
     { MOD_TABLE (MOD_VEX_382E_PREFIX_2) },
d4599 1
a4599 1
  /* PREFIX_VEX_382F */
d4603 1
a4603 1
     { MOD_TABLE (MOD_VEX_382F_PREFIX_2) },
d4606 1
a4606 1
  /* PREFIX_VEX_3830 */
d4610 1
a4610 1
    { VEX_LEN_TABLE (VEX_LEN_3830_P_2) },
d4613 1
a4613 1
  /* PREFIX_VEX_3831 */
d4617 1
a4617 1
    { VEX_LEN_TABLE (VEX_LEN_3831_P_2) },
d4620 1
a4620 1
  /* PREFIX_VEX_3832 */
d4624 1
a4624 1
    { VEX_LEN_TABLE (VEX_LEN_3832_P_2) },
d4627 1
a4627 1
  /* PREFIX_VEX_3833 */
d4631 1
a4631 1
    { VEX_LEN_TABLE (VEX_LEN_3833_P_2) },
d4634 1
a4634 1
  /* PREFIX_VEX_3834 */
d4638 1
a4638 1
    { VEX_LEN_TABLE (VEX_LEN_3834_P_2) },
d4641 1
a4641 1
  /* PREFIX_VEX_3835 */
d4645 1
a4645 1
    { VEX_LEN_TABLE (VEX_LEN_3835_P_2) },
d4648 1
a4648 1
  /* PREFIX_VEX_3837 */
d4652 1
a4652 1
    { VEX_LEN_TABLE (VEX_LEN_3837_P_2) },
d4655 1
a4655 1
  /* PREFIX_VEX_3838 */
d4659 1
a4659 1
    { VEX_LEN_TABLE (VEX_LEN_3838_P_2) },
d4662 1
a4662 1
  /* PREFIX_VEX_3839 */
d4666 1
a4666 1
    { VEX_LEN_TABLE (VEX_LEN_3839_P_2) },
d4669 1
a4669 1
  /* PREFIX_VEX_383A */
d4673 1
a4673 1
    { VEX_LEN_TABLE (VEX_LEN_383A_P_2) },
d4676 1
a4676 1
  /* PREFIX_VEX_383B */
d4680 1
a4680 1
    { VEX_LEN_TABLE (VEX_LEN_383B_P_2) },
d4683 1
a4683 1
  /* PREFIX_VEX_383C */
d4687 1
a4687 1
    { VEX_LEN_TABLE (VEX_LEN_383C_P_2) },
d4690 1
a4690 1
  /* PREFIX_VEX_383D */
d4694 1
a4694 1
    { VEX_LEN_TABLE (VEX_LEN_383D_P_2) },
d4697 1
a4697 1
  /* PREFIX_VEX_383E */
d4701 1
a4701 1
    { VEX_LEN_TABLE (VEX_LEN_383E_P_2) },
d4704 1
a4704 1
  /* PREFIX_VEX_383F */
d4708 1
a4708 1
    { VEX_LEN_TABLE (VEX_LEN_383F_P_2) },
d4711 1
a4711 1
  /* PREFIX_VEX_3840 */
d4715 1
a4715 1
    { VEX_LEN_TABLE (VEX_LEN_3840_P_2) },
d4718 1
a4718 1
  /* PREFIX_VEX_3841 */
d4722 1
a4722 1
    { VEX_LEN_TABLE (VEX_LEN_3841_P_2) },
d4725 1
a4725 1
  /* PREFIX_VEX_3896 */
d4732 1
a4732 1
  /* PREFIX_VEX_3897 */
d4739 1
a4739 1
  /* PREFIX_VEX_3898 */
d4746 1
a4746 1
  /* PREFIX_VEX_3899 */
d4753 1
a4753 1
  /* PREFIX_VEX_389A */
d4760 1
a4760 1
  /* PREFIX_VEX_389B */
d4767 1
a4767 1
  /* PREFIX_VEX_389C */
d4774 1
a4774 1
  /* PREFIX_VEX_389D */
d4781 1
a4781 1
  /* PREFIX_VEX_389E */
d4788 1
a4788 1
  /* PREFIX_VEX_389F */
d4795 1
a4795 1
  /* PREFIX_VEX_38A6 */
d4803 1
a4803 1
  /* PREFIX_VEX_38A7 */
d4810 1
a4810 1
  /* PREFIX_VEX_38A8 */
d4817 1
a4817 1
  /* PREFIX_VEX_38A9 */
d4824 1
a4824 1
  /* PREFIX_VEX_38AA */
d4831 1
a4831 1
  /* PREFIX_VEX_38AB */
d4838 1
a4838 1
  /* PREFIX_VEX_38AC */
d4845 1
a4845 1
  /* PREFIX_VEX_38AD */
d4852 1
a4852 1
  /* PREFIX_VEX_38AE */
d4859 1
a4859 1
  /* PREFIX_VEX_38AF */
d4866 1
a4866 1
  /* PREFIX_VEX_38B6 */
d4873 1
a4873 1
  /* PREFIX_VEX_38B7 */
d4880 1
a4880 1
  /* PREFIX_VEX_38B8 */
d4887 1
a4887 1
  /* PREFIX_VEX_38B9 */
d4894 1
a4894 1
  /* PREFIX_VEX_38BA */
d4901 1
a4901 1
  /* PREFIX_VEX_38BB */
d4908 1
a4908 1
  /* PREFIX_VEX_38BC */
d4915 1
a4915 1
  /* PREFIX_VEX_38BD */
d4922 1
a4922 1
  /* PREFIX_VEX_38BE */
d4929 1
a4929 1
  /* PREFIX_VEX_38BF */
d4936 1
a4936 1
  /* PREFIX_VEX_38DB */
d4940 1
a4940 1
    { VEX_LEN_TABLE (VEX_LEN_38DB_P_2) },
d4943 1
a4943 1
  /* PREFIX_VEX_38DC */
d4947 1
a4947 1
    { VEX_LEN_TABLE (VEX_LEN_38DC_P_2) },
d4950 1
a4950 1
  /* PREFIX_VEX_38DD */
d4954 1
a4954 1
    { VEX_LEN_TABLE (VEX_LEN_38DD_P_2) },
d4957 1
a4957 1
  /* PREFIX_VEX_38DE */
d4961 1
a4961 1
    { VEX_LEN_TABLE (VEX_LEN_38DE_P_2) },
d4964 1
a4964 1
  /* PREFIX_VEX_38DF */
d4968 1
a4968 1
    { VEX_LEN_TABLE (VEX_LEN_38DF_P_2) },
d4971 1
a4971 1
  /* PREFIX_VEX_3A04 */
d4975 1
a4975 1
    { VEX_W_TABLE (VEX_W_3A04_P_2) },
d4978 1
a4978 1
  /* PREFIX_VEX_3A05 */
d4982 1
a4982 1
    { VEX_W_TABLE (VEX_W_3A05_P_2) },
d4985 1
a4985 1
  /* PREFIX_VEX_3A06 */
d4989 1
a4989 1
    { VEX_LEN_TABLE (VEX_LEN_3A06_P_2) },
d4992 1
a4992 1
  /* PREFIX_VEX_3A08 */
d4996 1
a4996 1
    { VEX_W_TABLE (VEX_W_3A08_P_2) },
d4999 1
a4999 1
  /* PREFIX_VEX_3A09 */
d5003 1
a5003 1
    { VEX_W_TABLE (VEX_W_3A09_P_2) },
d5006 1
a5006 1
  /* PREFIX_VEX_3A0A */
d5010 1
a5010 1
    { VEX_LEN_TABLE (VEX_LEN_3A0A_P_2) },
d5013 1
a5013 1
  /* PREFIX_VEX_3A0B */
d5017 1
a5017 1
    { VEX_LEN_TABLE (VEX_LEN_3A0B_P_2) },
d5020 1
a5020 1
  /* PREFIX_VEX_3A0C */
d5024 1
a5024 1
    { VEX_W_TABLE (VEX_W_3A0C_P_2) },
d5027 1
a5027 1
  /* PREFIX_VEX_3A0D */
d5031 1
a5031 1
    { VEX_W_TABLE (VEX_W_3A0D_P_2) },
d5034 1
a5034 1
  /* PREFIX_VEX_3A0E */
d5038 1
a5038 1
    { VEX_LEN_TABLE (VEX_LEN_3A0E_P_2) },
d5041 1
a5041 1
  /* PREFIX_VEX_3A0F */
d5045 1
a5045 1
    { VEX_LEN_TABLE (VEX_LEN_3A0F_P_2) },
d5048 1
a5048 1
  /* PREFIX_VEX_3A14 */
d5052 1
a5052 1
    { VEX_LEN_TABLE (VEX_LEN_3A14_P_2) },
d5055 1
a5055 1
  /* PREFIX_VEX_3A15 */
d5059 1
a5059 1
    { VEX_LEN_TABLE (VEX_LEN_3A15_P_2) },
d5062 1
a5062 1
  /* PREFIX_VEX_3A16 */
d5066 1
a5066 1
    { VEX_LEN_TABLE (VEX_LEN_3A16_P_2) },
d5069 1
a5069 1
  /* PREFIX_VEX_3A17 */
d5073 1
a5073 1
    { VEX_LEN_TABLE (VEX_LEN_3A17_P_2) },
d5076 1
a5076 1
  /* PREFIX_VEX_3A18 */
d5080 1
a5080 1
    { VEX_LEN_TABLE (VEX_LEN_3A18_P_2) },
d5083 1
a5083 1
  /* PREFIX_VEX_3A19 */
d5087 1
a5087 1
    { VEX_LEN_TABLE (VEX_LEN_3A19_P_2) },
d5090 1
a5090 1
  /* PREFIX_VEX_3A1D */
d5097 1
a5097 1
  /* PREFIX_VEX_3A20 */
d5101 1
a5101 1
    { VEX_LEN_TABLE (VEX_LEN_3A20_P_2) },
d5104 1
a5104 1
  /* PREFIX_VEX_3A21 */
d5108 1
a5108 1
    { VEX_LEN_TABLE (VEX_LEN_3A21_P_2) },
d5111 1
a5111 1
  /* PREFIX_VEX_3A22 */
d5115 1
a5115 1
    { VEX_LEN_TABLE (VEX_LEN_3A22_P_2) },
d5118 1
a5118 1
  /* PREFIX_VEX_3A40 */
d5122 1
a5122 1
    { VEX_W_TABLE (VEX_W_3A40_P_2) },
d5125 1
a5125 1
  /* PREFIX_VEX_3A41 */
d5129 1
a5129 1
    { VEX_LEN_TABLE (VEX_LEN_3A41_P_2) },
d5132 1
a5132 1
  /* PREFIX_VEX_3A42 */
d5136 1
a5136 1
    { VEX_LEN_TABLE (VEX_LEN_3A42_P_2) },
d5139 1
a5139 1
  /* PREFIX_VEX_3A44 */
d5143 1
a5143 1
    { VEX_LEN_TABLE (VEX_LEN_3A44_P_2) },
d5146 1
a5146 1
  /* PREFIX_VEX_3A48 */
d5150 1
a5150 1
    { VEX_W_TABLE (VEX_W_3A48_P_2) },
d5153 1
a5153 1
  /* PREFIX_VEX_3A49 */
d5157 1
a5157 1
    { VEX_W_TABLE (VEX_W_3A49_P_2) },
d5160 1
a5160 1
  /* PREFIX_VEX_3A4A */
d5164 1
a5164 1
    { VEX_W_TABLE (VEX_W_3A4A_P_2) },
d5167 1
a5167 1
  /* PREFIX_VEX_3A4B */
d5171 1
a5171 1
    { VEX_W_TABLE (VEX_W_3A4B_P_2) },
d5174 1
a5174 1
  /* PREFIX_VEX_3A4C */
d5178 1
a5178 1
    { VEX_LEN_TABLE (VEX_LEN_3A4C_P_2) },
d5181 1
a5181 1
  /* PREFIX_VEX_3A5C */
d5188 1
a5188 1
  /* PREFIX_VEX_3A5D */
d5195 1
a5195 1
  /* PREFIX_VEX_3A5E */
d5202 1
a5202 1
  /* PREFIX_VEX_3A5F */
d5209 1
a5209 1
  /* PREFIX_VEX_3A60 */
d5213 1
a5213 1
    { VEX_LEN_TABLE (VEX_LEN_3A60_P_2) },
d5217 1
a5217 1
  /* PREFIX_VEX_3A61 */
d5221 1
a5221 1
    { VEX_LEN_TABLE (VEX_LEN_3A61_P_2) },
d5224 1
a5224 1
  /* PREFIX_VEX_3A62 */
d5228 1
a5228 1
    { VEX_LEN_TABLE (VEX_LEN_3A62_P_2) },
d5231 1
a5231 1
  /* PREFIX_VEX_3A63 */
d5235 1
a5235 1
    { VEX_LEN_TABLE (VEX_LEN_3A63_P_2) },
d5238 1
a5238 1
  /* PREFIX_VEX_3A68 */
d5245 1
a5245 1
  /* PREFIX_VEX_3A69 */
d5252 1
a5252 1
  /* PREFIX_VEX_3A6A */
d5256 1
a5256 1
    { VEX_LEN_TABLE (VEX_LEN_3A6A_P_2) },
d5259 1
a5259 1
  /* PREFIX_VEX_3A6B */
d5263 1
a5263 1
    { VEX_LEN_TABLE (VEX_LEN_3A6B_P_2) },
d5266 1
a5266 1
  /* PREFIX_VEX_3A6C */
d5273 1
a5273 1
  /* PREFIX_VEX_3A6D */
d5280 1
a5280 1
  /* PREFIX_VEX_3A6E */
d5284 1
a5284 1
    { VEX_LEN_TABLE (VEX_LEN_3A6E_P_2) },
d5287 1
a5287 1
  /* PREFIX_VEX_3A6F */
d5291 1
a5291 1
    { VEX_LEN_TABLE (VEX_LEN_3A6F_P_2) },
d5294 1
a5294 1
  /* PREFIX_VEX_3A78 */
d5301 1
a5301 1
  /* PREFIX_VEX_3A79 */
d5308 1
a5308 1
  /* PREFIX_VEX_3A7A */
d5312 1
a5312 1
    { VEX_LEN_TABLE (VEX_LEN_3A7A_P_2) },
d5315 1
a5315 1
  /* PREFIX_VEX_3A7B */
d5319 1
a5319 1
    { VEX_LEN_TABLE (VEX_LEN_3A7B_P_2) },
d5322 1
a5322 1
  /* PREFIX_VEX_3A7C */
d5330 1
a5330 1
  /* PREFIX_VEX_3A7D */
d5337 1
a5337 1
  /* PREFIX_VEX_3A7E */
d5341 1
a5341 1
    { VEX_LEN_TABLE (VEX_LEN_3A7E_P_2) },
d5344 1
a5344 1
  /* PREFIX_VEX_3A7F */
d5348 1
a5348 1
    { VEX_LEN_TABLE (VEX_LEN_3A7F_P_2) },
d5351 1
a5351 1
  /* PREFIX_VEX_3ADF */
d5355 1
a5355 1
    { VEX_LEN_TABLE (VEX_LEN_3ADF_P_2) },
d6827 2
a6828 2
    { VEX_LEN_TABLE (VEX_LEN_XOP_09_80) },
    { VEX_LEN_TABLE (VEX_LEN_XOP_09_81) },
d7286 8
a7293 8
    { PREFIX_TABLE (PREFIX_VEX_10) },
    { PREFIX_TABLE (PREFIX_VEX_11) },
    { PREFIX_TABLE (PREFIX_VEX_12) },
    { MOD_TABLE (MOD_VEX_13) },
    { VEX_W_TABLE (VEX_W_14) },
    { VEX_W_TABLE (VEX_W_15) },
    { PREFIX_TABLE (PREFIX_VEX_16) },
    { MOD_TABLE (MOD_VEX_17) },
d7313 8
a7320 8
    { VEX_W_TABLE (VEX_W_28) },
    { VEX_W_TABLE (VEX_W_29) },
    { PREFIX_TABLE (PREFIX_VEX_2A) },
    { MOD_TABLE (MOD_VEX_2B) },
    { PREFIX_TABLE (PREFIX_VEX_2C) },
    { PREFIX_TABLE (PREFIX_VEX_2D) },
    { PREFIX_TABLE (PREFIX_VEX_2E) },
    { PREFIX_TABLE (PREFIX_VEX_2F) },
d7358 4
a7361 4
    { MOD_TABLE (MOD_VEX_50) },
    { PREFIX_TABLE (PREFIX_VEX_51) },
    { PREFIX_TABLE (PREFIX_VEX_52) },
    { PREFIX_TABLE (PREFIX_VEX_53) },
d7367 8
a7374 8
    { PREFIX_TABLE (PREFIX_VEX_58) },
    { PREFIX_TABLE (PREFIX_VEX_59) },
    { PREFIX_TABLE (PREFIX_VEX_5A) },
    { PREFIX_TABLE (PREFIX_VEX_5B) },
    { PREFIX_TABLE (PREFIX_VEX_5C) },
    { PREFIX_TABLE (PREFIX_VEX_5D) },
    { PREFIX_TABLE (PREFIX_VEX_5E) },
    { PREFIX_TABLE (PREFIX_VEX_5F) },
d7376 8
a7383 8
    { PREFIX_TABLE (PREFIX_VEX_60) },
    { PREFIX_TABLE (PREFIX_VEX_61) },
    { PREFIX_TABLE (PREFIX_VEX_62) },
    { PREFIX_TABLE (PREFIX_VEX_63) },
    { PREFIX_TABLE (PREFIX_VEX_64) },
    { PREFIX_TABLE (PREFIX_VEX_65) },
    { PREFIX_TABLE (PREFIX_VEX_66) },
    { PREFIX_TABLE (PREFIX_VEX_67) },
d7385 8
a7392 8
    { PREFIX_TABLE (PREFIX_VEX_68) },
    { PREFIX_TABLE (PREFIX_VEX_69) },
    { PREFIX_TABLE (PREFIX_VEX_6A) },
    { PREFIX_TABLE (PREFIX_VEX_6B) },
    { PREFIX_TABLE (PREFIX_VEX_6C) },
    { PREFIX_TABLE (PREFIX_VEX_6D) },
    { PREFIX_TABLE (PREFIX_VEX_6E) },
    { PREFIX_TABLE (PREFIX_VEX_6F) },
d7394 8
a7401 8
    { PREFIX_TABLE (PREFIX_VEX_70) },
    { REG_TABLE (REG_VEX_71) },
    { REG_TABLE (REG_VEX_72) },
    { REG_TABLE (REG_VEX_73) },
    { PREFIX_TABLE (PREFIX_VEX_74) },
    { PREFIX_TABLE (PREFIX_VEX_75) },
    { PREFIX_TABLE (PREFIX_VEX_76) },
    { PREFIX_TABLE (PREFIX_VEX_77) },
d7407 4
a7410 4
    { PREFIX_TABLE (PREFIX_VEX_7C) },
    { PREFIX_TABLE (PREFIX_VEX_7D) },
    { PREFIX_TABLE (PREFIX_VEX_7E) },
    { PREFIX_TABLE (PREFIX_VEX_7F) },
d7463 1
a7463 1
    { REG_TABLE (REG_VEX_AE) },
d7486 1
a7486 1
    { PREFIX_TABLE (PREFIX_VEX_C2) },
d7488 2
a7489 2
    { PREFIX_TABLE (PREFIX_VEX_C4) },
    { PREFIX_TABLE (PREFIX_VEX_C5) },
d7502 8
a7509 8
    { PREFIX_TABLE (PREFIX_VEX_D0) },
    { PREFIX_TABLE (PREFIX_VEX_D1) },
    { PREFIX_TABLE (PREFIX_VEX_D2) },
    { PREFIX_TABLE (PREFIX_VEX_D3) },
    { PREFIX_TABLE (PREFIX_VEX_D4) },
    { PREFIX_TABLE (PREFIX_VEX_D5) },
    { PREFIX_TABLE (PREFIX_VEX_D6) },
    { PREFIX_TABLE (PREFIX_VEX_D7) },
d7511 8
a7518 8
    { PREFIX_TABLE (PREFIX_VEX_D8) },
    { PREFIX_TABLE (PREFIX_VEX_D9) },
    { PREFIX_TABLE (PREFIX_VEX_DA) },
    { PREFIX_TABLE (PREFIX_VEX_DB) },
    { PREFIX_TABLE (PREFIX_VEX_DC) },
    { PREFIX_TABLE (PREFIX_VEX_DD) },
    { PREFIX_TABLE (PREFIX_VEX_DE) },
    { PREFIX_TABLE (PREFIX_VEX_DF) },
d7520 8
a7527 8
    { PREFIX_TABLE (PREFIX_VEX_E0) },
    { PREFIX_TABLE (PREFIX_VEX_E1) },
    { PREFIX_TABLE (PREFIX_VEX_E2) },
    { PREFIX_TABLE (PREFIX_VEX_E3) },
    { PREFIX_TABLE (PREFIX_VEX_E4) },
    { PREFIX_TABLE (PREFIX_VEX_E5) },
    { PREFIX_TABLE (PREFIX_VEX_E6) },
    { PREFIX_TABLE (PREFIX_VEX_E7) },
d7529 8
a7536 8
    { PREFIX_TABLE (PREFIX_VEX_E8) },
    { PREFIX_TABLE (PREFIX_VEX_E9) },
    { PREFIX_TABLE (PREFIX_VEX_EA) },
    { PREFIX_TABLE (PREFIX_VEX_EB) },
    { PREFIX_TABLE (PREFIX_VEX_EC) },
    { PREFIX_TABLE (PREFIX_VEX_ED) },
    { PREFIX_TABLE (PREFIX_VEX_EE) },
    { PREFIX_TABLE (PREFIX_VEX_EF) },
d7538 8
a7545 8
    { PREFIX_TABLE (PREFIX_VEX_F0) },
    { PREFIX_TABLE (PREFIX_VEX_F1) },
    { PREFIX_TABLE (PREFIX_VEX_F2) },
    { PREFIX_TABLE (PREFIX_VEX_F3) },
    { PREFIX_TABLE (PREFIX_VEX_F4) },
    { PREFIX_TABLE (PREFIX_VEX_F5) },
    { PREFIX_TABLE (PREFIX_VEX_F6) },
    { PREFIX_TABLE (PREFIX_VEX_F7) },
d7547 7
a7553 7
    { PREFIX_TABLE (PREFIX_VEX_F8) },
    { PREFIX_TABLE (PREFIX_VEX_F9) },
    { PREFIX_TABLE (PREFIX_VEX_FA) },
    { PREFIX_TABLE (PREFIX_VEX_FB) },
    { PREFIX_TABLE (PREFIX_VEX_FC) },
    { PREFIX_TABLE (PREFIX_VEX_FD) },
    { PREFIX_TABLE (PREFIX_VEX_FE) },
d7559 8
a7566 8
    { PREFIX_TABLE (PREFIX_VEX_3800) },
    { PREFIX_TABLE (PREFIX_VEX_3801) },
    { PREFIX_TABLE (PREFIX_VEX_3802) },
    { PREFIX_TABLE (PREFIX_VEX_3803) },
    { PREFIX_TABLE (PREFIX_VEX_3804) },
    { PREFIX_TABLE (PREFIX_VEX_3805) },
    { PREFIX_TABLE (PREFIX_VEX_3806) },
    { PREFIX_TABLE (PREFIX_VEX_3807) },
d7568 8
a7575 8
    { PREFIX_TABLE (PREFIX_VEX_3808) },
    { PREFIX_TABLE (PREFIX_VEX_3809) },
    { PREFIX_TABLE (PREFIX_VEX_380A) },
    { PREFIX_TABLE (PREFIX_VEX_380B) },
    { PREFIX_TABLE (PREFIX_VEX_380C) },
    { PREFIX_TABLE (PREFIX_VEX_380D) },
    { PREFIX_TABLE (PREFIX_VEX_380E) },
    { PREFIX_TABLE (PREFIX_VEX_380F) },
d7580 1
a7580 1
    { PREFIX_TABLE (PREFIX_VEX_3813) },
d7584 1
a7584 1
    { PREFIX_TABLE (PREFIX_VEX_3817) },
d7586 7
a7592 7
    { PREFIX_TABLE (PREFIX_VEX_3818) },
    { PREFIX_TABLE (PREFIX_VEX_3819) },
    { PREFIX_TABLE (PREFIX_VEX_381A) },
    { Bad_Opcode },
    { PREFIX_TABLE (PREFIX_VEX_381C) },
    { PREFIX_TABLE (PREFIX_VEX_381D) },
    { PREFIX_TABLE (PREFIX_VEX_381E) },
d7595 6
a7600 6
    { PREFIX_TABLE (PREFIX_VEX_3820) },
    { PREFIX_TABLE (PREFIX_VEX_3821) },
    { PREFIX_TABLE (PREFIX_VEX_3822) },
    { PREFIX_TABLE (PREFIX_VEX_3823) },
    { PREFIX_TABLE (PREFIX_VEX_3824) },
    { PREFIX_TABLE (PREFIX_VEX_3825) },
d7604 8
a7611 8
    { PREFIX_TABLE (PREFIX_VEX_3828) },
    { PREFIX_TABLE (PREFIX_VEX_3829) },
    { PREFIX_TABLE (PREFIX_VEX_382A) },
    { PREFIX_TABLE (PREFIX_VEX_382B) },
    { PREFIX_TABLE (PREFIX_VEX_382C) },
    { PREFIX_TABLE (PREFIX_VEX_382D) },
    { PREFIX_TABLE (PREFIX_VEX_382E) },
    { PREFIX_TABLE (PREFIX_VEX_382F) },
d7613 6
a7618 6
    { PREFIX_TABLE (PREFIX_VEX_3830) },
    { PREFIX_TABLE (PREFIX_VEX_3831) },
    { PREFIX_TABLE (PREFIX_VEX_3832) },
    { PREFIX_TABLE (PREFIX_VEX_3833) },
    { PREFIX_TABLE (PREFIX_VEX_3834) },
    { PREFIX_TABLE (PREFIX_VEX_3835) },
d7620 1
a7620 1
    { PREFIX_TABLE (PREFIX_VEX_3837) },
d7622 8
a7629 8
    { PREFIX_TABLE (PREFIX_VEX_3838) },
    { PREFIX_TABLE (PREFIX_VEX_3839) },
    { PREFIX_TABLE (PREFIX_VEX_383A) },
    { PREFIX_TABLE (PREFIX_VEX_383B) },
    { PREFIX_TABLE (PREFIX_VEX_383C) },
    { PREFIX_TABLE (PREFIX_VEX_383D) },
    { PREFIX_TABLE (PREFIX_VEX_383E) },
    { PREFIX_TABLE (PREFIX_VEX_383F) },
d7631 2
a7632 2
    { PREFIX_TABLE (PREFIX_VEX_3840) },
    { PREFIX_TABLE (PREFIX_VEX_3841) },
d7727 2
a7728 2
    { PREFIX_TABLE (PREFIX_VEX_3896) },
    { PREFIX_TABLE (PREFIX_VEX_3897) },
d7730 8
a7737 8
    { PREFIX_TABLE (PREFIX_VEX_3898) },
    { PREFIX_TABLE (PREFIX_VEX_3899) },
    { PREFIX_TABLE (PREFIX_VEX_389A) },
    { PREFIX_TABLE (PREFIX_VEX_389B) },
    { PREFIX_TABLE (PREFIX_VEX_389C) },
    { PREFIX_TABLE (PREFIX_VEX_389D) },
    { PREFIX_TABLE (PREFIX_VEX_389E) },
    { PREFIX_TABLE (PREFIX_VEX_389F) },
d7745 2
a7746 2
    { PREFIX_TABLE (PREFIX_VEX_38A6) },
    { PREFIX_TABLE (PREFIX_VEX_38A7) },
d7748 8
a7755 8
    { PREFIX_TABLE (PREFIX_VEX_38A8) },
    { PREFIX_TABLE (PREFIX_VEX_38A9) },
    { PREFIX_TABLE (PREFIX_VEX_38AA) },
    { PREFIX_TABLE (PREFIX_VEX_38AB) },
    { PREFIX_TABLE (PREFIX_VEX_38AC) },
    { PREFIX_TABLE (PREFIX_VEX_38AD) },
    { PREFIX_TABLE (PREFIX_VEX_38AE) },
    { PREFIX_TABLE (PREFIX_VEX_38AF) },
d7763 2
a7764 2
    { PREFIX_TABLE (PREFIX_VEX_38B6) },
    { PREFIX_TABLE (PREFIX_VEX_38B7) },
d7766 8
a7773 8
    { PREFIX_TABLE (PREFIX_VEX_38B8) },
    { PREFIX_TABLE (PREFIX_VEX_38B9) },
    { PREFIX_TABLE (PREFIX_VEX_38BA) },
    { PREFIX_TABLE (PREFIX_VEX_38BB) },
    { PREFIX_TABLE (PREFIX_VEX_38BC) },
    { PREFIX_TABLE (PREFIX_VEX_38BD) },
    { PREFIX_TABLE (PREFIX_VEX_38BE) },
    { PREFIX_TABLE (PREFIX_VEX_38BF) },
d7805 5
a7809 5
    { PREFIX_TABLE (PREFIX_VEX_38DB) },
    { PREFIX_TABLE (PREFIX_VEX_38DC) },
    { PREFIX_TABLE (PREFIX_VEX_38DD) },
    { PREFIX_TABLE (PREFIX_VEX_38DE) },
    { PREFIX_TABLE (PREFIX_VEX_38DF) },
d7854 3
a7856 3
    { PREFIX_TABLE (PREFIX_VEX_3A04) },
    { PREFIX_TABLE (PREFIX_VEX_3A05) },
    { PREFIX_TABLE (PREFIX_VEX_3A06) },
d7859 8
a7866 8
    { PREFIX_TABLE (PREFIX_VEX_3A08) },
    { PREFIX_TABLE (PREFIX_VEX_3A09) },
    { PREFIX_TABLE (PREFIX_VEX_3A0A) },
    { PREFIX_TABLE (PREFIX_VEX_3A0B) },
    { PREFIX_TABLE (PREFIX_VEX_3A0C) },
    { PREFIX_TABLE (PREFIX_VEX_3A0D) },
    { PREFIX_TABLE (PREFIX_VEX_3A0E) },
    { PREFIX_TABLE (PREFIX_VEX_3A0F) },
d7872 4
a7875 4
    { PREFIX_TABLE (PREFIX_VEX_3A14) },
    { PREFIX_TABLE (PREFIX_VEX_3A15) },
    { PREFIX_TABLE (PREFIX_VEX_3A16) },
    { PREFIX_TABLE (PREFIX_VEX_3A17) },
d7877 2
a7878 2
    { PREFIX_TABLE (PREFIX_VEX_3A18) },
    { PREFIX_TABLE (PREFIX_VEX_3A19) },
d7882 1
a7882 1
    { PREFIX_TABLE (PREFIX_VEX_3A1D) },
d7886 3
a7888 3
    { PREFIX_TABLE (PREFIX_VEX_3A20) },
    { PREFIX_TABLE (PREFIX_VEX_3A21) },
    { PREFIX_TABLE (PREFIX_VEX_3A22) },
d7922 3
a7924 3
    { PREFIX_TABLE (PREFIX_VEX_3A40) },
    { PREFIX_TABLE (PREFIX_VEX_3A41) },
    { PREFIX_TABLE (PREFIX_VEX_3A42) },
d7926 1
a7926 1
    { PREFIX_TABLE (PREFIX_VEX_3A44) },
d7931 5
a7935 5
    { PREFIX_TABLE (PREFIX_VEX_3A48) },
    { PREFIX_TABLE (PREFIX_VEX_3A49) },
    { PREFIX_TABLE (PREFIX_VEX_3A4A) },
    { PREFIX_TABLE (PREFIX_VEX_3A4B) },
    { PREFIX_TABLE (PREFIX_VEX_3A4C) },
d7953 4
a7956 4
    { PREFIX_TABLE (PREFIX_VEX_3A5C) },
    { PREFIX_TABLE (PREFIX_VEX_3A5D) },
    { PREFIX_TABLE (PREFIX_VEX_3A5E) },
    { PREFIX_TABLE (PREFIX_VEX_3A5F) },
d7958 4
a7961 4
    { PREFIX_TABLE (PREFIX_VEX_3A60) },
    { PREFIX_TABLE (PREFIX_VEX_3A61) },
    { PREFIX_TABLE (PREFIX_VEX_3A62) },
    { PREFIX_TABLE (PREFIX_VEX_3A63) },
d7967 8
a7974 8
    { PREFIX_TABLE (PREFIX_VEX_3A68) },
    { PREFIX_TABLE (PREFIX_VEX_3A69) },
    { PREFIX_TABLE (PREFIX_VEX_3A6A) },
    { PREFIX_TABLE (PREFIX_VEX_3A6B) },
    { PREFIX_TABLE (PREFIX_VEX_3A6C) },
    { PREFIX_TABLE (PREFIX_VEX_3A6D) },
    { PREFIX_TABLE (PREFIX_VEX_3A6E) },
    { PREFIX_TABLE (PREFIX_VEX_3A6F) },
d7985 8
a7992 8
    { PREFIX_TABLE (PREFIX_VEX_3A78) },
    { PREFIX_TABLE (PREFIX_VEX_3A79) },
    { PREFIX_TABLE (PREFIX_VEX_3A7A) },
    { PREFIX_TABLE (PREFIX_VEX_3A7B) },
    { PREFIX_TABLE (PREFIX_VEX_3A7C) },
    { PREFIX_TABLE (PREFIX_VEX_3A7D) },
    { PREFIX_TABLE (PREFIX_VEX_3A7E) },
    { PREFIX_TABLE (PREFIX_VEX_3A7F) },
d8100 1
a8100 1
    { PREFIX_TABLE (PREFIX_VEX_3ADF) },
d8141 1
a8141 1
  /* VEX_LEN_10_P_1 */
d8143 2
a8144 2
    { VEX_W_TABLE (VEX_W_10_P_1) },
    { VEX_W_TABLE (VEX_W_10_P_1) },
d8147 1
a8147 1
  /* VEX_LEN_10_P_3 */
d8149 2
a8150 2
    { VEX_W_TABLE (VEX_W_10_P_3) },
    { VEX_W_TABLE (VEX_W_10_P_3) },
d8153 1
a8153 1
  /* VEX_LEN_11_P_1 */
d8155 2
a8156 2
    { VEX_W_TABLE (VEX_W_11_P_1) },
    { VEX_W_TABLE (VEX_W_11_P_1) },
d8159 1
a8159 1
  /* VEX_LEN_11_P_3 */
d8161 2
a8162 2
    { VEX_W_TABLE (VEX_W_11_P_3) },
    { VEX_W_TABLE (VEX_W_11_P_3) },
d8165 1
a8165 1
  /* VEX_LEN_12_P_0_M_0 */
d8167 1
a8167 1
    { VEX_W_TABLE (VEX_W_12_P_0_M_0) },
d8170 1
a8170 1
  /* VEX_LEN_12_P_0_M_1 */
d8172 1
a8172 1
    { VEX_W_TABLE (VEX_W_12_P_0_M_1) },
d8175 1
a8175 1
  /* VEX_LEN_12_P_2 */
d8177 1
a8177 1
    { VEX_W_TABLE (VEX_W_12_P_2) },
d8180 1
a8180 1
  /* VEX_LEN_13_M_0 */
d8182 1
a8182 1
    { VEX_W_TABLE (VEX_W_13_M_0) },
d8185 1
a8185 1
  /* VEX_LEN_16_P_0_M_0 */
d8187 1
a8187 1
    { VEX_W_TABLE (VEX_W_16_P_0_M_0) },
d8190 1
a8190 1
  /* VEX_LEN_16_P_0_M_1 */
d8192 1
a8192 1
    { VEX_W_TABLE (VEX_W_16_P_0_M_1) },
d8195 1
a8195 1
  /* VEX_LEN_16_P_2 */
d8197 1
a8197 1
    { VEX_W_TABLE (VEX_W_16_P_2) },
d8200 1
a8200 1
  /* VEX_LEN_17_M_0 */
d8202 1
a8202 1
    { VEX_W_TABLE (VEX_W_17_M_0) },
d8205 1
a8205 1
  /* VEX_LEN_2A_P_1 */
d8211 1
a8211 1
  /* VEX_LEN_2A_P_3 */
d8217 1
a8217 1
  /* VEX_LEN_2C_P_1 */
d8223 1
a8223 1
  /* VEX_LEN_2C_P_3 */
d8229 1
a8229 1
  /* VEX_LEN_2D_P_1 */
d8235 1
a8235 1
  /* VEX_LEN_2D_P_3 */
d8241 1
a8241 1
  /* VEX_LEN_2E_P_0 */
d8243 2
a8244 2
    { VEX_W_TABLE (VEX_W_2E_P_0) },
    { VEX_W_TABLE (VEX_W_2E_P_0) },
d8247 1
a8247 1
  /* VEX_LEN_2E_P_2 */
d8249 2
a8250 2
    { VEX_W_TABLE (VEX_W_2E_P_2) },
    { VEX_W_TABLE (VEX_W_2E_P_2) },
d8253 1
a8253 1
  /* VEX_LEN_2F_P_0 */
d8255 2
a8256 2
    { VEX_W_TABLE (VEX_W_2F_P_0) },
    { VEX_W_TABLE (VEX_W_2F_P_0) },
d8259 1
a8259 1
  /* VEX_LEN_2F_P_2 */
d8261 2
a8262 2
    { VEX_W_TABLE (VEX_W_2F_P_2) },
    { VEX_W_TABLE (VEX_W_2F_P_2) },
d8265 1
a8265 1
  /* VEX_LEN_51_P_1 */
d8267 2
a8268 2
    { VEX_W_TABLE (VEX_W_51_P_1) },
    { VEX_W_TABLE (VEX_W_51_P_1) },
d8271 1
a8271 1
  /* VEX_LEN_51_P_3 */
d8273 2
a8274 2
    { VEX_W_TABLE (VEX_W_51_P_3) },
    { VEX_W_TABLE (VEX_W_51_P_3) },
d8277 1
a8277 1
  /* VEX_LEN_52_P_1 */
d8279 2
a8280 2
    { VEX_W_TABLE (VEX_W_52_P_1) },
    { VEX_W_TABLE (VEX_W_52_P_1) },
d8283 1
a8283 1
  /* VEX_LEN_53_P_1 */
d8285 2
a8286 2
    { VEX_W_TABLE (VEX_W_53_P_1) },
    { VEX_W_TABLE (VEX_W_53_P_1) },
d8289 1
a8289 1
  /* VEX_LEN_58_P_1 */
d8291 2
a8292 2
    { VEX_W_TABLE (VEX_W_58_P_1) },
    { VEX_W_TABLE (VEX_W_58_P_1) },
d8295 1
a8295 1
  /* VEX_LEN_58_P_3 */
d8297 2
a8298 2
    { VEX_W_TABLE (VEX_W_58_P_3) },
    { VEX_W_TABLE (VEX_W_58_P_3) },
d8301 1
a8301 1
  /* VEX_LEN_59_P_1 */
d8303 2
a8304 2
    { VEX_W_TABLE (VEX_W_59_P_1) },
    { VEX_W_TABLE (VEX_W_59_P_1) },
d8307 1
a8307 1
  /* VEX_LEN_59_P_3 */
d8309 2
a8310 2
    { VEX_W_TABLE (VEX_W_59_P_3) },
    { VEX_W_TABLE (VEX_W_59_P_3) },
d8313 1
a8313 1
  /* VEX_LEN_5A_P_1 */
d8315 2
a8316 2
    { VEX_W_TABLE (VEX_W_5A_P_1) },
    { VEX_W_TABLE (VEX_W_5A_P_1) },
d8319 1
a8319 1
  /* VEX_LEN_5A_P_3 */
d8321 2
a8322 2
    { VEX_W_TABLE (VEX_W_5A_P_3) },
    { VEX_W_TABLE (VEX_W_5A_P_3) },
d8325 1
a8325 1
  /* VEX_LEN_5C_P_1 */
d8327 2
a8328 2
    { VEX_W_TABLE (VEX_W_5C_P_1) },
    { VEX_W_TABLE (VEX_W_5C_P_1) },
d8331 1
a8331 1
  /* VEX_LEN_5C_P_3 */
d8333 2
a8334 2
    { VEX_W_TABLE (VEX_W_5C_P_3) },
    { VEX_W_TABLE (VEX_W_5C_P_3) },
d8337 1
a8337 1
  /* VEX_LEN_5D_P_1 */
d8339 2
a8340 2
    { VEX_W_TABLE (VEX_W_5D_P_1) },
    { VEX_W_TABLE (VEX_W_5D_P_1) },
d8343 1
a8343 1
  /* VEX_LEN_5D_P_3 */
d8345 2
a8346 2
    { VEX_W_TABLE (VEX_W_5D_P_3) },
    { VEX_W_TABLE (VEX_W_5D_P_3) },
d8349 1
a8349 1
  /* VEX_LEN_5E_P_1 */
d8351 2
a8352 2
    { VEX_W_TABLE (VEX_W_5E_P_1) },
    { VEX_W_TABLE (VEX_W_5E_P_1) },
d8355 1
a8355 1
  /* VEX_LEN_5E_P_3 */
d8357 2
a8358 2
    { VEX_W_TABLE (VEX_W_5E_P_3) },
    { VEX_W_TABLE (VEX_W_5E_P_3) },
d8361 1
a8361 1
  /* VEX_LEN_5F_P_1 */
d8363 2
a8364 2
    { VEX_W_TABLE (VEX_W_5F_P_1) },
    { VEX_W_TABLE (VEX_W_5F_P_1) },
d8367 1
a8367 1
  /* VEX_LEN_5F_P_3 */
d8369 2
a8370 2
    { VEX_W_TABLE (VEX_W_5F_P_3) },
    { VEX_W_TABLE (VEX_W_5F_P_3) },
d8373 1
a8373 1
  /* VEX_LEN_60_P_2 */
d8375 1
a8375 1
    { VEX_W_TABLE (VEX_W_60_P_2) },
d8378 1
a8378 1
  /* VEX_LEN_61_P_2 */
d8380 1
a8380 1
    { VEX_W_TABLE (VEX_W_61_P_2) },
d8383 1
a8383 1
  /* VEX_LEN_62_P_2 */
d8385 1
a8385 1
    { VEX_W_TABLE (VEX_W_62_P_2) },
d8388 1
a8388 1
  /* VEX_LEN_63_P_2 */
d8390 1
a8390 1
    { VEX_W_TABLE (VEX_W_63_P_2) },
d8393 1
a8393 1
  /* VEX_LEN_64_P_2 */
d8395 1
a8395 1
    { VEX_W_TABLE (VEX_W_64_P_2) },
d8398 1
a8398 1
  /* VEX_LEN_65_P_2 */
d8400 1
a8400 1
    { VEX_W_TABLE (VEX_W_65_P_2) },
d8403 1
a8403 1
  /* VEX_LEN_66_P_2 */
d8405 1
a8405 1
    { VEX_W_TABLE (VEX_W_66_P_2) },
d8408 1
a8408 1
  /* VEX_LEN_67_P_2 */
d8410 1
a8410 1
    { VEX_W_TABLE (VEX_W_67_P_2) },
d8413 1
a8413 1
  /* VEX_LEN_68_P_2 */
d8415 1
a8415 1
    { VEX_W_TABLE (VEX_W_68_P_2) },
d8418 1
a8418 1
  /* VEX_LEN_69_P_2 */
d8420 1
a8420 1
    { VEX_W_TABLE (VEX_W_69_P_2) },
d8423 1
a8423 1
  /* VEX_LEN_6A_P_2 */
d8425 1
a8425 1
    { VEX_W_TABLE (VEX_W_6A_P_2) },
d8428 1
a8428 1
  /* VEX_LEN_6B_P_2 */
d8430 1
a8430 1
    { VEX_W_TABLE (VEX_W_6B_P_2) },
d8433 1
a8433 1
  /* VEX_LEN_6C_P_2 */
d8435 1
a8435 1
    { VEX_W_TABLE (VEX_W_6C_P_2) },
d8438 1
a8438 1
  /* VEX_LEN_6D_P_2 */
d8440 1
a8440 1
    { VEX_W_TABLE (VEX_W_6D_P_2) },
d8443 1
a8443 1
  /* VEX_LEN_6E_P_2 */
d8449 1
a8449 1
  /* VEX_LEN_70_P_1 */
d8451 1
a8451 1
    { VEX_W_TABLE (VEX_W_70_P_1) },
d8454 1
a8454 1
  /* VEX_LEN_70_P_2 */
d8456 1
a8456 1
    { VEX_W_TABLE (VEX_W_70_P_2) },
d8459 1
a8459 1
  /* VEX_LEN_70_P_3 */
d8461 1
a8461 1
    { VEX_W_TABLE (VEX_W_70_P_3) },
d8464 1
a8464 1
  /* VEX_LEN_71_R_2_P_2 */
d8466 1
a8466 1
    { VEX_W_TABLE (VEX_W_71_R_2_P_2) },
d8469 1
a8469 1
  /* VEX_LEN_71_R_4_P_2 */
d8471 1
a8471 1
    { VEX_W_TABLE (VEX_W_71_R_4_P_2) },
d8474 1
a8474 1
  /* VEX_LEN_71_R_6_P_2 */
d8476 1
a8476 1
    { VEX_W_TABLE (VEX_W_71_R_6_P_2) },
d8479 1
a8479 1
  /* VEX_LEN_72_R_2_P_2 */
d8481 1
a8481 1
    { VEX_W_TABLE (VEX_W_72_R_2_P_2) },
d8484 1
a8484 1
  /* VEX_LEN_72_R_4_P_2 */
d8486 1
a8486 1
    { VEX_W_TABLE (VEX_W_72_R_4_P_2) },
d8489 1
a8489 1
  /* VEX_LEN_72_R_6_P_2 */
d8491 1
a8491 1
    { VEX_W_TABLE (VEX_W_72_R_6_P_2) },
d8494 1
a8494 1
  /* VEX_LEN_73_R_2_P_2 */
d8496 1
a8496 1
    { VEX_W_TABLE (VEX_W_73_R_2_P_2) },
d8499 1
a8499 1
  /* VEX_LEN_73_R_3_P_2 */
d8501 1
a8501 1
    { VEX_W_TABLE (VEX_W_73_R_3_P_2) },
d8504 1
a8504 1
  /* VEX_LEN_73_R_6_P_2 */
d8506 1
a8506 1
    { VEX_W_TABLE (VEX_W_73_R_6_P_2) },
d8509 1
a8509 1
  /* VEX_LEN_73_R_7_P_2 */
d8511 1
a8511 1
    { VEX_W_TABLE (VEX_W_73_R_7_P_2) },
d8514 1
a8514 1
  /* VEX_LEN_74_P_2 */
d8516 1
a8516 1
    { VEX_W_TABLE (VEX_W_74_P_2) },
d8519 1
a8519 1
  /* VEX_LEN_75_P_2 */
d8521 1
a8521 1
    { VEX_W_TABLE (VEX_W_75_P_2) },
d8524 1
a8524 1
  /* VEX_LEN_76_P_2 */
d8526 1
a8526 1
    { VEX_W_TABLE (VEX_W_76_P_2) },
d8529 1
a8529 1
  /* VEX_LEN_7E_P_1 */
d8531 2
a8532 2
    { VEX_W_TABLE (VEX_W_7E_P_1) },
    { VEX_W_TABLE (VEX_W_7E_P_1) },
d8535 1
a8535 1
  /* VEX_LEN_7E_P_2 */
d8541 1
a8541 1
  /* VEX_LEN_AE_R_2_M_0 */
d8543 1
a8543 1
    { VEX_W_TABLE (VEX_W_AE_R_2_M_0) },
d8546 1
a8546 1
  /* VEX_LEN_AE_R_3_M_0 */
d8548 1
a8548 1
    { VEX_W_TABLE (VEX_W_AE_R_3_M_0) },
d8551 1
a8551 1
  /* VEX_LEN_C2_P_1 */
d8553 2
a8554 2
    { VEX_W_TABLE (VEX_W_C2_P_1) },
    { VEX_W_TABLE (VEX_W_C2_P_1) },
d8557 1
a8557 1
  /* VEX_LEN_C2_P_3 */
d8559 2
a8560 2
    { VEX_W_TABLE (VEX_W_C2_P_3) },
    { VEX_W_TABLE (VEX_W_C2_P_3) },
d8563 1
a8563 1
  /* VEX_LEN_C4_P_2 */
d8565 1
a8565 1
    { VEX_W_TABLE (VEX_W_C4_P_2) },
d8568 1
a8568 1
  /* VEX_LEN_C5_P_2 */
d8570 1
a8570 1
    { VEX_W_TABLE (VEX_W_C5_P_2) },
d8573 1
a8573 1
  /* VEX_LEN_D1_P_2 */
d8575 1
a8575 1
    { VEX_W_TABLE (VEX_W_D1_P_2) },
d8578 1
a8578 1
  /* VEX_LEN_D2_P_2 */
d8580 1
a8580 1
    { VEX_W_TABLE (VEX_W_D2_P_2) },
d8583 1
a8583 1
  /* VEX_LEN_D3_P_2 */
d8585 1
a8585 1
    { VEX_W_TABLE (VEX_W_D3_P_2) },
d8588 1
a8588 1
  /* VEX_LEN_D4_P_2 */
d8590 1
a8590 1
    { VEX_W_TABLE (VEX_W_D4_P_2) },
d8593 1
a8593 1
  /* VEX_LEN_D5_P_2 */
d8595 1
a8595 1
    { VEX_W_TABLE (VEX_W_D5_P_2) },
d8598 1
a8598 1
  /* VEX_LEN_D6_P_2 */
d8600 2
a8601 2
    { VEX_W_TABLE (VEX_W_D6_P_2) },
    { VEX_W_TABLE (VEX_W_D6_P_2) },
d8604 1
a8604 1
  /* VEX_LEN_D7_P_2_M_1 */
d8606 1
a8606 1
    { VEX_W_TABLE (VEX_W_D7_P_2_M_1) },
d8609 1
a8609 1
  /* VEX_LEN_D8_P_2 */
d8611 1
a8611 1
    { VEX_W_TABLE (VEX_W_D8_P_2) },
d8614 1
a8614 1
  /* VEX_LEN_D9_P_2 */
d8616 1
a8616 1
    { VEX_W_TABLE (VEX_W_D9_P_2) },
d8619 1
a8619 1
  /* VEX_LEN_DA_P_2 */
d8621 1
a8621 1
    { VEX_W_TABLE (VEX_W_DA_P_2) },
d8624 1
a8624 1
  /* VEX_LEN_DB_P_2 */
d8626 1
a8626 1
    { VEX_W_TABLE (VEX_W_DB_P_2) },
d8629 1
a8629 1
  /* VEX_LEN_DC_P_2 */
d8631 1
a8631 1
    { VEX_W_TABLE (VEX_W_DC_P_2) },
d8634 1
a8634 1
  /* VEX_LEN_DD_P_2 */
d8636 1
a8636 1
    { VEX_W_TABLE (VEX_W_DD_P_2) },
d8639 1
a8639 1
  /* VEX_LEN_DE_P_2 */
d8641 1
a8641 1
    { VEX_W_TABLE (VEX_W_DE_P_2) },
d8644 1
a8644 1
  /* VEX_LEN_DF_P_2 */
d8646 1
a8646 1
    { VEX_W_TABLE (VEX_W_DF_P_2) },
d8649 1
a8649 1
  /* VEX_LEN_E0_P_2 */
d8651 1
a8651 1
    { VEX_W_TABLE (VEX_W_E0_P_2) },
d8654 1
a8654 1
  /* VEX_LEN_E1_P_2 */
d8656 1
a8656 1
    { VEX_W_TABLE (VEX_W_E1_P_2) },
d8659 1
a8659 1
  /* VEX_LEN_E2_P_2 */
d8661 1
a8661 1
    { VEX_W_TABLE (VEX_W_E2_P_2) },
d8664 1
a8664 1
  /* VEX_LEN_E3_P_2 */
d8666 1
a8666 1
    { VEX_W_TABLE (VEX_W_E3_P_2) },
d8669 1
a8669 1
  /* VEX_LEN_E4_P_2 */
d8671 1
a8671 1
    { VEX_W_TABLE (VEX_W_E4_P_2) },
d8674 1
a8674 1
  /* VEX_LEN_E5_P_2 */
d8676 1
a8676 1
    { VEX_W_TABLE (VEX_W_E5_P_2) },
d8679 1
a8679 1
  /* VEX_LEN_E8_P_2 */
d8681 1
a8681 1
    { VEX_W_TABLE (VEX_W_E8_P_2) },
d8684 1
a8684 1
  /* VEX_LEN_E9_P_2 */
d8686 1
a8686 1
    { VEX_W_TABLE (VEX_W_E9_P_2) },
d8689 1
a8689 1
  /* VEX_LEN_EA_P_2 */
d8691 1
a8691 1
    { VEX_W_TABLE (VEX_W_EA_P_2) },
d8694 1
a8694 1
  /* VEX_LEN_EB_P_2 */
d8696 1
a8696 1
    { VEX_W_TABLE (VEX_W_EB_P_2) },
d8699 1
a8699 1
  /* VEX_LEN_EC_P_2 */
d8701 1
a8701 1
    { VEX_W_TABLE (VEX_W_EC_P_2) },
d8704 1
a8704 1
  /* VEX_LEN_ED_P_2 */
d8706 1
a8706 1
    { VEX_W_TABLE (VEX_W_ED_P_2) },
d8709 1
a8709 1
  /* VEX_LEN_EE_P_2 */
d8711 1
a8711 1
    { VEX_W_TABLE (VEX_W_EE_P_2) },
d8714 1
a8714 1
  /* VEX_LEN_EF_P_2 */
d8716 1
a8716 1
    { VEX_W_TABLE (VEX_W_EF_P_2) },
d8719 1
a8719 1
  /* VEX_LEN_F1_P_2 */
d8721 1
a8721 1
    { VEX_W_TABLE (VEX_W_F1_P_2) },
d8724 1
a8724 1
  /* VEX_LEN_F2_P_2 */
d8726 1
a8726 1
    { VEX_W_TABLE (VEX_W_F2_P_2) },
d8729 1
a8729 1
  /* VEX_LEN_F3_P_2 */
d8731 1
a8731 1
    { VEX_W_TABLE (VEX_W_F3_P_2) },
d8734 1
a8734 1
  /* VEX_LEN_F4_P_2 */
d8736 1
a8736 1
    { VEX_W_TABLE (VEX_W_F4_P_2) },
d8739 1
a8739 1
  /* VEX_LEN_F5_P_2 */
d8741 1
a8741 1
    { VEX_W_TABLE (VEX_W_F5_P_2) },
d8744 1
a8744 1
  /* VEX_LEN_F6_P_2 */
d8746 1
a8746 1
    { VEX_W_TABLE (VEX_W_F6_P_2) },
d8749 1
a8749 1
  /* VEX_LEN_F7_P_2 */
d8751 1
a8751 1
    { VEX_W_TABLE (VEX_W_F7_P_2) },
d8754 1
a8754 1
  /* VEX_LEN_F8_P_2 */
d8756 1
a8756 1
    { VEX_W_TABLE (VEX_W_F8_P_2) },
d8759 1
a8759 1
  /* VEX_LEN_F9_P_2 */
d8761 1
a8761 1
    { VEX_W_TABLE (VEX_W_F9_P_2) },
d8764 1
a8764 1
  /* VEX_LEN_FA_P_2 */
d8766 1
a8766 1
    { VEX_W_TABLE (VEX_W_FA_P_2) },
d8769 1
a8769 1
  /* VEX_LEN_FB_P_2 */
d8771 1
a8771 1
    { VEX_W_TABLE (VEX_W_FB_P_2) },
d8774 1
a8774 1
  /* VEX_LEN_FC_P_2 */
d8776 1
a8776 1
    { VEX_W_TABLE (VEX_W_FC_P_2) },
d8779 1
a8779 1
  /* VEX_LEN_FD_P_2 */
d8781 1
a8781 1
    { VEX_W_TABLE (VEX_W_FD_P_2) },
d8784 1
a8784 1
  /* VEX_LEN_FE_P_2 */
d8786 1
a8786 1
    { VEX_W_TABLE (VEX_W_FE_P_2) },
d8789 1
a8789 1
  /* VEX_LEN_3800_P_2 */
d8791 1
a8791 1
    { VEX_W_TABLE (VEX_W_3800_P_2) },
d8794 1
a8794 1
  /* VEX_LEN_3801_P_2 */
d8796 1
a8796 1
    { VEX_W_TABLE (VEX_W_3801_P_2) },
d8799 1
a8799 1
  /* VEX_LEN_3802_P_2 */
d8801 1
a8801 1
    { VEX_W_TABLE (VEX_W_3802_P_2) },
d8804 1
a8804 1
  /* VEX_LEN_3803_P_2 */
d8806 1
a8806 1
    { VEX_W_TABLE (VEX_W_3803_P_2) },
d8809 1
a8809 1
  /* VEX_LEN_3804_P_2 */
d8811 1
a8811 1
    { VEX_W_TABLE (VEX_W_3804_P_2) },
d8814 1
a8814 1
  /* VEX_LEN_3805_P_2 */
d8816 1
a8816 1
    { VEX_W_TABLE (VEX_W_3805_P_2) },
d8819 1
a8819 1
  /* VEX_LEN_3806_P_2 */
d8821 1
a8821 1
    { VEX_W_TABLE (VEX_W_3806_P_2) },
d8824 1
a8824 1
  /* VEX_LEN_3807_P_2 */
d8826 1
a8826 1
    { VEX_W_TABLE (VEX_W_3807_P_2) },
d8829 1
a8829 1
  /* VEX_LEN_3808_P_2 */
d8831 1
a8831 1
    { VEX_W_TABLE (VEX_W_3808_P_2) },
d8834 1
a8834 1
  /* VEX_LEN_3809_P_2 */
d8836 1
a8836 1
    { VEX_W_TABLE (VEX_W_3809_P_2) },
d8839 1
a8839 1
  /* VEX_LEN_380A_P_2 */
d8841 1
a8841 1
    { VEX_W_TABLE (VEX_W_380A_P_2) },
d8844 1
a8844 1
  /* VEX_LEN_380B_P_2 */
d8846 1
a8846 1
    { VEX_W_TABLE (VEX_W_380B_P_2) },
d8849 1
a8849 1
  /* VEX_LEN_3819_P_2_M_0 */
d8852 1
a8852 1
    { VEX_W_TABLE (VEX_W_3819_P_2_M_0) },
d8855 1
a8855 1
  /* VEX_LEN_381A_P_2_M_0 */
d8858 1
a8858 1
    { VEX_W_TABLE (VEX_W_381A_P_2_M_0) },
d8861 1
a8861 1
  /* VEX_LEN_381C_P_2 */
d8863 1
a8863 1
    { VEX_W_TABLE (VEX_W_381C_P_2) },
d8866 1
a8866 1
  /* VEX_LEN_381D_P_2 */
d8868 1
a8868 1
    { VEX_W_TABLE (VEX_W_381D_P_2) },
d8871 1
a8871 1
  /* VEX_LEN_381E_P_2 */
d8873 1
a8873 1
    { VEX_W_TABLE (VEX_W_381E_P_2) },
d8876 1
a8876 1
  /* VEX_LEN_3820_P_2 */
d8878 1
a8878 1
    { VEX_W_TABLE (VEX_W_3820_P_2) },
d8881 1
a8881 1
  /* VEX_LEN_3821_P_2 */
d8883 1
a8883 1
    { VEX_W_TABLE (VEX_W_3821_P_2) },
d8886 1
a8886 1
  /* VEX_LEN_3822_P_2 */
d8888 1
a8888 1
    { VEX_W_TABLE (VEX_W_3822_P_2) },
d8891 1
a8891 1
  /* VEX_LEN_3823_P_2 */
d8893 1
a8893 1
    { VEX_W_TABLE (VEX_W_3823_P_2) },
d8896 1
a8896 1
  /* VEX_LEN_3824_P_2 */
d8898 1
a8898 1
    { VEX_W_TABLE (VEX_W_3824_P_2) },
d8901 1
a8901 1
  /* VEX_LEN_3825_P_2 */
d8903 1
a8903 1
    { VEX_W_TABLE (VEX_W_3825_P_2) },
d8906 1
a8906 1
  /* VEX_LEN_3828_P_2 */
d8908 1
a8908 1
    { VEX_W_TABLE (VEX_W_3828_P_2) },
d8911 1
a8911 1
  /* VEX_LEN_3829_P_2 */
d8913 1
a8913 1
    { VEX_W_TABLE (VEX_W_3829_P_2) },
d8916 1
a8916 1
  /* VEX_LEN_382A_P_2_M_0 */
d8918 1
a8918 1
    { VEX_W_TABLE (VEX_W_382A_P_2_M_0) },
d8921 1
a8921 1
  /* VEX_LEN_382B_P_2 */
d8923 1
a8923 1
    { VEX_W_TABLE (VEX_W_382B_P_2) },
d8926 1
a8926 1
  /* VEX_LEN_3830_P_2 */
d8928 1
a8928 1
    { VEX_W_TABLE (VEX_W_3830_P_2) },
d8931 1
a8931 1
  /* VEX_LEN_3831_P_2 */
d8933 1
a8933 1
    { VEX_W_TABLE (VEX_W_3831_P_2) },
d8936 1
a8936 1
  /* VEX_LEN_3832_P_2 */
d8938 1
a8938 1
    { VEX_W_TABLE (VEX_W_3832_P_2) },
d8941 1
a8941 1
  /* VEX_LEN_3833_P_2 */
d8943 1
a8943 1
    { VEX_W_TABLE (VEX_W_3833_P_2) },
d8946 1
a8946 1
  /* VEX_LEN_3834_P_2 */
d8948 1
a8948 1
    { VEX_W_TABLE (VEX_W_3834_P_2) },
d8951 1
a8951 1
  /* VEX_LEN_3835_P_2 */
d8953 1
a8953 1
    { VEX_W_TABLE (VEX_W_3835_P_2) },
d8956 1
a8956 1
  /* VEX_LEN_3837_P_2 */
d8958 1
a8958 1
    { VEX_W_TABLE (VEX_W_3837_P_2) },
d8961 1
a8961 1
  /* VEX_LEN_3838_P_2 */
d8963 1
a8963 1
    { VEX_W_TABLE (VEX_W_3838_P_2) },
d8966 1
a8966 1
  /* VEX_LEN_3839_P_2 */
d8968 1
a8968 1
    { VEX_W_TABLE (VEX_W_3839_P_2) },
d8971 1
a8971 1
  /* VEX_LEN_383A_P_2 */
d8973 1
a8973 1
    { VEX_W_TABLE (VEX_W_383A_P_2) },
d8976 1
a8976 1
  /* VEX_LEN_383B_P_2 */
d8978 1
a8978 1
    { VEX_W_TABLE (VEX_W_383B_P_2) },
d8981 1
a8981 1
  /* VEX_LEN_383C_P_2 */
d8983 1
a8983 1
    { VEX_W_TABLE (VEX_W_383C_P_2) },
d8986 1
a8986 1
  /* VEX_LEN_383D_P_2 */
d8988 1
a8988 1
    { VEX_W_TABLE (VEX_W_383D_P_2) },
d8991 1
a8991 1
  /* VEX_LEN_383E_P_2 */
d8993 1
a8993 1
    { VEX_W_TABLE (VEX_W_383E_P_2) },
d8996 1
a8996 1
  /* VEX_LEN_383F_P_2 */
d8998 1
a8998 1
    { VEX_W_TABLE (VEX_W_383F_P_2) },
d9001 1
a9001 1
  /* VEX_LEN_3840_P_2 */
d9003 1
a9003 1
    { VEX_W_TABLE (VEX_W_3840_P_2) },
d9006 1
a9006 1
  /* VEX_LEN_3841_P_2 */
d9008 1
a9008 1
    { VEX_W_TABLE (VEX_W_3841_P_2) },
d9011 1
a9011 1
  /* VEX_LEN_38DB_P_2 */
d9013 1
a9013 1
    { VEX_W_TABLE (VEX_W_38DB_P_2) },
d9016 1
a9016 1
  /* VEX_LEN_38DC_P_2 */
d9018 1
a9018 1
    { VEX_W_TABLE (VEX_W_38DC_P_2) },
d9021 1
a9021 1
  /* VEX_LEN_38DD_P_2 */
d9023 1
a9023 1
    { VEX_W_TABLE (VEX_W_38DD_P_2) },
d9026 1
a9026 1
  /* VEX_LEN_38DE_P_2 */
d9028 1
a9028 1
    { VEX_W_TABLE (VEX_W_38DE_P_2) },
d9031 1
a9031 1
  /* VEX_LEN_38DF_P_2 */
d9033 1
a9033 1
    { VEX_W_TABLE (VEX_W_38DF_P_2) },
d9036 1
a9036 1
  /* VEX_LEN_3A06_P_2 */
d9039 1
a9039 1
    { VEX_W_TABLE (VEX_W_3A06_P_2) },
d9042 1
a9042 1
  /* VEX_LEN_3A0A_P_2 */
d9044 2
a9045 2
    { VEX_W_TABLE (VEX_W_3A0A_P_2) },
    { VEX_W_TABLE (VEX_W_3A0A_P_2) },
d9048 1
a9048 1
  /* VEX_LEN_3A0B_P_2 */
d9050 2
a9051 2
    { VEX_W_TABLE (VEX_W_3A0B_P_2) },
    { VEX_W_TABLE (VEX_W_3A0B_P_2) },
d9054 1
a9054 1
  /* VEX_LEN_3A0E_P_2 */
d9056 1
a9056 1
    { VEX_W_TABLE (VEX_W_3A0E_P_2) },
d9059 1
a9059 1
  /* VEX_LEN_3A0F_P_2 */
d9061 1
a9061 1
    { VEX_W_TABLE (VEX_W_3A0F_P_2) },
d9064 1
a9064 1
  /* VEX_LEN_3A14_P_2 */
d9066 1
a9066 1
    { VEX_W_TABLE (VEX_W_3A14_P_2) },
d9069 1
a9069 1
  /* VEX_LEN_3A15_P_2 */
d9071 1
a9071 1
    { VEX_W_TABLE (VEX_W_3A15_P_2) },
d9074 1
a9074 1
  /* VEX_LEN_3A16_P_2  */
d9079 1
a9079 1
  /* VEX_LEN_3A17_P_2 */
d9084 1
a9084 1
  /* VEX_LEN_3A18_P_2 */
d9087 1
a9087 1
    { VEX_W_TABLE (VEX_W_3A18_P_2) },
d9090 1
a9090 1
  /* VEX_LEN_3A19_P_2 */
d9093 1
a9093 1
    { VEX_W_TABLE (VEX_W_3A19_P_2) },
d9096 1
a9096 1
  /* VEX_LEN_3A20_P_2 */
d9098 1
a9098 1
    { VEX_W_TABLE (VEX_W_3A20_P_2) },
d9101 1
a9101 1
  /* VEX_LEN_3A21_P_2 */
d9103 1
a9103 1
    { VEX_W_TABLE (VEX_W_3A21_P_2) },
d9106 1
a9106 1
  /* VEX_LEN_3A22_P_2 */
d9111 1
a9111 1
  /* VEX_LEN_3A41_P_2 */
d9113 1
a9113 1
    { VEX_W_TABLE (VEX_W_3A41_P_2) },
d9116 1
a9116 1
  /* VEX_LEN_3A42_P_2 */
d9118 1
a9118 1
    { VEX_W_TABLE (VEX_W_3A42_P_2) },
d9121 1
a9121 1
  /* VEX_LEN_3A44_P_2 */
d9123 1
a9123 1
    { VEX_W_TABLE (VEX_W_3A44_P_2) },
d9126 1
a9126 1
  /* VEX_LEN_3A4C_P_2 */
d9128 1
a9128 1
    { VEX_W_TABLE (VEX_W_3A4C_P_2) },
d9131 1
a9131 1
  /* VEX_LEN_3A60_P_2 */
d9133 1
a9133 1
    { VEX_W_TABLE (VEX_W_3A60_P_2) },
d9136 1
a9136 1
  /* VEX_LEN_3A61_P_2 */
d9138 1
a9138 1
    { VEX_W_TABLE (VEX_W_3A61_P_2) },
d9141 1
a9141 1
  /* VEX_LEN_3A62_P_2 */
d9143 1
a9143 1
    { VEX_W_TABLE (VEX_W_3A62_P_2) },
d9146 1
a9146 1
  /* VEX_LEN_3A63_P_2 */
d9148 1
a9148 1
    { VEX_W_TABLE (VEX_W_3A63_P_2) },
d9151 1
a9151 1
  /* VEX_LEN_3A6A_P_2 */
d9156 1
a9156 1
  /* VEX_LEN_3A6B_P_2 */
d9161 1
a9161 1
  /* VEX_LEN_3A6E_P_2 */
d9166 1
a9166 1
  /* VEX_LEN_3A6F_P_2 */
d9171 1
a9171 1
  /* VEX_LEN_3A7A_P_2 */
d9176 1
a9176 1
  /* VEX_LEN_3A7B_P_2 */
d9181 1
a9181 1
  /* VEX_LEN_3A7E_P_2 */
d9186 1
a9186 1
  /* VEX_LEN_3A7F_P_2 */
d9191 1
a9191 1
  /* VEX_LEN_3ADF_P_2 */
d9193 1
a9193 1
    { VEX_W_TABLE (VEX_W_3ADF_P_2) },
d9196 1
a9196 1
  /* VEX_LEN_XOP_09_80 */
d9202 1
a9202 1
  /* VEX_LEN_XOP_09_81 */
d9211 1
a9211 1
    /* VEX_W_10_P_0 */
d9215 1
a9215 1
    /* VEX_W_10_P_1 */
d9219 1
a9219 1
    /* VEX_W_10_P_2 */
d9223 1
a9223 1
    /* VEX_W_10_P_3 */
d9227 1
a9227 1
    /* VEX_W_11_P_0 */
d9231 1
a9231 1
    /* VEX_W_11_P_1 */
d9235 1
a9235 1
    /* VEX_W_11_P_2 */
d9239 1
a9239 1
    /* VEX_W_11_P_3 */
d9243 1
a9243 1
    /* VEX_W_12_P_0_M_0 */
d9247 1
a9247 1
    /* VEX_W_12_P_0_M_1 */
d9251 1
a9251 1
    /* VEX_W_12_P_1 */
d9255 1
a9255 1
    /* VEX_W_12_P_2 */
d9259 1
a9259 1
    /* VEX_W_12_P_3 */
d9263 1
a9263 1
    /* VEX_W_13_M_0 */
d9267 1
a9267 1
    /* VEX_W_14 */
d9271 1
a9271 1
    /* VEX_W_15 */
d9275 1
a9275 1
    /* VEX_W_16_P_0_M_0 */
d9279 1
a9279 1
    /* VEX_W_16_P_0_M_1 */
d9283 1
a9283 1
    /* VEX_W_16_P_1 */
d9287 1
a9287 1
    /* VEX_W_16_P_2 */
d9291 1
a9291 1
    /* VEX_W_17_M_0 */
d9295 1
a9295 1
    /* VEX_W_28 */
d9299 1
a9299 1
    /* VEX_W_29 */
d9303 1
a9303 1
    /* VEX_W_2B_M_0 */
d9307 1
a9307 1
    /* VEX_W_2E_P_0 */
d9311 1
a9311 1
    /* VEX_W_2E_P_2 */
d9315 1
a9315 1
    /* VEX_W_2F_P_0 */
d9319 1
a9319 1
    /* VEX_W_2F_P_2 */
d9323 1
a9323 1
    /* VEX_W_50_M_0 */
d9327 1
a9327 1
    /* VEX_W_51_P_0 */
d9331 1
a9331 1
    /* VEX_W_51_P_1 */
d9335 1
a9335 1
    /* VEX_W_51_P_2  */
d9339 1
a9339 1
    /* VEX_W_51_P_3 */
d9343 1
a9343 1
    /* VEX_W_52_P_0 */
d9347 1
a9347 1
    /* VEX_W_52_P_1 */
d9351 1
a9351 1
    /* VEX_W_53_P_0  */
d9355 1
a9355 1
    /* VEX_W_53_P_1  */
d9359 1
a9359 1
    /* VEX_W_58_P_0  */
d9363 1
a9363 1
    /* VEX_W_58_P_1  */
d9367 1
a9367 1
    /* VEX_W_58_P_2  */
d9371 1
a9371 1
    /* VEX_W_58_P_3  */
d9375 1
a9375 1
    /* VEX_W_59_P_0  */
d9379 1
a9379 1
    /* VEX_W_59_P_1  */
d9383 1
a9383 1
    /* VEX_W_59_P_2  */
d9387 1
a9387 1
    /* VEX_W_59_P_3  */
d9391 1
a9391 1
    /* VEX_W_5A_P_0  */
d9395 1
a9395 1
    /* VEX_W_5A_P_1  */
d9399 1
a9399 1
    /* VEX_W_5A_P_3  */
d9403 1
a9403 1
    /* VEX_W_5B_P_0  */
d9407 1
a9407 1
    /* VEX_W_5B_P_1  */
d9411 1
a9411 1
    /* VEX_W_5B_P_2  */
d9415 1
a9415 1
    /* VEX_W_5C_P_0  */
d9419 1
a9419 1
    /* VEX_W_5C_P_1  */
d9423 1
a9423 1
    /* VEX_W_5C_P_2  */
d9427 1
a9427 1
    /* VEX_W_5C_P_3  */
d9431 1
a9431 1
    /* VEX_W_5D_P_0  */
d9435 1
a9435 1
    /* VEX_W_5D_P_1  */
d9439 1
a9439 1
    /* VEX_W_5D_P_2  */
d9443 1
a9443 1
    /* VEX_W_5D_P_3  */
d9447 1
a9447 1
    /* VEX_W_5E_P_0  */
d9451 1
a9451 1
    /* VEX_W_5E_P_1  */
d9455 1
a9455 1
    /* VEX_W_5E_P_2  */
d9459 1
a9459 1
    /* VEX_W_5E_P_3  */
d9463 1
a9463 1
    /* VEX_W_5F_P_0  */
d9467 1
a9467 1
    /* VEX_W_5F_P_1  */
d9471 1
a9471 1
    /* VEX_W_5F_P_2  */
d9475 1
a9475 1
    /* VEX_W_5F_P_3  */
d9479 1
a9479 1
    /* VEX_W_60_P_2  */
d9483 1
a9483 1
    /* VEX_W_61_P_2  */
d9487 1
a9487 1
    /* VEX_W_62_P_2  */
d9491 1
a9491 1
    /* VEX_W_63_P_2  */
d9495 1
a9495 1
    /* VEX_W_64_P_2  */
d9499 1
a9499 1
    /* VEX_W_65_P_2  */
d9503 1
a9503 1
    /* VEX_W_66_P_2  */
d9507 1
a9507 1
    /* VEX_W_67_P_2  */
d9511 1
a9511 1
    /* VEX_W_68_P_2  */
d9515 1
a9515 1
    /* VEX_W_69_P_2  */
d9519 1
a9519 1
    /* VEX_W_6A_P_2  */
d9523 1
a9523 1
    /* VEX_W_6B_P_2  */
d9527 1
a9527 1
    /* VEX_W_6C_P_2  */
d9531 1
a9531 1
    /* VEX_W_6D_P_2  */
d9535 1
a9535 1
    /* VEX_W_6F_P_1  */
d9539 1
a9539 1
    /* VEX_W_6F_P_2  */
d9543 1
a9543 1
    /* VEX_W_70_P_1 */
d9547 1
a9547 1
    /* VEX_W_70_P_2 */
d9551 1
a9551 1
    /* VEX_W_70_P_3 */
d9555 1
a9555 1
    /* VEX_W_71_R_2_P_2  */
d9559 1
a9559 1
    /* VEX_W_71_R_4_P_2  */
d9563 1
a9563 1
    /* VEX_W_71_R_6_P_2  */
d9567 1
a9567 1
    /* VEX_W_72_R_2_P_2  */
d9571 1
a9571 1
    /* VEX_W_72_R_4_P_2  */
d9575 1
a9575 1
    /* VEX_W_72_R_6_P_2  */
d9579 1
a9579 1
    /* VEX_W_73_R_2_P_2  */
d9583 1
a9583 1
    /* VEX_W_73_R_3_P_2  */
d9587 1
a9587 1
    /* VEX_W_73_R_6_P_2  */
d9591 1
a9591 1
    /* VEX_W_73_R_7_P_2  */
d9595 1
a9595 1
    /* VEX_W_74_P_2 */
d9599 1
a9599 1
    /* VEX_W_75_P_2 */
d9603 1
a9603 1
    /* VEX_W_76_P_2 */
d9607 1
a9607 1
    /* VEX_W_77_P_0 */
d9611 1
a9611 1
    /* VEX_W_7C_P_2 */
d9615 1
a9615 1
    /* VEX_W_7C_P_3 */
d9619 1
a9619 1
    /* VEX_W_7D_P_2 */
d9623 1
a9623 1
    /* VEX_W_7D_P_3 */
d9627 1
a9627 1
    /* VEX_W_7E_P_1 */
d9631 1
a9631 1
    /* VEX_W_7F_P_1 */
d9635 1
a9635 1
    /* VEX_W_7F_P_2 */
d9639 1
a9639 1
    /* VEX_W_AE_R_2_M_0 */
d9643 1
a9643 1
    /* VEX_W_AE_R_3_M_0 */
d9647 1
a9647 1
    /* VEX_W_C2_P_0 */
d9651 1
a9651 1
    /* VEX_W_C2_P_1 */
d9655 1
a9655 1
    /* VEX_W_C2_P_2 */
d9659 1
a9659 1
    /* VEX_W_C2_P_3 */
d9663 1
a9663 1
    /* VEX_W_C4_P_2 */
d9667 1
a9667 1
    /* VEX_W_C5_P_2 */
d9671 1
a9671 1
    /* VEX_W_D0_P_2 */
d9675 1
a9675 1
    /* VEX_W_D0_P_3 */
d9679 1
a9679 1
    /* VEX_W_D1_P_2 */
d9683 1
a9683 1
    /* VEX_W_D2_P_2 */
d9687 1
a9687 1
    /* VEX_W_D3_P_2 */
d9691 1
a9691 1
    /* VEX_W_D4_P_2 */
d9695 1
a9695 1
    /* VEX_W_D5_P_2 */
d9699 1
a9699 1
    /* VEX_W_D6_P_2 */
d9703 1
a9703 1
    /* VEX_W_D7_P_2_M_1 */
d9707 1
a9707 1
    /* VEX_W_D8_P_2 */
d9711 1
a9711 1
    /* VEX_W_D9_P_2 */
d9715 1
a9715 1
    /* VEX_W_DA_P_2 */
d9719 1
a9719 1
    /* VEX_W_DB_P_2 */
d9723 1
a9723 1
    /* VEX_W_DC_P_2 */
d9727 1
a9727 1
    /* VEX_W_DD_P_2 */
d9731 1
a9731 1
    /* VEX_W_DE_P_2 */
d9735 1
a9735 1
    /* VEX_W_DF_P_2 */
d9739 1
a9739 1
    /* VEX_W_E0_P_2  */
d9743 1
a9743 1
    /* VEX_W_E1_P_2  */
d9747 1
a9747 1
    /* VEX_W_E2_P_2  */
d9751 1
a9751 1
    /* VEX_W_E3_P_2  */
d9755 1
a9755 1
    /* VEX_W_E4_P_2  */
d9759 1
a9759 1
    /* VEX_W_E5_P_2  */
d9763 1
a9763 1
    /* VEX_W_E6_P_1  */
d9767 1
a9767 1
    /* VEX_W_E6_P_2  */
d9771 1
a9771 1
    /* VEX_W_E6_P_3  */
d9775 1
a9775 1
    /* VEX_W_E7_P_2_M_0 */
d9779 1
a9779 1
    /* VEX_W_E8_P_2  */
d9783 1
a9783 1
    /* VEX_W_E9_P_2  */
d9787 1
a9787 1
    /* VEX_W_EA_P_2  */
d9791 1
a9791 1
    /* VEX_W_EB_P_2  */
d9795 1
a9795 1
    /* VEX_W_EC_P_2  */
d9799 1
a9799 1
    /* VEX_W_ED_P_2  */
d9803 1
a9803 1
    /* VEX_W_EE_P_2  */
d9807 1
a9807 1
    /* VEX_W_EF_P_2  */
d9811 1
a9811 1
    /* VEX_W_F0_P_3_M_0 */
d9815 1
a9815 1
    /* VEX_W_F1_P_2 */
d9819 1
a9819 1
    /* VEX_W_F2_P_2 */
d9823 1
a9823 1
    /* VEX_W_F3_P_2 */
d9827 1
a9827 1
    /* VEX_W_F4_P_2 */
d9831 1
a9831 1
    /* VEX_W_F5_P_2 */
d9835 1
a9835 1
    /* VEX_W_F6_P_2 */
d9839 1
a9839 1
    /* VEX_W_F7_P_2 */
d9843 1
a9843 1
    /* VEX_W_F8_P_2 */
d9847 1
a9847 1
    /* VEX_W_F9_P_2 */
d9851 1
a9851 1
    /* VEX_W_FA_P_2 */
d9855 1
a9855 1
    /* VEX_W_FB_P_2 */
d9859 1
a9859 1
    /* VEX_W_FC_P_2 */
d9863 1
a9863 1
    /* VEX_W_FD_P_2 */
d9867 1
a9867 1
    /* VEX_W_FE_P_2 */
d9871 1
a9871 1
    /* VEX_W_3800_P_2  */
d9875 1
a9875 1
    /* VEX_W_3801_P_2  */
d9879 1
a9879 1
    /* VEX_W_3802_P_2  */
d9883 1
a9883 1
    /* VEX_W_3803_P_2  */
d9887 1
a9887 1
    /* VEX_W_3804_P_2  */
d9891 1
a9891 1
    /* VEX_W_3805_P_2  */
d9895 1
a9895 1
    /* VEX_W_3806_P_2  */
d9899 1
a9899 1
    /* VEX_W_3807_P_2  */
d9903 1
a9903 1
    /* VEX_W_3808_P_2  */
d9907 1
a9907 1
    /* VEX_W_3809_P_2  */
d9911 1
a9911 1
    /* VEX_W_380A_P_2  */
d9915 1
a9915 1
    /* VEX_W_380B_P_2  */
d9919 1
a9919 1
    /* VEX_W_380C_P_2  */
d9923 1
a9923 1
    /* VEX_W_380D_P_2  */
d9927 1
a9927 1
    /* VEX_W_380E_P_2  */
d9931 1
a9931 1
    /* VEX_W_380F_P_2  */
d9935 1
a9935 1
    /* VEX_W_3817_P_2 */
d9939 1
a9939 1
    /* VEX_W_3818_P_2_M_0 */
d9943 1
a9943 1
    /* VEX_W_3819_P_2_M_0 */
d9947 1
a9947 1
    /* VEX_W_381A_P_2_M_0 */
d9951 1
a9951 1
    /* VEX_W_381C_P_2 */
d9955 1
a9955 1
    /* VEX_W_381D_P_2 */
d9959 1
a9959 1
    /* VEX_W_381E_P_2 */
d9963 1
a9963 1
    /* VEX_W_3820_P_2 */
d9967 1
a9967 1
    /* VEX_W_3821_P_2 */
d9971 1
a9971 1
    /* VEX_W_3822_P_2 */
d9975 1
a9975 1
    /* VEX_W_3823_P_2 */
d9979 1
a9979 1
    /* VEX_W_3824_P_2 */
d9983 1
a9983 1
    /* VEX_W_3825_P_2 */
d9987 1
a9987 1
    /* VEX_W_3828_P_2 */
d9991 1
a9991 1
    /* VEX_W_3829_P_2 */
d9995 1
a9995 1
    /* VEX_W_382A_P_2_M_0 */
d9999 1
a9999 1
    /* VEX_W_382B_P_2 */
d10003 1
a10003 1
    /* VEX_W_382C_P_2_M_0 */
d10007 1
a10007 1
    /* VEX_W_382D_P_2_M_0 */
d10011 1
a10011 1
    /* VEX_W_382E_P_2_M_0 */
d10015 1
a10015 1
    /* VEX_W_382F_P_2_M_0 */
d10019 1
a10019 1
    /* VEX_W_3830_P_2 */
d10023 1
a10023 1
    /* VEX_W_3831_P_2 */
d10027 1
a10027 1
    /* VEX_W_3832_P_2 */
d10031 1
a10031 1
    /* VEX_W_3833_P_2 */
d10035 1
a10035 1
    /* VEX_W_3834_P_2 */
d10039 1
a10039 1
    /* VEX_W_3835_P_2 */
d10043 1
a10043 1
    /* VEX_W_3837_P_2 */
d10047 1
a10047 1
    /* VEX_W_3838_P_2 */
d10051 1
a10051 1
    /* VEX_W_3839_P_2 */
d10055 1
a10055 1
    /* VEX_W_383A_P_2 */
d10059 1
a10059 1
    /* VEX_W_383B_P_2 */
d10063 1
a10063 1
    /* VEX_W_383C_P_2 */
d10067 1
a10067 1
    /* VEX_W_383D_P_2 */
d10071 1
a10071 1
    /* VEX_W_383E_P_2 */
d10075 1
a10075 1
    /* VEX_W_383F_P_2 */
d10079 1
a10079 1
    /* VEX_W_3840_P_2 */
d10083 1
a10083 1
    /* VEX_W_3841_P_2 */
d10087 1
a10087 1
    /* VEX_W_38DB_P_2 */
d10091 1
a10091 1
    /* VEX_W_38DC_P_2 */
d10095 1
a10095 1
    /* VEX_W_38DD_P_2 */
d10099 1
a10099 1
    /* VEX_W_38DE_P_2 */
d10103 1
a10103 1
    /* VEX_W_38DF_P_2 */
d10107 1
a10107 1
    /* VEX_W_3A04_P_2 */
d10111 1
a10111 1
    /* VEX_W_3A05_P_2 */
d10115 1
a10115 1
    /* VEX_W_3A06_P_2 */
d10119 1
a10119 1
    /* VEX_W_3A08_P_2 */
d10123 1
a10123 1
    /* VEX_W_3A09_P_2 */
d10127 1
a10127 1
    /* VEX_W_3A0A_P_2 */
d10131 1
a10131 1
    /* VEX_W_3A0B_P_2 */
d10135 1
a10135 1
    /* VEX_W_3A0C_P_2 */
d10139 1
a10139 1
    /* VEX_W_3A0D_P_2 */
d10143 1
a10143 1
    /* VEX_W_3A0E_P_2 */
d10147 1
a10147 1
    /* VEX_W_3A0F_P_2 */
d10151 1
a10151 1
    /* VEX_W_3A14_P_2 */
d10155 1
a10155 1
    /* VEX_W_3A15_P_2 */
d10159 1
a10159 1
    /* VEX_W_3A18_P_2 */
d10163 1
a10163 1
    /* VEX_W_3A19_P_2 */
d10167 1
a10167 1
    /* VEX_W_3A20_P_2 */
d10171 1
a10171 1
    /* VEX_W_3A21_P_2 */
d10175 1
a10175 1
    /* VEX_W_3A40_P_2 */
d10179 1
a10179 1
    /* VEX_W_3A41_P_2 */
d10183 1
a10183 1
    /* VEX_W_3A42_P_2 */
d10187 1
a10187 1
    /* VEX_W_3A44_P_2 */
d10191 1
a10191 1
    /* VEX_W_3A48_P_2 */
d10196 1
a10196 1
    /* VEX_W_3A49_P_2 */
d10201 1
a10201 1
    /* VEX_W_3A4A_P_2 */
d10205 1
a10205 1
    /* VEX_W_3A4B_P_2 */
d10209 1
a10209 1
    /* VEX_W_3A4C_P_2 */
d10213 1
a10213 1
    /* VEX_W_3A60_P_2 */
d10217 1
a10217 1
    /* VEX_W_3A61_P_2 */
d10221 1
a10221 1
    /* VEX_W_3A62_P_2 */
d10225 1
a10225 1
    /* VEX_W_3A63_P_2 */
d10229 1
a10229 1
    /* VEX_W_3ADF_P_2 */
d10491 3
a10493 3
    /* MOD_VEX_12_PREFIX_0 */
    { VEX_LEN_TABLE (VEX_LEN_12_P_0_M_0) },
    { VEX_LEN_TABLE (VEX_LEN_12_P_0_M_1) },
d10496 2
a10497 2
    /* MOD_VEX_13 */
    { VEX_LEN_TABLE (VEX_LEN_13_M_0) },
d10500 3
a10502 3
    /* MOD_VEX_16_PREFIX_0 */
    { VEX_LEN_TABLE (VEX_LEN_16_P_0_M_0) },
    { VEX_LEN_TABLE (VEX_LEN_16_P_0_M_1) },
d10505 2
a10506 2
    /* MOD_VEX_17 */
    { VEX_LEN_TABLE (VEX_LEN_17_M_0) },
d10509 2
a10510 2
    /* MOD_VEX_2B */
    { VEX_W_TABLE (VEX_W_2B_M_0) },
d10513 1
a10513 1
    /* MOD_VEX_50 */
d10515 1
a10515 1
    { VEX_W_TABLE (VEX_W_50_M_0) },
d10518 1
a10518 1
    /* MOD_VEX_71_REG_2 */
d10520 1
a10520 1
    { PREFIX_TABLE (PREFIX_VEX_71_REG_2) },
d10523 1
a10523 1
    /* MOD_VEX_71_REG_4 */
d10525 1
a10525 1
    { PREFIX_TABLE (PREFIX_VEX_71_REG_4) },
d10528 1
a10528 1
    /* MOD_VEX_71_REG_6 */
d10530 1
a10530 1
    { PREFIX_TABLE (PREFIX_VEX_71_REG_6) },
d10533 1
a10533 1
    /* MOD_VEX_72_REG_2 */
d10535 1
a10535 1
    { PREFIX_TABLE (PREFIX_VEX_72_REG_2) },
d10538 1
a10538 1
    /* MOD_VEX_72_REG_4 */
d10540 1
a10540 1
    { PREFIX_TABLE (PREFIX_VEX_72_REG_4) },
d10543 1
a10543 1
    /* MOD_VEX_72_REG_6 */
d10545 1
a10545 1
    { PREFIX_TABLE (PREFIX_VEX_72_REG_6) },
d10548 1
a10548 1
    /* MOD_VEX_73_REG_2 */
d10550 1
a10550 1
    { PREFIX_TABLE (PREFIX_VEX_73_REG_2) },
d10553 1
a10553 1
    /* MOD_VEX_73_REG_3 */
d10555 1
a10555 1
    { PREFIX_TABLE (PREFIX_VEX_73_REG_3) },
d10558 1
a10558 1
    /* MOD_VEX_73_REG_6 */
d10560 1
a10560 1
    { PREFIX_TABLE (PREFIX_VEX_73_REG_6) },
d10563 1
a10563 1
    /* MOD_VEX_73_REG_7 */
d10565 1
a10565 1
    { PREFIX_TABLE (PREFIX_VEX_73_REG_7) },
d10568 2
a10569 2
    /* MOD_VEX_AE_REG_2 */
    { VEX_LEN_TABLE (VEX_LEN_AE_R_2_M_0) },
d10572 2
a10573 2
    /* MOD_VEX_AE_REG_3 */
    { VEX_LEN_TABLE (VEX_LEN_AE_R_3_M_0) },
d10576 1
a10576 1
    /* MOD_VEX_D7_PREFIX_2 */
d10578 1
a10578 1
    { VEX_LEN_TABLE (VEX_LEN_D7_P_2_M_1) },
d10581 2
a10582 2
    /* MOD_VEX_E7_PREFIX_2 */
    { VEX_W_TABLE (VEX_W_E7_P_2_M_0) },
d10585 2
a10586 2
    /* MOD_VEX_F0_PREFIX_3 */
    { VEX_W_TABLE (VEX_W_F0_P_3_M_0) },
d10589 2
a10590 2
    /* MOD_VEX_3818_PREFIX_2 */
    { VEX_W_TABLE (VEX_W_3818_P_2_M_0) },
d10593 2
a10594 2
    /* MOD_VEX_3819_PREFIX_2 */
    { VEX_LEN_TABLE (VEX_LEN_3819_P_2_M_0) },
d10597 2
a10598 2
    /* MOD_VEX_381A_PREFIX_2 */
    { VEX_LEN_TABLE (VEX_LEN_381A_P_2_M_0) },
d10601 2
a10602 2
    /* MOD_VEX_382A_PREFIX_2 */
    { VEX_LEN_TABLE (VEX_LEN_382A_P_2_M_0) },
d10605 2
a10606 2
    /* MOD_VEX_382C_PREFIX_2 */
    { VEX_W_TABLE (VEX_W_382C_P_2_M_0) },
d10609 2
a10610 2
    /* MOD_VEX_382D_PREFIX_2 */
    { VEX_W_TABLE (VEX_W_382D_P_2_M_0) },
d10613 2
a10614 2
    /* MOD_VEX_382E_PREFIX_2 */
    { VEX_W_TABLE (VEX_W_382E_P_2_M_0) },
d10617 2
a10618 2
    /* MOD_VEX_382F_PREFIX_2 */
    { VEX_W_TABLE (VEX_W_382F_P_2_M_0) },
@


1.246
log
@Support AVX Programming Reference (June, 2010)

gas/

2010-07-01  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (June, 2010)
	* config/tc-i386.c (cpu_arch): Add .xsaveopt, .fsgsbase, .rdrnd
	and .f16c.

	* doc/c-i386.texi: Document xsaveopt, fsgsbase, rdrnd and f16c.

gas/testsuite/

2010-07-01  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (June, 2010)
	* gas/i386/arch-10.s: Add xsaveopt.
	* gas/i386/x86-64-arch-2.s: Likwise.

	* gas/i386/arch-10.d: Updated.
	* gas/i386/arch-10-1.l: Likewise.
	* gas/i386/arch-10-2.l: Likewise.
	* gas/i386/arch-10-3.l: Likewise.
	* gas/i386/arch-10-4.l: Likewise.
	* gas/i386/x86-64-arch-2.d: Likewise.

	* gas/i386/f16c-intel.d: New.
	* gas/i386/f16c.d: Likewise.
	* gas/i386/f16c.s: Likewise.
	* gas/i386/fsgs-intel.d: Likewise.
	* gas/i386/fsgs.d: Likewise.
	* gas/i386/fsgs.s: Likewise.
	* gas/i386/rdrnd-intel.d: Likewise.
	* gas/i386/rdrnd.d: Likewise.
	* gas/i386/rdrnd.s: Likewise.
	* gas/i386/x86-64-f16c-intel.d: Likewise.
	* gas/i386/x86-64-f16c.d: Likewise.
	* gas/i386/x86-64-f16c.s: Likewise.
	* gas/i386/x86-64-fsgs-intel.d: Likewise.
	* gas/i386/x86-64-fsgs.d: Likewise.
	* gas/i386/x86-64-fsgs.s: Likewise.
	* gas/i386/x86-64-rdrnd-intel.d: Likewise.
	* gas/i386/x86-64-rdrnd.d: Likewise.
	* gas/i386/x86-64-rdrnd.s: Likewise.

	* gas/i386/i386.exp: Run f16c, f16c-intel, fsgs, fsgs-intel,
	rdrnd, rdrnd-intel, x86-64-f16c, x86-64-f16c-intel, x86-64-fsgs,
	x86-64-fsgs-intel, x86-64-rdrnd, x86-64-rdrnd-intel.

	* gas/i386/x86-64-xsave.s: Add tests for xsaveopt64.

	* gas/i386/x86-64-xsave-intel.d: Updated.
	* gas/i386/x86-64-xsave.d: Likewise.

opcodes/

2010-07-01  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (June, 2010)
	* i386-dis.c (PREFIX_0FAE_REG_0): New.
	(PREFIX_0FAE_REG_1): Likewise.
	(PREFIX_0FAE_REG_2): Likewise.
	(PREFIX_0FAE_REG_3): Likewise.
	(PREFIX_VEX_3813): Likewise.
	(PREFIX_VEX_3A1D): Likewise.
	(prefix_table): Add PREFIX_0FAE_REG_0, PREFIX_0FAE_REG_1,
	PREFIX_0FAE_REG_2, PREFIX_0FAE_REG_3, PREFIX_VEX_3813 and
	PREFIX_VEX_3A1D.
	(vex_table): Add PREFIX_VEX_3813 and PREFIX_VEX_3A1D.
	(mod_table): Add PREFIX_0FAE_REG_0, PREFIX_0FAE_REG_1,
	PREFIX_0FAE_REG_2, PREFIX_0FAE_REG_3 xsaveopt and rdrnd.

	* i386-gen.c (cpu_flag_init): Add CPU_XSAVEOPT_FLAGS,
	CPU_FSGSBASE_FLAGS, CPU_RDRND_FLAGS and CPU_F16C_FLAGS.
	(cpu_flags): Add CpuXsaveopt, CpuFSGSBase, CpuRdRnd and CpuF16C.

	* i386-opc.h (CpuXsaveopt): New.
	(CpuFSGSBase):Likewise.
	(CpuRdRnd): Likewise.
	(CpuF16C): Likewise.
	(i386_cpu_flags): Add cpuxsaveopt, cpufsgsbase, cpurdrnd and
	cpuf16c.

	* i386-opc.tbl: Add xsaveopt, rdfsbase, rdgsbase, rdrnd,
	wrfsbase, wrgsbase, vcvtph2ps and vcvtps2ph.
@
text
@d10453 1
a10453 1
    { "rdrnd",		{ Ev } },
@


1.245
log
@Add SIB.

2010-05-26  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (sib): New.
	(get_sib): Likewise.
	(print_insn): Call get_sib.
	OP_E_memory): Use sib.
@
text
@d744 4
d943 1
d1034 1
d3042 24
d4452 7
d5090 7
d7580 1
a7580 1
    { Bad_Opcode },
d7882 1
a7882 1
    { Bad_Opcode },
d10402 1
d10407 1
d10412 1
d10417 1
d10430 1
a10430 1
    { Bad_Opcode },
d10453 1
@


1.244
log
@Remove extra breack.
@
text
@d2308 7
d11253 16
d11554 1
d11562 1
d12963 3
a12965 4
	  FETCH_DATA (the_info, codep + 1);
	  vindex = (*codep >> 3) & 7;
	  scale = (*codep >> 6) & 3;
	  base = *codep & 7;
@


1.243
log
@Return bad_opcode on unknown bits in opcode.

2010-04-16  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (get_valid_dis386): Return bad_opcode on unknown
	bits in opcode.
@
text
@a11062 1
	  break;
@


1.242
log
@bfd/ChangeLog
2010-04-09  Nick Clifton  <nickc@@redhat.com>

        * aoutx.h (aout_link_input_bfd): Remove unused variable sym_count.
        * elf-eh-frame.c (_bfd_elf_eh_frame_section_offset): Remove unused
        variables htab and hdr_info and mark info parameter as unused.
        * elf.c (prep_headers): Remove unused variable i_phdrp.
        (_bfd_elf_write_object_contents): Remove unused variable i_ehdrp.
        * elf32-i386.c (elf_i386_relocate_section): Mark variabled warned
        as unused.
        * peXXigen.c (pe_print_reloc): Remove unused variable datasize.
        * verilog.c (verilog_write_section): Remove unused variable
        address.

binutils/ChangeLog
2010-04-09  Nick Clifton  <nickc@@redhat.com>

        * dwarf.c (process_debug_info): Remove unused variable
        cu_abbrev_offset_ptr.
        (display_debug_lines_decoded): Remove unused variable prev_line.
        * elfedit.c (process_archive): Remove unused variable
        file_name_size.
        * ieee.c (ieee_start_compilation_unit): Remove unused variable
        nindx.
        (ieee_set_type): Remove unused variables info, targetindx and
        baseindx.
        * objdump.c (disassmble_byte): Remove unused variable done_dot.
        * rddbg.c (read_section_stabs_debugging_info): Remove unused
        variable other.
        * readelf.c (dump_section_as_strings): Remove unused variable
        addr.
        (process_archive): Remove unused variable file_name_size.
        * stabs.c (parse_stab_string): Mark desc parameter as unused.
        Remove unused variable lineno.
        (parse_stab_struct_type): Remove unused variable orig.
        (stab_demangle_type): Remove unused variables constp, volatilep
        and hold.

gas/ChangeLog
2010-04-09  Nick Clifton  <nickc@@redhat.com>

        * as.c (create_obj_attrs_section): Remove unused variable addr.
        * listing.c (listing_listing): Remove unused variable message.
        * read.c: Remove unnecessary register type qualifiers.
        (s_mri): Only define/use old_flag variable if MRI_MODE_CHANGE is
        defined.

ld/ChangeLog
2010-04-09  Nick Clifton  <nickc@@redhat.com>

        * ldlang.c (wild_sort): Remove unused variable section_name.

opcodes/ChangeLog
2010-04-09  Nick Clifton  <nickc@@redhat.com>

        * i386-dis.c (print_insn): Remove unused variable op.
        (OP_sI): Remove unused variable mask.
@
text
@d11061 3
a11063 1
	  BadOp ();
d11082 4
a11085 1
	BadOp ();
d11123 2
a11124 1
	  BadOp ();
d11143 4
a11146 1
	BadOp ();
d11188 4
a11191 1
	BadOp ();
@


1.241
log
@2010-03-22  Sebastian Pop  <sebastian.pop@@amd.com>
	    Quentin Neill <quentin.neill@@amd.com>

	opcodes/
	* i386-dis.c (OP_LWP_I): Removed.
	(reg_table): Do not use OP_LWP_I, use Iq.
	(OP_LWPCB_E): Remove use of names16.
	(OP_LWP_E): Same.
	* i386-opc.tbl: Removed 16bit LWP insns.  32bit LWP insns
	should not set the Vex.length bit.
	* i386-tbl.h: Regenerated.

	gas/
	* testsuite/gas/i386/x86-64-lwp.s: Remove use of 16bit LWP insns.
	* testsuite/gas/i386/lwp.s: Same.
	* testsuite/gas/i386/x86-64-lwp.d: Updated.
	* testsuite/gas/i386/lwp.d: Updated.
@
text
@a11244 1
  unsigned char op;
a11448 2
  op = 0;

a13531 1
  bfd_signed_vma mask = -1;
a13539 1
      mask = 0xffffffff;
a13549 1
	      mask = 0xffffffff;
a13552 1
	      mask = 0xffffffff;
a13561 1
      mask = 0xffffffff;
@


1.240
log
@Update copyright.

gas/

2010-02-11  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c: Update copyright.

opcodes/

2010-02-11  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c: Update copyright.
	* i386-gen.c: Likewise.
	* i386-opc.h: Likewise.
	* i386-opc.tbl: Likewise.
@
text
@a116 1
static void OP_LWP_I (int, int);
d2746 2
a2747 2
    { "lwpins", { { OP_LWP_E, 0 }, Ed, { OP_LWP_I, 0 } } },
    { "lwpval",	{ { OP_LWP_E, 0 }, Ed, { OP_LWP_I, 0 } } },
d14979 1
a14979 1
  else if (vex.length == 256)
a14980 2
  else
    names = names16;
d14997 1
a14997 1
  else if (vex.length == 256)
a14998 2
  else
    names = names16;
a15002 9
static void
OP_LWP_I (int bytemode ATTRIBUTE_UNUSED, int sizeflag)
{
  if (vex.w || vex.length == 256)
    OP_I (q_mode, sizeflag);
  else
    OP_I (w_mode, sizeflag);
}

@


1.239
log
@2010-02-10  Quentin Neill  <quentin.neill@@amd.com>
            Sebastian Pop  <sebastian.pop@@amd.com>

gas:
        * config/tc-i386.c (vec_imm4) New operand type.
        (fits_in_imm4): New.
        (VEX_check_operands): New.
        (check_reverse): Call VEX_check_operands.
        (build_modrm_byte): Reintroduce code for 5
        operand insns.  Fix whitespace.

gas/testsuite:
        * gas/i386/x86-64-xop.d: Add vpermil2p[sd] tests.
        * gas/i386/x86-64-xop.s: Likewise.
        * gas/i386/xop.d: Likewise.
        * gas/i386/xop.s: Likewise.

opcodes:
        * i386-dis.c (OP_EX_VexImmW): Reintroduced
        function to handle 5th imm8 operand.
        (PREFIX_VEX_3A48): Added.
        (PREFIX_VEX_3A49): Added.
        (VEX_W_3A48_P_2): Added.
        (VEX_W_3A49_P_2): Added.
        (prefix table): Added entries for PREFIX_VEX_3A48
        and PREFIX_VEX_3A49.
        (vex table): Added entries for VEX_W_3A48_P_2 and
        and VEX_W_3A49_P_2.
        * i386-gen.c (operand_type_init): Added OPERAND_TYPE_VEC_IMM4
        for Vec_Imm4 operands.
        * i386-opc.h (enum): Added Vec_Imm4.
        (i386_operand_type): Added vec_imm4.
        * i386-opc.tbl: Add entries for vpermilp[ds].
        * i386-init.h: Regenerated.
        * i386-tbl.h: Regenerated.
@
text
@d3 1
a3 1
   2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009
@


1.238
log
@Allow VL=1 on scalar FMA instructions.

gas/testsuite/

2010-01-28  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/fma-scalar-intel.d: New.
	* gas/i386/fma-scalar.d: Likewise.
	* gas/i386/fma-scalar.s: Likewise.
	* gas/i386/x86-64-fma-scalar-intel.d: Likewise.
	* gas/i386/x86-64-fma-scalar.d: Likewise.
	* gas/i386/x86-64-fma-scalar.s: Likewise.

	* gas/i386/i386.exp: Run fma-scalar, fma-scalar-intel,
	x86-64-fma-scalar and x86-64-fma-scalar-intel.

opcodes/

2010-01-28  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (EXVexWdqScalar): New.
	(vex_scalar_w_dq_mode): Likewise.
	(prefix_table): Update entries for PREFIX_VEX_3899,
	PREFIX_VEX_389B, PREFIX_VEX_389D, PREFIX_VEX_389F,
	PREFIX_VEX_38A9, PREFIX_VEX_38AB, PREFIX_VEX_38AD,
	PREFIX_VEX_38AF, PREFIX_VEX_38B9, PREFIX_VEX_38BB,
	PREFIX_VEX_38BD and PREFIX_VEX_38BF.
	(intel_operand_size): Handle vex_scalar_w_dq_mode.
	(OP_EX): Likewise.
@
text
@d94 1
d384 1
d1037 2
d1577 2
d5096 14
d7881 2
a7882 2
    { Bad_Opcode },
    { Bad_Opcode },
d10141 10
d14614 41
@


1.237
log
@Allow VL=1 on AVX scalar instructions.

gas/

2010-01-27  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c (avxscalar): New.
	(OPTION_MAVXSCALAR): Likewise.
	(build_vex_prefix): Select vector_length for scalar instructions
	based on avxscalar.
	(md_longopts): Add OPTION_MAVXSCALAR.
	(md_parse_option): Handle OPTION_MAVXSCALAR.
	(md_show_usage): Add -mavxscalar=.

	* doc/c-i386.texi: Document -mavxscalar=.

gas/testsuite/

2010-01-27  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/avx-scalar-intel.d: New.
	* gas/i386/avx-scalar.d: Likewise.
	* gas/i386/avx-scalar.s: Likewise.
	* gas/i386/x86-64-avx-scalar-intel.d: Likewise.
	* gas/i386/x86-64-avx-scalar.d: Likewise.
	* gas/i386/x86-64-avx-scalar.s: Likewise.

	* gas/i386/i386.exp: Run avx-scalar, avx-scalar-intel,
	x86-64-avx-scalar and x86-64-avx-scalar-intel.

opcodes/

2010-01-27  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (XMScalar): New.
	(EXdScalar): Likewise.
	(EXqScalar): Likewise.
	(EXqScalarS): Likewise.
	(VexScalar): Likewise.
	(EXdVexScalarS): Likewise.
	(EXqVexScalarS): Likewise.
	(XMVexScalar): Likewise.
	(scalar_mode): Likewise.
	(d_scalar_mode): Likewise.
	(d_scalar_swap_mode): Likewise.
	(q_scalar_mode): Likewise.
	(q_scalar_swap_mode): Likewise.
	(vex_scalar_mode): Likewise.
	(vex_len_table): Duplcate entries for VEX_LEN_10_P_1,
	VEX_LEN_10_P_3, VEX_LEN_11_P_1, VEX_LEN_11_P_3, VEX_LEN_2A_P_1,
	VEX_LEN_2A_P_3, VEX_LEN_2C_P_3, VEX_LEN_2D_P_1, VEX_LEN_2E_P_0,
	VEX_LEN_2E_P_2, VEX_LEN_2F_P_2, VEX_LEN_51_P_1, VEX_LEN_51_P_3,
	VEX_LEN_52_P_1, VEX_LEN_53_P_1, VEX_LEN_58_P_1, VEX_LEN_58_P_3,
	VEX_LEN_59_P_1, VEX_LEN_5A_P_1, VEX_LEN_5A_P_3, VEX_LEN_5C_P_1,
	VEX_LEN_5C_P_3, VEX_LEN_5D_P_1, VEX_LEN_5D_P_3, VEX_LEN_5E_P_1,
	VEX_LEN_5E_P_3, VEX_LEN_5F_P_1, VEX_LEN_5F_P_3, VEX_LEN_6E_P_2,
	VEX_LEN_7E_P_1, VEX_LEN_7E_P_2, VEX_LEN_D6_P_2, VEX_LEN_C2_P_1,
	VEX_LEN_C2_P_3, VEX_LEN_3A0A_P_2 and VEX_LEN_3A0B_P_2.
	(vex_w_table): Update entries for VEX_W_10_P_1, VEX_W_10_P_3,
	VEX_W_11_P_1, VEX_W_11_P_3, VEX_W_2E_P_0, VEX_W_2E_P_2,
	VEX_W_2F_P_0, VEX_W_2F_P_2, VEX_W_51_P_1, VEX_W_51_P_3,
	VEX_W_52_P_1, VEX_W_53_P_1, VEX_W_58_P_1, VEX_W_58_P_3,
	VEX_W_59_P_1, VEX_W_59_P_3, VEX_W_5A_P_1, VEX_W_5A_P_3,
	VEX_W_5C_P_1, VEX_W_5C_P_3, VEX_W_5D_P_1, VEX_W_5D_P_3,
	VEX_W_5E_P_1, VEX_W_5E_P_3, VEX_W_5F_P_1, VEX_W_5F_P_3,
	VEX_W_7E_P_1, VEX_W_D6_P_2  VEX_W_C2_P_1, VEX_W_C2_P_3,
	VEX_W_3A0A_P_2 and VEX_W_3A0B_P_2.
	(intel_operand_size): Handle d_scalar_mode, d_scalar_swap_mode,
	q_scalar_mode, q_scalar_swap_mode.
	(OP_XMM): Handle scalar_mode.
	(OP_EX): Handle d_scalar_mode, d_scalar_swap_mode, q_scalar_mode
	and q_scalar_swap_mode.
	(OP_VEX): Handle vex_scalar_mode.
@
text
@d357 1
d485 2
d4701 1
a4701 1
    { "vfmadd132s%XW", { XM, Vex, EXVexWdq } },
d4715 1
a4715 1
    { "vfmsub132s%XW", { XM, Vex, EXVexWdq } },
d4729 1
a4729 1
    { "vfnmadd132s%XW", { XM, Vex, EXVexWdq } },
d4743 1
a4743 1
    { "vfnmsub132s%XW", { XM, Vex, EXVexWdq } },
d4772 1
a4772 1
    { "vfmadd213s%XW", { XM, Vex, EXVexWdq } },
d4786 1
a4786 1
    { "vfmsub213s%XW", { XM, Vex, EXVexWdq } },
d4800 1
a4800 1
    { "vfnmadd213s%XW", { XM, Vex, EXVexWdq } },
d4814 1
a4814 1
    { "vfnmsub213s%XW", { XM, Vex, EXVexWdq } },
d4842 1
a4842 1
    { "vfmadd231s%XW", { XM, Vex, EXVexWdq } },
d4856 1
a4856 1
    { "vfmsub231s%XW", { XM, Vex, EXVexWdq } },
d4870 1
a4870 1
    { "vfnmadd231s%XW", { XM, Vex, EXVexWdq } },
d4884 1
a4884 1
    { "vfnmsub231s%XW", { XM, Vex, EXVexWdq } },
d12782 1
d13976 2
a13977 1
      && bytemode != q_scalar_swap_mode)
@


1.236
log
@Remove trailing { Bad_Opcode }.
@
text
@d337 1
d345 1
d348 2
d369 1
d375 1
d378 1
d383 1
d472 13
d8071 1
d8077 1
d8083 1
d8089 1
d8134 2
a8135 1
    { "vcvtsi2ss%LQ",	{ XM, Vex128, Ev } },
d8140 2
a8141 1
    { "vcvtsi2sd%LQ",	{ XM, Vex128, Ev } },
d8146 2
a8147 1
    { "vcvttss2siY",	{ Gv, EXd } },
d8152 2
a8153 1
    { "vcvttsd2siY",	{ Gv, EXq } },
d8158 2
a8159 1
    { "vcvtss2siY",	{ Gv, EXd } },
d8164 2
a8165 1
    { "vcvtsd2siY",	{ Gv, EXq } },
d8171 1
d8177 1
d8183 1
d8189 1
d8195 1
d8201 1
d8207 1
d8213 1
d8219 1
d8225 1
d8231 1
d8237 1
d8243 1
d8249 1
d8255 1
d8261 1
d8267 1
d8273 1
d8279 1
d8285 1
d8291 1
d8297 1
d8372 2
a8373 1
    { "vmovK",		{ XM, Edq } },
d8459 1
d8464 2
a8465 1
    { "vmovK",		{ Edq, XM } },
d8481 1
d8487 1
d8528 1
d8972 1
d8978 1
d9143 1
a9143 1
    { "vmovss",		{ XMVex, Vex128, EXd } },
d9151 1
a9151 1
    { "vmovsd",		{ XMVex, Vex128, EXq } },
d9159 1
a9159 1
    { "vmovss",		{ EXdVexS, Vex128, XM } },
d9167 1
a9167 1
    { "vmovsd",		{ EXqVexS, Vex128, XM } },
d9235 1
a9235 1
    { "vucomiss",	{ XM, EXd } }, 
d9239 1
a9239 1
    { "vucomisd",	{ XM, EXq } }, 
d9243 1
a9243 1
    { "vcomiss",	{ XM, EXd } },
d9247 1
a9247 1
    { "vcomisd",	{ XM, EXq } },
d9259 1
a9259 1
    { "vsqrtss",	{ XM, Vex128, EXd } },
d9267 1
a9267 1
    { "vsqrtsd",	{ XM, Vex128, EXq } },
d9275 1
a9275 1
    { "vrsqrtss",	{ XM, Vex128, EXd } },
d9283 1
a9283 1
    { "vrcpss",		{ XM, Vex128, EXd } },
d9291 1
a9291 1
    { "vaddss",		{ XM, Vex128, EXd } },
d9299 1
a9299 1
    { "vaddsd",		{ XM, Vex128, EXq } },
d9307 1
a9307 1
    { "vmulss",		{ XM, Vex128, EXd } },
d9315 1
a9315 1
    { "vmulsd",		{ XM, Vex128, EXq } },
d9323 1
a9323 1
    { "vcvtss2sd",	{ XM, Vex128, EXd } },
d9327 1
a9327 1
    { "vcvtsd2ss",	{ XM, Vex128, EXq } },
d9347 1
a9347 1
    { "vsubss",		{ XM, Vex128, EXd } },
d9355 1
a9355 1
    { "vsubsd",		{ XM, Vex128, EXq } },
d9363 1
a9363 1
    { "vminss",		{ XM, Vex128, EXd } },
d9371 1
a9371 1
    { "vminsd",		{ XM, Vex128, EXq } },
d9379 1
a9379 1
    { "vdivss",		{ XM, Vex128, EXd } },
d9387 1
a9387 1
    { "vdivsd",		{ XM, Vex128, EXq } },
d9395 1
a9395 1
    { "vmaxss",		{ XM, Vex128, EXd } },
d9403 1
a9403 1
    { "vmaxsd",		{ XM, Vex128, EXq } },
d9555 1
a9555 1
    { "vmovq",		{ XM, EXq } },
d9579 1
a9579 1
    { "vcmpss",		{ XM, Vex128, EXd, VCMP } },
d9587 1
a9587 1
    { "vcmpsd",		{ XM, Vex128, EXq, VCMP } },
d9627 1
a9627 1
    { "vmovq",		{ EXqS, XM } },
d10055 1
a10055 1
    { "vroundss",	{ XM, Vex128, EXd, Ib } },
d10059 1
a10059 1
    { "vroundsd",	{ XM, Vex128, EXq, Ib } },
d12693 2
d12700 2
d13845 3
a13847 1
  if (need_vex && bytemode != xmm_mode)
d13961 3
a13963 1
	  || bytemode == q_swap_mode))
d13968 5
a13972 1
      && bytemode != xmmq_mode)
d14401 1
d14410 7
d14449 1
a14449 1
  oappend (names[vex.register_specifier]);
@


1.235
log
@Remove trailing { Bad_Opcode } in vex_len_table.

2010-01-24  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (vex_len_table): Remove trailing { Bad_Opcode }.
@
text
@a4439 1
    { Bad_Opcode },
@


1.234
log
@Remove trailing { Bad_Opcode }.

2010-01-24  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (prefix_table): Remove trailing { Bad_Opcode }.
@
text
@a8595 1
    { Bad_Opcode },
@


1.233
log
@Remove trailing "(bad)" entries and replace { "(bad)", { XX } }
with { Bad_Opcode }.

2010-01-24  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (Bad_Opcode): New.
	(bad_opcode): Likewise.
	(dis386): Replace { "(bad)", { XX } } with { Bad_Opcode }.
	(dis386_twobyte): Likewise.
	(reg_table): Likewise.
	(prefix_table): Likewise.
	(x86_64_table): Likewise.
	(vex_len_table): Likewise.
	(vex_w_table): Likewise.
	(mod_table): Likewise.
	(rm_table): Likewise.
	(float_reg): Likewise.
	(reg_table): Remove trailing "(bad)" entries.
	(prefix_table): Likewise.
	(x86_64_table): Likewise.
	(vex_len_table): Likewise.
	(vex_w_table): Likewise.
	(mod_table): Likewise.
	(rm_table): Likewise.
	(get_valid_dis386): Handle bytemode 0.
@
text
@a5262 1
    { Bad_Opcode },
@


1.232
log
@Add xsave64 and xrstor64.

gas/testsuite/

2010-02-21  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/x86-64-xsave.s: Add tests for xsave64 and xrstor64.

	* gas/i386/x86-64-xsave-intel.d: Updated.
	* gas/i386/x86-64-xsave.d: Likewise.

opcodes/

2010-02-21  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (mod_table): Use FXSAVE on xsave and xrstor.

	* i386-opc.tbl: Add xsave64 and xrstor64.
	* i386-tbl.h: Regenerated.
@
text
@d219 1
d1640 1
a1640 1
  { "(bad)",		{ XX } },	/* 0x0f extended opcode escape */
d1666 1
a1666 1
  { "(bad)",		{ XX } },	/* SEG ES prefix */
d1675 1
a1675 1
  { "(bad)",		{ XX } },	/* SEG CS prefix */
d1684 1
a1684 1
  { "(bad)",		{ XX } },	/* SEG SS prefix */
d1693 1
a1693 1
  { "(bad)",		{ XX } },	/* SEG DS prefix */
d1736 4
a1739 4
  { "(bad)",		{ XX } },	/* seg fs */
  { "(bad)",		{ XX } },	/* seg gs */
  { "(bad)",		{ XX } },	/* op size prefix */
  { "(bad)",		{ XX } },	/* adr size prefix */
d1770 1
a1770 1
  { "(bad)",		{ XX } },
d1798 1
a1798 1
  { "(bad)",		{ XX } },	/* fwait */
d1864 1
a1864 1
  { "(bad)",		{ XX } },
d1894 1
a1894 1
  { "(bad)",		{ XX } },	/* lock prefix */
d1896 2
a1897 2
  { "(bad)",		{ XX } },	/* repne */
  { "(bad)",		{ XX } },	/* repz */
d1919 1
a1919 1
  { "(bad)",		{ XX } },
d1926 1
a1926 1
  { "(bad)",		{ XX } },
d1928 1
a1928 1
  { "(bad)",		{ XX } },
d1956 1
a1956 1
  { "(bad)",		{ XX } },
d1958 1
a1958 1
  { "(bad)",		{ XX } },
d1975 1
a1975 1
  { "(bad)",		{ XX } },
d1979 1
a1979 1
  { "(bad)",		{ XX } },
d1981 5
a1985 5
  { "(bad)",		{ XX } },
  { "(bad)",		{ XX } },
  { "(bad)",		{ XX } },
  { "(bad)",		{ XX } },
  { "(bad)",		{ XX } },
d2053 1
a2053 1
  { "(bad)",		{ XX } },
d2201 1
a2201 1
  { "(bad)",		{ XX } },
d2442 3
a2444 3
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a2445 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d2455 1
a2455 1
    { "(bad)",	{ XX } },
d2466 1
a2466 1
    { "(bad)",	{ XX } },
a2471 7
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a2475 7
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",  { XX } },
d2485 1
a2485 1
    { "(bad)",	{ XX } },
d2496 1
a2496 1
    { "(bad)",	{ XX } },
d2507 1
a2507 1
    { "(bad)",	{ XX } },
d2518 1
a2518 1
    { "(bad)",	{ XX } },
d2524 1
a2524 1
    { "(bad)",	{ XX } },
d2535 1
a2535 1
    { "(bad)",	{ XX } },
a2546 6
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d2557 1
a2557 1
    { "(bad)",	{ XX } },
d2567 2
a2568 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d2577 1
a2577 1
    { "(bad)",	{ XX } },
a2584 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
a2591 4
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d2595 2
a2596 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d2598 1
a2598 1
    { "(bad)",	{ XX } },
d2600 1
a2600 1
    { "(bad)",	{ XX } },
a2601 1
    { "(bad)",	{ XX } },
d2605 2
a2606 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d2608 1
a2608 1
    { "(bad)",	{ XX } },
d2610 1
a2610 1
    { "(bad)",	{ XX } },
a2611 1
    { "(bad)",	{ XX } },
d2615 2
a2616 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d2619 2
a2620 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a2628 5
    { "(bad)",		{ { OP_0f07, 0 } } },
    { "(bad)",		{ { OP_0f07, 0 } } },
    { "(bad)",		{ { OP_0f07, 0 } } },
    { "(bad)",		{ { OP_0f07, 0 } } },
    { "(bad)",		{ { OP_0f07, 0 } } },
a2637 2
    { "(bad)",		{ { OP_0f07, 0 } } },
    { "(bad)",		{ { OP_0f07, 0 } } },
d2652 4
a2655 4
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d2663 1
a2663 1
    { "(bad)",	{ XX } },
d2665 4
a2668 4
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d2674 2
a2675 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d2677 1
a2677 1
    { "(bad)",	{ XX } },
d2679 1
a2679 1
    { "(bad)",	{ XX } },
a2680 1
    { "(bad)",	{ XX } },
d2684 2
a2685 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d2687 1
a2687 1
    { "(bad)",	{ XX } },
d2689 1
a2689 1
    { "(bad)",	{ XX } },
a2690 1
    { "(bad)",	{ XX } },
d2694 2
a2695 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d2698 2
a2699 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d2705 2
a2706 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a2708 4
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a2713 6
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a2718 6
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a2727 1
    { "(bad)", { XX } },
a2758 1
    { "(bad)",	{ XX } },
d2796 1
a2796 1
    { "(bad)",	{ XX } },
a2797 1
    { "(bad)",	{ XX } },
d2803 1
a2803 1
    { "(bad)",	{ XX } },
a2804 1
    { "(bad)",	{ XX } },
a2818 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a2824 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a2855 1
    { "(bad)",	{ XX } },
d2893 1
a2893 1
    { "(bad)",	{ XX } },
a2894 1
    { "(bad)",	{ XX } },
d2900 1
a2900 1
    { "(bad)",	{ XX } },
a2901 1
    { "(bad)",	{ XX } },
d2907 1
a2907 1
    { "(bad)",	{ XX } },
a2908 1
    { "(bad)",	{ XX } },
d2913 2
a2914 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a2915 1
    { "(bad)",	{ XX } },
d2920 2
a2921 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a2922 1
    { "(bad)",	{ XX } },
a2929 1
    { "(bad)",	{ XX } },
d2942 2
a2943 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a2944 1
    { "(bad)",	{ XX } },
d2949 2
a2950 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a2951 1
    { "(bad)",	{ XX } },
d2957 1
a2957 1
    {"(bad)",	{ XX } },
d2965 1
a2965 1
    {"(bad)",	{ XX } },
d2972 2
a2973 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d2980 2
a2981 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a2990 1
    { "(bad)",	{ XX } },
a2997 1
    { "(bad)",	{ XX } },
d3002 1
a3002 1
    { "(bad)", { XX } },
a3003 2
    { "(bad)", { XX } },
    { "(bad)", { XX } },
a3010 1
    { "(bad)",	{ XX } },
a3023 3
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3030 1
    { "(bad)",	{ XX } },
d3035 2
a3036 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d3043 1
a3043 1
    { "(bad)",	{ XX } },
d3051 1
a3051 1
    { "(bad)",	{ XX } },
d3060 1
a3060 1
    { "(bad)",	{ XX } },
a3061 1
    { "(bad)",	{ XX } },
d3066 3
a3068 3
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d3075 1
a3075 1
    { "(bad)",	{ XX } },
a3076 1
    { "(bad)",	{ XX } },
d3081 2
a3082 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3083 1
    { "(bad)",	{ XX } },
d3088 2
a3089 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3090 1
    { "(bad)",	{ XX } },
d3095 2
a3096 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3097 1
    { "(bad)",	{ XX } },
d3102 2
a3103 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3104 1
    { "(bad)",	{ XX } },
d3109 2
a3110 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3111 1
    { "(bad)",	{ XX } },
d3116 2
a3117 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3118 1
    { "(bad)",	{ XX } },
d3123 2
a3124 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3125 1
    { "(bad)",	{ XX } },
d3130 2
a3131 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3132 1
    { "(bad)",	{ XX } },
d3137 2
a3138 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3139 1
    { "(bad)",	{ XX } },
d3144 2
a3145 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3146 1
    { "(bad)",	{ XX } },
d3151 2
a3152 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3153 1
    { "(bad)",	{ XX } },
d3158 2
a3159 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3160 1
    { "(bad)",	{ XX } },
d3165 2
a3166 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3167 1
    { "(bad)",	{ XX } },
d3172 2
a3173 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3174 1
    { "(bad)",	{ XX } },
d3179 2
a3180 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3181 1
    { "(bad)",	{ XX } },
d3186 2
a3187 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3188 1
    { "(bad)",	{ XX } },
d3193 2
a3194 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3195 1
    { "(bad)",	{ XX } },
d3200 2
a3201 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3202 1
    { "(bad)",	{ XX } },
d3207 2
a3208 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3209 1
    { "(bad)",	{ XX } },
d3214 2
a3215 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3216 1
    { "(bad)",	{ XX } },
d3221 2
a3222 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3223 1
    { "(bad)",	{ XX } },
d3228 2
a3229 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3230 1
    { "(bad)",	{ XX } },
d3235 2
a3236 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3237 1
    { "(bad)",	{ XX } },
d3242 2
a3243 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3244 1
    { "(bad)",	{ XX } },
d3249 2
a3250 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3251 1
    { "(bad)",	{ XX } },
d3256 2
a3257 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3258 1
    { "(bad)",	{ XX } },
d3263 2
a3264 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3265 1
    { "(bad)",	{ XX } },
d3270 2
a3271 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3272 1
    { "(bad)",	{ XX } },
d3277 2
a3278 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3279 1
    { "(bad)",	{ XX } },
d3284 2
a3285 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3286 1
    { "(bad)",	{ XX } },
d3291 2
a3292 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3293 1
    { "(bad)",	{ XX } },
d3298 2
a3299 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3300 1
    { "(bad)",	{ XX } },
d3305 2
a3306 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3307 1
    { "(bad)",	{ XX } },
d3312 2
a3313 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3314 1
    { "(bad)",	{ XX } },
d3319 2
a3320 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3321 1
    { "(bad)",	{ XX } },
d3326 2
a3327 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3328 1
    { "(bad)",	{ XX } },
d3333 2
a3334 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3335 1
    { "(bad)",	{ XX } },
d3340 2
a3341 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3342 1
    { "(bad)",	{ XX } },
d3348 1
a3348 1
    { "(bad)",	{ XX } },
d3356 1
a3356 1
    { "(bad)",	{ XX } },
d3363 2
a3364 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3365 1
    { "(bad)",	{ XX } },
d3370 2
a3371 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3372 1
    { "(bad)",	{ XX } },
d3377 2
a3378 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3379 1
    { "(bad)",	{ XX } },
d3384 2
a3385 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3386 1
    { "(bad)",	{ XX } },
d3391 2
a3392 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3393 1
    { "(bad)",	{ XX } },
d3398 2
a3399 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3400 1
    { "(bad)",	{ XX } },
d3405 2
a3406 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3407 1
    { "(bad)",	{ XX } },
d3412 2
a3413 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3414 1
    { "(bad)",	{ XX } },
d3419 2
a3420 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3421 1
    { "(bad)",	{ XX } },
d3426 2
a3427 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3428 1
    { "(bad)",	{ XX } },
d3433 2
a3434 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3435 1
    { "(bad)",	{ XX } },
d3440 2
a3441 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3442 1
    { "(bad)",	{ XX } },
d3447 2
a3448 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3449 1
    { "(bad)",	{ XX } },
d3454 2
a3455 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3456 1
    { "(bad)",	{ XX } },
d3461 2
a3462 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3463 1
    { "(bad)",	{ XX } },
d3468 2
a3469 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3470 1
    { "(bad)",	{ XX } },
d3475 2
a3476 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3477 1
    { "(bad)",	{ XX } },
d3482 2
a3483 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3484 1
    { "(bad)",	{ XX } },
d3489 2
a3490 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3491 1
    { "(bad)",	{ XX } },
d3496 2
a3497 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3498 1
    { "(bad)",	{ XX } },
d3503 2
a3504 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3505 1
    { "(bad)",	{ XX } },
d3510 2
a3511 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3512 1
    { "(bad)",	{ XX } },
d3517 2
a3518 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3519 1
    { "(bad)",	{ XX } },
a3550 1
    { "(bad)",	{ XX } },
d3555 1
a3555 1
    { "(bad)",	{ XX } },
d3557 1
a3557 1
    { "(bad)",	{ XX } },
d3563 1
a3563 1
    { "(bad)",	{ XX } },
d3565 1
a3565 1
    { "(bad)",	{ XX } },
d3571 1
a3571 1
    { "(bad)",	{ XX } },
d3573 1
a3573 1
    { "(bad)",	{ XX } },
d3580 1
a3580 1
    { "(bad)",	{ XX } },
a3581 1
    { "(bad)",	{ XX } },
d3587 1
a3587 1
    { "(bad)",	{ XX } },
a3588 1
    { "(bad)",	{ XX } },
a3602 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3608 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3639 1
    { "(bad)",	{ XX } },
d3676 2
a3677 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3678 1
    { "(bad)",	{ XX } },
d3683 2
a3684 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3685 1
    { "(bad)",	{ XX } },
d3690 2
a3691 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3692 1
    { "(bad)",	{ XX } },
d3697 2
a3698 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3699 1
    { "(bad)",	{ XX } },
d3704 2
a3705 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3706 1
    { "(bad)",	{ XX } },
d3711 2
a3712 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3713 1
    { "(bad)",	{ XX } },
d3718 2
a3719 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3720 1
    { "(bad)",	{ XX } },
d3725 2
a3726 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3727 1
    { "(bad)",	{ XX } },
d3732 2
a3733 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3734 1
    { "(bad)",	{ XX } },
d3739 2
a3740 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3741 1
    { "(bad)",	{ XX } },
d3746 2
a3747 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3748 1
    { "(bad)",	{ XX } },
d3753 2
a3754 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3755 1
    { "(bad)",	{ XX } },
d3760 2
a3761 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3762 1
    { "(bad)",	{ XX } },
d3767 2
a3768 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3769 1
    { "(bad)",	{ XX } },
d3774 2
a3775 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3776 1
    { "(bad)",	{ XX } },
d3781 1
a3781 1
    { "(bad)",	{ XX } },
a3783 1
    { "(bad)",	{ XX } },
d3788 1
a3788 1
    { "(bad)",	{ XX } },
d3796 2
a3797 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3798 1
    { "(bad)",	{ XX } },
d3803 2
a3804 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3805 1
    { "(bad)",	{ XX } },
d3810 2
a3811 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3812 1
    { "(bad)",	{ XX } },
d3817 2
a3818 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3819 1
    { "(bad)",	{ XX } },
d3824 2
a3825 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3826 1
    { "(bad)",	{ XX } },
d3831 2
a3832 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3833 1
    { "(bad)",	{ XX } },
d3838 2
a3839 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3840 1
    { "(bad)",	{ XX } },
d3845 2
a3846 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3847 1
    { "(bad)",	{ XX } },
d3852 2
a3853 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3854 1
    { "(bad)",	{ XX } },
d3859 2
a3860 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3861 1
    { "(bad)",	{ XX } },
d3866 2
a3867 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3868 1
    { "(bad)",	{ XX } },
d3873 2
a3874 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3875 1
    { "(bad)",	{ XX } },
d3880 2
a3881 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3882 1
    { "(bad)",	{ XX } },
a3887 3
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d3892 2
a3893 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d3900 2
a3901 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d3908 1
a3908 1
    { "(bad)",	{ XX } },
a3910 1
    { "(bad)",	{ XX } },
d3915 1
a3915 1
    { "(bad)",	{ XX } },
a3917 1
    { "(bad)",	{ XX } },
d3930 2
a3931 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3932 1
    { "(bad)",	{ XX } },
d3937 2
a3938 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3939 1
    { "(bad)",	{ XX } },
d3944 2
a3945 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d3952 2
a3953 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3954 1
    { "(bad)",	{ XX } },
d3959 2
a3960 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3961 1
    { "(bad)",	{ XX } },
d3966 2
a3967 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3968 1
    { "(bad)",	{ XX } },
d3973 2
a3974 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3975 1
    { "(bad)",	{ XX } },
d3980 2
a3981 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3982 1
    { "(bad)",	{ XX } },
d3987 2
a3988 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3989 1
    { "(bad)",	{ XX } },
d3994 2
a3995 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a3996 1
    { "(bad)",	{ XX } },
d4001 2
a4002 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4003 1
    { "(bad)",	{ XX } },
d4008 2
a4009 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4010 1
    { "(bad)",	{ XX } },
d4015 2
a4016 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4017 1
    { "(bad)",	{ XX } },
d4022 2
a4023 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4024 1
    { "(bad)",	{ XX } },
d4029 2
a4030 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4031 1
    { "(bad)",	{ XX } },
d4036 2
a4037 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4038 1
    { "(bad)",	{ XX } },
d4043 2
a4044 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4045 1
    { "(bad)",	{ XX } },
d4050 2
a4051 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4052 1
    { "(bad)",	{ XX } },
d4057 2
a4058 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4059 1
    { "(bad)",	{ XX } },
d4064 2
a4065 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4066 1
    { "(bad)",	{ XX } },
d4071 2
a4072 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4073 1
    { "(bad)",	{ XX } },
d4078 2
a4079 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4080 1
    { "(bad)",	{ XX } },
d4085 2
a4086 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4087 1
    { "(bad)",	{ XX } },
d4092 2
a4093 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4094 1
    { "(bad)",	{ XX } },
d4099 1
a4099 1
    { "(bad)",	{ XX } },
d4107 2
a4108 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4109 1
    { "(bad)",	{ XX } },
d4114 2
a4115 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4116 1
    { "(bad)",	{ XX } },
d4121 2
a4122 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4123 1
    { "(bad)",	{ XX } },
d4128 2
a4129 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4130 1
    { "(bad)",	{ XX } },
d4135 2
a4136 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4137 1
    { "(bad)",	{ XX } },
d4142 2
a4143 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4144 1
    { "(bad)",	{ XX } },
d4149 2
a4150 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4151 1
    { "(bad)",	{ XX } },
d4156 2
a4157 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4158 1
    { "(bad)",	{ XX } },
d4163 2
a4164 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4165 1
    { "(bad)",	{ XX } },
d4170 3
a4172 3
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d4178 2
a4179 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4180 1
    { "(bad)",	{ XX } },
d4185 2
a4186 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4187 1
    { "(bad)",	{ XX } },
d4192 2
a4193 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4194 1
    { "(bad)",	{ XX } },
d4199 2
a4200 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4201 1
    { "(bad)",	{ XX } },
d4206 2
a4207 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4208 1
    { "(bad)",	{ XX } },
d4213 2
a4214 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4215 1
    { "(bad)",	{ XX } },
d4220 2
a4221 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4222 1
    { "(bad)",	{ XX } },
d4227 2
a4228 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4229 1
    { "(bad)",	{ XX } },
d4234 2
a4235 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4236 1
    { "(bad)",	{ XX } },
d4241 2
a4242 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4243 1
    { "(bad)",	{ XX } },
d4248 2
a4249 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4250 1
    { "(bad)",	{ XX } },
d4255 2
a4256 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4257 1
    { "(bad)",	{ XX } },
d4262 2
a4263 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4264 1
    { "(bad)",	{ XX } },
d4269 2
a4270 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4271 1
    { "(bad)",	{ XX } },
d4276 2
a4277 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4278 1
    { "(bad)",	{ XX } },
d4283 2
a4284 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4285 1
    { "(bad)",	{ XX } },
d4290 2
a4291 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4292 1
    { "(bad)",	{ XX } },
d4297 2
a4298 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4299 1
    { "(bad)",	{ XX } },
d4304 2
a4305 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4306 1
    { "(bad)",	{ XX } },
d4311 2
a4312 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4313 1
    { "(bad)",	{ XX } },
d4318 2
a4319 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4320 1
    { "(bad)",	{ XX } },
d4325 2
a4326 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4327 1
    { "(bad)",	{ XX } },
d4332 2
a4333 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4334 1
    { "(bad)",	{ XX } },
d4339 2
a4340 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4341 1
    { "(bad)",	{ XX } },
d4346 2
a4347 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4348 1
    { "(bad)",	{ XX } },
d4353 2
a4354 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4355 1
    { "(bad)",	{ XX } },
d4360 2
a4361 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4362 1
    { "(bad)",	{ XX } },
d4367 2
a4368 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4369 1
    { "(bad)",	{ XX } },
d4374 2
a4375 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4376 1
    { "(bad)",	{ XX } },
d4381 2
a4382 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4383 1
    { "(bad)",	{ XX } },
d4388 2
a4389 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4390 1
    { "(bad)",	{ XX } },
d4395 2
a4396 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4397 1
    { "(bad)",	{ XX } },
d4402 2
a4403 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4404 1
    { "(bad)",	{ XX } },
d4409 2
a4410 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4411 1
    { "(bad)",	{ XX } },
d4416 2
a4417 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4418 1
    { "(bad)",	{ XX } },
d4423 2
a4424 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4425 1
    { "(bad)",	{ XX } },
d4430 2
a4431 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4432 1
    { "(bad)",	{ XX } },
d4437 2
a4438 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d4440 1
a4440 1
    { "(bad)",	{ XX } },
d4445 2
a4446 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4447 1
    { "(bad)",	{ XX } },
d4452 2
a4453 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4454 1
    { "(bad)",	{ XX } },
d4459 2
a4460 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4461 1
    { "(bad)",	{ XX } },
d4466 2
a4467 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4468 1
    { "(bad)",	{ XX } },
d4473 2
a4474 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4475 1
    { "(bad)",	{ XX } },
d4480 2
a4481 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4482 1
    { "(bad)",	{ XX } },
d4487 2
a4488 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4489 1
    { "(bad)",	{ XX } },
d4494 2
a4495 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4496 1
    { "(bad)",	{ XX } },
d4501 2
a4502 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4503 1
    { "(bad)",	{ XX } },
d4508 2
a4509 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4510 1
    { "(bad)",	{ XX } },
d4515 2
a4516 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4517 1
    { "(bad)",	{ XX } },
d4522 2
a4523 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4524 1
    { "(bad)",	{ XX } },
d4529 2
a4530 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4531 1
    { "(bad)",	{ XX } },
d4536 2
a4537 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4538 1
    { "(bad)",	{ XX } },
d4543 2
a4544 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4545 1
    { "(bad)",	{ XX } },
d4550 2
a4551 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4552 1
    { "(bad)",	{ XX } },
d4557 2
a4558 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4559 1
    { "(bad)",	{ XX } },
d4564 2
a4565 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4566 1
    { "(bad)",	{ XX } },
d4571 2
a4572 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4573 1
    { "(bad)",	{ XX } },
d4578 2
a4579 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4580 1
    { "(bad)",	{ XX } },
d4585 2
a4586 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4587 1
    { "(bad)",	{ XX } },
d4592 2
a4593 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4594 1
    { "(bad)",	{ XX } },
d4599 2
a4600 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4601 1
    { "(bad)",	{ XX } },
d4606 2
a4607 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4608 1
    { "(bad)",	{ XX } },
d4613 2
a4614 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4615 1
    { "(bad)",	{ XX } },
d4620 2
a4621 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4622 1
    { "(bad)",	{ XX } },
d4627 2
a4628 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4629 1
    { "(bad)",	{ XX } },
d4634 2
a4635 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4636 1
    { "(bad)",	{ XX } },
d4641 2
a4642 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4643 1
    { "(bad)",	{ XX } },
d4648 2
a4649 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4650 1
    { "(bad)",	{ XX } },
d4655 2
a4656 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4657 1
    { "(bad)",	{ XX } },
d4662 2
a4663 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4664 1
    { "(bad)",	{ XX } },
d4669 2
a4670 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4671 1
    { "(bad)",	{ XX } },
d4676 2
a4677 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4678 1
    { "(bad)",	{ XX } },
d4683 2
a4684 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4685 1
    { "(bad)",	{ XX } },
d4690 2
a4691 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4692 1
    { "(bad)",	{ XX } },
d4697 2
a4698 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4699 1
    { "(bad)",	{ XX } },
d4704 2
a4705 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4706 1
    { "(bad)",	{ XX } },
d4711 2
a4712 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4713 1
    { "(bad)",	{ XX } },
d4718 2
a4719 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4720 1
    { "(bad)",	{ XX } },
d4725 2
a4726 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d4728 1
a4728 1
    { "(bad)",	{ XX } },
d4733 2
a4734 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4735 1
    { "(bad)",	{ XX } },
d4740 2
a4741 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4742 1
    { "(bad)",	{ XX } },
d4747 2
a4748 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4749 1
    { "(bad)",	{ XX } },
d4754 2
a4755 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4756 1
    { "(bad)",	{ XX } },
d4761 2
a4762 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4763 1
    { "(bad)",	{ XX } },
d4768 2
a4769 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4770 1
    { "(bad)",	{ XX } },
d4775 2
a4776 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4777 1
    { "(bad)",	{ XX } },
d4782 2
a4783 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4784 1
    { "(bad)",	{ XX } },
d4789 2
a4790 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4791 1
    { "(bad)",	{ XX } },
d4796 2
a4797 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4798 1
    { "(bad)",	{ XX } },
d4803 2
a4804 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4805 1
    { "(bad)",	{ XX } },
d4810 2
a4811 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4812 1
    { "(bad)",	{ XX } },
d4817 2
a4818 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4819 1
    { "(bad)",	{ XX } },
d4824 2
a4825 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4826 1
    { "(bad)",	{ XX } },
d4831 2
a4832 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4833 1
    { "(bad)",	{ XX } },
d4838 2
a4839 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4840 1
    { "(bad)",	{ XX } },
d4845 2
a4846 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4847 1
    { "(bad)",	{ XX } },
d4852 2
a4853 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4854 1
    { "(bad)",	{ XX } },
d4859 2
a4860 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4861 1
    { "(bad)",	{ XX } },
d4866 2
a4867 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4868 1
    { "(bad)",	{ XX } },
d4873 2
a4874 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4875 1
    { "(bad)",	{ XX } },
d4880 2
a4881 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4882 1
    { "(bad)",	{ XX } },
d4887 2
a4888 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4889 1
    { "(bad)",	{ XX } },
d4894 2
a4895 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4896 1
    { "(bad)",	{ XX } },
d4901 2
a4902 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4903 1
    { "(bad)",	{ XX } },
d4908 2
a4909 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4910 1
    { "(bad)",	{ XX } },
d4915 2
a4916 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4917 1
    { "(bad)",	{ XX } },
d4922 2
a4923 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4924 1
    { "(bad)",	{ XX } },
d4929 2
a4930 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4931 1
    { "(bad)",	{ XX } },
d4936 2
a4937 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4938 1
    { "(bad)",	{ XX } },
d4943 2
a4944 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4945 1
    { "(bad)",	{ XX } },
d4950 2
a4951 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4952 1
    { "(bad)",	{ XX } },
d4957 2
a4958 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4959 1
    { "(bad)",	{ XX } },
d4964 2
a4965 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4966 1
    { "(bad)",	{ XX } },
d4971 2
a4972 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4973 1
    { "(bad)",	{ XX } },
d4978 2
a4979 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4980 1
    { "(bad)",	{ XX } },
d4985 2
a4986 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4987 1
    { "(bad)",	{ XX } },
d4992 2
a4993 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a4994 1
    { "(bad)",	{ XX } },
d4999 2
a5000 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5001 1
    { "(bad)",	{ XX } },
d5006 2
a5007 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5008 1
    { "(bad)",	{ XX } },
d5013 2
a5014 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5015 1
    { "(bad)",	{ XX } },
d5020 2
a5021 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5022 1
    { "(bad)",	{ XX } },
d5027 2
a5028 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5029 1
    { "(bad)",	{ XX } },
d5034 2
a5035 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5036 1
    { "(bad)",	{ XX } },
d5041 2
a5042 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5043 1
    { "(bad)",	{ XX } },
d5048 2
a5049 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5050 1
    { "(bad)",	{ XX } },
d5055 2
a5056 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5057 1
    { "(bad)",	{ XX } },
d5062 2
a5063 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5064 1
    { "(bad)",	{ XX } },
d5069 2
a5070 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5071 1
    { "(bad)",	{ XX } },
d5076 2
a5077 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5078 1
    { "(bad)",	{ XX } },
d5083 2
a5084 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5085 1
    { "(bad)",	{ XX } },
d5090 2
a5091 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5092 1
    { "(bad)",	{ XX } },
d5097 2
a5098 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5099 1
    { "(bad)",	{ XX } },
d5104 2
a5105 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5106 1
    { "(bad)",	{ XX } },
d5111 2
a5112 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5113 1
    { "(bad)",	{ XX } },
d5118 2
a5119 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d5121 1
a5121 1
    { "(bad)",	{ XX } },
d5126 2
a5127 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5128 1
    { "(bad)",	{ XX } },
d5133 2
a5134 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5135 1
    { "(bad)",	{ XX } },
d5140 2
a5141 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5142 1
    { "(bad)",	{ XX } },
d5147 2
a5148 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5149 1
    { "(bad)",	{ XX } },
d5154 2
a5155 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5156 1
    { "(bad)",	{ XX } },
d5161 2
a5162 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5163 1
    { "(bad)",	{ XX } },
d5168 2
a5169 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5170 1
    { "(bad)",	{ XX } },
d5175 2
a5176 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5177 1
    { "(bad)",	{ XX } },
d5182 2
a5183 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5184 1
    { "(bad)",	{ XX } },
d5189 2
a5190 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5191 1
    { "(bad)",	{ XX } },
d5196 2
a5197 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5198 1
    { "(bad)",	{ XX } },
d5203 2
a5204 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5205 1
    { "(bad)",	{ XX } },
d5210 2
a5211 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5212 1
    { "(bad)",	{ XX } },
d5217 2
a5218 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5219 1
    { "(bad)",	{ XX } },
d5224 2
a5225 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5226 1
    { "(bad)",	{ XX } },
d5231 2
a5232 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d5234 1
a5234 1
    { "(bad)",	{ XX } },
d5239 2
a5240 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5241 1
    { "(bad)",	{ XX } },
d5246 2
a5247 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5248 1
    { "(bad)",	{ XX } },
d5253 2
a5254 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
a5255 1
    { "(bad)",	{ XX } },
d5260 2
a5261 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d5263 1
a5263 1
    { "(bad)",	{ XX } },
a5270 1
    { "(bad)", { XX } },
a5275 1
    { "(bad)", { XX } },
a5280 1
    { "(bad)", { XX } },
a5285 1
    { "(bad)", { XX } },
a5290 1
    { "(bad)", { XX } },
a5295 1
    { "(bad)", { XX } },
a5300 1
    { "(bad)", { XX } },
a5305 1
    { "(bad)", { XX } },
a5310 1
    { "(bad)", { XX } },
a5315 1
    { "(bad)", { XX } },
a5320 1
    { "(bad)", { XX } },
a5325 1
    { "(bad)", { XX } },
a5330 1
    { "(bad)", { XX } },
a5335 1
    { "(bad)", { XX } },
a5358 1
    { "(bad)", { XX } },
a5375 1
    { "(bad)", { XX } },
a5380 1
    { "(bad)", { XX } },
a5385 1
    { "(bad)", { XX } },
a5390 1
    { "(bad)", { XX } },
d5436 4
a5439 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5442 3
a5444 3
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5447 1
a5447 1
    { "(bad)",		{ XX } },
d5450 4
a5453 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5457 1
a5457 1
    { "(bad)",		{ XX } },
d5465 2
a5466 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5472 4
a5475 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5483 1
a5483 1
    { "(bad)",		{ XX } },
d5497 6
a5502 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5504 8
a5511 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5513 8
a5520 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5522 8
a5529 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5531 8
a5538 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5540 8
a5547 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5549 8
a5556 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5558 8
a5565 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5569 6
a5574 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5576 8
a5583 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5585 8
a5592 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5594 8
a5601 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5603 8
a5610 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5612 8
a5619 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5621 8
a5628 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5630 8
a5637 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5639 8
a5646 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5648 8
a5655 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5657 8
a5664 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5666 3
a5668 3
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5675 8
a5682 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5684 8
a5691 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5695 6
a5700 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5702 8
a5709 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5714 8
a5721 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5732 4
a5735 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5741 8
a5748 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5753 5
a5757 5
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5759 8
a5766 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5768 8
a5775 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5777 8
a5784 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5789 1
a5789 1
    { "(bad)",		{ XX } },
d5791 3
a5793 3
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5795 8
a5802 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5804 8
a5811 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5813 8
a5820 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5826 4
a5829 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5831 8
a5838 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5840 8
a5847 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5849 8
a5856 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5858 8
a5865 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5867 8
a5874 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5876 8
a5883 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5885 8
a5892 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5894 8
a5901 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5903 8
a5910 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5912 8
a5919 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5921 8
a5928 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5930 8
a5937 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5939 8
a5946 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5948 8
a5955 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5957 7
a5963 7
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5966 8
a5973 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5975 8
a5982 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5984 8
a5991 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5993 8
a6000 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6006 8
a6013 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6015 8
a6022 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6024 8
a6031 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6033 8
a6040 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6043 7
a6049 7
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6051 8
a6058 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6060 8
a6067 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6069 8
a6076 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6078 1
a6078 1
    { "(bad)",		{ XX } },
d6082 2
a6083 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6087 3
a6089 3
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6091 4
a6094 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6096 1
a6096 1
    { "(bad)",		{ XX } },
d6100 2
a6101 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6105 3
a6107 3
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6109 4
a6112 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6114 1
a6114 1
    { "(bad)",		{ XX } },
d6118 4
a6121 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6123 8
a6130 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6132 8
a6139 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6141 8
a6148 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6150 8
a6157 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6159 8
a6166 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6168 8
a6175 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6177 8
a6184 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6186 8
a6193 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6195 8
a6202 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6204 8
a6211 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6213 8
a6220 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6222 8
a6229 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6231 8
a6238 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6240 8
a6247 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6249 8
a6256 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6258 8
a6265 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6267 8
a6274 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6276 8
a6283 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6285 8
a6292 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6300 8
a6307 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6309 8
a6316 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6318 8
a6325 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6327 8
a6334 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6336 8
a6343 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6345 8
a6352 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6354 8
a6361 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6363 8
a6370 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6372 8
a6379 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6381 8
a6388 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6390 8
a6397 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6399 8
a6406 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6408 8
a6415 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6417 8
a6424 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6426 8
a6433 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6435 8
a6442 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6444 5
a6448 5
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6453 6
a6458 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6462 5
a6466 5
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6471 6
a6476 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6480 2
a6481 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6484 2
a6485 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6487 1
a6487 1
    { "(bad)",		{ XX } },
d6489 8
a6496 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6498 6
a6503 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6505 1
a6505 1
    { "(bad)",		{ XX } },
d6507 8
a6514 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6520 4
a6523 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6525 4
a6528 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6534 8
a6541 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6543 8
a6550 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6552 8
a6559 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6561 4
a6564 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6570 8
a6577 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6579 8
a6586 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6591 8
a6598 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6600 8
a6607 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6609 2
a6610 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6612 5
a6616 5
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6618 8
a6625 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6627 8
a6634 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6636 8
a6643 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6645 8
a6652 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6654 8
a6661 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6663 8
a6670 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6672 8
a6679 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6681 8
a6688 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6690 8
a6697 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6699 8
a6706 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6708 8
a6715 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6717 8
a6724 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6726 8
a6733 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6739 4
a6742 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6744 8
a6751 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6766 4
a6769 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6771 8
a6778 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6780 8
a6787 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6789 8
a6796 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6798 8
a6805 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6807 1
a6807 1
    { "(bad)",		{ XX } },
d6811 2
a6812 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6816 3
a6818 3
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6820 4
a6823 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6825 1
a6825 1
    { "(bad)",		{ XX } },
d6829 2
a6830 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6834 3
a6836 3
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6838 4
a6841 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6843 1
a6843 1
    { "(bad)",		{ XX } },
d6847 4
a6850 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6852 8
a6859 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6861 8
a6868 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6870 8
a6877 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6882 8
a6889 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6891 8
a6898 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6900 2
a6901 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6903 5
a6907 5
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6909 8
a6916 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6918 8
a6925 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6927 8
a6934 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6936 8
a6943 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6945 8
a6952 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6954 8
a6961 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6963 8
a6970 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6972 8
a6979 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6981 8
a6988 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6990 8
a6997 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6999 8
a7006 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7008 8
a7015 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7017 8
a7024 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7026 8
a7033 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7035 8
a7042 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7044 8
a7051 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7053 8
a7060 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7062 8
a7069 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7071 8
a7078 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7080 8
a7087 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7089 8
a7096 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7098 8
a7105 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7107 8
a7114 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7116 8
a7123 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7125 8
a7132 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7134 8
a7141 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7143 8
a7150 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7152 8
a7159 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7161 8
a7168 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7176 8
a7183 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7185 8
a7192 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7203 8
a7210 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7212 8
a7219 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7230 8
a7237 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7239 8
a7246 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7248 8
a7255 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7257 8
a7264 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7311 4
a7314 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7320 8
a7327 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7329 8
a7336 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7338 8
a7345 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7347 8
a7354 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7356 8
a7363 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7365 6
a7370 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7372 1
a7372 1
    { "(bad)",		{ XX } },
d7374 8
a7381 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7383 8
a7390 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7392 2
a7393 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7395 1
a7395 1
    { "(bad)",		{ XX } },
d7399 1
a7399 1
    { "(bad)",		{ XX } },
d7401 8
a7408 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7462 1
a7462 1
    { "(bad)",		{ XX } },
d7485 7
a7491 7
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7497 1
a7497 1
    { "(bad)",		{ XX } },
d7501 1
a7501 1
    { "(bad)",		{ XX } },
d7509 2
a7510 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7527 1
a7527 1
    { "(bad)",		{ XX } },
d7541 6
a7546 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7548 8
a7555 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7557 8
a7564 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7566 8
a7573 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7575 8
a7582 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7584 8
a7591 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7593 8
a7600 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7602 8
a7609 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7611 8
a7618 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7620 8
a7627 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7629 6
a7634 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7647 6
a7652 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7665 6
a7670 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7683 8
a7690 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7692 8
a7699 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7701 8
a7708 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7710 3
a7712 3
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7719 8
a7726 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7728 8
a7735 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7737 8
a7744 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7746 8
a7753 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7758 4
a7761 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7765 1
a7765 1
    { "(bad)",		{ XX } },
d7776 4
a7779 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7787 6
a7792 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7797 5
a7801 5
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7803 8
a7810 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7812 8
a7819 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7821 8
a7828 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7833 1
a7833 1
    { "(bad)",		{ XX } },
d7835 3
a7837 3
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7839 2
a7840 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7844 3
a7846 3
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7848 8
a7855 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7857 4
a7860 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7870 4
a7873 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7884 8
a7891 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7902 8
a7909 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7911 8
a7918 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7920 8
a7927 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7929 8
a7936 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7938 8
a7945 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7947 8
a7954 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7956 8
a7963 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7965 8
a7972 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7974 8
a7981 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7983 8
a7990 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7992 8
a7999 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d8001 7
a8007 7
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d8010 8
a8017 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d8019 8
a8026 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d8028 8
a8035 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d8037 8
a8044 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
a8051 1
    { "(bad)",		{ XX } },
a8056 1
    { "(bad)",		{ XX } },
a8061 1
    { "(bad)",		{ XX } },
a8066 1
    { "(bad)",		{ XX } },
a8071 1
    { "(bad)",		{ XX } },
a8076 1
    { "(bad)",		{ XX } },
a8081 1
    { "(bad)",		{ XX } },
a8086 1
    { "(bad)",		{ XX } },
a8091 1
    { "(bad)",		{ XX } },
a8096 1
    { "(bad)",		{ XX } },
a8101 1
    { "(bad)",		{ XX } },
a8106 1
    { "(bad)",		{ XX } },
a8111 1
    { "(bad)",		{ XX } },
a8116 1
    { "(bad)",		{ XX } },
a8121 1
    { "(bad)",		{ XX } },
a8126 1
    { "(bad)",		{ XX } },
a8131 1
    { "(bad)",		{ XX } },
a8136 1
    { "(bad)",		{ XX } },
a8141 1
    { "(bad)",		{ XX } },
a8146 1
    { "(bad)",		{ XX } },
a8151 1
    { "(bad)",		{ XX } },
a8156 1
    { "(bad)",		{ XX } },
a8161 1
    { "(bad)",		{ XX } },
a8166 1
    { "(bad)",		{ XX } },
a8171 1
    { "(bad)",		{ XX } },
a8176 1
    { "(bad)",		{ XX } },
a8181 1
    { "(bad)",		{ XX } },
a8186 1
    { "(bad)",		{ XX } },
a8191 1
    { "(bad)",		{ XX } },
a8196 1
    { "(bad)",		{ XX } },
a8201 1
    { "(bad)",		{ XX } },
a8206 1
    { "(bad)",		{ XX } },
a8211 1
    { "(bad)",		{ XX } },
a8216 1
    { "(bad)",		{ XX } },
a8221 1
    { "(bad)",		{ XX } },
a8226 1
    { "(bad)",		{ XX } },
a8231 1
    { "(bad)",		{ XX } },
a8236 1
    { "(bad)",		{ XX } },
a8241 1
    { "(bad)",		{ XX } },
a8246 1
    { "(bad)",		{ XX } },
a8251 1
    { "(bad)",		{ XX } },
a8256 1
    { "(bad)",		{ XX } },
a8261 1
    { "(bad)",		{ XX } },
a8266 1
    { "(bad)",		{ XX } },
a8271 1
    { "(bad)",		{ XX } },
a8276 1
    { "(bad)",		{ XX } },
a8281 1
    { "(bad)",		{ XX } },
a8286 1
    { "(bad)",		{ XX } },
a8291 1
    { "(bad)",		{ XX } },
a8296 1
    { "(bad)",		{ XX } },
a8301 1
    { "(bad)",		{ XX } },
a8306 1
    { "(bad)",		{ XX } },
a8311 1
    { "(bad)",		{ XX } },
a8316 1
    { "(bad)",		{ XX } },
a8321 1
    { "(bad)",		{ XX } },
a8326 1
    { "(bad)",		{ XX } },
a8331 1
    { "(bad)",		{ XX } },
a8336 1
    { "(bad)",		{ XX } },
a8341 1
    { "(bad)",		{ XX } },
a8346 1
    { "(bad)",		{ XX } },
a8351 1
    { "(bad)",		{ XX } },
a8356 1
    { "(bad)",		{ XX } },
a8361 1
    { "(bad)",		{ XX } },
a8366 1
    { "(bad)",		{ XX } },
a8371 1
    { "(bad)",		{ XX } },
a8376 1
    { "(bad)",		{ XX } },
a8381 1
    { "(bad)",		{ XX } },
a8386 1
    { "(bad)",		{ XX } },
a8391 1
    { "(bad)",		{ XX } },
a8396 1
    { "(bad)",		{ XX } },
a8401 1
    { "(bad)",		{ XX } },
a8406 1
    { "(bad)",		{ XX } },
a8411 1
    { "(bad)",		{ XX } },
a8416 1
    { "(bad)",		{ XX } },
a8421 1
    { "(bad)",		{ XX } },
a8426 1
    { "(bad)",		{ XX } },
a8431 1
    { "(bad)",		{ XX } },
a8436 1
    { "(bad)",		{ XX } },
a8441 1
    { "(bad)",		{ XX } },
a8446 1
    { "(bad)",		{ XX } },
a8451 1
    { "(bad)",		{ XX } },
a8456 1
    { "(bad)",		{ XX } },
a8461 1
    { "(bad)",		{ XX } },
a8466 1
    { "(bad)",		{ XX } },
a8471 1
    { "(bad)",		{ XX } },
a8476 1
    { "(bad)",		{ XX } },
a8481 1
    { "(bad)",		{ XX } },
a8486 1
    { "(bad)",		{ XX } },
a8491 1
    { "(bad)",		{ XX } },
a8496 1
    { "(bad)",		{ XX } },
a8501 1
    { "(bad)",		{ XX } },
a8506 1
    { "(bad)",		{ XX } },
a8511 1
    { "(bad)",		{ XX } },
a8516 1
    { "(bad)",		{ XX } },
a8521 1
    { "(bad)",		{ XX } },
a8526 1
    { "(bad)",		{ XX } },
a8531 1
    { "(bad)",		{ XX } },
a8536 1
    { "(bad)",		{ XX } },
a8541 1
    { "(bad)",		{ XX } },
a8546 1
    { "(bad)",		{ XX } },
a8551 1
    { "(bad)",		{ XX } },
a8556 1
    { "(bad)",		{ XX } },
a8561 1
    { "(bad)",		{ XX } },
a8566 1
    { "(bad)",		{ XX } },
a8571 1
    { "(bad)",		{ XX } },
a8576 1
    { "(bad)",		{ XX } },
a8581 1
    { "(bad)",		{ XX } },
a8586 1
    { "(bad)",		{ XX } },
a8591 1
    { "(bad)",		{ XX } },
d8597 1
a8597 1
    { "(bad)",		{ XX } },
a8602 1
    { "(bad)",		{ XX } },
a8607 1
    { "(bad)",		{ XX } },
a8612 1
    { "(bad)",		{ XX } },
a8617 1
    { "(bad)",		{ XX } },
a8622 1
    { "(bad)",		{ XX } },
a8627 1
    { "(bad)",		{ XX } },
a8632 1
    { "(bad)",		{ XX } },
a8637 1
    { "(bad)",		{ XX } },
a8642 1
    { "(bad)",		{ XX } },
a8647 1
    { "(bad)",		{ XX } },
a8652 1
    { "(bad)",		{ XX } },
a8657 1
    { "(bad)",		{ XX } },
a8662 1
    { "(bad)",		{ XX } },
a8667 1
    { "(bad)",		{ XX } },
a8672 1
    { "(bad)",		{ XX } },
a8677 1
    { "(bad)",		{ XX } },
a8682 1
    { "(bad)",		{ XX } },
a8687 1
    { "(bad)",		{ XX } },
a8692 1
    { "(bad)",		{ XX } },
a8697 1
    { "(bad)",		{ XX } },
a8702 1
    { "(bad)",		{ XX } },
a8707 1
    { "(bad)",		{ XX } },
a8712 1
    { "(bad)",		{ XX } },
a8717 1
    { "(bad)",		{ XX } },
d8722 1
a8722 1
    { "(bad)",		{ XX } },
d8728 1
a8728 1
    { "(bad)",		{ XX } },
a8734 1
    { "(bad)",		{ XX } },
a8739 1
    { "(bad)",		{ XX } },
a8744 1
    { "(bad)",		{ XX } },
a8749 1
    { "(bad)",		{ XX } },
a8754 1
    { "(bad)",		{ XX } },
a8759 1
    { "(bad)",		{ XX } },
a8764 1
    { "(bad)",		{ XX } },
a8769 1
    { "(bad)",		{ XX } },
a8774 1
    { "(bad)",		{ XX } },
a8779 1
    { "(bad)",		{ XX } },
a8784 1
    { "(bad)",		{ XX } },
a8789 1
    { "(bad)",		{ XX } },
a8794 1
    { "(bad)",		{ XX } },
a8799 1
    { "(bad)",		{ XX } },
a8804 1
    { "(bad)",		{ XX } },
a8809 1
    { "(bad)",		{ XX } },
a8814 1
    { "(bad)",		{ XX } },
a8819 1
    { "(bad)",		{ XX } },
a8824 1
    { "(bad)",		{ XX } },
a8829 1
    { "(bad)",		{ XX } },
a8834 1
    { "(bad)",		{ XX } },
a8839 1
    { "(bad)",		{ XX } },
a8844 1
    { "(bad)",		{ XX } },
a8849 1
    { "(bad)",		{ XX } },
a8854 1
    { "(bad)",		{ XX } },
a8859 1
    { "(bad)",		{ XX } },
a8864 1
    { "(bad)",		{ XX } },
a8869 1
    { "(bad)",		{ XX } },
a8874 1
    { "(bad)",		{ XX } },
a8879 1
    { "(bad)",		{ XX } },
a8884 1
    { "(bad)",		{ XX } },
a8889 1
    { "(bad)",		{ XX } },
a8894 1
    { "(bad)",		{ XX } },
a8899 1
    { "(bad)",		{ XX } },
a8904 1
    { "(bad)",		{ XX } },
d8909 1
a8909 1
    { "(bad)",		{ XX } },
a8915 1
    { "(bad)",		{ XX } },
a8920 1
    { "(bad)",		{ XX } },
a8925 1
    { "(bad)",		{ XX } },
a8930 1
    { "(bad)",		{ XX } },
a8935 1
    { "(bad)",		{ XX } },
a8940 1
    { "(bad)",		{ XX } },
a8945 1
    { "(bad)",		{ XX } },
a8950 1
    { "(bad)",		{ XX } },
d8955 1
a8955 1
    { "(bad)",		{ XX } },
d8961 1
a8961 1
    { "(bad)",		{ XX } },
a8967 1
    { "(bad)",		{ XX } },
a8972 1
    { "(bad)",		{ XX } },
a8977 1
    { "(bad)",		{ XX } },
a8982 1
    { "(bad)",		{ XX } },
a8987 1
    { "(bad)",		{ XX } },
a8992 1
    { "(bad)",		{ XX } },
a8997 1
    { "(bad)",		{ XX } },
a9002 1
    { "(bad)",		{ XX } },
a9007 1
    { "(bad)",		{ XX } },
a9012 1
    { "(bad)",		{ XX } },
a9017 1
    { "(bad)",		{ XX } },
a9022 1
    { "(bad)",		{ XX } },
a9027 1
    { "(bad)",		{ XX } },
a9032 1
    { "(bad)",		{ XX } },
a9037 1
    { "(bad)",		{ XX } },
a9042 1
    { "(bad)",		{ XX } },
a9047 1
    { "(bad)",		{ XX } },
a9052 1
    { "(bad)",		{ XX } },
a9057 1
    { "(bad)",		{ XX } },
a9062 1
    { "(bad)",		{ XX } },
a9081 1
    { "(bad)",		{ XX } },
a9085 1
    { "(bad)",		{ XX } },
a9089 1
    { "(bad)",		{ XX } },
a9093 1
    { "(bad)",		{ XX } },
a9097 1
    { "(bad)",		{ XX } },
a9101 1
    { "(bad)",		{ XX } },
a9105 1
    { "(bad)",		{ XX } },
a9109 1
    { "(bad)",		{ XX } },
a9113 1
    { "(bad)",		{ XX } },
a9117 1
    { "(bad)",		{ XX } },
a9121 1
    { "(bad)",		{ XX } },
a9125 1
    { "(bad)",		{ XX } },
a9129 1
    { "(bad)",		{ XX } },
a9133 1
    { "(bad)",		{ XX } },
a9137 1
    { "(bad)",		{ XX } },
a9141 1
    { "(bad)",		{ XX } },
a9145 1
    { "(bad)",		{ XX } },
a9149 1
    { "(bad)",		{ XX } },
a9153 1
    { "(bad)",		{ XX } },
a9157 1
    { "(bad)",		{ XX } },
a9161 1
    { "(bad)",		{ XX } },
a9165 1
    { "(bad)",		{ XX } },
a9169 1
    { "(bad)",		{ XX } },
a9173 1
    { "(bad)",		{ XX } },
a9177 1
    { "(bad)",		{ XX } },
a9181 1
    { "(bad)",		{ XX } },
a9185 1
    { "(bad)",		{ XX } },
a9189 1
    { "(bad)",		{ XX } },
a9193 1
    { "(bad)",		{ XX } },
a9197 1
    { "(bad)",		{ XX } },
a9201 1
    { "(bad)",		{ XX } },
a9205 1
    { "(bad)",		{ XX } },
a9209 1
    { "(bad)",		{ XX } },
a9213 1
    { "(bad)",		{ XX } },
a9217 1
    { "(bad)",		{ XX } },
a9221 1
    { "(bad)",		{ XX } },
a9225 1
    { "(bad)",		{ XX } },
a9229 1
    { "(bad)",		{ XX } },
a9233 1
    { "(bad)",		{ XX } },
a9237 1
    { "(bad)",		{ XX } },
a9241 1
    { "(bad)",		{ XX } },
a9245 1
    { "(bad)",		{ XX } },
a9249 1
    { "(bad)",		{ XX } },
a9253 1
    { "(bad)",		{ XX } },
a9257 1
    { "(bad)",		{ XX } },
a9261 1
    { "(bad)",		{ XX } },
a9265 1
    { "(bad)",		{ XX } },
a9269 1
    { "(bad)",		{ XX } },
a9273 1
    { "(bad)",		{ XX } },
a9277 1
    { "(bad)",		{ XX } },
a9281 1
    { "(bad)",		{ XX } },
a9285 1
    { "(bad)",		{ XX } },
a9289 1
    { "(bad)",		{ XX } },
a9293 1
    { "(bad)",		{ XX } },
a9297 1
    { "(bad)",		{ XX } },
a9301 1
    { "(bad)",		{ XX } },
a9305 1
    { "(bad)",		{ XX } },
a9309 1
    { "(bad)",		{ XX } },
a9313 1
    { "(bad)",		{ XX } },
a9317 1
    { "(bad)",		{ XX } },
a9321 1
    { "(bad)",		{ XX } },
a9325 1
    { "(bad)",		{ XX } },
a9329 1
    { "(bad)",		{ XX } },
a9333 1
    { "(bad)",		{ XX } },
a9337 1
    { "(bad)",		{ XX } },
a9341 1
    { "(bad)",		{ XX } },
a9345 1
    { "(bad)",		{ XX } },
a9349 1
    { "(bad)",		{ XX } },
a9353 1
    { "(bad)",		{ XX } },
a9357 1
    { "(bad)",		{ XX } },
a9361 1
    { "(bad)",		{ XX } },
a9365 1
    { "(bad)",		{ XX } },
a9369 1
    { "(bad)",		{ XX } },
a9373 1
    { "(bad)",		{ XX } },
a9377 1
    { "(bad)",		{ XX } },
a9381 1
    { "(bad)",		{ XX } },
a9385 1
    { "(bad)",		{ XX } },
a9389 1
    { "(bad)",		{ XX } },
a9393 1
    { "(bad)",		{ XX } },
a9397 1
    { "(bad)",		{ XX } },
a9401 1
    { "(bad)",		{ XX } },
a9405 1
    { "(bad)",		{ XX } },
a9409 1
    { "(bad)",		{ XX } },
a9413 1
    { "(bad)",		{ XX } },
a9417 1
    { "(bad)",		{ XX } },
a9421 1
    { "(bad)",		{ XX } },
a9425 1
    { "(bad)",		{ XX } },
a9429 1
    { "(bad)",		{ XX } },
a9433 1
    { "(bad)",		{ XX } },
a9437 1
    { "(bad)",		{ XX } },
a9441 1
    { "(bad)",		{ XX } },
a9445 1
    { "(bad)",		{ XX } },
a9449 1
    { "(bad)",		{ XX } },
a9453 1
    { "(bad)",		{ XX } },
a9457 1
    { "(bad)",		{ XX } },
a9461 1
    { "(bad)",		{ XX } },
a9465 1
    { "(bad)",		{ XX } },
a9469 1
    { "(bad)",		{ XX } },
a9473 1
    { "(bad)",		{ XX } },
a9477 1
    { "(bad)",		{ XX } },
a9481 1
    { "(bad)",		{ XX } },
a9485 1
    { "(bad)",		{ XX } },
a9489 1
    { "(bad)",		{ XX } },
a9493 1
    { "(bad)",		{ XX } },
a9497 1
    { "(bad)",		{ XX } },
a9501 1
    { "(bad)",		{ XX } },
a9505 1
    { "(bad)",		{ XX } },
a9509 1
    { "(bad)",		{ XX } },
a9513 1
    { "(bad)",		{ XX } },
a9517 1
    { "(bad)",		{ XX } },
a9521 1
    { "(bad)",		{ XX } },
a9525 1
    { "(bad)",		{ XX } },
a9529 1
    { "(bad)",		{ XX } },
a9533 1
    { "(bad)",		{ XX } },
a9537 1
    { "(bad)",		{ XX } },
a9541 1
    { "(bad)",		{ XX } },
a9545 1
    { "(bad)",		{ XX } },
a9549 1
    { "(bad)",		{ XX } },
a9553 1
    { "(bad)",		{ XX } },
a9557 1
    { "(bad)",		{ XX } },
a9561 1
    { "(bad)",		{ XX } },
a9565 1
    { "(bad)",		{ XX } },
a9569 1
    { "(bad)",		{ XX } },
a9573 1
    { "(bad)",		{ XX } },
a9577 1
    { "(bad)",		{ XX } },
a9581 1
    { "(bad)",		{ XX } },
a9585 1
    { "(bad)",		{ XX } },
a9589 1
    { "(bad)",		{ XX } },
a9593 1
    { "(bad)",		{ XX } },
a9597 1
    { "(bad)",		{ XX } },
a9601 1
    { "(bad)",		{ XX } },
a9605 1
    { "(bad)",		{ XX } },
a9609 1
    { "(bad)",		{ XX } },
a9613 1
    { "(bad)",		{ XX } },
a9617 1
    { "(bad)",		{ XX } },
a9621 1
    { "(bad)",		{ XX } },
a9625 1
    { "(bad)",		{ XX } },
a9629 1
    { "(bad)",		{ XX } },
a9633 1
    { "(bad)",		{ XX } },
a9637 1
    { "(bad)",		{ XX } },
a9641 1
    { "(bad)",		{ XX } },
a9645 1
    { "(bad)",		{ XX } },
a9649 1
    { "(bad)",		{ XX } },
a9653 1
    { "(bad)",		{ XX } },
a9657 1
    { "(bad)",		{ XX } },
a9661 1
    { "(bad)",		{ XX } },
a9665 1
    { "(bad)",		{ XX } },
a9669 1
    { "(bad)",		{ XX } },
a9673 1
    { "(bad)",		{ XX } },
a9677 1
    { "(bad)",		{ XX } },
a9681 1
    { "(bad)",		{ XX } },
a9685 1
    { "(bad)",		{ XX } },
a9689 1
    { "(bad)",		{ XX } },
a9693 1
    { "(bad)",		{ XX } },
a9697 1
    { "(bad)",		{ XX } },
a9701 1
    { "(bad)",		{ XX } },
a9705 1
    { "(bad)",		{ XX } },
a9709 1
    { "(bad)",		{ XX } },
a9713 1
    { "(bad)",		{ XX } },
a9717 1
    { "(bad)",		{ XX } },
a9721 1
    { "(bad)",		{ XX } },
a9725 1
    { "(bad)",		{ XX } },
a9729 1
    { "(bad)",		{ XX } },
a9733 1
    { "(bad)",		{ XX } },
a9737 1
    { "(bad)",		{ XX } },
a9741 1
    { "(bad)",		{ XX } },
a9745 1
    { "(bad)",		{ XX } },
a9749 1
    { "(bad)",		{ XX } },
a9753 1
    { "(bad)",		{ XX } },
a9757 1
    { "(bad)",		{ XX } },
a9761 1
    { "(bad)",		{ XX } },
a9765 1
    { "(bad)",		{ XX } },
a9769 1
    { "(bad)",		{ XX } },
a9773 1
    { "(bad)",		{ XX } },
a9777 1
    { "(bad)",		{ XX } },
a9781 1
    { "(bad)",		{ XX } },
a9785 1
    { "(bad)",		{ XX } },
a9789 1
    { "(bad)",		{ XX } },
a9793 1
    { "(bad)",		{ XX } },
a9797 1
    { "(bad)",		{ XX } },
a9801 1
    { "(bad)",		{ XX } },
a9805 1
    { "(bad)",		{ XX } },
a9809 1
    { "(bad)",		{ XX } },
a9813 1
    { "(bad)",		{ XX } },
a9817 1
    { "(bad)",		{ XX } },
a9821 1
    { "(bad)",		{ XX } },
a9825 1
    { "(bad)",		{ XX } },
a9829 1
    { "(bad)",		{ XX } },
a9833 1
    { "(bad)",		{ XX } },
a9837 1
    { "(bad)",		{ XX } },
a9841 1
    { "(bad)",		{ XX } },
a9845 1
    { "(bad)",		{ XX } },
a9849 1
    { "(bad)",		{ XX } },
a9853 1
    { "(bad)",		{ XX } },
a9857 1
    { "(bad)",		{ XX } },
a9861 1
    { "(bad)",		{ XX } },
a9865 1
    { "(bad)",		{ XX } },
a9869 1
    { "(bad)",		{ XX } },
a9873 1
    { "(bad)",		{ XX } },
a9877 1
    { "(bad)",		{ XX } },
a9881 1
    { "(bad)",		{ XX } },
a9885 1
    { "(bad)",		{ XX } },
a9889 1
    { "(bad)",		{ XX } },
a9893 1
    { "(bad)",		{ XX } },
a9897 1
    { "(bad)",		{ XX } },
a9901 1
    { "(bad)",		{ XX } },
a9905 1
    { "(bad)",		{ XX } },
a9909 1
    { "(bad)",		{ XX } },
a9913 1
    { "(bad)",		{ XX } },
a9917 1
    { "(bad)",		{ XX } },
a9921 1
    { "(bad)",		{ XX } },
a9925 1
    { "(bad)",		{ XX } },
a9929 1
    { "(bad)",		{ XX } },
a9933 1
    { "(bad)",		{ XX } },
a9937 1
    { "(bad)",		{ XX } },
a9941 1
    { "(bad)",		{ XX } },
a9945 1
    { "(bad)",		{ XX } },
a9949 1
    { "(bad)",		{ XX } },
a9953 1
    { "(bad)",		{ XX } },
a9957 1
    { "(bad)",		{ XX } },
a9961 1
    { "(bad)",		{ XX } },
a9965 1
    { "(bad)",		{ XX } },
a9969 1
    { "(bad)",		{ XX } },
a9973 1
    { "(bad)",		{ XX } },
a9977 1
    { "(bad)",		{ XX } },
a9981 1
    { "(bad)",		{ XX } },
a9985 1
    { "(bad)",		{ XX } },
a9989 1
    { "(bad)",		{ XX } },
a9993 1
    { "(bad)",		{ XX } },
a9997 1
    { "(bad)",		{ XX } },
a10001 1
    { "(bad)",		{ XX } },
a10005 1
    { "(bad)",		{ XX } },
a10009 1
    { "(bad)",		{ XX } },
a10013 1
    { "(bad)",		{ XX } },
a10017 1
    { "(bad)",		{ XX } },
a10021 1
    { "(bad)",		{ XX } },
a10025 1
    { "(bad)",		{ XX } },
a10029 1
    { "(bad)",		{ XX } },
a10033 1
    { "(bad)",		{ XX } },
a10037 1
    { "(bad)",		{ XX } },
a10041 1
    { "(bad)",		{ XX } },
a10045 1
    { "(bad)",		{ XX } },
a10049 1
    { "(bad)",		{ XX } },
a10053 1
    { "(bad)",		{ XX } },
a10057 1
    { "(bad)",		{ XX } },
a10061 1
    { "(bad)",		{ XX } },
a10065 1
    { "(bad)",		{ XX } },
a10069 1
    { "(bad)",		{ XX } },
a10073 1
    { "(bad)",		{ XX } },
a10077 1
    { "(bad)",		{ XX } },
a10081 1
    { "(bad)",		{ XX } },
a10085 1
    { "(bad)",		{ XX } },
a10089 1
    { "(bad)",		{ XX } },
a10096 1
    { "(bad)",		{ XX } },
a10130 1
    { "(bad)",		{ XX } },
a10139 1
    { "(bad)",		{ XX } },
a10143 1
    { "(bad)",		{ XX } },
a10147 1
    { "(bad)",		{ XX } },
a10151 1
    { "(bad)",		{ XX } },
a10155 1
    { "(bad)",		{ XX } },
d10159 1
a10159 1
    { "(bad)",		{ XX } },
d10164 1
a10164 1
    { "(bad)",		{ XX } },
d10169 1
a10169 1
    { "(bad)",		{ XX } },
d10174 1
a10174 1
    { "(bad)",		{ XX } },
d10179 1
a10179 1
    { "(bad)",		{ XX } },    
d10184 1
a10184 1
    { "(bad)",		{ XX } },
a10189 1
    { "(bad)",		{ XX } },
a10193 1
    { "(bad)",		{ XX } },
a10197 1
    { "(bad)",		{ XX } },
a10201 1
    { "(bad)",		{ XX } },
d10205 1
a10205 1
    { "(bad)",		{ XX } },
d10210 1
a10210 1
    { "(bad)",		{ XX } },
d10215 1
a10215 1
    { "(bad)",		{ XX } },
d10220 1
a10220 1
    { "(bad)",		{ XX } },
d10225 1
a10225 1
    { "(bad)",		{ XX } },
d10230 1
a10230 1
    { "(bad)",		{ XX } },
d10235 1
a10235 1
    { "(bad)",		{ XX } },
d10240 1
a10240 1
    { "(bad)",		{ XX } },
d10245 1
a10245 1
    { "(bad)",		{ XX } },
d10250 1
a10250 1
    { "(bad)",		{ XX } },
d10255 1
a10255 1
    { "(bad)",		{ XX } },
a10260 1
    { "(bad)",		{ XX } },
a10264 1
    { "(bad)",		{ XX } },
a10268 1
    { "(bad)",		{ XX } },
a10272 1
    { "(bad)",		{ XX } },
a10276 1
    { "(bad)",		{ XX } },
d10285 1
a10285 1
    { "(bad)",		{ XX } },
a10295 1
    { "(bad)",		{ XX } },
a10299 1
    { "(bad)",		{ XX } },
a10303 1
    { "(bad)",		{ XX } },
a10307 1
    { "(bad)",		{ XX } },
a10311 1
    { "(bad)",		{ XX } },
d10315 1
a10315 1
    { "(bad)",		{ XX } },
a10320 1
    { "(bad)",		{ XX } },
a10324 1
    { "(bad)",		{ XX } },
a10328 1
    { "(bad)",		{ XX } },
a10332 1
    { "(bad)",		{ XX } },
a10351 1
    { "(bad)",		{ XX } },
a10360 1
    { "(bad)",		{ XX } },
a10364 1
    { "(bad)",		{ XX } },
d10368 1
a10368 1
    { "(bad)",		{ XX } },
d10373 1
a10373 1
    { "(bad)",		{ XX } },
d10378 1
a10378 1
    { "(bad)",		{ XX } },
d10383 1
a10383 1
    { "(bad)",		{ XX } },
d10388 1
a10388 1
    { "(bad)",		{ XX } },
d10393 1
a10393 1
    { "(bad)",		{ XX } },
d10398 1
a10398 1
    { "(bad)",		{ XX } },
d10403 1
a10403 1
    { "(bad)",		{ XX } },
d10408 1
a10408 1
    { "(bad)",		{ XX } },
d10413 1
a10413 1
    { "(bad)",		{ XX } },
d10418 1
a10418 1
    { "(bad)",		{ XX } },
a10423 1
    { "(bad)",		{ XX } },
a10427 1
    { "(bad)",		{ XX } },
d10431 1
a10431 1
    { "(bad)",		{ XX } },
a10436 1
    { "(bad)",		{ XX } },
a10440 1
    { "(bad)",		{ XX } },
a10444 1
    { "(bad)",		{ XX } },
a10448 1
    { "(bad)",		{ XX } },
a10452 1
    { "(bad)",		{ XX } },
a10456 1
    { "(bad)",		{ XX } },
a10460 1
    { "(bad)",		{ XX } },
a10464 1
    { "(bad)",		{ XX } },
a10468 1
    { "(bad)",		{ XX } },
a10472 1
    { "(bad)",		{ XX } },
d10479 1
a10479 1
    { "(bad)",		{ XX } },
a10483 3
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
a10488 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
a10493 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
a10509 6
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
a10513 7
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
a10517 7
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
a10521 7
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d10843 3
d11131 4
d11743 1
a11743 1
    { "(bad)",	{ XX } },
d11755 1
a11755 1
    { "(bad)",	{ XX } },
d11757 2
a11758 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d11769 1
a11769 1
    { "(bad)",	{ XX } },
d11775 2
a11776 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d11785 1
a11785 1
    { "(bad)",	{ XX } },
d11790 2
a11791 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d11797 1
a11797 1
    { "(bad)",	{ XX } },
d11807 3
a11809 3
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d11813 1
a11813 1
    { "(bad)",	{ XX } },
@


1.231
log
@Add names_mm, names_xmm and names_ymm.

2010-01-14  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (names_mm): New.
	(intel_names_mm): Likewise.
	(att_names_mm): Likewise.
	(names_xmm): Likewise.
	(intel_names_xmm): Likewise.
	(att_names_xmm): Likewise.
	(names_ymm): Likewise.
	(intel_names_ymm): Likewise.
	(att_names_ymm): Likewise.
	(print_insn): Set names_mm, names_xmm and names_ymm.
	(OP_MMX): Use names_mm, names_xmm and names_ymm.
	(OP_XMM): Likewise.
	(OP_EM): Likewise.
	(OP_EMC): Likewise.
	(OP_MXC): Likewise.
	(OP_EX): Likewise.
	(XMM_Fixup): Likewise.
	(OP_VEX): Likewise.
	(OP_EX_VexReg): Likewise.
	(OP_Vex_2src): Likewise.
	(OP_Vex_2src_1): Likewise.
	(OP_Vex_2src_2): Likewise.
	(OP_REG_VexI4): Likewise.
@
text
@d11130 1
a11130 1
    { "xsave",		{ M } },
d11135 1
a11135 1
    { "xrstor",		{ M } },
d11140 1
a11140 1
    { "xsaveopt",	{ M } },
@


1.230
log
@Update comments

2010-01-13  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (print_insn): Update comments.
@
text
@d2365 38
d12167 3
d12186 3
d14672 3
d14678 1
a14678 1
      int add;
d14681 1
a14681 4
	add = 8;
      else
	add = 0;
      sprintf (scratchbuf, "%%xmm%d", modrm.reg + add);
d14684 2
a14685 2
    sprintf (scratchbuf, "%%mm%d", modrm.reg);
  oappend (scratchbuf + intel_syntax);
d14691 3
a14693 1
  int add;
d14696 1
a14696 3
    add = 8;
  else
    add = 0;
d14702 1
a14702 1
	  sprintf (scratchbuf, "%%xmm%d", modrm.reg + add);
d14705 1
a14705 1
	  sprintf (scratchbuf, "%%ymm%d", modrm.reg + add);
d14712 2
a14713 2
    sprintf (scratchbuf, "%%xmm%d", modrm.reg + add);
  oappend (scratchbuf + intel_syntax);
d14719 3
d14741 1
d14744 1
a14744 2
      int add;

d14747 1
a14747 4
	add = 8;
      else
	add = 0;
      sprintf (scratchbuf, "%%xmm%d", modrm.rm + add);
d14750 2
a14751 2
    sprintf (scratchbuf, "%%mm%d", modrm.rm);
  oappend (scratchbuf + intel_syntax);
d14777 1
a14777 2
  sprintf (scratchbuf, "%%mm%d", modrm.rm);
  oappend (scratchbuf + intel_syntax);
d14784 1
a14784 2
  sprintf (scratchbuf, "%%mm%d", modrm.reg);
  oappend (scratchbuf + intel_syntax);
d14790 2
a14791 1
  int add;
d14803 1
d14806 1
a14806 3
    add = 8;
  else
    add = 0;
d14821 1
a14821 1
	  sprintf (scratchbuf, "%%xmm%d", modrm.rm + add);
d14824 1
a14824 1
	  sprintf (scratchbuf, "%%ymm%d", modrm.rm + add);
d14831 2
a14832 2
    sprintf (scratchbuf, "%%xmm%d", modrm.rm + add);
  oappend (scratchbuf + intel_syntax);
d15131 2
d15138 1
a15138 1
	  sprintf (scratchbuf, "%%xmm%d", reg);
d15141 1
a15141 1
	  sprintf (scratchbuf, "%%ymm%d", reg);
d15148 2
a15149 2
    sprintf (scratchbuf, "%%xmm%d", reg);
  oappend (scratchbuf + intel_syntax);
d15245 2
d15266 1
a15266 1
      sprintf (scratchbuf, "%%xmm%d", vex.register_specifier);
d15279 1
a15279 1
      sprintf (scratchbuf, "%%ymm%d", vex.register_specifier);
d15285 1
a15285 1
  oappend (scratchbuf + intel_syntax);
d15380 2
d15403 1
a15403 1
      sprintf (scratchbuf, "%%xmm%d", reg);
d15406 1
a15406 1
      sprintf (scratchbuf, "%%ymm%d", reg);
d15411 1
a15411 1
  oappend (scratchbuf + intel_syntax);
d15419 1
d15421 3
a15423 2
      sprintf (scratchbuf, "%%xmm%d", rex & REX_B ? modrm.rm + 8 : modrm.rm);
      oappend (scratchbuf + intel_syntax);
d15448 1
a15448 4
    {
      sprintf (scratchbuf, "%%xmm%d", vex.register_specifier);
      oappend (scratchbuf + intel_syntax);
    }
d15459 1
a15459 4
    {
      sprintf (scratchbuf, "%%xmm%d", vex.register_specifier);
      oappend (scratchbuf + intel_syntax);
    }
d15501 2
d15519 1
a15519 1
      sprintf (scratchbuf, "%%xmm%d", reg);
d15522 1
a15522 1
      sprintf (scratchbuf, "%%ymm%d", reg);
d15527 1
a15527 1
  oappend (scratchbuf + intel_syntax);
@


1.229
log
@Remove rex_original

2010-01-12  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (rex_original): Removed.
	(ckprefix): Remove rex_original.
	(print_insn): Update comments.
@
text
@d12342 1
a12342 1
  /* Check if the SEG prefix used.  */
d12349 1
a12349 1
  /* Check if the ADDR prefix used.  */
d12354 1
a12354 1
  /* Check if the DATA prefix used.  */
@


1.228
log
@Add VEX_W_3818_P_2_M_0.

2009-12-15  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (VEX_W_3818_P_2_M_0): New.
	(vex_w_table): Add VEX_W_3818_P_2_M_0.
	(mod_table): Use VEX_W_3818_P_2_M_0.
@
text
@d147 1
a147 4
/* Original REX prefix.  */
static int rex_original;
/* REX bits in original REX prefix ignored.  It may not be the same
   as rex_original since some bits may not be ignored.  */
a11422 1
  rex_original = 0;
a11535 1
      rex_original = rex;
d12338 1
a12338 1
  /* Check if the REX prefix used.  */
@


1.227
log
@Reformat vex_w_table.

2009-12-15  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (vex_w_table): Reformat.
@
text
@d1488 1
d10541 5
d11280 1
a11280 1
    { "vbroadcastss",	{ XM, Md } },
@


1.226
log
@Add VEX_W_382X_P_2_M_0.

2009-12-15  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (VEX_W_382X_P_2_M_0): New.
	(vex_w_table): Add VEX_W_382X_P_2_M_0.
	(mod_table): Use VEX_W_382X_P_2_M_0.
@
text
@d10326 1
a10326 1
    { "vcvttpd2dq%XY", { XMM, EXx } },
d10331 1
a10331 1
    { "vcvtpd2dq%XY", { XMM, EXx } },
@


1.225
log
@Reformat vex_w_table.

2009-12-15  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (vex_w_table): Reformat.
@
text
@d1503 4
d10615 20
d11294 1
a11294 1
    { "vmaskmovps",	{ XM, Vex, Mx } },
d11299 1
a11299 1
    { "vmaskmovpd",	{ XM, Vex, Mx } },
d11304 1
a11304 1
    { "vmaskmovps",	{ Mx, Vex, XM } },
d11309 1
a11309 1
    { "vmaskmovpd",	{ Mx, Vex, XM } },
@


1.224
log
@Add USE_VEX_W_TABLE, VEX_W_TABLE and VEX_W_XXX.

2009-12-15  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (USE_VEX_W_TABLE): New.
	(VEX_W_TABLE): Likewise.
	(VEX_W_XXX): Likewise.
	(vex_w_table): Likewise.
	(prefix_table): Use VEX_W_XXX.
	(vex_table): Likewise.
	(vex_len_table): Likewise.
	(mod_table): Likewise.
	(get_valid_dis386): Handle USE_VEX_W_TABLE.

	* i386-opc.tbl: Add VexW0 to AVX instructions where the VEX.W bit
	isn't used.
	* i386-tbl.h: Regenerated.
@
text
@d10032 1
a10032 1
    { "vmovdqu", { XM, EXx } },
d10037 1
a10037 1
    { "vmovdqa", { XM, EXx } },
d10317 1
a10317 1
    { "vcvtdq2pd", { XM, EXxmmq } },
@


1.223
log
@Reformat vex_len_table.

2009-12-14  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (vex_len_table): Reformat.
@
text
@d525 2
a526 1
  USE_VEX_LEN_TABLE
d542 1
d1304 252
d3631 1
a3631 1
    { "vmovups", { XM, EXx } },
d3633 1
a3633 1
    { "vmovupd", { XM, EXx } },
d3639 1
a3639 1
    { "vmovups", { EXxS, XM } },
d3641 1
a3641 1
    { "vmovupd", { EXxS, XM } },
d3648 1
a3648 1
    { "vmovsldup", { XM, EXx } },
d3650 1
a3650 1
    { "vmovddup", { XM, EXymmq } },
d3656 1
a3656 1
    { "vmovshdup", { XM, EXx } },
d3703 1
a3703 1
    { "vsqrtps", { XM, EXx } },
d3705 1
a3705 1
    { "vsqrtpd", { XM, EXx } },
d3711 1
a3711 1
    { "vrsqrtps", { XM, EXx } },
d3719 1
a3719 1
    { "vrcpps",	{ XM, EXx } },
d3727 1
a3727 1
    { "vaddps",	{ XM, Vex, EXx } },
d3729 1
a3729 1
    { "vaddpd",	{ XM, Vex, EXx } },
d3735 1
a3735 1
    { "vmulps",	{ XM, Vex, EXx } },
d3737 1
a3737 1
    { "vmulpd",	{ XM, Vex, EXx } },
d3743 1
a3743 1
    { "vcvtps2pd", { XM, EXxmmq } },
d3751 3
a3753 3
    { "vcvtdq2ps", { XM, EXx } },
    { "vcvttps2dq", { XM, EXx } },
    { "vcvtps2dq", { XM, EXx } },
d3759 1
a3759 1
    { "vsubps",	{ XM, Vex, EXx } },
d3761 1
a3761 1
    { "vsubpd",	{ XM, Vex, EXx } },
d3767 1
a3767 1
    { "vminps",	{ XM, Vex, EXx } },
d3769 1
a3769 1
    { "vminpd",	{ XM, Vex, EXx } },
d3775 1
a3775 1
    { "vdivps",	{ XM, Vex, EXx } },
d3777 1
a3777 1
    { "vdivpd",	{ XM, Vex, EXx } },
d3783 1
a3783 1
    { "vmaxps",	{ XM, Vex, EXx } },
d3785 1
a3785 1
    { "vmaxpd",	{ XM, Vex, EXx } },
d3912 2
a3913 2
    { "vmovdqu", { XM, EXx } },
    { "vmovdqa", { XM, EXx } },
d4031 1
a4031 1
    { "",	{ VZERO } },
d4041 2
a4042 2
    { "vhaddpd", { XM, Vex, EXx } },
    { "vhaddps", { XM, Vex, EXx } },
d4049 2
a4050 2
    { "vhsubpd", { XM, Vex, EXx } },
    { "vhsubps", { XM, Vex, EXx } },
d4064 2
a4065 2
    { "vmovdqu", { EXxS, XM } },
    { "vmovdqa", { EXxS, XM } },
d4071 1
a4071 1
    { "vcmpps",	{ XM, Vex, EXx, VCMP } },
d4073 1
a4073 1
    { "vcmppd",	{ XM, Vex, EXx, VCMP } },
d4097 2
a4098 2
    { "vaddsubpd", { XM, Vex, EXx } },
    { "vaddsubps", { XM, Vex, EXx } },
d4272 3
a4274 3
    { "vcvtdq2pd", { XM, EXxmmq } },
    { "vcvttpd2dq%XY", { XMM, EXx } },
    { "vcvtpd2dq%XY", { XMM, EXx } },
d4569 1
a4569 1
    { "vpermilps", { XM, Vex, EXx } },
d4577 1
a4577 1
    { "vpermilpd", { XM, Vex, EXx } },
d4585 1
a4585 1
    { "vtestps", { XM, EXx } },
d4593 1
a4593 1
    { "vtestpd", { XM, EXx } },
d4601 1
a4601 1
    { "vptest",	{ XM, EXx } },
d5185 1
a5185 1
    { "vpermilps", { XM, EXx, Ib } },
d5193 1
a5193 1
    { "vpermilpd", { XM, EXx, Ib } },
d5209 1
a5209 1
    { "vroundps", { XM, EXx, Ib } },
d5217 1
a5217 1
    { "vroundpd", { XM, EXx, Ib } },
d5241 1
a5241 1
    { "vblendps", { XM, Vex, EXx, Ib } },
d5249 1
a5249 1
    { "vblendpd", { XM, Vex, EXx, Ib } },
d5345 1
a5345 1
    { "vdpps",	{ XM, Vex, EXx, Ib } },
d5377 1
a5377 1
    { "vblendvps", { XM, Vex, EXx, XMVexI4 } },
d5385 1
a5385 1
    { "vblendvpd", { XM, Vex, EXx, XMVexI4 } },
d7548 2
a7549 2
    { "vunpcklpX",	{ XM, Vex, EXx } },
    { "vunpckhpX",	{ XM, Vex, EXx } },
d7571 2
a7572 2
    { "vmovapX",	{ XM, EXx } },
    { "vmovapX",	{ EXxS, XM } },
d8401 1
a8401 1
    { "vmovss",		{ XMVex, Vex128, EXd } },
d8407 1
a8407 1
    { "vmovsd",		{ XMVex, Vex128, EXq } },
d8413 1
a8413 1
    { "vmovss",		{ EXdVexS, Vex128, XM } },
d8419 1
a8419 1
    { "vmovsd",		{ EXqVexS, Vex128, XM } },
d8425 1
a8425 1
    { "vmovlps",	{ XM, Vex128, EXq } },
d8431 1
a8431 1
    { "vmovhlps",	{ XM, Vex128, EXq } },
d8437 1
a8437 1
    { "vmovlpd",	{ XM, Vex128, EXq } },
d8443 1
a8443 1
    { "vmovlpX",	{ EXq, XM } },
d8449 1
a8449 1
    { "vmovhps",	{ XM, Vex128, EXq } },
d8455 1
a8455 1
    { "vmovlhps",	{ XM, Vex128, EXq } },
d8461 1
a8461 1
    { "vmovhpd",	{ XM, Vex128, EXq } },
d8467 1
a8467 1
    { "vmovhpX",	{ EXq, XM } },
d8509 1
a8509 1
    { "vucomiss",	{ XM, EXd } }, 
d8515 1
a8515 1
    { "vucomisd",	{ XM, EXq } }, 
d8521 1
a8521 1
    { "vcomiss",	{ XM, EXd } },
d8527 1
a8527 1
    { "vcomisd",	{ XM, EXq } },
d8533 1
a8533 1
    { "vsqrtss",	{ XM, Vex128, EXd } },
d8539 1
a8539 1
    { "vsqrtsd",	{ XM, Vex128, EXq } },
d8545 1
a8545 1
    { "vrsqrtss",	{ XM, Vex128, EXd } },
d8551 1
a8551 1
    { "vrcpss",		{ XM, Vex128, EXd } },
d8557 1
a8557 1
    { "vaddss",		{ XM, Vex128, EXd } },
d8563 1
a8563 1
    { "vaddsd",		{ XM, Vex128, EXq } },
d8569 1
a8569 1
    { "vmulss",		{ XM, Vex128, EXd } },
d8575 1
a8575 1
    { "vmulsd",		{ XM, Vex128, EXq } },
d8581 1
a8581 1
    { "vcvtss2sd",	{ XM, Vex128, EXd } },
d8587 1
a8587 1
    { "vcvtsd2ss",	{ XM, Vex128, EXq } },
d8593 1
a8593 1
    { "vsubss",		{ XM, Vex128, EXd } },
d8599 1
a8599 1
    { "vsubsd",		{ XM, Vex128, EXq } },
d8605 1
a8605 1
    { "vminss",		{ XM, Vex128, EXd } },
d8611 1
a8611 1
    { "vminsd",		{ XM, Vex128, EXq } },
d8617 1
a8617 1
    { "vdivss",		{ XM, Vex128, EXd } },
d8623 1
a8623 1
    { "vdivsd",		{ XM, Vex128, EXq } },
d8629 1
a8629 1
    { "vmaxss",		{ XM, Vex128, EXd } },
d8635 1
a8635 1
    { "vmaxsd",		{ XM, Vex128, EXq } },
d8641 1
a8641 1
    { "vpunpcklbw",	{ XM, Vex128, EXx } },
d8647 1
a8647 1
    { "vpunpcklwd",	{ XM, Vex128, EXx } },
d8653 1
a8653 1
    { "vpunpckldq",	{ XM, Vex128, EXx } },
d8659 1
a8659 1
    { "vpacksswb",	{ XM, Vex128, EXx } },
d8665 1
a8665 1
    { "vpcmpgtb",	{ XM, Vex128, EXx } },
d8671 1
a8671 1
    { "vpcmpgtw",	{ XM, Vex128, EXx } },
d8677 1
a8677 1
    { "vpcmpgtd",	{ XM, Vex128, EXx } },
d8683 1
a8683 1
    { "vpackuswb",	{ XM, Vex128, EXx } },
d8689 1
a8689 1
    { "vpunpckhbw",	{ XM, Vex128, EXx } },
d8695 1
a8695 1
    { "vpunpckhwd",	{ XM, Vex128, EXx } },
d8701 1
a8701 1
    { "vpunpckhdq",	{ XM, Vex128, EXx } },
d8707 1
a8707 1
    { "vpackssdw",	{ XM, Vex128, EXx } },
d8713 1
a8713 1
    { "vpunpcklqdq",	{ XM, Vex128, EXx } },
d8719 1
a8719 1
    { "vpunpckhqdq",	{ XM, Vex128, EXx } },
d8731 1
a8731 1
    { "vpshufhw",	{ XM, EXx, Ib } },
d8737 1
a8737 1
    { "vpshufd",	{ XM, EXx, Ib } },
d8743 1
a8743 1
    { "vpshuflw",	{ XM, EXx, Ib } },
d8749 1
a8749 1
    { "vpsrlw",		{ Vex128, XS, Ib } },
d8755 1
a8755 1
    { "vpsraw",		{ Vex128, XS, Ib } },
d8761 1
a8761 1
    { "vpsllw",		{ Vex128, XS, Ib } },
d8767 1
a8767 1
    { "vpsrld",		{ Vex128, XS, Ib } },
d8773 1
a8773 1
    { "vpsrad",		{ Vex128, XS, Ib } },
d8779 1
a8779 1
    { "vpslld",		{ Vex128, XS, Ib } },
d8785 1
a8785 1
    { "vpsrlq",		{ Vex128, XS, Ib } },
d8791 1
a8791 1
    { "vpsrldq",	{ Vex128, XS, Ib } },
d8797 1
a8797 1
    { "vpsllq",		{ Vex128, XS, Ib } },
d8803 1
a8803 1
    { "vpslldq",	{ Vex128, XS, Ib } },
d8809 1
a8809 1
    { "vpcmpeqb",	{ XM, Vex128, EXx } },
d8815 1
a8815 1
    { "vpcmpeqw",	{ XM, Vex128, EXx } },
d8821 1
a8821 1
    { "vpcmpeqd",	{ XM, Vex128, EXx } },
d8827 1
a8827 1
    { "vmovq",		{ XM, EXq } },
d8839 1
a8839 1
    { "vldmxcsr",	{ Md } },
d8845 1
a8845 1
    { "vstmxcsr",	{ Md } },
d8851 1
a8851 1
    { "vcmpss",		{ XM, Vex128, EXd, VCMP } },
d8857 1
a8857 1
    { "vcmpsd",		{ XM, Vex128, EXq, VCMP } },
d8863 1
a8863 1
    { "vpinsrw",	{ XM, Vex128, Edqw, Ib } },
d8869 1
a8869 1
    { "vpextrw",	{ Gdq, XS, Ib } },
d8875 1
a8875 1
    { "vpsrlw",		{ XM, Vex128, EXx } },
d8881 1
a8881 1
    { "vpsrld",		{ XM, Vex128, EXx } },
d8887 1
a8887 1
    { "vpsrlq",		{ XM, Vex128, EXx } },
d8893 1
a8893 1
    { "vpaddq",		{ XM, Vex128, EXx } },
d8899 1
a8899 1
    { "vpmullw",	{ XM, Vex128, EXx } },
d8905 1
a8905 1
    { "vmovq",		{ EXqS, XM } },
d8911 1
a8911 1
    { "vpmovmskb",	{ Gdq, XS } },
d8917 1
a8917 1
    { "vpsubusb",	{ XM, Vex128, EXx } },
d8923 1
a8923 1
    { "vpsubusw",	{ XM, Vex128, EXx } },
d8929 1
a8929 1
    { "vpminub",	{ XM, Vex128, EXx } },
d8935 1
a8935 1
    { "vpand",		{ XM, Vex128, EXx } },
d8941 1
a8941 1
    { "vpaddusb",	{ XM, Vex128, EXx } },
d8947 1
a8947 1
    { "vpaddusw",	{ XM, Vex128, EXx } },
d8953 1
a8953 1
    { "vpmaxub",	{ XM, Vex128, EXx } },
d8959 1
a8959 1
    { "vpandn",		{ XM, Vex128, EXx } },
d8965 1
a8965 1
    { "vpavgb",		{ XM, Vex128, EXx } },
d8971 1
a8971 1
    { "vpsraw",		{ XM, Vex128, EXx } },
d8977 1
a8977 1
    { "vpsrad",		{ XM, Vex128, EXx } },
d8983 1
a8983 1
    { "vpavgw",		{ XM, Vex128, EXx } },
d8989 1
a8989 1
    { "vpmulhuw",	{ XM, Vex128, EXx } },
d8995 1
a8995 1
    { "vpmulhw",	{ XM, Vex128, EXx } },
d9001 1
a9001 1
    { "vpsubsb",	{ XM, Vex128, EXx } },
d9007 1
a9007 1
    { "vpsubsw",	{ XM, Vex128, EXx } },
d9013 1
a9013 1
    { "vpminsw",	{ XM, Vex128, EXx } },
d9019 1
a9019 1
    { "vpor",		{ XM, Vex128, EXx } },
d9025 1
a9025 1
    { "vpaddsb",	{ XM, Vex128, EXx } },
d9031 1
a9031 1
    { "vpaddsw",	{ XM, Vex128, EXx } },
d9037 1
a9037 1
    { "vpmaxsw",	{ XM, Vex128, EXx } },
d9043 1
a9043 1
    { "vpxor",		{ XM, Vex128, EXx } },
d9049 1
a9049 1
    { "vpsllw",		{ XM, Vex128, EXx } },
d9055 1
a9055 1
    { "vpslld",		{ XM, Vex128, EXx } },
d9061 1
a9061 1
    { "vpsllq",		{ XM, Vex128, EXx } },
d9067 1
a9067 1
    { "vpmuludq",	{ XM, Vex128, EXx } },
d9073 1
a9073 1
    { "vpmaddwd",	{ XM, Vex128, EXx } },
d9079 1
a9079 1
    { "vpsadbw",	{ XM, Vex128, EXx } },
d9085 1
a9085 1
    { "vmaskmovdqu",	{ XM, XS } },
d9091 1
a9091 1
    { "vpsubb",		{ XM, Vex128, EXx } },
d9097 1
a9097 1
    { "vpsubw",		{ XM, Vex128, EXx } },
d9103 1
a9103 1
    { "vpsubd",		{ XM, Vex128, EXx } },
d9109 1
a9109 1
    { "vpsubq",		{ XM, Vex128, EXx } },
d9115 1
a9115 1
    { "vpaddb",		{ XM, Vex128, EXx } },
d9121 1
a9121 1
    { "vpaddw",		{ XM, Vex128, EXx } },
d9127 1
a9127 1
    { "vpaddd",		{ XM, Vex128, EXx } },
d9133 1
a9133 1
    { "vpshufb",	{ XM, Vex128, EXx } },
d9139 1
a9139 1
    { "vphaddw",	{ XM, Vex128, EXx } },
d9145 1
a9145 1
    { "vphaddd",	{ XM, Vex128, EXx } },
d9151 1
a9151 1
    { "vphaddsw",	{ XM, Vex128, EXx } },
d9157 1
a9157 1
    { "vpmaddubsw",	{ XM, Vex128, EXx } },
d9163 1
a9163 1
    { "vphsubw",	{ XM, Vex128, EXx } },
d9169 1
a9169 1
    { "vphsubd",	{ XM, Vex128, EXx } },
d9175 1
a9175 1
    { "vphsubsw",	{ XM, Vex128, EXx } },
d9181 1
a9181 1
    { "vpsignb",	{ XM, Vex128, EXx } },
d9187 1
a9187 1
    { "vpsignw",	{ XM, Vex128, EXx } },
d9193 1
a9193 1
    { "vpsignd",	{ XM, Vex128, EXx } },
d9199 1
a9199 1
    { "vpmulhrsw",	{ XM, Vex128, EXx } },
d9206 1
a9206 1
    { "vbroadcastsd",	{ XM, Mq } },
d9212 1
a9212 1
    { "vbroadcastf128",	{ XM, Mxmm } },
d9217 1
a9217 1
    { "vpabsb",		{ XM, EXx } },
d9223 1
a9223 1
    { "vpabsw",		{ XM, EXx } },
d9229 1
a9229 1
    { "vpabsd",		{ XM, EXx } },
d9235 1
a9235 1
    { "vpmovsxbw",	{ XM, EXq } },
d9241 1
a9241 1
    { "vpmovsxbd",	{ XM, EXd } },
d9247 1
a9247 1
    { "vpmovsxbq",	{ XM, EXw } },
d9253 1
a9253 1
    { "vpmovsxwd",	{ XM, EXq } },
d9259 1
a9259 1
    { "vpmovsxwq",	{ XM, EXd } },
d9265 1
a9265 1
    { "vpmovsxdq",	{ XM, EXq } },
d9271 1
a9271 1
    { "vpmuldq",	{ XM, Vex128, EXx } },
d9277 1
a9277 1
    { "vpcmpeqq",	{ XM, Vex128, EXx } },
d9283 1
a9283 1
    { "vmovntdqa",	{ XM, Mx } },
d9289 1
a9289 1
    { "vpackusdw",	{ XM, Vex128, EXx } },
d9295 1
a9295 1
    { "vpmovzxbw",	{ XM, EXq } },
d9301 1
a9301 1
    { "vpmovzxbd",	{ XM, EXd } },
d9307 1
a9307 1
    { "vpmovzxbq",	{ XM, EXw } },
d9313 1
a9313 1
    { "vpmovzxwd",	{ XM, EXq } },
d9319 1
a9319 1
    { "vpmovzxwq",	{ XM, EXd } },
d9325 1
a9325 1
    { "vpmovzxdq",	{ XM, EXq } },
d9331 1
a9331 1
    { "vpcmpgtq",	{ XM, Vex128, EXx } },
d9337 1
a9337 1
    { "vpminsb",	{ XM, Vex128, EXx } },
d9343 1
a9343 1
    { "vpminsd",	{ XM, Vex128, EXx } },
d9349 1
a9349 1
    { "vpminuw",	{ XM, Vex128, EXx } },
d9355 1
a9355 1
    { "vpminud",	{ XM, Vex128, EXx } },
d9361 1
a9361 1
    { "vpmaxsb",	{ XM, Vex128, EXx } },
d9367 1
a9367 1
    { "vpmaxsd",	{ XM, Vex128, EXx } },
d9373 1
a9373 1
    { "vpmaxuw",	{ XM, Vex128, EXx } },
d9379 1
a9379 1
    { "vpmaxud",	{ XM, Vex128, EXx } },
d9385 1
a9385 1
    { "vpmulld",	{ XM, Vex128, EXx } },
d9391 1
a9391 1
    { "vphminposuw",	{ XM, EXx } },
d9397 1
a9397 1
    { "vaesimc",	{ XM, EXx } },
d9403 1
a9403 1
    { "vaesenc",	{ XM, Vex128, EXx } },
d9409 1
a9409 1
    { "vaesenclast",	{ XM, Vex128, EXx } },
d9415 1
a9415 1
    { "vaesdec",	{ XM, Vex128, EXx } },
d9421 1
a9421 1
    { "vaesdeclast",	{ XM, Vex128, EXx } },
d9428 1
a9428 1
    { "vperm2f128",	{ XM, Vex256, EXx, Ib } },
d9433 1
a9433 1
    { "vroundss",	{ XM, Vex128, EXd, Ib } },
d9439 1
a9439 1
    { "vroundsd",	{ XM, Vex128, EXq, Ib } },
d9445 1
a9445 1
    { "vpblendw",	{ XM, Vex128, EXx, Ib } },
d9451 1
a9451 1
    { "vpalignr",	{ XM, Vex128, EXx, Ib } },
d9457 1
a9457 1
    { "vpextrb",	{ Edqb, XM, Ib } },
d9463 1
a9463 1
    { "vpextrw",	{ Edqw, XM, Ib } },
d9482 1
a9482 1
    { "vinsertf128",	{ XM, Vex256, EXxmm, Ib } },
d9488 1
a9488 1
    { "vextractf128",	{ EXxmm, XM, Ib } },
d9493 1
a9493 1
    { "vpinsrb",	{ XM, Vex128, Edqb, Ib } },
d9499 1
a9499 1
    { "vinsertps",	{ XM, Vex128, EXd, Ib } },
d9511 1
a9511 1
    { "vdppd",		{ XM, Vex128, EXx, Ib } },
d9517 1
a9517 1
    { "vmpsadbw",	{ XM, Vex128, EXx, Ib } },
d9523 1
a9523 1
    { "vpclmulqdq",	{ XM, Vex128, EXx, PCLMUL } },
d9529 1
a9529 1
    { "vpblendvb",	{ XM, Vex128, EXx, XMVexI4 } },
d9535 1
a9535 1
    { "vpcmpestrm",	{ XM, EXx, Ib } },
d9541 1
a9541 1
    { "vpcmpestri",	{ XM, EXx, Ib } },
d9547 1
a9547 1
    { "vpcmpistrm",	{ XM, EXx, Ib } },
d9553 1
a9553 1
    { "vpcmpistri",	{ XM, EXx, Ib } },
d9607 1
a9607 1
    { "vaeskeygenassist", { XM, EXx, Ib } },
d9624 1
a9624 1
static const struct dis386 mod_table[][2] = {
d9626 2
a9627 2
    /* MOD_8D */
    { "leaS",		{ Gv, M } },
d9631 3
a9633 3
    /* MOD_0F01_REG_0 */
    { X86_64_TABLE (X86_64_0F01_REG_0) },
    { RM_TABLE (RM_0F01_REG_0) },
d9636 3
a9638 3
    /* MOD_0F01_REG_1 */
    { X86_64_TABLE (X86_64_0F01_REG_1) },
    { RM_TABLE (RM_0F01_REG_1) },
d9641 3
a9643 3
    /* MOD_0F01_REG_2 */
    { X86_64_TABLE (X86_64_0F01_REG_2) },
    { RM_TABLE (RM_0F01_REG_2) },
d9646 3
a9648 3
    /* MOD_0F01_REG_3 */
    { X86_64_TABLE (X86_64_0F01_REG_3) },
    { RM_TABLE (RM_0F01_REG_3) },
d9651 3
a9653 3
    /* MOD_0F01_REG_7 */
    { "invlpg",		{ Mb } },
    { RM_TABLE (RM_0F01_REG_7) },
d9656 3
a9658 3
    /* MOD_0F12_PREFIX_0 */
    { "movlps",		{ XM, EXq } },
    { "movhlps",	{ XM, EXq } },
d9661 2
a9662 2
    /* MOD_0F13 */
    { "movlpX",		{ EXq, XM } },
d9666 3
a9668 3
    /* MOD_0F16_PREFIX_0 */
    { "movhps",		{ XM, EXq } },
    { "movlhps",	{ XM, EXq } },
d9671 2
a9672 2
    /* MOD_0F17 */
    { "movhpX",		{ EXq, XM } },
d9676 2
a9677 2
    /* MOD_0F18_REG_0 */
    { "prefetchnta",	{ Mb } },
d9681 2
a9682 2
    /* MOD_0F18_REG_1 */
    { "prefetcht0",	{ Mb } },
d9686 2
a9687 2
    /* MOD_0F18_REG_2 */
    { "prefetcht1",	{ Mb } },
d9691 2
a9692 2
    /* MOD_0F18_REG_3 */
    { "prefetcht2",	{ Mb } },
d9696 2
a9697 1
    /* MOD_0F20 */
a9698 1
    { "movZ",		{ Rm, Cm } },
d9701 2
a9702 1
    /* MOD_0F21 */
a9703 1
    { "movZ",		{ Rm, Dm } },
d9706 2
a9707 1
    /* MOD_0F22 */
d9709 1243
a10951 1
    { "movZ",		{ Cm, Rm } },
d11165 1
a11165 1
    { "vmovntpX",	{ Mx, XM } },
d11171 1
a11171 1
    { "vmovmskpX",	{ Gdq, XS } },
d11240 1
a11240 1
    { "vmovntdq",	{ Mx, XM } },
d11245 1
a11245 1
    { "vlddqu",		{ XM, M } },
d11979 7
@


1.222
log
@Rename MOD_VEX_51 to MOD_VEX_50.

2009-12-14  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (MOD_VEX_51): Renamed to ...
	(MOD_VEX_50): This.
	(vex_table): Updated.
	(mod_table): Likewise.
@
text
@d9356 1
d9359 2
a9360 2
    { "vfrczps", { XM, EXxmm } },
    { "vfrczps", { XM, EXymmq } },
d9362 1
d9365 2
a9366 2
    { "vfrczpd", { XM, EXxmm } },
    { "vfrczpd", { XM, EXymmq } },
@


1.221
log
@Set vex.w to 0 for VEX C5 prefix.

2009-12-11  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (get_valid_dis386): Set vex.w to 0 for VEX C5
	prefix.
	(print_insn): Don't set vex.w here.
@
text
@d642 1
a642 1
  MOD_VEX_51,
d7362 1
a7362 1
    { MOD_TABLE (MOD_VEX_51) },
d9670 1
a9670 1
    /* MOD_VEX_51 */
@


1.220
log
@2009-12-11  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (print_insn): Set vex.w to 0.
@
text
@d10447 2
a10767 1
   vex.w = 0;
@


1.219
log
@2009-12-11  Quentin Neill  <quentin.neill@@amd.com>

	gas/testsuite/
	* gas/i386/fma4.d: Add test cases.
	* gas/i386/fma4.s: Add test cases.
	* gas/i386/x86-64-fma4.d: Add test cases.
	* gas/i386/x86-64-fma4.s: Add test cases.

	opcodes/
	* i386-dis.c (get_vex_imm8): Extend logic to apply in all
	cases, to avoid fetching ahead for the immediate bytes when
	OP_E_memory has already been called.  Fix indentation.
@
text
@d10766 1
@


1.218
log
@Add -Wshadow to the gcc command line options used when compiling the binutils.
Fix up all warnings generated by the addition of this switch.
@
text
@d13720 1
a13720 1
	{
d13722 1
a13722 1
	  int base = modrm.rm;
d13725 8
a13732 28
	  if (base == 4)
	    {
	      FETCH_DATA (the_info, codep + 1);
	      base = *codep & 7;
	      /* When decoding the third source, don't increase
		 bytes_before_imm as this has already been incremented
		 by one in OP_E_memory while decoding the second
		 source operand.  */
              if (opnum == 0)
                bytes_before_imm++;
	    }
	  switch (modrm.mod)
	    {
	    case 0:
	      /* When modrm.rm == 5 or modrm.rm == 4 and base in
		 SIB == 5, there is a 4 byte displacement.  */
	      if (base != 5)
		/* No displacement. */
		break;
	    case 2:
	      /* 4 byte displacement.  */
	      bytes_before_imm += 4;
	      break;
	    case 1:
	      /* 1 byte displacement: when decoding the third source,
		 don't increase bytes_before_imm as this has already
		 been incremented by one in OP_E_memory while decoding
		 the second source operand.  */
d13735 1
d13737 24
a13760 3
	      break;
	    }
	}
d13762 25
a13786 19
	{ /* 16 bit address mode */
	  switch (modrm.mod)
	    {
	    case 0:
	      /* When modrm.rm == 6, there is a 2 byte displacement.  */
	      if (modrm.rm != 6)
		/* No displacement. */
		break;
	    case 2:
	      /* 2 byte displacement.  */
	      bytes_before_imm += 2;
	      break;
	    case 1:
	      /* 1 byte displacement: when decoding the third source,
		 don't increase bytes_before_imm as this has already
		 been incremented by one in OP_E_memory while decoding
		 the second source operand.  */
              if (opnum == 0)
                bytes_before_imm++;
d13788 2
a13789 1
	      break;
@


1.217
log
@Support fxsave64 and fxrstor64.

gas/testsuite/

2009-12-03  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run x86-64-fxsave and x86-64-fxsave-intel.

	* gas/i386/rex.d: Updated for fxsave64.

	* gas/i386/x86-64-fxsave-intel.d: New.
	* gas/i386/x86-64-fxsave.d: Likewise.
	* gas/i386/x86-64-fxsave.s: Likewise.

opcodes/

2009-12-03  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (FXSAVE_Fixup): New.
	(FXSAVE): Likewise.
	(mod_table): Use FXSAVE on fxsave and fxrstor.

	* i386-opc.tbl: Add fxsave64 and fxrstor64.
	* i386-tbl.h: Regenerated.
@
text
@d10207 1
a10207 1
  int index, vex_table_index;
d10219 2
a10220 2
      index = modrm.mod == 0x3 ? 1 : 0;
      dp = &mod_table[dp->op[1].bytemode][index];
d10234 1
a10234 1
	      index = 0;
d10237 1
a10237 1
	      index = 1;
d10240 1
a10240 1
	      index = 2;
d10243 1
a10243 1
	      index = 3;
d10252 1
a10252 1
	  index = 0;
d10256 1
a10256 1
	      index = 1;
d10266 1
a10266 1
		  index = 3;
d10274 1
a10274 1
		      index = 2;
d10280 1
a10280 1
      dp = &prefix_table[dp->op[1].bytemode][index];
d10284 2
a10285 2
      index = address_mode == mode_64bit ? 1 : 0;
      dp = &x86_64_table[dp->op[1].bytemode][index];
d10290 2
a10291 2
      index = *codep++;
      dp = &three_byte_table[dp->op[1].bytemode][index];
d10304 1
a10304 1
	  index = 0;
d10307 1
a10307 1
	  index = 1;
d10314 1
a10314 1
      dp = &vex_len_table[dp->op[1].bytemode][index];
d10367 2
a10368 2
      index = *codep++;
      dp = &xop_table[vex_table_index][index];
d10424 2
a10425 2
      index = *codep++;
      dp = &vex_table[vex_table_index][index];
d10427 1
a10427 1
      if (index != 0x77 && index != 0x82)
d10466 2
a10467 2
      index = *codep++;
      dp = &vex_table[dp->op[1].bytemode][index];
d10469 1
a10469 1
      if (index != 0x77 && index != 0x82)
d12161 1
a12161 1
      int index = 0;
d12173 1
a12173 1
	  index = (*codep >> 3) & 7;
d12178 2
a12179 2
	    index += 8;
	  haveindex = index != 4;
d12263 1
a12263 1
			     ? names64[index] : names32[index]);
@


1.216
log
@2009-11-17  Quentin Neill  <quentin.neill@@amd.com>
	    Sebastian Pop  <sebastian.pop@@amd.com>

	gas/testsuite/
	* gas/i386/x86-64-fma4.d: Add new patterns.
	* gas/i386/x86-64-fma4.s: Same.
	* gas/i386/x86-64-xop.d: Adjusted.

	opcodes/
	* i386-dis.c (get_vex_imm8): Increase bytes_before_imm when
	decoding the second source operand from the immediate byte.
	(OP_EX_VexW): Pass an extra integer to identify the second
	and third source arguments.
@
text
@d113 1
d362 1
d9546 1
a9546 1
    { "fxsave",		{ M } },
d9551 1
a9551 1
    { "fxrstor",	{ M } },
d13646 16
@


1.215
log
@2009-11-18  Sebastian Pop  <sebastian.pop@@amd.com>

	opcodes/
	PR binutils/10973
	* i386-dis.c (get_vex_imm8): Do not increment codep.
	Avoid incrementing bytes_before_imm when OP_E_memory
	has already forwarded the codep pointer.
	(OP_EX_VexW): Increment codep to skip mod/rm byte.

	gas/testsuite/
	* gas/i386/x86-64-xop.d: Update patterns.
@
text
@d13694 1
a13694 1
get_vex_imm8 (int sizeflag)
d13711 6
a13716 2
	      /* Don't increase bytes_before_imm as this has already
		 been done in OP_E_memory.  */
a13717 1

d13731 7
a13737 2
	      /* 1 byte displacement: codep has already been
		 incremented by 1 in OP_E_memory.  */
d13755 7
a13761 2
	      /* 1 byte displacement: codep has already been
		 incremented by 1 in OP_E_memory.  */
d13872 1
a13872 1
	reg = get_vex_imm8 (sizeflag) >> 4;
d13877 1
a13877 1
	reg = get_vex_imm8 (sizeflag) >> 4;
@


1.214
log
@2009-11-18  Sebastian Pop  <sebastian.pop@@amd.com>

	gas/
	* config/tc-i386.c (cpu_arch): Remove cvt16.
	(md_show_usage): Same.
	* doc/c-i386.texi: Same.

	gas/testsuite/
	* gas/i386/cvt16.d: Removed.
	* gas/i386/cvt16.s: Removed.
	* gas/i386/x86-64-cvt16.d: Removed.
	* gas/i386/x86-64-cvt16.s: Removed.
	* gas/i386/i386.exp: Remove cvt16 and x86-64-cvt16 tests.

	opcodes/
	* i386-dis.c (VEX_LEN_XOP_08_A0): Removed.
	(VEX_LEN_XOP_08_A1): Removed.
	(xop_table): Remove entries for VEX_LEN_XOP_08_A0 and
	VEX_LEN_XOP_08_A1.
	(vex_len_table): Same.
	* i386-gen.c (CPU_CVT16_FLAGS): Removed.
	(cpu_flags): Remove field for CpuCVT16.
	* i386-opc.h (CpuCVT16): Removed.
	(i386_cpu_flags): Remove bitfield cpucvt16.
	(i386-opc.tbl): Remove CVT16 instructions.
	* i386-init.h: Regenerated.
	* i386-tbl.h: Regenerated.
@
text
@a13697 4
  /* Skip mod/rm byte.   */
  MODRM_CHECK;
  codep++;

d13711 2
a13712 1
	      bytes_before_imm++;
d13728 2
a13729 2
	      /* 1 byte displacement.  */
	      bytes_before_imm++;
d13747 2
a13748 2
	      /* 1 byte displacement.  */
	      bytes_before_imm++;
d13853 5
@


1.213
log
@2009-11-17  Sebastian Pop  <sebastian.pop@@amd.com>
	    Quentin Neill  <quentin.neill@@amd.com>

	gas/
	* config/tc-i386.c (cpu_arch): Added .xop and .cvt16.
	(build_vex_prefix): Handle xop08.
	(md_assemble): Don't special case the constant 3 for insns using MODRM.
	(build_modrm_byte): Handle vex2sources.
	(md_show_usage): Add xop and cvt16.
	* doc/c-i386.texi: Document fma4, xop, and cvt16.

	gas/testsuite/
	* gas/i386/i386.exp: Run xop and cvt16 in 32-bit mode.
	Run x86-64-xop and x86-64-cvt16 in 64-bit mode.
	* gas/i386/lwp.d: Update name of the testcase.
	* gas/i386/x86-64-xop.d: New.
	* gas/i386/x86-64-xop.s: New.
	* gas/i386/xop.d: New.
	* gas/i386/xop.s: New.
	* gas/i386/cvt16.d: New.
	* gas/i386/cvt16.s: New.

	opcodes/
	* i386-dis.c (OP_Vex_2src_1): New.
	(OP_Vex_2src_2): New.
	(Vex_2src_1): New.
	(Vex_2src_2): New.
	(XOP_08): Added.
	(VEX_LEN_XOP_08_A0): Added.
	(VEX_LEN_XOP_08_A1): Added.
	(VEX_LEN_XOP_09_80): Added.
	(VEX_LEN_XOP_09_81): Added.
	(xop_table): Added an entry for XOP_08.  Handle xop instructions.
	(vex_len_table): Added entries for VEX_LEN_XOP_08_A0,
	VEX_LEN_XOP_08_A1, VEX_LEN_XOP_09_80, VEX_LEN_XOP_09_81.
	(get_valid_dis386): Handle XOP_08.
	(OP_Vex_2src): New.
	* i386-gen.c (cpu_flag_init): Add CPU_XOP_FLAGS and CPU_CVT16_FLAGS.
	(cpu_flags): Add CpuXOP and CpuCVT16.
	(opcode_modifiers): Add XOP08, Vex2Sources.
	* i386-opc.h (CpuXOP): Added.
	(CpuCVT16): Added.
	(i386_cpu_flags): Add cpuxop and cpucvt16.
	(XOP08): Added.
	(Vex2Sources): Added.
	(i386_opcode_modifier): Add xop08, vex2sources.
	* i386-opc.tbl: Add entries for XOP and CVT16 instructions.
	* i386-init.h: Regenerated.
	* i386-tbl.h: Regenerated.
@
text
@a1295 2
  VEX_LEN_XOP_08_A0,
  VEX_LEN_XOP_08_A1,
d6574 2
a6575 2
    { VEX_LEN_TABLE (VEX_LEN_XOP_08_A0) },
    { VEX_LEN_TABLE (VEX_LEN_XOP_08_A1) },
a9353 10
  /* VEX_LEN_XOP_08_A0 */
  {
    { "vcvtph2ps", { XM, EXq, Ib } },
    { "vcvtph2ps", { XM, EXxmm, Ib } },
  },
  /* VEX_LEN_XOP_08_A1 */
  {
    { "vcvtps2ph", { EXq, XM, Ib } },
    { "vcvtps2ph", { EXxmm, XM, Ib } },
  },
@


1.212
log
@2009-11-13  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_E_extended): Removed.
@
text
@d116 2
d361 2
d1080 2
a1081 1
  XOP_09 = 0,
d1295 5
a1299 1
  VEX_LEN_3ADF_P_2
d6393 1
a6393 1
  /* XOP_09 */
d6416 1
a6416 1
    { REG_TABLE (REG_XOP_LWPCB) },
d6545 182
d6730 75
a6804 1
    /* 88 */
d6812 1
a6813 1
    /* 90 */
d6821 1
a6822 1
    /* 98 */
d6830 5
a6835 1
    /* a0 */
d6839 1
a6844 1
    /* a8 */
d6848 14
d6866 1
a6867 1
    /* b0 */
d6875 1
a6876 1
    /* b8 */
d6884 1
a6885 1
    /* c0 */
d6893 1
a6894 1
    /* c8 */
d6902 1
d6904 3
a6906 1
    /* d0 */
d6909 3
d6915 1
a6918 1
    /* d8 */
d6920 1
d6922 3
d6927 3
d6933 1
a6934 1
    /* e0 */
d6938 1
d6940 3
d9356 20
d10338 3
d13809 52
@


1.211
log
@Check rex_ignored.

gas/testsuite/

2009-11-13  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/rex.s: Add a test for VEX insn.
	* gas/i386/rex.d: Updated.

opcodes/

2009-11-13  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (print_insn): Check rex_ignored.
@
text
@a55 1
static void OP_E_extended (int, int);
d12082 1
a12082 1
OP_E_extended (int bytemode, int sizeflag)
a12094 7
OP_E (int bytemode, int sizeflag)
{
  OP_E_extended (bytemode, sizeflag);
}


static void
@


1.210
log
@Rewrite prefix processing.

gas/testsuite/

2009-11-13  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run long-1, long-1-intel, x86-64-long-1,
	and x86-64-long-1-intel.

	* gas/i386/long-1-intel.d: New.
	* gas/i386/long-1.d: Likewise.
	* gas/i386/long-1.s: Likewise.
	* gas/i386/x86-64-long-1-intel.d: Likewise.
	* gas/i386/x86-64-long-1.d: Likewise.
	* gas/i386/x86-64-long-1.s: Likewise.

	* gas/i386/jump16.d: Updated for prefix processing.
	* gas/i386/naked.d: Likewise.
	* gas/i386/nops-1-core2.d: Likewise.
	* gas/i386/nops-1-i686.d: Likewise.
	* gas/i386/nops-3-i686.d: Likewise.
	* gas/i386/nops-4-i686.d: Likewise.
	* gas/i386/nops-5-i686.d: Likewise.
	* gas/i386/nops-5.d: Likewise.
	* gas/i386/prefix.d: Likewise.
	* gas/i386/rep.d: Likewise.
	* gas/i386/string-ok.d: Likewise.
	* gas/i386/x86-64-addr32-intel.d: Likewise.
	* gas/i386/x86-64-addr32.d: Likewise.
	* gas/i386/x86-64-cbw-intel.d: Likewise.
	* gas/i386/x86-64-cbw.d: Likewise.
	* gas/i386/x86-64-io-intel.d: Likewise.
	* gas/i386/x86-64-io-suffix.d: Likewise.
	* gas/i386/x86-64-io.d: Likewise.
	* gas/i386/x86-64-lwp.d: Likewise.
	* gas/i386/x86-64-nops-1-core2.d: Likewise.
	* gas/i386/x86-64-nops-1-nocona.d: Likewise.
	* gas/i386/x86-64-nops-1.d: Likewise.
	* gas/i386/x86-64-nops-2.d: Likewise.
	* gas/i386/x86-64-nops-3.d: Likewise.
	* gas/i386/x86-64-nops-4-core2.d: Likewise.
	* gas/i386/x86-64-nops-4.d: Likewise.
	* gas/i386/x86-64-nops-5-k8.d: Likewise.
	* gas/i386/x86-64-nops-5.d: Likewise.
	* gas/i386/x86-64-rep.d: Likewise.
	* gas/i386/x86-64-stack-intel.d: Likewise.
	* gas/i386/x86-64-stack-suffix.d: Likewise.
	* gas/i386/x86-64-stack.d: Likewise.

ld/testsuite/

2009-11-13  H.J. Lu  <hongjiu.lu@@intel.com>

	* ld-x86-64/tlsbin.dd: Updated for prefix processing.
	* ld-x86-64/tlsgdesc.dd: Likewise.
	* ld-x86-64/tlsld1.dd: Likewise.
	* ld-x86-64/tlspic.dd: Likewise.

opcodes/

2009-11-13  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (ckprefix): Updated to return 0 if number of
	prefixes > 14 and record the last position for each prefix.
	(lock_prefix): Removed.
	(data_prefix): Likewise.
	(addr_prefix): Likewise.
	(repz_prefix): Likewise.
	(repnz_prefix): Likewise.
	(last_lock_prefix): New.
	(last_repz_prefix): Likewise.
	(last_repnz_prefix): Likewise.
	(last_data_prefix): Likewise.
	(last_addr_prefix): Likewise.
	(last_rex_prefix): Likewise.
	(last_seg_prefix): Likewise.
	(MAX_CODE_LENGTH): Likewise.
	(ADDR16_PREFIX): Likewise.
	(ADDR32_PREFIX): Likewise.
	(DATA16_PREFIX): Likewise.
	(DATA32_PREFIX): Likewise.
	(REP_PREFIX): Likewise.
	(seg_prefix): Likewise.
	(all_prefixes): Change size to MAX_CODE_LENGTH - 1.
	(prefix_name): Handle ADDR16_PREFIX, ADDR32_PREFIX,
	DATA16_PREFIX, DATA32_PREFIX and REP_PREFIX.
	(get_valid_dis386): Updated.
	(OP_C): Likewise.
	(OP_Monitor): Likewise.
	(REP_Fixup): Likewise.
	(print_insn): Display all prefixes.
	(putop): Set PREFIX_DATA on used_prefixes only if it is used.
	(intel_operand_size): Likewise.
	(OP_E_register): Likewise.
	(OP_G): Likewise.
	(OP_REG): Likewise.
	(OP_IMREG): Likewise.
	(OP_I): Likewise.
	(OP_I64): Likewise.
	(OP_sI): Likewise.
	(CRC32_Fixup): Likewise.
	(MOVBE_Fixup): Likewise.
	(OP_E_memory): Set REFIX_DATA on used_prefixes when it is used
	in 16bit mode.
	(OP_J): Set REX_W used if it is used. Set PREFIX_DATA on
	used_prefixes only if it is used.
@
text
@d10494 1
a10494 1
  if ((rex ^ rex_used) == 0)
@


1.209
log
@gas/testsuite/

2009-11-11  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/prefix.d: Swap order of ADDR and REP prefixes.
	* gas/i386/rep.d: Likewise.
	* gas/i386/x86-64-rep.d: Likewise.

opcodes/

2009-11-11  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (all_prefixes): New.
	(ckprefix): Set all_prefixes.
	(print_insn): Print all_prefixes instead of lock_prefix,
	repz_prefix, repnz_prefix, addr_prefix and data_prefix.
@
text
@a44 3
static int fetch_data (struct disassemble_info *, bfd_byte *);
static void ckprefix (void);
static const char *prefix_name (int, int);
d1992 11
a2002 6
static const char *lock_prefix;
static const char *data_prefix;
static const char *addr_prefix;
static const char *repz_prefix;
static const char *repnz_prefix;
static const char **all_prefixes[5];
d9575 9
a9583 1
static void
d9586 1
a9586 1
  int newrex, i;
d9593 7
d9603 3
a9605 1
  while (1)
d9628 5
a9632 4
	    if (address_mode == mode_64bit)
	      newrex = *codep;
	    else
	      return;
a9634 5
	  if ((prefixes & PREFIX_REPZ) == 0)
	    {
	      all_prefixes[i] = &repz_prefix;
	      i++;
	    }
d9636 1
a9638 5
	  if ((prefixes & PREFIX_REPNZ) == 0)
	    {
	      all_prefixes[i] = &repnz_prefix;
	      i++;
	    }
d9640 1
a9642 5
	  if ((prefixes & PREFIX_LOCK) == 0)
	    {
	      all_prefixes[i] = &lock_prefix;
	      i++;
	    }
d9644 1
d9648 1
d9652 1
d9656 1
d9660 1
d9664 1
d9668 1
a9670 5
	  if ((prefixes & PREFIX_DATA) == 0)
	    {
	      all_prefixes[i] = &data_prefix;
	      i++;
	    }
d9672 1
a9674 5
	  if ((prefixes & PREFIX_ADDR) == 0)
	    {
	      all_prefixes[i] = &addr_prefix;
	      i++;
	    }
d9676 1
d9686 1
a9686 1
	      return;
d9691 1
a9691 1
	  return;
d9697 1
a9697 1
	  return;
d9699 2
d9704 24
d9804 10
d9948 1
a9948 1
	      repz_prefix = NULL;
d9958 1
a9958 1
		  repnz_prefix = NULL;
d9966 1
a9966 1
		      data_prefix = NULL;
d10187 2
a10188 2
  char prefix_obuf[32];
  char *prefix_obufp;
d10360 12
a10371 1
  ckprefix ();
a10373 1
  sizeflag = priv.orig_sizeflag;
d10379 1
a10379 2
       && ((*codep < 0xd8) || (*codep > 0xdf)))
      || (rex && rex_used))
d10381 1
a10381 8
      const char *name;

      /* fwait not followed by floating point instruction, or rex followed
	 by other prefixes.  Print the first prefix.  */
      name = prefix_name (priv.the_buffer[0], priv.orig_sizeflag);
      if (name == NULL)
	name = INTERNAL_DISASSEMBLER_ERROR;
      (*info->fprintf_func) (info->stream, "%s", name);
d10404 1
a10404 7
    {
      repz_prefix = "repz ";
      used_prefixes |= PREFIX_REPZ;
    }
  else
    repz_prefix = NULL;

d10406 1
a10406 7
    {
      repnz_prefix = "repnz ";
      used_prefixes |= PREFIX_REPNZ;
    }
  else
    repnz_prefix = NULL;

d10408 1
a10408 6
    {
      lock_prefix = "lock ";
      used_prefixes |= PREFIX_LOCK;
    }
  else
    lock_prefix = NULL;
d10410 1
a10410 1
  addr_prefix = NULL;
d10417 1
a10417 1
	    addr_prefix = "addr32 ";
d10419 2
a10420 2
	    addr_prefix = "addr16 ";
	  used_prefixes |= PREFIX_ADDR;
a10423 1
  data_prefix = NULL;
d10432 1
a10432 1
	    data_prefix = "data32 ";
d10434 7
a10440 2
	    data_prefix = "data16 ";
	  used_prefixes |= PREFIX_DATA;
d10479 1
a10479 1
  if ((prefixes & ~used_prefixes) != 0)
d10481 27
a10507 1
      const char *name;
d10509 4
a10512 14
      name = prefix_name (priv.the_buffer[0], priv.orig_sizeflag);
      if (name == NULL)
	name = INTERNAL_DISASSEMBLER_ERROR;
      (*info->fprintf_func) (info->stream, "%s", name);
      return 1;
    }
  if ((rex_original & ~rex_used) || rex_ignored)
    {
      const char *name;
      name = prefix_name (rex_original, priv.orig_sizeflag);
      if (name == NULL)
	name = INTERNAL_DISASSEMBLER_ERROR;
      (*info->fprintf_func) (info->stream, "%s ", name);
    }
d10514 1
a10514 2
  prefix_obuf[0] = 0;
  prefix_obufp = prefix_obuf;
d10516 9
a10524 2
    if (all_prefixes[i] && *all_prefixes[i])
      prefix_obufp = stpcpy (prefix_obufp, *all_prefixes[i]);
d10526 6
a10531 2
  if (prefix_obuf[0] != 0)
    (*info->fprintf_func) (info->stream, "%s", prefix_obuf);
d10534 1
a10534 1
  for (i = strlen (obuf) + strlen (prefix_obuf); i < 6; i++)
a11072 2
	      else if (sizeflag & DFLAG)
		*obufp++ = intel_syntax ? 'd' : 'l';
d11074 7
a11080 2
		*obufp++ = 'w';
	      used_prefixes |= (prefixes & PREFIX_DATA);
d11215 1
a11216 1
	      used_prefixes |= (prefixes & PREFIX_DATA);
d11247 1
a11248 1
		  used_prefixes |= (prefixes & PREFIX_DATA);
a11373 2
	  else if (prefixes & PREFIX_DATA)
	    *obufp++ = 'd';
d11375 7
a11381 2
	    *obufp++ = 's';
	  used_prefixes |= (prefixes & PREFIX_DATA);
a11626 1
	  used_prefixes |= (prefixes & PREFIX_DATA);
a11635 2
      else if ((sizeflag & DFLAG) || bytemode == dq_mode)
	oappend ("DWORD PTR ");
d11637 7
a11643 2
	oappend ("WORD PTR ");
      used_prefixes |= (prefixes & PREFIX_DATA);
a11794 1
	  used_prefixes |= (prefixes & PREFIX_DATA);
a11807 4
      else if ((sizeflag & DFLAG) 
	       || (bytemode != v_mode
		   && bytemode != v_swap_mode))
	names = names32;
d11809 9
a11817 2
	names = names16;
      used_prefixes |= (prefixes & PREFIX_DATA);
d12006 3
a12008 1
    { /* 16 bit address mode */
a12134 2
      else if ((sizeflag & DFLAG) || bytemode != v_mode)
	oappend (names32[modrm.reg + add]);
d12136 7
a12142 2
	oappend (names16[modrm.reg + add]);
      used_prefixes |= (prefixes & PREFIX_DATA);
a12280 2
      else if (sizeflag & DFLAG)
	s = names32[code - eAX_reg + add];
d12282 7
a12288 2
	s = names16[code - eAX_reg + add];
      used_prefixes |= (prefixes & PREFIX_DATA);
a12330 2
      else if (sizeflag & DFLAG)
	s = names32[code - eAX_reg];
d12332 7
a12338 2
	s = names16[code - eAX_reg];
      used_prefixes |= (prefixes & PREFIX_DATA);
a12378 5
      else if (sizeflag & DFLAG)
	{
	  op = get32 ();
	  mask = 0xffffffff;
	}
d12381 11
a12391 2
	  op = get16 ();
	  mask = 0xfffff;
a12392 1
      used_prefixes |= (prefixes & PREFIX_DATA);
a12436 5
      else if (sizeflag & DFLAG)
	{
	  op = get32 ();
	  mask = 0xffffffff;
	}
d12439 11
a12449 2
	  op = get16 ();
	  mask = 0xfffff;
a12450 1
      used_prefixes |= (prefixes & PREFIX_DATA);
a12486 5
      else if (sizeflag & DFLAG)
	{
	  op = get32s ();
	  mask = 0xffffffff;
	}
d12489 13
a12501 4
	  mask = 0xffffffff;
	  op = get16 ();
	  if ((op & 0x8000) != 0)
	    op -= 0x10000;
a12502 1
      used_prefixes |= (prefixes & PREFIX_DATA);
d12536 1
d12553 2
a12554 1
      used_prefixes |= (prefixes & PREFIX_DATA);
d12745 1
a12745 1
      lock_prefix = NULL;
d13184 1
a13184 1
	  addr_prefix = NULL;
d13213 1
a13213 1
    repz_prefix = "rep ";
d13291 8
a13298 5
      else if (sizeflag & DFLAG)
	*p++ = 'l';
      else
	*p++ = 'w';
      used_prefixes |= (prefixes & PREFIX_DATA);
a13730 2
	  else if (sizeflag & DFLAG)
	    *p++ = 'l';
d13732 7
a13738 1
	    *p++ = 'w';
a13739 1
      used_prefixes |= (prefixes & PREFIX_DATA);
@


1.208
log
@2009-11-06  Sebastian Pop  <sebastian.pop@@amd.com>

	* opcodes/i386-dis.c (reg_table): Add XOP_8F_TABLE (XOP_09) to
	reg_table[REG_8F][1]: for XOP instructions, ModRM.reg first points to
	B.mm in the RXB.mmmmm byte, and so when B is set, we still should use
	the xop_table.
	(get_valid_dis386): Removed unused condition (from cut/n/paste) for
	XOP instructions.

	* gas/testsuite/gas/i386/x86-64-lwp.s: Updated to also contain
	patterns with r[8-15] registers.
	* gas/testsuite/gas/i386/x86-64-lwp.d: Same.
@
text
@d2000 1
d9576 1
a9576 1
  int newrex;
d9583 3
d9615 5
d9623 5
d9631 5
d9657 5
d9665 5
d10469 3
a10471 10
  if (lock_prefix)
    prefix_obufp = stpcpy (prefix_obufp, lock_prefix);
  if (repz_prefix)
    prefix_obufp = stpcpy (prefix_obufp, repz_prefix);
  if (repnz_prefix)
    prefix_obufp = stpcpy (prefix_obufp, repnz_prefix);
  if (addr_prefix)
    prefix_obufp = stpcpy (prefix_obufp, addr_prefix);
  if (data_prefix)
    prefix_obufp = stpcpy (prefix_obufp, data_prefix);
@


1.207
log
@2009-11-05  Sebastian Pop  <sebastian.pop@@amd.com>
	    Quentin Neill  <quentin.neill@@amd.com>

	* gas/config/tc-i386.c (cpu_arch): Add CPU_LWP_FLAGS.
	(build_vex_prefix): Handle xop09 and xop0a.
	(build_modrm_byte): Handle vexlwp.
	(md_show_usage): Add lwp.
	* gas/doc/c-i386.texi (i386-LWP): New section.

	* gas/testsuite/gas/i386/i386.exp: Run x86-64-lwp in 64-bit mode,
	run lwp in 32-bit mode.
	* gas/testsuite/gas/i386/x86-64-lwp.d: New.
	* gas/testsuite/gas/i386/x86-64-lwp.s: New.
	* gas/testsuite/gas/i386/lwp.d: New.
	* gas/testsuite/gas/i386/lwp.s: New.

	* opcodes/i386-dis.c (OP_LWPCB_E): New.
	(OP_LWP_E): New.
	(OP_LWP_I): New.
	(USE_XOP_8F_TABLE): New.
	(XOP_8F_TABLE): New.
	(REG_XOP_LWPCB): New.
	(REG_XOP_LWP): New.
	(XOP_09): New.
	(XOP_0A): New.
	(reg_table): Redirect REG_8F to XOP_8F_TABLE.
	Add entries for REG_XOP_LWPCB and REG_XOP_LWP.
	(xop_table): New.
	(get_valid_dis386): Handle USE_XOP_8F_TABLE.
	Use the offsets VEX_0F, VEX_0F38, and VEX_0F3A instead of their values
	to access to the vex_table.
	(OP_LWPCB_E): New.
	(OP_LWP_E): New.
	(OP_LWP_I): New.
	* opcodes/i386-gen.c (cpu_flag_init): Add CPU_LWP_FLAGS, CpuLWP.
	(cpu_flags): Add CpuLWP.
	(opcode_modifiers): Add VexLWP, XOP09, and XOP0A.
	* opcodes/i386-opc.h (CpuLWP): New.
	(i386_cpu_flags): Add bit cpulwp.
	(VexLWP): New.
	(XOP09): New.
	(XOP0A): New.
	(i386_opcode_modifier): Add vexlwp, xop09, and xop0a.
	* opcodes/i386-opc.tbl (llwpcb): Added.
	(lwpval): Added.
	(lwpins): Added.
@
text
@d2135 1
a2135 1
    { "(bad)",	{ XX } },
d9986 5
a9990 8
      /* There is no MODRM byte for VEX [82|77].  */
      if (index != 0x77 && index != 0x82)
	{
	  FETCH_DATA (info, codep + 1);
	  modrm.mod = (*codep >> 6) & 3;
	  modrm.reg = (*codep >> 3) & 7;
	  modrm.rm = *codep & 7;
	}
@


1.206
log
@gas/

2009-10-29  Sebastian Pop  <sebastian.pop@@amd.com>

	* config/tc-i386.c (build_modrm_byte): Do not swap REG and
	NDS operands for FMA4.

gas/testsuite/

2009-10-29  Sebastian Pop  <sebastian.pop@@amd.com>

	* gas/i386/fma4.d: Updated patterns.
	* gas/i386/x86-64-fma4.d: Same.

opcodes/

2009-10-29  Sebastian Pop  <sebastian.pop@@amd.com>

	* i386-dis.c (OP_VEX_FMA): Removed.
	(VexFMA): Removed.
	(Vex128FMA): Removed.
	(prefix_table): First source operand of FMA4 insns is decoded
	with Vex not with VexFMA.
	(OP_EX_VexW): Second source operand is decoded with get_vex_imm8
	when vex.w is set.  Third source operand is decoded with
	get_vex_imm8 when vex.w is cleared.
	(OP_VEX_FMA): Removed.
@
text
@d117 3
d520 1
d535 1
d573 3
a575 1
  REG_VEX_AE
d1080 6
d2139 1
a2139 1
    { "(bad)",	{ XX } },
d2451 22
d5520 611
a6130 1
    { "pmulhrsw",	{ MX, EM } },
d6135 1
a6135 2
    /* 10 */
    { PREFIX_TABLE (PREFIX_0F3810) },
a6138 2
    { PREFIX_TABLE (PREFIX_0F3814) },
    { PREFIX_TABLE (PREFIX_0F3815) },
a6139 2
    { PREFIX_TABLE (PREFIX_0F3817) },
    /* 18 */
d6144 1
a6144 3
    { "pabsb",		{ MX, EM } },
    { "pabsw",		{ MX, EM } },
    { "pabsd",		{ MX, EM } },
a6145 7
    /* 20 */
    { PREFIX_TABLE (PREFIX_0F3820) },
    { PREFIX_TABLE (PREFIX_0F3821) },
    { PREFIX_TABLE (PREFIX_0F3822) },
    { PREFIX_TABLE (PREFIX_0F3823) },
    { PREFIX_TABLE (PREFIX_0F3824) },
    { PREFIX_TABLE (PREFIX_0F3825) },
a6147 5
    /* 28 */
    { PREFIX_TABLE (PREFIX_0F3828) },
    { PREFIX_TABLE (PREFIX_0F3829) },
    { PREFIX_TABLE (PREFIX_0F382A) },
    { PREFIX_TABLE (PREFIX_0F382B) },
a6151 7
    /* 30 */
    { PREFIX_TABLE (PREFIX_0F3830) },
    { PREFIX_TABLE (PREFIX_0F3831) },
    { PREFIX_TABLE (PREFIX_0F3832) },
    { PREFIX_TABLE (PREFIX_0F3833) },
    { PREFIX_TABLE (PREFIX_0F3834) },
    { PREFIX_TABLE (PREFIX_0F3835) },
a6152 1
    { PREFIX_TABLE (PREFIX_0F3837) },
a6153 11
    { PREFIX_TABLE (PREFIX_0F3838) },
    { PREFIX_TABLE (PREFIX_0F3839) },
    { PREFIX_TABLE (PREFIX_0F383A) },
    { PREFIX_TABLE (PREFIX_0F383B) },
    { PREFIX_TABLE (PREFIX_0F383C) },
    { PREFIX_TABLE (PREFIX_0F383D) },
    { PREFIX_TABLE (PREFIX_0F383E) },
    { PREFIX_TABLE (PREFIX_0F383F) },
    /* 40 */
    { PREFIX_TABLE (PREFIX_0F3840) },
    { PREFIX_TABLE (PREFIX_0F3841) },
a6159 1
    /* 48 */
d6162 1
d6164 3
d6169 3
d6175 1
a6175 2
    /* 50 */
    { "(bad)",		{ XX } },
d6180 1
d6182 3
d6187 2
d6193 1
a6193 1
    { "(bad)",		{ XX } },
d6200 3
a6202 3
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6235 2
a6236 2
    { PREFIX_TABLE (PREFIX_0F3880) },
    { PREFIX_TABLE (PREFIX_0F3881) },
d6337 5
a6341 5
    { PREFIX_TABLE (PREFIX_0F38DB) },
    { PREFIX_TABLE (PREFIX_0F38DC) },
    { PREFIX_TABLE (PREFIX_0F38DD) },
    { PREFIX_TABLE (PREFIX_0F38DE) },
    { PREFIX_TABLE (PREFIX_0F38DF) },
d6361 2
a6362 2
    { PREFIX_TABLE (PREFIX_0F38F0) },
    { PREFIX_TABLE (PREFIX_0F38F1) },
d6379 4
a6382 1
  /* THREE_BYTE_0F3A */
d6394 8
a6401 8
    { PREFIX_TABLE (PREFIX_0F3A08) },
    { PREFIX_TABLE (PREFIX_0F3A09) },
    { PREFIX_TABLE (PREFIX_0F3A0A) },
    { PREFIX_TABLE (PREFIX_0F3A0B) },
    { PREFIX_TABLE (PREFIX_0F3A0C) },
    { PREFIX_TABLE (PREFIX_0F3A0D) },
    { PREFIX_TABLE (PREFIX_0F3A0E) },
    { "palignr",	{ MX, EM, Ib } },
d6405 4
a6410 4
    { PREFIX_TABLE (PREFIX_0F3A14) },
    { PREFIX_TABLE (PREFIX_0F3A15) },
    { PREFIX_TABLE (PREFIX_0F3A16) },
    { PREFIX_TABLE (PREFIX_0F3A17) },
d6421 3
a6423 3
    { PREFIX_TABLE (PREFIX_0F3A20) },
    { PREFIX_TABLE (PREFIX_0F3A21) },
    { PREFIX_TABLE (PREFIX_0F3A22) },
a6456 3
    { PREFIX_TABLE (PREFIX_0F3A40) },
    { PREFIX_TABLE (PREFIX_0F3A41) },
    { PREFIX_TABLE (PREFIX_0F3A42) },
d6458 4
a6461 1
    { PREFIX_TABLE (PREFIX_0F3A44) },
d6493 4
a6496 4
    { PREFIX_TABLE (PREFIX_0F3A60) },
    { PREFIX_TABLE (PREFIX_0F3A61) },
    { PREFIX_TABLE (PREFIX_0F3A62) },
    { PREFIX_TABLE (PREFIX_0F3A63) },
d6635 1
a6635 1
    { PREFIX_TABLE (PREFIX_0F3ADF) },
d6673 1
a6673 2

  /* THREE_BYTE_0F7A */
d6696 1
a6696 1
    { "(bad)",		{ XX } },
d6712 1
a6712 1
    { "ptest",		{ XX } },
a6748 3
    { "phaddbw",	{ XM, EXq } },
    { "phaddbd",	{ XM, EXq } },
    { "phaddbq",	{ XM, EXq } },
d6751 5
a6755 2
    { "phaddwd",	{ XM, EXq } },
    { "phaddwq",	{ XM, EXq } },
d6760 1
a6760 1
    { "phadddq",	{ XM, EXq } },
a6766 3
    { "phaddubw",	{ XM, EXq } },
    { "phaddubd",	{ XM, EXq } },
    { "phaddubq",	{ XM, EXq } },
d6769 5
a6773 2
    { "phadduwd",	{ XM, EXq } },
    { "phadduwq",	{ XM, EXq } },
d6778 1
a6778 1
    { "phaddudq",	{ XM, EXq } },
d6785 3
a6787 3
    { "phsubbw",	{ XM, EXq } },
    { "phsubbd",	{ XM, EXq } },
    { "phsubbq",	{ XM, EXq } },
a6965 1

d9937 59
d10006 1
a10006 1
	  vex_table_index = 0;
d10009 1
a10009 1
	  vex_table_index = 1;
d10012 1
a10012 1
	  vex_table_index = 2;
d13637 50
@


1.205
log
@gas/

2009-10-20  H.J. Lu  <hongjiu.lu@@intel.com>

	PR gas/10775
	* doc/c-i386.texi: Mention movabs.

gas/testsuite/

2009-10-20  H.J. Lu  <hongjiu.lu@@intel.com>

	PR gas/10775
	* gas/i386/immed64.d: Updated.
	* gas/i386/l1om.d: Likewise.
	* gas/i386/x86-64-disp-intel.d: Likewise.
	* gas/i386/x86-64-disp.d: Likewise.
	* gas/i386/x86_64.d: Likewise.

opcodes/

2009-10-20  H.J. Lu  <hongjiu.lu@@intel.com>

	PR gas/10775
	* i386-dis.c: Document LB, LS and LV macros.
	(dis386): Use mov%LB, mov%LS and mov%LV on mov instruction
	with the 64-bit displacement or immediate operand.
	(putop): Handle LB, LS and LV macros.
@
text
@a95 1
static void OP_VEX_FMA (int, int);
a364 2
#define VexFMA { OP_VEX_FMA, vex_mode }
#define Vex128FMA { OP_VEX_FMA, vex128_mode }
d5101 1
a5101 1
    { "vfmaddsubps", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5109 1
a5109 1
    { "vfmaddsubpd", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5117 1
a5117 1
    { "vfmsubaddps", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5125 1
a5125 1
    { "vfmsubaddpd", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5165 1
a5165 1
    { "vfmaddps", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5173 1
a5173 1
    { "vfmaddpd", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5197 1
a5197 1
    { "vfmsubps", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5205 1
a5205 1
    { "vfmsubpd", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5229 1
a5229 1
    { "vfnmaddps", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5237 1
a5237 1
    { "vfnmaddpd", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5261 1
a5261 1
    { "vfnmsubps", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5269 1
a5269 1
    { "vfnmsubpd", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d8384 1
a8384 1
    { "vfmaddss",	{ XMVexW, Vex128FMA, EXdVexW, EXdVexW, VexI4 } },
d8390 1
a8390 1
    { "vfmaddsd",	{ XMVexW, Vex128FMA, EXqVexW, EXqVexW, VexI4 } },
d8396 1
a8396 1
    { "vfmsubss",	{ XMVexW, Vex128FMA, EXdVexW, EXdVexW, VexI4 } },
d8402 1
a8402 1
    { "vfmsubsd",	{ XMVexW, Vex128FMA, EXqVexW, EXqVexW, VexI4 } },
d8408 1
a8408 1
    { "vfnmaddss",	{ XMVexW, Vex128FMA, EXdVexW, EXdVexW, VexI4 } },
d8414 1
a8414 1
    { "vfnmaddsd",	{ XMVexW, Vex128FMA, EXqVexW, EXqVexW, VexI4 } },
d8420 1
a8420 1
    { "vfnmsubss",	{ XMVexW, Vex128FMA, EXdVexW, EXdVexW, VexI4 } },
d8426 1
a8426 1
    { "vfnmsubsd",	{ XMVexW, Vex128FMA, EXqVexW, EXqVexW, VexI4 } },
d12713 1
a12713 1
	reg = vex.register_specifier;
d12718 1
a12718 1
	reg = vex.register_specifier;
a12724 41
OP_VEX_FMA (int bytemode, int sizeflag)
{
  int reg = get_vex_imm8 (sizeflag) >> 4;

  if (reg > 7 && address_mode != mode_64bit)
    BadOp ();

  switch (vex.length)
    {
    case 128:
      switch (bytemode)
	{
	case vex_mode:
	case vex128_mode:
	  break;
	default:
	  abort ();
	  return;
	}

      sprintf (scratchbuf, "%%xmm%d", reg);
      break;
    case 256:
      switch (bytemode)
	{
	case vex_mode:
	  break;
	default:
	  abort ();
	  return;
	}

      sprintf (scratchbuf, "%%ymm%d", reg);
      break;
    default:
      abort ();
    }
  oappend (scratchbuf + intel_syntax);
}

static void
@


1.204
log
@2009-10-16  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c: Simplify enums.
@
text
@d1337 2
a1338 2
   'XW' => print 's', 'd' depending on the VEX.W bit (for FMA)
   'LQ' => print 'l' ('d' in Intel mode) or 'q' for memory operand
d1340 3
d1532 4
a1535 4
  { "movB",		{ AL, Ob } },
  { "movS",		{ eAX, Ov } },
  { "movB",		{ Ob, AL } },
  { "movS",		{ Ov, eAX } },
d1559 8
a1566 8
  { "movS",		{ RMeAX, Iv64 } },
  { "movS",		{ RMeCX, Iv64 } },
  { "movS",		{ RMeDX, Iv64 } },
  { "movS",		{ RMeBX, Iv64 } },
  { "movS",		{ RMeSP, Iv64 } },
  { "movS",		{ RMeBP, Iv64 } },
  { "movS",		{ RMeSI, Iv64 } },
  { "movS",		{ RMeDI, Iv64 } },
d10273 28
a10300 4
	  if (intel_syntax)
	    break;
	  if (sizeflag & SUFFIX_ALWAYS)
	    *obufp++ = 'b';
d10536 12
a10547 3
	  if (intel_syntax)
	    break;
	  if (address_mode == mode_64bit && (sizeflag & DFLAG))
d10549 14
a10562 3
	      if (sizeflag & SUFFIX_ALWAYS)
		*obufp++ = 'q';
	      break;
d10565 1
d10567 1
a10567 3
	  if (intel_syntax)
	    break;
	  if (sizeflag & SUFFIX_ALWAYS)
d10569 4
a10572 3
	      if (rex & REX_W)
		*obufp++ = 'q';
	      else
d10574 2
a10575 2
		  if (sizeflag & DFLAG)
		    *obufp++ = 'l';
d10577 25
a10601 2
		    *obufp++ = 'w';
		  used_prefixes |= (prefixes & PREFIX_DATA);
d10603 2
@


1.203
log
@2009-10-15  H.J. Lu  <hongjiu.lu@@intel.com>
	    Ineiev <ineiev@@gmail.com>

	PR binutils/10767
	* i386-dis.c: Use enum instead of nested macros.
@
text
@d405 1
a405 1
  b_swap_mode = b_mode + 1,
d407 1
a407 1
  v_mode = b_swap_mode + 1,
d409 1
a409 1
  v_swap_mode = v_mode + 1,
d411 1
a411 1
  w_mode = v_swap_mode + 1,
d413 1
a413 1
  d_mode = w_mode + 1,
d415 1
a415 1
  d_swap_mode = d_mode + 1,
d417 1
a417 1
  q_mode = d_swap_mode + 1,
d419 1
a419 1
  q_swap_mode = q_mode + 1,
d421 1
a421 1
  t_mode = q_swap_mode + 1,
d423 1
a423 1
  x_mode = t_mode + 1,
d425 1
a425 1
  x_swap_mode = x_mode + 1,
d427 1
a427 1
  xmm_mode = x_swap_mode + 1,
d429 1
a429 1
  xmmq_mode = xmm_mode + 1,
d431 1
a431 1
  ymmq_mode = xmmq_mode + 1,
d433 1
a433 1
  m_mode = ymmq_mode + 1,
d435 3
a437 3
  a_mode = m_mode + 1,
  cond_jump_mode = a_mode + 1,
  loop_jcxz_mode = cond_jump_mode + 1,
d439 1
a439 1
  dq_mode = loop_jcxz_mode + 1,
d441 1
a441 1
  dqw_mode = dq_mode + 1,
d443 2
a444 2
  f_mode = dqw_mode + 1,
  const_1_mode = f_mode + 1,
d446 1
a446 1
  stack_v_mode = const_1_mode + 1,
d448 1
a448 1
  z_mode = stack_v_mode + 1,
d450 1
a450 1
  o_mode = z_mode + 1,
d452 1
a452 1
  dqb_mode = o_mode + 1,
d454 1
a454 1
  dqd_mode = dqb_mode + 1,
d456 1
a456 1
  vex_mode = dqd_mode + 1,
d458 1
a458 1
  vex128_mode = vex_mode + 1,
d460 1
a460 1
  vex256_mode = vex128_mode + 1,
d462 1
a462 1
  vex_w_dq_mode = vex256_mode + 1,
d464 42
a505 42
  es_reg = vex_w_dq_mode + 1,
  cs_reg = es_reg + 1,
  ss_reg = cs_reg + 1,
  ds_reg = ss_reg + 1,
  fs_reg = ds_reg + 1,
  gs_reg = fs_reg + 1,

  eAX_reg = gs_reg + 1,
  eCX_reg = eAX_reg + 1,
  eDX_reg = eCX_reg + 1,
  eBX_reg = eDX_reg + 1,
  eSP_reg = eBX_reg + 1,
  eBP_reg = eSP_reg + 1,
  eSI_reg = eBP_reg + 1,
  eDI_reg = eSI_reg + 1,

  al_reg = eDI_reg + 1,
  cl_reg = al_reg + 1,
  dl_reg = cl_reg + 1,
  bl_reg = dl_reg + 1,
  ah_reg = bl_reg + 1,
  ch_reg = ah_reg + 1,
  dh_reg = ch_reg + 1,
  bh_reg = dh_reg + 1,

  ax_reg = bh_reg + 1,
  cx_reg = ax_reg + 1,
  dx_reg = cx_reg + 1,
  bx_reg = dx_reg + 1,
  sp_reg = bx_reg + 1,
  bp_reg = sp_reg + 1,
  si_reg = bp_reg + 1,
  di_reg = si_reg + 1,

  rAX_reg = di_reg + 1,
  rCX_reg = rAX_reg + 1,
  rDX_reg = rCX_reg + 1,
  rBX_reg = rDX_reg + 1,
  rSP_reg = rBX_reg + 1,
  rBP_reg = rSP_reg + 1,
  rSI_reg = rBP_reg + 1,
  rDI_reg = rSI_reg + 1,
d507 2
a508 2
  z_mode_ax_reg = rDI_reg + 1,
  indir_dx_reg = z_mode_ax_reg + 1
d514 9
a522 9
  USE_REG_TABLE = FLOATCODE + 1,
  USE_MOD_TABLE = USE_REG_TABLE + 1,
  USE_RM_TABLE = USE_MOD_TABLE + 1,
  USE_PREFIX_TABLE = USE_RM_TABLE + 1,
  USE_X86_64_TABLE = USE_PREFIX_TABLE + 1,
  USE_3BYTE_TABLE = USE_X86_64_TABLE + 1,
  USE_VEX_C4_TABLE = USE_3BYTE_TABLE + 1,
  USE_VEX_C5_TABLE = USE_VEX_C4_TABLE + 1,
  USE_VEX_LEN_TABLE = USE_VEX_C5_TABLE + 1
d541 31
a571 31
  REG_81 = REG_80 + 1,
  REG_82 = REG_81 + 1,
  REG_8F = REG_82 + 1,
  REG_C0 = REG_8F + 1,
  REG_C1 = REG_C0 + 1,
  REG_C6 = REG_C1 + 1,
  REG_C7 = REG_C6 + 1,
  REG_D0 = REG_C7 + 1,
  REG_D1 = REG_D0 + 1,
  REG_D2 = REG_D1 + 1,
  REG_D3 = REG_D2 + 1,
  REG_F6 = REG_D3 + 1,
  REG_F7 = REG_F6 + 1,
  REG_FE = REG_F7 + 1,
  REG_FF = REG_FE + 1,
  REG_0F00 = REG_FF + 1,
  REG_0F01 = REG_0F00 + 1,
  REG_0F0D = REG_0F01 + 1,
  REG_0F18 = REG_0F0D + 1,
  REG_0F71 = REG_0F18 + 1,
  REG_0F72 = REG_0F71 + 1,
  REG_0F73 = REG_0F72 + 1,
  REG_0FA6 = REG_0F73 + 1,
  REG_0FA7 = REG_0FA6 + 1,
  REG_0FAE = REG_0FA7 + 1,
  REG_0FBA = REG_0FAE + 1,
  REG_0FC7 = REG_0FBA + 1,
  REG_VEX_71 = REG_0FC7 + 1,
  REG_VEX_72 = REG_VEX_71 + 1,
  REG_VEX_73 = REG_VEX_72 + 1,
  REG_VEX_AE = REG_VEX_73 + 1
d577 83
a659 83
  MOD_0F01_REG_0 = MOD_8D + 1,
  MOD_0F01_REG_1 = MOD_0F01_REG_0 + 1,
  MOD_0F01_REG_2 = MOD_0F01_REG_1 + 1,
  MOD_0F01_REG_3 = MOD_0F01_REG_2 + 1,
  MOD_0F01_REG_7 = MOD_0F01_REG_3 + 1,
  MOD_0F12_PREFIX_0 = MOD_0F01_REG_7 + 1,
  MOD_0F13 = MOD_0F12_PREFIX_0 + 1,
  MOD_0F16_PREFIX_0 = MOD_0F13 + 1,
  MOD_0F17 = MOD_0F16_PREFIX_0 + 1,
  MOD_0F18_REG_0 = MOD_0F17 + 1,
  MOD_0F18_REG_1 = MOD_0F18_REG_0 + 1,
  MOD_0F18_REG_2 = MOD_0F18_REG_1 + 1,
  MOD_0F18_REG_3 = MOD_0F18_REG_2 + 1,
  MOD_0F20 = MOD_0F18_REG_3 + 1,
  MOD_0F21 = MOD_0F20 + 1,
  MOD_0F22 = MOD_0F21 + 1,
  MOD_0F23 = MOD_0F22 + 1,
  MOD_0F24 = MOD_0F23 + 1,
  MOD_0F26 = MOD_0F24 + 1,
  MOD_0F2B_PREFIX_0 = MOD_0F26 + 1,
  MOD_0F2B_PREFIX_1 = MOD_0F2B_PREFIX_0 + 1,
  MOD_0F2B_PREFIX_2 = MOD_0F2B_PREFIX_1 + 1,
  MOD_0F2B_PREFIX_3 = MOD_0F2B_PREFIX_2 + 1,
  MOD_0F51 = MOD_0F2B_PREFIX_3 + 1,
  MOD_0F71_REG_2 = MOD_0F51 + 1,
  MOD_0F71_REG_4 = MOD_0F71_REG_2 + 1,
  MOD_0F71_REG_6 = MOD_0F71_REG_4 + 1,
  MOD_0F72_REG_2 = MOD_0F71_REG_6 + 1,
  MOD_0F72_REG_4 = MOD_0F72_REG_2 + 1,
  MOD_0F72_REG_6 = MOD_0F72_REG_4 + 1,
  MOD_0F73_REG_2 = MOD_0F72_REG_6 + 1,
  MOD_0F73_REG_3 = MOD_0F73_REG_2 + 1,
  MOD_0F73_REG_6 = MOD_0F73_REG_3 + 1,
  MOD_0F73_REG_7 = MOD_0F73_REG_6 + 1,
  MOD_0FAE_REG_0 = MOD_0F73_REG_7 + 1,
  MOD_0FAE_REG_1 = MOD_0FAE_REG_0 + 1,
  MOD_0FAE_REG_2 = MOD_0FAE_REG_1 + 1,
  MOD_0FAE_REG_3 = MOD_0FAE_REG_2 + 1,
  MOD_0FAE_REG_4 = MOD_0FAE_REG_3 + 1,
  MOD_0FAE_REG_5 = MOD_0FAE_REG_4 + 1,
  MOD_0FAE_REG_6 = MOD_0FAE_REG_5 + 1,
  MOD_0FAE_REG_7 = MOD_0FAE_REG_6 + 1,
  MOD_0FB2 = MOD_0FAE_REG_7 + 1,
  MOD_0FB4 = MOD_0FB2 + 1,
  MOD_0FB5 = MOD_0FB4 + 1,
  MOD_0FC7_REG_6 = MOD_0FB5 + 1,
  MOD_0FC7_REG_7 = MOD_0FC7_REG_6 + 1,
  MOD_0FD7 = MOD_0FC7_REG_7 + 1,
  MOD_0FE7_PREFIX_2 = MOD_0FD7 + 1,
  MOD_0FF0_PREFIX_3 = MOD_0FE7_PREFIX_2 + 1,
  MOD_0F382A_PREFIX_2 = MOD_0FF0_PREFIX_3 + 1,
  MOD_62_32BIT = MOD_0F382A_PREFIX_2 + 1,
  MOD_C4_32BIT = MOD_62_32BIT + 1,
  MOD_C5_32BIT = MOD_C4_32BIT + 1,
  MOD_VEX_12_PREFIX_0 = MOD_C5_32BIT + 1,
  MOD_VEX_13 = MOD_VEX_12_PREFIX_0 + 1,
  MOD_VEX_16_PREFIX_0 = MOD_VEX_13 + 1,
  MOD_VEX_17 = MOD_VEX_16_PREFIX_0 + 1,
  MOD_VEX_2B = MOD_VEX_17 + 1,
  MOD_VEX_51 = MOD_VEX_2B + 1,
  MOD_VEX_71_REG_2 = MOD_VEX_51 + 1,
  MOD_VEX_71_REG_4 = MOD_VEX_71_REG_2 + 1,
  MOD_VEX_71_REG_6 = MOD_VEX_71_REG_4 + 1,
  MOD_VEX_72_REG_2 = MOD_VEX_71_REG_6 + 1,
  MOD_VEX_72_REG_4 = MOD_VEX_72_REG_2 + 1,
  MOD_VEX_72_REG_6 = MOD_VEX_72_REG_4 + 1,
  MOD_VEX_73_REG_2 = MOD_VEX_72_REG_6 + 1,
  MOD_VEX_73_REG_3 = MOD_VEX_73_REG_2 + 1,
  MOD_VEX_73_REG_6 = MOD_VEX_73_REG_3 + 1,
  MOD_VEX_73_REG_7 = MOD_VEX_73_REG_6 + 1,
  MOD_VEX_AE_REG_2 = MOD_VEX_73_REG_7 + 1,
  MOD_VEX_AE_REG_3 = MOD_VEX_AE_REG_2 + 1,
  MOD_VEX_D7_PREFIX_2 = MOD_VEX_AE_REG_3 + 1,
  MOD_VEX_E7_PREFIX_2 = MOD_VEX_D7_PREFIX_2 + 1,
  MOD_VEX_F0_PREFIX_3 = MOD_VEX_E7_PREFIX_2 + 1,
  MOD_VEX_3818_PREFIX_2 = MOD_VEX_F0_PREFIX_3 + 1,
  MOD_VEX_3819_PREFIX_2 = MOD_VEX_3818_PREFIX_2 + 1,
  MOD_VEX_381A_PREFIX_2 = MOD_VEX_3819_PREFIX_2 + 1,
  MOD_VEX_382A_PREFIX_2 = MOD_VEX_381A_PREFIX_2 + 1,
  MOD_VEX_382C_PREFIX_2 = MOD_VEX_382A_PREFIX_2 + 1,
  MOD_VEX_382D_PREFIX_2 = MOD_VEX_382C_PREFIX_2 + 1,
  MOD_VEX_382E_PREFIX_2 = MOD_VEX_382D_PREFIX_2 + 1,
  MOD_VEX_382F_PREFIX_2 = MOD_VEX_382E_PREFIX_2 + 1
d665 7
a671 7
  RM_0F01_REG_1 = RM_0F01_REG_0 + 1,
  RM_0F01_REG_2 = RM_0F01_REG_1 + 1,
  RM_0F01_REG_3 = RM_0F01_REG_2 + 1,
  RM_0F01_REG_7 = RM_0F01_REG_3 + 1,
  RM_0FAE_REG_5 = RM_0F01_REG_7 + 1,
  RM_0FAE_REG_6 = RM_0FAE_REG_5 + 1,
  RM_0FAE_REG_7 = RM_0FAE_REG_6 + 1
d677 356
a1032 356
  PREFIX_0F10 = PREFIX_90 + 1,
  PREFIX_0F11 = PREFIX_0F10 + 1,
  PREFIX_0F12 = PREFIX_0F11 + 1,
  PREFIX_0F16 = PREFIX_0F12 + 1,
  PREFIX_0F2A = PREFIX_0F16 + 1,
  PREFIX_0F2B = PREFIX_0F2A + 1,
  PREFIX_0F2C = PREFIX_0F2B + 1,
  PREFIX_0F2D = PREFIX_0F2C + 1,
  PREFIX_0F2E = PREFIX_0F2D + 1,
  PREFIX_0F2F = PREFIX_0F2E + 1,
  PREFIX_0F51 = PREFIX_0F2F + 1,
  PREFIX_0F52 = PREFIX_0F51 + 1,
  PREFIX_0F53 = PREFIX_0F52 + 1,
  PREFIX_0F58 = PREFIX_0F53 + 1,
  PREFIX_0F59 = PREFIX_0F58 + 1,
  PREFIX_0F5A = PREFIX_0F59 + 1,
  PREFIX_0F5B = PREFIX_0F5A + 1,
  PREFIX_0F5C = PREFIX_0F5B + 1,
  PREFIX_0F5D = PREFIX_0F5C + 1,
  PREFIX_0F5E = PREFIX_0F5D + 1,
  PREFIX_0F5F = PREFIX_0F5E + 1,
  PREFIX_0F60 = PREFIX_0F5F + 1,
  PREFIX_0F61 = PREFIX_0F60 + 1,
  PREFIX_0F62 = PREFIX_0F61 + 1,
  PREFIX_0F6C = PREFIX_0F62 + 1,
  PREFIX_0F6D = PREFIX_0F6C + 1,
  PREFIX_0F6F = PREFIX_0F6D + 1,
  PREFIX_0F70 = PREFIX_0F6F + 1,
  PREFIX_0F73_REG_3 = PREFIX_0F70 + 1,
  PREFIX_0F73_REG_7 = PREFIX_0F73_REG_3 + 1,
  PREFIX_0F78 = PREFIX_0F73_REG_7 + 1,
  PREFIX_0F79 = PREFIX_0F78 + 1,
  PREFIX_0F7C = PREFIX_0F79 + 1,
  PREFIX_0F7D = PREFIX_0F7C + 1,
  PREFIX_0F7E = PREFIX_0F7D + 1,
  PREFIX_0F7F = PREFIX_0F7E + 1,
  PREFIX_0FB8 = PREFIX_0F7F + 1,
  PREFIX_0FBD = PREFIX_0FB8 + 1,
  PREFIX_0FC2 = PREFIX_0FBD + 1,
  PREFIX_0FC3 = PREFIX_0FC2 + 1,
  PREFIX_0FC7_REG_6 = PREFIX_0FC3 + 1,
  PREFIX_0FD0 = PREFIX_0FC7_REG_6 + 1,
  PREFIX_0FD6 = PREFIX_0FD0 + 1,
  PREFIX_0FE6 = PREFIX_0FD6 + 1,
  PREFIX_0FE7 = PREFIX_0FE6 + 1,
  PREFIX_0FF0 = PREFIX_0FE7 + 1,
  PREFIX_0FF7 = PREFIX_0FF0 + 1,
  PREFIX_0F3810 = PREFIX_0FF7 + 1,
  PREFIX_0F3814 = PREFIX_0F3810 + 1,
  PREFIX_0F3815 = PREFIX_0F3814 + 1,
  PREFIX_0F3817 = PREFIX_0F3815 + 1,
  PREFIX_0F3820 = PREFIX_0F3817 + 1,
  PREFIX_0F3821 = PREFIX_0F3820 + 1,
  PREFIX_0F3822 = PREFIX_0F3821 + 1,
  PREFIX_0F3823 = PREFIX_0F3822 + 1,
  PREFIX_0F3824 = PREFIX_0F3823 + 1,
  PREFIX_0F3825 = PREFIX_0F3824 + 1,
  PREFIX_0F3828 = PREFIX_0F3825 + 1,
  PREFIX_0F3829 = PREFIX_0F3828 + 1,
  PREFIX_0F382A = PREFIX_0F3829 + 1,
  PREFIX_0F382B = PREFIX_0F382A + 1,
  PREFIX_0F3830 = PREFIX_0F382B + 1,
  PREFIX_0F3831 = PREFIX_0F3830 + 1,
  PREFIX_0F3832 = PREFIX_0F3831 + 1,
  PREFIX_0F3833 = PREFIX_0F3832 + 1,
  PREFIX_0F3834 = PREFIX_0F3833 + 1,
  PREFIX_0F3835 = PREFIX_0F3834 + 1,
  PREFIX_0F3837 = PREFIX_0F3835 + 1,
  PREFIX_0F3838 = PREFIX_0F3837 + 1,
  PREFIX_0F3839 = PREFIX_0F3838 + 1,
  PREFIX_0F383A = PREFIX_0F3839 + 1,
  PREFIX_0F383B = PREFIX_0F383A + 1,
  PREFIX_0F383C = PREFIX_0F383B + 1,
  PREFIX_0F383D = PREFIX_0F383C + 1,
  PREFIX_0F383E = PREFIX_0F383D + 1,
  PREFIX_0F383F = PREFIX_0F383E + 1,
  PREFIX_0F3840 = PREFIX_0F383F + 1,
  PREFIX_0F3841 = PREFIX_0F3840 + 1,
  PREFIX_0F3880 = PREFIX_0F3841 + 1,
  PREFIX_0F3881 = PREFIX_0F3880 + 1,
  PREFIX_0F38DB = PREFIX_0F3881 + 1,
  PREFIX_0F38DC = PREFIX_0F38DB + 1,
  PREFIX_0F38DD = PREFIX_0F38DC + 1,
  PREFIX_0F38DE = PREFIX_0F38DD + 1,
  PREFIX_0F38DF = PREFIX_0F38DE + 1,
  PREFIX_0F38F0 = PREFIX_0F38DF + 1,
  PREFIX_0F38F1 = PREFIX_0F38F0 + 1,
  PREFIX_0F3A08 = PREFIX_0F38F1 + 1,
  PREFIX_0F3A09 = PREFIX_0F3A08 + 1,
  PREFIX_0F3A0A = PREFIX_0F3A09 + 1,
  PREFIX_0F3A0B = PREFIX_0F3A0A + 1,
  PREFIX_0F3A0C = PREFIX_0F3A0B + 1,
  PREFIX_0F3A0D = PREFIX_0F3A0C + 1,
  PREFIX_0F3A0E = PREFIX_0F3A0D + 1,
  PREFIX_0F3A14 = PREFIX_0F3A0E + 1,
  PREFIX_0F3A15 = PREFIX_0F3A14 + 1,
  PREFIX_0F3A16 = PREFIX_0F3A15 + 1,
  PREFIX_0F3A17 = PREFIX_0F3A16 + 1,
  PREFIX_0F3A20 = PREFIX_0F3A17 + 1,
  PREFIX_0F3A21 = PREFIX_0F3A20 + 1,
  PREFIX_0F3A22 = PREFIX_0F3A21 + 1,
  PREFIX_0F3A40 = PREFIX_0F3A22 + 1,
  PREFIX_0F3A41 = PREFIX_0F3A40 + 1,
  PREFIX_0F3A42 = PREFIX_0F3A41 + 1,
  PREFIX_0F3A44 = PREFIX_0F3A42 + 1,
  PREFIX_0F3A60 = PREFIX_0F3A44 + 1,
  PREFIX_0F3A61 = PREFIX_0F3A60 + 1,
  PREFIX_0F3A62 = PREFIX_0F3A61 + 1,
  PREFIX_0F3A63 = PREFIX_0F3A62 + 1,
  PREFIX_0F3ADF = PREFIX_0F3A63 + 1,
  PREFIX_VEX_10 = PREFIX_0F3ADF + 1,
  PREFIX_VEX_11 = PREFIX_VEX_10 + 1,
  PREFIX_VEX_12 = PREFIX_VEX_11 + 1,
  PREFIX_VEX_16 = PREFIX_VEX_12 + 1,
  PREFIX_VEX_2A = PREFIX_VEX_16 + 1,
  PREFIX_VEX_2C = PREFIX_VEX_2A + 1,
  PREFIX_VEX_2D = PREFIX_VEX_2C + 1,
  PREFIX_VEX_2E = PREFIX_VEX_2D + 1,
  PREFIX_VEX_2F = PREFIX_VEX_2E + 1,
  PREFIX_VEX_51 = PREFIX_VEX_2F + 1,
  PREFIX_VEX_52 = PREFIX_VEX_51 + 1,
  PREFIX_VEX_53 = PREFIX_VEX_52 + 1,
  PREFIX_VEX_58 = PREFIX_VEX_53 + 1,
  PREFIX_VEX_59 = PREFIX_VEX_58 + 1,
  PREFIX_VEX_5A = PREFIX_VEX_59 + 1,
  PREFIX_VEX_5B = PREFIX_VEX_5A + 1,
  PREFIX_VEX_5C = PREFIX_VEX_5B + 1,
  PREFIX_VEX_5D = PREFIX_VEX_5C + 1,
  PREFIX_VEX_5E = PREFIX_VEX_5D + 1,
  PREFIX_VEX_5F = PREFIX_VEX_5E + 1,
  PREFIX_VEX_60 = PREFIX_VEX_5F + 1,
  PREFIX_VEX_61 = PREFIX_VEX_60 + 1,
  PREFIX_VEX_62 = PREFIX_VEX_61 + 1,
  PREFIX_VEX_63 = PREFIX_VEX_62 + 1,
  PREFIX_VEX_64 = PREFIX_VEX_63 + 1,
  PREFIX_VEX_65 = PREFIX_VEX_64 + 1,
  PREFIX_VEX_66 = PREFIX_VEX_65 + 1,
  PREFIX_VEX_67 = PREFIX_VEX_66 + 1,
  PREFIX_VEX_68 = PREFIX_VEX_67 + 1,
  PREFIX_VEX_69 = PREFIX_VEX_68 + 1,
  PREFIX_VEX_6A = PREFIX_VEX_69 + 1,
  PREFIX_VEX_6B = PREFIX_VEX_6A + 1,
  PREFIX_VEX_6C = PREFIX_VEX_6B + 1,
  PREFIX_VEX_6D = PREFIX_VEX_6C + 1,
  PREFIX_VEX_6E = PREFIX_VEX_6D + 1,
  PREFIX_VEX_6F = PREFIX_VEX_6E + 1,
  PREFIX_VEX_70 = PREFIX_VEX_6F + 1,
  PREFIX_VEX_71_REG_2 = PREFIX_VEX_70 + 1,
  PREFIX_VEX_71_REG_4 = PREFIX_VEX_71_REG_2 + 1,
  PREFIX_VEX_71_REG_6 = PREFIX_VEX_71_REG_4 + 1,
  PREFIX_VEX_72_REG_2 = PREFIX_VEX_71_REG_6 + 1,
  PREFIX_VEX_72_REG_4 = PREFIX_VEX_72_REG_2 + 1,
  PREFIX_VEX_72_REG_6 = PREFIX_VEX_72_REG_4 + 1,
  PREFIX_VEX_73_REG_2 = PREFIX_VEX_72_REG_6 + 1,
  PREFIX_VEX_73_REG_3 = PREFIX_VEX_73_REG_2 + 1,
  PREFIX_VEX_73_REG_6 = PREFIX_VEX_73_REG_3 + 1,
  PREFIX_VEX_73_REG_7 = PREFIX_VEX_73_REG_6 + 1,
  PREFIX_VEX_74 = PREFIX_VEX_73_REG_7 + 1,
  PREFIX_VEX_75 = PREFIX_VEX_74 + 1,
  PREFIX_VEX_76 = PREFIX_VEX_75 + 1,
  PREFIX_VEX_77 = PREFIX_VEX_76 + 1,
  PREFIX_VEX_7C = PREFIX_VEX_77 + 1,
  PREFIX_VEX_7D = PREFIX_VEX_7C + 1,
  PREFIX_VEX_7E = PREFIX_VEX_7D + 1,
  PREFIX_VEX_7F = PREFIX_VEX_7E + 1,
  PREFIX_VEX_C2 = PREFIX_VEX_7F + 1,
  PREFIX_VEX_C4 = PREFIX_VEX_C2 + 1,
  PREFIX_VEX_C5 = PREFIX_VEX_C4 + 1,
  PREFIX_VEX_D0 = PREFIX_VEX_C5 + 1,
  PREFIX_VEX_D1 = PREFIX_VEX_D0 + 1,
  PREFIX_VEX_D2 = PREFIX_VEX_D1 + 1,
  PREFIX_VEX_D3 = PREFIX_VEX_D2 + 1,
  PREFIX_VEX_D4 = PREFIX_VEX_D3 + 1,
  PREFIX_VEX_D5 = PREFIX_VEX_D4 + 1,
  PREFIX_VEX_D6 = PREFIX_VEX_D5 + 1,
  PREFIX_VEX_D7 = PREFIX_VEX_D6 + 1,
  PREFIX_VEX_D8 = PREFIX_VEX_D7 + 1,
  PREFIX_VEX_D9 = PREFIX_VEX_D8 + 1,
  PREFIX_VEX_DA = PREFIX_VEX_D9 + 1,
  PREFIX_VEX_DB = PREFIX_VEX_DA + 1,
  PREFIX_VEX_DC = PREFIX_VEX_DB + 1,
  PREFIX_VEX_DD = PREFIX_VEX_DC + 1,
  PREFIX_VEX_DE = PREFIX_VEX_DD + 1,
  PREFIX_VEX_DF = PREFIX_VEX_DE + 1,
  PREFIX_VEX_E0 = PREFIX_VEX_DF + 1,
  PREFIX_VEX_E1 = PREFIX_VEX_E0 + 1,
  PREFIX_VEX_E2 = PREFIX_VEX_E1 + 1,
  PREFIX_VEX_E3 = PREFIX_VEX_E2 + 1,
  PREFIX_VEX_E4 = PREFIX_VEX_E3 + 1,
  PREFIX_VEX_E5 = PREFIX_VEX_E4 + 1,
  PREFIX_VEX_E6 = PREFIX_VEX_E5 + 1,
  PREFIX_VEX_E7 = PREFIX_VEX_E6 + 1,
  PREFIX_VEX_E8 = PREFIX_VEX_E7 + 1,
  PREFIX_VEX_E9 = PREFIX_VEX_E8 + 1,
  PREFIX_VEX_EA = PREFIX_VEX_E9 + 1,
  PREFIX_VEX_EB = PREFIX_VEX_EA + 1,
  PREFIX_VEX_EC = PREFIX_VEX_EB + 1,
  PREFIX_VEX_ED = PREFIX_VEX_EC + 1,
  PREFIX_VEX_EE = PREFIX_VEX_ED + 1,
  PREFIX_VEX_EF = PREFIX_VEX_EE + 1,
  PREFIX_VEX_F0 = PREFIX_VEX_EF + 1,
  PREFIX_VEX_F1 = PREFIX_VEX_F0 + 1,
  PREFIX_VEX_F2 = PREFIX_VEX_F1 + 1,
  PREFIX_VEX_F3 = PREFIX_VEX_F2 + 1,
  PREFIX_VEX_F4 = PREFIX_VEX_F3 + 1,
  PREFIX_VEX_F5 = PREFIX_VEX_F4 + 1,
  PREFIX_VEX_F6 = PREFIX_VEX_F5 + 1,
  PREFIX_VEX_F7 = PREFIX_VEX_F6 + 1,
  PREFIX_VEX_F8 = PREFIX_VEX_F7 + 1,
  PREFIX_VEX_F9 = PREFIX_VEX_F8 + 1,
  PREFIX_VEX_FA = PREFIX_VEX_F9 + 1,
  PREFIX_VEX_FB = PREFIX_VEX_FA + 1,
  PREFIX_VEX_FC = PREFIX_VEX_FB + 1,
  PREFIX_VEX_FD = PREFIX_VEX_FC + 1,
  PREFIX_VEX_FE = PREFIX_VEX_FD + 1,
  PREFIX_VEX_3800 = PREFIX_VEX_FE + 1,
  PREFIX_VEX_3801 = PREFIX_VEX_3800 + 1,
  PREFIX_VEX_3802 = PREFIX_VEX_3801 + 1,
  PREFIX_VEX_3803 = PREFIX_VEX_3802 + 1,
  PREFIX_VEX_3804 = PREFIX_VEX_3803 + 1,
  PREFIX_VEX_3805 = PREFIX_VEX_3804 + 1,
  PREFIX_VEX_3806 = PREFIX_VEX_3805 + 1,
  PREFIX_VEX_3807 = PREFIX_VEX_3806 + 1,
  PREFIX_VEX_3808 = PREFIX_VEX_3807 + 1,
  PREFIX_VEX_3809 = PREFIX_VEX_3808 + 1,
  PREFIX_VEX_380A = PREFIX_VEX_3809 + 1,
  PREFIX_VEX_380B = PREFIX_VEX_380A + 1,
  PREFIX_VEX_380C = PREFIX_VEX_380B + 1,
  PREFIX_VEX_380D = PREFIX_VEX_380C + 1,
  PREFIX_VEX_380E = PREFIX_VEX_380D + 1,
  PREFIX_VEX_380F = PREFIX_VEX_380E + 1,
  PREFIX_VEX_3817 = PREFIX_VEX_380F + 1,
  PREFIX_VEX_3818 = PREFIX_VEX_3817 + 1,
  PREFIX_VEX_3819 = PREFIX_VEX_3818 + 1,
  PREFIX_VEX_381A = PREFIX_VEX_3819 + 1,
  PREFIX_VEX_381C = PREFIX_VEX_381A + 1,
  PREFIX_VEX_381D = PREFIX_VEX_381C + 1,
  PREFIX_VEX_381E = PREFIX_VEX_381D + 1,
  PREFIX_VEX_3820 = PREFIX_VEX_381E + 1,
  PREFIX_VEX_3821 = PREFIX_VEX_3820 + 1,
  PREFIX_VEX_3822 = PREFIX_VEX_3821 + 1,
  PREFIX_VEX_3823 = PREFIX_VEX_3822 + 1,
  PREFIX_VEX_3824 = PREFIX_VEX_3823 + 1,
  PREFIX_VEX_3825 = PREFIX_VEX_3824 + 1,
  PREFIX_VEX_3828 = PREFIX_VEX_3825 + 1,
  PREFIX_VEX_3829 = PREFIX_VEX_3828 + 1,
  PREFIX_VEX_382A = PREFIX_VEX_3829 + 1,
  PREFIX_VEX_382B = PREFIX_VEX_382A + 1,
  PREFIX_VEX_382C = PREFIX_VEX_382B + 1,
  PREFIX_VEX_382D = PREFIX_VEX_382C + 1,
  PREFIX_VEX_382E = PREFIX_VEX_382D + 1,
  PREFIX_VEX_382F = PREFIX_VEX_382E + 1,
  PREFIX_VEX_3830 = PREFIX_VEX_382F + 1,
  PREFIX_VEX_3831 = PREFIX_VEX_3830 + 1,
  PREFIX_VEX_3832 = PREFIX_VEX_3831 + 1,
  PREFIX_VEX_3833 = PREFIX_VEX_3832 + 1,
  PREFIX_VEX_3834 = PREFIX_VEX_3833 + 1,
  PREFIX_VEX_3835 = PREFIX_VEX_3834 + 1,
  PREFIX_VEX_3837 = PREFIX_VEX_3835 + 1,
  PREFIX_VEX_3838 = PREFIX_VEX_3837 + 1,
  PREFIX_VEX_3839 = PREFIX_VEX_3838 + 1,
  PREFIX_VEX_383A = PREFIX_VEX_3839 + 1,
  PREFIX_VEX_383B = PREFIX_VEX_383A + 1,
  PREFIX_VEX_383C = PREFIX_VEX_383B + 1,
  PREFIX_VEX_383D = PREFIX_VEX_383C + 1,
  PREFIX_VEX_383E = PREFIX_VEX_383D + 1,
  PREFIX_VEX_383F = PREFIX_VEX_383E + 1,
  PREFIX_VEX_3840 = PREFIX_VEX_383F + 1,
  PREFIX_VEX_3841 = PREFIX_VEX_3840 + 1,
  PREFIX_VEX_3896 = PREFIX_VEX_3841 + 1,
  PREFIX_VEX_3897 = PREFIX_VEX_3896 + 1,
  PREFIX_VEX_3898 = PREFIX_VEX_3897 + 1,
  PREFIX_VEX_3899 = PREFIX_VEX_3898 + 1,
  PREFIX_VEX_389A = PREFIX_VEX_3899 + 1,
  PREFIX_VEX_389B = PREFIX_VEX_389A + 1,
  PREFIX_VEX_389C = PREFIX_VEX_389B + 1,
  PREFIX_VEX_389D = PREFIX_VEX_389C + 1,
  PREFIX_VEX_389E = PREFIX_VEX_389D + 1,
  PREFIX_VEX_389F = PREFIX_VEX_389E + 1,
  PREFIX_VEX_38A6 = PREFIX_VEX_389F + 1,
  PREFIX_VEX_38A7 = PREFIX_VEX_38A6 + 1,
  PREFIX_VEX_38A8 = PREFIX_VEX_38A7 + 1,
  PREFIX_VEX_38A9 = PREFIX_VEX_38A8 + 1,
  PREFIX_VEX_38AA = PREFIX_VEX_38A9 + 1,
  PREFIX_VEX_38AB = PREFIX_VEX_38AA + 1,
  PREFIX_VEX_38AC = PREFIX_VEX_38AB + 1,
  PREFIX_VEX_38AD = PREFIX_VEX_38AC + 1,
  PREFIX_VEX_38AE = PREFIX_VEX_38AD + 1,
  PREFIX_VEX_38AF = PREFIX_VEX_38AE + 1,
  PREFIX_VEX_38B6 = PREFIX_VEX_38AF + 1,
  PREFIX_VEX_38B7 = PREFIX_VEX_38B6 + 1,
  PREFIX_VEX_38B8 = PREFIX_VEX_38B7 + 1,
  PREFIX_VEX_38B9 = PREFIX_VEX_38B8 + 1,
  PREFIX_VEX_38BA = PREFIX_VEX_38B9 + 1,
  PREFIX_VEX_38BB = PREFIX_VEX_38BA + 1,
  PREFIX_VEX_38BC = PREFIX_VEX_38BB + 1,
  PREFIX_VEX_38BD = PREFIX_VEX_38BC + 1,
  PREFIX_VEX_38BE = PREFIX_VEX_38BD + 1,
  PREFIX_VEX_38BF = PREFIX_VEX_38BE + 1,
  PREFIX_VEX_38DB = PREFIX_VEX_38BF + 1,
  PREFIX_VEX_38DC = PREFIX_VEX_38DB + 1,
  PREFIX_VEX_38DD = PREFIX_VEX_38DC + 1,
  PREFIX_VEX_38DE = PREFIX_VEX_38DD + 1,
  PREFIX_VEX_38DF = PREFIX_VEX_38DE + 1,
  PREFIX_VEX_3A04 = PREFIX_VEX_38DF + 1,
  PREFIX_VEX_3A05 = PREFIX_VEX_3A04 + 1,
  PREFIX_VEX_3A06 = PREFIX_VEX_3A05 + 1,
  PREFIX_VEX_3A08 = PREFIX_VEX_3A06 + 1,
  PREFIX_VEX_3A09 = PREFIX_VEX_3A08 + 1,
  PREFIX_VEX_3A0A = PREFIX_VEX_3A09 + 1,
  PREFIX_VEX_3A0B = PREFIX_VEX_3A0A + 1,
  PREFIX_VEX_3A0C = PREFIX_VEX_3A0B + 1,
  PREFIX_VEX_3A0D = PREFIX_VEX_3A0C + 1,
  PREFIX_VEX_3A0E = PREFIX_VEX_3A0D + 1,
  PREFIX_VEX_3A0F = PREFIX_VEX_3A0E + 1,
  PREFIX_VEX_3A14 = PREFIX_VEX_3A0F + 1,
  PREFIX_VEX_3A15 = PREFIX_VEX_3A14 + 1,
  PREFIX_VEX_3A16 = PREFIX_VEX_3A15 + 1,
  PREFIX_VEX_3A17 = PREFIX_VEX_3A16 + 1,
  PREFIX_VEX_3A18 = PREFIX_VEX_3A17 + 1,
  PREFIX_VEX_3A19 = PREFIX_VEX_3A18 + 1,
  PREFIX_VEX_3A20 = PREFIX_VEX_3A19 + 1,
  PREFIX_VEX_3A21 = PREFIX_VEX_3A20 + 1,
  PREFIX_VEX_3A22 = PREFIX_VEX_3A21 + 1,
  PREFIX_VEX_3A40 = PREFIX_VEX_3A22 + 1,
  PREFIX_VEX_3A41 = PREFIX_VEX_3A40 + 1,
  PREFIX_VEX_3A42 = PREFIX_VEX_3A41 + 1,
  PREFIX_VEX_3A44 = PREFIX_VEX_3A42 + 1,
  PREFIX_VEX_3A4A = PREFIX_VEX_3A44 + 1,
  PREFIX_VEX_3A4B = PREFIX_VEX_3A4A + 1,
  PREFIX_VEX_3A4C = PREFIX_VEX_3A4B + 1,
  PREFIX_VEX_3A5C = PREFIX_VEX_3A4C + 1,
  PREFIX_VEX_3A5D = PREFIX_VEX_3A5C + 1,
  PREFIX_VEX_3A5E = PREFIX_VEX_3A5D + 1,
  PREFIX_VEX_3A5F = PREFIX_VEX_3A5E + 1,
  PREFIX_VEX_3A60 = PREFIX_VEX_3A5F + 1,
  PREFIX_VEX_3A61 = PREFIX_VEX_3A60 + 1,
  PREFIX_VEX_3A62 = PREFIX_VEX_3A61 + 1,
  PREFIX_VEX_3A63 = PREFIX_VEX_3A62 + 1,
  PREFIX_VEX_3A68 = PREFIX_VEX_3A63 + 1,
  PREFIX_VEX_3A69 = PREFIX_VEX_3A68 + 1,
  PREFIX_VEX_3A6A = PREFIX_VEX_3A69 + 1,
  PREFIX_VEX_3A6B = PREFIX_VEX_3A6A + 1,
  PREFIX_VEX_3A6C = PREFIX_VEX_3A6B + 1,
  PREFIX_VEX_3A6D = PREFIX_VEX_3A6C + 1,
  PREFIX_VEX_3A6E = PREFIX_VEX_3A6D + 1,
  PREFIX_VEX_3A6F = PREFIX_VEX_3A6E + 1,
  PREFIX_VEX_3A78 = PREFIX_VEX_3A6F + 1,
  PREFIX_VEX_3A79 = PREFIX_VEX_3A78 + 1,
  PREFIX_VEX_3A7A = PREFIX_VEX_3A79 + 1,
  PREFIX_VEX_3A7B = PREFIX_VEX_3A7A + 1,
  PREFIX_VEX_3A7C = PREFIX_VEX_3A7B + 1,
  PREFIX_VEX_3A7D = PREFIX_VEX_3A7C + 1,
  PREFIX_VEX_3A7E = PREFIX_VEX_3A7D + 1,
  PREFIX_VEX_3A7F = PREFIX_VEX_3A7E + 1,
  PREFIX_VEX_3ADF = PREFIX_VEX_3A7F + 1
d1038 27
a1064 27
  X86_64_07 = X86_64_06 + 1,
  X86_64_0D = X86_64_07 + 1,
  X86_64_16 = X86_64_0D + 1,
  X86_64_17 = X86_64_16 + 1,
  X86_64_1E = X86_64_17 + 1,
  X86_64_1F = X86_64_1E + 1,
  X86_64_27 = X86_64_1F + 1,
  X86_64_2F = X86_64_27 + 1,
  X86_64_37 = X86_64_2F + 1,
  X86_64_3F = X86_64_37 + 1,
  X86_64_60 = X86_64_3F + 1,
  X86_64_61 = X86_64_60 + 1,
  X86_64_62 = X86_64_61 + 1,
  X86_64_63 = X86_64_62 + 1,
  X86_64_6D = X86_64_63 + 1,
  X86_64_6F = X86_64_6D + 1,
  X86_64_9A = X86_64_6F + 1,
  X86_64_C4 = X86_64_9A + 1,
  X86_64_C5 = X86_64_C4 + 1,
  X86_64_CE = X86_64_C5 + 1,
  X86_64_D4 = X86_64_CE + 1,
  X86_64_D5 = X86_64_D4 + 1,
  X86_64_EA = X86_64_D5 + 1,
  X86_64_0F01_REG_0 = X86_64_EA + 1,
  X86_64_0F01_REG_1 = X86_64_0F01_REG_0 + 1,
  X86_64_0F01_REG_2 = X86_64_0F01_REG_1 + 1,
  X86_64_0F01_REG_3 = X86_64_0F01_REG_2 + 1
d1070 2
a1071 2
  THREE_BYTE_0F3A = THREE_BYTE_0F38 + 1,
  THREE_BYTE_0F7A = THREE_BYTE_0F3A + 1
d1077 2
a1078 2
  VEX_0F38 = VEX_0F + 1,
  VEX_0F3A = VEX_0F38 + 1
d1084 201
a1284 201
  VEX_LEN_10_P_3 = VEX_LEN_10_P_1 + 1,
  VEX_LEN_11_P_1 = VEX_LEN_10_P_3 + 1,
  VEX_LEN_11_P_3 = VEX_LEN_11_P_1 + 1,
  VEX_LEN_12_P_0_M_0 = VEX_LEN_11_P_3 + 1,
  VEX_LEN_12_P_0_M_1 = VEX_LEN_12_P_0_M_0 + 1,
  VEX_LEN_12_P_2 = VEX_LEN_12_P_0_M_1 + 1,
  VEX_LEN_13_M_0 = VEX_LEN_12_P_2 + 1,
  VEX_LEN_16_P_0_M_0 = VEX_LEN_13_M_0 + 1,
  VEX_LEN_16_P_0_M_1 = VEX_LEN_16_P_0_M_0 + 1,
  VEX_LEN_16_P_2 = VEX_LEN_16_P_0_M_1 + 1,
  VEX_LEN_17_M_0 = VEX_LEN_16_P_2 + 1,
  VEX_LEN_2A_P_1 = VEX_LEN_17_M_0 + 1,
  VEX_LEN_2A_P_3 = VEX_LEN_2A_P_1 + 1,
  VEX_LEN_2C_P_1 = VEX_LEN_2A_P_3 + 1,
  VEX_LEN_2C_P_3 = VEX_LEN_2C_P_1 + 1,
  VEX_LEN_2D_P_1 = VEX_LEN_2C_P_3 + 1,
  VEX_LEN_2D_P_3 = VEX_LEN_2D_P_1 + 1,
  VEX_LEN_2E_P_0 = VEX_LEN_2D_P_3 + 1,
  VEX_LEN_2E_P_2 = VEX_LEN_2E_P_0 + 1,
  VEX_LEN_2F_P_0 = VEX_LEN_2E_P_2 + 1,
  VEX_LEN_2F_P_2 = VEX_LEN_2F_P_0 + 1,
  VEX_LEN_51_P_1 = VEX_LEN_2F_P_2 + 1,
  VEX_LEN_51_P_3 = VEX_LEN_51_P_1 + 1,
  VEX_LEN_52_P_1 = VEX_LEN_51_P_3 + 1,
  VEX_LEN_53_P_1 = VEX_LEN_52_P_1 + 1,
  VEX_LEN_58_P_1 = VEX_LEN_53_P_1 + 1,
  VEX_LEN_58_P_3 = VEX_LEN_58_P_1 + 1,
  VEX_LEN_59_P_1 = VEX_LEN_58_P_3 + 1,
  VEX_LEN_59_P_3 = VEX_LEN_59_P_1 + 1,
  VEX_LEN_5A_P_1 = VEX_LEN_59_P_3 + 1,
  VEX_LEN_5A_P_3 = VEX_LEN_5A_P_1 + 1,
  VEX_LEN_5C_P_1 = VEX_LEN_5A_P_3 + 1,
  VEX_LEN_5C_P_3 = VEX_LEN_5C_P_1 + 1,
  VEX_LEN_5D_P_1 = VEX_LEN_5C_P_3 + 1,
  VEX_LEN_5D_P_3 = VEX_LEN_5D_P_1 + 1,
  VEX_LEN_5E_P_1 = VEX_LEN_5D_P_3 + 1,
  VEX_LEN_5E_P_3 = VEX_LEN_5E_P_1 + 1,
  VEX_LEN_5F_P_1 = VEX_LEN_5E_P_3 + 1,
  VEX_LEN_5F_P_3 = VEX_LEN_5F_P_1 + 1,
  VEX_LEN_60_P_2 = VEX_LEN_5F_P_3 + 1,
  VEX_LEN_61_P_2 = VEX_LEN_60_P_2 + 1,
  VEX_LEN_62_P_2 = VEX_LEN_61_P_2 + 1,
  VEX_LEN_63_P_2 = VEX_LEN_62_P_2 + 1,
  VEX_LEN_64_P_2 = VEX_LEN_63_P_2 + 1,
  VEX_LEN_65_P_2 = VEX_LEN_64_P_2 + 1,
  VEX_LEN_66_P_2 = VEX_LEN_65_P_2 + 1,
  VEX_LEN_67_P_2 = VEX_LEN_66_P_2 + 1,
  VEX_LEN_68_P_2 = VEX_LEN_67_P_2 + 1,
  VEX_LEN_69_P_2 = VEX_LEN_68_P_2 + 1,
  VEX_LEN_6A_P_2 = VEX_LEN_69_P_2 + 1,
  VEX_LEN_6B_P_2 = VEX_LEN_6A_P_2 + 1,
  VEX_LEN_6C_P_2 = VEX_LEN_6B_P_2 + 1,
  VEX_LEN_6D_P_2 = VEX_LEN_6C_P_2 + 1,
  VEX_LEN_6E_P_2 = VEX_LEN_6D_P_2 + 1,
  VEX_LEN_70_P_1 = VEX_LEN_6E_P_2 + 1,
  VEX_LEN_70_P_2 = VEX_LEN_70_P_1 + 1,
  VEX_LEN_70_P_3 = VEX_LEN_70_P_2 + 1,
  VEX_LEN_71_R_2_P_2 = VEX_LEN_70_P_3 + 1,
  VEX_LEN_71_R_4_P_2 = VEX_LEN_71_R_2_P_2 + 1,
  VEX_LEN_71_R_6_P_2 = VEX_LEN_71_R_4_P_2 + 1,
  VEX_LEN_72_R_2_P_2 = VEX_LEN_71_R_6_P_2 + 1,
  VEX_LEN_72_R_4_P_2 = VEX_LEN_72_R_2_P_2 + 1,
  VEX_LEN_72_R_6_P_2 = VEX_LEN_72_R_4_P_2 + 1,
  VEX_LEN_73_R_2_P_2 = VEX_LEN_72_R_6_P_2 + 1,
  VEX_LEN_73_R_3_P_2 = VEX_LEN_73_R_2_P_2 + 1,
  VEX_LEN_73_R_6_P_2 = VEX_LEN_73_R_3_P_2 + 1,
  VEX_LEN_73_R_7_P_2 = VEX_LEN_73_R_6_P_2 + 1,
  VEX_LEN_74_P_2 = VEX_LEN_73_R_7_P_2 + 1,
  VEX_LEN_75_P_2 = VEX_LEN_74_P_2 + 1,
  VEX_LEN_76_P_2 = VEX_LEN_75_P_2 + 1,
  VEX_LEN_7E_P_1 = VEX_LEN_76_P_2 + 1,
  VEX_LEN_7E_P_2 = VEX_LEN_7E_P_1 + 1,
  VEX_LEN_AE_R_2_M_0 = VEX_LEN_7E_P_2 + 1,
  VEX_LEN_AE_R_3_M_0 = VEX_LEN_AE_R_2_M_0 + 1,
  VEX_LEN_C2_P_1 = VEX_LEN_AE_R_3_M_0 + 1,
  VEX_LEN_C2_P_3 = VEX_LEN_C2_P_1 + 1,
  VEX_LEN_C4_P_2 = VEX_LEN_C2_P_3 + 1,
  VEX_LEN_C5_P_2 = VEX_LEN_C4_P_2 + 1,
  VEX_LEN_D1_P_2 = VEX_LEN_C5_P_2 + 1,
  VEX_LEN_D2_P_2 = VEX_LEN_D1_P_2 + 1,
  VEX_LEN_D3_P_2 = VEX_LEN_D2_P_2 + 1,
  VEX_LEN_D4_P_2 = VEX_LEN_D3_P_2 + 1,
  VEX_LEN_D5_P_2 = VEX_LEN_D4_P_2 + 1,
  VEX_LEN_D6_P_2 = VEX_LEN_D5_P_2 + 1,
  VEX_LEN_D7_P_2_M_1 = VEX_LEN_D6_P_2 + 1,
  VEX_LEN_D8_P_2 = VEX_LEN_D7_P_2_M_1 + 1,
  VEX_LEN_D9_P_2 = VEX_LEN_D8_P_2 + 1,
  VEX_LEN_DA_P_2 = VEX_LEN_D9_P_2 + 1,
  VEX_LEN_DB_P_2 = VEX_LEN_DA_P_2 + 1,
  VEX_LEN_DC_P_2 = VEX_LEN_DB_P_2 + 1,
  VEX_LEN_DD_P_2 = VEX_LEN_DC_P_2 + 1,
  VEX_LEN_DE_P_2 = VEX_LEN_DD_P_2 + 1,
  VEX_LEN_DF_P_2 = VEX_LEN_DE_P_2 + 1,
  VEX_LEN_E0_P_2 = VEX_LEN_DF_P_2 + 1,
  VEX_LEN_E1_P_2 = VEX_LEN_E0_P_2 + 1,
  VEX_LEN_E2_P_2 = VEX_LEN_E1_P_2 + 1,
  VEX_LEN_E3_P_2 = VEX_LEN_E2_P_2 + 1,
  VEX_LEN_E4_P_2 = VEX_LEN_E3_P_2 + 1,
  VEX_LEN_E5_P_2 = VEX_LEN_E4_P_2 + 1,
  VEX_LEN_E8_P_2 = VEX_LEN_E5_P_2 + 1,
  VEX_LEN_E9_P_2 = VEX_LEN_E8_P_2 + 1,
  VEX_LEN_EA_P_2 = VEX_LEN_E9_P_2 + 1,
  VEX_LEN_EB_P_2 = VEX_LEN_EA_P_2 + 1,
  VEX_LEN_EC_P_2 = VEX_LEN_EB_P_2 + 1,
  VEX_LEN_ED_P_2 = VEX_LEN_EC_P_2 + 1,
  VEX_LEN_EE_P_2 = VEX_LEN_ED_P_2 + 1,
  VEX_LEN_EF_P_2 = VEX_LEN_EE_P_2 + 1,
  VEX_LEN_F1_P_2 = VEX_LEN_EF_P_2 + 1,
  VEX_LEN_F2_P_2 = VEX_LEN_F1_P_2 + 1,
  VEX_LEN_F3_P_2 = VEX_LEN_F2_P_2 + 1,
  VEX_LEN_F4_P_2 = VEX_LEN_F3_P_2 + 1,
  VEX_LEN_F5_P_2 = VEX_LEN_F4_P_2 + 1,
  VEX_LEN_F6_P_2 = VEX_LEN_F5_P_2 + 1,
  VEX_LEN_F7_P_2 = VEX_LEN_F6_P_2 + 1,
  VEX_LEN_F8_P_2 = VEX_LEN_F7_P_2 + 1,
  VEX_LEN_F9_P_2 = VEX_LEN_F8_P_2 + 1,
  VEX_LEN_FA_P_2 = VEX_LEN_F9_P_2 + 1,
  VEX_LEN_FB_P_2 = VEX_LEN_FA_P_2 + 1,
  VEX_LEN_FC_P_2 = VEX_LEN_FB_P_2 + 1,
  VEX_LEN_FD_P_2 = VEX_LEN_FC_P_2 + 1,
  VEX_LEN_FE_P_2 = VEX_LEN_FD_P_2 + 1,
  VEX_LEN_3800_P_2 = VEX_LEN_FE_P_2 + 1,
  VEX_LEN_3801_P_2 = VEX_LEN_3800_P_2 + 1,
  VEX_LEN_3802_P_2 = VEX_LEN_3801_P_2 + 1,
  VEX_LEN_3803_P_2 = VEX_LEN_3802_P_2 + 1,
  VEX_LEN_3804_P_2 = VEX_LEN_3803_P_2 + 1,
  VEX_LEN_3805_P_2 = VEX_LEN_3804_P_2 + 1,
  VEX_LEN_3806_P_2 = VEX_LEN_3805_P_2 + 1,
  VEX_LEN_3807_P_2 = VEX_LEN_3806_P_2 + 1,
  VEX_LEN_3808_P_2 = VEX_LEN_3807_P_2 + 1,
  VEX_LEN_3809_P_2 = VEX_LEN_3808_P_2 + 1,
  VEX_LEN_380A_P_2 = VEX_LEN_3809_P_2 + 1,
  VEX_LEN_380B_P_2 = VEX_LEN_380A_P_2 + 1,
  VEX_LEN_3819_P_2_M_0 = VEX_LEN_380B_P_2 + 1,
  VEX_LEN_381A_P_2_M_0 = VEX_LEN_3819_P_2_M_0 + 1,
  VEX_LEN_381C_P_2 = VEX_LEN_381A_P_2_M_0 + 1,
  VEX_LEN_381D_P_2 = VEX_LEN_381C_P_2 + 1,
  VEX_LEN_381E_P_2 = VEX_LEN_381D_P_2 + 1,
  VEX_LEN_3820_P_2 = VEX_LEN_381E_P_2 + 1,
  VEX_LEN_3821_P_2 = VEX_LEN_3820_P_2 + 1,
  VEX_LEN_3822_P_2 = VEX_LEN_3821_P_2 + 1,
  VEX_LEN_3823_P_2 = VEX_LEN_3822_P_2 + 1,
  VEX_LEN_3824_P_2 = VEX_LEN_3823_P_2 + 1,
  VEX_LEN_3825_P_2 = VEX_LEN_3824_P_2 + 1,
  VEX_LEN_3828_P_2 = VEX_LEN_3825_P_2 + 1,
  VEX_LEN_3829_P_2 = VEX_LEN_3828_P_2 + 1,
  VEX_LEN_382A_P_2_M_0 = VEX_LEN_3829_P_2 + 1,
  VEX_LEN_382B_P_2 = VEX_LEN_382A_P_2_M_0 + 1,
  VEX_LEN_3830_P_2 = VEX_LEN_382B_P_2 + 1,
  VEX_LEN_3831_P_2 = VEX_LEN_3830_P_2 + 1,
  VEX_LEN_3832_P_2 = VEX_LEN_3831_P_2 + 1,
  VEX_LEN_3833_P_2 = VEX_LEN_3832_P_2 + 1,
  VEX_LEN_3834_P_2 = VEX_LEN_3833_P_2 + 1,
  VEX_LEN_3835_P_2 = VEX_LEN_3834_P_2 + 1,
  VEX_LEN_3837_P_2 = VEX_LEN_3835_P_2 + 1,
  VEX_LEN_3838_P_2 = VEX_LEN_3837_P_2 + 1,
  VEX_LEN_3839_P_2 = VEX_LEN_3838_P_2 + 1,
  VEX_LEN_383A_P_2 = VEX_LEN_3839_P_2 + 1,
  VEX_LEN_383B_P_2 = VEX_LEN_383A_P_2 + 1,
  VEX_LEN_383C_P_2 = VEX_LEN_383B_P_2 + 1,
  VEX_LEN_383D_P_2 = VEX_LEN_383C_P_2 + 1,
  VEX_LEN_383E_P_2 = VEX_LEN_383D_P_2 + 1,
  VEX_LEN_383F_P_2 = VEX_LEN_383E_P_2 + 1,
  VEX_LEN_3840_P_2 = VEX_LEN_383F_P_2 + 1,
  VEX_LEN_3841_P_2 = VEX_LEN_3840_P_2 + 1,
  VEX_LEN_38DB_P_2 = VEX_LEN_3841_P_2 + 1,
  VEX_LEN_38DC_P_2 = VEX_LEN_38DB_P_2 + 1,
  VEX_LEN_38DD_P_2 = VEX_LEN_38DC_P_2 + 1,
  VEX_LEN_38DE_P_2 = VEX_LEN_38DD_P_2 + 1,
  VEX_LEN_38DF_P_2 = VEX_LEN_38DE_P_2 + 1,
  VEX_LEN_3A06_P_2 = VEX_LEN_38DF_P_2 + 1,
  VEX_LEN_3A0A_P_2 = VEX_LEN_3A06_P_2 + 1,
  VEX_LEN_3A0B_P_2 = VEX_LEN_3A0A_P_2 + 1,
  VEX_LEN_3A0E_P_2 = VEX_LEN_3A0B_P_2 + 1,
  VEX_LEN_3A0F_P_2 = VEX_LEN_3A0E_P_2 + 1,
  VEX_LEN_3A14_P_2 = VEX_LEN_3A0F_P_2 + 1,
  VEX_LEN_3A15_P_2 = VEX_LEN_3A14_P_2 + 1,
  VEX_LEN_3A16_P_2 = VEX_LEN_3A15_P_2 + 1,
  VEX_LEN_3A17_P_2 = VEX_LEN_3A16_P_2 + 1,
  VEX_LEN_3A18_P_2 = VEX_LEN_3A17_P_2 + 1,
  VEX_LEN_3A19_P_2 = VEX_LEN_3A18_P_2 + 1,
  VEX_LEN_3A20_P_2 = VEX_LEN_3A19_P_2 + 1,
  VEX_LEN_3A21_P_2 = VEX_LEN_3A20_P_2 + 1,
  VEX_LEN_3A22_P_2 = VEX_LEN_3A21_P_2 + 1,
  VEX_LEN_3A41_P_2 = VEX_LEN_3A22_P_2 + 1,
  VEX_LEN_3A42_P_2 = VEX_LEN_3A41_P_2 + 1,
  VEX_LEN_3A44_P_2 = VEX_LEN_3A42_P_2 + 1,
  VEX_LEN_3A4C_P_2 = VEX_LEN_3A44_P_2 + 1,
  VEX_LEN_3A60_P_2 = VEX_LEN_3A4C_P_2 + 1,
  VEX_LEN_3A61_P_2 = VEX_LEN_3A60_P_2 + 1,
  VEX_LEN_3A62_P_2 = VEX_LEN_3A61_P_2 + 1,
  VEX_LEN_3A63_P_2 = VEX_LEN_3A62_P_2 + 1,
  VEX_LEN_3A6A_P_2 = VEX_LEN_3A63_P_2 + 1,
  VEX_LEN_3A6B_P_2 = VEX_LEN_3A6A_P_2 + 1,
  VEX_LEN_3A6E_P_2 = VEX_LEN_3A6B_P_2 + 1,
  VEX_LEN_3A6F_P_2 = VEX_LEN_3A6E_P_2 + 1,
  VEX_LEN_3A7A_P_2 = VEX_LEN_3A6F_P_2 + 1,
  VEX_LEN_3A7B_P_2 = VEX_LEN_3A7A_P_2 + 1,
  VEX_LEN_3A7E_P_2 = VEX_LEN_3A7B_P_2 + 1,
  VEX_LEN_3A7F_P_2 = VEX_LEN_3A7E_P_2 + 1,
  VEX_LEN_3ADF_P_2 = VEX_LEN_3A7F_P_2 + 1
@


1.202
log
@2009-10-15  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (MAX_BYTEMODE): Removed.
@
text
@d400 124
a523 119
/* byte operand */
#define b_mode			1
/* byte operand with operand swapped */
#define b_swap_mode		(b_mode + 1)
/* operand size depends on prefixes */
#define v_mode			(b_swap_mode + 1)
/* operand size depends on prefixes with operand swapped */
#define v_swap_mode		(v_mode + 1)
/* word operand */
#define w_mode			(v_swap_mode + 1)
/* double word operand  */
#define d_mode			(w_mode + 1)
/* double word operand with operand swapped */
#define d_swap_mode		(d_mode + 1)
/* quad word operand */
#define q_mode			(d_swap_mode + 1)
/* quad word operand with operand swapped */
#define q_swap_mode		(q_mode + 1)
/* ten-byte operand */
#define t_mode			(q_swap_mode + 1)
/* 16-byte XMM or 32-byte YMM operand */
#define x_mode			(t_mode + 1)
/* 16-byte XMM or 32-byte YMM operand with operand swapped */
#define x_swap_mode		(x_mode + 1)
/* 16-byte XMM operand */
#define xmm_mode		(x_swap_mode + 1)
/* 16-byte XMM or quad word operand */
#define xmmq_mode		(xmm_mode + 1)
/* 32-byte YMM or quad word operand */
#define ymmq_mode		(xmmq_mode + 1)
/* d_mode in 32bit, q_mode in 64bit mode.  */
#define m_mode			(ymmq_mode + 1)
/* pair of v_mode operands */
#define a_mode			(m_mode + 1)
#define cond_jump_mode		(a_mode + 1)
#define loop_jcxz_mode		(cond_jump_mode + 1)
/* operand size depends on REX prefixes.  */
#define dq_mode			(loop_jcxz_mode + 1)
/* registers like dq_mode, memory like w_mode.  */
#define dqw_mode		(dq_mode + 1)
/* 4- or 6-byte pointer operand */
#define f_mode			(dqw_mode + 1)
#define const_1_mode		(f_mode + 1)
/* v_mode for stack-related opcodes.  */
#define stack_v_mode		(const_1_mode + 1)
/* non-quad operand size depends on prefixes */
#define z_mode			(stack_v_mode + 1)
/* 16-byte operand */
#define o_mode			(z_mode + 1)
/* registers like dq_mode, memory like b_mode.  */
#define dqb_mode		(o_mode + 1)
/* registers like dq_mode, memory like d_mode.  */
#define dqd_mode		(dqb_mode + 1)
/* normal vex mode */
#define vex_mode		(dqd_mode + 1)
/* 128bit vex mode */
#define vex128_mode		(vex_mode + 1)
/* 256bit vex mode */
#define vex256_mode		(vex128_mode + 1)
/* operand size depends on the VEX.W bit.  */
#define vex_w_dq_mode		(vex256_mode + 1)

#define es_reg			(vex_w_dq_mode + 1)
#define cs_reg			(es_reg + 1)
#define ss_reg			(cs_reg + 1)
#define ds_reg			(ss_reg + 1)
#define fs_reg			(ds_reg + 1)
#define gs_reg			(fs_reg + 1)

#define eAX_reg			(gs_reg + 1)
#define eCX_reg			(eAX_reg + 1)
#define eDX_reg			(eCX_reg + 1)
#define eBX_reg			(eDX_reg + 1)
#define eSP_reg			(eBX_reg + 1)
#define eBP_reg			(eSP_reg + 1)
#define eSI_reg			(eBP_reg + 1)
#define eDI_reg			(eSI_reg + 1)

#define al_reg			(eDI_reg + 1)
#define cl_reg			(al_reg + 1)
#define dl_reg			(cl_reg + 1)
#define bl_reg			(dl_reg + 1)
#define ah_reg			(bl_reg + 1)
#define ch_reg			(ah_reg + 1)
#define dh_reg			(ch_reg + 1)
#define bh_reg			(dh_reg + 1)

#define ax_reg			(bh_reg + 1)
#define cx_reg			(ax_reg + 1)
#define dx_reg			(cx_reg + 1)
#define bx_reg			(dx_reg + 1)
#define sp_reg			(bx_reg + 1)
#define bp_reg			(sp_reg + 1)
#define si_reg			(bp_reg + 1)
#define di_reg			(si_reg + 1)

#define rAX_reg			(di_reg + 1)
#define rCX_reg			(rAX_reg + 1)
#define rDX_reg			(rCX_reg + 1)
#define rBX_reg			(rDX_reg + 1)
#define rSP_reg			(rBX_reg + 1)
#define rBP_reg			(rSP_reg + 1)
#define rSI_reg			(rBP_reg + 1)
#define rDI_reg			(rSI_reg + 1)

#define z_mode_ax_reg		(rDI_reg + 1)
#define indir_dx_reg		(z_mode_ax_reg + 1)


#define FLOATCODE		1
#define USE_REG_TABLE		(FLOATCODE + 1)
#define USE_MOD_TABLE		(USE_REG_TABLE + 1)
#define USE_RM_TABLE		(USE_MOD_TABLE + 1)
#define USE_PREFIX_TABLE	(USE_RM_TABLE + 1)
#define USE_X86_64_TABLE	(USE_PREFIX_TABLE + 1)
#define USE_3BYTE_TABLE		(USE_X86_64_TABLE + 1)
#define USE_VEX_C4_TABLE	(USE_3BYTE_TABLE + 1)
#define USE_VEX_C5_TABLE	(USE_VEX_C4_TABLE + 1)
#define USE_VEX_LEN_TABLE	(USE_VEX_C5_TABLE + 1)
d538 748
a1285 724
#define REG_80			0
#define REG_81			(REG_80 + 1)
#define REG_82			(REG_81 + 1)
#define REG_8F			(REG_82 + 1)
#define REG_C0			(REG_8F + 1)
#define REG_C1			(REG_C0 + 1)
#define REG_C6			(REG_C1 + 1)
#define REG_C7			(REG_C6 + 1)
#define REG_D0			(REG_C7 + 1)
#define REG_D1			(REG_D0 + 1)
#define REG_D2			(REG_D1 + 1)
#define REG_D3			(REG_D2 + 1)
#define REG_F6			(REG_D3 + 1)
#define REG_F7			(REG_F6 + 1)
#define REG_FE			(REG_F7 + 1)
#define REG_FF			(REG_FE + 1)
#define REG_0F00		(REG_FF + 1)
#define REG_0F01		(REG_0F00 + 1)
#define REG_0F0D		(REG_0F01 + 1)
#define REG_0F18		(REG_0F0D + 1)
#define REG_0F71		(REG_0F18 + 1)
#define REG_0F72		(REG_0F71 + 1)
#define REG_0F73		(REG_0F72 + 1)
#define REG_0FA6		(REG_0F73 + 1)
#define REG_0FA7		(REG_0FA6 + 1)
#define REG_0FAE		(REG_0FA7 + 1)
#define REG_0FBA		(REG_0FAE + 1)
#define REG_0FC7		(REG_0FBA + 1)
#define REG_VEX_71		(REG_0FC7 + 1)
#define REG_VEX_72		(REG_VEX_71 + 1)
#define REG_VEX_73		(REG_VEX_72 + 1)
#define REG_VEX_AE		(REG_VEX_73 + 1)

#define MOD_8D			0
#define MOD_0F01_REG_0		(MOD_8D + 1)
#define MOD_0F01_REG_1		(MOD_0F01_REG_0 + 1)
#define MOD_0F01_REG_2		(MOD_0F01_REG_1 + 1)
#define MOD_0F01_REG_3		(MOD_0F01_REG_2 + 1)
#define MOD_0F01_REG_7		(MOD_0F01_REG_3 + 1)
#define MOD_0F12_PREFIX_0	(MOD_0F01_REG_7 + 1)
#define MOD_0F13		(MOD_0F12_PREFIX_0 + 1)
#define MOD_0F16_PREFIX_0	(MOD_0F13 + 1)
#define MOD_0F17		(MOD_0F16_PREFIX_0 + 1)
#define MOD_0F18_REG_0		(MOD_0F17 + 1)
#define MOD_0F18_REG_1		(MOD_0F18_REG_0 + 1)
#define MOD_0F18_REG_2		(MOD_0F18_REG_1 + 1)
#define MOD_0F18_REG_3		(MOD_0F18_REG_2 + 1)
#define MOD_0F20		(MOD_0F18_REG_3 + 1)
#define MOD_0F21		(MOD_0F20 + 1)
#define MOD_0F22		(MOD_0F21 + 1)
#define MOD_0F23		(MOD_0F22 + 1)
#define MOD_0F24		(MOD_0F23 + 1)
#define MOD_0F26		(MOD_0F24 + 1)
#define MOD_0F2B_PREFIX_0	(MOD_0F26 + 1)
#define MOD_0F2B_PREFIX_1	(MOD_0F2B_PREFIX_0 + 1)
#define MOD_0F2B_PREFIX_2	(MOD_0F2B_PREFIX_1 + 1)
#define MOD_0F2B_PREFIX_3	(MOD_0F2B_PREFIX_2 + 1)
#define MOD_0F51		(MOD_0F2B_PREFIX_3 + 1)
#define MOD_0F71_REG_2		(MOD_0F51 + 1)
#define MOD_0F71_REG_4		(MOD_0F71_REG_2 + 1)
#define MOD_0F71_REG_6		(MOD_0F71_REG_4 + 1)
#define MOD_0F72_REG_2		(MOD_0F71_REG_6 + 1)
#define MOD_0F72_REG_4		(MOD_0F72_REG_2 + 1)
#define MOD_0F72_REG_6		(MOD_0F72_REG_4 + 1)
#define MOD_0F73_REG_2		(MOD_0F72_REG_6 + 1)
#define MOD_0F73_REG_3		(MOD_0F73_REG_2 + 1)
#define MOD_0F73_REG_6		(MOD_0F73_REG_3 + 1)
#define MOD_0F73_REG_7		(MOD_0F73_REG_6 + 1)
#define MOD_0FAE_REG_0		(MOD_0F73_REG_7 + 1)
#define MOD_0FAE_REG_1		(MOD_0FAE_REG_0 + 1)
#define MOD_0FAE_REG_2		(MOD_0FAE_REG_1 + 1)
#define MOD_0FAE_REG_3		(MOD_0FAE_REG_2 + 1)
#define MOD_0FAE_REG_4		(MOD_0FAE_REG_3 + 1)
#define MOD_0FAE_REG_5		(MOD_0FAE_REG_4 + 1)
#define MOD_0FAE_REG_6		(MOD_0FAE_REG_5 + 1)
#define MOD_0FAE_REG_7		(MOD_0FAE_REG_6 + 1)
#define MOD_0FB2		(MOD_0FAE_REG_7 + 1)
#define MOD_0FB4		(MOD_0FB2 + 1)
#define MOD_0FB5		(MOD_0FB4 + 1)
#define MOD_0FC7_REG_6		(MOD_0FB5 + 1)
#define MOD_0FC7_REG_7		(MOD_0FC7_REG_6 + 1)
#define MOD_0FD7		(MOD_0FC7_REG_7 + 1)
#define MOD_0FE7_PREFIX_2	(MOD_0FD7 + 1)
#define MOD_0FF0_PREFIX_3	(MOD_0FE7_PREFIX_2 + 1)
#define MOD_0F382A_PREFIX_2	(MOD_0FF0_PREFIX_3 + 1)
#define MOD_62_32BIT		(MOD_0F382A_PREFIX_2 + 1)
#define MOD_C4_32BIT		(MOD_62_32BIT + 1)
#define MOD_C5_32BIT		(MOD_C4_32BIT + 1)
#define MOD_VEX_12_PREFIX_0	(MOD_C5_32BIT + 1)
#define MOD_VEX_13		(MOD_VEX_12_PREFIX_0 + 1)
#define MOD_VEX_16_PREFIX_0	(MOD_VEX_13 + 1)
#define MOD_VEX_17		(MOD_VEX_16_PREFIX_0 + 1)
#define MOD_VEX_2B		(MOD_VEX_17 + 1)
#define MOD_VEX_51		(MOD_VEX_2B + 1)
#define MOD_VEX_71_REG_2	(MOD_VEX_51 + 1)
#define MOD_VEX_71_REG_4	(MOD_VEX_71_REG_2 + 1)
#define MOD_VEX_71_REG_6	(MOD_VEX_71_REG_4 + 1)
#define MOD_VEX_72_REG_2	(MOD_VEX_71_REG_6 + 1)
#define MOD_VEX_72_REG_4	(MOD_VEX_72_REG_2 + 1)
#define MOD_VEX_72_REG_6	(MOD_VEX_72_REG_4 + 1)
#define MOD_VEX_73_REG_2	(MOD_VEX_72_REG_6 + 1)
#define MOD_VEX_73_REG_3	(MOD_VEX_73_REG_2 + 1)
#define MOD_VEX_73_REG_6	(MOD_VEX_73_REG_3 + 1)
#define MOD_VEX_73_REG_7	(MOD_VEX_73_REG_6 + 1)
#define MOD_VEX_AE_REG_2	(MOD_VEX_73_REG_7 + 1)
#define MOD_VEX_AE_REG_3	(MOD_VEX_AE_REG_2 + 1)
#define MOD_VEX_D7_PREFIX_2	(MOD_VEX_AE_REG_3 + 1)
#define MOD_VEX_E7_PREFIX_2	(MOD_VEX_D7_PREFIX_2 + 1)
#define MOD_VEX_F0_PREFIX_3	(MOD_VEX_E7_PREFIX_2 + 1)
#define MOD_VEX_3818_PREFIX_2	(MOD_VEX_F0_PREFIX_3 + 1)
#define MOD_VEX_3819_PREFIX_2	(MOD_VEX_3818_PREFIX_2 + 1)
#define MOD_VEX_381A_PREFIX_2	(MOD_VEX_3819_PREFIX_2 + 1)
#define MOD_VEX_382A_PREFIX_2	(MOD_VEX_381A_PREFIX_2 + 1)
#define MOD_VEX_382C_PREFIX_2	(MOD_VEX_382A_PREFIX_2 + 1)
#define MOD_VEX_382D_PREFIX_2	(MOD_VEX_382C_PREFIX_2 + 1)
#define MOD_VEX_382E_PREFIX_2	(MOD_VEX_382D_PREFIX_2 + 1)
#define MOD_VEX_382F_PREFIX_2	(MOD_VEX_382E_PREFIX_2 + 1)

#define RM_0F01_REG_0		0
#define RM_0F01_REG_1		(RM_0F01_REG_0 + 1)
#define RM_0F01_REG_2		(RM_0F01_REG_1 + 1)
#define RM_0F01_REG_3		(RM_0F01_REG_2 + 1)
#define RM_0F01_REG_7		(RM_0F01_REG_3 + 1)
#define RM_0FAE_REG_5		(RM_0F01_REG_7 + 1)
#define RM_0FAE_REG_6		(RM_0FAE_REG_5 + 1)
#define RM_0FAE_REG_7		(RM_0FAE_REG_6 + 1)

#define PREFIX_90		0
#define PREFIX_0F10		(PREFIX_90 + 1)
#define PREFIX_0F11		(PREFIX_0F10 + 1)
#define PREFIX_0F12		(PREFIX_0F11 + 1)
#define PREFIX_0F16		(PREFIX_0F12 + 1)
#define PREFIX_0F2A		(PREFIX_0F16 + 1)
#define PREFIX_0F2B		(PREFIX_0F2A + 1)
#define PREFIX_0F2C		(PREFIX_0F2B + 1)
#define PREFIX_0F2D		(PREFIX_0F2C + 1)
#define PREFIX_0F2E		(PREFIX_0F2D + 1)
#define PREFIX_0F2F		(PREFIX_0F2E + 1)
#define PREFIX_0F51		(PREFIX_0F2F + 1)
#define PREFIX_0F52		(PREFIX_0F51 + 1)
#define PREFIX_0F53		(PREFIX_0F52 + 1)
#define PREFIX_0F58		(PREFIX_0F53 + 1)
#define PREFIX_0F59		(PREFIX_0F58 + 1)
#define PREFIX_0F5A		(PREFIX_0F59 + 1)
#define PREFIX_0F5B		(PREFIX_0F5A + 1)
#define PREFIX_0F5C		(PREFIX_0F5B + 1)
#define PREFIX_0F5D		(PREFIX_0F5C + 1)
#define PREFIX_0F5E		(PREFIX_0F5D + 1)
#define PREFIX_0F5F		(PREFIX_0F5E + 1)
#define PREFIX_0F60		(PREFIX_0F5F + 1)
#define PREFIX_0F61		(PREFIX_0F60 + 1)
#define PREFIX_0F62		(PREFIX_0F61 + 1)
#define PREFIX_0F6C		(PREFIX_0F62 + 1)
#define PREFIX_0F6D		(PREFIX_0F6C + 1)
#define PREFIX_0F6F		(PREFIX_0F6D + 1)
#define PREFIX_0F70		(PREFIX_0F6F + 1)
#define PREFIX_0F73_REG_3	(PREFIX_0F70 + 1)
#define PREFIX_0F73_REG_7	(PREFIX_0F73_REG_3 + 1)
#define PREFIX_0F78		(PREFIX_0F73_REG_7 + 1)
#define PREFIX_0F79		(PREFIX_0F78 + 1)
#define PREFIX_0F7C		(PREFIX_0F79 + 1)
#define PREFIX_0F7D		(PREFIX_0F7C + 1)
#define PREFIX_0F7E		(PREFIX_0F7D + 1)
#define PREFIX_0F7F		(PREFIX_0F7E + 1)
#define PREFIX_0FB8		(PREFIX_0F7F + 1)
#define PREFIX_0FBD		(PREFIX_0FB8 + 1)
#define PREFIX_0FC2		(PREFIX_0FBD + 1)
#define PREFIX_0FC3		(PREFIX_0FC2 + 1)
#define PREFIX_0FC7_REG_6	(PREFIX_0FC3 + 1)
#define PREFIX_0FD0		(PREFIX_0FC7_REG_6 + 1)
#define PREFIX_0FD6		(PREFIX_0FD0 + 1)
#define PREFIX_0FE6		(PREFIX_0FD6 + 1)
#define PREFIX_0FE7		(PREFIX_0FE6 + 1)
#define PREFIX_0FF0		(PREFIX_0FE7 + 1)
#define PREFIX_0FF7		(PREFIX_0FF0 + 1)
#define PREFIX_0F3810		(PREFIX_0FF7 + 1)
#define PREFIX_0F3814		(PREFIX_0F3810 + 1)
#define PREFIX_0F3815		(PREFIX_0F3814 + 1)
#define PREFIX_0F3817		(PREFIX_0F3815 + 1)
#define PREFIX_0F3820		(PREFIX_0F3817 + 1)
#define PREFIX_0F3821		(PREFIX_0F3820 + 1)
#define PREFIX_0F3822		(PREFIX_0F3821 + 1)
#define PREFIX_0F3823		(PREFIX_0F3822 + 1)
#define PREFIX_0F3824		(PREFIX_0F3823 + 1)
#define PREFIX_0F3825		(PREFIX_0F3824 + 1)
#define PREFIX_0F3828		(PREFIX_0F3825 + 1)
#define PREFIX_0F3829		(PREFIX_0F3828 + 1)
#define PREFIX_0F382A		(PREFIX_0F3829 + 1)
#define PREFIX_0F382B		(PREFIX_0F382A + 1)
#define PREFIX_0F3830		(PREFIX_0F382B + 1)
#define PREFIX_0F3831		(PREFIX_0F3830 + 1)
#define PREFIX_0F3832		(PREFIX_0F3831 + 1)
#define PREFIX_0F3833		(PREFIX_0F3832 + 1)
#define PREFIX_0F3834		(PREFIX_0F3833 + 1)
#define PREFIX_0F3835		(PREFIX_0F3834 + 1)
#define PREFIX_0F3837		(PREFIX_0F3835 + 1)
#define PREFIX_0F3838		(PREFIX_0F3837 + 1)
#define PREFIX_0F3839		(PREFIX_0F3838 + 1)
#define PREFIX_0F383A		(PREFIX_0F3839 + 1)
#define PREFIX_0F383B		(PREFIX_0F383A + 1)
#define PREFIX_0F383C		(PREFIX_0F383B + 1)
#define PREFIX_0F383D		(PREFIX_0F383C + 1)
#define PREFIX_0F383E		(PREFIX_0F383D + 1)
#define PREFIX_0F383F		(PREFIX_0F383E + 1)
#define PREFIX_0F3840		(PREFIX_0F383F + 1)
#define PREFIX_0F3841		(PREFIX_0F3840 + 1)
#define PREFIX_0F3880		(PREFIX_0F3841 + 1)
#define PREFIX_0F3881		(PREFIX_0F3880 + 1)
#define PREFIX_0F38DB		(PREFIX_0F3881 + 1)
#define PREFIX_0F38DC		(PREFIX_0F38DB + 1)
#define PREFIX_0F38DD		(PREFIX_0F38DC + 1)
#define PREFIX_0F38DE		(PREFIX_0F38DD + 1)
#define PREFIX_0F38DF		(PREFIX_0F38DE + 1)
#define PREFIX_0F38F0		(PREFIX_0F38DF + 1)
#define PREFIX_0F38F1		(PREFIX_0F38F0 + 1)
#define PREFIX_0F3A08		(PREFIX_0F38F1 + 1)
#define PREFIX_0F3A09		(PREFIX_0F3A08 + 1)
#define PREFIX_0F3A0A		(PREFIX_0F3A09 + 1)
#define PREFIX_0F3A0B		(PREFIX_0F3A0A + 1)
#define PREFIX_0F3A0C		(PREFIX_0F3A0B + 1)
#define PREFIX_0F3A0D		(PREFIX_0F3A0C + 1)
#define PREFIX_0F3A0E		(PREFIX_0F3A0D + 1)
#define PREFIX_0F3A14		(PREFIX_0F3A0E + 1)
#define PREFIX_0F3A15		(PREFIX_0F3A14 + 1)
#define PREFIX_0F3A16		(PREFIX_0F3A15 + 1)
#define PREFIX_0F3A17		(PREFIX_0F3A16 + 1)
#define PREFIX_0F3A20		(PREFIX_0F3A17 + 1)
#define PREFIX_0F3A21		(PREFIX_0F3A20 + 1)
#define PREFIX_0F3A22		(PREFIX_0F3A21 + 1)
#define PREFIX_0F3A40		(PREFIX_0F3A22 + 1)
#define PREFIX_0F3A41		(PREFIX_0F3A40 + 1)
#define PREFIX_0F3A42		(PREFIX_0F3A41 + 1)
#define PREFIX_0F3A44		(PREFIX_0F3A42 + 1)
#define PREFIX_0F3A60		(PREFIX_0F3A44 + 1)
#define PREFIX_0F3A61		(PREFIX_0F3A60 + 1)
#define PREFIX_0F3A62		(PREFIX_0F3A61 + 1)
#define PREFIX_0F3A63		(PREFIX_0F3A62 + 1)
#define PREFIX_0F3ADF		(PREFIX_0F3A63 + 1)
#define PREFIX_VEX_10		(PREFIX_0F3ADF + 1)
#define PREFIX_VEX_11		(PREFIX_VEX_10 + 1)
#define PREFIX_VEX_12		(PREFIX_VEX_11 + 1)
#define PREFIX_VEX_16		(PREFIX_VEX_12 + 1)
#define PREFIX_VEX_2A		(PREFIX_VEX_16 + 1)
#define PREFIX_VEX_2C		(PREFIX_VEX_2A + 1)
#define PREFIX_VEX_2D		(PREFIX_VEX_2C + 1)
#define PREFIX_VEX_2E		(PREFIX_VEX_2D + 1)
#define PREFIX_VEX_2F		(PREFIX_VEX_2E + 1)
#define PREFIX_VEX_51		(PREFIX_VEX_2F + 1)
#define PREFIX_VEX_52		(PREFIX_VEX_51 + 1)
#define PREFIX_VEX_53		(PREFIX_VEX_52 + 1)
#define PREFIX_VEX_58		(PREFIX_VEX_53 + 1)
#define PREFIX_VEX_59		(PREFIX_VEX_58 + 1)
#define PREFIX_VEX_5A		(PREFIX_VEX_59 + 1)
#define PREFIX_VEX_5B		(PREFIX_VEX_5A + 1)
#define PREFIX_VEX_5C		(PREFIX_VEX_5B + 1)
#define PREFIX_VEX_5D		(PREFIX_VEX_5C + 1)
#define PREFIX_VEX_5E		(PREFIX_VEX_5D + 1)
#define PREFIX_VEX_5F		(PREFIX_VEX_5E + 1)
#define PREFIX_VEX_60		(PREFIX_VEX_5F + 1)
#define PREFIX_VEX_61		(PREFIX_VEX_60 + 1)
#define PREFIX_VEX_62		(PREFIX_VEX_61 + 1)
#define PREFIX_VEX_63		(PREFIX_VEX_62 + 1)
#define PREFIX_VEX_64		(PREFIX_VEX_63 + 1)
#define PREFIX_VEX_65		(PREFIX_VEX_64 + 1)
#define PREFIX_VEX_66		(PREFIX_VEX_65 + 1)
#define PREFIX_VEX_67		(PREFIX_VEX_66 + 1)
#define PREFIX_VEX_68		(PREFIX_VEX_67 + 1)
#define PREFIX_VEX_69		(PREFIX_VEX_68 + 1)
#define PREFIX_VEX_6A		(PREFIX_VEX_69 + 1)
#define PREFIX_VEX_6B		(PREFIX_VEX_6A + 1)
#define PREFIX_VEX_6C		(PREFIX_VEX_6B + 1)
#define PREFIX_VEX_6D		(PREFIX_VEX_6C + 1)
#define PREFIX_VEX_6E		(PREFIX_VEX_6D + 1)
#define PREFIX_VEX_6F		(PREFIX_VEX_6E + 1)
#define PREFIX_VEX_70		(PREFIX_VEX_6F + 1)
#define PREFIX_VEX_71_REG_2	(PREFIX_VEX_70 + 1)
#define PREFIX_VEX_71_REG_4	(PREFIX_VEX_71_REG_2 + 1)
#define PREFIX_VEX_71_REG_6	(PREFIX_VEX_71_REG_4 + 1)
#define PREFIX_VEX_72_REG_2	(PREFIX_VEX_71_REG_6 + 1)
#define PREFIX_VEX_72_REG_4	(PREFIX_VEX_72_REG_2 + 1)
#define PREFIX_VEX_72_REG_6	(PREFIX_VEX_72_REG_4 + 1)
#define PREFIX_VEX_73_REG_2	(PREFIX_VEX_72_REG_6 + 1)
#define PREFIX_VEX_73_REG_3	(PREFIX_VEX_73_REG_2 + 1)
#define PREFIX_VEX_73_REG_6	(PREFIX_VEX_73_REG_3 + 1)
#define PREFIX_VEX_73_REG_7	(PREFIX_VEX_73_REG_6 + 1)
#define PREFIX_VEX_74		(PREFIX_VEX_73_REG_7 + 1)
#define PREFIX_VEX_75		(PREFIX_VEX_74 + 1)
#define PREFIX_VEX_76		(PREFIX_VEX_75 + 1)
#define PREFIX_VEX_77		(PREFIX_VEX_76 + 1)
#define PREFIX_VEX_7C		(PREFIX_VEX_77 + 1)
#define PREFIX_VEX_7D		(PREFIX_VEX_7C + 1)
#define PREFIX_VEX_7E		(PREFIX_VEX_7D + 1)
#define PREFIX_VEX_7F		(PREFIX_VEX_7E + 1)
#define PREFIX_VEX_C2		(PREFIX_VEX_7F + 1)
#define PREFIX_VEX_C4		(PREFIX_VEX_C2 + 1)
#define PREFIX_VEX_C5		(PREFIX_VEX_C4 + 1)
#define PREFIX_VEX_D0		(PREFIX_VEX_C5 + 1)
#define PREFIX_VEX_D1		(PREFIX_VEX_D0 + 1)
#define PREFIX_VEX_D2		(PREFIX_VEX_D1 + 1)
#define PREFIX_VEX_D3		(PREFIX_VEX_D2 + 1)
#define PREFIX_VEX_D4		(PREFIX_VEX_D3 + 1)
#define PREFIX_VEX_D5		(PREFIX_VEX_D4 + 1)
#define PREFIX_VEX_D6		(PREFIX_VEX_D5 + 1)
#define PREFIX_VEX_D7		(PREFIX_VEX_D6 + 1)
#define PREFIX_VEX_D8		(PREFIX_VEX_D7 + 1)
#define PREFIX_VEX_D9		(PREFIX_VEX_D8 + 1)
#define PREFIX_VEX_DA		(PREFIX_VEX_D9 + 1)
#define PREFIX_VEX_DB		(PREFIX_VEX_DA + 1)
#define PREFIX_VEX_DC		(PREFIX_VEX_DB + 1)
#define PREFIX_VEX_DD		(PREFIX_VEX_DC + 1)
#define PREFIX_VEX_DE		(PREFIX_VEX_DD + 1)
#define PREFIX_VEX_DF		(PREFIX_VEX_DE + 1)
#define PREFIX_VEX_E0		(PREFIX_VEX_DF + 1)
#define PREFIX_VEX_E1		(PREFIX_VEX_E0 + 1)
#define PREFIX_VEX_E2		(PREFIX_VEX_E1 + 1)
#define PREFIX_VEX_E3		(PREFIX_VEX_E2 + 1)
#define PREFIX_VEX_E4		(PREFIX_VEX_E3 + 1)
#define PREFIX_VEX_E5		(PREFIX_VEX_E4 + 1)
#define PREFIX_VEX_E6		(PREFIX_VEX_E5 + 1)
#define PREFIX_VEX_E7		(PREFIX_VEX_E6 + 1)
#define PREFIX_VEX_E8		(PREFIX_VEX_E7 + 1)
#define PREFIX_VEX_E9		(PREFIX_VEX_E8 + 1)
#define PREFIX_VEX_EA		(PREFIX_VEX_E9 + 1)
#define PREFIX_VEX_EB		(PREFIX_VEX_EA + 1)
#define PREFIX_VEX_EC		(PREFIX_VEX_EB + 1)
#define PREFIX_VEX_ED		(PREFIX_VEX_EC + 1)
#define PREFIX_VEX_EE		(PREFIX_VEX_ED + 1)
#define PREFIX_VEX_EF		(PREFIX_VEX_EE + 1)
#define PREFIX_VEX_F0		(PREFIX_VEX_EF + 1)
#define PREFIX_VEX_F1		(PREFIX_VEX_F0 + 1)
#define PREFIX_VEX_F2		(PREFIX_VEX_F1 + 1)
#define PREFIX_VEX_F3		(PREFIX_VEX_F2 + 1)
#define PREFIX_VEX_F4		(PREFIX_VEX_F3 + 1)
#define PREFIX_VEX_F5		(PREFIX_VEX_F4 + 1)
#define PREFIX_VEX_F6		(PREFIX_VEX_F5 + 1)
#define PREFIX_VEX_F7		(PREFIX_VEX_F6 + 1)
#define PREFIX_VEX_F8		(PREFIX_VEX_F7 + 1)
#define PREFIX_VEX_F9		(PREFIX_VEX_F8 + 1)
#define PREFIX_VEX_FA		(PREFIX_VEX_F9 + 1)
#define PREFIX_VEX_FB		(PREFIX_VEX_FA + 1)
#define PREFIX_VEX_FC		(PREFIX_VEX_FB + 1)
#define PREFIX_VEX_FD		(PREFIX_VEX_FC + 1)
#define PREFIX_VEX_FE		(PREFIX_VEX_FD + 1)
#define PREFIX_VEX_3800		(PREFIX_VEX_FE + 1)
#define PREFIX_VEX_3801		(PREFIX_VEX_3800 + 1)
#define PREFIX_VEX_3802		(PREFIX_VEX_3801 + 1)
#define PREFIX_VEX_3803		(PREFIX_VEX_3802 + 1)
#define PREFIX_VEX_3804		(PREFIX_VEX_3803 + 1)
#define PREFIX_VEX_3805		(PREFIX_VEX_3804 + 1)
#define PREFIX_VEX_3806		(PREFIX_VEX_3805 + 1)
#define PREFIX_VEX_3807		(PREFIX_VEX_3806 + 1)
#define PREFIX_VEX_3808		(PREFIX_VEX_3807 + 1)
#define PREFIX_VEX_3809		(PREFIX_VEX_3808 + 1)
#define PREFIX_VEX_380A		(PREFIX_VEX_3809 + 1)
#define PREFIX_VEX_380B		(PREFIX_VEX_380A + 1)
#define PREFIX_VEX_380C		(PREFIX_VEX_380B + 1)
#define PREFIX_VEX_380D		(PREFIX_VEX_380C + 1)
#define PREFIX_VEX_380E		(PREFIX_VEX_380D + 1)
#define PREFIX_VEX_380F		(PREFIX_VEX_380E + 1)
#define PREFIX_VEX_3817		(PREFIX_VEX_380F + 1)
#define PREFIX_VEX_3818		(PREFIX_VEX_3817 + 1)
#define PREFIX_VEX_3819		(PREFIX_VEX_3818 + 1)
#define PREFIX_VEX_381A		(PREFIX_VEX_3819 + 1)
#define PREFIX_VEX_381C		(PREFIX_VEX_381A + 1)
#define PREFIX_VEX_381D		(PREFIX_VEX_381C + 1)
#define PREFIX_VEX_381E		(PREFIX_VEX_381D + 1)
#define PREFIX_VEX_3820		(PREFIX_VEX_381E + 1)
#define PREFIX_VEX_3821		(PREFIX_VEX_3820 + 1)
#define PREFIX_VEX_3822		(PREFIX_VEX_3821 + 1)
#define PREFIX_VEX_3823		(PREFIX_VEX_3822 + 1)
#define PREFIX_VEX_3824		(PREFIX_VEX_3823 + 1)
#define PREFIX_VEX_3825		(PREFIX_VEX_3824 + 1)
#define PREFIX_VEX_3828		(PREFIX_VEX_3825 + 1)
#define PREFIX_VEX_3829		(PREFIX_VEX_3828 + 1)
#define PREFIX_VEX_382A		(PREFIX_VEX_3829 + 1)
#define PREFIX_VEX_382B		(PREFIX_VEX_382A + 1)
#define PREFIX_VEX_382C		(PREFIX_VEX_382B + 1)
#define PREFIX_VEX_382D		(PREFIX_VEX_382C + 1)
#define PREFIX_VEX_382E		(PREFIX_VEX_382D + 1)
#define PREFIX_VEX_382F		(PREFIX_VEX_382E + 1)
#define PREFIX_VEX_3830		(PREFIX_VEX_382F + 1)
#define PREFIX_VEX_3831		(PREFIX_VEX_3830 + 1)
#define PREFIX_VEX_3832		(PREFIX_VEX_3831 + 1)
#define PREFIX_VEX_3833		(PREFIX_VEX_3832 + 1)
#define PREFIX_VEX_3834		(PREFIX_VEX_3833 + 1)
#define PREFIX_VEX_3835		(PREFIX_VEX_3834 + 1)
#define PREFIX_VEX_3837		(PREFIX_VEX_3835 + 1)
#define PREFIX_VEX_3838		(PREFIX_VEX_3837 + 1)
#define PREFIX_VEX_3839		(PREFIX_VEX_3838 + 1)
#define PREFIX_VEX_383A		(PREFIX_VEX_3839 + 1)
#define PREFIX_VEX_383B		(PREFIX_VEX_383A + 1)
#define PREFIX_VEX_383C		(PREFIX_VEX_383B + 1)
#define PREFIX_VEX_383D		(PREFIX_VEX_383C + 1)
#define PREFIX_VEX_383E		(PREFIX_VEX_383D + 1)
#define PREFIX_VEX_383F		(PREFIX_VEX_383E + 1)
#define PREFIX_VEX_3840		(PREFIX_VEX_383F + 1)
#define PREFIX_VEX_3841		(PREFIX_VEX_3840 + 1)
#define PREFIX_VEX_3896		(PREFIX_VEX_3841 + 1)
#define PREFIX_VEX_3897		(PREFIX_VEX_3896 + 1)
#define PREFIX_VEX_3898		(PREFIX_VEX_3897 + 1)
#define PREFIX_VEX_3899		(PREFIX_VEX_3898 + 1)
#define PREFIX_VEX_389A		(PREFIX_VEX_3899 + 1)
#define PREFIX_VEX_389B		(PREFIX_VEX_389A + 1)
#define PREFIX_VEX_389C		(PREFIX_VEX_389B + 1)
#define PREFIX_VEX_389D		(PREFIX_VEX_389C + 1)
#define PREFIX_VEX_389E		(PREFIX_VEX_389D + 1)
#define PREFIX_VEX_389F		(PREFIX_VEX_389E + 1)
#define PREFIX_VEX_38A6		(PREFIX_VEX_389F + 1)
#define PREFIX_VEX_38A7		(PREFIX_VEX_38A6 + 1)
#define PREFIX_VEX_38A8		(PREFIX_VEX_38A7 + 1)
#define PREFIX_VEX_38A9		(PREFIX_VEX_38A8 + 1)
#define PREFIX_VEX_38AA		(PREFIX_VEX_38A9 + 1)
#define PREFIX_VEX_38AB		(PREFIX_VEX_38AA + 1)
#define PREFIX_VEX_38AC		(PREFIX_VEX_38AB + 1)
#define PREFIX_VEX_38AD		(PREFIX_VEX_38AC + 1)
#define PREFIX_VEX_38AE		(PREFIX_VEX_38AD + 1)
#define PREFIX_VEX_38AF		(PREFIX_VEX_38AE + 1)
#define PREFIX_VEX_38B6		(PREFIX_VEX_38AF + 1)
#define PREFIX_VEX_38B7		(PREFIX_VEX_38B6 + 1)
#define PREFIX_VEX_38B8		(PREFIX_VEX_38B7 + 1)
#define PREFIX_VEX_38B9		(PREFIX_VEX_38B8 + 1)
#define PREFIX_VEX_38BA		(PREFIX_VEX_38B9 + 1)
#define PREFIX_VEX_38BB		(PREFIX_VEX_38BA + 1)
#define PREFIX_VEX_38BC		(PREFIX_VEX_38BB + 1)
#define PREFIX_VEX_38BD		(PREFIX_VEX_38BC + 1)
#define PREFIX_VEX_38BE		(PREFIX_VEX_38BD + 1)
#define PREFIX_VEX_38BF		(PREFIX_VEX_38BE + 1)
#define PREFIX_VEX_38DB		(PREFIX_VEX_38BF + 1)
#define PREFIX_VEX_38DC		(PREFIX_VEX_38DB + 1)
#define PREFIX_VEX_38DD		(PREFIX_VEX_38DC + 1)
#define PREFIX_VEX_38DE		(PREFIX_VEX_38DD + 1)
#define PREFIX_VEX_38DF		(PREFIX_VEX_38DE + 1)
#define PREFIX_VEX_3A04		(PREFIX_VEX_38DF + 1)
#define PREFIX_VEX_3A05		(PREFIX_VEX_3A04 + 1)
#define PREFIX_VEX_3A06		(PREFIX_VEX_3A05 + 1)
#define PREFIX_VEX_3A08		(PREFIX_VEX_3A06 + 1)
#define PREFIX_VEX_3A09		(PREFIX_VEX_3A08 + 1)
#define PREFIX_VEX_3A0A		(PREFIX_VEX_3A09 + 1)
#define PREFIX_VEX_3A0B		(PREFIX_VEX_3A0A + 1)
#define PREFIX_VEX_3A0C		(PREFIX_VEX_3A0B + 1)
#define PREFIX_VEX_3A0D		(PREFIX_VEX_3A0C + 1)
#define PREFIX_VEX_3A0E		(PREFIX_VEX_3A0D + 1)
#define PREFIX_VEX_3A0F		(PREFIX_VEX_3A0E + 1)
#define PREFIX_VEX_3A14		(PREFIX_VEX_3A0F + 1)
#define PREFIX_VEX_3A15		(PREFIX_VEX_3A14 + 1)
#define PREFIX_VEX_3A16		(PREFIX_VEX_3A15 + 1)
#define PREFIX_VEX_3A17		(PREFIX_VEX_3A16 + 1)
#define PREFIX_VEX_3A18		(PREFIX_VEX_3A17 + 1)
#define PREFIX_VEX_3A19		(PREFIX_VEX_3A18 + 1)
#define PREFIX_VEX_3A20		(PREFIX_VEX_3A19 + 1)
#define PREFIX_VEX_3A21		(PREFIX_VEX_3A20 + 1)
#define PREFIX_VEX_3A22		(PREFIX_VEX_3A21 + 1)
#define PREFIX_VEX_3A40		(PREFIX_VEX_3A22 + 1)
#define PREFIX_VEX_3A41		(PREFIX_VEX_3A40 + 1)
#define PREFIX_VEX_3A42		(PREFIX_VEX_3A41 + 1)
#define PREFIX_VEX_3A44		(PREFIX_VEX_3A42 + 1)
#define PREFIX_VEX_3A4A		(PREFIX_VEX_3A44 + 1)
#define PREFIX_VEX_3A4B		(PREFIX_VEX_3A4A + 1)
#define PREFIX_VEX_3A4C		(PREFIX_VEX_3A4B + 1)
#define PREFIX_VEX_3A5C		(PREFIX_VEX_3A4C + 1)
#define PREFIX_VEX_3A5D		(PREFIX_VEX_3A5C + 1)
#define PREFIX_VEX_3A5E		(PREFIX_VEX_3A5D + 1)
#define PREFIX_VEX_3A5F		(PREFIX_VEX_3A5E + 1)
#define PREFIX_VEX_3A60		(PREFIX_VEX_3A5F + 1)
#define PREFIX_VEX_3A61		(PREFIX_VEX_3A60 + 1)
#define PREFIX_VEX_3A62		(PREFIX_VEX_3A61 + 1)
#define PREFIX_VEX_3A63		(PREFIX_VEX_3A62 + 1)
#define PREFIX_VEX_3A68		(PREFIX_VEX_3A63 + 1)
#define PREFIX_VEX_3A69		(PREFIX_VEX_3A68 + 1)
#define PREFIX_VEX_3A6A		(PREFIX_VEX_3A69 + 1)
#define PREFIX_VEX_3A6B		(PREFIX_VEX_3A6A + 1)
#define PREFIX_VEX_3A6C		(PREFIX_VEX_3A6B + 1)
#define PREFIX_VEX_3A6D		(PREFIX_VEX_3A6C + 1)
#define PREFIX_VEX_3A6E		(PREFIX_VEX_3A6D + 1)
#define PREFIX_VEX_3A6F		(PREFIX_VEX_3A6E + 1)
#define PREFIX_VEX_3A78		(PREFIX_VEX_3A6F + 1)
#define PREFIX_VEX_3A79		(PREFIX_VEX_3A78 + 1)
#define PREFIX_VEX_3A7A		(PREFIX_VEX_3A79 + 1)
#define PREFIX_VEX_3A7B		(PREFIX_VEX_3A7A + 1)
#define PREFIX_VEX_3A7C		(PREFIX_VEX_3A7B + 1)
#define PREFIX_VEX_3A7D		(PREFIX_VEX_3A7C + 1)
#define PREFIX_VEX_3A7E		(PREFIX_VEX_3A7D + 1)
#define PREFIX_VEX_3A7F		(PREFIX_VEX_3A7E + 1)
#define PREFIX_VEX_3ADF		(PREFIX_VEX_3A7F + 1)

#define X86_64_06		0
#define X86_64_07		(X86_64_06 + 1)
#define X86_64_0D		(X86_64_07 + 1)
#define X86_64_16		(X86_64_0D + 1)
#define X86_64_17		(X86_64_16 + 1)
#define X86_64_1E		(X86_64_17 + 1)
#define X86_64_1F		(X86_64_1E + 1)
#define X86_64_27		(X86_64_1F + 1)
#define X86_64_2F		(X86_64_27 + 1)
#define X86_64_37		(X86_64_2F + 1)
#define X86_64_3F		(X86_64_37 + 1)
#define X86_64_60		(X86_64_3F + 1)
#define X86_64_61		(X86_64_60 + 1)
#define X86_64_62		(X86_64_61 + 1)
#define X86_64_63		(X86_64_62 + 1)
#define X86_64_6D		(X86_64_63 + 1)
#define X86_64_6F		(X86_64_6D + 1)
#define X86_64_9A		(X86_64_6F + 1)
#define X86_64_C4		(X86_64_9A + 1)
#define X86_64_C5		(X86_64_C4 + 1)
#define X86_64_CE		(X86_64_C5 + 1)
#define X86_64_D4		(X86_64_CE + 1)
#define X86_64_D5		(X86_64_D4 + 1)
#define X86_64_EA		(X86_64_D5 + 1)
#define X86_64_0F01_REG_0	(X86_64_EA + 1)
#define X86_64_0F01_REG_1	(X86_64_0F01_REG_0 + 1)
#define X86_64_0F01_REG_2	(X86_64_0F01_REG_1 + 1)
#define X86_64_0F01_REG_3	(X86_64_0F01_REG_2 + 1)

#define THREE_BYTE_0F38		0
#define THREE_BYTE_0F3A		(THREE_BYTE_0F38 + 1)
#define THREE_BYTE_0F7A		(THREE_BYTE_0F3A + 1)

#define VEX_0F			0
#define VEX_0F38		(VEX_0F + 1)
#define VEX_0F3A		(VEX_0F38 + 1)

#define VEX_LEN_10_P_1	0
#define VEX_LEN_10_P_3	(VEX_LEN_10_P_1 + 1)
#define VEX_LEN_11_P_1	(VEX_LEN_10_P_3 + 1)
#define VEX_LEN_11_P_3	(VEX_LEN_11_P_1 + 1)
#define VEX_LEN_12_P_0_M_0	(VEX_LEN_11_P_3 + 1)
#define VEX_LEN_12_P_0_M_1	(VEX_LEN_12_P_0_M_0 + 1)
#define VEX_LEN_12_P_2	(VEX_LEN_12_P_0_M_1 + 1)
#define VEX_LEN_13_M_0	(VEX_LEN_12_P_2 + 1)
#define VEX_LEN_16_P_0_M_0	(VEX_LEN_13_M_0 + 1)
#define VEX_LEN_16_P_0_M_1	(VEX_LEN_16_P_0_M_0 + 1)
#define VEX_LEN_16_P_2	(VEX_LEN_16_P_0_M_1 + 1)
#define VEX_LEN_17_M_0	(VEX_LEN_16_P_2 + 1)
#define VEX_LEN_2A_P_1	(VEX_LEN_17_M_0 + 1)
#define VEX_LEN_2A_P_3	(VEX_LEN_2A_P_1 + 1)
#define VEX_LEN_2C_P_1	(VEX_LEN_2A_P_3 + 1)
#define VEX_LEN_2C_P_3	(VEX_LEN_2C_P_1 + 1)
#define VEX_LEN_2D_P_1	(VEX_LEN_2C_P_3 + 1)
#define VEX_LEN_2D_P_3	(VEX_LEN_2D_P_1 + 1)
#define VEX_LEN_2E_P_0	(VEX_LEN_2D_P_3 + 1)
#define VEX_LEN_2E_P_2	(VEX_LEN_2E_P_0 + 1)
#define VEX_LEN_2F_P_0	(VEX_LEN_2E_P_2 + 1)
#define VEX_LEN_2F_P_2	(VEX_LEN_2F_P_0 + 1)
#define VEX_LEN_51_P_1	(VEX_LEN_2F_P_2 + 1)
#define VEX_LEN_51_P_3	(VEX_LEN_51_P_1 + 1)
#define VEX_LEN_52_P_1	(VEX_LEN_51_P_3 + 1)
#define VEX_LEN_53_P_1	(VEX_LEN_52_P_1 + 1)
#define VEX_LEN_58_P_1	(VEX_LEN_53_P_1 + 1)
#define VEX_LEN_58_P_3	(VEX_LEN_58_P_1 + 1)
#define VEX_LEN_59_P_1	(VEX_LEN_58_P_3 + 1)
#define VEX_LEN_59_P_3	(VEX_LEN_59_P_1 + 1)
#define VEX_LEN_5A_P_1	(VEX_LEN_59_P_3 + 1)
#define VEX_LEN_5A_P_3	(VEX_LEN_5A_P_1 + 1)
#define VEX_LEN_5C_P_1	(VEX_LEN_5A_P_3 + 1)
#define VEX_LEN_5C_P_3	(VEX_LEN_5C_P_1 + 1)
#define VEX_LEN_5D_P_1	(VEX_LEN_5C_P_3 + 1)
#define VEX_LEN_5D_P_3	(VEX_LEN_5D_P_1 + 1)
#define VEX_LEN_5E_P_1	(VEX_LEN_5D_P_3 + 1)
#define VEX_LEN_5E_P_3	(VEX_LEN_5E_P_1 + 1)
#define VEX_LEN_5F_P_1	(VEX_LEN_5E_P_3 + 1)
#define VEX_LEN_5F_P_3	(VEX_LEN_5F_P_1 + 1)
#define VEX_LEN_60_P_2	(VEX_LEN_5F_P_3 + 1)
#define VEX_LEN_61_P_2	(VEX_LEN_60_P_2 + 1)
#define VEX_LEN_62_P_2	(VEX_LEN_61_P_2 + 1)
#define VEX_LEN_63_P_2	(VEX_LEN_62_P_2 + 1)
#define VEX_LEN_64_P_2	(VEX_LEN_63_P_2 + 1)
#define VEX_LEN_65_P_2	(VEX_LEN_64_P_2 + 1)
#define VEX_LEN_66_P_2	(VEX_LEN_65_P_2 + 1)
#define VEX_LEN_67_P_2	(VEX_LEN_66_P_2 + 1)
#define VEX_LEN_68_P_2	(VEX_LEN_67_P_2 + 1)
#define VEX_LEN_69_P_2	(VEX_LEN_68_P_2 + 1)
#define VEX_LEN_6A_P_2	(VEX_LEN_69_P_2 + 1)
#define VEX_LEN_6B_P_2	(VEX_LEN_6A_P_2 + 1)
#define VEX_LEN_6C_P_2	(VEX_LEN_6B_P_2 + 1)
#define VEX_LEN_6D_P_2	(VEX_LEN_6C_P_2 + 1)
#define VEX_LEN_6E_P_2	(VEX_LEN_6D_P_2 + 1)
#define VEX_LEN_70_P_1	(VEX_LEN_6E_P_2 + 1)
#define VEX_LEN_70_P_2	(VEX_LEN_70_P_1 + 1)
#define VEX_LEN_70_P_3	(VEX_LEN_70_P_2 + 1)
#define VEX_LEN_71_R_2_P_2	(VEX_LEN_70_P_3 + 1)
#define VEX_LEN_71_R_4_P_2	(VEX_LEN_71_R_2_P_2 + 1)
#define VEX_LEN_71_R_6_P_2	(VEX_LEN_71_R_4_P_2 + 1)
#define VEX_LEN_72_R_2_P_2	(VEX_LEN_71_R_6_P_2 + 1)
#define VEX_LEN_72_R_4_P_2	(VEX_LEN_72_R_2_P_2 + 1)
#define VEX_LEN_72_R_6_P_2	(VEX_LEN_72_R_4_P_2 + 1)
#define VEX_LEN_73_R_2_P_2	(VEX_LEN_72_R_6_P_2 + 1)
#define VEX_LEN_73_R_3_P_2	(VEX_LEN_73_R_2_P_2 + 1)
#define VEX_LEN_73_R_6_P_2	(VEX_LEN_73_R_3_P_2 + 1)
#define VEX_LEN_73_R_7_P_2	(VEX_LEN_73_R_6_P_2 + 1)
#define VEX_LEN_74_P_2	(VEX_LEN_73_R_7_P_2 + 1)
#define VEX_LEN_75_P_2	(VEX_LEN_74_P_2 + 1)
#define VEX_LEN_76_P_2	(VEX_LEN_75_P_2 + 1)
#define VEX_LEN_7E_P_1	(VEX_LEN_76_P_2 + 1)
#define VEX_LEN_7E_P_2	(VEX_LEN_7E_P_1 + 1)
#define VEX_LEN_AE_R_2_M_0	(VEX_LEN_7E_P_2 + 1)
#define VEX_LEN_AE_R_3_M_0	(VEX_LEN_AE_R_2_M_0 + 1)
#define VEX_LEN_C2_P_1	(VEX_LEN_AE_R_3_M_0 + 1)
#define VEX_LEN_C2_P_3	(VEX_LEN_C2_P_1 + 1)
#define VEX_LEN_C4_P_2	(VEX_LEN_C2_P_3 + 1)
#define VEX_LEN_C5_P_2	(VEX_LEN_C4_P_2 + 1)
#define VEX_LEN_D1_P_2	(VEX_LEN_C5_P_2 + 1)
#define VEX_LEN_D2_P_2	(VEX_LEN_D1_P_2 + 1)
#define VEX_LEN_D3_P_2	(VEX_LEN_D2_P_2 + 1)
#define VEX_LEN_D4_P_2	(VEX_LEN_D3_P_2 + 1)
#define VEX_LEN_D5_P_2	(VEX_LEN_D4_P_2 + 1)
#define VEX_LEN_D6_P_2	(VEX_LEN_D5_P_2 + 1)
#define VEX_LEN_D7_P_2_M_1	(VEX_LEN_D6_P_2 + 1)
#define VEX_LEN_D8_P_2	(VEX_LEN_D7_P_2_M_1 + 1)
#define VEX_LEN_D9_P_2	(VEX_LEN_D8_P_2 + 1)
#define VEX_LEN_DA_P_2	(VEX_LEN_D9_P_2 + 1)
#define VEX_LEN_DB_P_2	(VEX_LEN_DA_P_2 + 1)
#define VEX_LEN_DC_P_2	(VEX_LEN_DB_P_2 + 1)
#define VEX_LEN_DD_P_2	(VEX_LEN_DC_P_2 + 1)
#define VEX_LEN_DE_P_2	(VEX_LEN_DD_P_2 + 1)
#define VEX_LEN_DF_P_2	(VEX_LEN_DE_P_2 + 1)
#define VEX_LEN_E0_P_2	(VEX_LEN_DF_P_2 + 1)
#define VEX_LEN_E1_P_2	(VEX_LEN_E0_P_2 + 1)
#define VEX_LEN_E2_P_2	(VEX_LEN_E1_P_2 + 1)
#define VEX_LEN_E3_P_2	(VEX_LEN_E2_P_2 + 1)
#define VEX_LEN_E4_P_2	(VEX_LEN_E3_P_2 + 1)
#define VEX_LEN_E5_P_2	(VEX_LEN_E4_P_2 + 1)
#define VEX_LEN_E8_P_2	(VEX_LEN_E5_P_2 + 1)
#define VEX_LEN_E9_P_2	(VEX_LEN_E8_P_2 + 1)
#define VEX_LEN_EA_P_2	(VEX_LEN_E9_P_2 + 1)
#define VEX_LEN_EB_P_2	(VEX_LEN_EA_P_2 + 1)
#define VEX_LEN_EC_P_2	(VEX_LEN_EB_P_2 + 1)
#define VEX_LEN_ED_P_2	(VEX_LEN_EC_P_2 + 1)
#define VEX_LEN_EE_P_2	(VEX_LEN_ED_P_2 + 1)
#define VEX_LEN_EF_P_2	(VEX_LEN_EE_P_2 + 1)
#define VEX_LEN_F1_P_2	(VEX_LEN_EF_P_2 + 1)
#define VEX_LEN_F2_P_2	(VEX_LEN_F1_P_2 + 1)
#define VEX_LEN_F3_P_2	(VEX_LEN_F2_P_2 + 1)
#define VEX_LEN_F4_P_2	(VEX_LEN_F3_P_2 + 1)
#define VEX_LEN_F5_P_2	(VEX_LEN_F4_P_2 + 1)
#define VEX_LEN_F6_P_2	(VEX_LEN_F5_P_2 + 1)
#define VEX_LEN_F7_P_2	(VEX_LEN_F6_P_2 + 1)
#define VEX_LEN_F8_P_2	(VEX_LEN_F7_P_2 + 1)
#define VEX_LEN_F9_P_2	(VEX_LEN_F8_P_2 + 1)
#define VEX_LEN_FA_P_2	(VEX_LEN_F9_P_2 + 1)
#define VEX_LEN_FB_P_2	(VEX_LEN_FA_P_2 + 1)
#define VEX_LEN_FC_P_2	(VEX_LEN_FB_P_2 + 1)
#define VEX_LEN_FD_P_2	(VEX_LEN_FC_P_2 + 1)
#define VEX_LEN_FE_P_2	(VEX_LEN_FD_P_2 + 1)
#define VEX_LEN_3800_P_2	(VEX_LEN_FE_P_2 + 1)
#define VEX_LEN_3801_P_2	(VEX_LEN_3800_P_2 + 1)
#define VEX_LEN_3802_P_2	(VEX_LEN_3801_P_2 + 1)
#define VEX_LEN_3803_P_2	(VEX_LEN_3802_P_2 + 1)
#define VEX_LEN_3804_P_2	(VEX_LEN_3803_P_2 + 1)
#define VEX_LEN_3805_P_2	(VEX_LEN_3804_P_2 + 1)
#define VEX_LEN_3806_P_2	(VEX_LEN_3805_P_2 + 1)
#define VEX_LEN_3807_P_2	(VEX_LEN_3806_P_2 + 1)
#define VEX_LEN_3808_P_2	(VEX_LEN_3807_P_2 + 1)
#define VEX_LEN_3809_P_2	(VEX_LEN_3808_P_2 + 1)
#define VEX_LEN_380A_P_2	(VEX_LEN_3809_P_2 + 1)
#define VEX_LEN_380B_P_2	(VEX_LEN_380A_P_2 + 1)
#define VEX_LEN_3819_P_2_M_0	(VEX_LEN_380B_P_2 + 1)
#define VEX_LEN_381A_P_2_M_0	(VEX_LEN_3819_P_2_M_0 + 1)
#define VEX_LEN_381C_P_2	(VEX_LEN_381A_P_2_M_0 + 1)
#define VEX_LEN_381D_P_2	(VEX_LEN_381C_P_2 + 1)
#define VEX_LEN_381E_P_2	(VEX_LEN_381D_P_2 + 1)
#define VEX_LEN_3820_P_2	(VEX_LEN_381E_P_2 + 1)
#define VEX_LEN_3821_P_2	(VEX_LEN_3820_P_2 + 1)
#define VEX_LEN_3822_P_2	(VEX_LEN_3821_P_2 + 1)
#define VEX_LEN_3823_P_2	(VEX_LEN_3822_P_2 + 1)
#define VEX_LEN_3824_P_2	(VEX_LEN_3823_P_2 + 1)
#define VEX_LEN_3825_P_2	(VEX_LEN_3824_P_2 + 1)
#define VEX_LEN_3828_P_2	(VEX_LEN_3825_P_2 + 1)
#define VEX_LEN_3829_P_2	(VEX_LEN_3828_P_2 + 1)
#define VEX_LEN_382A_P_2_M_0	(VEX_LEN_3829_P_2 + 1)
#define VEX_LEN_382B_P_2	(VEX_LEN_382A_P_2_M_0 + 1)
#define VEX_LEN_3830_P_2	(VEX_LEN_382B_P_2 + 1)
#define VEX_LEN_3831_P_2	(VEX_LEN_3830_P_2 + 1)
#define VEX_LEN_3832_P_2	(VEX_LEN_3831_P_2 + 1)
#define VEX_LEN_3833_P_2	(VEX_LEN_3832_P_2 + 1)
#define VEX_LEN_3834_P_2	(VEX_LEN_3833_P_2 + 1)
#define VEX_LEN_3835_P_2	(VEX_LEN_3834_P_2 + 1)
#define VEX_LEN_3837_P_2	(VEX_LEN_3835_P_2 + 1)
#define VEX_LEN_3838_P_2	(VEX_LEN_3837_P_2 + 1)
#define VEX_LEN_3839_P_2	(VEX_LEN_3838_P_2 + 1)
#define VEX_LEN_383A_P_2	(VEX_LEN_3839_P_2 + 1)
#define VEX_LEN_383B_P_2	(VEX_LEN_383A_P_2 + 1)
#define VEX_LEN_383C_P_2	(VEX_LEN_383B_P_2 + 1)
#define VEX_LEN_383D_P_2	(VEX_LEN_383C_P_2 + 1)
#define VEX_LEN_383E_P_2	(VEX_LEN_383D_P_2 + 1)
#define VEX_LEN_383F_P_2	(VEX_LEN_383E_P_2 + 1)
#define VEX_LEN_3840_P_2	(VEX_LEN_383F_P_2 + 1)
#define VEX_LEN_3841_P_2	(VEX_LEN_3840_P_2 + 1)
#define VEX_LEN_38DB_P_2	(VEX_LEN_3841_P_2 + 1)
#define VEX_LEN_38DC_P_2	(VEX_LEN_38DB_P_2 + 1)
#define VEX_LEN_38DD_P_2	(VEX_LEN_38DC_P_2 + 1)
#define VEX_LEN_38DE_P_2	(VEX_LEN_38DD_P_2 + 1)
#define VEX_LEN_38DF_P_2	(VEX_LEN_38DE_P_2 + 1)
#define VEX_LEN_3A06_P_2	(VEX_LEN_38DF_P_2 + 1)
#define VEX_LEN_3A0A_P_2	(VEX_LEN_3A06_P_2 + 1)
#define VEX_LEN_3A0B_P_2	(VEX_LEN_3A0A_P_2 + 1)
#define VEX_LEN_3A0E_P_2	(VEX_LEN_3A0B_P_2 + 1)
#define VEX_LEN_3A0F_P_2	(VEX_LEN_3A0E_P_2 + 1)
#define VEX_LEN_3A14_P_2	(VEX_LEN_3A0F_P_2 + 1)
#define VEX_LEN_3A15_P_2	(VEX_LEN_3A14_P_2 + 1)
#define VEX_LEN_3A16_P_2	(VEX_LEN_3A15_P_2 + 1)
#define VEX_LEN_3A17_P_2	(VEX_LEN_3A16_P_2 + 1)
#define VEX_LEN_3A18_P_2	(VEX_LEN_3A17_P_2 + 1)
#define VEX_LEN_3A19_P_2	(VEX_LEN_3A18_P_2 + 1)
#define VEX_LEN_3A20_P_2	(VEX_LEN_3A19_P_2 + 1)
#define VEX_LEN_3A21_P_2	(VEX_LEN_3A20_P_2 + 1)
#define VEX_LEN_3A22_P_2	(VEX_LEN_3A21_P_2 + 1)
#define VEX_LEN_3A41_P_2	(VEX_LEN_3A22_P_2 + 1)
#define VEX_LEN_3A42_P_2	(VEX_LEN_3A41_P_2 + 1)
#define VEX_LEN_3A44_P_2	(VEX_LEN_3A42_P_2 + 1)
#define VEX_LEN_3A4C_P_2	(VEX_LEN_3A44_P_2 + 1)
#define VEX_LEN_3A60_P_2	(VEX_LEN_3A4C_P_2 + 1)
#define VEX_LEN_3A61_P_2	(VEX_LEN_3A60_P_2 + 1)
#define VEX_LEN_3A62_P_2	(VEX_LEN_3A61_P_2 + 1)
#define VEX_LEN_3A63_P_2	(VEX_LEN_3A62_P_2 + 1)
#define VEX_LEN_3A6A_P_2	(VEX_LEN_3A63_P_2 + 1)
#define VEX_LEN_3A6B_P_2	(VEX_LEN_3A6A_P_2 + 1)
#define VEX_LEN_3A6E_P_2	(VEX_LEN_3A6B_P_2 + 1)
#define VEX_LEN_3A6F_P_2	(VEX_LEN_3A6E_P_2 + 1)
#define VEX_LEN_3A7A_P_2	(VEX_LEN_3A6F_P_2 + 1)
#define VEX_LEN_3A7B_P_2	(VEX_LEN_3A7A_P_2 + 1)
#define VEX_LEN_3A7E_P_2	(VEX_LEN_3A7B_P_2 + 1)
#define VEX_LEN_3A7F_P_2	(VEX_LEN_3A7E_P_2 + 1)
#define VEX_LEN_3ADF_P_2	(VEX_LEN_3A7F_P_2 + 1)
@


1.201
log
@2009-10-13  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (print_insn): Always clear need_vex, need_vex_reg
	and vex_w_done.
@
text
@a507 2
#define MAX_BYTEMODE	indir_dx_reg

@


1.200
log
@2009-09-15  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_E_memory): Don't print '-' in Intel mode if
	disp == -disp.
@
text
@d9690 4
a9699 3
      need_vex = 0;
      need_vex_reg = 0;
      vex_w_done = 0;
@


1.199
log
@2009-09-09  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (vex_len_table): Change VEX_LEN_AE_R_X_M0 to
	VEX_LEN_AE_R_X_M_0 in comments.
@
text
@d11110 1
a11110 1
	      else if (modrm.mod != 1)
@


1.198
log
@        Updated sources to avoid using the identifier name "new", which is a
        keyword in c++.

        * bfd/aoutx.h (NAME (aout, make_empty_symbol)): Rename variable
        new to new_symbol.
        * bfd/coffgen.c (coff_make_empty_symbol)
        (coff_bfd_make_debug_symbol): Rename variable new to new_symbol.
        * bfd/cpu-ia64-opc.c (ext_reg, ins_imms_scaled): Rename variable
        new to new_insn.
        * bfd/doc/chew.c (newentry, add_intrinsic): Rename variable new to
        new_d.
        * bfd/ecoff.c (_bfd_ecoff_make_empty_symbol): Rename variable new
        to new_symbol.
        * bfd/elf32-m68k.c (elf_m68k_get_got_entry_type): Rename argument
        new to new_reloc.
        * bfd/hash.c (bfd_hash_lookup): Rename variable new to new_string.
        * bfd/ieee.c (ieee_make_empty_symbol): Rename variable new to
        new_symbol.
        * bfd/linker.c (bfd_new_link_order): Rename variable new to
        new_lo.
        * bfd/mach-o.c (bfd_mach_o_sizeof_headers): Rename variable new to
        symbol.
        * bfd/oasys.c (oasys_make_empty_symbol): Rename variable new to
        new_symbol_type.
        * bfd/pdp11.c (NAME (aout, make_empty_symbol)): Rename variable
        new to new_symbol_type.
        * bfd/plugin.c (bfd_plugin_make_empty_symbol): Rename variable new
        to new_symbol.
        * bfd/rs6000-core.c (CoreHdr, VmInfo): Rename union member new to
        new_dump.
        (read_hdr, rs6000coff_core_p)
        (rs6000coff_core_file_matches_executable_p)
        (rs6000coff_core_file_failing_command)
        (rs6000coff_core_file_failing_signal): Updated function to use new
        union member name.
        * bfd/som.c (som_make_empty_symbol): Rename variable new to
        new_symbol_type.
        * bfd/syms.c (_bfd_generic_make_empty_symbol): Rename variable new
        to new_symbol.
        * bfd/tekhex.c (first_phase, tekhex_make_empty_symbol): Rename
        variable new to new_symbol.
        * binutils/nlmconv.c (main): Rename variable new to new_name.
        * gas/config/tc-arm.c (insert_reg_alias): Rename variable new to
        new_reg.
        * gas/config/tc-dlx.c (parse_operand): Rename variable new to
        new_pos.
        * gas/config/tc-ia64.c (ia64_gen_real_reloc_type): Rename variable
        new to newr.
        * gas/config/tc-mcore.c (parse_exp, parse_imm): Rename variable
        new to new_pointer.
        * gas/config/tc-microblaze.c (parse_exp, parse_imm, check_got):
        Change name from new to new_pointer.
        * gas/config/tc-or32.c (parse_operand): Rename variable new to
        new_pointer.
        * gas/config/tc-pdp11.c (md_assemble): Rename variable new to
        new_pointer.
        * gas/config/tc-pj.c (alias): Change argument new to new_name.
        * gas/config/tc-score.c (s3_build_score_ops_hsh): Rename variable
        new to new_opcode. (s3_build_dependency_insn_hsh) Rename variable
        new to new_i2n. (s3_convert): Rename variables old and new to
        r_old and r_new.
        * gas/config/tc-score7.c (s7_build_score_ops_hsh): Rename variable
        new to new_opcode. (s7_build_dependency_insn_hsh): Rename variable
        new to new_i2d. (s7_b32_relax_to_b16, s7_convert_frag): Rename
        variables old and new to r_old and r_new.
        * gas/config/tc-sh.c (parse_exp): Rename variable new to
        new_pointer.
        * gas/config/tc-sh64.c (shmedia_parse_exp): Rename variable new to
        new_pointer.
        * gas/config/tc-tic4x.c (tic4x_operand_parse): Rename variable new
        to new_pointer.
        * gas/config/tc-z8k.c (parse_exp): Rename variable new to
        new_pointer.
        * gas/listing.c (listing_newline): Rename variable new to new_i.
        * ld/ldexp.c (exp_intop, exp_bigintop, exp_relop, exp_binop)
        (exp_trinop, exp_unop, exp_nameop, exp_assop): Rename variable new
        to new_e.
        * ld/ldfile.c (ldfile_add_library_path): Rename variable new to
        new_dirs. (ldfile_add_arch): Rename variable new to new_arch.
        * ld/ldlang.c (new_statement, lang_final, lang_add_wild)
        (lang_target, lang_add_fill, lang_add_data, lang_add_assignment)
        (lang_add_insert): Rename variable new to new_stmt. (new_afile):
        Added missing cast. (lang_memory_region_lookup): Rename variable
        new to new_region. (init_os): Rename variable new to
        new_userdata. (lang_add_section): Rename variable new to
        new_section. (ldlang_add_undef): Rename variable new to
        new_undef. (realsymbol): Rename variable new to new_name.
        * opcodes/z8kgen.c (internal, gas): Rename variable new to new_op.

        Updated sources to avoid using the identifier name "template",
        which is a keyword in c++.

        * bfd/elf32-arm.c (struct stub_def): Rename member template to
        template_sequence. (arm_build_one_stub,
        find_stub_size_and_template, arm_size_one_stub, arm_map_one_stub):
        Rename variable template to template_sequence.
        * bfd/elfxx-ia64.c (elfNN_ia64_relax_br, elfNN_ia64_relax_brl):
        Rename variable template to template_val.
        * gas/config/tc-arm.c (struct asm_cond, struct asm_psr, struct
        asm_barrier_opt): Change member template to
        template_name. (md_begin): Update code to reflect new member
        names.
        * gas/config/tc-i386.c (struct templates, struct _i386_insn)
        (match_template, cpu_flags_match, match_reg_size, match_mem_size)
        (operand_size_match, md_begin, i386_print_statistics, pi)
        (build_vex_prefix, md_assemble, parse_insn, optimize_imm)
        (optimize_disp): Updated code to use new names. (parse_insn):
        Added casts.
        * gas/config/tc-ia64.c (dot_template, emit_one_bundle): Updated
        code to use new names.
        * gas/config/tc-score.c (struct s3_asm_opcode): Renamed member
        template to template_name. (s3_parse_16_32_inst, s3_parse_48_inst,
        s3_do_macro_ldst_label, s3_build_score_ops_hsh): Update code to
        use new names.
        * gas/config/tc-score7.c (struct s7_asm_opcode): Renamed member
        template to template_name. (s7_parse_16_32_inst,
        s7_do_macro_ldst_label, s7_build_score_ops_hsh): Update code to
        use new names.
        * gas/config/tc-tic30.c (md_begin, struct tic30_insn)
        (md_assemble): Update code to use new names.
        * gas/config/tc-tic54x.c (struct _tic54x_insn, md_begin)
        (optimize_insn, tic54x_parse_insn, next_line_shows_parallel):
        Update code to use new names.
        * include/opcode/tic30.h (template): Rename type template to
        insn_template. Updated code to use new name.
        * include/opcode/tic54x.h (template): Rename type template to
        insn_template.
        * opcodes/cris-dis.c (bytes_to_skip): Update code to use new name.
        * opcodes/i386-dis.c (putop): Update code to use new name.
        * opcodes/i386-gen.c (process_i386_opcodes): Update code to use
        new name.
        * opcodes/i386-opc.h (struct template): Rename struct template to
        insn_template. Update code accordingly.
        * opcodes/i386-tbl.h (i386_optab): Update type to use new name.
        * opcodes/ia64-dis.c (print_insn_ia64): Rename variable template
        to template_val.
        * opcodes/tic30-dis.c (struct instruction, get_tic30_instruction):
        Update code to use new name.
        * opcodes/tic54x-dis.c (has_lkaddr, get_insn_size)
        (print_parallel_instruction, print_insn_tic54x, tic54x_get_insn):
        Update code to use new name.
        * opcodes/tic54x-opc.c (tic54x_unknown_opcode, tic54x_optab):
        Update type to new name.
@
text
@d7635 1
a7635 1
  /* VEX_LEN_AE_R_2_M0 */
d7641 1
a7641 1
  /* VEX_LEN_AE_R_3_M0 */
@


1.197
log
@bfd/

2009-07-25  H.J. Lu  <hongjiu.lu@@intel.com>

	* archures.c (bfd_architecture): Add bfd_arch_l1om.
	(bfd_l1om_arch): New.
	(bfd_archures_list): Add &bfd_l1om_arch.
	* bfd-in2.h: Regenerated.

	* config.bfd (targ64_selvecs): Add bfd_elf64_l1om_vec if
	bfd_elf64_x86_64_vec is supported.  Add bfd_elf64_l1om_freebsd_vec
	if bfd_elf64_x86_64_freebsd_vec is supported.
	(targ_selvecs): Likewise.

	* configure.in: Support bfd_elf64_l1om_vec and
	bfd_elf64_l1om_freebsd_vec.
	* configure: Regenerated.

	* cpu-l1om.c: New.

	* elf64-x86-64.c (elf64_l1om_elf_object_p): New.
	(bfd_elf64_l1om_vec): Likewise.
	(bfd_elf64_l1om_freebsd_vec): Likewise.

	* Makefile.am (ALL_MACHINES): Add cpu-l1om.lo.
	(ALL_MACHINES_CFILES): Add cpu-l1om.c.
	* Makefile.in: Regenerated.

	* targets.c (bfd_elf64_l1om_vec): New.
	(bfd_elf64_l1om_freebsd_vec): Likewise.
	(_bfd_target_vector): Add bfd_elf64_l1om_vec and
	bfd_elf64_l1om_freebsd_vec.

binutils/

2009-07-25  H.J. Lu  <hongjiu.lu@@intel.com>

	* readelf.c (guess_is_rela): Handle EM_L1OM.
	(dump_relocations): Likewise.
	(get_machine_name): Likewise.
	(get_section_type_name): Likewise.
	(get_elf_section_flags): Likewise.
	(get_symbol_index_type): Likewise.
	(is_32bit_abs_reloc): Likewise.
	(is_32bit_pcrel_reloc): Likewise.
	(is_64bit_abs_reloc): Likewise.
	(is_64bit_pcrel_reloc): Likewise.
	(is_none_reloc): Likewise.

gas/

2009-07-25  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c (cpu_arch): Add l1om.
	(check_cpu_arch_compatible): New.
	(set_cpu_arch): Use it.
	(i386_arch): New.
	(i386_mach): Return bfd_mach_l1om for Intel L1OM.
	(md_show_usage): Display l1om.
	(i386_target_format): Return ELF_TARGET_L1OM_FORMAT if
	cpu_arch_isa_flags.bitfield.cpul1om is set.

	* config/tc-i386.h (TARGET_ARCH): Use (i386_arch ()).
	(i386_arch): New.
	(ELF_TARGET_L1OM_FORMAT): Likewise.

	* doc/c-i386.texi: Document l1om.

gas/testsuite/

2009-07-25  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/l1om.d: New.
	* gas/i386/l1om-inval.l: Likewise.
	* gas/i386/l1om-inval.s: Likewise.

	* gas/i386/i386.exp: Run l1om-inval and l1om.

include/elf/

2009-07-25  H.J. Lu  <hongjiu.lu@@intel.com>

	* common.h (EM_L1OM): New.

ld/

2009-07-25  H.J. Lu  <hongjiu.lu@@intel.com>

	* configure.tgt (targ64_extra_emuls): Add elf_l1om if elf_x86_64
	is supported.  Add elf_l1om_fbsd if elf_x86_64_fbsd is supported.
	(targ_extra_emuls): Likewise.

	* Makefile.am (ALL_64_EMULATIONS): Add eelf_l1om.o and
	eelf_l1om_fbsd.o
	(eelf_l1om.c): New.
	(eelf_l1om_fbsd.c): Likewise.
	* Makefile.in: Regenerated.

	* emulparams/elf_l1om.sh: New.
	* emulparams/elf_l1om_fbsd.sh: Likewise.

ld/testsuite/

2009-07-25  H.J. Lu  <hongjiu.lu@@intel.com>

	* ld-x86-64/abs-l1om.d: New.
	* ld-x86-64/protected2-l1om.d: Likewise.
	* ld-x86-64/protected3-l1om.d: Likewise.

	* ld-x86-64/x86-64.exp: Run abs-l1om, protected2-l1om and
	protected3-l1om.

opcodes/

2009-07-25  H.J. Lu  <hongjiu.lu@@intel.com>

	* configure.in: Handle bfd_l1om_arch.
	* disassemble.c (disassembler): Likewise.

	* configure: Regenerated.

	* i386-dis.c (print_insn): Handle bfd_mach_l1om and
	bfd_mach_l1om_intel_syntax.  Use 8 bytes per line for Intel L1OM.

	* i386-gen.c (cpu_flag_init): Set CPU_UNKNOWN_FLAGS to ~CpuL1OM.
	Add CPU_L1OM_FLAGS.
	(cpu_flags): Add CpuL1OM.
	(set_bitfield): Take an argument to set the value field.
	(process_i386_cpu_flag): Support ~CpuXXX and ~(CpuXXX|CpuYYY).
	(process_i386_opcode_modifier): Updated.
	(process_i386_operand_type): Likewise.
	* i386-init.h: Regenerated.
	* i386-tbl.h: Likewise.

	* i386-opc.h (CpuL1OM): New.
	(CpuXsave): Updated.
	(i386_cpu_flags): Add cpul1om.
@
text
@d10187 1
a10187 1
putop (const char *template, int sizeflag)
d10201 1
a10201 1
  for (p = template; *p; p++)
@


1.196
log
@gas/
2009-07-24  Jan Beulich  <jbeulich@@novell.com>

	* tc-i386.c (cpu_arch): Add .8087, .287, .387, .no87, .nommx,
	.nosse, and .noavx.
	(cpu_flags_and_not): New.
	(set_cpu_arch): Check whether sub-architecture specified is a
	feature disable.
	(md_parse_option): Likewise.
	(parse_real_register): Don't return floating point register
	when x87 functionality is disabled.
	(md_show_usage): Add new sub-options.
	* doc/c-i386.texi: Update with new command line sub-options.

gas/testsuite/
2009-07-24  Jan Beulich  <jbeulich@@novell.com>

	* gas/i386/8087.[ds]: New.
	* gas/i386/287.[ds]: New.
	* gas/i386/387.[ds]: New.
	* gas/i386/no87.[ls]: New.
	* gas/i386/no87-2.[ls]: New.
	* gas/i386/i386.exp: Run new tests.
	* gas/i386/att-regs.s: Also check FPU register access.
	* gas/i386/intel-regs.s: Likewise.
	* gas/i386/att-regs.d: Adjust expectations.
	* gas/i386/intel-regs.d: Likewise.

opcodes/
2009-07-24  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (fgrps): Correct annotation for feni/fdisi. Add
	frstpm.
	* i386-gen.c (cpu_flag_init): Add FP enabling flags where needed.
	(cpu_flags): Add Cpu8087, Cpu287, Cpu387, Cpu687, and CpuFISTTP.
	(set_bitfield): Expand CpuFP to Cpu8087|Cpu287|Cpu387.
	* i386-opc.h (Cpu8087, Cpu287, Cpu387, Cpu687, CpuFISTTP):
	Define.
	(union i386_cpu_flags): Add cpu8087, cpu287, cpu387, cpu687,
	and cpufisttp.
	* i386-opc.tbl: Qualify floating point instructions by their
	respective CpuXXX flag. Fix fucom{,p,pp}, fprem1, fsin, fcos,
	and fsincos to be avilable only on 387. Fix fstsw ax to be
	available only on 287+. Add f{,n}eni, f{,n}disi, f{,n}setpm,
	and frstpm.
	* i386-init.h, i386-tbl.h: Regenerate.
@
text
@d9418 3
a9420 1
      || info->mach == bfd_mach_x86_64)
d9427 2
a9428 1
		    || info->mach == bfd_mach_x86_64_intel_syntax);
d9432 1
d9434 2
a9435 1
      || info->mach == bfd_mach_x86_64_intel_syntax)
d9537 7
a9543 2
     puts most long word instructions on a single line.  */
  info->bytes_per_line = 7;
@


1.195
log
@<gas changes>
2009-07-06  Dwarakanath Rajagopal  <dwarak.rajagopal@@amd.com>

	* config/tc-i386.c (cpu_arch): Add .fma4 and CPU_FMA4_FLAGS.
	(build_modrm_byte): Add support to handle FMA4 instructions.
	(md_show_usage): Add fma4.

<gas/testsuite changes>
2009-07-06  Dwarakanath Rajagopal  <dwarak.rajagopal@@amd.com>

	* gas/i386/i386.exp: Add FMA4 tests.
	* gas/i386/x86-64-fma4.d: Ditto.
	* gas/i386/fma4.d: Ditto.
	* gas/i386/x86-64-fma4.s: Ditto.
	* gas/i386/fma4.s: Ditto.

<opcodes changes>
2009-07-06  Dwarakanath Rajagopal  <dwarak.rajagopal@@amd.com>

	* i386-opc.h (CpuFMA4): Add CpuFMA4.
	(i386_cpu_flags): New.
	* i386-gen.c: Add CPU_FMA4_FLAGS.
	* i386-opc.tbl: Add FMA4 instructions.
	* i386-tbl.h: Regenerate.
	* i386-init.h: Regenerate.
	* i386-dis.c (OP_VEX_FMA): New. Handle FMA4.
	(OP_XMM_VexW): Ditto.
	(OP_EX_VexW): Ditto.
	(VEXI4_Fixup): Ditto.
	(VexI4, VexFMA, Vex128FMA, EXVexW, EXdVexW, XMVexW): New Macros.
	(PREFIX_VEX_3A5C, PREFIX_VEX_3A5D, PREFIX_VEX_3A5E): New.
	(PREFIX_VEX_3A5F, PREFIX_VEX_3A60): New.
	(PREFIX_VEX_3A68, PREFIX_VEX_3A69, PREFIX_VEX_3A6A): New.
	(PREFIX_VEX_3A6B, PREFIX_VEX_3A6C, PREFIX_VEX_3A6D): New.
	(PREFIX_VEX_3A6E, PREFIX_VEX_3A6F, PREFIX_VEX_3A7A): New.
	(PREFIX_VEX_3A7B, PREFIX_VEX_3A7C, PREFIX_VEX_3A7D): New.
	(PREFIX_VEX_3A7E, PREFIX_VEX_3A7F): New.
	(VEX_LEN_3A6A_P_2,VEX_LEN_3A6B_P_2, VEX_LEN_3A6E_P_2): New.
	(VEX_LEN_3A6F_P_2,VEX_LEN_3A7A_P_2, VEX_LEN_3A7B_P_2): New.
	(VEX_LEN_3A7E_P_2,VEX_LEN_3A7F_P_2): New.
	(get_vex_imm8): New. handle FMA4.
	(OP_EX_VexReg): Ditto.
@
text
@d10083 2
a10084 2
    "feni(287 only)","fdisi(287 only)","fNclex","fNinit",
    "fNsetpm(287 only)","(bad)","(bad)","(bad)",
@


1.194
log
@<gas changes>
2009-05-22  Dwarakanath Rajagopal  <dwarak.rajagopal@@amd.com>

	* config/tc-i386.c (process_drex): Delete. Remove SSE5 support.
	(build_modrm_byte): Remove DREX handling support.
	(DREX_*): Delete.
	(drex_byte): Delete.
	(md_assemble): Remove DREX handling support.
	(process_operands): Remove DREX, SSE5 support.
	(i386_insn): Remove DREX.

<gas/testsuite changes>
2009-05-22  Dwarakanath Rajagopal  <dwarak.rajagopal@@amd.com>

	* gas/i386/i386.exp: Remove SSE5 tests.
	* gas/i386/x86-64-sse5.s: Delete. Remove SSE5 tests.
	* gas/i386/x86-64-sse5.d: Ditto.
	* gas/i386/arch-10-1.l: Remove SSE5 tests.
	* gas/i386/arch-10-2.l: Ditto.
	* gas/i386/arch-10-3.l: Ditto.
	* gas/i386/arch-10-4.l: Ditto.
	* gas/i386/arch-10.d: Ditto.
	* gas/i386/arch-10.s: Ditto.
	* gas/i386/arch-4.s: Delete. Remove SSE5 tests.
	* gas/i386/arch-4.d: Ditto.
	* gas/i386/arch-8.s: Ditto.
	* gas/i386/arch-8.d: Ditto.
	* gas/i386/arch-2.s: Remove SSE5 tests.
	* gas/i386/arch-2.d: Remove SSE5 tests.
	* gas/i386/x86-64-arch-2.s: Ditto.

<opcodes changes>
2009-05-22  Dwarakanath Rajagopal  <dwarak.rajagopal@@amd.com>

	* i386-opc.h (Cpusse5): Delete.
	(i386_cpu_flags): Delete.
	* i386-gen.c: Remove CpuSSE5, Drex, Drexv and Drexc.
	* i386-opc.tbl: Remove SSE5 instructions.
	* i386-tbl.h: Regenerate.
	* i386-init.h: Regenerate.
	* i386-dis.c (OP_E_memeory, OP_E_extended): Remove drex handling.
	(print_drex_arg): Delete.
	(OP_DREX4): Delete.
	(OP_DREX3): Delete.
	(OP_DREX_ICMP): Delete.
	(OP_DREX_FCMP): Delete.
	(DREX_*): Delete.
	(THREE_BYTE_0F24, THREE_BYTE_0F25, THREE_BYTE_0f7B): Delete.
@
text
@d96 1
d98 1
d100 1
d103 1
d365 3
d372 3
d376 1
d994 5
a998 1
#define PREFIX_VEX_3A60		(PREFIX_VEX_3A4C + 1)
d1002 17
a1018 1
#define PREFIX_VEX_3ADF		(PREFIX_VEX_3A63 + 1)
d1250 9
a1258 1
#define VEX_LEN_3ADF_P_2	(VEX_LEN_3A63_P_2 + 1)
d5070 32
d5134 128
d7009 4
a7012 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7023 8
a7030 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7041 8
a7048 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d8355 48
d12492 176
d12700 9
@


1.193
log
@2009-03-26  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (get_valid_dis386): Abort on unhandled table.
@
text
@d58 2
a59 2
static void OP_E_memory (int, int, int);
static void OP_E_extended (int, int, int);
d114 1
a114 5
static void print_drex_arg (unsigned int, int, int);
static void OP_DREX4 (int, int);
static void OP_DREX3 (int, int);
static void OP_DREX_ICMP (int, int);
static void OP_DREX_FCMP (int, int);
a161 14
/* Special 'registers' for DREX handling */
#define DREX_REG_UNKNOWN	1000	/* not initialized */
#define DREX_REG_MEMORY         1001	/* use MODRM/SIB/OFFSET memory */

/* The DREX byte has the following fields:
   Bits 7-4 -- DREX.Dest, xmm destination register
   Bit 3    -- DREX.OC0, operand config bit defines operand order
   Bit 2    -- DREX.R, equivalent to REX_R bit, to extend ModRM register
   Bit 1    -- DREX.X, equivalent to REX_X bit, to extend SIB index field
   Bit 0    -- DREX.W, equivalent to REX_B bit, to extend ModRM r/m field,
	       SIB base field, or opcode reg field.  */
#define DREX_XMM(drex) ((drex >> 4) & 0xf)
#define DREX_OC0(drex) ((drex >> 3) & 0x1)

a498 9
/* Flags that are OR'ed into the bytemode field to pass extra
   information.  */
#define DREX_OC1		0x10000	/* OC1 bit set */
#define DREX_NO_OC0		0x20000	/* OC0 bit not used */
#define DREX_MASK		0x40000	/* mask to delete */

#if MAX_BYTEMODE >= DREX_OC1
#error MAX_BYTEMODE must be less than DREX_OC1
#endif
d1018 1
a1018 3
#define THREE_BYTE_0F24		0
#define THREE_BYTE_0F25		(THREE_BYTE_0F24 + 1)
#define THREE_BYTE_0F38		(THREE_BYTE_0F25 + 1)
a1020 1
#define THREE_BYTE_0F7B		(THREE_BYTE_0F7A + 1)
d1615 1
a1615 1
  { THREE_BYTE_TABLE (THREE_BYTE_0F25) },
d1712 1
a1712 1
  { THREE_BYTE_TABLE (THREE_BYTE_0F7B) },
d5243 2
a5244 1
  /* THREE_BYTE_0F24 */
d5247 8
a5254 8
    { "fmaddps",	{ { OP_DREX4, q_mode } } },
    { "fmaddpd",	{ { OP_DREX4, q_mode } } },
    { "fmaddss",	{ { OP_DREX4, w_mode } } },
    { "fmaddsd",	{ { OP_DREX4, d_mode } } },
    { "fmaddps",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fmaddpd",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fmaddss",	{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "fmaddsd",	{ { OP_DREX4, DREX_OC1 + d_mode } } },
d5256 4
a5259 36
    { "fmsubps",	{ { OP_DREX4, q_mode } } },
    { "fmsubpd",	{ { OP_DREX4, q_mode } } },
    { "fmsubss",	{ { OP_DREX4, w_mode } } },
    { "fmsubsd",	{ { OP_DREX4, d_mode } } },
    { "fmsubps",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fmsubpd",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fmsubss",	{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "fmsubsd",	{ { OP_DREX4, DREX_OC1 + d_mode } } },
    /* 10 */
    { "fnmaddps",	{ { OP_DREX4, q_mode } } },
    { "fnmaddpd",	{ { OP_DREX4, q_mode } } },
    { "fnmaddss",	{ { OP_DREX4, w_mode } } },
    { "fnmaddsd",	{ { OP_DREX4, d_mode } } },
    { "fnmaddps",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fnmaddpd",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fnmaddss",	{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "fnmaddsd",	{ { OP_DREX4, DREX_OC1 + d_mode } } },
    /* 18 */
    { "fnmsubps",	{ { OP_DREX4, q_mode } } },
    { "fnmsubpd",	{ { OP_DREX4, q_mode } } },
    { "fnmsubss",	{ { OP_DREX4, w_mode } } },
    { "fnmsubsd",	{ { OP_DREX4, d_mode } } },
    { "fnmsubps",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fnmsubpd",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fnmsubss",	{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "fnmsubsd",	{ { OP_DREX4, DREX_OC1 + d_mode } } },
    /* 20 */
    { "permps",		{ { OP_DREX4, q_mode } } },
    { "permpd",		{ { OP_DREX4, q_mode } } },
    { "pcmov",		{ { OP_DREX4, q_mode } } },
    { "pperm",		{ { OP_DREX4, q_mode } } },
    { "permps",		{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "permpd",		{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "pcmov",		{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "pperm",		{ { OP_DREX4, DREX_OC1 + d_mode } } },
    /* 28 */
d5264 2
d5269 2
d5272 2
a5273 1
    /* 30 */
d5278 3
d5282 7
d5291 5
a5295 5
    { "(bad)",		{ XX } },
    /* 38 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5300 7
d5308 10
d5319 2
a5320 868
    { "protb",		{ { OP_DREX3, q_mode } } },
    { "protw",		{ { OP_DREX3, q_mode } } },
    { "protd",		{ { OP_DREX3, q_mode } } },
    { "protq",		{ { OP_DREX3, q_mode } } },
    { "pshlb",		{ { OP_DREX3, q_mode } } },
    { "pshlw",		{ { OP_DREX3, q_mode } } },
    { "pshld",		{ { OP_DREX3, q_mode } } },
    { "pshlq",		{ { OP_DREX3, q_mode } } },
    /* 48 */
    { "pshab",		{ { OP_DREX3, q_mode } } },
    { "pshaw",		{ { OP_DREX3, q_mode } } },
    { "pshad",		{ { OP_DREX3, q_mode } } },
    { "pshaq",		{ { OP_DREX3, q_mode } } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 50 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 58 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 60 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 68 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 70 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 78 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 80 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pmacssww",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacsswd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacssdql",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    /* 88 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pmacssdd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacssdqh",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    /* 90 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pmacsww",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacswd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacsdql",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    /* 98 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pmacsdd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacsdqh",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    /* a0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pmadcsswd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "(bad)",		{ XX } },
    /* a8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* b0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pmadcswd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "(bad)",		{ XX } },
    /* b8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* c0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* c8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* d0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* d8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* e0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* e8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* f0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* f8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
  },
  /* THREE_BYTE_0F25 */
  {
    /* 00 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 08 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 10 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 18 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 20 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 28 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "comps",		{ { OP_DREX3, q_mode }, { OP_DREX_FCMP, b_mode } } },
    { "compd",		{ { OP_DREX3, q_mode }, { OP_DREX_FCMP, b_mode } } },
    { "comss",		{ { OP_DREX3, w_mode }, { OP_DREX_FCMP, b_mode } } },
    { "comsd",		{ { OP_DREX3, d_mode }, { OP_DREX_FCMP, b_mode } } },
    /* 30 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 38 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 40 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 48 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pcomb",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomw",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomd",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomq",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    /* 50 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 58 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 60 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 68 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pcomub",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomuw",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomud",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomuq",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    /* 70 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 78 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 80 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 88 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 90 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 98 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* a0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* a8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* b0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* b8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* c0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* c8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* d0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* d8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* e0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* e8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* f0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* f8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
  },
  /* THREE_BYTE_0F38 */
  {
    /* 00 */
    { "pshufb",		{ MX, EM } },
    { "phaddw",		{ MX, EM } },
    { "phaddd",		{ MX, EM } },
    { "phaddsw",	{ MX, EM } },
    { "pmaddubsw",	{ MX, EM } },
    { "phsubw",		{ MX, EM } },
    { "phsubd",		{ MX, EM } },
    { "phsubsw",	{ MX, EM } },
    /* 08 */
    { "psignb",		{ MX, EM } },
    { "psignw",		{ MX, EM } },
    { "psignd",		{ MX, EM } },
    { "pmulhrsw",	{ MX, EM } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 10 */
    { PREFIX_TABLE (PREFIX_0F3810) },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { PREFIX_TABLE (PREFIX_0F3814) },
    { PREFIX_TABLE (PREFIX_0F3815) },
    { "(bad)",		{ XX } },
    { PREFIX_TABLE (PREFIX_0F3817) },
    /* 18 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pabsb",		{ MX, EM } },
    { "pabsw",		{ MX, EM } },
    { "pabsd",		{ MX, EM } },
    { "(bad)",		{ XX } },
    /* 20 */
    { PREFIX_TABLE (PREFIX_0F3820) },
    { PREFIX_TABLE (PREFIX_0F3821) },
    { PREFIX_TABLE (PREFIX_0F3822) },
    { PREFIX_TABLE (PREFIX_0F3823) },
    { PREFIX_TABLE (PREFIX_0F3824) },
    { PREFIX_TABLE (PREFIX_0F3825) },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 28 */
    { PREFIX_TABLE (PREFIX_0F3828) },
    { PREFIX_TABLE (PREFIX_0F3829) },
    { PREFIX_TABLE (PREFIX_0F382A) },
    { PREFIX_TABLE (PREFIX_0F382B) },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 30 */
    { PREFIX_TABLE (PREFIX_0F3830) },
    { PREFIX_TABLE (PREFIX_0F3831) },
    { PREFIX_TABLE (PREFIX_0F3832) },
    { PREFIX_TABLE (PREFIX_0F3833) },
    { PREFIX_TABLE (PREFIX_0F3834) },
    { PREFIX_TABLE (PREFIX_0F3835) },
    { "(bad)",		{ XX } },
    { PREFIX_TABLE (PREFIX_0F3837) },
    /* 38 */
    { PREFIX_TABLE (PREFIX_0F3838) },
    { PREFIX_TABLE (PREFIX_0F3839) },
    { PREFIX_TABLE (PREFIX_0F383A) },
    { PREFIX_TABLE (PREFIX_0F383B) },
    { PREFIX_TABLE (PREFIX_0F383C) },
    { PREFIX_TABLE (PREFIX_0F383D) },
    { PREFIX_TABLE (PREFIX_0F383E) },
    { PREFIX_TABLE (PREFIX_0F383F) },
    /* 40 */
    { PREFIX_TABLE (PREFIX_0F3840) },
    { PREFIX_TABLE (PREFIX_0F3841) },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 48 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 50 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 58 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 60 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 68 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 70 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 78 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 80 */
    { PREFIX_TABLE (PREFIX_0F3880) },
    { PREFIX_TABLE (PREFIX_0F3881) },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 88 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 90 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 98 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* a0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* a8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* b0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* b8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* c0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* c8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* d0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* d8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { PREFIX_TABLE (PREFIX_0F38DB) },
    { PREFIX_TABLE (PREFIX_0F38DC) },
    { PREFIX_TABLE (PREFIX_0F38DD) },
    { PREFIX_TABLE (PREFIX_0F38DE) },
    { PREFIX_TABLE (PREFIX_0F38DF) },
    /* e0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* e8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* f0 */
    { PREFIX_TABLE (PREFIX_0F38F0) },
    { PREFIX_TABLE (PREFIX_0F38F1) },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* f8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
  },
  /* THREE_BYTE_0F3A */
  {
    /* 00 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 08 */
    { PREFIX_TABLE (PREFIX_0F3A08) },
    { PREFIX_TABLE (PREFIX_0F3A09) },
    { PREFIX_TABLE (PREFIX_0F3A0A) },
    { PREFIX_TABLE (PREFIX_0F3A0B) },
    { PREFIX_TABLE (PREFIX_0F3A0C) },
    { PREFIX_TABLE (PREFIX_0F3A0D) },
    { PREFIX_TABLE (PREFIX_0F3A0E) },
    { "palignr",	{ MX, EM, Ib } },
    /* 10 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { PREFIX_TABLE (PREFIX_0F3A14) },
    { PREFIX_TABLE (PREFIX_0F3A15) },
    { PREFIX_TABLE (PREFIX_0F3A16) },
    { PREFIX_TABLE (PREFIX_0F3A17) },
    /* 18 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 20 */
    { PREFIX_TABLE (PREFIX_0F3A20) },
    { PREFIX_TABLE (PREFIX_0F3A21) },
    { PREFIX_TABLE (PREFIX_0F3A22) },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 28 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 30 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 38 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
a5324 7
    /* 40 */
    { PREFIX_TABLE (PREFIX_0F3A40) },
    { PREFIX_TABLE (PREFIX_0F3A41) },
    { PREFIX_TABLE (PREFIX_0F3A42) },
    { "(bad)",		{ XX } },
    { PREFIX_TABLE (PREFIX_0F3A44) },
    { "(bad)",		{ XX } },
d5355 4
a5358 4
    { PREFIX_TABLE (PREFIX_0F3A60) },
    { PREFIX_TABLE (PREFIX_0F3A61) },
    { PREFIX_TABLE (PREFIX_0F3A62) },
    { PREFIX_TABLE (PREFIX_0F3A63) },
d5391 2
a5392 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5493 5
a5497 5
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { PREFIX_TABLE (PREFIX_0F3ADF) },
d5517 2
a5518 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d5535 1
a5535 1
  /* THREE_BYTE_0F7A */
d5547 9
d5560 5
a5568 5
    /* 10 */
    { "frczps",		{ XM, EXq } },
    { "frczpd",		{ XM, EXq } },
    { "frczss",		{ XM, EXq } },
    { "frczsd",		{ XM, EXq } },
d5573 4
a5576 1
    /* 18 */
d5582 1
a5585 2
    /* 20 */
    { "ptest",		{ XX } },
d5591 1
a5593 1
    /* 28 */
d5600 1
a5602 3
    /* 30 */
    { "cvtph2ps",	{ XM, EXd } },
    { "cvtps2ph",	{ EXd, XM } },
d5609 4
a5612 2
    /* 38 */
    { "(bad)",		{ XX } },
d5614 1
d5618 1
a5621 1
    /* 40 */
a5622 3
    { "phaddbw",	{ XM, EXq } },
    { "phaddbd",	{ XM, EXq } },
    { "phaddbq",	{ XM, EXq } },
a5624 3
    { "phaddwd",	{ XM, EXq } },
    { "phaddwq",	{ XM, EXq } },
    /* 48 */
d5627 1
a5628 1
    { "phadddq",	{ XM, EXq } },
a5632 1
    /* 50 */
a5633 3
    { "phaddubw",	{ XM, EXq } },
    { "phaddubd",	{ XM, EXq } },
    { "phaddubq",	{ XM, EXq } },
a5635 2
    { "phadduwd",	{ XM, EXq } },
    { "phadduwq",	{ XM, EXq } },
d5640 1
a5640 1
    { "phaddudq",	{ XM, EXq } },
d5646 4
a5649 4
    { "(bad)",		{ XX } },
    { "phsubbw",	{ XM, EXq } },
    { "phsubbd",	{ XM, EXq } },
    { "phsubbq",	{ XM, EXq } },
d5788 1
a5788 1
    { "(bad)",		{ XX } },
d5826 2
a5827 1
  /* THREE_BYTE_0F7B */
d5866 1
a5866 1
    { "(bad)",		{ XX } },
d5902 4
a5905 13
    { "protb",		{ XM, EXq, Ib } },
    { "protw",		{ XM, EXq, Ib } },
    { "protd",		{ XM, EXq, Ib } },
    { "protq",		{ XM, EXq, Ib } },
    { "pshlb",		{ XM, EXq, Ib } },
    { "pshlw",		{ XM, EXq, Ib } },
    { "pshld",		{ XM, EXq, Ib } },
    { "pshlq",		{ XM, EXq, Ib } },
    /* 48 */
    { "pshab",		{ XM, EXq, Ib } },
    { "pshaw",		{ XM, EXq, Ib } },
    { "pshad",		{ XM, EXq, Ib } },
    { "pshaq",		{ XM, EXq, Ib } },
d5908 3
a5912 1
    /* 50 */
d5914 1
d5919 1
d5921 3
d5926 2
d5932 1
a5932 1
    { "(bad)",		{ XX } },
d5939 3
a5941 3
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6120 1
d8256 1
a8256 1
    { THREE_BYTE_TABLE (THREE_BYTE_0F24) },
d9354 1
d10711 1
a10711 1
OP_E_memory (int bytemode, int sizeflag, int has_drex)
a10753 8
      /* If we have a DREX byte, skip it now 
	 (it has already been handled) */
      if (has_drex)
	{
	  FETCH_DATA (the_info, codep + 1);
	  codep++;
	}

d10963 1
a10963 1
OP_E_extended (int bytemode, int sizeflag, int has_drex)
d10972 1
a10972 1
    OP_E_memory (bytemode, sizeflag, has_drex);
d10978 1
a10978 1
  OP_E_extended (bytemode, sizeflag, 0);
d11778 1
a11778 1
      OP_E_memory (bytemode, sizeflag, 0);
a12197 341
/* Print a DREX argument as either a register or memory operation.  */
static void
print_drex_arg (unsigned int reg, int bytemode, int sizeflag)
{
  if (reg == DREX_REG_UNKNOWN)
    BadOp ();

  else if (reg != DREX_REG_MEMORY)
    {
      sprintf (scratchbuf, "%%xmm%d", reg);
      oappend (scratchbuf + intel_syntax);
    }

  else
    OP_E_extended (bytemode, sizeflag, 1);
}

/* SSE5 instructions that have 4 arguments are encoded as:
   0f 24 <sub-opcode> <modrm> <optional-sib> <drex> <offset>.

   The <sub-opcode> byte has 1 bit (0x4) that is combined with 1 bit in
   the DREX field (0x8) to determine how the arguments are laid out.  
   The destination register must be the same register as one of the 
   inputs, and it is encoded in the DREX byte.  No REX prefix is used 
   for these instructions, since the DREX field contains the 3 extension
   bits provided by the REX prefix.

   The bytemode argument adds 2 extra bits for passing extra information:
	DREX_OC1	-- Set the OC1 bit to indicate dest == 1st arg
	DREX_NO_OC0	-- OC0 in DREX is invalid 
	(but pretend it is set).  */

static void
OP_DREX4 (int flag_bytemode, int sizeflag)
{
  unsigned int drex_byte;
  unsigned int regs[4];
  unsigned int modrm_regmem;
  unsigned int modrm_reg;
  unsigned int drex_reg;
  int bytemode;
  int rex_save = rex;
  int rex_used_save = rex_used;
  int has_sib = 0;
  int oc1 = (flag_bytemode & DREX_OC1) ? 2 : 0;
  int oc0;
  int i;

  bytemode = flag_bytemode & ~ DREX_MASK;

  for (i = 0; i < 4; i++)
    regs[i] = DREX_REG_UNKNOWN;

  /* Determine if we have a SIB byte in addition to MODRM before the 
     DREX byte.  */
  if (((sizeflag & AFLAG) || address_mode == mode_64bit)
      && (modrm.mod != 3)
      && (modrm.rm == 4))
    has_sib = 1;

  /* Get the DREX byte.  */
  FETCH_DATA (the_info, codep + 2 + has_sib);
  drex_byte = codep[has_sib+1];
  drex_reg = DREX_XMM (drex_byte);
  modrm_reg = modrm.reg + ((drex_byte & REX_R) ? 8 : 0);

  /* Is OC0 legal?  If not, hardwire oc0 == 1.  */
  if (flag_bytemode & DREX_NO_OC0)
    {
      oc0 = 1;
      if (DREX_OC0 (drex_byte))
	BadOp ();
    }
  else
    oc0 = DREX_OC0 (drex_byte);

  if (modrm.mod == 3)
    {			
      /* regmem == register  */
      modrm_regmem = modrm.rm + ((drex_byte & REX_B) ? 8 : 0);
      rex = rex_used = 0;
      /* skip modrm/drex since we don't call OP_E_extended  */
      codep += 2;
    }
  else
    {			
      /* regmem == memory, fill in appropriate REX bits  */
      modrm_regmem = DREX_REG_MEMORY;
      rex = drex_byte & (REX_B | REX_X | REX_R);
      if (rex)
	rex |= REX_OPCODE;
      rex_used = rex;
    }
  
  /* Based on the OC1/OC0 bits, lay out the arguments in the correct 
     order.  */
  switch (oc0 + oc1)
    {
    default:
      BadOp ();
      return;

    case 0:
      regs[0] = modrm_regmem;
      regs[1] = modrm_reg;
      regs[2] = drex_reg;
      regs[3] = drex_reg;
      break;

    case 1:
      regs[0] = modrm_reg;
      regs[1] = modrm_regmem;
      regs[2] = drex_reg;
      regs[3] = drex_reg;
      break;

    case 2:
      regs[0] = drex_reg;
      regs[1] = modrm_regmem;
      regs[2] = modrm_reg;
      regs[3] = drex_reg;
      break;

    case 3:
      regs[0] = drex_reg;
      regs[1] = modrm_reg;
      regs[2] = modrm_regmem;
      regs[3] = drex_reg;
      break;
    }

  /* Print out the arguments.  */
  for (i = 0; i < 4; i++)
    {
      int j = (intel_syntax) ? 3 - i : i;
      if (i > 0)
	{
	  *obufp++ = ',';
	  *obufp = '\0';
	}

      print_drex_arg (regs[j], bytemode, sizeflag);
    }

  rex = rex_save;
  rex_used = rex_used_save;
}

/* SSE5 instructions that have 3 arguments, and are encoded as:
   0f 24 <sub-opcode> <modrm> <optional-sib> <drex> <offset>	(or)
   0f 25 <sub-opcode> <modrm> <optional-sib> <drex> <offset> <cmp-byte>

   The DREX field has 1 bit (0x8) to determine how the arguments are 
   laid out. The destination register is encoded in the DREX byte.  
   No REX prefix is used for these instructions, since the DREX field 
   contains the 3 extension bits provided by the REX prefix.  */

static void
OP_DREX3 (int flag_bytemode, int sizeflag)
{
  unsigned int drex_byte;
  unsigned int regs[3];
  unsigned int modrm_regmem;
  unsigned int modrm_reg;
  unsigned int drex_reg;
  int bytemode;
  int rex_save = rex;
  int rex_used_save = rex_used;
  int has_sib = 0;
  int oc0;
  int i;

  bytemode = flag_bytemode & ~ DREX_MASK;

  for (i = 0; i < 3; i++)
    regs[i] = DREX_REG_UNKNOWN;

  /* Determine if we have a SIB byte in addition to MODRM before the 
     DREX byte.  */
  if (((sizeflag & AFLAG) || address_mode == mode_64bit)
      && (modrm.mod != 3)
      && (modrm.rm == 4))
    has_sib = 1;

  /* Get the DREX byte.  */
  FETCH_DATA (the_info, codep + 2 + has_sib);
  drex_byte = codep[has_sib+1];
  drex_reg = DREX_XMM (drex_byte);
  modrm_reg = modrm.reg + ((drex_byte & REX_R) ? 8 : 0);

  /* Is OC0 legal?  If not, hardwire oc0 == 0 */
  oc0 = DREX_OC0 (drex_byte);
  if ((flag_bytemode & DREX_NO_OC0) && oc0)
    BadOp ();

  if (modrm.mod == 3)
    {			
      /* regmem == register */
      modrm_regmem = modrm.rm + ((drex_byte & REX_B) ? 8 : 0);
      rex = rex_used = 0;
      /* skip modrm/drex since we don't call OP_E_extended.  */
      codep += 2;
    }
  else
    {			
      /* regmem == memory, fill in appropriate REX bits.  */
      modrm_regmem = DREX_REG_MEMORY;
      rex = drex_byte & (REX_B | REX_X | REX_R);
      if (rex)
	rex |= REX_OPCODE;
      rex_used = rex;
    }

  /* Based on the OC1/OC0 bits, lay out the arguments in the correct 
     order.  */
  switch (oc0)
    {
    default:
      BadOp ();
      return;

    case 0:
      regs[0] = modrm_regmem;
      regs[1] = modrm_reg;
      regs[2] = drex_reg;
      break;

    case 1:
      regs[0] = modrm_reg;
      regs[1] = modrm_regmem;
      regs[2] = drex_reg;
      break;
    }

  /* Print out the arguments.  */
  for (i = 0; i < 3; i++)
    {
      int j = (intel_syntax) ? 2 - i : i;
      if (i > 0)
	{
	  *obufp++ = ',';
	  *obufp = '\0';
	}

      print_drex_arg (regs[j], bytemode, sizeflag);
    }

  rex = rex_save;
  rex_used = rex_used_save;
}

/* Emit a floating point comparison for comp<xx> instructions.  */

static void
OP_DREX_FCMP (int bytemode ATTRIBUTE_UNUSED, 
	      int sizeflag ATTRIBUTE_UNUSED)
{
  unsigned char byte;

  static const char *const cmp_test[] = {
    "eq",
    "lt",
    "le",
    "unord",
    "ne",
    "nlt",
    "nle",
    "ord",
    "ueq",
    "ult",
    "ule",
    "false",
    "une",
    "unlt",
    "unle",
    "true"
  };

  FETCH_DATA (the_info, codep + 1);
  byte = *codep & 0xff;

  if (byte >= ARRAY_SIZE (cmp_test)
      || obuf[0] != 'c'
      || obuf[1] != 'o'
      || obuf[2] != 'm')
    {
      /* The instruction isn't one we know about, so just append the 
	 extension byte as a numeric value.  */
      OP_I (b_mode, 0);
    }

  else
    {
      sprintf (scratchbuf, "com%s%s", cmp_test[byte], obuf+3);
      mnemonicendp = stpcpy (obuf, scratchbuf);
      codep++;
    }
}

/* Emit an integer point comparison for pcom<xx> instructions, 
   rewriting the instruction to have the test inside of it.  */

static void
OP_DREX_ICMP (int bytemode ATTRIBUTE_UNUSED, 
	      int sizeflag ATTRIBUTE_UNUSED)
{
  unsigned char byte;

  static const char *const cmp_test[] = {
    "lt",
    "le",
    "gt",
    "ge",
    "eq",
    "ne",
    "false",
    "true"
  };

  FETCH_DATA (the_info, codep + 1);
  byte = *codep & 0xff;

  if (byte >= ARRAY_SIZE (cmp_test)
      || obuf[0] != 'p'
      || obuf[1] != 'c'
      || obuf[2] != 'o'
      || obuf[3] != 'm')
    {
      /* The instruction isn't one we know about, so just print the 
	 comparison test byte as a numeric value.  */
      OP_I (b_mode, 0);
    }

  else
    {
      sprintf (scratchbuf, "pcom%s%s", cmp_test[byte], obuf+4);
      mnemonicendp = stpcpy (obuf, scratchbuf);
      codep++;
    }
}

@


1.192
log
@2009-02-27  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_EX): Call OP_E_memory instead of OP_E.
@
text
@d10047 1
a10047 2
      oappend (INTERNAL_DISASSEMBLER_ERROR);
      return NULL;
@


1.191
log
@gas/

2009-02-04  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (January, 2009)
	* config/tc-i386.c (CPU_FLAGS_PCLMUL_MATCH): New.
	(CPU_FLAGS_AVX_MATCH): Updated.
	(CPU_FLAGS_32BIT_MATCH): Likewise.
	(cpu_flags_match): Likewise.

gas/testsuite/

2009-02-04  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (January, 2009)
	* gas/i386/arch-avx-1-3.l: New.
	* gas/i386/arch-avx-1-3.s: Likewise.
	* gas/i386/arch-avx-1-4.l: Likewise.
	* gas/i386/arch-avx-1-4.s: Likewise.
	* gas/i386/arch-avx-1-5.l: Likewise.
	* gas/i386/arch-avx-1-5.s: Likewise.
	* gas/i386/arch-avx-1-6.l: Likewise.
	* gas/i386/arch-avx-1-6.s: Likewise.

	* gas/i386/arch-10.s: Add vpclmul instructions.
	* gas/i386/arch-avx-1.s: Likewise.
	* gas/i386/avx.s: Likewise.
	* gas/i386/x86-64-arch-2.s: Likewise.
	* gas/i386/x86-64-avx.s: Likewise.

	* gas/i386/sse2avx.s: Add pclmul instructions.
	* gas/i386/x86-64-sse2avx.s: Likewise.

	* gas/i386/arch-10.d: Updated.
	* gas/i386/arch-10-1.l: Likewise.
	* gas/i386/arch-10-2.l: Likewise.
	* gas/i386/arch-10-3.l: Likewise.
	* gas/i386/arch-10-4.l: Likewise.
	* gas/i386/arch-avx-1.d: Likewise.
	* gas/i386/arch-avx-1-1.l: Likewise.
	* gas/i386/arch-avx-1-2.l: Likewise.
	* gas/i386/avx.d: Likewise.
	* gas/i386/avx-intel.d: Likewise.
	* gas/i386/sse2avx.d: Likewise.
	* gas/i386/x86-64-arch-2.d: Likewise.
	* gas/i386/x86-64-avx.d: Likewise.
	* gas/i386/x86-64-avx-intel.d: Likewise.
	* gas/i386/x86-64-sse2avx.d: Likewise.

	* gas/i386/i386.exp: Run arch-avx-1-3, arch-avx-1-4,
	arch-avx-1-5 and arch-avx-1-6.

opcodes/

2009-02-04  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (January, 2009)
	* i386-dis.c (PREFIX_VEX_3A44): New.
	(VEX_LEN_3A44_P_2): Likewise.
	(PREFIX_VEX_3A48): Updated.
	(VEX_LEN_3A4C_P_2): Likewise.
	(prefix_table): Add PREFIX_VEX_3A44.
	(vex_table): Likewise.
	(vex_len_table): Add VEX_LEN_3A44_P_2.

	* i386-opc.tbl: Add PCLMUL + AVX instructions.
	* i386-tbl.h: Regenerated.
@
text
@d12679 5
d12686 1
a12686 1
      OP_E (bytemode, sizeflag);
d12689 1
a12701 3
  /* Skip mod/rm byte.  */
  MODRM_CHECK;
  codep++;
@


1.190
log
@gas/testsuite/

2009-01-12  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/opts.s: Add tests for add, adc, and, cmp, or, sbb,
	sub and xor.
	* gas/i386/x86-64-opts.s: Likewise.

	* gas/i386/opts.d: Updated.
	* gas/i386/opts-intel.d: Likewise.
	* gas/i386/x86-64-opts.d: Likewise.
	* gas/i386/x86-64-opts-intel.d: Likewise.

opcodes/

2009-01-12  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (dis386): Use EbS on addB, orB, adcB, sbbB, andB,
	subB, xorB and cmpB.  Use EvS on addS, orS, adcS, sbbS, andS,
	subS, xorS and cmpS.
@
text
@d1006 2
a1007 1
#define PREFIX_VEX_3A4A		(PREFIX_VEX_3A42 + 1)
d1243 2
a1244 1
#define VEX_LEN_3A4C_P_2	(VEX_LEN_3A42_P_2 + 1)
d5029 8
d7683 1
a7683 1
    { "(bad)",		{ XX } },
d9020 6
@


1.189
log
@gas/testsuite/

2009-01-06  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (December, 2008)
	* gas/i386/avx.s: Add tests for 256bit vmovntdq, vmovntpd and
	vmovntps.
	* gas/i386/x86-64-avx.s: Likewise.

	* gas/i386/avx.d: Updated.
	* gas/i386/avx-intel.d: Likewise.
	* gas/i386/x86-64-avx.d: Likewise.
	* gas/i386/x86-64-avx-intel.d: Likewise.

opcodes/

2009-01-06  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (December, 2008)
	* i386-dis.c (VEX_LEN_2B_M_0): Removed.
	(VEX_LEN_E7_P_2_M_0): Likewise.
	(VEX_LEN_2C_P_1): Updated.
	(VEX_LEN_E8_P_2): Likewise.
	(vex_len_table): Remove VEX_LEN_2B_M_0 and VEX_LEN_E7_P_2_M_0.
	(mod_table): Likewise.

	* i386-opc.tbl: Add 256bit vmovntdq, vmovntpd and vmovntps.
	* i386-tbl.h: Regenerated.
@
text
@d1313 2
a1314 2
  { "addB",		{ Gb, Eb } },
  { "addS",		{ Gv, Ev } },
d1322 2
a1323 2
  { "orB",		{ Gb, Eb } },
  { "orS",		{ Gv, Ev } },
d1331 2
a1332 2
  { "adcB",		{ Gb, Eb } },
  { "adcS",		{ Gv, Ev } },
d1340 2
a1341 2
  { "sbbB",		{ Gb, Eb } },
  { "sbbS",		{ Gv, Ev } },
d1349 2
a1350 2
  { "andB",		{ Gb, Eb } },
  { "andS",		{ Gv, Ev } },
d1358 2
a1359 2
  { "subB",		{ Gb, Eb } },
  { "subS",		{ Gv, Ev } },
d1367 2
a1368 2
  { "xorB",		{ Gb, Eb } },
  { "xorS",		{ Gv, Ev } },
d1376 2
a1377 2
  { "cmpB",		{ Gb, Eb } },
  { "cmpS",		{ Gv, Ev } },
@


1.188
log
@gas/

2009-01-05  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (December, 2008)
	* config/tc-i386.c (build_modrm_byte): Remove 5 operand instruction
	support.  Don't swap REG and NDS for FMA.

gas/testsuite/

2009-01-05  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (December, 2008)
	* gas/i386/arch-10.s: Replace vfmaddpd with vfmadd132pd.
	* gas/i386/x86-64-arch-2.s: Likewise.

	* gas/i386/arch-10.d: Updated.
	* gas/i386/arch-10-1.l: Likewise.
	* gas/i386/arch-10-2.l: Likewise.
	* gas/i386/arch-10-3.l: Likewise.
	* gas/i386/arch-10-4.l: Likewise.
	* gas/i386/avx.d: Likewise.
	* gas/i386/avx-intel.d: Likewise.
	* gas/i386/inval-avx.l: Likewise.
	* gas/i386/x86-64-arch-2.d: Likewise.
	* gas/i386/x86-64-avx.d: Likewise.
	* gas/i386/x86-64-avx-intel.d: Likewise.
	* gas/i386/x86-64-inval-avx.l: Likewise.

	* gas/i386/avx.s: Remove vpermil2ps/vpermil2pd and FMA
	instructions.  Update tests.
	* gas/i386/inval-avx.s: Likewise.
	* gas/i386/x86-64-avx.s: Likewise.
	* gas/i386/x86-64-inval-avx.s: Likewise.

	* gas/i386/fma.d: New.
	* gas/i386/fma.s: Likewise.
	* gas/i386/fma-intel.d: Likewise.
	* gas/i386/x86-64-fma.d: Likewise.
	* gas/i386/x86-64-fma.s: Likewise.
	* gas/i386/x86-64-fma-intel.d: Likewise.

	* gas/i386/i386.exp: Run fma, fma-intel, x86-64-fma and
	x86-64-fma-intel.

opcodes/

2009-01-05  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (December, 2008)
	* i386-dis.c (OP_VEX_FMA): Removed.
	(OP_EX_VexW): Likewise.
	(OP_EX_VexImmW): Likewise.
	(OP_XMM_VexW): Likewise.
	(VEXI4_Fixup): Likewise.
	(VPERMIL2_Fixup): Likewise.
	(VexI4): Likewise.
	(VexFMA): Likewise.
	(Vex128FMA): Likewise.
	(EXVexW): Likewise.
	(EXdVexW): Likewise.
	(EXqVexW): Likewise.
	(EXVexImmW): Likewise.
	(XMVexW): Likewise.
	(VPERMIL2): Likewise.
	(PREFIX_VEX_3A48...PREFIX_VEX_3A4A): Likewise.
	(PREFIX_VEX_3A5C...PREFIX_VEX_3A5F): Likewise.
	(PREFIX_VEX_3A68...PREFIX_VEX_3A6F): Likewise.
	(PREFIX_VEX_3A78...PREFIX_VEX_3A7F): Likewise.
	(VEX_LEN_3A6A_P_2...VEX_LEN_3A6F_P_2): Likewise.
	(VEX_LEN_3A7A_P_2...VEX_LEN_3A7F_P_2): Likewise.
	(get_vex_imm8): Likewise.
	(OP_EX_VexReg): Likewise.
	vpermil2_op): Likewise.
	(EXVexWdq): New.
	(vex_w_dq_mode): Likewise.
	(PREFIX_VEX_3896...PREFIX_VEX_389F): Likewise.
	(PREFIX_VEX_38A6...PREFIX_VEX_38AF): Likewise.
	(PREFIX_VEX_38B6...PREFIX_VEX_38BF): Likewise.
	(es_reg): Updated.
	(PREFIX_VEX_38DB): Likewise.
	(PREFIX_VEX_3A4A): Likewise.
	(PREFIX_VEX_3A60): Likewise.
	(PREFIX_VEX_3ADF): Likewise.
	(VEX_LEN_3ADF_P_2): Likewise.
	(prefix_table): Remove PREFIX_VEX_3A48...PREFIX_VEX_3A4A,
	PREFIX_VEX_3A5C...PREFIX_VEX_3A5F,
	PREFIX_VEX_3A68...PREFIX_VEX_3A6F and
	PREFIX_VEX_3A78...PREFIX_VEX_3A7F.  Add
	PREFIX_VEX_3896...PREFIX_VEX_389F,
	PREFIX_VEX_38A6...PREFIX_VEX_38AF and
	PREFIX_VEX_38B6...PREFIX_VEX_38BF.
	(vex_table): Likewise.
	(vex_len_table): Remove VEX_LEN_3A6A_P_2...VEX_LEN_3A6F_P_2
	and VEX_LEN_3A7A_P_2...VEX_LEN_3A7F_P_2.
	(putop): Support "%XW".
	(intel_operand_size): Handle vex_w_dq_mode.

	* i386-opc.h (VexNDS): Add a comment for VEX NDS and VEX DDS.

	* i386-opc.tbl: Remove vpermil2pd/vpermil2ps and old FMA
	instructions.  Add new FMA instructions.
	* i386-tbl.h: Regenerated.
@
text
@d1069 1
a1069 2
#define VEX_LEN_2B_M_0	(VEX_LEN_2A_P_3 + 1)
#define VEX_LEN_2C_P_1	(VEX_LEN_2B_M_0 + 1)
d1155 1
a1155 2
#define VEX_LEN_E7_P_2_M_0	(VEX_LEN_E5_P_2 + 1)
#define VEX_LEN_E8_P_2	(VEX_LEN_E7_P_2_M_0 + 1)
a7971 6
  /* VEX_LEN_2B_M_0 */
  {
    { "vmovntpX",	{ Mx, XM } },
    { "(bad)",		{ XX } },
  },

a8487 6
  /* VEX_LEN_E7_P_2_M_0 */
  {
    { "vmovntdq",	{ Mx, XM } },
    { "(bad)",		{ XX } },
  },

d9345 1
a9345 1
    { VEX_LEN_TABLE (VEX_LEN_2B_M_0) },
d9420 1
a9420 1
    { VEX_LEN_TABLE (VEX_LEN_E7_P_2_M_0) },
@


1.187
log
@gas/

2008-12-23  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c (match_template): Changed to return
	 const template *.  Handle i.swap_operand for 3 operands.
	 (build_vex_prefix): Take const template *.  Swap operand for
	 2-byte VEX prefix if possible.
	 (md_assemble): Updated.
	 (build_modrm_byte): Handle RegMem bit for SSE2AVX.

gas/testsuite/

2008-12-23  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run x86-64-avx-swap and x86-64-avx-swap-intel.

	* gas/i386/opts.s: Add tests for movsd, movss, vmovsd and
	vmovss.
	* gas/i386/x86-64-opts.s: Likewise.

	* gas/i386/opts.d: Updated.
	* gas/i386/opts-intel.d: Likewise.
	* gas/i386/sse2avx-opts.d: Likewise.
	* gas/i386/sse2avx-opts-intel.d: Likewise.
	* gas/i386/x86-64-opts.d: Likewise.
	* gas/i386/x86-64-opts-intel.d: Likewise.
	* gas/i386/x86-64-sse2avx-opts.d: Likewise.
	* gas/i386/x86-64-sse2avx-opts-intel.d: Likewise.

	* gas/i386/x86-64-avx-swap.d: New.
	* gas/i386/x86-64-avx-swap.s: Likewise.
	* gas/i386/x86-64-avx-swap-intel.d: Likewise.

opcodes/

2008-12-23  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (EXdS): New.
	(EXdVexS): Likewise.
	(EXqVexS): Likewise.
	(d_swap_mode): Likewise.
	(q_mode): Updated.
	(prefix_table): Use EXdS on movss and EXqS on movsd.
	(vex_len_table): Use EXdVexS on vmovss and EXqVexS on vmovsd.
	(intel_operand_size): Handle d_swap_mode.
	(OP_EX): Likewise.

	* i386-opc.h (S): Update comments.

	* i386-opc.tbl: Add S to movss, movsd, vmovss and vmovsd.
	* i386-tbl.h: Regenerated.
@
text
@d3 1
a3 1
   2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008
a95 1
static void OP_VEX_FMA (int, int);
a96 2
static void OP_EX_VexW (int, int);
static void OP_EX_VexImmW (int, int);
a97 1
static void OP_XMM_VexW (int, int);
a99 1
static void VEXI4_Fixup (int, int);
a101 1
static void VPERMIL2_Fixup (int, int);
d367 1
a378 3
#define VexI4 { VEXI4_Fixup, 0}
#define VexFMA { OP_VEX_FMA, vex_mode }
#define Vex128FMA { OP_VEX_FMA, vex128_mode }
a382 4
#define EXVexW { OP_EX_VexW, x_mode }
#define EXdVexW { OP_EX_VexW, d_mode }
#define EXqVexW { OP_EX_VexW, q_mode }
#define EXVexImmW { OP_EX_VexImmW, x_mode }
a383 1
#define XMVexW { OP_XMM_VexW, 0 }
a387 1
#define VPERMIL2 { VPERMIL2_Fixup, 0 }
d466 2
d469 1
a469 1
#define es_reg			(vex256_mode + 1)
d948 31
a978 1
#define PREFIX_VEX_38DB		(PREFIX_VEX_3841 + 1)
d1006 1
a1006 3
#define PREFIX_VEX_3A48		(PREFIX_VEX_3A42 + 1)
#define PREFIX_VEX_3A49		(PREFIX_VEX_3A48 + 1)
#define PREFIX_VEX_3A4A		(PREFIX_VEX_3A49 + 1)
d1009 1
a1009 5
#define PREFIX_VEX_3A5C		(PREFIX_VEX_3A4C + 1)
#define PREFIX_VEX_3A5D		(PREFIX_VEX_3A5C + 1)
#define PREFIX_VEX_3A5E		(PREFIX_VEX_3A5D + 1)
#define PREFIX_VEX_3A5F		(PREFIX_VEX_3A5E + 1)
#define PREFIX_VEX_3A60		(PREFIX_VEX_3A5F + 1)
d1013 1
a1013 17
#define PREFIX_VEX_3A68		(PREFIX_VEX_3A63 + 1)
#define PREFIX_VEX_3A69		(PREFIX_VEX_3A68 + 1)
#define PREFIX_VEX_3A6A		(PREFIX_VEX_3A69 + 1)
#define PREFIX_VEX_3A6B		(PREFIX_VEX_3A6A + 1)
#define PREFIX_VEX_3A6C		(PREFIX_VEX_3A6B + 1)
#define PREFIX_VEX_3A6D		(PREFIX_VEX_3A6C + 1)
#define PREFIX_VEX_3A6E		(PREFIX_VEX_3A6D + 1)
#define PREFIX_VEX_3A6F		(PREFIX_VEX_3A6E + 1)
#define PREFIX_VEX_3A78		(PREFIX_VEX_3A6F + 1)
#define PREFIX_VEX_3A79		(PREFIX_VEX_3A78 + 1)
#define PREFIX_VEX_3A7A		(PREFIX_VEX_3A79 + 1)
#define PREFIX_VEX_3A7B		(PREFIX_VEX_3A7A + 1)
#define PREFIX_VEX_3A7C		(PREFIX_VEX_3A7B + 1)
#define PREFIX_VEX_3A7D		(PREFIX_VEX_3A7C + 1)
#define PREFIX_VEX_3A7E		(PREFIX_VEX_3A7D + 1)
#define PREFIX_VEX_3A7F		(PREFIX_VEX_3A7E + 1)
#define PREFIX_VEX_3ADF		(PREFIX_VEX_3A7F + 1)
d1249 1
a1249 9
#define VEX_LEN_3A6A_P_2	(VEX_LEN_3A63_P_2 + 1)
#define VEX_LEN_3A6B_P_2	(VEX_LEN_3A6A_P_2 + 1)
#define VEX_LEN_3A6E_P_2	(VEX_LEN_3A6B_P_2 + 1)
#define VEX_LEN_3A6F_P_2	(VEX_LEN_3A6E_P_2 + 1)
#define VEX_LEN_3A7A_P_2	(VEX_LEN_3A6F_P_2 + 1)
#define VEX_LEN_3A7B_P_2	(VEX_LEN_3A7A_P_2 + 1)
#define VEX_LEN_3A7E_P_2	(VEX_LEN_3A7B_P_2 + 1)
#define VEX_LEN_3A7F_P_2	(VEX_LEN_3A7E_P_2 + 1)
#define VEX_LEN_3ADF_P_2	(VEX_LEN_3A7F_P_2 + 1)
d1301 1
d4565 65
a4629 1
  /* PREFIX_VEX_38DB */
d4633 1
a4633 1
    { VEX_LEN_TABLE (VEX_LEN_38DB_P_2) },
d4637 1
a4637 1
  /* PREFIX_VEX_38DC */
d4641 1
a4641 1
    { VEX_LEN_TABLE (VEX_LEN_38DC_P_2) },
d4645 1
a4645 1
  /* PREFIX_VEX_38DD */
d4649 1
a4649 1
    { VEX_LEN_TABLE (VEX_LEN_38DD_P_2) },
d4653 1
a4653 1
  /* PREFIX_VEX_38DE */
d4657 1
a4657 1
    { VEX_LEN_TABLE (VEX_LEN_38DE_P_2) },
d4661 1
a4661 1
  /* PREFIX_VEX_38DF */
d4665 1
a4665 1
    { VEX_LEN_TABLE (VEX_LEN_38DF_P_2) },
d4669 1
a4669 1
  /* PREFIX_VEX_3A04 */
d4673 1
a4673 1
    { "vpermilps", { XM, EXx, Ib } },
d4677 1
a4677 1
  /* PREFIX_VEX_3A05 */
d4681 1
a4681 1
    { "vpermilpd", { XM, EXx, Ib } },
d4685 1
a4685 1
  /* PREFIX_VEX_3A06 */
d4689 1
a4689 1
    { VEX_LEN_TABLE (VEX_LEN_3A06_P_2) },
d4693 1
a4693 1
  /* PREFIX_VEX_3A08 */
d4697 1
a4697 1
    { "vroundps", { XM, EXx, Ib } },
d4701 1
a4701 1
  /* PREFIX_VEX_3A09 */
d4705 1
a4705 1
    { "vroundpd", { XM, EXx, Ib } },
d4709 1
a4709 1
  /* PREFIX_VEX_3A0A */
d4713 1
a4713 1
    { VEX_LEN_TABLE (VEX_LEN_3A0A_P_2) },
d4717 1
a4717 1
  /* PREFIX_VEX_3A0B */
d4721 1
a4721 1
    { VEX_LEN_TABLE (VEX_LEN_3A0B_P_2) },
d4725 1
a4725 1
  /* PREFIX_VEX_3A0C */
d4729 1
a4729 1
    { "vblendps", { XM, Vex, EXx, Ib } },
d4733 1
a4733 1
  /* PREFIX_VEX_3A0D */
d4737 1
a4737 1
    { "vblendpd", { XM, Vex, EXx, Ib } },
d4741 1
a4741 1
  /* PREFIX_VEX_3A0E */
d4745 1
a4745 1
    { VEX_LEN_TABLE (VEX_LEN_3A0E_P_2) },
d4749 1
a4749 1
  /* PREFIX_VEX_3A0F */
d4753 1
a4753 1
    { VEX_LEN_TABLE (VEX_LEN_3A0F_P_2) },
d4757 1
a4757 1
  /* PREFIX_VEX_3A14 */
d4761 1
a4761 1
    { VEX_LEN_TABLE (VEX_LEN_3A14_P_2) },
d4765 1
a4765 1
  /* PREFIX_VEX_3A15 */
d4769 1
a4769 1
    { VEX_LEN_TABLE (VEX_LEN_3A15_P_2) },
d4773 1
a4773 1
  /* PREFIX_VEX_3A16 */
d4777 1
a4777 1
    { VEX_LEN_TABLE (VEX_LEN_3A16_P_2) },
d4781 1
a4781 1
  /* PREFIX_VEX_3A17 */
d4785 1
a4785 1
    { VEX_LEN_TABLE (VEX_LEN_3A17_P_2) },
d4789 1
a4789 1
  /* PREFIX_VEX_3A18 */
d4793 1
a4793 1
    { VEX_LEN_TABLE (VEX_LEN_3A18_P_2) },
d4797 1
a4797 1
  /* PREFIX_VEX_3A19 */
d4801 1
a4801 1
    { VEX_LEN_TABLE (VEX_LEN_3A19_P_2) },
d4805 1
a4805 1
  /* PREFIX_VEX_3A20 */
d4809 1
a4809 1
    { VEX_LEN_TABLE (VEX_LEN_3A20_P_2) },
d4813 1
a4813 1
  /* PREFIX_VEX_3A21 */
d4817 1
a4817 1
    { VEX_LEN_TABLE (VEX_LEN_3A21_P_2) },
d4821 1
a4821 1
  /* PREFIX_VEX_3A22 */
d4825 1
a4825 1
    { VEX_LEN_TABLE (VEX_LEN_3A22_P_2) },
d4829 1
a4829 1
  /* PREFIX_VEX_3A40 */
d4833 1
a4833 1
    { "vdpps",	{ XM, Vex, EXx, Ib } },
d4837 1
a4837 1
  /* PREFIX_VEX_3A41 */
d4841 1
a4841 1
    { VEX_LEN_TABLE (VEX_LEN_3A41_P_2) },
d4845 1
a4845 1
  /* PREFIX_VEX_3A42 */
d4849 1
a4849 1
    { VEX_LEN_TABLE (VEX_LEN_3A42_P_2) },
d4853 1
a4853 1
  /* PREFIX_VEX_3A48 */
d4857 1
a4857 1
    { "vpermil2ps", { XMVexW, Vex, EXVexImmW, EXVexImmW, VPERMIL2 } },
d4861 1
a4861 1
  /* PREFIX_VEX_3A49 */
d4865 1
a4865 1
    { "vpermil2pd", { XMVexW, Vex, EXVexImmW, EXVexImmW, VPERMIL2 } },
d4869 1
a4869 1
  /* PREFIX_VEX_3A4A */
d4873 1
a4873 1
    { "vblendvps", { XM, Vex, EXx, XMVexI4 } },
d4877 1
a4877 1
  /* PREFIX_VEX_3A4B */
d4881 1
a4881 1
    { "vblendvpd", { XM, Vex, EXx, XMVexI4 } },
d4885 1
a4885 1
  /* PREFIX_VEX_3A4C */
d4889 1
a4889 1
    { VEX_LEN_TABLE (VEX_LEN_3A4C_P_2) },
d4893 1
a4893 1
  /* PREFIX_VEX_3A5C */
d4897 1
a4897 1
    { "vfmaddsubps", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d4901 1
a4901 1
  /* PREFIX_VEX_3A5D */
d4905 1
a4905 1
    { "vfmaddsubpd", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d4909 1
a4909 1
  /* PREFIX_VEX_3A5E */
d4913 1
a4913 1
    { "vfmsubaddps", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d4917 1
a4917 1
  /* PREFIX_VEX_3A5F */
d4921 1
a4921 1
    { "vfmsubaddpd", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d4925 1
a4925 1
  /* PREFIX_VEX_3A60 */
d4929 1
a4929 1
    { VEX_LEN_TABLE (VEX_LEN_3A60_P_2) },
d4933 1
a4933 1
  /* PREFIX_VEX_3A61 */
d4937 1
a4937 1
    { VEX_LEN_TABLE (VEX_LEN_3A61_P_2) },
d4941 1
a4941 1
  /* PREFIX_VEX_3A62 */
d4945 1
a4945 1
    { VEX_LEN_TABLE (VEX_LEN_3A62_P_2) },
d4949 1
a4949 1
  /* PREFIX_VEX_3A63 */
d4953 1
a4953 1
    { VEX_LEN_TABLE (VEX_LEN_3A63_P_2) },
d4957 1
a4957 1
  /* PREFIX_VEX_3A68 */
d4961 1
a4961 1
    { "vfmaddps", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d4965 1
a4965 1
  /* PREFIX_VEX_3A69 */
d4969 1
a4969 1
    { "vfmaddpd", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d4973 1
a4973 1
  /* PREFIX_VEX_3A6A */
d4977 1
a4977 1
    { VEX_LEN_TABLE (VEX_LEN_3A6A_P_2) },
d4981 1
a4981 1
  /* PREFIX_VEX_3A6B */
d4985 1
a4985 1
    { VEX_LEN_TABLE (VEX_LEN_3A6B_P_2) },
d4989 1
a4989 1
  /* PREFIX_VEX_3A6C */
d4993 1
a4993 1
    { "vfmsubps", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d4997 1
a4997 1
  /* PREFIX_VEX_3A6D */
d5001 1
a5001 1
    { "vfmsubpd", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5005 1
a5005 1
  /* PREFIX_VEX_3A6E */
d5009 1
a5009 1
    { VEX_LEN_TABLE (VEX_LEN_3A6E_P_2) },
d5013 1
a5013 1
  /* PREFIX_VEX_3A6F */
d5017 1
a5017 1
    { VEX_LEN_TABLE (VEX_LEN_3A6F_P_2) },
d5021 1
a5021 1
  /* PREFIX_VEX_3A78 */
d5025 1
a5025 1
    { "vfnmaddps", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5029 1
a5029 1
  /* PREFIX_VEX_3A79 */
d5033 1
a5033 1
    { "vfnmaddpd", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5037 1
a5037 1
  /* PREFIX_VEX_3A7A */
d5041 1
a5041 1
    { VEX_LEN_TABLE (VEX_LEN_3A7A_P_2) },
d5045 1
a5045 1
  /* PREFIX_VEX_3A7B */
d5049 1
a5049 1
    { VEX_LEN_TABLE (VEX_LEN_3A7B_P_2) },
d5053 1
a5053 1
  /* PREFIX_VEX_3A7C */
d5057 1
a5057 1
    { "vfnmsubps", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5061 1
a5061 1
  /* PREFIX_VEX_3A7D */
d5065 1
a5065 1
    { "vfnmsubpd", { XMVexW, VexFMA, EXVexW, EXVexW, VexI4 } },
d5069 1
a5069 1
  /* PREFIX_VEX_3A7E */
d5073 1
a5073 1
    { VEX_LEN_TABLE (VEX_LEN_3A7E_P_2) },
d5077 1
a5077 1
  /* PREFIX_VEX_3A7F */
d5081 1
a5081 1
    { VEX_LEN_TABLE (VEX_LEN_3A7F_P_2) },
d7476 2
a7477 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7479 8
a7486 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7494 2
a7495 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7497 8
a7504 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7512 2
a7513 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7515 8
a7522 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7680 2
a7681 2
    { PREFIX_TABLE (PREFIX_VEX_3A48) },
    { PREFIX_TABLE (PREFIX_VEX_3A49) },
d7702 4
a7705 4
    { PREFIX_TABLE (PREFIX_VEX_3A5C) },
    { PREFIX_TABLE (PREFIX_VEX_3A5D) },
    { PREFIX_TABLE (PREFIX_VEX_3A5E) },
    { PREFIX_TABLE (PREFIX_VEX_3A5F) },
d7716 8
a7723 8
    { PREFIX_TABLE (PREFIX_VEX_3A68) },
    { PREFIX_TABLE (PREFIX_VEX_3A69) },
    { PREFIX_TABLE (PREFIX_VEX_3A6A) },
    { PREFIX_TABLE (PREFIX_VEX_3A6B) },
    { PREFIX_TABLE (PREFIX_VEX_3A6C) },
    { PREFIX_TABLE (PREFIX_VEX_3A6D) },
    { PREFIX_TABLE (PREFIX_VEX_3A6E) },
    { PREFIX_TABLE (PREFIX_VEX_3A6F) },
d7734 8
a7741 8
    { PREFIX_TABLE (PREFIX_VEX_3A78) },
    { PREFIX_TABLE (PREFIX_VEX_3A79) },
    { PREFIX_TABLE (PREFIX_VEX_3A7A) },
    { PREFIX_TABLE (PREFIX_VEX_3A7B) },
    { PREFIX_TABLE (PREFIX_VEX_3A7C) },
    { PREFIX_TABLE (PREFIX_VEX_3A7D) },
    { PREFIX_TABLE (PREFIX_VEX_3A7E) },
    { PREFIX_TABLE (PREFIX_VEX_3A7F) },
a9053 48
  /* VEX_LEN_3A6A_P_2 */
  {
    { "vfmaddss",	{ XMVexW, Vex128FMA, EXdVexW, EXdVexW, VexI4 } },
    { "(bad)",		{ XX } },
  },

  /* VEX_LEN_3A6B_P_2 */
  {
    { "vfmaddsd",	{ XMVexW, Vex128FMA, EXqVexW, EXqVexW, VexI4 } },
    { "(bad)",		{ XX } },
  },

  /* VEX_LEN_3A6E_P_2 */
  {
    { "vfmsubss",	{ XMVexW, Vex128FMA, EXdVexW, EXdVexW, VexI4 } },
    { "(bad)",		{ XX } },
  },

  /* VEX_LEN_3A6F_P_2 */
  {
    { "vfmsubsd",	{ XMVexW, Vex128FMA, EXqVexW, EXqVexW, VexI4 } },
    { "(bad)",		{ XX } },
  },

  /* VEX_LEN_3A7A_P_2 */
  {
    { "vfnmaddss",	{ XMVexW, Vex128FMA, EXdVexW, EXdVexW, VexI4 } },
    { "(bad)",		{ XX } },
  },

  /* VEX_LEN_3A7B_P_2 */
  {
    { "vfnmaddsd",	{ XMVexW, Vex128FMA, EXqVexW, EXqVexW, VexI4 } },
    { "(bad)",		{ XX } },
  },

  /* VEX_LEN_3A7E_P_2 */
  {
    { "vfnmsubss",	{ XMVexW, Vex128FMA, EXdVexW, EXdVexW, VexI4 } },
    { "(bad)",		{ XX } },
  },

  /* VEX_LEN_3A7F_P_2 */
  {
    { "vfnmsubsd",	{ XMVexW, Vex128FMA, EXqVexW, EXqVexW, VexI4 } },
    { "(bad)",		{ XX } },
  },

d11205 1
a11205 3
	  /* operand size flag for cwtl, cbtw */
	  USED_REX (REX_W);
	  if (rex & REX_W)
d11207 11
a11217 2
	      if (intel_syntax)
		*obufp++ = 'd';
d11219 3
a11221 1
		*obufp++ = 'l';
a11222 2
	  else if (sizeflag & DFLAG)
	    *obufp++ = 'w';
d11224 10
a11233 3
	    *obufp++ = 'b';
	  if (!(rex & REX_W))
	    used_prefixes |= (prefixes & PREFIX_DATA);
d11523 9
a13488 198
/* Get the VEX immediate byte without moving codep.  */

static unsigned char
get_vex_imm8 (int sizeflag)
{
  int bytes_before_imm = 0;

  /* Skip mod/rm byte.   */
  MODRM_CHECK;
  codep++;

  if (modrm.mod != 3)
    {
      /* There are SIB/displacement bytes.  */
      if ((sizeflag & AFLAG) || address_mode == mode_64bit)
	{
	  /* 32/64 bit address mode */
	  int base = modrm.rm;

	  /* Check SIB byte.  */
	  if (base == 4)
	    {
	      FETCH_DATA (the_info, codep + 1);
	      base = *codep & 7;
	      bytes_before_imm++;
	    }

	  switch (modrm.mod)
	    {
	    case 0:
	      /* When modrm.rm == 5 or modrm.rm == 4 and base in
		 SIB == 5, there is a 4 byte displacement.  */
	      if (base != 5)
		/* No displacement. */
		break;
	    case 2:
	      /* 4 byte displacement.  */
	      bytes_before_imm += 4;
	      break;
	    case 1:
	      /* 1 byte displacement.  */
	      bytes_before_imm++;
	      break;
	    }
	}
      else
	{ /* 16 bit address mode */
	  switch (modrm.mod)
	    {
	    case 0:
	      /* When modrm.rm == 6, there is a 2 byte displacement.  */
	      if (modrm.rm != 6)
		/* No displacement. */
		break;
	    case 2:
	      /* 2 byte displacement.  */
	      bytes_before_imm += 2;
	      break;
	    case 1:
	      /* 1 byte displacement.  */
	      bytes_before_imm++;
	      break;
	    }
	}
    }

  FETCH_DATA (the_info, codep + bytes_before_imm + 1);
  return codep [bytes_before_imm];
}

static void
OP_EX_VexReg (int bytemode, int sizeflag, int reg)
{
  if (reg == -1 && modrm.mod != 3)
    {
      OP_E_memory (bytemode, sizeflag, 0);
      return;
    }
  else
    {
      if (reg == -1)
	{
	  reg = modrm.rm;
	  USED_REX (REX_B);
	  if (rex & REX_B)
	    reg += 8;
	}
      else if (reg > 7 && address_mode != mode_64bit)
	BadOp ();
    }

  switch (vex.length)
    {
    case 128:
      sprintf (scratchbuf, "%%xmm%d", reg);
      break;
    case 256:
      sprintf (scratchbuf, "%%ymm%d", reg);
      break;
    default:
      abort ();
    }
  oappend (scratchbuf + intel_syntax);
}

static void
OP_EX_VexImmW (int bytemode, int sizeflag)
{
  int reg = -1;
  static unsigned char vex_imm8;

  if (!vex_w_done)
    {
      vex_imm8 = get_vex_imm8 (sizeflag);
      if (vex.w)
	reg = vex_imm8 >> 4;
      vex_w_done = 1;
    }
  else
    {
      if (!vex.w)
	reg = vex_imm8 >> 4;
    }

  OP_EX_VexReg (bytemode, sizeflag, reg);
}

static void
OP_EX_VexW (int bytemode, int sizeflag)
{
  int reg = -1;

  if (!vex_w_done)
    {
      vex_w_done = 1;
      if (vex.w)
	reg = vex.register_specifier;
    }
  else
    {
      if (!vex.w)
	reg = vex.register_specifier;
    }

  OP_EX_VexReg (bytemode, sizeflag, reg);
}

static void
OP_VEX_FMA (int bytemode, int sizeflag)
{
  int reg = get_vex_imm8 (sizeflag) >> 4;

  if (reg > 7 && address_mode != mode_64bit)
    BadOp ();

  switch (vex.length)
    {
    case 128:
      switch (bytemode)
	{
	case vex_mode:
	case vex128_mode:
	  break;
	default:
	  abort ();
	  return;
	}

      sprintf (scratchbuf, "%%xmm%d", reg);
      break;
    case 256:
      switch (bytemode)
	{
	case vex_mode:
	  break;
	default:
	  abort ();
	  return;
	}

      sprintf (scratchbuf, "%%ymm%d", reg);
      break;
    default:
      abort ();
    }
  oappend (scratchbuf + intel_syntax);
}

static void
VEXI4_Fixup (int bytemode ATTRIBUTE_UNUSED,
	     int sizeflag ATTRIBUTE_UNUSED)
{
  /* Skip the immediate byte and check for invalid bits.  */
  FETCH_DATA (the_info, codep + 1);
  if (*codep++ & 0xf)
    BadOp ();
}

a13520 9
OP_XMM_VexW (int bytemode, int sizeflag)
{
  /* Turn off the REX.W bit since it is used for swapping operands
     now.  */
  rex &= ~REX_W;
  OP_XMM (bytemode, sizeflag);
}

static void
a13670 37
static const struct op vpermil2_op[] =
{
  { STRING_COMMA_LEN ("td") },
  { STRING_COMMA_LEN ("td") },
  { STRING_COMMA_LEN ("mo") },
  { STRING_COMMA_LEN ("mz") }
};

static void
VPERMIL2_Fixup (int bytemode ATTRIBUTE_UNUSED,
		int sizeflag ATTRIBUTE_UNUSED)
{
  unsigned int vpermil2_type;

  FETCH_DATA (the_info, codep + 1);
  vpermil2_type = *codep++ & 0xf;
  if (vpermil2_type < ARRAY_SIZE (vpermil2_op))
    {
      char suffix [4];
      char *p = mnemonicendp - 3;
      suffix[0] = p[0];
      suffix[1] = p[1];
      suffix[2] = p[2];
      suffix[3] = '\0';
      sprintf (p, "%s%s", vpermil2_op[vpermil2_type].name, suffix);
      mnemonicendp += vpermil2_op[vpermil2_type].len;
    }
  else
    {
      /* We have a reserved extension byte.  Output it directly.  */
      scratchbuf[0] = '$';
      print_operand_value (scratchbuf + 1, 1, vpermil2_type);
      oappend (scratchbuf + intel_syntax);
      scratchbuf[0] = '\0';
    }
}

@


1.186
log
@gas/

2008-12-20  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c (_i386_insn): Add swap_operand.
	(parse_insn): Handle ".s".
	(match_template): Handle swap_operand.

	* doc/c-i386.texi: Document .s suffix.

gas/testsuite/

2008-12-20  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run opts, opts-intel, sse2avx-opts,
	sse2avx-opts-intel, x86-64-opts, x86-64-opts-intel,
	x86-64-sse2avx-opts and x86-64-sse2avx-opts-intel.

	* gas/i386/opts.d: New.
	* gas/i386/opts-intel.d: Likewise.
	* gas/i386/opts.s: Likewise.
	* gas/i386/sse2avx-opts.d: Likewise.
	* gas/i386/sse2avx-opts-intel.d: Likewise.
	* gas/i386/x86-64-opts.d: Likewise.
	* gas/i386/x86-64-opts-intel.d: Likewise.
	* gas/i386/x86-64-opts.s: Likewise.
	* gas/i386/x86-64-sse2avx-opts.d: Likewise.
	* gas/i386/x86-64-sse2avx-opts-intel.d: Likewise.

opcodes/

2008-12-20  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (EbS): New.
	(EvS): Likewise.
	(EMS): Likewise.
	(EXqS): Likewise.
	(EXxS): Likewise.
	(b_swap_mode): Likewise.
	(v_swap_mode): Likewise.
	(q_swap_mode): Likewise.
	(x_swap_mode): Likewise.
	(v_mode): Updated.
	(w_mode): Likewise.
	(t_mode): Likewise.
	(xmm_mode): Likewise.
	(swap_operand): Likewise.
	(dis386): Use EbS on movB.  Use EvS on moveS.
	(dis386_twobyte): Use EXxS on movapX.
	(prefix_table): Use EXxS on movups, movupd, movdqu, movdqa,
	vmovups, vmovdqu, vmovdqa. Use EMS and EXqS on movq.
	(vex_table): Use EXxS on vmovapX.
	(vex_len_table): Use EXqS on vmovq.
	(intel_operand_size): Handle b_swap_mode, v_swap_mode,
	q_swap_mode and x_swap_mode.
	(OP_E_register): Handle b_swap_mode and v_swap_mode.
	(OP_EM): Handle v_swap_mode.
	(OP_EX): x_swap_mode and q_swap_mode.

	* i386-gen.c (opcode_modifiers): Add S.

	* i386-opc.h (S): New.
	(Modrm): Updated.
	(i386_opcode_modifier): Add s.

	* i386-opc.tbl: Add S to movapd, movaps, movdqa, movdqu, movq,
	movupd, movups, vmovapd, vmovaps, vmovdqa, vmovdqu and vmovq.
	* i386-tbl.h: Regenerated.
@
text
@d365 1
d388 1
d390 1
d433 2
d436 1
a436 1
#define q_mode			(d_mode + 1)
d2435 1
a2435 1
    { "movss",	{ EXd, XM } },
d2437 1
a2437 1
    { "movsd",	{ EXq, XM } },
d7851 1
a7851 1
    { "vmovss",		{ EXdVex, Vex128, XM } },
d7857 1
a7857 1
    { "vmovsd",		{ EXqVex, Vex128, XM } },
d11423 1
d12661 3
a12663 1
      && (bytemode == x_swap_mode || bytemode == q_swap_mode))
@


1.185
log
@gas/testsuite/

2008-12-18  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/intel.d: Remove trailing white spaces after nop.
	* gas/i386/intelpic.d: Likewise.
	* gas/i386/nops16-1.d: Likewise.
	* gas/i386/nops-1-i686.d: Likewise.
	* gas/i386/nops-3.d: Likewise.
	* gas/i386/nops-3-i386.d: Likewise.
	* gas/i386/nops-3-i686.d: Likewise.
	* gas/i386/nops-4.d: Likewise.
	* gas/i386/nops-4-i386.d: Likewise.
	* gas/i386/nops-4-i686.d: Likewise.
	* gas/i386/opcode.d: Likewise.
	* gas/i386/opcode-suffix.d: Likewise.
	* gas/i386/reloc.d: Likewise.
	* gas/i386/tlsnopic.d: Likewise.
	* gas/i386/x86-64-nops-1.d: Likewise.
	* gas/i386/x86-64-nops-1-nocona.d: Likewise.
	* gas/i386/x86-64-nops-2.d: Likewise.
	* gas/i386/x86-64-nops-3.d: Likewise.
	* gas/i386/x86-64-nops-4-core2.d: Likewise.
	* gas/i386/x86-64-nops-4.d: Likewise.
	* gas/i386/x86-64-nops-4-k8.d: Likewise.
	* gas/i386/x86-64-opcode.d: Likewise.

ld/testsuite/

2008-12-18  H.J. Lu  <hongjiu.lu@@intel.com>

	* ld-i386/tlsld1.dd: Remove trailing white spaces after nop.

opcodes/

2008-12-18  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (mnemonicendp): New.
	(op): Likewise.
	(print_insn): Use mnemonicendp.
	(OP_3DNowSuffix): Likewise.
	(CMP_Fixup): Likewise.
	(CMPXCHG8B_Fixup): Likewise.
	(CRC32_Fixup): Likewise.
	(OP_DREX_FCMP): Likewise.
	(OP_DREX_ICMP): Likewise.
	(VZERO_Fixup): Likewise.
	(VCMP_Fixup): Likewise.
	(PCLMUL_Fixup): Likewise.
	(VPERMIL2_Fixup): Likewise.
	(MOVBE_Fixup): Likewise.
	(putop): Update mnemonicendp.
	(oappend): Use stpcpy.
	(simd_cmp_op): Changed to struct op.
	(vex_cmp_op): Likewise.
	(pclmul_op): Likewise.
	(vpermil2_op): Likewise.
@
text
@d243 1
d245 1
d360 1
d366 1
d368 1
d420 2
d423 3
a425 1
#define v_mode			(b_mode + 1)
d427 1
a427 1
#define w_mode			(v_mode + 1)
d432 2
d435 1
a435 1
#define t_mode			(q_mode + 1)
d438 2
d441 1
a441 1
#define xmm_mode		(x_mode + 1)
d1474 2
a1475 2
  { "movB",		{ Gb, Eb } },
  { "movS",		{ Gv, Ev } },
d1656 1
a1656 1
  { "movapX",		{ EXx, XM } },
d2429 1
a2429 1
    { "movups",	{ EXx, XM } },
d2431 1
a2431 1
    { "movupd",	{ EXx, XM } },
d2701 3
a2703 3
    { "movq",	{ EM, MX } },
    { "movdqu",	{ EXx, XM } },
    { "movdqa",	{ EXx, XM } },
d2759 1
a2759 1
    { "movq",	{ EXq, XM } },
d3309 1
a3309 1
    { "vmovups", { EXx, XM } },
d3311 1
a3311 1
    { "vmovupd", { EXx, XM } },
d3734 2
a3735 2
    { "vmovdqu", { EXx, XM } },
    { "vmovdqa", { EXx, XM } },
d7005 1
a7005 1
    { "vmovapX",	{ EXx, XM } },
d8344 1
a8344 1
    { "vmovq",		{ EXq, XM } },
d10740 8
d11375 1
d11392 1
d11422 1
d11442 1
d11513 4
d11520 1
d11549 1
d11557 3
a11559 1
      else if ((sizeflag & DFLAG) || bytemode != v_mode)
d12571 2
a12572 1
      if (intel_syntax && bytemode == v_mode)
d12581 3
d12654 4
@


1.184
log
@2008-12-08  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (putop): Remove strayed comments.
@
text
@d1934 1
d1965 6
d10369 1
a10369 1
  obufp = obuf + strlen (obuf);
d11194 1
d11201 1
a11201 2
  strcpy (obufp, s);
  obufp += strlen (s);
d12779 1
a12779 1
  obufp = obuf + strlen (obuf);
d12793 1
d12796 10
a12805 9
static const char *simd_cmp_op[] = {
  "eq",
  "lt",
  "le",
  "unord",
  "neq",
  "nlt",
  "nle",
  "ord"
d12818 1
a12818 1
      char *p = obuf + strlen (obuf) - 2;
d12822 2
a12823 1
      sprintf (p, "%s%s", simd_cmp_op[cmp_type], suffix);
d12927 2
a12928 2
      char *p = obuf + strlen (obuf) - 2;
      strcpy (p, "16b");
d12960 1
a12960 1
  char *p = obuf + strlen (obuf);
d12966 1
a12966 1
	break;
d12972 1
a12972 1
	break;
d12987 1
d12990 1
d13318 1
a13318 1
      strcpy (obuf, scratchbuf);
d13360 1
a13360 1
      strcpy (obuf, scratchbuf);
d13680 1
a13680 1
      strcpy (obuf, "vzeroupper");
d13683 1
a13683 1
      strcpy (obuf, "vzeroall");
d13690 34
a13723 33
static const char *vex_cmp_op[] = {
  "eq",
  "lt",
  "le",
  "unord",
  "neq",
  "nlt",
  "nle",
  "ord",
  "eq_uq",
  "nge",
  "ngt",
  "false",
  "neq_oq",
  "ge",
  "gt",
  "true",
  "eq_os",
  "lt_oq",
  "le_oq",
  "unord_s",
  "neq_us",
  "nlt_uq",
  "nle_uq",
  "ord_s",
  "eq_us",
  "nge_uq",
  "ngt_uq",
  "false_os",
  "neq_os",
  "ge_oq",
  "gt_oq",
  "true_us"
d13736 1
a13736 1
      char *p = obuf + strlen (obuf) - 2;
d13740 2
a13741 1
      sprintf (p, "%s%s", vex_cmp_op[cmp_type], suffix);
d13753 6
a13758 5
static const char *pclmul_op[] = {
  "lql",
  "hql",
  "lqh",
  "hqh"
d13783 1
a13783 1
      char *p = obuf + strlen (obuf) - 3;
d13788 2
a13789 1
      sprintf (p, "%s%s", pclmul_op[pclmul_type], suffix);
d13801 6
a13806 5
static const char *vpermil2_op[] = {
  "td",
  "td",
  "mo",
  "mz"
d13820 1
a13820 1
      char *p = obuf + strlen (obuf) - 3;
d13825 2
a13826 1
      sprintf (p, "%s%s", vpermil2_op[vpermil2_type], suffix);
d13842 1
a13842 1
  char *p = obuf + strlen (obuf);
d13848 1
a13848 1
	break;
d13866 1
d13869 1
@


1.183
log
@gas/testsuite/
2008-08-28  Jan Beulich  <jbeulich@@novell.com>

	* gas/i386/intel.s: Add retf.
	* gas/i386/intel.{d,e}: Adjust.
	* gas/i386/opcode-intel.d: Replace lret with retf.

opcodes/
2008-08-28  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (dis386): Adjust far return mnemonics.
	* i386-opc.tbl: Add retf.
	* i386-tbl.h: Re-generate.
@
text
@a11165 1
	  /* implicit operand size 'l' for i386 or 'q' for x86-64 */
@


1.182
log
@gas/testsuite/
2008-08-28  Jan Beulich  <jbeulich@@novell.com>

	* gas/i386/gas/i386/opcode-suffix.d: Add suffixes to cmovXX.

opcodes/
2008-08-28  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (dis386_twobyte): Adjust cmovXX mnemonics.
@
text
@d1533 2
a1534 2
  { "lretP",		{ Iw } },
  { "lretP",		{ XX } },
@


1.181
log
@gas/

2008-08-20  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (August, 2008)
	* config/tc-i386.c (CPU_FLAGS_AES_MATCH): New.
	(CPU_FLAGS_AVX_MATCH): Likewise.
	(CPU_FLAGS_32BIT_MATCH): Updated.
	(cpu_flags_match): Likewise.

gas/testsuite/

2008-08-20  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (August, 2008)
	* gas/i386/avx.s: Add AES + AVX tests.
	* gas/i386/arch-10.s: Likewise.
	* gas/i386/sse2avx.s: Likewise.
	* gas/i386/x86-64-arch-2.s: Likewise.
	* gas/i386/x86-64-avx.s: Likewise.
	* gas/i386/x86-64-sse2avx.s: Likewise.

	* gas/i386/arch-10.d: Updated.
	* gas/i386/arch-10-1.l: Likewise.
	* gas/i386/arch-10-2.l: Likewise.
	* gas/i386/arch-10-3.l: Likewise.
	* gas/i386/arch-10-4.l: Likewise.
	* gas/i386/avx.d: Likewise.
	* gas/i386/avx-intel.d: Likewise.
	* gas/i386/sse2avx.d: Likewise.
	* gas/i386/x86-64-arch-2.d: Likewise.
	* gas/i386/x86-64-avx.d: Likewise.
	* gas/i386/x86-64-avx-intel.d: Likewise.
	* gas/i386/x86-64-sse2avx.d: Likewise.

	* gas/i386/i386.exp: Run arch-avx-1, arch-avx-1-1 and
	arch-avx-1-2.

	* gas/i386/arch-avx-1.d: New.
	* gas/i386/arch-avx-1.s: Likewise.
	* gas/i386/arch-avx-1-1.l: Likewise.
	* gas/i386/arch-avx-1-1.s: Likewise.
	* gas/i386/arch-avx-1-2.l: Likewise.
	* gas/i386/arch-avx-1-2.s: Likewise.

opcodes/

2008-08-20  H.J. Lu  <hongjiu.lu@@intel.com>

	AVX Programming Reference (August, 2008)
	* i386-dis.c (PREFIX_VEX_38DB): New.
	(PREFIX_VEX_38DC): Likewise.
	(PREFIX_VEX_38DD): Likewise.
	(PREFIX_VEX_38DE): Likewise.
	(PREFIX_VEX_38DF): Likewise.
	(PREFIX_VEX_3ADF): Likewise.
	(VEX_LEN_38DB_P_2): Likewise.
	(VEX_LEN_38DC_P_2): Likewise.
	(VEX_LEN_38DD_P_2): Likewise.
	(VEX_LEN_38DE_P_2): Likewise.
	(VEX_LEN_38DF_P_2): Likewise.
	(VEX_LEN_3ADF_P_2): Likewise.
	(PREFIX_VEX_3A04): Updated.
	(VEX_LEN_3A06_P_2): Likewise.
	(prefix_table): Add PREFIX_VEX_38DB, PREFIX_VEX_38DC,
	PREFIX_VEX_38DD, PREFIX_VEX_38DE and PREFIX_VEX_3ADF.
	(x86_64_table): Likewise.
	(vex_len_table): Add VEX_LEN_38DB_P_2, VEX_LEN_38DC_P_2,
	VEX_LEN_38DD_P_2, VEX_LEN_38DE_P_2, VEX_LEN_38DF_P_2 and
	VEX_LEN_3ADF_P_2.

	* i386-opc.tbl: Add AES + AVX instructions.
	* i386-init.h: Regenerated.
	* i386-tbl.h: Likewise.
@
text
@d1669 8
a1676 8
  { "cmovo",		{ Gv, Ev } },
  { "cmovno",		{ Gv, Ev } },
  { "cmovb",		{ Gv, Ev } },
  { "cmovae",		{ Gv, Ev } },
  { "cmove",		{ Gv, Ev } },
  { "cmovne",		{ Gv, Ev } },
  { "cmovbe",		{ Gv, Ev } },
  { "cmova",		{ Gv, Ev } },
d1678 8
a1685 8
  { "cmovs",		{ Gv, Ev } },
  { "cmovns",		{ Gv, Ev } },
  { "cmovp",		{ Gv, Ev } },
  { "cmovnp",		{ Gv, Ev } },
  { "cmovl",		{ Gv, Ev } },
  { "cmovge",		{ Gv, Ev } },
  { "cmovle",		{ Gv, Ev } },
  { "cmovg",		{ Gv, Ev } },
@


1.180
log
@Silence gcc printf warnings
@
text
@d942 6
a947 1
#define PREFIX_VEX_3A04		(PREFIX_VEX_3841 + 1)
d999 1
d1209 6
a1214 1
#define VEX_LEN_3A06_P_2	(VEX_LEN_3841_P_2 + 1)
d1243 1
d4551 40
d5006 8
d7476 5
a7480 5
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d7771 1
a7771 1
    { "(bad)",		{ XX } },
d8820 30
d9023 6
@


1.179
log
@gas/

2008-05-02  H.J. Lu  <hongjiu.lu@@intel.com>

	* NEWS: Mention XSAVE, EPT and MOVBE.

	* config/tc-i386.c (cpu_arch): Add .movbe and .ept.
	(md_show_usage): Add .movbe and .ept.

	* doc/c-i386.texi: Add movbe and ept to -march=.  Document
	.movbe and .ept.

gas/testsuite/

2008-05-02  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run movbe, movbe-intel, inval-movbe, ept,
	ept-intel, inval-ept, x86-64-movbe, x86-64-movbe-intel,
	x86-64-inval-movbe.  x86-64-ept, x86-64-ept-intel and
	x86-64-inval-ept.

	* gas/i386/arch-10.s: Add movbe and invept.
	* gas/i386/x86-64-arch-2.s: Likewise.

	* gas/i386/ept.d: New file
	* gas/i386/ept-intel.d: Likewise.
	* gas/i386/ept.s: Likewise.
	* gas/i386/inval-ept.l: Likewise.
	* gas/i386/inval-ept.s: Likewise.
	* gas/i386/inval-movbe.l: Likewise.
	* gas/i386/inval-movbe.s: Likewise.
	* gas/i386/movbe.d: Likewise.
	* gas/i386/movbe-intel.d: Likewise.
	* gas/i386/movbe.s: Likewise.
	* gas/i386/x86-64-inval-ept.l: Likewise.
	* gas/i386/x86-64-inval-ept.s: Likewise.
	* gas/i386/x86-64-inval-movbe.l: Likewise.
	* gas/i386/x86-64-inval-movbe.s: Likewise.
	* gas/i386/x86-64-ept.d: Likewise.
	* gas/i386/x86-64-ept-intel.d: Likewise.
	* gas/i386/x86-64-ept.s: Likewise.
	* gas/i386/x86-64-movbe.d: Likewise.
	* gas/i386/x86-64-movbe-intel.d: Likewise.
	* gas/i386/x86-64-movbe.s: Likewise.

	* gas/i386/arch-10.d: Updated.
	* gas/i386/arch-10-1.l: Likewise.
	* gas/i386/arch-10-2.l: Likewise.
	* gas/i386/arch-10-3.l: Likewise.
	* gas/i386/arch-10-4.l: Likewise.
	* gas/i386/x86-64-arch-2.d: Likewise.

opcodes/

2008-05-02  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (MOVBE_Fixup): New.
	(Mo): Likewise.
	(PREFIX_0F3880): Likewise.
	(PREFIX_0F3881): Likewise.
	(PREFIX_0F38F0): Updated.
	(prefix_table): Add PREFIX_0F3880 and PREFIX_0F3881.  Update
	PREFIX_0F38F0 and PREFIX_0F38F1 for movbe.
	(three_byte_table): Use PREFIX_0F3880 and PREFIX_0F3881.

	* i386-gen.c (cpu_flag_init): Add CPU_MOVBE_FLAGS and
	CPU_EPT_FLAGS.
	(cpu_flags): Add CpuMovbe and CpuEPT.

	* i386-opc.h (CpuMovbe): New.
	(CpuEPT): Likewise.
	(CpuLM): Updated.
	(i386_cpu_flags): Add cpumovbe and cpuept.

	* i386-opc.tbl: Add entries for movbe and EPT instructions.
	* i386-init.h: Regenerated.
	* i386-tbl.h: Likewise.
@
text
@d3 2
a4 1
   2001, 2002, 2003, 2004, 2005, 2006, 2007 Free Software Foundation, Inc.
d11238 1
a11238 1
  sprintf_vma (tmp, val);
@


1.178
log
@gas/

2008-04-18  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c (build_modrm_byte): Swap REG and NDS for
	FMA.

gas/testsuite/

2008-04-18  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/arch-10.d: Updated.
	* gas/i386/avx.d: Likewise.
	* gas/i386/avx-intel.d: Likewise.
	* gas/i386/x86-64-arch-2.d: Likewise.
	* gas/i386/x86-64-avx.d: Likewise.
	* gas/i386/x86-64-avx-intel.d: Likewise.

opcodes/

2008-04-18  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_VEX_FMA): New.
	(OP_EX_VexImmW): Likewise.
	(VexFMA): Likewise.
	(Vex128FMA): Likewise.
	(EXVexImmW): Likewise.
	(get_vex_imm8): Likewise.
	(OP_EX_VexReg): Likewise.
	(vex_i4_done): Renamed to ...
	(vex_w_done): This.
	(prefix_table): Replace EXVexW with EXVexImmW on vpermil2ps
	and vpermil2pd.  Replace Vex/Vex128 with VexFMA/Vex128FMA on
	FMA instructions.
	(print_insn): Updated.
	(OP_EX_VexW): Rewrite to swap register in VEX with EX.
	(OP_REG_VexI4): Check invalid high registers.
@
text
@d124 1
d258 1
d750 3
a752 1
#define PREFIX_0F38DB		(PREFIX_0F3841 + 1)
d3010 16
d3068 1
d3070 1
a3070 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d3076 1
d3078 1
a3078 2
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d5855 2
a5856 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d13723 33
@


1.177
log
@2008-04-07  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (PREFIX_VEX_38XX): Add a tab.
	(PREFIX_VEX_3AXX): Likewis.
@
text
@d95 1
d98 1
d376 2
d383 1
d1945 1
a1945 1
static unsigned char vex_i4_done;
d4706 1
a4706 1
    { "vpermil2ps", { XMVexW, Vex, EXVexW, EXVexW, VPERMIL2 } },
d4714 1
a4714 1
    { "vpermil2pd", { XMVexW, Vex, EXVexW, EXVexW, VPERMIL2 } },
d4746 1
a4746 1
    { "vfmaddsubps", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
d4754 1
a4754 1
    { "vfmaddsubpd", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
d4762 1
a4762 1
    { "vfmsubaddps", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
d4770 1
a4770 1
    { "vfmsubaddpd", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
d4810 1
a4810 1
    { "vfmaddps", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
d4818 1
a4818 1
    { "vfmaddpd", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
d4842 1
a4842 1
    { "vfmsubps", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
d4850 1
a4850 1
    { "vfmsubpd", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
d4874 1
a4874 1
    { "vfnmaddps", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
d4882 1
a4882 1
    { "vfnmaddpd", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
d4906 1
a4906 1
    { "vfnmsubps", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
d4914 1
a4914 1
    { "vfnmsubpd", { XMVexW, Vex, EXVexW, EXVexW, VexI4 } },
d8867 1
a8867 1
    { "vfmaddss",	{ XMVexW, Vex128, EXdVexW, EXdVexW, VexI4 } },
d8873 1
a8873 1
    { "vfmaddsd",	{ XMVexW, Vex128, EXqVexW, EXqVexW, VexI4 } },
d8879 1
a8879 1
    { "vfmsubss",	{ XMVexW, Vex128, EXdVexW, EXdVexW, VexI4 } },
d8885 1
a8885 1
    { "vfmsubsd",	{ XMVexW, Vex128, EXqVexW, EXqVexW, VexI4 } },
d8891 1
a8891 1
    { "vfnmaddss",	{ XMVexW, Vex128, EXdVexW, EXdVexW, VexI4 } },
d8897 1
a8897 1
    { "vfnmaddsd",	{ XMVexW, Vex128, EXqVexW, EXqVexW, VexI4 } },
d8903 1
a8903 1
    { "vfnmsubss",	{ XMVexW, Vex128, EXdVexW, EXdVexW, VexI4 } },
d8909 1
a8909 1
    { "vfnmsubsd",	{ XMVexW, Vex128, EXqVexW, EXqVexW, VexI4 } },
d10192 1
a10192 1
      vex_i4_done = 0;
d13284 4
a13287 2
static void
OP_EX_VexW (int bytemode, int sizeflag)
d13289 5
a13293 2
  int reg = -1;
  static unsigned char vex_i4;
d13295 1
a13295 1
  if (!vex_i4_done)
d13297 5
a13301 1
      int bytes_before_imm = 0;
d13303 7
a13309 3
      /* Skip mod/rm byte once. We will be called twice. */
      MODRM_CHECK;
      codep++;
d13311 1
a13311 4
      if (modrm.mod != 3)
	{
	  /* There are SIB/displacement bytes.  */
	  if ((sizeflag & AFLAG) || address_mode == mode_64bit)
d13313 14
a13326 28
	      /* 32/64 bit address mode */
	      int base = modrm.rm;

	      /* Check SIB byte.  */
	      if (base == 4)
		{
		  FETCH_DATA (the_info, codep + 1);
		  base = *codep & 7;
		  bytes_before_imm++;
		}

	      switch (modrm.mod)
		{
		case 0:
		  /* When modrm.rm == 5 or modrm.rm == 4 and base in
		     SIB == 5, there is a 4 byte displacement.  */
		  if (base != 5)
		    /* No displacement. */
		    break;
		case 2:
		  /* 4 byte displacement.  */
		  bytes_before_imm += 4;
		  break;
		case 1:
		  /* 1 byte displacement.  */
		  bytes_before_imm++;
		  break;
		}
d13328 18
a13345 19
	  else
	    { /* 16 bit address mode */
	      switch (modrm.mod)
		{
		case 0:
		  /* When modrm.rm == 6, there is a 2 byte
		     displacement.  */
		  if (modrm.rm != 6)
		    /* No displacement. */
		    break;
		case 2:
		  /* 2 byte displacement.  */
		  bytes_before_imm += 2;
		  break;
		case 1:
		  /* 1 byte displacement.  */
		  bytes_before_imm++;
		  break;
		}
d13348 1
d13350 3
a13352 11
      FETCH_DATA (the_info, codep + bytes_before_imm + 1);
      vex_i4 = codep [bytes_before_imm];
      vex_i4_done = 1;
      if (vex.w)
	reg = vex_i4 >> 4;
    }
  else
    {
      if (!vex.w)
	reg = vex_i4 >> 4;
    }
d13354 3
d13390 83
d13496 3
@


1.176
log
@binutils/

2008-04-03  H.J. Lu  <hongjiu.lu@@intel.com>

	* dwarf.c (dwarf_regnames_i386): Add AVX registers.
	(dwarf_regnames_x86_64): Likewise.

gas/

2008-04-03  H.J. Lu  <hongjiu.lu@@intel.com>

	* NEWS: Mention AES, CLMUL, AVX/FMA and -msse2avx.

	* doc/c-i386.texi: Add avx, aes, clmul and fma to -march=.
	Document -msse2avx, .avx, .aes, .clmul and .fma.

	* config/tc-i386.c (YMMWORD_MNEM_SUFFIX): New.
	(vex_prefix): Likewise.
	(sse2avx): Likewise.
	(CPU_FLAGS_ARCH_MATCH): Likewise.
	(CPU_FLAGS_64BIT_MATCH): Likewise.
	(CPU_FLAGS_32BIT_MATCH): Likewise.
	(CPU_FLAGS_PERFECT_MATCH): Likewise.
	(regymm): Likewise.
	(vex_imm4): Likewise.
	(fits_in_imm4): Likewise.
	(build_vex_prefix): Likewise.
	(VEX_check_operands): Likewise.
	(bad_implicit_operand): Likewise.
	(OPTION_MSSE2AVX): Likewise.
	(T_YMMWORD): Likewise.
	(_i386_insn): Add vex.
	(cpu_arch): Add .avx, .aes, .clmul and .fma.
	(cpu_flags_match): Changed to take a pointer to const template.
	Enable encoding SSE instructions with VEX prefix for -msse2avx.
	(match_mem_size): Also check ymmword.
	(operand_type_match): Clear ymmword.
	(md_begin): Allow '_' in mnemonic.
	(type_names): Add OPERAND_TYPE_VEX_IMM4.
	(process_immext): Update assert.
	(md_assemble): Don't call process_immext if sse2avx and immext
	are true.  Call build_vex_prefix if vex is true.
	(parse_insn): Updated for cpu_flags_match.
	(swap_operands): Handle 5 operands.
	(match_template): Handle 5 operands. Updated for cpu_flags_match.
	Check regymm.  Call VEX_check_operands. Handle YMMWORD_MNEM_SUFFIX.
	(process_suffix): Handle YMMWORD_MNEM_SUFFIX.
	(check_byte_reg): Check regymm.
	(process_operands): Duplicate the destination register for
	-msse2avx if needed.
	(build_modrm_byte): Updated for instructions with VEX encoding.
	(output_insn): Output VEX prefix if needed.
	(md_longopts): Add msse2avx.
	(md_parse_option): Handle OPTION_MSSE2AVX.
	(md_show_usage): Add avx, aes, clmul, fma and -msse2avx.
	(intel_e09): Support YMMWORD.
	(intel_e11): Likewise.
	(intel_get_token): Likewise.

gas/testsuite/

2008-04-03  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run aes, aes-intel, x86-64-aes,
	x86-64-aes-intel, avx, avx-intel, inval-avx, x86-64-avx,
	x86-64-avx-intel and x86-64-inval-avx.

	* gas/cfi/cfi-i386.s: Add tests for AVX register maps.
	* gas/cfi/cfi-x86_64.s: Likewise.

	* gas/i386/aes.d: New.
	* gas/i386/aes.s: Likewise.
	* gas/i386/aes-intel.d: Likewise.
	* gas/i386/avx.d: Likewise.
	* gas/i386/avx.s: Likewise.
	* gas/i386/avx-intel.d: Likewise.
	* gas/i386/clmul.d: Likewise.
	* gas/i386/clmul-intel.d: Likewise.
	* gas/i386/clmul.s: Likewise.
	* gas/i386/i386.exp: Likewise.
	* gas/i386/inval-avx.l: Likewise.
	* gas/i386/inval-avx.s: Likewise.
	* gas/i386/sse2avx.d: Likewise.
	* gas/i386/sse2avx.s: Likewise.
	* gas/i386/x86-64-aes.d: Likewise.
	* gas/i386/x86-64-aes.s: Likewise.
	* gas/i386/x86-64-aes-intel.d: Likewise.
	* gas/i386/x86-64-avx.d: Likewise.
	* gas/i386/x86-64-avx.s: Likewise.
	* gas/i386/x86-64-avx-intel.d: Likewise.
	* gas/i386/x86-64-clmul.d: Likewise.
	* gas/i386/x86-64-clmul-intel.d: Likewise.
	* gas/i386/x86-64-clmul.s: Likewise.
	* gas/i386/x86-64-inval-avx.l: Likewise.
	* gas/i386/x86-64-inval-avx.s: Likewise.
	* gas/i386/x86-64-sse2avx.d: Likewise.
	* gas/i386/x86-64-sse2avx.s: Likewise.

	* gas/i386/arch-10.s: Add tests for AVX, AES, CLMUL and FMA.
	* gas/i386/x86-64-arch-2.s: Likewise.

	* gas/i386/rexw.s: Add AVX tests.

	* gas/i386/x86-64-opcode-inval.s: Remove lds/les test.

	* gas/cfi/cfi-i386.d: Updated.
	* gas/cfi/cfi-x86_64.d: Likewise.
	* gas/i386/arch-10.d:  Likewise.
	* gas/i386/arch-10-1.l: Likewise.
	* gas/i386/arch-10-2.l: Likewise.
	* gas/i386/arch-10-3.l: Likewise.
	* gas/i386/arch-10-4.l: Likewise.
	* gas/i386/rexw.d: Likewise.
	* gas/i386/x86-64-arch-2.d: Likewise.
	* gas/i386/x86-64-opcode-inval.d: Likewise.
	* gas/i386/x86-64-opcode-inval-intel.d: Likewise.

include/opcode/

2008-04-03  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386.h (MAX_OPERANDS): Set to 5.
	(MAX_MNEM_SIZE): Changed to 20.

opcodes/

2008-04-03  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_E_register): New.
	(OP_E_memory): Likewise.
	(OP_VEX): Likewise.
	(OP_EX_Vex): Likewise.
	(OP_EX_VexW): Likewise.
	(OP_XMM_Vex): Likewise.
	(OP_XMM_VexW): Likewise.
	(OP_REG_VexI4): Likewise.
	(PCLMUL_Fixup): Likewise.
	(VEXI4_Fixup): Likewise.
	(VZERO_Fixup): Likewise.
	(VCMP_Fixup): Likewise.
	(VPERMIL2_Fixup): Likewise.
	(rex_original): Likewise.
	(rex_ignored): Likewise.
	(Mxmm): Likewise.
	(XMM): Likewise.
	(EXxmm): Likewise.
	(EXxmmq): Likewise.
	(EXymmq): Likewise.
	(Vex): Likewise.
	(Vex128): Likewise.
	(Vex256): Likewise.
	(VexI4): Likewise.
	(EXdVex): Likewise.
	(EXqVex): Likewise.
	(EXVexW): Likewise.
	(EXdVexW): Likewise.
	(EXqVexW): Likewise.
	(XMVex): Likewise.
	(XMVexW): Likewise.
	(XMVexI4): Likewise.
	(PCLMUL): Likewise.
	(VZERO): Likewise.
	(VCMP): Likewise.
	(VPERMIL2): Likewise.
	(xmm_mode): Likewise.
	(xmmq_mode): Likewise.
	(ymmq_mode): Likewise.
	(vex_mode): Likewise.
	(vex128_mode): Likewise.
	(vex256_mode): Likewise.
	(USE_VEX_C4_TABLE): Likewise.
	(USE_VEX_C5_TABLE): Likewise.
	(USE_VEX_LEN_TABLE): Likewise.
	(VEX_C4_TABLE): Likewise.
	(VEX_C5_TABLE): Likewise.
	(VEX_LEN_TABLE): Likewise.
	(REG_VEX_XX): Likewise.
	(MOD_VEX_XXX): Likewise.
	(PREFIX_0F38DB..PREFIX_0F38DF): Likewise.
	(PREFIX_0F3A44): Likewise.
	(PREFIX_0F3ADF): Likewise.
	(PREFIX_VEX_XXX): Likewise.
	(VEX_OF): Likewise.
	(VEX_OF38): Likewise.
	(VEX_OF3A): Likewise.
	(VEX_LEN_XXX): Likewise.
	(vex): Likewise.
	(need_vex): Likewise.
	(need_vex_reg): Likewise.
	(vex_i4_done): Likewise.
	(vex_table): Likewise.
	(vex_len_table): Likewise.
	(OP_REG_VexI4): Likewise.
	(vex_cmp_op): Likewise.
	(pclmul_op): Likewise.
	(vpermil2_op): Likewise.
	(m_mode): Updated.
	(es_reg): Likewise.
	(PREFIX_0F38F0): Likewise.
	(PREFIX_0F3A60): Likewise.
	(reg_table): Add REG_VEX_71...REG_VEX_73 and REG_VEX_AE.
	(prefix_table): Add PREFIX_0F38DB..PREFIX_0F38DF, PREFIX_0F3ADF
	and PREFIX_VEX_XXX entries.
	(x86_64_table): Use VEX_C4_TABLE and VEX_C5_TABLE.
	(three_byte_table): Use PREFIX_0F38DB..PREFIX_0F38DF and
	PREFIX_0F3ADF.
	(mod_table): Use VEX_C4_TABLE, VEX_C5_TABLE and VEX_LEN_TABLE.
	Add MOD_VEX_XXX entries.
	(ckprefix): Initialize rex_original and rex_ignored.  Store the
	REX byte in rex_original.
	(get_valid_dis386): Handle the implicit prefix in VEX prefix
	bytes and USE_VEX_LEN_TABLE/USE_VEX_C4_TABLE/USE_VEX_C5_TABLE.
	(print_insn): Set need_vex/need_vex_reg/vex_i4_done to 0 before
	calling get_valid_dis386.  Use rex_original and rex_ignored when
	printing out REX.
	(putop): Handle "XY".
	(intel_operand_size): Handle VEX, xmm_mode, xmmq_mode and
	ymmq_mode.
	(OP_E_extended): Updated to use OP_E_register and
	OP_E_memory.
	(OP_XMM): Handle VEX.
	(OP_EX): Likewise.
	(XMM_Fixup): Likewise.
	(CMP_Fixup): Use ARRAY_SIZE.

	* i386-gen.c (cpu_flag_init): Add CpuAES, CPU_CLMUL_FLAGS,
	CPU_FMA_FLAGS and CPU_AVX_FLAGS.
	(operand_type_init): Add OPERAND_TYPE_REGYMM and
	OPERAND_TYPE_VEX_IMM4.
	(cpu_flags): Add CpuAVX, CpuAES, CpuCLMUL and CpuFMA.
	(opcode_modifiers): Add Implicit1stXmm0, Vex, Vex256, VexNDD,
	VexNDS, VexW0, VexW1, Vex0F, Vex0F38, Vex0F3A, Vex3Sources,
	VexImmExt and SSE2AVX.
	(operand_types): Add RegYMM, Ymmword and Vex_Imm4.

	* i386-opc.h (CpuAVX): New.
	(CpuAES): Likewise.
	(CpuCLMUL): Likewise.
	(CpuFMA): Likewise.
	(Vex): Likewise.
	(Vex256): Likewise.
	(VexNDS): Likewise.
	(VexNDD): Likewise.
	(VexW0): Likewise.
	(VexW1): Likewise.
	(Vex0F): Likewise.
	(Vex0F38): Likewise.
	(Vex0F3A): Likewise.
	(Vex3Sources): Likewise.
	(VexImmExt): Likewise.
	(SSE2AVX): Likewise.
	(RegYMM): Likewise.
	(Ymmword): Likewise.
	(Vex_Imm4): Likewise.
	(Implicit1stXmm0): Likewise.
	(CpuXsave): Updated.
	(CpuLM): Likewise.
	(ByteOkIntel): Likewise.
	(OldGcc): Likewise.
	(Control): Likewise.
	(Unspecified): Likewise.
	(OTMax): Likewise.
	(i386_cpu_flags): Add cpuavx, cpuaes, cpuclmul and cpufma.
	(i386_opcode_modifier): Add implicit1stxmm0, vex, vex256,
	vexnds, vexndd, vexw0, vexw1, vex0f, vex0f38, vex0f3a,
	vex3sources, veximmext and sse2avx.
	(i386_operand_type): Add regymm, ymmword and vex_imm4.

	* i386-opc.tbl: Add AES, CLMUL, AVX and FMA new instructions.

	* i386-reg.tbl: Add AVX registers, ymm0..ymm15.

	* i386-init.h: Regenerated.
	* i386-tbl.h: Likewise.
@
text
@d878 106
a983 106
#define PREFIX_VEX_3800	(PREFIX_VEX_FE + 1)
#define PREFIX_VEX_3801	(PREFIX_VEX_3800 + 1)
#define PREFIX_VEX_3802	(PREFIX_VEX_3801 + 1)
#define PREFIX_VEX_3803	(PREFIX_VEX_3802 + 1)
#define PREFIX_VEX_3804	(PREFIX_VEX_3803 + 1)
#define PREFIX_VEX_3805	(PREFIX_VEX_3804 + 1)
#define PREFIX_VEX_3806	(PREFIX_VEX_3805 + 1)
#define PREFIX_VEX_3807	(PREFIX_VEX_3806 + 1)
#define PREFIX_VEX_3808	(PREFIX_VEX_3807 + 1)
#define PREFIX_VEX_3809	(PREFIX_VEX_3808 + 1)
#define PREFIX_VEX_380A	(PREFIX_VEX_3809 + 1)
#define PREFIX_VEX_380B	(PREFIX_VEX_380A + 1)
#define PREFIX_VEX_380C	(PREFIX_VEX_380B + 1)
#define PREFIX_VEX_380D	(PREFIX_VEX_380C + 1)
#define PREFIX_VEX_380E	(PREFIX_VEX_380D + 1)
#define PREFIX_VEX_380F	(PREFIX_VEX_380E + 1)
#define PREFIX_VEX_3817	(PREFIX_VEX_380F + 1)
#define PREFIX_VEX_3818	(PREFIX_VEX_3817 + 1)
#define PREFIX_VEX_3819	(PREFIX_VEX_3818 + 1)
#define PREFIX_VEX_381A	(PREFIX_VEX_3819 + 1)
#define PREFIX_VEX_381C	(PREFIX_VEX_381A + 1)
#define PREFIX_VEX_381D	(PREFIX_VEX_381C + 1)
#define PREFIX_VEX_381E	(PREFIX_VEX_381D + 1)
#define PREFIX_VEX_3820	(PREFIX_VEX_381E + 1)
#define PREFIX_VEX_3821	(PREFIX_VEX_3820 + 1)
#define PREFIX_VEX_3822	(PREFIX_VEX_3821 + 1)
#define PREFIX_VEX_3823	(PREFIX_VEX_3822 + 1)
#define PREFIX_VEX_3824	(PREFIX_VEX_3823 + 1)
#define PREFIX_VEX_3825	(PREFIX_VEX_3824 + 1)
#define PREFIX_VEX_3828	(PREFIX_VEX_3825 + 1)
#define PREFIX_VEX_3829	(PREFIX_VEX_3828 + 1)
#define PREFIX_VEX_382A	(PREFIX_VEX_3829 + 1)
#define PREFIX_VEX_382B	(PREFIX_VEX_382A + 1)
#define PREFIX_VEX_382C	(PREFIX_VEX_382B + 1)
#define PREFIX_VEX_382D	(PREFIX_VEX_382C + 1)
#define PREFIX_VEX_382E	(PREFIX_VEX_382D + 1)
#define PREFIX_VEX_382F	(PREFIX_VEX_382E + 1)
#define PREFIX_VEX_3830	(PREFIX_VEX_382F + 1)
#define PREFIX_VEX_3831	(PREFIX_VEX_3830 + 1)
#define PREFIX_VEX_3832	(PREFIX_VEX_3831 + 1)
#define PREFIX_VEX_3833	(PREFIX_VEX_3832 + 1)
#define PREFIX_VEX_3834	(PREFIX_VEX_3833 + 1)
#define PREFIX_VEX_3835	(PREFIX_VEX_3834 + 1)
#define PREFIX_VEX_3837	(PREFIX_VEX_3835 + 1)
#define PREFIX_VEX_3838	(PREFIX_VEX_3837 + 1)
#define PREFIX_VEX_3839	(PREFIX_VEX_3838 + 1)
#define PREFIX_VEX_383A	(PREFIX_VEX_3839 + 1)
#define PREFIX_VEX_383B	(PREFIX_VEX_383A + 1)
#define PREFIX_VEX_383C	(PREFIX_VEX_383B + 1)
#define PREFIX_VEX_383D	(PREFIX_VEX_383C + 1)
#define PREFIX_VEX_383E	(PREFIX_VEX_383D + 1)
#define PREFIX_VEX_383F	(PREFIX_VEX_383E + 1)
#define PREFIX_VEX_3840	(PREFIX_VEX_383F + 1)
#define PREFIX_VEX_3841	(PREFIX_VEX_3840 + 1)
#define PREFIX_VEX_3A04	(PREFIX_VEX_3841 + 1)
#define PREFIX_VEX_3A05	(PREFIX_VEX_3A04 + 1)
#define PREFIX_VEX_3A06	(PREFIX_VEX_3A05 + 1)
#define PREFIX_VEX_3A08	(PREFIX_VEX_3A06 + 1)
#define PREFIX_VEX_3A09	(PREFIX_VEX_3A08 + 1)
#define PREFIX_VEX_3A0A	(PREFIX_VEX_3A09 + 1)
#define PREFIX_VEX_3A0B	(PREFIX_VEX_3A0A + 1)
#define PREFIX_VEX_3A0C	(PREFIX_VEX_3A0B + 1)
#define PREFIX_VEX_3A0D	(PREFIX_VEX_3A0C + 1)
#define PREFIX_VEX_3A0E	(PREFIX_VEX_3A0D + 1)
#define PREFIX_VEX_3A0F	(PREFIX_VEX_3A0E + 1)
#define PREFIX_VEX_3A14	(PREFIX_VEX_3A0F + 1)
#define PREFIX_VEX_3A15	(PREFIX_VEX_3A14 + 1)
#define PREFIX_VEX_3A16	(PREFIX_VEX_3A15 + 1)
#define PREFIX_VEX_3A17	(PREFIX_VEX_3A16 + 1)
#define PREFIX_VEX_3A18	(PREFIX_VEX_3A17 + 1)
#define PREFIX_VEX_3A19	(PREFIX_VEX_3A18 + 1)
#define PREFIX_VEX_3A20	(PREFIX_VEX_3A19 + 1)
#define PREFIX_VEX_3A21	(PREFIX_VEX_3A20 + 1)
#define PREFIX_VEX_3A22	(PREFIX_VEX_3A21 + 1)
#define PREFIX_VEX_3A40	(PREFIX_VEX_3A22 + 1)
#define PREFIX_VEX_3A41	(PREFIX_VEX_3A40 + 1)
#define PREFIX_VEX_3A42	(PREFIX_VEX_3A41 + 1)
#define PREFIX_VEX_3A48	(PREFIX_VEX_3A42 + 1)
#define PREFIX_VEX_3A49	(PREFIX_VEX_3A48 + 1)
#define PREFIX_VEX_3A4A	(PREFIX_VEX_3A49 + 1)
#define PREFIX_VEX_3A4B	(PREFIX_VEX_3A4A + 1)
#define PREFIX_VEX_3A4C	(PREFIX_VEX_3A4B + 1)
#define PREFIX_VEX_3A5C	(PREFIX_VEX_3A4C + 1)
#define PREFIX_VEX_3A5D	(PREFIX_VEX_3A5C + 1)
#define PREFIX_VEX_3A5E	(PREFIX_VEX_3A5D + 1)
#define PREFIX_VEX_3A5F	(PREFIX_VEX_3A5E + 1)
#define PREFIX_VEX_3A60	(PREFIX_VEX_3A5F + 1)
#define PREFIX_VEX_3A61	(PREFIX_VEX_3A60 + 1)
#define PREFIX_VEX_3A62	(PREFIX_VEX_3A61 + 1)
#define PREFIX_VEX_3A63	(PREFIX_VEX_3A62 + 1)
#define PREFIX_VEX_3A68	(PREFIX_VEX_3A63 + 1)
#define PREFIX_VEX_3A69	(PREFIX_VEX_3A68 + 1)
#define PREFIX_VEX_3A6A	(PREFIX_VEX_3A69 + 1)
#define PREFIX_VEX_3A6B	(PREFIX_VEX_3A6A + 1)
#define PREFIX_VEX_3A6C	(PREFIX_VEX_3A6B + 1)
#define PREFIX_VEX_3A6D	(PREFIX_VEX_3A6C + 1)
#define PREFIX_VEX_3A6E	(PREFIX_VEX_3A6D + 1)
#define PREFIX_VEX_3A6F	(PREFIX_VEX_3A6E + 1)
#define PREFIX_VEX_3A78	(PREFIX_VEX_3A6F + 1)
#define PREFIX_VEX_3A79	(PREFIX_VEX_3A78 + 1)
#define PREFIX_VEX_3A7A	(PREFIX_VEX_3A79 + 1)
#define PREFIX_VEX_3A7B	(PREFIX_VEX_3A7A + 1)
#define PREFIX_VEX_3A7C	(PREFIX_VEX_3A7B + 1)
#define PREFIX_VEX_3A7D	(PREFIX_VEX_3A7C + 1)
#define PREFIX_VEX_3A7E	(PREFIX_VEX_3A7D + 1)
#define PREFIX_VEX_3A7F	(PREFIX_VEX_3A7E + 1)
@


1.175
log
@gas/
2008-02-13  Jan Beulich  <jbeulich@@novell.com>

	* config/tc-i386.c (intel_e09): Also special-case 'bound'.

gas/testsuite/
2008-02-13  Jan Beulich  <jbeulich@@novell.com>

	* gas/i386/intelbad.s, gas/i386/intelok.s: Add 'bound' tests.
	* gas/i386/intelbad.l, gas/i386/intelok.l, gas/i386/intelok.e,
	gas/i386/opcode-intel.d: Adjust.

opcodes/
2008-02-13  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (a_mode): New.
	(cond_jump_mode): Adjust.
	(Ma): Change to a_mode.
	(intel_operand_size): Handle a_mode.
	* i386-opc.tbl: Allow Dword and Qword for bound.
	* i386-tbl.h: Re-generate.
@
text
@d56 2
d94 11
d148 5
d258 1
d351 1
d359 3
d370 17
d417 2
d420 5
a424 1
#define x_mode			(t_mode + 1)
d426 1
a426 1
#define m_mode			(x_mode + 1)
d448 6
d455 1
a455 1
#define es_reg			(dqd_mode + 1)
d520 3
d533 3
d565 4
d625 29
d743 6
a748 1
#define PREFIX_0F38F0		(PREFIX_0F3841 + 1)
d767 2
a768 1
#define PREFIX_0F3A60		(PREFIX_0F3A42 + 1)
d772 212
d1021 202
d1271 2
d1930 11
d2322 44
d3001 40
d3193 8
a3231 1
};
d3233 73
a3305 2
static const struct dis386 x86_64_table[][2] = {
  /* X86_64_06 */
d3307 4
a3310 2
    { "push{T|}", { es } },
    { "(bad)", { XX } },
d3313 1
a3313 1
  /* X86_64_07 */
d3315 4
a3318 2
    { "pop{T|}", { es } },
    { "(bad)", { XX } },
d3321 1
a3321 1
  /* X86_64_0D */
d3323 4
a3326 2
    { "push{T|}", { cs } },
    { "(bad)", { XX } },
d3329 1
a3329 1
  /* X86_64_16 */
d3331 4
a3334 2
    { "push{T|}", { ss } },
    { "(bad)", { XX } },
d3337 1
a3337 1
  /* X86_64_17 */
d3339 4
a3342 2
    { "pop{T|}", { ss } },
    { "(bad)", { XX } },
d3345 1
a3345 1
  /* X86_64_1E */
d3347 4
a3350 2
    { "push{T|}", { ds } },
    { "(bad)", { XX } },
d3353 1
a3353 1
  /* X86_64_1F */
d3355 4
a3358 2
    { "pop{T|}", { ds } },
    { "(bad)", { XX } },
d3361 1
a3361 1
  /* X86_64_27 */
d3363 4
a3366 2
    { "daa", { XX } },
    { "(bad)", { XX } },
d3369 1
a3369 1
  /* X86_64_2F */
d3371 4
a3374 2
    { "das", { XX } },
    { "(bad)", { XX } },
d3377 1
a3377 1
  /* X86_64_37 */
d3379 4
a3382 2
    { "aaa", { XX } },
    { "(bad)", { XX } },
d3385 1
a3385 1
  /* X86_64_3F */
d3387 4
a3390 2
    { "aas", { XX } },
    { "(bad)", { XX } },
d3393 1
a3393 1
  /* X86_64_60 */
d3395 4
a3398 2
    { "pusha{P|}", { XX } },
    { "(bad)", { XX } },
d3401 1
a3401 1
  /* X86_64_61 */
d3403 4
a3406 2
    { "popa{P|}", { XX } },
    { "(bad)", { XX } },
d3409 1
a3409 1
  /* X86_64_62 */
d3411 4
a3414 2
    { MOD_TABLE (MOD_62_32BIT) },
    { "(bad)", { XX } },
d3417 1
a3417 1
  /* X86_64_63 */
d3419 4
a3422 2
    { "arpl", { Ew, Gw } },
    { "movs{lq|xd}", { Gv, Ed } },
d3425 1
a3425 1
  /* X86_64_6D */
d3427 4
a3430 2
    { "ins{R|}", { Yzr, indirDX } },
    { "ins{G|}", { Yzr, indirDX } },
d3433 1
a3433 1
  /* X86_64_6F */
d3435 4
a3438 2
    { "outs{R|}", { indirDXr, Xz } },
    { "outs{G|}", { indirDXr, Xz } },
d3441 1
a3441 1
  /* X86_64_9A */
d3443 4
a3446 2
    { "Jcall{T|}", { Ap } },
    { "(bad)", { XX } },
d3449 1
a3449 1
  /* X86_64_C4 */
d3451 4
a3454 2
    { MOD_TABLE (MOD_C4_32BIT) },
    { "(bad)", { XX } },
d3457 1
a3457 1
  /* X86_64_C5 */
d3459 4
a3462 2
    { MOD_TABLE (MOD_C5_32BIT) },
    { "(bad)", { XX } },
d3465 1
a3465 1
  /* X86_64_CE */
d3467 4
a3470 2
    { "into", { XX } },
    { "(bad)", { XX } },
d3473 1
a3473 1
  /* X86_64_D4 */
d3475 4
a3478 2
    { "aam", { sIb } },
    { "(bad)", { XX } },
d3481 1
a3481 1
  /* X86_64_D5 */
d3483 4
a3486 2
    { "aad", { sIb } },
    { "(bad)", { XX } },
d3489 1
a3489 1
  /* X86_64_EA */
d3491 4
a3494 2
    { "Jjmp{T|}", { Ap } },
    { "(bad)", { XX } },
d3497 1
a3497 1
  /* X86_64_0F01_REG_0 */
d3499 4
a3502 2
    { "sgdt{Q|IQ}", { M } },
    { "sgdt", { M } },
d3505 1
a3505 1
  /* X86_64_0F01_REG_1 */
d3507 4
a3510 2
    { "sidt{Q|IQ}", { M } },
    { "sidt", { M } },
d3513 1
a3513 1
  /* X86_64_0F01_REG_2 */
d3515 4
a3518 2
    { "lgdt{Q|Q}", { M } },
    { "lgdt", { M } },
d3521 1
a3521 1
  /* X86_64_0F01_REG_3 */
d3523 4
a3526 2
    { "lidt{Q|Q}", { M } },
    { "lidt", { M } },
a3527 1
};
d3529 2446
a5974 2
static const struct dis386 three_byte_table[][256] = {
  /* THREE_BYTE_0F24 */
d5977 8
a5984 8
    { "fmaddps",	{ { OP_DREX4, q_mode } } },
    { "fmaddpd",	{ { OP_DREX4, q_mode } } },
    { "fmaddss",	{ { OP_DREX4, w_mode } } },
    { "fmaddsd",	{ { OP_DREX4, d_mode } } },
    { "fmaddps",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fmaddpd",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fmaddss",	{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "fmaddsd",	{ { OP_DREX4, DREX_OC1 + d_mode } } },
d5986 17
a6002 17
    { "fmsubps",	{ { OP_DREX4, q_mode } } },
    { "fmsubpd",	{ { OP_DREX4, q_mode } } },
    { "fmsubss",	{ { OP_DREX4, w_mode } } },
    { "fmsubsd",	{ { OP_DREX4, d_mode } } },
    { "fmsubps",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fmsubpd",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fmsubss",	{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "fmsubsd",	{ { OP_DREX4, DREX_OC1 + d_mode } } },
    /* 10 */
    { "fnmaddps",	{ { OP_DREX4, q_mode } } },
    { "fnmaddpd",	{ { OP_DREX4, q_mode } } },
    { "fnmaddss",	{ { OP_DREX4, w_mode } } },
    { "fnmaddsd",	{ { OP_DREX4, d_mode } } },
    { "fnmaddps",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fnmaddpd",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fnmaddss",	{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "fnmaddsd",	{ { OP_DREX4, DREX_OC1 + d_mode } } },
d6004 8
a6011 8
    { "fnmsubps",	{ { OP_DREX4, q_mode } } },
    { "fnmsubpd",	{ { OP_DREX4, q_mode } } },
    { "fnmsubss",	{ { OP_DREX4, w_mode } } },
    { "fnmsubsd",	{ { OP_DREX4, d_mode } } },
    { "fnmsubps",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fnmsubpd",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fnmsubss",	{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "fnmsubsd",	{ { OP_DREX4, DREX_OC1 + d_mode } } },
d6013 8
a6020 8
    { "permps",		{ { OP_DREX4, q_mode } } },
    { "permpd",		{ { OP_DREX4, q_mode } } },
    { "pcmov",		{ { OP_DREX4, q_mode } } },
    { "pperm",		{ { OP_DREX4, q_mode } } },
    { "permps",		{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "permpd",		{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "pcmov",		{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "pperm",		{ { OP_DREX4, DREX_OC1 + d_mode } } },
d6049 8
a6056 8
    { "protb",		{ { OP_DREX3, q_mode } } },
    { "protw",		{ { OP_DREX3, q_mode } } },
    { "protd",		{ { OP_DREX3, q_mode } } },
    { "protq",		{ { OP_DREX3, q_mode } } },
    { "pshlb",		{ { OP_DREX3, q_mode } } },
    { "pshlw",		{ { OP_DREX3, q_mode } } },
    { "pshld",		{ { OP_DREX3, q_mode } } },
    { "pshlq",		{ { OP_DREX3, q_mode } } },
a6057 4
    { "pshab",		{ { OP_DREX3, q_mode } } },
    { "pshaw",		{ { OP_DREX3, q_mode } } },
    { "pshad",		{ { OP_DREX3, q_mode } } },
    { "pshaq",		{ { OP_DREX3, q_mode } } },
a6061 1
    /* 50 */
d6066 1
a6070 1
    /* 58 */
d6075 1
a6079 1
    /* 60 */
d6084 5
d6126 3
a6128 3
    { "pmacssww",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacsswd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacssdql",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
d6136 2
a6137 2
    { "pmacssdd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacssdqh",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
d6144 3
a6146 3
    { "pmacsww",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacswd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacsdql",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
d6154 2
a6155 2
    { "pmacsdd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacsdqh",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
d6163 1
a6163 1
    { "pmadcsswd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
d6181 1
a6181 1
    { "pmadcswd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
d6227 1
a6227 1
    { "(bad)",		{ XX } },
d6265 1
a6265 1
  /* THREE_BYTE_0F25 */
d6286 4
d6294 1
a6298 2
    /* 18 */
    { "(bad)",		{ XX } },
d6303 2
a6307 1
    /* 20 */
d6312 1
a6316 1
    /* 28 */
a6320 4
    { "comps",		{ { OP_DREX3, q_mode }, { OP_DREX_FCMP, b_mode } } },
    { "compd",		{ { OP_DREX3, q_mode }, { OP_DREX_FCMP, b_mode } } },
    { "comss",		{ { OP_DREX3, w_mode }, { OP_DREX_FCMP, b_mode } } },
    { "comsd",		{ { OP_DREX3, d_mode }, { OP_DREX_FCMP, b_mode } } },
d6322 2
a6323 2
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6341 3
d6346 3
d6352 1
a6352 3
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 48 */
a6356 4
    { "pcomb",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomw",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomd",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomq",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
d6359 3
d6364 2
a6365 5
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6370 1
d6375 1
d6377 3
a6379 1
    /* 60 */
d6384 1
a6388 1
    /* 68 */
a6392 4
    { "pcomub",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomuw",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomud",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomuq",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
d6556 1
a6556 1
  /* THREE_BYTE_0F38 */
d6559 8
a6566 8
    { "pshufb",		{ MX, EM } },
    { "phaddw",		{ MX, EM } },
    { "phaddd",		{ MX, EM } },
    { "phaddsw",	{ MX, EM } },
    { "pmaddubsw",	{ MX, EM } },
    { "phsubw",		{ MX, EM } },
    { "phsubd",		{ MX, EM } },
    { "phsubsw",	{ MX, EM } },
d6568 4
a6571 4
    { "psignb",		{ MX, EM } },
    { "psignw",		{ MX, EM } },
    { "psignd",		{ MX, EM } },
    { "pmulhrsw",	{ MX, EM } },
a6576 1
    { PREFIX_TABLE (PREFIX_0F3810) },
a6579 2
    { PREFIX_TABLE (PREFIX_0F3814) },
    { PREFIX_TABLE (PREFIX_0F3815) },
d6581 4
a6584 1
    { PREFIX_TABLE (PREFIX_0F3817) },
d6590 3
a6592 3
    { "pabsb",		{ MX, EM } },
    { "pabsw",		{ MX, EM } },
    { "pabsd",		{ MX, EM } },
d6595 6
a6600 6
    { PREFIX_TABLE (PREFIX_0F3820) },
    { PREFIX_TABLE (PREFIX_0F3821) },
    { PREFIX_TABLE (PREFIX_0F3822) },
    { PREFIX_TABLE (PREFIX_0F3823) },
    { PREFIX_TABLE (PREFIX_0F3824) },
    { PREFIX_TABLE (PREFIX_0F3825) },
d6604 4
a6607 4
    { PREFIX_TABLE (PREFIX_0F3828) },
    { PREFIX_TABLE (PREFIX_0F3829) },
    { PREFIX_TABLE (PREFIX_0F382A) },
    { PREFIX_TABLE (PREFIX_0F382B) },
a6612 6
    { PREFIX_TABLE (PREFIX_0F3830) },
    { PREFIX_TABLE (PREFIX_0F3831) },
    { PREFIX_TABLE (PREFIX_0F3832) },
    { PREFIX_TABLE (PREFIX_0F3833) },
    { PREFIX_TABLE (PREFIX_0F3834) },
    { PREFIX_TABLE (PREFIX_0F3835) },
d6614 7
a6620 1
    { PREFIX_TABLE (PREFIX_0F3837) },
d6622 8
a6629 8
    { PREFIX_TABLE (PREFIX_0F3838) },
    { PREFIX_TABLE (PREFIX_0F3839) },
    { PREFIX_TABLE (PREFIX_0F383A) },
    { PREFIX_TABLE (PREFIX_0F383B) },
    { PREFIX_TABLE (PREFIX_0F383C) },
    { PREFIX_TABLE (PREFIX_0F383D) },
    { PREFIX_TABLE (PREFIX_0F383E) },
    { PREFIX_TABLE (PREFIX_0F383F) },
d6631 8
a6638 8
    { PREFIX_TABLE (PREFIX_0F3840) },
    { PREFIX_TABLE (PREFIX_0F3841) },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6640 4
a6643 4
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d6829 2
a6830 2
    { PREFIX_TABLE (PREFIX_0F38F0) },
    { PREFIX_TABLE (PREFIX_0F38F1) },
d6847 4
a6850 1
  /* THREE_BYTE_0F3A */
a6861 10
    { PREFIX_TABLE (PREFIX_0F3A08) },
    { PREFIX_TABLE (PREFIX_0F3A09) },
    { PREFIX_TABLE (PREFIX_0F3A0A) },
    { PREFIX_TABLE (PREFIX_0F3A0B) },
    { PREFIX_TABLE (PREFIX_0F3A0C) },
    { PREFIX_TABLE (PREFIX_0F3A0D) },
    { PREFIX_TABLE (PREFIX_0F3A0E) },
    { "palignr",	{ MX, EM, Ib } },
    /* 10 */
    { "(bad)",		{ XX } },
a6864 5
    { PREFIX_TABLE (PREFIX_0F3A14) },
    { PREFIX_TABLE (PREFIX_0F3A15) },
    { PREFIX_TABLE (PREFIX_0F3A16) },
    { PREFIX_TABLE (PREFIX_0F3A17) },
    /* 18 */
d6870 10
a6882 4
    /* 20 */
    { PREFIX_TABLE (PREFIX_0F3A20) },
    { PREFIX_TABLE (PREFIX_0F3A21) },
    { PREFIX_TABLE (PREFIX_0F3A22) },
d6888 1
a6888 1
    /* 28 */
d6897 9
d6925 3
a6927 3
    { PREFIX_TABLE (PREFIX_0F3A40) },
    { PREFIX_TABLE (PREFIX_0F3A41) },
    { PREFIX_TABLE (PREFIX_0F3A42) },
d6943 82
d7032 5
a7037 1
    /* 58 */
d7041 1
a7046 5
    /* 60 */
    { PREFIX_TABLE (PREFIX_0F3A60) },
    { PREFIX_TABLE (PREFIX_0F3A61) },
    { PREFIX_TABLE (PREFIX_0F3A62) },
    { PREFIX_TABLE (PREFIX_0F3A63) },
d7048 1
d7050 1
a7052 1
    /* 68 */
d7059 1
a7061 1
    /* 70 */
d7068 1
d7071 1
a7071 1
    /* 78 */
d7073 3
d7077 1
a7083 1
    /* 80 */
d7086 53
d7140 22
a7166 1
    /* 88 */
d7169 9
d7179 7
d7188 16
d7205 13
a7219 1
    /* 90 */
d7224 1
a7228 1
    /* 98 */
d7233 1
a7237 1
    /* a0 */
d7242 1
a7246 1
    /* a8 */
d7251 1
a7255 1
    /* b0 */
d7260 1
a7264 1
    /* b8 */
d7269 1
a7273 1
    /* c0 */
d7278 1
a7282 1
    /* c8 */
d7287 1
a7291 1
    /* d0 */
d7296 1
a7300 1
    /* d8 */
d7305 1
a7309 1
    /* e0 */
d7314 1
a7318 1
    /* e8 */
d7323 1
a7327 1
    /* f0 */
d7332 1
a7336 1
    /* f8 */
d7341 1
a7345 4
  },
  /* THREE_BYTE_0F7A */
  {
    /* 00 */
d7350 1
a7354 1
    /* 08 */
d7359 1
a7363 5
    /* 10 */
    { "frczps",		{ XM, EXq } },
    { "frczpd",		{ XM, EXq } },
    { "frczss",		{ XM, EXq } },
    { "frczsd",		{ XM, EXq } },
d7368 1
a7368 1
    /* 18 */
d7377 1
a7377 2
    /* 20 */
    { "ptest",		{ XX } },
a7384 1
    /* 28 */
d7386 1
a7393 3
    /* 30 */
    { "cvtph2ps",	{ XM, EXd } },
    { "cvtps2ph",	{ EXd, XM } },
d7395 1
a7400 1
    /* 38 */
d7404 1
a7409 1
    /* 40 */
a7410 3
    { "phaddbw",	{ XM, EXq } },
    { "phaddbd",	{ XM, EXq } },
    { "phaddbq",	{ XM, EXq } },
d7413 1
a7413 3
    { "phaddwd",	{ XM, EXq } },
    { "phaddwq",	{ XM, EXq } },
    /* 48 */
a7416 1
    { "phadddq",	{ XM, EXq } },
a7420 1
    /* 50 */
d7422 1
a7422 3
    { "phaddubw",	{ XM, EXq } },
    { "phaddubd",	{ XM, EXq } },
    { "phaddubq",	{ XM, EXq } },
a7424 3
    { "phadduwd",	{ XM, EXq } },
    { "phadduwq",	{ XM, EXq } },
    /* 58 */
a7427 1
    { "phaddudq",	{ XM, EXq } },
d7431 4
a7435 1
    /* 60 */
a7436 3
    { "phsubbw",	{ XM, EXq } },
    { "phsubbd",	{ XM, EXq } },
    { "phsubbq",	{ XM, EXq } },
d7439 3
d7443 10
a7453 1
    /* 68 */
d7457 7
a7468 1
    /* 70 */
d7470 4
d7479 1
a7481 1
    /* 78 */
d7488 1
a7490 1
    /* 80 */
d7497 1
a7499 1
    /* 88 */
d7506 4
a7511 1
    /* 90 */
d7515 6
d7524 1
a7526 1
    /* 98 */
d7533 1
a7535 1
    /* a0 */
d7538 9
d7551 10
a7562 1
    /* a8 */
d7569 10
a7580 1
    /* b0 */
d7587 1
a7589 1
    /* b8 */
d7596 1
a7598 1
    /* c0 */
d7605 1
a7607 1
    /* c8 */
d7614 1
a7616 1
    /* d0 */
d7623 1
a7625 1
    /* d8 */
d7632 1
a7634 1
    /* e0 */
d7641 1
a7643 1
    /* e8 */
d7650 1
a7652 1
    /* f0 */
d7659 1
a7661 1
    /* f8 */
d7668 1
a7670 4
  },
  /* THREE_BYTE_0F7B */
  {
    /* 00 */
d7677 1
a7679 1
    /* 08 */
d7686 1
a7688 1
    /* 10 */
d7695 1
a7697 1
    /* 18 */
d7704 1
a7706 1
    /* 20 */
d7713 1
a7715 1
    /* 28 */
d7722 7
d7730 5
d7736 5
a7740 1
    /* 30 */
d7742 5
d7748 5
d7754 5
d7760 5
d7766 5
d7772 5
d7778 5
d7784 5
a7788 1
    /* 38 */
d7790 5
d7796 5
d7802 5
d7808 5
d7814 5
d7820 5
d7826 5
d7832 5
a7836 14
    /* 40 */
    { "protb",		{ XM, EXq, Ib } },
    { "protw",		{ XM, EXq, Ib } },
    { "protd",		{ XM, EXq, Ib } },
    { "protq",		{ XM, EXq, Ib } },
    { "pshlb",		{ XM, EXq, Ib } },
    { "pshlw",		{ XM, EXq, Ib } },
    { "pshld",		{ XM, EXq, Ib } },
    { "pshlq",		{ XM, EXq, Ib } },
    /* 48 */
    { "pshab",		{ XM, EXq, Ib } },
    { "pshaw",		{ XM, EXq, Ib } },
    { "pshad",		{ XM, EXq, Ib } },
    { "pshaq",		{ XM, EXq, Ib } },
d7838 5
d7844 5
d7850 5
d7856 5
a7860 1
    /* 50 */
d7862 5
d7868 5
d7874 5
d7880 5
d7886 5
d7892 5
d7898 5
d7904 5
a7908 1
    /* 58 */
d7910 5
d7916 5
d7922 5
d7928 5
d7934 5
d7940 5
d7946 5
d7952 5
a7956 1
    /* 60 */
d7958 5
d7964 5
d7970 5
d7976 5
d7982 5
d7988 5
d7994 5
d8000 5
a8004 1
    /* 68 */
d8006 5
d8012 5
d8018 5
d8024 5
d8030 5
d8036 5
d8042 5
d8048 5
a8052 1
    /* 70 */
d8054 5
d8060 5
d8066 5
d8072 5
d8078 5
d8084 5
d8090 5
d8096 5
a8100 1
    /* 78 */
d8102 5
d8108 5
d8114 5
d8120 5
d8126 5
d8132 5
d8138 5
d8144 5
a8148 1
    /* 80 */
d8150 5
d8156 5
d8162 5
d8168 5
d8174 5
d8180 5
d8186 5
d8192 5
a8196 1
    /* 88 */
d8198 5
d8204 5
d8210 5
d8216 5
d8222 5
d8228 5
d8234 5
d8240 5
a8244 1
    /* 90 */
d8246 5
d8252 5
d8258 5
d8264 5
d8270 5
d8276 5
d8282 5
d8288 5
a8292 1
    /* 98 */
d8294 5
d8300 5
d8306 5
d8312 5
d8318 5
d8324 5
d8330 5
d8336 5
a8340 1
    /* a0 */
d8342 5
d8348 5
d8354 5
d8360 5
d8366 5
d8372 5
d8378 5
d8384 5
a8388 1
    /* a8 */
d8390 5
d8396 5
d8402 5
d8408 5
d8414 5
d8420 5
d8426 5
d8432 5
a8436 1
    /* b0 */
d8438 5
d8444 5
d8450 5
d8456 5
d8462 5
d8468 5
d8474 5
d8480 5
a8484 1
    /* b8 */
d8486 5
d8492 5
d8498 5
d8504 5
d8510 5
d8516 5
d8522 5
d8528 5
a8532 1
    /* c0 */
d8534 5
d8540 4
d8545 5
d8551 6
d8558 5
d8564 5
d8570 5
d8576 5
a8580 1
    /* c8 */
d8582 5
d8588 5
d8594 5
d8600 5
d8606 5
d8612 5
d8618 5
d8624 5
a8628 1
    /* d0 */
d8630 5
d8636 5
d8642 5
d8648 5
d8654 5
d8660 5
d8666 5
d8672 5
a8676 1
    /* d8 */
d8678 5
d8684 5
d8690 5
d8696 5
d8702 5
d8708 5
d8714 5
d8720 5
a8724 1
    /* e0 */
d8726 5
d8732 4
d8737 6
d8744 5
d8750 5
d8756 5
d8762 5
d8768 5
a8772 1
    /* e8 */
d8774 5
d8780 5
d8786 4
d8791 5
d8797 6
d8804 5
d8810 5
d8816 5
a8820 1
    /* f0 */
d8822 5
d8828 5
d8834 5
d8840 5
d8846 5
d8852 5
d8858 5
d8864 5
a8868 1
    /* f8 */
d8870 5
d8876 5
d8882 5
d8888 5
d8894 5
d8900 5
d8906 1
a8906 2
    { "(bad)",		{ XX } },
  }
d9071 146
a9216 1
    /* MOD_0F73_REG_3 */
d9218 1
a9218 1
    { PREFIX_TABLE (PREFIX_0F73_REG_3) },
d9221 1
a9221 1
    /* MOD_0F73_REG_6 */
d9223 1
a9223 1
    { "psllq",		{ MS, Ib } },
d9226 1
a9226 1
    /* MOD_0F73_REG_7 */
d9228 1
a9228 1
    { PREFIX_TABLE (PREFIX_0F73_REG_7) },
d9231 1
a9231 2
    /* MOD_0FAE_REG_0 */
    { "fxsave",		{ M } },
d9233 1
d9236 1
a9236 2
    /* MOD_0FAE_REG_1 */
    { "fxrstor",	{ M } },
d9238 1
d9241 1
a9241 2
    /* MOD_0FAE_REG_2 */
    { "ldmxcsr",	{ Md } },
d9243 1
d9246 1
a9246 2
    /* MOD_0FAE_REG_3 */
    { "stmxcsr",	{ Md } },
d9248 1
d9251 1
a9251 2
    /* MOD_0FAE_REG_4 */
    { "xsave",		{ M } },
d9253 1
d9256 3
a9258 3
    /* MOD_0FAE_REG_5 */
    { "xrstor",		{ M } },
    { RM_TABLE (RM_0FAE_REG_5) },
d9261 1
a9261 1
    /* MOD_0FAE_REG_6 */
d9263 1
a9263 1
    { RM_TABLE (RM_0FAE_REG_6) },
d9266 3
a9268 3
    /* MOD_0FAE_REG_7 */
    { "clflush",	{ Mb } },
    { RM_TABLE (RM_0FAE_REG_7) },
d9271 2
a9272 2
    /* MOD_0FB2 */
    { "lssS",		{ Gv, Mp } },
d9276 1
a9276 2
    /* MOD_0FB4 */
    { "lfsS",		{ Gv, Mp } },
d9278 1
d9281 2
a9282 2
    /* MOD_0FB5 */
    { "lgsS",		{ Gv, Mp } },
d9286 2
a9287 2
    /* MOD_0FC7_REG_6 */
    { PREFIX_TABLE (PREFIX_0FC7_REG_6) },
d9291 2
a9292 2
    /* MOD_0FC7_REG_7 */
    { "vmptrst",	{ Mq } },
d9296 2
a9297 1
    /* MOD_0FD7 */
a9298 1
    { "pmovmskb",	{ Gdq, MS } },
d9301 2
a9302 2
    /* MOD_0FE7_PREFIX_2 */
    { "movntdq",	{ Mx, XM } },
d9306 2
a9307 2
    /* MOD_0FF0_PREFIX_3 */
    { "lddqu",		{ XM, M } },
d9311 2
a9312 2
    /* MOD_0F382A_PREFIX_2 */
    { "movntdqa",	{ XM, Mx } },
d9316 2
a9317 2
    /* MOD_62_32BIT */
    { "bound{S|}",	{ Gv, Ma } },
d9321 2
a9322 2
    /* MOD_C4_32BIT */
    { "lesS",		{ Gv, Mp } },
d9326 2
a9327 2
    /* MOD_C5_32BIT */
    { "ldsS",		{ Gv, Mp } },
d9430 2
d9518 1
d9680 1
a9680 1
  int index;
d9701 1
a9701 3
      index = 0;
      used_prefixes |= (prefixes & PREFIX_REPZ);
      if (prefixes & PREFIX_REPZ)
d9703 19
a9721 2
	  index = 1;
	  repz_prefix = NULL;
d9723 1
a9723 1
      else
d9725 3
a9727 4
	  /* We should check PREFIX_REPNZ and PREFIX_REPZ before
	     PREFIX_DATA.  */
	  used_prefixes |= (prefixes & PREFIX_REPNZ);
	  if (prefixes & PREFIX_REPNZ)
d9729 2
a9730 2
	      index = 3;
	      repnz_prefix = NULL;
d9734 9
a9742 2
	      used_prefixes |= (prefixes & PREFIX_DATA);
	      if (prefixes & PREFIX_DATA)
d9744 6
a9749 2
		  index = 2;
		  data_prefix = NULL;
d9770 122
d10185 3
d10215 1
a10215 1
  if (rex & ~rex_used)
d10218 1
a10218 1
      name = prefix_name (rex | 0x40, priv.orig_sizeflag);
d10989 13
a11001 1
	  if (prefixes & PREFIX_DATA)
d11008 12
a11019 3
	  if (intel_syntax || !(sizeflag & SUFFIX_ALWAYS))
	    break;
	  if (rex & REX_W)
d11021 21
a11041 2
	      USED_REX (REX_W);
	      *obufp++ = 'q';
d11290 18
d11310 32
d11351 1
a11351 1
OP_E_extended (int bytemode, int sizeflag, int has_drex)
d11353 3
a11355 3
  bfd_vma disp;
  int add = 0;
  int riprel = 0;
d11357 2
a11358 2
  if (rex & REX_B)
    add += 8;
d11360 1
a11360 5
  /* Skip mod/rm byte.  */
  MODRM_CHECK;
  codep++;

  if (modrm.mod == 3)
d11362 21
a11382 1
      switch (bytemode)
d11384 1
a11384 43
	case b_mode:
	  USED_REX (0);
	  if (rex)
	    oappend (names8rex[modrm.rm + add]);
	  else
	    oappend (names8[modrm.rm + add]);
	  break;
	case w_mode:
	  oappend (names16[modrm.rm + add]);
	  break;
	case d_mode:
	  oappend (names32[modrm.rm + add]);
	  break;
	case q_mode:
	  oappend (names64[modrm.rm + add]);
	  break;
	case m_mode:
	  if (address_mode == mode_64bit)
	    oappend (names64[modrm.rm + add]);
	  else
	    oappend (names32[modrm.rm + add]);
	  break;
	case stack_v_mode:
	  if (address_mode == mode_64bit && (sizeflag & DFLAG))
	    {
	      oappend (names64[modrm.rm + add]);
	      used_prefixes |= (prefixes & PREFIX_DATA);
	      break;
	    }
	  bytemode = v_mode;
	  /* FALLTHRU */
	case v_mode:
	case dq_mode:
	case dqb_mode:
	case dqd_mode:
	case dqw_mode:
	  USED_REX (REX_W);
	  if (rex & REX_W)
	    oappend (names64[modrm.rm + add]);
	  else if ((sizeflag & DFLAG) || bytemode != v_mode)
	    oappend (names32[modrm.rm + add]);
	  else
	    oappend (names16[modrm.rm + add]);
d11387 21
a11407 6
	case 0:
	  break;
	default:
	  oappend (INTERNAL_DISASSEMBLER_ERROR);
	  break;
	}
d11410 9
d11420 1
a11420 1
  disp = 0;
d11674 13
d12378 1
a12378 1
OP_XMM (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d12386 16
a12401 1
  sprintf (scratchbuf, "%%xmm%d", modrm.reg + add);
d12492 18
a12509 1
  sprintf (scratchbuf, "%%xmm%d", modrm.rm + add);
d12685 1
a12685 1
  if (cmp_type < 8)
d12806 16
a12821 1
  sprintf (scratchbuf, "%%xmm%d", reg);
d13231 390
@


1.174
log
@gas/testsuite/

2002-02-11  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run xsave, xsave-intel, x86-64-xsave
	and x86-64-xsave-intel.

	* gas/i386/x86-64-xsave-intel.d: New file.
	* gas/i386/x86-64-xsave.d: Likewise.
	* gas/i386/x86-64-xsave.s: Likewise.
	* gas/i386/xsave-intel.d: Likewise.
	* gas/i386/xsave.d: Likewise.
	* gas/i386/xsave.s: Likewise.

opcodes/

2008-02-11  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-gen.c (cpu_flags): Add CpuXsave.

	* i386-opc.h (CpuXsave): New.
	(Cpu64): Updated.
	(i386_cpu_flags): Add cpuxsave.

	* i386-dis.c (MOD_0FAE_REG_4): New.
	(RM_0F01_REG_2): Likewise.
	(MOD_0FAE_REG_5): Updated.
	(RM_0F01_REG_3): Likewise.
	(reg_table): Use MOD_0FAE_REG_4.
	(mod_table): Use RM_0F01_REG_2.  Add MOD_0FAE_REG_4.  Updated
	for xrstor.
	(rm_table): Add RM_0F01_REG_2.

	* i386-opc.tbl: Add xsave, xrstor, xgetbv and xsetbv.
	* i386-init.h: Regenerated.
	* i386-tbl.h: Likewise.
@
text
@d234 1
a234 1
#define Ma { OP_M, v_mode }
d381 3
a383 1
#define cond_jump_mode		(m_mode + 1)
d6549 7
@


1.173
log
@gas/testsuite/

2008-01-24  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/x86-64-sib.s: Add tests for r12.

	* gas/i386/x86-64-sib-intel.d: Updated.
	* gas/i386/x86-64-sib.d: Likewise.

opcodes/

2008-01-24  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_E_extended): Handle r12 like rsp.
@
text
@d545 2
a546 1
#define MOD_0FAE_REG_5		(MOD_0FAE_REG_3 + 1)
d564 2
a565 1
#define RM_0F01_REG_3		(RM_0F01_REG_1 + 1)
d1769 1
a1769 1
    { "(bad)",	{ XX } },
d4554 1
a4554 1
    { "(bad)",		{ XX } },
d4732 5
d4738 1
a4738 1
    { "(bad)",		{ XX } },
d4837 11
@


1.172
log
@2008-01-15  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (Mx): New.
	(PREFIX_0FC3): Likewise.
	(PREFIX_0FC7_REG_6): Updated.
	(dis386_twobyte): Use PREFIX_0FC3.
	(prefix_table): Add PREFIX_0FC3.  Use Mq on movntq and movntsd.
	Use Mx on movntps, movntpd, movntdq and movntdqa.  Use Md on
	movntss.
@
text
@d6648 1
a6648 1
      int base;
d6670 1
a6670 1
      base += add;
d6683 1
a6683 1
	  if ((base & 7) == 5)
d6713 1
a6713 1
	if (modrm.mod != 0 || (base & 7) == 5)
d6741 1
a6741 1
		     ? names64[base] : names32[base]);
d6772 1
a6772 1
	      && (disp || modrm.mod != 0 || (base & 7) == 5))
d6798 1
a6798 1
	  if (modrm.mod != 0 || (base & 7) == 5)
@


1.171
log
@gas/testsuite/

2008-01-10  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/nops.s: Add more tests with opcodes from 0x0f19
	to 0x0f1f.
	* gas/i386/x86-64-nops.s: Likewise.

	* gas/i386/nops.d: Updated.
	* gas/i386/x86-64-nops.d: Likewise.

opcodes/

2008-01-10  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (REG_0F0E): Renamed to REG_0F0D.
	(REG_0F18): Updated.
	(reg_table): Updated.
	(dis386_twobyte): Updated.  Use "nopQ" on 0x19 to 0x1e.
	(twobyte_has_modrm): Set 1 for 0x19 to 0x1e.
@
text
@d239 1
d609 2
a610 1
#define PREFIX_0FC7_REG_6	(PREFIX_0FC2 + 1)
d1277 1
a1277 1
  { "movntiS",		{ Ev, Gv } },
d2117 8
d2159 1
a2159 1
    { "movntq",	{ EM, MX } },
d4636 1
a4636 1
    {"movntps",		{ Ev, XM } },
d4641 1
a4641 1
    {"movntss",		{ Ed, XM } },
d4646 1
a4646 1
    {"movntpd",		{ Ev, XM } },
d4651 1
a4651 1
    {"movntsd",		{ Eq, XM } },
d4776 1
a4776 1
    { "movntdq",	{ EM, XM } },
d4786 1
a4786 1
    { "movntdqa",	{ XM, EM } },
@


1.170
log
@gas/testsuite/

2007-12-31  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/inval.s: Add test for cvtsi2ss/cvtsi2sd.
	* gas/i386/simd.s: Likewise.
	* gas/i386/x86-64-simd.s: Likewise.

	* gas/i386/inval.l: Updated.
	* gas/i386/simd-intel.d: Likewise.
	* gas/i386/simd-suffix.d: Likewise.
	* gas/i386/simd.d: Likewise.
	* gas/i386/sse2.d: Likewise.
	* gas/i386/x86-64-opcode.d: Likewise.
	* gas/i386/x86-64-simd-intel.d: Likewise.
	* gas/i386/x86-64-simd-suffix.d: Likewise.
	* gas/i386/x86-64-simd.d: Likewise.

opcodes/

2007-12-31  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (prefix_table): Use "%LQ" on cvtpi2ps/cvtsi2sd.
	(putop): Handle '%' and "LQ".

	* i386-opc.tbl: Remove IgnoreSize from cvtpi2ps/cvtsi2sd.
	* i386-tbl.h: Regenerated.
@
text
@d494 2
a495 2
#define REG_0F0E		(REG_0F01 + 1)
#define REG_0F18		(REG_0F0E + 1)
d1070 1
a1070 1
  { REG_TABLE (REG_0F0E) },
d1084 6
a1089 6
  { "(bad)",		{ XX } },
  { "(bad)",		{ XX } },
  { "(bad)",		{ XX } },
  { "(bad)",		{ XX } },
  { "(bad)",		{ XX } },
  { "(bad)",		{ XX } },
d1372 1
a1372 1
  /* 10 */ 1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1, /* 1f */
d1682 1
a1682 1
  /* REG_0F0E */
@


1.169
log
@binutils/

2007-12-22  H.J. Lu  <hongjiu.lu@@intel.com>

	* doc/binutils.texi: Document the new intel-mnemonic and
	intel-mnemonic options for i386 disassembler.

gas/testsuite/

2007-12-22  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/compat-intel.d: New file.
	* gas/i386/compat.d: Likewise.
	* gas/i386/compat.s: Likewise.

	* gas/i386/i386.exp: Run compat.

opcodes/

2007-12-22  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (intel_mnemonic): New.
	(print_i386_disassembler_options): Display att-mnemonic and
	intel-mnemonic options.
	(print_insn): Handle att-mnemonic and intel-mnemonic.
	(float_reg): Replace SYSV386_COMPAT with "!M" and "M".
	(putop): Handle "!M" and "M".
@
text
@d721 1
a721 1
   .      size prefix
d723 1
a723 1
   .      suffix_always is true
d729 1
a729 1
   .      for some of the macro letters)
d737 3
a739 3
   .      or suffix_always is true.  print 'q' if rex prefix is present.
   'Q' => print 'w', 'l' or 'q' if no register operands or suffix_always
   .      is true
d751 5
d1838 1
a1838 1
    { "cvtsi2ssY", { XM, Ev } },
d1840 1
a1840 1
    { "cvtsi2sdY", { XM, Ev } },
d5973 8
d5989 3
d6128 1
d6130 6
d6201 1
d6203 1
a6203 4
	  if (intel_syntax && !alt)
	    break;
	  USED_REX (REX_W);
	  if (modrm.mod != 3 || (sizeflag & SUFFIX_ALWAYS))
d6205 5
a6209 3
	      if (rex & REX_W)
		*obufp++ = 'q';
	      else
d6211 2
a6212 2
		  if (sizeflag & DFLAG)
		    *obufp++ = intel_syntax ? 'd' : 'l';
d6214 23
a6236 1
		    *obufp++ = 'w';
d6238 2
a6239 1
	      used_prefixes |= (prefixes & PREFIX_DATA);
@


1.168
log
@2007-10-31  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (USE_REG_TABLE): Defined as the previous one + 1.
	(USE_REG_TABLE): Likewise.
	(USE_MOD_TABLE): Likewise.
	(USE_RM_TABLE): Likewise.
	(USE_PREFIX_TABLE): Likewise.
	(USE_X86_64_TABLE): Likewise.
	(USE_3BYTE_TABLE): Likewise.
@
text
@d733 1
d750 1
d5063 1
d5108 4
d5255 2
d5261 2
d5804 4
a5807 11
#if SYSV386_COMPAT
    { "fsub",	{ STi, ST } },
    { "fsubr",	{ STi, ST } },
    { "fdiv",	{ STi, ST } },
    { "fdivr",	{ STi, ST } },
#else
    { "fsubr",	{ STi, ST } },
    { "fsub",	{ STi, ST } },
    { "fdivr",	{ STi, ST } },
    { "fdiv",	{ STi, ST } },
#endif
d5826 4
a5829 11
#if SYSV386_COMPAT
    { "fsubp",	{ STi, ST } },
    { "fsubrp",	{ STi, ST } },
    { "fdivp",	{ STi, ST } },
    { "fdivrp",	{ STi, ST } },
#else
    { "fsubrp",	{ STi, ST } },
    { "fsubp",	{ STi, ST } },
    { "fdivrp",	{ STi, ST } },
    { "fdivp",	{ STi, ST } },
#endif
d5967 1
d5976 3
d6118 4
@


1.167
log
@2007-10-26  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (MOD_0F2B_PREFIX_0...MOD_0F2B_PREFIX_3): New.
	(MOD_0F51): Likewise.
	(MOD_0FD7): Likewise.
	(MOD_0FE7_PREFIX_2): Likewise.
	(MOD_0F382A_PREFIX_2): Likewise.
	(MOD_0F71_REG_2): Updated.
	(MOD_0FF0_PREFIX_3): Likewise.
	(MOD_62_32BIT): Likewise.
	(dis386_twobyte): Use MOD_0F51 and  MOD_0FD7.
	(prefix_table): Use MOD_0F2B_PREFIX_0...MOD_0F2B_PREFIX_3,
	MOD_0FE7_PREFIX_2 and MOD_0F382A_PREFIX_2.
	(mod_table): Add MOD_0F2B_PREFIX_0...MOD_0F2B_PREFIX_3,
	MOD_0F51, MOD_0FD7 and MOD_0F382A_PREFIX_2.
@
text
@d458 7
a464 7
#define FLOATCODE 1
#define USE_REG_TABLE 2
#define USE_MOD_TABLE 3
#define USE_RM_TABLE 4
#define USE_PREFIX_TABLE 5
#define USE_X86_64_TABLE 6
#define USE_3BYTE_TABLE 7
@


1.166
log
@gas/testsuite/

2007-10-23  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/katmai.s: Remove cmpps opcode test.

	* gas/i386/simd.s: Add tests for cmpss and cmpsd.
	* gas/i386/x86-64-simd.s: Likewise.

	* gas/i386/katmai.d: Updated.
	* gas/i386/simd-intel.d: Likewise.
	* gas/i386/simd-suffix.d: Likewise.
	* gas/i386/simd.d: Likewise.
	* gas/i386/x86-64-simd-intel.d: Likewise.
	* gas/i386/x86-64-simd-suffix.d: Likewise.
	* gas/i386/x86-64-simd.d: Likewise.

opcodes/

2007-10-23  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_SIMD_Suffix): Renamed to ...
	(CMP_Fixup): This.  Rewrite.
	(OPSIMD): Renamed to ...
	(CMP): This. Updated.
	(prefix_table): Update PREFIX_0FC2 entry.
@
text
@d525 6
a530 1
#define MOD_0F71_REG_2		(MOD_0F26 + 1)
d552 5
a556 2
#define MOD_0FF0_PREFIX_3	(MOD_0FC7_REG_7 + 1)
#define MOD_62_32BIT		(MOD_0FF0_PREFIX_3 + 1)
d1139 1
a1139 1
  { "movmskpX",		{ Gdq, XS } },
d1290 1
a1290 1
  { "pmovmskb",		{ Gdq, MS } },
d1838 4
a1841 4
    {"movntps", { Ev, XM } },
    {"movntss", { Ed, XM } },
    {"movntpd", { Ev, XM } },
    {"movntsd", { Eq, XM } },
d2144 1
a2144 1
    { "movntdq",{ EM, XM } },
d2264 1
a2264 1
    { "movntdqa", { XM, EM } },
d4618 25
d4753 10
d4768 5
@


1.165
log
@2007-10-22  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (prefix_table): Reordered by opcode.
	(mod_table): Likewise.
@
text
@d98 1
a98 1
static void OP_SIMD_Suffix (int, int);
d343 1
a343 1
#define OPSIMD { OP_SIMD_Suffix, 0 }
d2094 4
a2097 4
    { "", { XM, EXx, OPSIMD } },	/* See OP_SIMD_SUFFIX.  */
    { "", { XM, EXd, OPSIMD } },
    { "", { XM, EXx, OPSIMD } },
    { "", { XM, EXq, OPSIMD } },
d7740 1
a7740 1
OP_SIMD_Suffix (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
a7744 1
  obufp = obuf + strlen (obuf);
d7748 6
a7753 20
      char suffix1 = 'p', suffix2 = 's';
      used_prefixes |= (prefixes & PREFIX_REPZ);
      if (prefixes & PREFIX_REPZ)
	suffix1 = 's';
      else
	{
	  used_prefixes |= (prefixes & PREFIX_DATA);
	  if (prefixes & PREFIX_DATA)
	    suffix2 = 'd';
	  else
	    {
	      used_prefixes |= (prefixes & PREFIX_REPNZ);
	      if (prefixes & PREFIX_REPNZ)
		suffix1 = 's', suffix2 = 'd';
	    }
	}
      sprintf (scratchbuf, "cmp%s%c%c",
	       simd_cmp_op[cmp_type], suffix1, suffix2);
      used_prefixes |= (prefixes & PREFIX_REPZ);
      oappend (scratchbuf);
d7757 5
a7761 4
      /* We have a bad extension byte.  Clean up.  */
      op_out[0][0] = '\0';
      op_out[1][0] = '\0';
      BadOp ();
@


1.164
log
@2007-10-19  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (prefix_table): Use XS on psrldq and pslldq.
@
text
@d506 1
a506 12
#define MOD_0F13		(MOD_8D + 1)
#define MOD_0F17		(MOD_0F13 + 1)
#define MOD_0F20		(MOD_0F17 + 1)
#define MOD_0F21		(MOD_0F20 + 1)
#define MOD_0F22		(MOD_0F21 + 1)
#define MOD_0F23		(MOD_0F22 + 1)
#define MOD_0F24		(MOD_0F23 + 1)
#define MOD_0F26		(MOD_0F24 + 1)
#define MOD_0FB2		(MOD_0F26 + 1)
#define MOD_0FB4		(MOD_0FB2 + 1)
#define MOD_0FB5		(MOD_0FB4 + 1)
#define MOD_0F01_REG_0		(MOD_0FB5 + 1)
d511 5
a515 1
#define MOD_0F18_REG_0		(MOD_0F01_REG_7 + 1)
d519 7
a525 1
#define MOD_0F71_REG_2		(MOD_0F18_REG_3 + 1)
d542 4
a545 1
#define MOD_0FC7_REG_6		(MOD_0FAE_REG_7 + 1)
d547 1
a547 3
#define MOD_0F12_PREFIX_0	(MOD_0FC7_REG_7 + 1)
#define MOD_0F16_PREFIX_0	(MOD_0F12_PREFIX_0 + 1)
#define MOD_0FF0_PREFIX_3	(MOD_0F16_PREFIX_0 + 1)
d589 3
a591 1
#define PREFIX_0F78		(PREFIX_0F70 + 1)
d600 2
a601 1
#define PREFIX_0FD0		(PREFIX_0FC2 + 1)
a660 3
#define PREFIX_0F73_REG_3	(PREFIX_0F3A63 + 1)
#define PREFIX_0F73_REG_7	(PREFIX_0F73_REG_3 + 1)
#define PREFIX_0FC7_REG_6	(PREFIX_0F73_REG_7 + 1)
d2012 16
d2100 8
a2586 24

  /* PREFIX_0F73_REG_3 */
  {
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "psrldq",	{ XS, Ib } },
    { "(bad)",	{ XX } },
  },

  /* PREFIX_0F73_REG_7 */
  {
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "pslldq",	{ XS, Ib } },
    { "(bad)",	{ XX } },
  },

  /* PREFIX_0FC7_REG_6 */
  {
    { "vmptrld",{ Mq } },
    { "vmxon",	{ Mq } },
    { "vmclear",{ Mq } },
    { "(bad)",	{ XX } },
  },
d4515 8
a4522 3
    /* MOD_0F13 */
    { "movlpX",		{ EXq, XM } },
    { "(bad)",		{ XX } },
d4525 2
a4526 2
    /* MOD_0F17 */
    { "movhpX",		{ EXq, XM } },
d4530 3
a4532 3
    /* MOD_0F20 */
    { "(bad)",		{ XX } },
    { "movZ",		{ Rm, Cm } },
d4535 3
a4537 3
    /* MOD_0F21 */
    { "(bad)",		{ XX } },
    { "movZ",		{ Rm, Dm } },
d4540 3
a4542 3
    /* MOD_0F22 */
    { "(bad)",		{ XX } },
    { "movZ",		{ Cm, Rm } },
d4545 2
a4546 1
    /* MOD_0F23 */
a4547 1
    { "movZ",		{ Dm, Rm } },
d4550 3
a4552 3
    /* MOD_0F24 */
    { THREE_BYTE_TABLE (THREE_BYTE_0F24) },
    { "movL",		{ Rd, Td } },
d4555 2
a4556 1
    /* MOD_0F26 */
a4557 1
    { "movL",		{ Td, Rd } },
d4560 2
a4561 2
    /* MOD_0FB2 */
    { "lssS",		{ Gv, Mp } },
d4565 2
a4566 2
    /* MOD_0FB4 */
    { "lfsS",		{ Gv, Mp } },
d4570 2
a4571 2
    /* MOD_0FB5 */
    { "lgsS",		{ Gv, Mp } },
d4575 3
a4577 3
    /* MOD_0F01_REG_0 */
    { X86_64_TABLE (X86_64_0F01_REG_0) },
    { RM_TABLE (RM_0F01_REG_0) },
d4580 3
a4582 3
    /* MOD_0F01_REG_1 */
    { X86_64_TABLE (X86_64_0F01_REG_1) },
    { RM_TABLE (RM_0F01_REG_1) },
d4585 1
a4585 2
    /* MOD_0F01_REG_2 */
    { X86_64_TABLE (X86_64_0F01_REG_2) },
d4587 1
d4590 1
a4590 12
    /* MOD_0F01_REG_3 */
    { X86_64_TABLE (X86_64_0F01_REG_3) },
    { RM_TABLE (RM_0F01_REG_3) },
  },
  {
    /* MOD_0F01_REG_7 */
    { "invlpg",		{ Mb } },
    { RM_TABLE (RM_0F01_REG_7) },
  },
  {
    /* MOD_0F18_REG_0 */
    { "prefetchnta",	{ Mb } },
d4592 1
d4595 1
a4595 2
    /* MOD_0F18_REG_1 */
    { "prefetcht0",	{ Mb } },
d4597 1
d4600 3
a4602 3
    /* MOD_0F18_REG_2 */
    { "prefetcht1",	{ Mb } },
    { "(bad)",		{ XX } },
d4605 1
a4605 2
    /* MOD_0F18_REG_3 */
    { "prefetcht2",	{ Mb } },
d4607 1
d4695 15
a4719 10
    /* MOD_0F12_PREFIX_0 */
    { "movlps",		{ XM, EXq } },
    { "movhlps",	{ XM, EXq } },
  },
  {
    /* MOD_0F16_PREFIX_0 */
    { "movhps",		{ XM, EXq } },
    { "movlhps",	{ XM, EXq } },
  },
  {
@


1.163
log
@2007-10-15  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (dis386_twobyte): Reformat.
	(prefix_table):  Likewise.
	(three_byte_table): Likewise.
@
text
@d2568 1
a2568 1
    { "psrldq",	{ MS, Ib } },
d2576 1
a2576 1
    { "pslldq",	{ MS, Ib } },
@


1.162
log
@2007-10-12  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (prefix_table): Reformat pblendvb and blendvps.
@
text
@d1087 1
a1087 1
  { "movapX",		{ EXx,  XM } },
d1798 4
a1801 4
    { "movups",	{ EXx,  XM } },
    { "movss",	{ EXd,  XM } },
    { "movupd",	{ EXx,  XM } },
    { "movsd",	{ EXq,  XM } },
d2055 2
a2056 2
    { "movdqu",	{ EXx,  XM } },
    { "movdqa",	{ EXx,  XM } },
d3345 8
a3352 8
    { "pshufb", { MX, EM } },
    { "phaddw", { MX, EM } },
    { "phaddd",	{ MX, EM } },
    { "phaddsw", { MX, EM } },
    { "pmaddubsw", { MX, EM } },
    { "phsubw", { MX, EM } },
    { "phsubd", { MX, EM } },
    { "phsubsw", { MX, EM } },
d3354 8
a3361 8
    { "psignb", { MX, EM } },
    { "psignw", { MX, EM } },
    { "psignd", { MX, EM } },
    { "pmulhrsw", { MX, EM } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3364 3
a3366 3
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3369 1
a3369 1
    { "(bad)", { XX } },
d3372 8
a3379 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "pabsb", { MX, EM } },
    { "pabsw", { MX, EM } },
    { "pabsd", { MX, EM } },
    { "(bad)", { XX } },
d3387 2
a3388 2
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3394 4
a3397 4
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3405 1
a3405 1
    { "(bad)", { XX } },
d3419 6
a3424 6
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3426 8
a3433 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3435 8
a3442 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3444 8
a3451 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3453 8
a3460 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3462 8
a3469 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3471 8
a3478 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3480 8
a3487 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3489 8
a3496 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3498 8
a3505 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3507 8
a3514 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3516 8
a3523 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3525 8
a3532 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3534 17
a3550 17
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* b0 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3552 8
a3559 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3561 8
a3568 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3570 8
a3577 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3579 8
a3586 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3588 8
a3595 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3597 8
a3604 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3606 8
a3613 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3617 6
a3622 6
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3624 8
a3631 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3636 8
a3643 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3652 1
a3652 1
    { "palignr", { MX, EM, Ib } },
d3654 4
a3657 4
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3663 8
a3670 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3675 5
a3679 5
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3681 8
a3688 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3690 8
a3697 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3699 17
a3715 17
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* 40 */
    { PREFIX_TABLE (PREFIX_0F3A40) },
    { PREFIX_TABLE (PREFIX_0F3A41) },
    { PREFIX_TABLE (PREFIX_0F3A42) },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
a3716 210
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* 50 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* 58 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* 60 */
    { PREFIX_TABLE (PREFIX_0F3A60) },
    { PREFIX_TABLE (PREFIX_0F3A61) },
    { PREFIX_TABLE (PREFIX_0F3A62) },
    { PREFIX_TABLE (PREFIX_0F3A63) },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* 68 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* 70 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* 78 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* 80 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* 88 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* 90 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* 98 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* a0 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* a8 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* b0 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* b8 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* c0 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* c8 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* d0 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* d8 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* e0 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* e8 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* f0 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    /* f8 */
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
  },
  /* THREE_BYTE_0F7A */
  {
    /* 00 */
d3725 6
a3730 1
    /* 08 */
d3734 1
a3739 5
    /* 10 */
    { "frczps",		{ XM, EXq } },
    { "frczpd",		{ XM, EXq } },
    { "frczss",		{ XM, EXq } },
    { "frczsd",		{ XM, EXq } },
d3743 5
a3748 1
    /* 18 */
d3752 1
a3757 2
    /* 20 */
    { "ptest",		{ XX } },
d3761 211
a3975 1
    /* 28 */
a3979 4
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3983 6
a3988 6
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3990 8
a3997 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3999 1
a3999 1
    { "(bad)", { XX } },
d4003 2
a4004 2
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4008 3
a4010 3
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4012 4
a4015 4
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4017 1
a4017 1
    { "(bad)", { XX } },
d4021 2
a4022 2
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4026 3
a4028 3
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4030 4
a4033 4
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4035 1
a4035 1
    { "(bad)", { XX } },
d4039 4
a4042 4
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4044 8
a4051 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4053 8
a4060 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4062 8
a4069 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4071 8
a4078 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4080 8
a4087 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4089 8
a4096 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4098 8
a4105 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4107 8
a4114 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4116 8
a4123 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4125 8
a4132 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4134 8
a4141 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4143 8
a4150 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4152 8
a4159 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4161 8
a4168 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4170 8
a4177 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4179 8
a4186 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4188 8
a4195 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4199 6
a4204 6
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4206 8
a4213 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4218 8
a4225 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4227 8
a4234 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4236 8
a4243 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4245 8
a4252 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4254 8
a4261 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4263 8
a4270 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4272 6
a4277 6
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4284 5
a4288 5
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4304 3
a4306 3
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4308 8
a4315 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4317 8
a4324 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4330 4
a4333 4
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4335 8
a4342 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4344 8
a4351 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4353 8
a4360 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4362 8
a4369 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4371 8
a4378 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4380 8
a4387 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4389 8
a4396 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4398 8
a4405 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4407 8
a4414 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4416 8
a4423 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4425 8
a4432 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4434 8
a4441 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4443 8
a4450 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4452 8
a4459 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4461 8
a4468 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4470 8
a4477 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4479 8
a4486 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4488 8
a4495 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4497 8
a4504 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
@


1.161
log
@Remove extra white space.
@
text
@d2136 1
a2136 1
    { "pblendvb", {XM, EXx, XMM0 } },
d2144 1
a2144 1
    { "blendvps", {XM, EXx, XMM0 } },
@


1.160
log
@2007-10-10  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (v_mode): Defined as previous one + 1.
	(w_mode): Likewise.
	(d_mode): Likewise.
	(q_mode): Likewise.
	(t_mode): Likewise.
	(x_mode): Likewise.
	(m_mode): Likewise.
	(cond_jump_mode): Likewise.
	(loop_jcxz_mode): Likewise.
	(dq_mode): Likewise.
	(dqw_mode): Likewise.
	(f_mode): Likewise.
	(const_1_mode): Likewise.
	(stack_v_mode): Likewise.
	(z_mode): Likewise.
	(o_mode): Likewise.
	(dqb_mode): Likewise.
	(dqd_mode): Likewise.
	(es_reg): Likewise.
	(cs_reg): Likewise.
	(ss_reg): Likewise.
	(ds_reg): Likewise.
	(fs_reg): Likewise.
	(gs_reg): Likewise.
	(eAX_reg): Likewise.
	(eCX_reg): Likewise.
	(eDX_reg): Likewise.
	(eBX_reg): Likewise.
	(eSP_reg): Likewise.
	(eBP_reg): Likewise.
	(eSI_reg): Likewise.
	(eDI_reg): Likewise.
	(al_reg): Likewise.
	(cl_reg): Likewise.
	(dl_reg): Likewise.
	(bl_reg): Likewise.
	(ah_reg): Likewise.
	(ch_reg): Likewise.
	(dh_reg): Likewise.
	(bh_reg): Likewise.
	(ax_reg): Likewise.
	(cx_reg): Likewise.
	(dx_reg): Likewise.
	(bx_reg): Likewise.
	(sp_reg): Likewise.
	(bp_reg): Likewise.
	(si_reg): Likewise.
	(di_reg): Likewise.
	(rAX_reg): Likewise.
	(rCX_reg): Likewise.
	(rDX_reg): Likewise.
	(rBX_reg): Likewise.
	(rSP_reg): Likewise.
	(rBP_reg): Likewise.
	(rSI_reg): Likewise.
	(rDI_reg): Likewise.
	(z_mode_ax_reg): Likewise.
	(indir_dx_reg): Likewise.
	(DREX_OC1): Updated.
	(DREX_NO_OC0): Likewise.
	(DREX_MASK): Likewise.
	(MAX_BYTEMODE): New.  Issue an error if MAX_BYTEMODE is not
	less than DREX_OC1.
@
text
@d367 1
a367 1
#define v_mode 			(b_mode + 1)
@


1.159
log
@gas/testsuite/

2007-10-08  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run simd-suffix and x86-64-simd-suffix.

	* gas/i386/simd-suffix.d: New.
	* gas/i386/x86-64-simd-suffix.d: Likewise.

	* gas/i386/x86-64-opcode.d: Updated.
	* gas/i386/x86-64-simd.d: Likewise.

opcodes/

2007-10-08  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c: Updated comments for 'Y'.
	(putop): Don't add 'q' for 'Y' if suffix_always isn't true.
@
text
@d364 89
a452 67
#define b_mode 1  /* byte operand */
#define v_mode 2  /* operand size depends on prefixes */
#define w_mode 3  /* word operand */
#define d_mode 4  /* double word operand  */
#define q_mode 5  /* quad word operand */
#define t_mode 6  /* ten-byte operand */
#define x_mode 7  /* 16-byte XMM operand */
#define m_mode 8  /* d_mode in 32bit, q_mode in 64bit mode.  */
#define cond_jump_mode 9
#define loop_jcxz_mode 10
#define dq_mode 11 /* operand size depends on REX prefixes.  */
#define dqw_mode 12 /* registers like dq_mode, memory like w_mode.  */
#define f_mode 13 /* 4- or 6-byte pointer operand */
#define const_1_mode 14
#define stack_v_mode 15 /* v_mode for stack-related opcodes.  */
#define z_mode 16 /* non-quad operand size depends on prefixes */
#define o_mode 17  /* 16-byte operand */
#define dqb_mode 18 /* registers like dq_mode, memory like b_mode.  */
#define dqd_mode 19 /* registers like dq_mode, memory like d_mode.  */

/* Flags that are OR'ed into the bytemode field to pass extra information.  */
#define DREX_OC1	0x4000	/* OC1 bit set */
#define DREX_NO_OC0	0x2000	/* OC0 bit not used */
#define DREX_MASK	0x6000	/* mask to delete */

#define es_reg 100
#define cs_reg 101
#define ss_reg 102
#define ds_reg 103
#define fs_reg 104
#define gs_reg 105

#define eAX_reg 108
#define eCX_reg 109
#define eDX_reg 110
#define eBX_reg 111
#define eSP_reg 112
#define eBP_reg 113
#define eSI_reg 114
#define eDI_reg 115

#define al_reg 116
#define cl_reg 117
#define dl_reg 118
#define bl_reg 119
#define ah_reg 120
#define ch_reg 121
#define dh_reg 122
#define bh_reg 123

#define ax_reg 124
#define cx_reg 125
#define dx_reg 126
#define bx_reg 127
#define sp_reg 128
#define bp_reg 129
#define si_reg 130
#define di_reg 131

#define rAX_reg 132
#define rCX_reg 133
#define rDX_reg 134
#define rBX_reg 135
#define rSP_reg 136
#define rBP_reg 137
#define rSI_reg 138
#define rDI_reg 139
d454 3
a456 2
#define z_mode_ax_reg 149
#define indir_dx_reg 150
@


1.158
log
@gas/testsuite/

2007-10-05  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run smx.

	* gas/i386/smx.d: New.
	* gas/i386/smx.s: Likewise.

opcodes/

2007-10-05  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (dis386_twobyte): Add getsec.

	* i386-gen.c (cpu_flags): Add CpuSMX.

	* i386-opc.h (CpuSMX): New.
	(CpuSSSE3): Updated.
	(i386_cpu_flags): Add cpusmx.

	* i386-opc.tbl: Add getsec.
	* i386-init.h: Regenerated.
	* i386-tbl.h: Likewise.
@
text
@d715 2
a716 1
   'Y' => 'q' if instruction has an REX 64bit overwrite prefix
d6174 1
a6174 1
	  if (intel_syntax)
@


1.157
log
@2007-10-05  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (reg_table): Use "{ XX }" on "(bad)".
	(prefix_table): Likewise.
@
text
@d1078 1
a1078 1
  { "(bad)",		{ XX } },
@


1.156
log
@gas/testsuite/

2007-10-04  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/simd.s: Add tests for unpckhpd and unpckhps.
	* gas/i386/x86-64-simd.s: Likewise.

	* gas/i386/simd-intel.d: Updated.
	* gas/i386/simd.d: Likewise.
	* gas/i386/x86-64-simd-intel.d: Likewise.
	* gas/i386/x86-64-simd.d: Likewise.

opcodes/

2007-10-04  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (dis386_twobyte): Use EXx instead of EXq on
	unpckhpX and unpckhpX.
@
text
@d1580 1
a1580 1
    { "(bad)",	{ Eb } },
d1793 1
a1793 1
    { "(bad)",	{ XM, EXq } },
d1856 2
a1857 2
    { "(bad)",	{ XM, EXx } },
    { "(bad)",	{ XM, EXx } },
d1864 2
a1865 2
    { "(bad)",	{ XM, EXx } },
    { "(bad)",	{ XM, EXx } },
d1897 1
a1897 1
    { "(bad)",	{ XM, EXx } },
d1958 2
a1959 2
    { "(bad)",	{ MX, EXx } },
    { "(bad)",	{ XM, EXx } },
d1961 1
a1961 1
    { "(bad)",	{ XM, EXx } },
d1966 2
a1967 2
    { "(bad)",	{ MX, EXx } },
    { "(bad)",	{ XM, EXx } },
d1969 1
a1969 1
    { "(bad)",	{ XM, EXx } },
d1977 1
a1977 1
    { "(bad)",	{ XM, EXx } },
d2006 2
a2007 2
    { "(bad)",	{ MX, EXx } },
    { "(bad)",	{ XM, EXx } },
d2014 2
a2015 2
    { "(bad)",	{ MX, EXx } },
    { "(bad)",	{ XM, EXx } },
d2025 1
a2025 1
    { "(bad)",	{ Ed, XM } },
d2033 1
a2033 1
    { "(bad)",	{ EXx,  XM } },
d2062 2
a2063 2
    { "(bad)",	{ MX, EXx } },
    { "(bad)",	{ XM, EXx } },
d2070 1
a2070 1
    { "(bad)",	{ EXx,  XM } },
d2078 1
a2078 1
    { "(bad)",	{ XM, EXx } },
d2087 1
a2087 1
    { "(bad)",	{ EM, XM } },
d2089 1
a2089 1
    { "(bad)",	{ EM, XM } },
d2094 3
a2096 3
    { "(bad)",	{ XM, EXx } },
    { "(bad)",	{ XM, EXx } },
    { "(bad)",	{ XM, EXx } },
d2103 1
a2103 1
    { "(bad)",	{ XM, EXx } },
d2105 1
a2105 1
    { "(bad)",	{ XM, EXx } },
@


1.155
log
@2007-10-04  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (MOD_0F12_PREFIX_0): Use "movlps" and "movhlps"
	instead of "movlpX" and "movhlpX", respectively.
	(MOD_0F16_PREFIX_0): Use "movhps" and "movlhps" instead of
	"movhpX" and "movlhpX", respectively.
@
text
@d1039 2
a1040 2
  { "unpcklpX",		{ XM, EXq } },
  { "unpckhpX",		{ XM, EXq } },
@


1.154
log
@2007-10-03  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_REG): Set add to 0 only when needed.
	(OP_C): Likewise.
	(OP_D): Likewise.
	(OP_MMX): Likewise.
	(OP_XMM): Likewise.
	(OP_EM): Likewise.
	(OP_MXC): Likewise.
	(OP_EX): Likewise.
@
text
@d4687 2
a4688 2
    { "movlpX",		{ XM, EXq } },
    { "movhlpX",	{ XM, EXq } },
d4692 2
a4693 2
    { "movhpX",		{ XM, EXq } },
    { "movlhpX",	{ XM, EXq } },
@


1.153
log
@2007-10-01  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (THREE_BYTE_0FBA): Renamed to ...
	(THREE_BYTE_0F7B): This.
	(dis386_twobyte): Updated.
	(three_byte_table): Updated comments.
@
text
@d6899 1
a6899 1
  int add = 0;
d6903 2
d7377 1
a7377 1
  int add = 0;
d7389 2
d7398 1
a7398 1
  int add = 0;
d7402 2
d7433 1
a7433 1
      int add = 0;
d7437 2
d7449 1
a7449 1
  int add = 0;
d7453 2
d7479 1
a7479 1
      int add = 0;
d7484 2
d7531 1
a7531 1
  int add = 0;
d7540 2
@


1.152
log
@2007-09-30  H.J. Lu  <hongjiu.lu@@intel.com>

	* 386-dis.c (prefix_table): Reformat comment.
@
text
@d673 1
a673 1
#define THREE_BYTE_0FBA		(THREE_BYTE_0F7A + 1)
d1155 1
a1155 1
  { THREE_BYTE_TABLE (THREE_BYTE_0FBA) },
d3900 1
a3900 1
  /* THREE_BYTE_SSE5_0F7A */
d4191 1
a4191 1
  /* THREE_BYTE_SSE5_0F7B */
@


1.151
log
@2007-09-29  H.J. Lu  <hongjiu.lu@@intel.com>

	* 386-dis.c (USE_GROUPS): Renamed to ...
	(USE_REG_TABLE): This.
	(USE_OPC_EXT_TABLE): Renamed to ...
	(USE_MOD_TABLE): This.
	(USE_OPC_EXT_RM_TABLE): Renamed to ...
	(USE_RM_TABLE): This.
	(USE_XXX_TABLE): Reordered.
	(GRP): Renamed to ...
	(REG_TABLE): This.
	(OPC_EXT_TABLE): Renamed to ...
	(MOD_TABLE): This.
	(OPC_EXT_RM_TABLE): Renamed to ...
	(RM_TABLE): This.
	(GRP_XXX): Renamed to ...
	(REG_XXX): This.
	(PREGRP_XXX): Renamed to ...
	(PREFIX_XXX): This.
	(OPC_EXT_XXX): Renamed to ...
	(MOD_XXX): This.
	(OPC_EXT_RM_XXX): Renamed to ...
	(RM_XXX): This.
	(grps): Renamed to ...
	(reg_table): This
	(prefix_user_table): Renamed to ...
	(prefix_table): This
	(opc_ext_table): Renamed to ...
	(mod_table): This
	(opc_ext_rm_table): Renamed to ...
	(rm_table): This
	(OPC_EXT_RM_XXX): Likewise.
	(dis386): Updated.
	(dis386_twobyte): Likewise.
	(reg_table): Likewise.
	(prefix_table): Likewise.
	(x86_64_table): Likewise.
	(three_byte_table): Likewise.
	(mod_table): Likewise.
	(rm_table): Likewise.
	(get_valid_dis386): Likewise.
@
text
@d2556 1
a2556 1
  /*PREFIX_0FC7_REG_6 */
@


1.150
log
@2007-09-28  H.J. Lu  <hongjiu.lu@@intel.com>

	* 386-dis.c (USE_PREFIX_USER_TABLE): Renamed to ...
	(USE_PREFIX_TABLE): This.
	(X86_64_SPECIAL): Renamed to ...
	(USE_X86_64_TABLE): This.
	(IS_3BYTE_OPCODE): Renamed to ...
	(USE_3BYTE_TABLE): This.
	(GRPXXX): Removed.
	(PREGRPXXX): Likewise.
	(X86_64_XXX): Likewise.
	(THREE_BYTE_XXX): Likewise.
	(OPC_EXT_XXX): Likewise.
	(OPC_EXT_RM_XXX): Likewise.
	(DIS386): New.
	(GRP): Likewise.
	(PREGRP): Likewise.
	(X86_64_TABLE): Likewise.
	(THREE_BYTE_TABLE): Likewise.
	(OPC_EXT_TABLE): Likewise.
	(OPC_EXT_RM_TABLE): Likewise.
	(GRP_XXX): Likewise.
	(PREGRP_XXX): Likewise.
	(X86_64_XXX): Likewise.
	(THREE_BYTE_XXX): Likewise.
	(OPC_EXT_XXX): Likewise.
	(OPC_EXT_RM_XXX): Likewise.
	(dis386): Updated.
	(dis386_twobyte): Likewise.
	(grps): Likewise.
	(prefix_user_table): Likewise.
	(x86_64_table): Likewise.
	(three_byte_table): Likewise.
	(opc_ext_table): Likewise.
	(opc_ext_rm_table): Likewise.
	(get_valid_dis386): Likewise.
@
text
@d436 6
a441 6
#define USE_GROUPS 2
#define USE_PREFIX_TABLE 3
#define USE_X86_64_TABLE 4
#define USE_3BYTE_TABLE 5
#define USE_OPC_EXT_TABLE 6
#define USE_OPC_EXT_RM_TABLE 7
d443 1
a443 1
#define FLOAT	  NULL, { { NULL, FLOATCODE } }
d446 4
a449 2
#define GRP(I)			DIS386 (USE_GROUPS, (I))
#define PREGRP(I)		DIS386 (USE_PREFIX_TABLE, (I))
a451 2
#define OPC_EXT_TABLE(I)	DIS386 (USE_OPC_EXT_TABLE, (I))
#define OPC_EXT_RM_TABLE(I)	DIS386 (USE_OPC_EXT_RM_TABLE, (I))
d453 185
a637 130
#define GRP_80			0
#define GRP_81			(GRP_80 + 1)
#define GRP_82			(GRP_81 + 1)
#define GRP_8F			(GRP_82 + 1)
#define GRP_C0			(GRP_8F + 1)
#define GRP_C1			(GRP_C0 + 1)
#define GRP_C6			(GRP_C1 + 1)
#define GRP_C7			(GRP_C6 + 1)
#define GRP_D0			(GRP_C7 + 1)
#define GRP_D1			(GRP_D0 + 1)
#define GRP_D2			(GRP_D1 + 1)
#define GRP_D3			(GRP_D2 + 1)
#define GRP_F6			(GRP_D3 + 1)
#define GRP_F7			(GRP_F6 + 1)
#define GRP_FE			(GRP_F7 + 1)
#define GRP_FF			(GRP_FE + 1)
#define GRP_0F00		(GRP_FF + 1)
#define GRP_0F01		(GRP_0F00 + 1)
#define GRP_0F0E		(GRP_0F01 + 1)
#define GRP_0F18		(GRP_0F0E + 1)
#define GRP_0F71		(GRP_0F18 + 1)
#define GRP_0F72		(GRP_0F71 + 1)
#define GRP_0F73		(GRP_0F72 + 1)
#define GRP_0FA6		(GRP_0F73 + 1)
#define GRP_0FA7		(GRP_0FA6 + 1)
#define GRP_0FAE		(GRP_0FA7 + 1)
#define GRP_0FBA		(GRP_0FAE + 1)
#define GRP_0FC7		(GRP_0FBA + 1)

#define PREGRP_90		0
#define PREGRP_0F10		(PREGRP_90 + 1)
#define PREGRP_0F11		(PREGRP_0F10 + 1)
#define PREGRP_0F12		(PREGRP_0F11 + 1)
#define PREGRP_0F16		(PREGRP_0F12 + 1)
#define PREGRP_0F2A		(PREGRP_0F16 + 1)
#define PREGRP_0F2B		(PREGRP_0F2A + 1)
#define PREGRP_0F2C		(PREGRP_0F2B + 1)
#define PREGRP_0F2D		(PREGRP_0F2C + 1)
#define PREGRP_0F2E		(PREGRP_0F2D + 1)
#define PREGRP_0F2F		(PREGRP_0F2E + 1)
#define PREGRP_0F51		(PREGRP_0F2F + 1)
#define PREGRP_0F52		(PREGRP_0F51 + 1)
#define PREGRP_0F53		(PREGRP_0F52 + 1)
#define PREGRP_0F58		(PREGRP_0F53 + 1)
#define PREGRP_0F59		(PREGRP_0F58 + 1)
#define PREGRP_0F5A		(PREGRP_0F59 + 1)
#define PREGRP_0F5B		(PREGRP_0F5A + 1)
#define PREGRP_0F5C		(PREGRP_0F5B + 1)
#define PREGRP_0F5D		(PREGRP_0F5C + 1)
#define PREGRP_0F5E		(PREGRP_0F5D + 1)
#define PREGRP_0F5F		(PREGRP_0F5E + 1)
#define PREGRP_0F60		(PREGRP_0F5F + 1)
#define PREGRP_0F61		(PREGRP_0F60 + 1)
#define PREGRP_0F62		(PREGRP_0F61 + 1)
#define PREGRP_0F6C		(PREGRP_0F62 + 1)
#define PREGRP_0F6D		(PREGRP_0F6C + 1)
#define PREGRP_0F6F		(PREGRP_0F6D + 1)
#define PREGRP_0F70		(PREGRP_0F6F + 1)
#define PREGRP_0F78		(PREGRP_0F70 + 1)
#define PREGRP_0F79		(PREGRP_0F78 + 1)
#define PREGRP_0F7C		(PREGRP_0F79 + 1)
#define PREGRP_0F7D		(PREGRP_0F7C + 1)
#define PREGRP_0F7E		(PREGRP_0F7D + 1)
#define PREGRP_0F7F		(PREGRP_0F7E + 1)
#define PREGRP_0FB8		(PREGRP_0F7F + 1)
#define PREGRP_0FBD		(PREGRP_0FB8 + 1)
#define PREGRP_0FC2		(PREGRP_0FBD + 1)
#define PREGRP_0FD0		(PREGRP_0FC2 + 1)
#define PREGRP_0FD6		(PREGRP_0FD0 + 1)
#define PREGRP_0FE6		(PREGRP_0FD6 + 1)
#define PREGRP_0FE7		(PREGRP_0FE6 + 1)
#define PREGRP_0FF0		(PREGRP_0FE7 + 1)
#define PREGRP_0FF7		(PREGRP_0FF0 + 1)
#define PREGRP_0F3810		(PREGRP_0FF7 + 1)
#define PREGRP_0F3814		(PREGRP_0F3810 + 1)
#define PREGRP_0F3815		(PREGRP_0F3814 + 1)
#define PREGRP_0F3817		(PREGRP_0F3815 + 1)
#define PREGRP_0F3820		(PREGRP_0F3817 + 1)
#define PREGRP_0F3821		(PREGRP_0F3820 + 1)
#define PREGRP_0F3822		(PREGRP_0F3821 + 1)
#define PREGRP_0F3823		(PREGRP_0F3822 + 1)
#define PREGRP_0F3824		(PREGRP_0F3823 + 1)
#define PREGRP_0F3825		(PREGRP_0F3824 + 1)
#define PREGRP_0F3828		(PREGRP_0F3825 + 1)
#define PREGRP_0F3829		(PREGRP_0F3828 + 1)
#define PREGRP_0F382A		(PREGRP_0F3829 + 1)
#define PREGRP_0F382B		(PREGRP_0F382A + 1)
#define PREGRP_0F3830		(PREGRP_0F382B + 1)
#define PREGRP_0F3831		(PREGRP_0F3830 + 1)
#define PREGRP_0F3832		(PREGRP_0F3831 + 1)
#define PREGRP_0F3833		(PREGRP_0F3832 + 1)
#define PREGRP_0F3834		(PREGRP_0F3833 + 1)
#define PREGRP_0F3835		(PREGRP_0F3834 + 1)
#define PREGRP_0F3837		(PREGRP_0F3835 + 1)
#define PREGRP_0F3838		(PREGRP_0F3837 + 1)
#define PREGRP_0F3839		(PREGRP_0F3838 + 1)
#define PREGRP_0F383A		(PREGRP_0F3839 + 1)
#define PREGRP_0F383B		(PREGRP_0F383A + 1)
#define PREGRP_0F383C		(PREGRP_0F383B + 1)
#define PREGRP_0F383D		(PREGRP_0F383C + 1)
#define PREGRP_0F383E		(PREGRP_0F383D + 1)
#define PREGRP_0F383F		(PREGRP_0F383E + 1)
#define PREGRP_0F3840		(PREGRP_0F383F + 1)
#define PREGRP_0F3841		(PREGRP_0F3840 + 1)
#define PREGRP_0F38F0		(PREGRP_0F3841 + 1)
#define PREGRP_0F38F1		(PREGRP_0F38F0 + 1)
#define PREGRP_0F3A08		(PREGRP_0F38F1 + 1)
#define PREGRP_0F3A09		(PREGRP_0F3A08 + 1)
#define PREGRP_0F3A0A		(PREGRP_0F3A09 + 1)
#define PREGRP_0F3A0B		(PREGRP_0F3A0A + 1)
#define PREGRP_0F3A0C		(PREGRP_0F3A0B + 1)
#define PREGRP_0F3A0D		(PREGRP_0F3A0C + 1)
#define PREGRP_0F3A0E		(PREGRP_0F3A0D + 1)
#define PREGRP_0F3A14		(PREGRP_0F3A0E + 1)
#define PREGRP_0F3A15		(PREGRP_0F3A14 + 1)
#define PREGRP_0F3A16		(PREGRP_0F3A15 + 1)
#define PREGRP_0F3A17		(PREGRP_0F3A16 + 1)
#define PREGRP_0F3A20		(PREGRP_0F3A17 + 1)
#define PREGRP_0F3A21		(PREGRP_0F3A20 + 1)
#define PREGRP_0F3A22		(PREGRP_0F3A21 + 1)
#define PREGRP_0F3A40		(PREGRP_0F3A22 + 1)
#define PREGRP_0F3A41		(PREGRP_0F3A40 + 1)
#define PREGRP_0F3A42		(PREGRP_0F3A41 + 1)
#define PREGRP_0F3A60		(PREGRP_0F3A42 + 1)
#define PREGRP_0F3A61		(PREGRP_0F3A60 + 1)
#define PREGRP_0F3A62		(PREGRP_0F3A61 + 1)
#define PREGRP_0F3A63		(PREGRP_0F3A62 + 1)
#define PREGRP_0F73_REG_3	(PREGRP_0F3A63 + 1)
#define PREGRP_0F73_REG_7	(PREGRP_0F73_REG_3 + 1)
#define PREGRP_0FC7_REG_6	(PREGRP_0F73_REG_7 + 1)
a674 55
#define OPC_EXT_8D		0
#define OPC_EXT_0F13		(OPC_EXT_8D + 1)
#define OPC_EXT_0F17		(OPC_EXT_0F13 + 1)
#define OPC_EXT_0F20		(OPC_EXT_0F17 + 1)
#define OPC_EXT_0F21		(OPC_EXT_0F20 + 1)
#define OPC_EXT_0F22		(OPC_EXT_0F21 + 1)
#define OPC_EXT_0F23		(OPC_EXT_0F22 + 1)
#define OPC_EXT_0F24		(OPC_EXT_0F23 + 1)
#define OPC_EXT_0F26		(OPC_EXT_0F24 + 1)
#define OPC_EXT_0FB2		(OPC_EXT_0F26 + 1)
#define OPC_EXT_0FB4		(OPC_EXT_0FB2 + 1)
#define OPC_EXT_0FB5		(OPC_EXT_0FB4 + 1)
#define OPC_EXT_0F01_REG_0	(OPC_EXT_0FB5 + 1)
#define OPC_EXT_0F01_REG_1	(OPC_EXT_0F01_REG_0 + 1)
#define OPC_EXT_0F01_REG_2	(OPC_EXT_0F01_REG_1 + 1)
#define OPC_EXT_0F01_REG_3	(OPC_EXT_0F01_REG_2 + 1)
#define OPC_EXT_0F01_REG_7	(OPC_EXT_0F01_REG_3 + 1)
#define OPC_EXT_0F18_REG_0	(OPC_EXT_0F01_REG_7 + 1)
#define OPC_EXT_0F18_REG_1	(OPC_EXT_0F18_REG_0 + 1)
#define OPC_EXT_0F18_REG_2	(OPC_EXT_0F18_REG_1 + 1)
#define OPC_EXT_0F18_REG_3	(OPC_EXT_0F18_REG_2 + 1)
#define OPC_EXT_0F71_REG_2	(OPC_EXT_0F18_REG_3 + 1)
#define OPC_EXT_0F71_REG_4	(OPC_EXT_0F71_REG_2 + 1)
#define OPC_EXT_0F71_REG_6	(OPC_EXT_0F71_REG_4 + 1)
#define OPC_EXT_0F72_REG_2	(OPC_EXT_0F71_REG_6 + 1)
#define OPC_EXT_0F72_REG_4	(OPC_EXT_0F72_REG_2 + 1)
#define OPC_EXT_0F72_REG_6	(OPC_EXT_0F72_REG_4 + 1)
#define OPC_EXT_0F73_REG_2	(OPC_EXT_0F72_REG_6 + 1)
#define OPC_EXT_0F73_REG_3	(OPC_EXT_0F73_REG_2 + 1)
#define OPC_EXT_0F73_REG_6	(OPC_EXT_0F73_REG_3 + 1)
#define OPC_EXT_0F73_REG_7	(OPC_EXT_0F73_REG_6 + 1)
#define OPC_EXT_0FAE_REG_0	(OPC_EXT_0F73_REG_7 + 1)
#define OPC_EXT_0FAE_REG_1	(OPC_EXT_0FAE_REG_0 + 1)
#define OPC_EXT_0FAE_REG_2	(OPC_EXT_0FAE_REG_1 + 1)
#define OPC_EXT_0FAE_REG_3	(OPC_EXT_0FAE_REG_2 + 1)
#define OPC_EXT_0FAE_REG_5	(OPC_EXT_0FAE_REG_3 + 1)
#define OPC_EXT_0FAE_REG_6	(OPC_EXT_0FAE_REG_5 + 1)
#define OPC_EXT_0FAE_REG_7	(OPC_EXT_0FAE_REG_6 + 1)
#define OPC_EXT_0FC7_REG_6	(OPC_EXT_0FAE_REG_7 + 1)
#define OPC_EXT_0FC7_REG_7	(OPC_EXT_0FC7_REG_6 + 1)
#define OPC_EXT_0F12_PREFIX_0	(OPC_EXT_0FC7_REG_7 + 1)
#define OPC_EXT_0F16_PREFIX_0	(OPC_EXT_0F12_PREFIX_0 + 1)
#define OPC_EXT_0FF0_PREFIX_3	(OPC_EXT_0F16_PREFIX_0 + 1)
#define OPC_EXT_62_32BIT	(OPC_EXT_0FF0_PREFIX_3 + 1)
#define OPC_EXT_C4_32BIT	(OPC_EXT_62_32BIT + 1)
#define OPC_EXT_C5_32BIT	(OPC_EXT_C4_32BIT + 1)

#define OPC_EXT_RM_0F01_REG_0	0
#define OPC_EXT_RM_0F01_REG_1	(OPC_EXT_RM_0F01_REG_0 + 1)
#define OPC_EXT_RM_0F01_REG_3	(OPC_EXT_RM_0F01_REG_1 + 1)
#define OPC_EXT_RM_0F01_REG_7	(OPC_EXT_RM_0F01_REG_3 + 1)
#define OPC_EXT_RM_0FAE_REG_5	(OPC_EXT_RM_0F01_REG_7 + 1)
#define OPC_EXT_RM_0FAE_REG_6	(OPC_EXT_RM_0FAE_REG_5 + 1)
#define OPC_EXT_RM_0FAE_REG_7	(OPC_EXT_RM_0FAE_REG_6 + 1)

d870 2
a871 2
  { GRP (GRP_80) },
  { GRP (GRP_81) },
d873 1
a873 1
  { GRP (GRP_82) },
d884 1
a884 1
  { OPC_EXT_TABLE (OPC_EXT_8D) },
d886 1
a886 1
  { GRP (GRP_8F) },
d888 1
a888 1
  { PREGRP (PREGRP_90) },
d942 2
a943 2
  { GRP (GRP_C0) },
  { GRP (GRP_C1) },
d948 2
a949 2
  { GRP (GRP_C6) },
  { GRP (GRP_C7) },
d960 4
a963 4
  { GRP (GRP_D0) },
  { GRP (GRP_D1) },
  { GRP (GRP_D2) },
  { GRP (GRP_D3) },
d1002 2
a1003 2
  { GRP (GRP_F6) },
  { GRP (GRP_F7) },
d1011 2
a1012 2
  { GRP (GRP_FE) },
  { GRP (GRP_FF) },
d1017 2
a1018 2
  { GRP (GRP_0F00 ) },
  { GRP (GRP_0F01 ) },
d1031 1
a1031 1
  { GRP (GRP_0F0E) },
d1035 4
a1038 4
  { PREGRP (PREGRP_0F10) },
  { PREGRP (PREGRP_0F11) },
  { PREGRP (PREGRP_0F12) },
  { OPC_EXT_TABLE (OPC_EXT_0F13) },
d1041 2
a1042 2
  { PREGRP (PREGRP_0F16) },
  { OPC_EXT_TABLE (OPC_EXT_0F17) },
d1044 1
a1044 1
  { GRP (GRP_0F18) },
d1053 5
a1057 5
  { OPC_EXT_TABLE (OPC_EXT_0F20) },
  { OPC_EXT_TABLE (OPC_EXT_0F21) },
  { OPC_EXT_TABLE (OPC_EXT_0F22) },
  { OPC_EXT_TABLE (OPC_EXT_0F23) },
  { OPC_EXT_TABLE (OPC_EXT_0F24) },
d1059 1
a1059 1
  { OPC_EXT_TABLE (OPC_EXT_0F26) },
d1064 6
a1069 6
  { PREGRP (PREGRP_0F2A) },
  { PREGRP (PREGRP_0F2B) },
  { PREGRP (PREGRP_0F2C) },
  { PREGRP (PREGRP_0F2D) },
  { PREGRP (PREGRP_0F2E) },
  { PREGRP (PREGRP_0F2F) },
d1108 3
a1110 3
  { PREGRP (PREGRP_0F51) },
  { PREGRP (PREGRP_0F52) },
  { PREGRP (PREGRP_0F53) },
d1116 8
a1123 8
  { PREGRP (PREGRP_0F58) },
  { PREGRP (PREGRP_0F59) },
  { PREGRP (PREGRP_0F5A) },
  { PREGRP (PREGRP_0F5B) },
  { PREGRP (PREGRP_0F5C) },
  { PREGRP (PREGRP_0F5D) },
  { PREGRP (PREGRP_0F5E) },
  { PREGRP (PREGRP_0F5F) },
d1125 3
a1127 3
  { PREGRP (PREGRP_0F60) },
  { PREGRP (PREGRP_0F61) },
  { PREGRP (PREGRP_0F62) },
d1138 2
a1139 2
  { PREGRP (PREGRP_0F6C) },
  { PREGRP (PREGRP_0F6D) },
d1141 1
a1141 1
  { PREGRP (PREGRP_0F6F) },
d1143 4
a1146 4
  { PREGRP (PREGRP_0F70) },
  { GRP (GRP_0F71) },
  { GRP (GRP_0F72) },
  { GRP (GRP_0F73) },
d1152 2
a1153 2
  { PREGRP (PREGRP_0F78) },
  { PREGRP (PREGRP_0F79) },
d1156 4
a1159 4
  { PREGRP (PREGRP_0F7C) },
  { PREGRP (PREGRP_0F7D) },
  { PREGRP (PREGRP_0F7E) },
  { PREGRP (PREGRP_0F7F) },
d1203 2
a1204 2
  { GRP (GRP_0FA6) },
  { GRP (GRP_0FA7) },
d1212 1
a1212 1
  { GRP (GRP_0FAE) },
d1217 1
a1217 1
  { OPC_EXT_TABLE (OPC_EXT_0FB2) },
d1219 2
a1220 2
  { OPC_EXT_TABLE (OPC_EXT_0FB4) },
  { OPC_EXT_TABLE (OPC_EXT_0FB5) },
d1224 1
a1224 1
  { PREGRP (PREGRP_0FB8) },
d1226 1
a1226 1
  { GRP (GRP_0FBA) },
d1229 1
a1229 1
  { PREGRP (PREGRP_0FBD) },
d1235 1
a1235 1
  { PREGRP (PREGRP_0FC2) },
d1240 1
a1240 1
  { GRP (GRP_0FC7) },
d1251 1
a1251 1
  { PREGRP (PREGRP_0FD0) },
d1257 1
a1257 1
  { PREGRP (PREGRP_0FD6) },
d1275 2
a1276 2
  { PREGRP (PREGRP_0FE6) },
  { PREGRP (PREGRP_0FE7) },
d1287 1
a1287 1
  { PREGRP (PREGRP_0FF0) },
d1294 1
a1294 1
  { PREGRP (PREGRP_0FF7) },
d1444 2
a1445 2
static const struct dis386 grps[][8] = {
  /* GRP_80 */
d1456 1
a1456 1
  /* GRP_81 */
d1467 1
a1467 1
  /* GRP_82 */
d1478 1
a1478 1
  /* GRP_8F */
d1489 1
a1489 1
  /* GRP_C0 */
d1500 1
a1500 1
  /* GRP_C1 */
d1511 1
a1511 1
  /* GRP_C6 */
d1522 1
a1522 1
  /* GRP_C7 */
d1533 1
a1533 1
  /* GRP_D0 */
d1544 1
a1544 1
  /* GRP_D1 */
d1555 1
a1555 1
  /* GRP_D2 */
d1566 1
a1566 1
  /* GRP_D3 */
d1577 1
a1577 1
  /* GRP_F6 */
d1588 1
a1588 1
  /* GRP_F7 */
d1599 1
a1599 1
  /* GRP_FE */
d1610 1
a1610 1
  /* GRP_FF */
d1621 1
a1621 1
  /* GRP_0F00 */
d1632 1
a1632 1
  /* GRP_0F01 */
d1634 4
a1637 4
    { OPC_EXT_TABLE (OPC_EXT_0F01_REG_0) },
    { OPC_EXT_TABLE (OPC_EXT_0F01_REG_1) },
    { OPC_EXT_TABLE (OPC_EXT_0F01_REG_2) },
    { OPC_EXT_TABLE (OPC_EXT_0F01_REG_3) },
d1641 1
a1641 1
    { OPC_EXT_TABLE (OPC_EXT_0F01_REG_7) },
d1643 1
a1643 1
  /* GRP_0F0E */
d1654 1
a1654 1
  /* GRP_0F18 */
d1656 4
a1659 4
    { OPC_EXT_TABLE (OPC_EXT_0F18_REG_0) },
    { OPC_EXT_TABLE (OPC_EXT_0F18_REG_1) },
    { OPC_EXT_TABLE (OPC_EXT_0F18_REG_2) },
    { OPC_EXT_TABLE (OPC_EXT_0F18_REG_3) },
d1665 1
a1665 1
  /* GRP_0F71 */
d1669 1
a1669 1
    { OPC_EXT_TABLE (OPC_EXT_0F71_REG_2) },
d1671 1
a1671 1
    { OPC_EXT_TABLE (OPC_EXT_0F71_REG_4) },
d1673 1
a1673 1
    { OPC_EXT_TABLE (OPC_EXT_0F71_REG_6) },
d1676 1
a1676 1
  /* GRP_0F72 */
d1680 1
a1680 1
    { OPC_EXT_TABLE (OPC_EXT_0F72_REG_2) },
d1682 1
a1682 1
    { OPC_EXT_TABLE (OPC_EXT_0F72_REG_4) },
d1684 1
a1684 1
    { OPC_EXT_TABLE (OPC_EXT_0F72_REG_6) },
d1687 1
a1687 1
  /* GRP_0F73 */
d1691 2
a1692 2
    { OPC_EXT_TABLE (OPC_EXT_0F73_REG_2) },
    { OPC_EXT_TABLE (OPC_EXT_0F73_REG_3) },
d1695 2
a1696 2
    { OPC_EXT_TABLE (OPC_EXT_0F73_REG_6) },
    { OPC_EXT_TABLE (OPC_EXT_0F73_REG_7) },
d1698 1
a1698 1
  /* GRP_0FA6 */
d1709 1
a1709 1
  /* GRP_0FA7 */
d1720 1
a1720 1
  /* GRP_0FAE */
d1722 8
a1729 8
    { OPC_EXT_TABLE (OPC_EXT_0FAE_REG_0) },
    { OPC_EXT_TABLE (OPC_EXT_0FAE_REG_1) },
    { OPC_EXT_TABLE (OPC_EXT_0FAE_REG_2) },
    { OPC_EXT_TABLE (OPC_EXT_0FAE_REG_3) },
    { "(bad)",	{ XX } },
    { OPC_EXT_TABLE (OPC_EXT_0FAE_REG_5) },
    { OPC_EXT_TABLE (OPC_EXT_0FAE_REG_6) },
    { OPC_EXT_TABLE (OPC_EXT_0FAE_REG_7) },
d1731 1
a1731 1
  /* GRP_0FBA */
d1742 1
a1742 1
  /* GRP_0FC7 */
d1750 2
a1751 2
    { OPC_EXT_TABLE (OPC_EXT_0FC7_REG_6) },
    { OPC_EXT_TABLE (OPC_EXT_0FC7_REG_7) },
d1755 2
a1756 2
static const struct dis386 prefix_user_table[][4] = {
  /* PREGRP_90 */
d1764 1
a1764 1
  /* PREGRP_0F10 */
d1772 1
a1772 1
  /* PREGRP_0F11 */
d1780 1
a1780 1
  /* PREGRP_0F12 */
d1782 1
a1782 1
    { OPC_EXT_TABLE (OPC_EXT_0F12_PREFIX_0) },
d1788 1
a1788 1
  /* PREGRP_0F16 */
d1790 1
a1790 1
    { OPC_EXT_TABLE (OPC_EXT_0F16_PREFIX_0) },
d1796 1
a1796 1
  /* PREGRP_0F2A */
d1804 1
a1804 1
  /* PREGRP_0F2B */
d1812 1
a1812 1
  /* PREGRP_0F2C */
d1820 1
a1820 1
  /* PREGRP_0F2D */
d1828 1
a1828 1
  /* PREGRP_0F2E */
d1836 1
a1836 1
  /* PREGRP_0F2F */
d1844 1
a1844 1
  /* PREGRP_0F51 */
d1852 1
a1852 1
  /* PREGRP_0F52 */
d1860 1
a1860 1
  /* PREGRP_0F53 */
d1868 1
a1868 1
  /* PREGRP_0F58 */
d1876 1
a1876 1
  /* PREGRP_0F59 */
d1884 1
a1884 1
  /* PREGRP_0F5A */
d1892 1
a1892 1
  /* PREGRP_0F5B */
d1900 1
a1900 1
  /* PREGRP_0F5C */
d1908 1
a1908 1
  /* PREGRP_0F5D */
d1916 1
a1916 1
  /* PREGRP_0F5E */
d1924 1
a1924 1
  /* PREGRP_0F5F */
d1932 1
a1932 1
  /* PREGRP_0F60 */
d1940 1
a1940 1
  /* PREGRP_0F61 */
d1948 1
a1948 1
  /* PREGRP_0F62 */
d1956 1
a1956 1
  /* PREGRP_0F6C */
d1964 1
a1964 1
  /* PREGRP_0F6D */
d1972 1
a1972 1
  /* PREGRP_0F6F */
d1980 1
a1980 1
  /* PREGRP_0F70 */
d1988 1
a1988 1
  /* PREGRP_0F78 */
d1996 1
a1996 1
  /* PREGRP_0F79 */
d2004 1
a2004 1
  /* PREGRP_0F7C */
d2012 1
a2012 1
  /* PREGRP_0F7D */
d2020 1
a2020 1
  /* PREGRP_0F7E */
d2028 1
a2028 1
  /* PREGRP_0F7F */
d2036 1
a2036 1
  /* PREGRP_0FB8 */
d2044 1
a2044 1
  /* PREGRP_0FBD */
d2052 1
a2052 1
  /* PREGRP_0FC2 */
d2060 1
a2060 1
  /* PREGRP_0FD0 */
d2068 1
a2068 1
  /* PREGRP_0FD6 */
d2076 1
a2076 1
  /* PREGRP_0FE6 */
d2084 1
a2084 1
  /* PREGRP_0FE7 */
d2092 1
a2092 1
  /* PREGRP_0FF0 */
d2097 1
a2097 1
    { OPC_EXT_TABLE (OPC_EXT_0FF0_PREFIX_3) },
d2100 1
a2100 1
  /* PREGRP_0FF7 */
d2108 1
a2108 1
  /* PREGRP_0F3810 */
d2116 1
a2116 1
  /* PREGRP_0F3814 */
d2124 1
a2124 1
  /* PREGRP_0F3815 */
d2132 1
a2132 1
  /* PREGRP_0F3817 */
d2140 1
a2140 1
  /* PREGRP_0F3820 */
d2148 1
a2148 1
  /* PREGRP_0F3821 */
d2156 1
a2156 1
  /* PREGRP_0F3822 */
d2164 1
a2164 1
  /* PREGRP_0F3823 */
d2172 1
a2172 1
  /* PREGRP_0F3824 */
d2180 1
a2180 1
  /* PREGRP_0F3825 */
d2188 1
a2188 1
  /* PREGRP_0F3828 */
d2196 1
a2196 1
  /* PREGRP_0F3829 */
d2204 1
a2204 1
  /* PREGRP_0F382A */
d2212 1
a2212 1
  /* PREGRP_0F382B */
d2220 1
a2220 1
  /* PREGRP_0F3830 */
d2228 1
a2228 1
  /* PREGRP_0F3831 */
d2236 1
a2236 1
  /* PREGRP_0F3832 */
d2244 1
a2244 1
  /* PREGRP_0F3833 */
d2252 1
a2252 1
  /* PREGRP_0F3834 */
d2260 1
a2260 1
  /* PREGRP_0F3835 */
d2268 1
a2268 1
  /* PREGRP_0F3837 */
d2276 1
a2276 1
  /* PREGRP_0F3838 */
d2284 1
a2284 1
  /* PREGRP_0F3839 */
d2292 1
a2292 1
  /* PREGRP_0F383A */
d2300 1
a2300 1
  /* PREGRP_0F383B */
d2308 1
a2308 1
  /* PREGRP_0F383C */
d2316 1
a2316 1
  /* PREGRP_0F383D */
d2324 1
a2324 1
  /* PREGRP_0F383E */
d2332 1
a2332 1
  /* PREGRP_0F383F */
d2340 1
a2340 1
  /* PREGRP_0F3840 */
d2348 1
a2348 1
  /* PREGRP_0F3841 */
d2356 1
a2356 1
  /* PREGRP_0F38F0 */
d2364 1
a2364 1
  /* PREGRP_0F38F1 */
d2372 1
a2372 1
  /* PREGRP_0F3A08 */
d2380 1
a2380 1
  /* PREGRP_0F3A09 */
d2388 1
a2388 1
  /* PREGRP_0F3A0A */
d2396 1
a2396 1
  /* PREGRP_0F3A0B */
d2404 1
a2404 1
  /* PREGRP_0F3A0C */
d2412 1
a2412 1
  /* PREGRP_0F3A0D */
d2420 1
a2420 1
  /* PREGRP_0F3A0E */
d2428 1
a2428 1
  /* PREGRP_0F3A14 */
d2436 1
a2436 1
  /* PREGRP_0F3A15 */
d2444 1
a2444 1
  /* PREGRP_0F3A16 */
d2452 1
a2452 1
  /* PREGRP_0F3A17 */
d2460 1
a2460 1
  /* PREGRP_0F3A20 */
d2468 1
a2468 1
  /* PREGRP_0F3A21 */
d2476 1
a2476 1
  /* PREGRP_0F3A22 */
d2484 1
a2484 1
  /* PREGRP_0F3A40 */
d2492 1
a2492 1
  /* PREGRP_0F3A41 */
d2500 1
a2500 1
  /* PREGRP_0F3A42 */
d2508 1
a2508 1
  /* PREGRP_0F3A60 */
d2516 1
a2516 1
  /* PREGRP_0F3A61 */
d2524 1
a2524 1
  /* PREGRP_0F3A62 */
d2532 1
a2532 1
  /* PREGRP_0F3A63 */
d2540 1
a2540 1
  /* PREGRP_0F73_REG_3 */
d2548 1
a2548 1
  /* PREGRP_0F73_REG_7 */
d2556 1
a2556 1
  /*PREGRP_0FC7_REG_6 */
d2646 1
a2646 1
    { OPC_EXT_TABLE (OPC_EXT_62_32BIT) },
d2676 1
a2676 1
    { OPC_EXT_TABLE (OPC_EXT_C4_32BIT) },
d2682 1
a2682 1
    { OPC_EXT_TABLE (OPC_EXT_C5_32BIT) },
d3339 1
a3339 1
    { PREGRP (PREGRP_0F3810) },
d3343 2
a3344 2
    { PREGRP (PREGRP_0F3814) },
    { PREGRP (PREGRP_0F3815) },
d3346 1
a3346 1
    { PREGRP (PREGRP_0F3817) },
d3357 6
a3362 6
    { PREGRP (PREGRP_0F3820) },
    { PREGRP (PREGRP_0F3821) },
    { PREGRP (PREGRP_0F3822) },
    { PREGRP (PREGRP_0F3823) },
    { PREGRP (PREGRP_0F3824) },
    { PREGRP (PREGRP_0F3825) },
d3366 4
a3369 4
    { PREGRP (PREGRP_0F3828) },
    { PREGRP (PREGRP_0F3829) },
    { PREGRP (PREGRP_0F382A) },
    { PREGRP (PREGRP_0F382B) },
d3375 6
a3380 6
    { PREGRP (PREGRP_0F3830) },
    { PREGRP (PREGRP_0F3831) },
    { PREGRP (PREGRP_0F3832) },
    { PREGRP (PREGRP_0F3833) },
    { PREGRP (PREGRP_0F3834) },
    { PREGRP (PREGRP_0F3835) },
d3382 1
a3382 1
    { PREGRP (PREGRP_0F3837) },
d3384 8
a3391 8
    { PREGRP (PREGRP_0F3838) },
    { PREGRP (PREGRP_0F3839) },
    { PREGRP (PREGRP_0F383A) },
    { PREGRP (PREGRP_0F383B) },
    { PREGRP (PREGRP_0F383C) },
    { PREGRP (PREGRP_0F383D) },
    { PREGRP (PREGRP_0F383E) },
    { PREGRP (PREGRP_0F383F) },
d3393 2
a3394 2
    { PREGRP (PREGRP_0F3840) },
    { PREGRP (PREGRP_0F3841) },
d3591 2
a3592 2
    { PREGRP (PREGRP_0F38F0) },
    { PREGRP (PREGRP_0F38F1) },
d3621 7
a3627 7
    { PREGRP (PREGRP_0F3A08) },
    { PREGRP (PREGRP_0F3A09) },
    { PREGRP (PREGRP_0F3A0A) },
    { PREGRP (PREGRP_0F3A0B) },
    { PREGRP (PREGRP_0F3A0C) },
    { PREGRP (PREGRP_0F3A0D) },
    { PREGRP (PREGRP_0F3A0E) },
d3634 4
a3637 4
    { PREGRP (PREGRP_0F3A14) },
    { PREGRP (PREGRP_0F3A15) },
    { PREGRP (PREGRP_0F3A16) },
    { PREGRP (PREGRP_0F3A17) },
d3648 3
a3650 3
    { PREGRP (PREGRP_0F3A20) },
    { PREGRP (PREGRP_0F3A21) },
    { PREGRP (PREGRP_0F3A22) },
d3684 3
a3686 3
    { PREGRP (PREGRP_0F3A40) },
    { PREGRP (PREGRP_0F3A41) },
    { PREGRP (PREGRP_0F3A42) },
d3720 4
a3723 4
    { PREGRP (PREGRP_0F3A60) },
    { PREGRP (PREGRP_0F3A61) },
    { PREGRP (PREGRP_0F3A62) },
    { PREGRP (PREGRP_0F3A63) },
d4484 1
a4484 1
static const struct dis386 opc_ext_table[][2] = {
d4486 1
a4486 1
    /* OPC_EXT_8D */
d4491 1
a4491 1
    /* OPC_EXT_0F13 */
d4496 1
a4496 1
    /* OPC_EXT_0F17 */
d4501 1
a4501 1
    /* OPC_EXT_0F20 */
d4506 1
a4506 1
    /* OPC_EXT_0F21 */
d4511 1
a4511 1
    /* OPC_EXT_0F22 */
d4516 1
a4516 1
    /* OPC_EXT_0F23 */
d4521 1
a4521 1
    /* OPC_EXT_0F24 */
d4526 1
a4526 1
    /* OPC_EXT_0F26 */
d4531 1
a4531 1
    /* OPC_EXT_0FB2 */
d4536 1
a4536 1
    /* OPC_EXT_0FB4 */
d4541 1
a4541 1
    /* OPC_EXT_0FB5 */
d4546 1
a4546 1
    /* OPC_EXT_0F01_REG_0 */
d4548 1
a4548 1
    { OPC_EXT_RM_TABLE (OPC_EXT_RM_0F01_REG_0) },
d4551 1
a4551 1
    /* OPC_EXT_0F01_REG_1 */
d4553 1
a4553 1
    { OPC_EXT_RM_TABLE (OPC_EXT_RM_0F01_REG_1) },
d4556 1
a4556 1
    /* OPC_EXT_0F01_REG_2 */
d4561 1
a4561 1
    /* OPC_EXT_0F01_REG_3 */
d4563 1
a4563 1
    { OPC_EXT_RM_TABLE (OPC_EXT_RM_0F01_REG_3) },
d4566 1
a4566 1
    /* OPC_EXT_0F01_REG_7 */
d4568 1
a4568 1
    { OPC_EXT_RM_TABLE (OPC_EXT_RM_0F01_REG_7) },
d4571 1
a4571 1
    /* OPC_EXT_0F18_REG_0 */
d4576 1
a4576 1
    /* OPC_EXT_0F18_REG_1 */
d4581 1
a4581 1
    /* OPC_EXT_0F18_REG_2 */
d4586 1
a4586 1
    /* OPC_EXT_0F18_REG_3 */
d4591 1
a4591 1
    /* OPC_EXT_0F71_REG_2 */
d4596 1
a4596 1
    /* OPC_EXT_0F71_REG_4 */
d4601 1
a4601 1
    /* OPC_EXT_0F71_REG_6 */
d4606 1
a4606 1
    /* OPC_EXT_0F72_REG_2 */
d4611 1
a4611 1
    /* OPC_EXT_0F72_REG_4 */
d4616 1
a4616 1
    /* OPC_EXT_0F72_REG_6 */
d4621 1
a4621 1
    /* OPC_EXT_0F73_REG_2 */
d4626 1
a4626 1
    /* OPC_EXT_0F73_REG_3 */
d4628 1
a4628 1
    { PREGRP (PREGRP_0F73_REG_3) },
d4631 1
a4631 1
    /* OPC_EXT_0F73_REG_6 */
d4636 1
a4636 1
    /* OPC_EXT_0F73_REG_7 */
d4638 1
a4638 1
    { PREGRP (PREGRP_0F73_REG_7) },
d4641 1
a4641 1
    /* OPC_EXT_0FAE_REG_0 */
d4646 1
a4646 1
    /* OPC_EXT_0FAE_REG_1 */
d4651 1
a4651 1
    /* OPC_EXT_0FAE_REG_2 */
d4656 1
a4656 1
    /* OPC_EXT_0FAE_REG_3 */
d4661 1
a4661 1
    /* OPC_EXT_0FAE_REG_5 */
d4663 1
a4663 1
    { OPC_EXT_RM_TABLE (OPC_EXT_RM_0FAE_REG_5) },
d4666 1
a4666 1
    /* OPC_EXT_0FAE_REG_6 */
d4668 1
a4668 1
    { OPC_EXT_RM_TABLE (OPC_EXT_RM_0FAE_REG_6) },
d4671 1
a4671 1
    /* OPC_EXT_0FAE_REG_7 */
d4673 1
a4673 1
    { OPC_EXT_RM_TABLE (OPC_EXT_RM_0FAE_REG_7) },
d4676 2
a4677 2
    /* OPC_EXT_0FC7_REG_6 */
    { PREGRP (PREGRP_0FC7_REG_6) },
d4681 1
a4681 1
    /* OPC_EXT_0FC7_REG_7 */
d4686 1
a4686 1
    /* OPC_EXT_0F12_PREFIX_0 */
d4691 1
a4691 1
    /* OPC_EXT_0F16_PREFIX_0 */
d4696 1
a4696 1
    /* OPC_EXT_0FF0_PREFIX_3 */
d4701 1
a4701 1
    /* OPC_EXT_62_32BIT */
d4706 1
a4706 1
    /* OPC_EXT_C4_32BIT */
d4711 1
a4711 1
    /* OPC_EXT_C5_32BIT */
d4717 1
a4717 1
static const struct dis386 opc_ext_rm_table[][8] = {
d4719 1
a4719 1
    /* OPC_EXT_RM_0F01_REG_0 */
d4730 1
a4730 1
    /* OPC_EXT_RM_0F01_REG_1 */
d4741 1
a4741 1
    /* OPC_EXT_RM_0F01_REG_3 */
d4752 1
a4752 1
    /* OPC_EXT_RM_0F01_REG_7 */
d4763 1
a4763 1
    /* OPC_EXT_RM_0FAE_REG_5 */
d4774 1
a4774 1
    /* OPC_EXT_RM_0FAE_REG_6 */
d4785 1
a4785 1
    /* OPC_EXT_RM_0FAE_REG_7 */
d5053 11
a5063 2
    case USE_GROUPS:
      dp = &grps[dp->op[1].bytemode][modrm.reg];
d5094 1
a5094 1
      dp = &prefix_user_table[dp->op[1].bytemode][index];
a5110 10
    case USE_OPC_EXT_TABLE:
      index = modrm.mod == 0x3 ? 1 : 0;
      dp = &opc_ext_table[dp->op[1].bytemode][index];
      break;

    case USE_OPC_EXT_RM_TABLE:
      index = modrm.rm;
      dp = &opc_ext_rm_table[dp->op[1].bytemode][index];
      break;

@


1.149
log
@2007-09-27  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (dis386): Swap X86_64_27 with OPC_EXT_2.
	(x86_64_table): Likewise.
	(opc_ext_table): Likewise.
@
text
@d437 3
a439 3
#define USE_PREFIX_USER_TABLE 3
#define X86_64_SPECIAL 4
#define IS_3BYTE_OPCODE 5
d445 229
a673 222
#define GRP1a	  NULL, { { NULL, USE_GROUPS }, { NULL,  0 } }
#define GRP1b	  NULL, { { NULL, USE_GROUPS }, { NULL,  1 } }
#define GRP1S	  NULL, { { NULL, USE_GROUPS }, { NULL,  2 } }
#define GRP1Ss	  NULL, { { NULL, USE_GROUPS }, { NULL,  3 } }
#define GRP2b	  NULL, { { NULL, USE_GROUPS }, { NULL,  4 } }
#define GRP2S	  NULL, { { NULL, USE_GROUPS }, { NULL,  5 } }
#define GRP2b_one NULL, { { NULL, USE_GROUPS }, { NULL,  6 } }
#define GRP2S_one NULL, { { NULL, USE_GROUPS }, { NULL,  7 } }
#define GRP2b_cl  NULL, { { NULL, USE_GROUPS }, { NULL,  8 } }
#define GRP2S_cl  NULL, { { NULL, USE_GROUPS }, { NULL,  9 } }
#define GRP3b	  NULL, { { NULL, USE_GROUPS }, { NULL, 10 } }
#define GRP3S	  NULL, { { NULL, USE_GROUPS }, { NULL, 11 } }
#define GRP4	  NULL, { { NULL, USE_GROUPS }, { NULL, 12 } }
#define GRP5	  NULL, { { NULL, USE_GROUPS }, { NULL, 13 } }
#define GRP6	  NULL, { { NULL, USE_GROUPS }, { NULL, 14 } }
#define GRP7	  NULL, { { NULL, USE_GROUPS }, { NULL, 15 } }
#define GRP8	  NULL, { { NULL, USE_GROUPS }, { NULL, 16 } }
#define GRP9	  NULL, { { NULL, USE_GROUPS }, { NULL, 17 } }
#define GRP11_C6  NULL, { { NULL, USE_GROUPS }, { NULL, 18 } }
#define GRP11_C7  NULL, { { NULL, USE_GROUPS }, { NULL, 19 } }
#define GRP12	  NULL, { { NULL, USE_GROUPS }, { NULL, 20 } }
#define GRP13	  NULL, { { NULL, USE_GROUPS }, { NULL, 21 } }
#define GRP14	  NULL, { { NULL, USE_GROUPS }, { NULL, 22 } }
#define GRP15	  NULL, { { NULL, USE_GROUPS }, { NULL, 23 } }
#define GRP16	  NULL, { { NULL, USE_GROUPS }, { NULL, 24 } }
#define GRPAMD	  NULL, { { NULL, USE_GROUPS }, { NULL, 25 } }
#define GRPPADLCK1 NULL, { { NULL, USE_GROUPS }, { NULL, 26 } }
#define GRPPADLCK2 NULL, { { NULL, USE_GROUPS }, { NULL, 27 } }

#define PREGRP0   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  0 } }
#define PREGRP1   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  1 } }
#define PREGRP2   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  2 } }
#define PREGRP3   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  3 } }
#define PREGRP4   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  4 } }
#define PREGRP5   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  5 } }
#define PREGRP6   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  6 } }
#define PREGRP7   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  7 } }
#define PREGRP8   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  8 } }
#define PREGRP9   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  9 } }
#define PREGRP10  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 10 } }
#define PREGRP11  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 11 } }
#define PREGRP12  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 12 } }
#define PREGRP13  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 13 } }
#define PREGRP14  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 14 } }
#define PREGRP15  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 15 } }
#define PREGRP16  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 16 } }
#define PREGRP17  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 17 } }
#define PREGRP18  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 18 } }
#define PREGRP19  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 19 } }
#define PREGRP20  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 20 } }
#define PREGRP21  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 21 } }
#define PREGRP22  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 22 } }
#define PREGRP23  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 23 } }
#define PREGRP24  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 24 } }
#define PREGRP25  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 25 } }
#define PREGRP26  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 26 } }
#define PREGRP27  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 27 } }
#define PREGRP28  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 28 } }
#define PREGRP29  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 29 } }
#define PREGRP30  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 30 } }
#define PREGRP31  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 31 } }
#define PREGRP32  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 32 } }
#define PREGRP33  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 33 } }
#define PREGRP34  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 34 } }
#define PREGRP35  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 35 } }
#define PREGRP36  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 36 } }
#define PREGRP37  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 37 } }
#define PREGRP38  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 38 } }
#define PREGRP39  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 39 } }
#define PREGRP40  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 40 } }
#define PREGRP41  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 41 } }
#define PREGRP42  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 42 } }
#define PREGRP43  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 43 } }
#define PREGRP44  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 44 } }
#define PREGRP45  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 45 } }
#define PREGRP46  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 46 } }
#define PREGRP47  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 47 } }
#define PREGRP48  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 48 } }
#define PREGRP49  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 49 } }
#define PREGRP50  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 50 } }
#define PREGRP51  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 51 } }
#define PREGRP52  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 52 } }
#define PREGRP53  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 53 } }
#define PREGRP54  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 54 } }
#define PREGRP55  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 55 } }
#define PREGRP56  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 56 } }
#define PREGRP57  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 57 } }
#define PREGRP58  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 58 } }
#define PREGRP59  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 59 } }
#define PREGRP60  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 60 } }
#define PREGRP61  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 61 } }
#define PREGRP62  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 62 } }
#define PREGRP63  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 63 } }
#define PREGRP64  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 64 } }
#define PREGRP65  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 65 } }
#define PREGRP66  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 66 } }
#define PREGRP67  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 67 } }
#define PREGRP68  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 68 } }
#define PREGRP69  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 69 } }
#define PREGRP70  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 70 } }
#define PREGRP71  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 71 } }
#define PREGRP72  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 72 } }
#define PREGRP73  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 73 } }
#define PREGRP74  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 74 } }
#define PREGRP75  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 75 } }
#define PREGRP76  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 76 } }
#define PREGRP77  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 77 } }
#define PREGRP78  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 78 } }
#define PREGRP79  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 79 } }
#define PREGRP80  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 80 } }
#define PREGRP81  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 81 } }
#define PREGRP82  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 82 } }
#define PREGRP83  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 83 } }
#define PREGRP84  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 84 } }
#define PREGRP85  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 85 } }
#define PREGRP86  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 86 } }
#define PREGRP87  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 87 } }
#define PREGRP88  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 88 } }
#define PREGRP89  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 89 } }
#define PREGRP90  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 90 } }
#define PREGRP91  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 91 } }
#define PREGRP92  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 92 } }
#define PREGRP93  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 93 } }
#define PREGRP94  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 94 } }
#define PREGRP95  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 95 } }
#define PREGRP96  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 96 } }
#define PREGRP97  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 97 } }
#define PREGRP98  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 98 } }
#define PREGRP99  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 99 } }
#define PREGRP100 NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 100 } }


#define X86_64_0  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 0 } }
#define X86_64_1  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 1 } }
#define X86_64_2  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 2 } }
#define X86_64_3  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 3 } }
#define X86_64_4  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 4 } }
#define X86_64_5  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 5 } }
#define X86_64_6  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 6 } }
#define X86_64_7  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 7 } }
#define X86_64_8  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 8 } }
#define X86_64_9  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 9 } }
#define X86_64_10  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 10 } }
#define X86_64_11  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 11 } }
#define X86_64_12  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 12 } }
#define X86_64_13  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 13 } }
#define X86_64_14  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 14 } }
#define X86_64_15  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 15 } }
#define X86_64_16  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 16 } }
#define X86_64_17  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 17 } }
#define X86_64_18  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 18 } }
#define X86_64_19  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 19 } }
#define X86_64_20  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 20 } }
#define X86_64_21  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 21 } }
#define X86_64_22  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 22 } }
#define X86_64_23  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 23 } }
#define X86_64_24  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 24 } }
#define X86_64_25  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 25 } }
#define X86_64_26  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 26 } }
#define X86_64_27  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 27 } }

#define THREE_BYTE_0 NULL, { { NULL, IS_3BYTE_OPCODE }, { NULL, 0 } }
#define THREE_BYTE_1 NULL, { { NULL, IS_3BYTE_OPCODE }, { NULL, 1 } }
#define THREE_BYTE_SSE5_0F24	NULL, { { NULL, IS_3BYTE_OPCODE }, { NULL, 2 } }
#define THREE_BYTE_SSE5_0F25	NULL, { { NULL, IS_3BYTE_OPCODE }, { NULL, 3 } }
#define THREE_BYTE_SSE5_0F7A	NULL, { { NULL, IS_3BYTE_OPCODE }, { NULL, 4 } }
#define THREE_BYTE_SSE5_0F7B	NULL, { { NULL, IS_3BYTE_OPCODE }, { NULL, 5 } }

#define OPC_EXT_0  NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 0 } }
#define OPC_EXT_1  NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 1 } }
#define OPC_EXT_2  NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 2 } }
#define OPC_EXT_3  NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 3 } }
#define OPC_EXT_4  NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 4 } }
#define OPC_EXT_5  NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 5 } }
#define OPC_EXT_6  NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 6 } }
#define OPC_EXT_7  NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 7 } }
#define OPC_EXT_8  NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 8 } }
#define OPC_EXT_9  NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 9 } }
#define OPC_EXT_10 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 10 } }
#define OPC_EXT_11 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 11 } }
#define OPC_EXT_12 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 12 } }
#define OPC_EXT_13 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 13 } }
#define OPC_EXT_14 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 14 } }
#define OPC_EXT_15 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 15 } }
#define OPC_EXT_16 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 16 } }
#define OPC_EXT_17 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 17 } }
#define OPC_EXT_18 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 18 } }
#define OPC_EXT_19 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 19 } }
#define OPC_EXT_20 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 20 } }
#define OPC_EXT_21 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 21 } }
#define OPC_EXT_22 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 22 } }
#define OPC_EXT_23 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 23 } }
#define OPC_EXT_24 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 24 } }
#define OPC_EXT_25 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 25 } }
#define OPC_EXT_26 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 26 } }
#define OPC_EXT_27 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 27 } }
#define OPC_EXT_28 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 28 } }
#define OPC_EXT_29 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 29 } }
#define OPC_EXT_30 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 30 } }
#define OPC_EXT_31 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 31 } }
#define OPC_EXT_32 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 32 } }
#define OPC_EXT_33 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 33 } }
#define OPC_EXT_34 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 34 } }
#define OPC_EXT_35 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 35 } }
#define OPC_EXT_36 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 36 } }
#define OPC_EXT_37 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 37 } }
#define OPC_EXT_38 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 38 } }
#define OPC_EXT_39 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 39 } }
#define OPC_EXT_40 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 40 } }
#define OPC_EXT_41 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 41 } }
#define OPC_EXT_42 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 42 } }
#define OPC_EXT_43 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 43 } }
#define OPC_EXT_44 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 44 } }
#define OPC_EXT_45 NULL, { { NULL, USE_OPC_EXT_TABLE }, { NULL, 45 } }

#define OPC_EXT_RM_0  NULL, { { NULL, USE_OPC_EXT_RM_TABLE }, { NULL, 0 } }
#define OPC_EXT_RM_1  NULL, { { NULL, USE_OPC_EXT_RM_TABLE }, { NULL, 1 } }
#define OPC_EXT_RM_2  NULL, { { NULL, USE_OPC_EXT_RM_TABLE }, { NULL, 2 } }
#define OPC_EXT_RM_3  NULL, { { NULL, USE_OPC_EXT_RM_TABLE }, { NULL, 3 } }
#define OPC_EXT_RM_4  NULL, { { NULL, USE_OPC_EXT_RM_TABLE }, { NULL, 4 } }
#define OPC_EXT_RM_5  NULL, { { NULL, USE_OPC_EXT_RM_TABLE }, { NULL, 5 } }
#define OPC_EXT_RM_6  NULL, { { NULL, USE_OPC_EXT_RM_TABLE }, { NULL, 6 } }
d732 2
a733 2
  { X86_64_4 },
  { X86_64_5 },
d741 1
a741 1
  { X86_64_6 },
d750 2
a751 2
  { X86_64_7 },
  { X86_64_8 },
d759 2
a760 2
  { X86_64_9 },
  { X86_64_10 },
d769 1
a769 1
  { X86_64_11 },
d778 1
a778 1
  { X86_64_12 },
d787 1
a787 1
  { X86_64_13 },
d796 1
a796 1
  { X86_64_14 },
d834 4
a837 4
  { X86_64_0 },
  { X86_64_1 },
  { X86_64_2 },
  { X86_64_3 },
d848 1
a848 1
  { X86_64_15 },
d850 1
a850 1
  { X86_64_16 },
d870 2
a871 2
  { GRP1b },
  { GRP1S },
d873 1
a873 1
  { GRP1Ss },
d884 1
a884 1
  { OPC_EXT_0 },
d886 1
a886 1
  { GRP1a },
d888 1
a888 1
  { PREGRP38 },
d899 1
a899 1
  { X86_64_17 },
d942 2
a943 2
  { GRP2b },
  { GRP2S },
d946 4
a949 4
  { OPC_EXT_1 },
  { X86_64_27 },
  { GRP11_C6 },
  { GRP11_C7 },
d957 1
a957 1
  { X86_64_18 },
d960 6
a965 6
  { GRP2b_one },
  { GRP2S_one },
  { GRP2b_cl },
  { GRP2S_cl },
  { X86_64_19 },
  { X86_64_20 },
d989 1
a989 1
  { X86_64_21 },
d1002 2
a1003 2
  { GRP3b },
  { GRP3S },
d1011 2
a1012 2
  { GRP4 },
  { GRP5 },
d1017 2
a1018 2
  { GRP6 },
  { GRP7 },
d1031 1
a1031 1
  { GRPAMD },
d1035 4
a1038 4
  { PREGRP8 },
  { PREGRP9 },
  { PREGRP30 },
  { OPC_EXT_34 },
d1041 2
a1042 2
  { PREGRP31 },
  { OPC_EXT_35 },
d1044 1
a1044 1
  { GRP16 },
d1053 7
a1059 7
  { OPC_EXT_40 },
  { OPC_EXT_41 },
  { OPC_EXT_42 },
  { OPC_EXT_43 },
  { OPC_EXT_44 },
  { THREE_BYTE_SSE5_0F25 },
  { OPC_EXT_45 },
d1064 6
a1069 6
  { PREGRP2 },
  { PREGRP33 },
  { PREGRP4 },
  { PREGRP3 },
  { PREGRP93 },
  { PREGRP94 },
d1080 1
a1080 1
  { THREE_BYTE_0 },
d1082 1
a1082 1
  { THREE_BYTE_1 },
d1108 3
a1110 3
  { PREGRP13 },
  { PREGRP12 },
  { PREGRP11 },
d1116 8
a1123 8
  { PREGRP0 },
  { PREGRP10 },
  { PREGRP17 },
  { PREGRP16 },
  { PREGRP14 },
  { PREGRP7 },
  { PREGRP5 },
  { PREGRP6 },
d1125 3
a1127 3
  { PREGRP95 },
  { PREGRP96 },
  { PREGRP97 },
d1138 2
a1139 2
  { PREGRP26 },
  { PREGRP24 },
d1141 1
a1141 1
  { PREGRP19 },
d1143 4
a1146 4
  { PREGRP22 },
  { GRP12 },
  { GRP13 },
  { GRP14 },
d1152 8
a1159 8
  { PREGRP34 },
  { PREGRP35 },
  { THREE_BYTE_SSE5_0F7A },
  { THREE_BYTE_SSE5_0F7B },
  { PREGRP28 },
  { PREGRP29 },
  { PREGRP23 },
  { PREGRP20 },
d1203 2
a1204 2
  { GRPPADLCK2 },
  { GRPPADLCK1 },
d1212 1
a1212 1
  { GRP15 },
d1217 1
a1217 1
  { OPC_EXT_3 },
d1219 2
a1220 2
  { OPC_EXT_4 },
  { OPC_EXT_5 },
d1224 1
a1224 1
  { PREGRP37 },
d1226 1
a1226 1
  { GRP8 },
d1229 1
a1229 1
  { PREGRP36 },
d1235 1
a1235 1
  { PREGRP1 },
d1240 1
a1240 1
  { GRP9 },
d1251 1
a1251 1
  { PREGRP27 },
d1257 1
a1257 1
  { PREGRP21 },
d1275 2
a1276 2
  { PREGRP15 },
  { PREGRP25 },
d1287 1
a1287 1
  { PREGRP32 },
d1294 1
a1294 1
  { PREGRP18 },
d1445 1
a1445 12
  /* GRP1a */
  {
    { "popU",	{ stackEv } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
  },
  /* GRP1b */
d1456 1
a1456 1
  /* GRP1S */
d1467 1
a1467 1
  /* GRP1Ss */
d1478 12
a1489 1
  /* GRP2b */
d1500 1
a1500 1
  /* GRP2S */
d1511 23
a1533 1
  /* GRP2b_one */
d1544 1
a1544 1
  /* GRP2S_one */
d1555 1
a1555 1
  /* GRP2b_cl */
d1566 1
a1566 1
  /* GRP2S_cl */
d1577 1
a1577 1
  /* GRP3b */
d1588 1
a1588 1
  /* GRP3S */
d1599 1
a1599 1
  /* GRP4 */
d1610 1
a1610 1
  /* GRP5 */
d1621 1
a1621 1
  /* GRP6 */
d1632 1
a1632 1
  /* GRP7 */
d1634 4
a1637 4
    { OPC_EXT_6 },
    { OPC_EXT_7 },
    { OPC_EXT_8 },
    { OPC_EXT_39 },
d1641 12
a1652 1
    { OPC_EXT_38 },
d1654 1
a1654 1
  /* GRP8 */
d1656 4
a1663 4
    { "btQ",	{ Ev, Ib } },
    { "btsQ",	{ Ev, Ib } },
    { "btrQ",	{ Ev, Ib } },
    { "btcQ",	{ Ev, Ib } },
d1665 1
a1665 1
  /* GRP9 */
a1667 1
    { "cmpxchg8b", { { CMPXCHG8B_Fixup, q_mode } } },
d1669 1
d1671 1
d1673 1
a1674 2
    { OPC_EXT_9 },
    { OPC_EXT_10 },
d1676 1
a1676 1
  /* GRP11_C6 */
a1677 3
    { "movA",	{ Eb, Ib } },
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
d1680 1
d1682 1
d1684 1
d1687 1
a1687 1
  /* GRP11_C7 */
a1688 1
    { "movQ",	{ Ev, Iv } },
d1691 2
d1695 13
a1707 3
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "(bad)",  { XX } },
d1709 1
a1709 1
  /* GRP12 */
d1711 8
a1718 8
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { OPC_EXT_11 },
    { "(bad)",	{ XX } },
    { OPC_EXT_12 },
    { "(bad)",	{ XX } },
    { OPC_EXT_13 },
    { "(bad)",	{ XX } },
d1720 1
a1720 1
  /* GRP13 */
d1722 8
a1729 8
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { OPC_EXT_14 },
    { "(bad)",	{ XX } },
    { OPC_EXT_15 },
    { "(bad)",	{ XX } },
    { OPC_EXT_16 },
    { "(bad)",	{ XX } },
d1731 1
a1731 1
  /* GRP14 */
a1734 2
    { OPC_EXT_17 },
    { OPC_EXT_18 },
d1737 4
a1740 2
    { OPC_EXT_19 },
    { OPC_EXT_20 },
d1742 1
a1742 1
  /* GRP15 */
a1743 4
    { OPC_EXT_21 },
    { OPC_EXT_22 },
    { OPC_EXT_23 },
    { OPC_EXT_24 },
d1745 1
a1745 10
    { OPC_EXT_25 },
    { OPC_EXT_26 },
    { OPC_EXT_27 },
  },
  /* GRP16 */
  {
    { OPC_EXT_28 },
    { OPC_EXT_29 },
    { OPC_EXT_30 },
    { OPC_EXT_31 },
d1750 2
d1753 4
a1756 1
  /* GRPAMD */
d1758 4
a1761 8
    { "prefetch",	{ Eb } },
    { "prefetchw",	{ Eb } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d1763 2
a1764 1
  /* GRPPADLCK1 */
d1766 4
a1769 8
    { "xstore-rng",	{ { OP_0f07, 0 } } },
    { "xcrypt-ecb",	{ { OP_0f07, 0 } } },
    { "xcrypt-cbc",	{ { OP_0f07, 0 } } },
    { "xcrypt-ctr",	{ { OP_0f07, 0 } } },
    { "xcrypt-cfb",	{ { OP_0f07, 0 } } },
    { "xcrypt-ofb",	{ { OP_0f07, 0 } } },
    { "(bad)",		{ { OP_0f07, 0 } } },
    { "(bad)",		{ { OP_0f07, 0 } } },
d1771 2
a1772 1
  /* GRPPADLCK2 */
d1774 5
a1778 10
    { "montmul",	{ { OP_0f07, 0 } } },
    { "xsha1",		{ { OP_0f07, 0 } } },
    { "xsha256",	{ { OP_0f07, 0 } } },
    { "(bad)",		{ { OP_0f07, 0 } } },
    { "(bad)",		{ { OP_0f07, 0 } } },
    { "(bad)",		{ { OP_0f07, 0 } } },
    { "(bad)",		{ { OP_0f07, 0 } } },
    { "(bad)",		{ { OP_0f07, 0 } } },
  }
};
d1780 1
a1780 2
static const struct dis386 prefix_user_table[][4] = {
  /* PREGRP0 */
d1782 4
a1785 4
    { "addps", { XM, EXx } },
    { "addss", { XM, EXd } },
    { "addpd", { XM, EXx } },
    { "addsd", { XM, EXq } },
d1787 2
a1788 1
  /* PREGRP1 */
d1790 4
a1793 4
    { "", { XM, EXx, OPSIMD } },	/* See OP_SIMD_SUFFIX.  */
    { "", { XM, EXd, OPSIMD } },
    { "", { XM, EXx, OPSIMD } },
    { "", { XM, EXq, OPSIMD } },
d1795 2
a1796 1
  /* PREGRP2 */
d1803 2
a1804 1
  /* PREGRP3 */
d1806 4
a1809 4
    { "cvtps2pi", { MXC, EXq } },
    { "cvtss2siY", { Gv, EXd } },
    { "cvtpd2pi", { MXC, EXx } },
    { "cvtsd2siY", { Gv, EXq } },
d1811 2
a1812 1
  /* PREGRP4 */
d1819 2
a1820 1
  /* PREGRP5 */
d1822 4
a1825 4
    { "divps",	{ XM, EXx } },
    { "divss",	{ XM, EXd } },
    { "divpd",	{ XM, EXx } },
    { "divsd",	{ XM, EXq } },
d1827 2
a1828 1
  /* PREGRP6 */
d1830 4
a1833 4
    { "maxps",	{ XM, EXx } },
    { "maxss",	{ XM, EXd } },
    { "maxpd",	{ XM, EXx } },
    { "maxsd",	{ XM, EXq } },
d1835 2
a1836 1
  /* PREGRP7 */
d1838 4
a1841 4
    { "minps",	{ XM, EXx } },
    { "minss",	{ XM, EXd } },
    { "minpd",	{ XM, EXx } },
    { "minsd",	{ XM, EXq } },
d1843 2
a1844 1
  /* PREGRP8 */
d1846 4
a1849 4
    { "movups",	{ XM, EXx } },
    { "movss",	{ XM, EXd } },
    { "movupd",	{ XM, EXx } },
    { "movsd",	{ XM, EXq } },
d1851 2
a1852 1
  /* PREGRP9 */
d1854 4
a1857 4
    { "movups",	{ EXx,  XM } },
    { "movss",	{ EXd,  XM } },
    { "movupd",	{ EXx,  XM } },
    { "movsd",	{ EXq,  XM } },
d1859 2
a1860 8
  /* PREGRP10 */
  {
    { "mulps",	{ XM, EXx } },
    { "mulss",	{ XM, EXd } },
    { "mulpd",	{ XM, EXx } },
    { "mulsd",	{ XM, EXq } },
  },
  /* PREGRP11 */
d1867 2
a1868 1
  /* PREGRP12 */
d1870 4
a1873 4
    { "rsqrtps",{ XM, EXx } },
    { "rsqrtss",{ XM, EXd } },
    { "(bad)",	{ XM, EXx } },
    { "(bad)",	{ XM, EXx } },
d1875 2
a1876 1
  /* PREGRP13 */
d1878 4
a1881 4
    { "sqrtps", { XM, EXx } },
    { "sqrtss", { XM, EXd } },
    { "sqrtpd", { XM, EXx } },
    { "sqrtsd",	{ XM, EXq } },
d1883 2
a1884 1
  /* PREGRP14 */
d1886 4
a1889 4
    { "subps",	{ XM, EXx } },
    { "subss",	{ XM, EXd } },
    { "subpd",	{ XM, EXx } },
    { "subsd",	{ XM, EXq } },
d1891 2
a1892 8
  /* PREGRP15 */
  {
    { "(bad)",	{ XM, EXx } },
    { "cvtdq2pd", { XM, EXq } },
    { "cvttpd2dq", { XM, EXx } },
    { "cvtpd2dq", { XM, EXx } },
  },
  /* PREGRP16 */
d1899 2
a1900 1
  /* PREGRP17 */
d1902 4
a1905 4
    { "cvtps2pd", { XM, EXq } },
    { "cvtss2sd", { XM, EXd } },
    { "cvtpd2ps", { XM, EXx } },
    { "cvtsd2ss", { XM, EXq } },
d1907 2
a1908 1
  /* PREGRP18 */
d1910 4
a1913 4
    { "maskmovq", { MX, MS } },
    { "(bad)",	{ XM, EXx } },
    { "maskmovdqu", { XM, XS } },
    { "(bad)",	{ XM, EXx } },
d1915 2
a1916 1
  /* PREGRP19 */
d1918 4
a1921 4
    { "movq",	{ MX, EM } },
    { "movdqu",	{ XM, EXx } },
    { "movdqa",	{ XM, EXx } },
    { "(bad)",	{ XM, EXx } },
d1923 2
a1924 1
  /* PREGRP20 */
d1926 4
a1929 4
    { "movq",	{ EM, MX } },
    { "movdqu",	{ EXx,  XM } },
    { "movdqa",	{ EXx,  XM } },
    { "(bad)",	{ EXx,  XM } },
d1931 2
a1932 1
  /* PREGRP21 */
d1934 4
a1937 4
    { "(bad)",	{ EXx,  XM } },
    { "movq2dq",{ XM, MS } },
    { "movq",	{ EXq, XM } },
    { "movdq2q",{ MX, XS } },
d1939 2
a1940 1
  /* PREGRP22 */
d1942 4
a1945 4
    { "pshufw",	{ MX, EM, Ib } },
    { "pshufhw",{ XM, EXx, Ib } },
    { "pshufd",	{ XM, EXx, Ib } },
    { "pshuflw",{ XM, EXx, Ib } },
d1947 2
a1948 1
  /* PREGRP23 */
d1950 4
a1953 4
    { "movK",	{ Edq, MX } },
    { "movq",	{ XM, EXq } },
    { "movK",	{ Edq, XM } },
    { "(bad)",	{ Ed, XM } },
d1955 2
a1956 1
  /* PREGRP24 */
d1960 1
a1960 1
    { "punpckhqdq", { XM, EXx } },
d1963 2
a1964 8
  /* PREGRP25 */
  {
    { "movntq",	{ EM, MX } },
    { "(bad)",	{ EM, XM } },
    { "movntdq",{ EM, XM } },
    { "(bad)",	{ EM, XM } },
  },
  /* PREGRP26 */
d1968 1
a1968 1
    { "punpcklqdq", { XM, EXx } },
d1971 2
a1972 1
  /* PREGRP27 */
d1974 3
a1976 1
    { "(bad)",	{ MX, EXx } },
a1977 2
    { "addsubpd", { XM, EXx } },
    { "addsubps", { XM, EXx } },
d1979 26
a2004 1
  /* PREGRP28 */
d2011 2
a2012 1
  /* PREGRP29 */
d2019 18
a2036 1
  /* PREGRP30 */
d2038 4
a2041 4
    { OPC_EXT_36 },
    { "movsldup", { XM, EXx } },
    { "movlpd",	{ XM, EXq } },
    { "movddup", { XM, EXq } },
d2043 2
a2044 1
  /* PREGRP31 */
d2046 4
a2049 4
    { OPC_EXT_37 },
    { "movshdup", { XM, EXx } },
    { "movhpd",	{ XM, EXq } },
    { "(bad)",	{ XM, EXq } },
d2051 2
a2052 1
  /* PREGRP32 */
d2054 4
a2057 4
    { "(bad)",	{ XM, EXx } },
    { "(bad)",	{ XM, EXx } },
    { "(bad)",	{ XM, EXx } },
    { OPC_EXT_32 },
d2059 2
a2060 1
  /* PREGRP33 */
d2062 4
a2065 4
    {"movntps", { Ev, XM } },
    {"movntss", { Ed, XM } },
    {"movntpd", { Ev, XM } },
    {"movntsd", { Eq, XM } },
d2068 1
a2068 1
  /* PREGRP34 */
d2070 4
a2073 4
    {"vmread",	{ Em, Gm } },
    {"(bad)",	{ XX } },
    {"extrq",	{ XS, Ib, Ib } },
    {"insertq",	{ XM, XS, Ib, Ib } },
d2076 1
a2076 1
 /* PREGRP35 */
d2078 4
a2081 4
    {"vmwrite",	{ Gm, Em } },
    {"(bad)",	{ XX } },
    {"extrq",	{ XM, XS } },
    {"insertq",	{ XM, XS } },
d2084 1
a2084 1
  /* PREGRP36 */
d2086 4
a2089 4
    { "bsrS",	{ Gv, Ev } },
    { "lzcntS",	{ Gv, Ev } },
    { "bsrS",	{ Gv, Ev } },
    { "(bad)",	{ XX } },
d2092 1
a2092 1
  /* PREGRP37 */
d2094 4
a2097 4
    { "(bad)", { XX } },
    { "popcntS", { Gv, Ev } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2100 1
a2100 1
  /* PREGRP38 */
d2102 4
a2105 4
    { "xchgS", { { NOP_Fixup1, eAX_reg }, { NOP_Fixup2, eAX_reg } } },
    { "pause", { XX } },
    { "xchgS", { { NOP_Fixup1, eAX_reg }, { NOP_Fixup2, eAX_reg } } },
    { "(bad)", { XX } },
d2108 1
a2108 1
  /* PREGRP39 */
d2116 1
a2116 1
  /* PREGRP40 */
d2124 1
a2124 1
  /* PREGRP41 */
d2132 1
a2132 1
  /* PREGRP42 */
d2140 1
a2140 1
  /* PREGRP43 */
d2148 1
a2148 1
  /* PREGRP44 */
d2156 1
a2156 1
  /* PREGRP45 */
d2164 1
a2164 1
  /* PREGRP46 */
d2172 1
a2172 1
  /* PREGRP47 */
d2180 1
a2180 1
  /* PREGRP48 */
d2188 1
a2188 1
  /* PREGRP49 */
d2196 1
a2196 1
  /* PREGRP50 */
d2204 1
a2204 1
  /* PREGRP51 */
d2212 1
a2212 1
  /* PREGRP52 */
d2220 1
a2220 1
  /* PREGRP53 */
d2228 1
a2228 1
  /* PREGRP54 */
d2236 1
a2236 1
  /* PREGRP55 */
d2244 1
a2244 1
  /* PREGRP56 */
d2252 1
a2252 1
  /* PREGRP57 */
d2260 1
a2260 1
  /* PREGRP58 */
d2268 9
a2276 1
  /* PREGRP59 */
d2284 1
a2284 1
  /* PREGRP60 */
d2292 1
a2292 1
  /* PREGRP61 */
d2300 1
a2300 1
  /* PREGRP62 */
d2308 1
a2308 1
  /* PREGRP63 */
d2316 1
a2316 1
  /* PREGRP64 */
d2324 1
a2324 1
  /* PREGRP65 */
d2332 1
a2332 1
  /* PREGRP66 */
d2340 1
a2340 1
  /* PREGRP67 */
d2348 1
a2348 1
  /* PREGRP68 */
d2356 17
a2372 1
  /* PREGRP69 */
d2380 1
a2380 1
  /* PREGRP70 */
d2388 1
a2388 1
  /* PREGRP71 */
d2396 1
a2396 1
  /* PREGRP72 */
d2404 1
a2404 1
  /* PREGRP73 */
d2412 1
a2412 1
  /* PREGRP74 */
d2420 1
a2420 1
  /* PREGRP75 */
d2428 1
a2428 1
  /* PREGRP76 */
d2436 1
a2436 1
  /* PREGRP77 */
d2444 1
a2444 1
  /* PREGRP78 */
d2452 1
a2452 1
  /* PREGRP79 */
d2460 1
a2460 1
  /* PREGRP80 */
d2468 1
a2468 1
  /* PREGRP81 */
d2476 1
a2476 1
  /* PREGRP82 */
d2484 1
a2484 1
  /* PREGRP83 */
d2492 1
a2492 1
  /* PREGRP84 */
d2500 1
a2500 1
  /* PREGRP85 */
d2508 1
a2508 1
  /* PREGRP86 */
d2512 1
a2512 1
    { "pcmpgtq", { XM, EXx } },
d2516 1
a2516 1
  /* PREGRP87 */
d2520 1
a2521 1
    { "crc32",	{ Gdq, { CRC32_Fixup, b_mode } } },	
d2524 1
a2524 1
  /* PREGRP88 */
d2528 1
a2529 1
    { "crc32",	{ Gdq, { CRC32_Fixup, v_mode } } },	
d2532 1
a2532 1
  /* PREGRP89 */
d2536 1
a2536 1
    { "pcmpestrm", { XM, EXx, Ib } },
d2540 1
a2540 1
  /* PREGRP90 */
d2544 1
a2544 1
    { "pcmpestri", { XM, EXx, Ib } },
d2548 1
a2548 1
  /* PREGRP91 */
d2552 1
a2552 1
    { "pcmpistrm", { XM, EXx, Ib } },
d2556 1
a2556 1
  /* PREGRP92 */
d2558 3
a2560 3
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "pcmpistri", { XM, EXx, Ib } },
d2563 1
d2565 2
a2566 1
  /* PREGRP93 */
d2568 2
a2569 4
    { "ucomiss",{ XM, EXd } }, 
    { "(bad)",	{ XX } },
    { "ucomisd",{ XM, EXq } }, 
    { "(bad)",	{ XX } },
d2572 1
a2572 1
  /* PREGRP94 */
d2574 2
a2575 4
    { "comiss",	{ XM, EXd } },
    { "(bad)",	{ XX } },
    { "comisd",	{ XM, EXq } },
    { "(bad)",	{ XX } },
d2578 1
a2578 1
  /* PREGRP95 */
d2580 2
a2581 4
    { "punpcklbw",{ MX, EMd } },
    { "(bad)",	{ XX } },
    { "punpcklbw",{ MX, EMx } },
    { "(bad)",	{ XX } },
d2584 1
a2584 1
  /* PREGRP96 */
d2586 2
a2587 4
    { "punpcklwd",{ MX, EMd } },
    { "(bad)",	{ XX } },
    { "punpcklwd",{ MX, EMx } },
    { "(bad)",	{ XX } },
d2590 1
a2590 1
  /* PREGRP97 */
d2592 2
a2593 4
    { "punpckldq",{ MX, EMd } },
    { "(bad)",	{ XX } },
    { "punpckldq",{ MX, EMx } },
    { "(bad)",	{ XX } },
d2596 1
a2596 1
  /* PREGRP98 */
d2598 1
a2598 27
    { "vmptrld",{ Mq } },
    { "vmxon",	{ Mq } },
    { "vmclear",{ Mq } },
    { "(bad)",	{ XX } },
  },

  /* PREGRP99 */
  {
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "psrldq",	{ MS, Ib } },
    { "(bad)",	{ XX } },
  },

  /* PREGRP100 */
  {
    { "(bad)",	{ XX } },
    { "(bad)",	{ XX } },
    { "pslldq",	{ MS, Ib } },
    { "(bad)",	{ XX } },
  },
};

static const struct dis386 x86_64_table[][2] = {
  /* X86_64_0 */
  {
    { "pusha{P|}", { XX } },
d2602 1
a2602 1
  /* X86_64_1 */
d2604 1
a2604 1
    { "popa{P|}", { XX } },
d2608 1
a2608 1
  /* X86_64_2 */
d2610 1
a2610 1
    { OPC_EXT_33 },
d2614 1
a2614 1
  /* X86_64_3 */
d2616 1
a2616 7
    { "arpl", { Ew, Gw } },
    { "movs{lq|xd}", { Gv, Ed } },
  },

  /* X86_64_4 */
  {
    { "push{T|}", { es } },
d2620 1
a2620 1
  /* X86_64_5 */
d2622 1
a2622 1
    { "pop{T|}", { es } },
d2626 1
a2626 1
  /* X86_64_6 */
d2628 1
a2628 1
    { "push{T|}", { cs } },
d2632 1
a2632 1
  /* X86_64_7 */
d2634 1
a2634 1
    { "push{T|}", { ss } },
d2638 1
a2638 1
  /* X86_64_8 */
d2640 1
a2640 1
    { "pop{T|}", { ss } },
d2644 1
a2644 1
  /* X86_64_9 */
d2646 1
a2646 1
    { "push{T|}", { ds } },
d2650 1
a2650 1
  /* X86_64_10 */
d2652 2
a2653 2
    { "pop{T|}", { ds } },
    { "(bad)", { XX } },
d2656 1
a2656 1
  /* X86_64_11 */
d2658 2
a2659 2
    { "daa", { XX } },
    { "(bad)", { XX } },
d2662 1
a2662 1
  /* X86_64_12 */
d2664 2
a2665 2
    { "das", { XX } },
    { "(bad)", { XX } },
d2668 1
a2668 1
  /* X86_64_13 */
d2670 1
a2670 1
    { "aaa", { XX } },
d2674 1
a2674 1
  /* X86_64_14 */
d2676 1
a2676 1
    { "aas", { XX } },
d2680 1
a2680 13
  /* X86_64_15 */
  {
    { "ins{R|}", { Yzr, indirDX } },
    { "ins{G|}", { Yzr, indirDX } },
  },

  /* X86_64_16 */
  {
    { "outs{R|}", { indirDXr, Xz } },
    { "outs{G|}", { indirDXr, Xz } },
  },

  /* X86_64_17 */
d2682 1
a2682 1
    { "Jcall{T|}", { Ap } },
d2686 1
a2686 1
  /* X86_64_18 */
d2692 1
a2692 1
  /* X86_64_19 */
d2698 1
a2698 1
  /* X86_64_20 */
d2704 1
a2704 1
  /* X86_64_21 */
d2710 1
a2710 1
  /* X86_64_22 */
d2716 1
a2716 1
  /* X86_64_23 */
d2722 1
a2722 1
  /* X86_64_24 */
d2728 1
a2728 1
  /* X86_64_25 */
a2732 12

  /* X86_64_26 */
  {
    { "lesS", { Gv, Mp } },
    { "(bad)", { XX } },
  },

  /* X86_64_27 */
  {
    { OPC_EXT_2 },
    { "(bad)", { XX } },
  },
d2736 1
a2736 1
  /* THREE_BYTE_0 */
d2739 8
a2746 8
    { "pshufb", { MX, EM } },
    { "phaddw", { MX, EM } },
    { "phaddd",	{ MX, EM } },
    { "phaddsw", { MX, EM } },
    { "pmaddubsw", { MX, EM } },
    { "phsubw", { MX, EM } },
    { "phsubd", { MX, EM } },
    { "phsubsw", { MX, EM } },
d2748 8
a2755 8
    { "psignb", { MX, EM } },
    { "psignw", { MX, EM } },
    { "psignd", { MX, EM } },
    { "pmulhrsw", { MX, EM } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2757 8
a2764 8
    { PREGRP39 },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { PREGRP40 },
    { PREGRP41 },
    { "(bad)", { XX } },
    { PREGRP42 },
d2766 8
a2773 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "pabsb", { MX, EM } },
    { "pabsw", { MX, EM } },
    { "pabsd", { MX, EM } },
    { "(bad)", { XX } },
d2775 8
a2782 8
    { PREGRP43 },
    { PREGRP44 },
    { PREGRP45 },
    { PREGRP46 },
    { PREGRP47 },
    { PREGRP48 },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2784 8
a2791 8
    { PREGRP49 },
    { PREGRP50 },
    { PREGRP51 },
    { PREGRP52 },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2793 8
a2800 8
    { PREGRP53 },
    { PREGRP54 },
    { PREGRP55 },
    { PREGRP56 },
    { PREGRP57 },
    { PREGRP58 },
    { "(bad)", { XX } },
    { PREGRP86 },
d2802 8
a2809 8
    { PREGRP59 },
    { PREGRP60 },
    { PREGRP61 },
    { PREGRP62 },
    { PREGRP63 },
    { PREGRP64 },
    { PREGRP65 },
    { PREGRP66 },
d2811 8
a2818 8
    { PREGRP67 },
    { PREGRP68 },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2820 8
a2827 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2829 8
a2836 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2838 8
a2845 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2847 8
a2854 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2856 8
a2863 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2865 8
a2872 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2874 8
a2881 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2883 8
a2890 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2892 8
a2899 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2901 8
a2908 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2910 8
a2917 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2919 8
a2926 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2928 8
a2935 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2937 8
a2944 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2946 8
a2953 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2955 8
a2962 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2964 8
a2971 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2973 8
a2980 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2982 8
a2989 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2991 8
a2998 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3000 8
a3007 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3009 8
a3016 8
    { PREGRP87 },
    { PREGRP88 },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3018 8
a3025 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3027 1
a3027 1
  /* THREE_BYTE_1 */
d3030 8
a3037 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3039 8
a3046 8
    { PREGRP69 },
    { PREGRP70 },
    { PREGRP71 },
    { PREGRP72 },
    { PREGRP73 },
    { PREGRP74 },
    { PREGRP75 },
    { "palignr", { MX, EM, Ib } },
d3048 8
a3055 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { PREGRP76 },
    { PREGRP77 },
    { PREGRP78 },
    { PREGRP79 },
d3057 8
a3064 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3066 8
a3073 8
    { PREGRP80 },
    { PREGRP81 },
    { PREGRP82 },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3075 8
a3082 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3084 8
a3091 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3093 8
a3100 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3102 8
a3109 8
    { PREGRP83 },
    { PREGRP84 },
    { PREGRP85 },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3111 8
a3118 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3120 8
a3127 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3129 8
a3136 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3138 299
a3436 8
    { PREGRP89 },
    { PREGRP90 },
    { PREGRP91 },
    { PREGRP92 },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3591 2
a3592 2
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3609 1
a3609 1
  /* THREE_BYTE_SSE5_0F24 */
d3612 17
a3628 17
    { "fmaddps",	{ { OP_DREX4, q_mode } } },
    { "fmaddpd",	{ { OP_DREX4, q_mode } } },
    { "fmaddss",	{ { OP_DREX4, w_mode } } },
    { "fmaddsd",	{ { OP_DREX4, d_mode } } },
    { "fmaddps",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fmaddpd",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fmaddss",	{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "fmaddsd",	{ { OP_DREX4, DREX_OC1 + d_mode } } },
    /* 08 */
    { "fmsubps",	{ { OP_DREX4, q_mode } } },
    { "fmsubpd",	{ { OP_DREX4, q_mode } } },
    { "fmsubss",	{ { OP_DREX4, w_mode } } },
    { "fmsubsd",	{ { OP_DREX4, d_mode } } },
    { "fmsubps",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fmsubpd",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fmsubss",	{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "fmsubsd",	{ { OP_DREX4, DREX_OC1 + d_mode } } },
d3630 8
a3637 8
    { "fnmaddps",	{ { OP_DREX4, q_mode } } },
    { "fnmaddpd",	{ { OP_DREX4, q_mode } } },
    { "fnmaddss",	{ { OP_DREX4, w_mode } } },
    { "fnmaddsd",	{ { OP_DREX4, d_mode } } },
    { "fnmaddps",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fnmaddpd",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fnmaddss",	{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "fnmaddsd",	{ { OP_DREX4, DREX_OC1 + d_mode } } },
d3639 8
a3646 8
    { "fnmsubps",	{ { OP_DREX4, q_mode } } },
    { "fnmsubpd",	{ { OP_DREX4, q_mode } } },
    { "fnmsubss",	{ { OP_DREX4, w_mode } } },
    { "fnmsubsd",	{ { OP_DREX4, d_mode } } },
    { "fnmsubps",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fnmsubpd",	{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "fnmsubss",	{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "fnmsubsd",	{ { OP_DREX4, DREX_OC1 + d_mode } } },
d3648 8
a3655 8
    { "permps",		{ { OP_DREX4, q_mode } } },
    { "permpd",		{ { OP_DREX4, q_mode } } },
    { "pcmov",		{ { OP_DREX4, q_mode } } },
    { "pperm",		{ { OP_DREX4, q_mode } } },
    { "permps",		{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "permpd",		{ { OP_DREX4, DREX_OC1 + q_mode } } },
    { "pcmov",		{ { OP_DREX4, DREX_OC1 + w_mode } } },
    { "pperm",		{ { OP_DREX4, DREX_OC1 + d_mode } } },
d3657 8
a3664 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3666 8
a3673 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3675 8
a3682 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3684 8
a3691 8
    { "protb",		{ { OP_DREX3, q_mode } } },
    { "protw",		{ { OP_DREX3, q_mode } } },
    { "protd",		{ { OP_DREX3, q_mode } } },
    { "protq",		{ { OP_DREX3, q_mode } } },
    { "pshlb",		{ { OP_DREX3, q_mode } } },
    { "pshlw",		{ { OP_DREX3, q_mode } } },
    { "pshld",		{ { OP_DREX3, q_mode } } },
    { "pshlq",		{ { OP_DREX3, q_mode } } },
d3693 8
a3700 8
    { "pshab",		{ { OP_DREX3, q_mode } } },
    { "pshaw",		{ { OP_DREX3, q_mode } } },
    { "pshad",		{ { OP_DREX3, q_mode } } },
    { "pshaq",		{ { OP_DREX3, q_mode } } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3702 8
a3709 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3711 8
a3718 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3720 8
a3727 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3729 8
a3736 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3738 8
a3745 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3747 8
a3754 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3756 8
a3763 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pmacssww",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacsswd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacssdql",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
d3765 17
a3781 17
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pmacssdd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacssdqh",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    /* 90 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pmacsww",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacswd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacsdql",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
d3783 8
a3790 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pmacsdd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "pmacsdqh",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
d3792 8
a3799 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pmadcsswd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "(bad)",		{ XX } },
d3801 8
a3808 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3810 8
a3817 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pmadcswd",	{ { OP_DREX4, DREX_OC1 + DREX_NO_OC0 + q_mode } } },
    { "(bad)",		{ XX } },
d3819 8
a3826 299
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* c0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* c8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* d0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* d8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* e0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* e8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* f0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* f8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
  },
  /* THREE_BYTE_SSE5_0F25 */
  {
    /* 00 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 08 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 10 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 18 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 20 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 28 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "comps",		{ { OP_DREX3, q_mode }, { OP_DREX_FCMP, b_mode } } },
    { "compd",		{ { OP_DREX3, q_mode }, { OP_DREX_FCMP, b_mode } } },
    { "comss",		{ { OP_DREX3, w_mode }, { OP_DREX_FCMP, b_mode } } },
    { "comsd",		{ { OP_DREX3, d_mode }, { OP_DREX_FCMP, b_mode } } },
    /* 30 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 38 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 40 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 48 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pcomb",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomw",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomd",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomq",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    /* 50 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 58 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 60 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 68 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "pcomub",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomuw",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomud",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    { "pcomuq",		{ { OP_DREX3, q_mode }, { OP_DREX_ICMP, b_mode } } },
    /* 70 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 78 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 80 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 88 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 90 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* 98 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* a0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* a8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* b0 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    /* b8 */
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3828 8
a3835 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3837 8
a3844 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3846 8
a3853 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3855 8
a3862 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3864 8
a3871 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3873 8
a3880 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3882 8
a3889 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d3891 8
a3898 8
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d4486 1
a4486 1
    /* OPC_EXT_0 */
d4491 2
a4492 2
    /* OPC_EXT_1 */
    { X86_64_26 },
d4496 2
a4497 2
    /* OPC_EXT_2 */
    { "ldsS",		{ Gv, Mp } },
d4501 1
a4501 2
    /* OPC_EXT_3 */
    { "lssS",		{ Gv, Mp } },
d4503 1
d4506 1
a4506 2
    /* OPC_EXT_4 */
    { "lfsS",		{ Gv, Mp } },
d4508 1
d4511 1
a4511 2
    /* OPC_EXT_5 */
    { "lgsS",		{ Gv, Mp } },
d4513 1
d4516 3
a4518 3
    /* OPC_EXT_6 */
    { X86_64_22 },
    { OPC_EXT_RM_0 },
d4521 3
a4523 3
    /* OPC_EXT_7 */
    { X86_64_23 },
    { OPC_EXT_RM_1 },
d4526 1
a4526 2
    /* OPC_EXT_8 */
    { X86_64_24 },
d4528 1
d4531 2
a4532 2
    /* OPC_EXT_9 */
    { PREGRP98 },
d4536 2
a4537 2
    /* OPC_EXT_10 */
    { "vmptrst",	{ Mq } },
d4541 2
a4542 1
    /* OPC_EXT_11 */
a4543 1
    { "psrlw",		{ MS, Ib } },
d4546 12
a4557 1
    /* OPC_EXT_12 */
a4558 1
    { "psraw",		{ MS, Ib } },
d4561 12
a4572 1
    /* OPC_EXT_13 */
a4573 1
    { "psllw",		{ MS, Ib } },
d4576 2
a4577 1
    /* OPC_EXT_14 */
a4578 1
    { "psrld",		{ MS, Ib } },
d4581 2
a4582 1
    /* OPC_EXT_15 */
a4583 1
    { "psrad",		{ MS, Ib } },
d4586 2
a4587 1
    /* OPC_EXT_16 */
a4588 1
    { "pslld",		{ MS, Ib } },
d4591 1
a4591 1
    /* OPC_EXT_17 */
d4593 1
a4593 1
    { "psrlq",		{ MS, Ib } },
d4596 1
a4596 1
    /* OPC_EXT_18 */
d4598 1
a4598 1
    { PREGRP99 },
d4601 1
a4601 1
    /* OPC_EXT_19 */
d4603 1
a4603 1
    { "psllq",		{ MS, Ib } },
d4606 1
a4606 1
    /* OPC_EXT_20 */
d4608 1
a4608 1
    { PREGRP100 },
d4611 1
a4611 2
    /* OPC_EXT_21 */
    { "fxsave",		{ M } },
d4613 1
d4616 1
a4616 2
    /* OPC_EXT_22 */
    { "fxrstor",	{ M } },
d4618 1
d4621 1
a4621 2
    /* OPC_EXT_23 */
    { "ldmxcsr",	{ Md } },
d4623 1
d4626 1
a4626 2
    /* OPC_EXT_24 */
    { "stmxcsr",	{ Md } },
d4628 1
d4631 1
a4631 1
    /* OPC_EXT_25 */
d4633 1
a4633 1
    { OPC_EXT_RM_2 },
d4636 1
a4636 1
    /* OPC_EXT_26 */
d4638 1
a4638 1
    { OPC_EXT_RM_3 },
d4641 3
a4643 3
    /* OPC_EXT_27 */
    { "clflush",	{ Mb } },
    { OPC_EXT_RM_4 },
d4646 2
a4647 2
    /* OPC_EXT_28 */
    { "prefetchnta",	{ Mb } },
d4651 2
a4652 2
    /* OPC_EXT_29 */
    { "prefetcht0",	{ Mb } },
d4656 2
a4657 2
    /* OPC_EXT_30 */
    { "prefetcht1",	{ Mb } },
d4661 1
a4661 2
    /* OPC_EXT_31 */
    { "prefetcht2",	{ Mb } },
d4663 1
d4666 1
a4666 2
    /* OPC_EXT_32 */
    { "lddqu",		{ XM, M } },
d4668 1
d4671 3
a4673 3
    /* OPC_EXT_33 */
    { "bound{S|}",	{ Gv, Ma } },
    { "(bad)",		{ XX } },
d4676 2
a4677 2
    /* OPC_EXT_34 */
    { "movlpX",		{ EXq, XM } },
d4681 2
a4682 2
    /* OPC_EXT_35 */
    { "movhpX",		{ EXq, XM } },
d4686 1
a4686 1
    /* OPC_EXT_36 */
d4691 1
a4691 1
    /* OPC_EXT_37 */
d4696 2
a4697 11
    /* OPC_EXT_38 */
    { "invlpg",		{ Mb } },
    { OPC_EXT_RM_5 },
  },
  {
    /* OPC_EXT_39 */
    { X86_64_25 },
    { OPC_EXT_RM_6 },
  },
  {
    /* OPC_EXT_40 */
a4698 1
    { "movZ",		{ Rm, Cm } },
d4701 2
a4702 1
    /* OPC_EXT_41 */
a4703 1
    { "movZ",		{ Rm, Dm } },
d4706 2
a4707 1
    /* OPC_EXT_42 */
a4708 1
    { "movZ",		{ Cm, Rm } },
d4711 2
a4712 1
    /* OPC_EXT_43 */
a4713 11
    { "movZ",		{ Dm, Rm } },
  },
  {
    /* OPC_EXT_44 */
    { THREE_BYTE_SSE5_0F24 },
    { "movL",		{ Rd, Td } },
  },
  {
    /* OPC_EXT_45 */
    { "(bad)",		{ XX } },
    { "movL",		{ Td, Rd } },
d4719 1
a4719 1
    /* OPC_EXT_RM_0 */
d4730 1
a4730 1
    /* OPC_EXT_RM_1 */
d4741 14
a4754 3
    /* OPC_EXT_RM_2 */
    { "lfence",		{ Skip_MODRM } },
    { "(bad)",		{ XX } },
d4763 2
a4764 2
    /* OPC_EXT_RM_3 */
    { "mfence",		{ Skip_MODRM } },
d4774 2
a4775 2
    /* OPC_EXT_RM_4 */
    { "sfence",		{ Skip_MODRM } },
d4785 3
a4787 3
    /* OPC_EXT_RM_5 */
    { "swapgs",		{ Skip_MODRM } },
    { "rdtscp",		{ Skip_MODRM } },
a4794 11
  {
    /* OPC_EXT_RM_6 */
    { "vmrun",		{ Skip_MODRM } },
    { "vmmcall",	{ Skip_MODRM } },
    { "vmload",		{ Skip_MODRM } },
    { "vmsave",		{ Skip_MODRM } },
    { "stgi",		{ Skip_MODRM } },
    { "clgi",		{ Skip_MODRM } },
    { "skinit",		{ Skip_MODRM } },
    { "invlpga",	{ Skip_MODRM } },
  },
d5057 1
a5057 1
    case USE_PREFIX_USER_TABLE:
d5088 1
a5088 1
    case X86_64_SPECIAL:
d5093 1
a5093 1
    case IS_3BYTE_OPCODE:
@


1.148
log
@gas/testsuite/gas/

2007-09-27  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/5072
	* gas/i386/i386.exp: Run x86-64-opcode-inval and
	x86-64-opcode-inval-intel.

	* gas/i386/x86-64-opcode-inval-intel.d: New.
	* gas/i386/x86-64-opcode-inval.d: Likewise.
	* gas/i386/x86-64-opcode-inval.s: Likewise.

opcodes/

2007-09-27  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/5072
	* i386-dis.c: Update comments on '{', '}' and '|' to support
	only AT&T and Intel modes.
	(X86_64_4...X86_64_27): New.
	(dis386): Updated.  Use X86_64_4...X86_64_21.
	(dis386_twobyte): Updated.
	(float_mem): Likewise.
	(x86_64_table): Add X86_64_4...X86_64_27.
	(opc_ext_table): Updated.  Use X86_64_22 and X86_64_27.
	(putop): Updated handling of '{', '}' and '|' to support only
	AT&T and Intel modes.
@
text
@d940 1
a940 1
  { OPC_EXT_2 },
d2690 1
a2690 1
    { "ldsS", { Gv, Mp } },
d4457 1
a4457 1
    { X86_64_27 },
@


1.147
log
@gas/testsuite/
2007-09-26  Jan Beulich  <jbeulich@@novell.com>

	* gas/i386/x86-64-addr32.d: Adjust expectations.

opcodes/
2007-09-26  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (OP_E_extended): Distinguish rip- and eip-
	relative addressing. Update used_prefixes based on whether any
	base or index register was printed.
@
text
@d581 24
d715 1
a715 4
   mnemonic strings for AT&T, Intel, X86_64 AT&T, and X86_64 Intel
   modes.  In cases where there are only two alternatives, the X86_64
   instruction is reserved, and "(bad)" is printed.
*/
d725 2
a726 2
  { "push{T|}",		{ es } },
  { "pop{T|}",		{ es } },
d734 1
a734 1
  { "push{T|}",		{ cs } },
d743 2
a744 2
  { "push{T|}",		{ ss } },
  { "pop{T|}",		{ ss } },
d752 2
a753 2
  { "push{T|}",		{ ds } },
  { "pop{T|}",		{ ds } },
d762 1
a762 1
  { "daa{|}",		{ XX } },
d771 1
a771 1
  { "das{|}",		{ XX } },
d780 1
a780 1
  { "aaa{|}",		{ XX } },
d789 1
a789 1
  { "aas{|}",		{ XX } },
d840 4
a843 4
  { "ins{b||b|}",	{ Ybr, indirDX } },
  { "ins{R||G|}",	{ Yzr, indirDX } },
  { "outs{b||b|}",	{ indirDXr, Xb } },
  { "outs{R||G|}",	{ indirDXr, Xz } },
d890 3
a892 3
  { "cW{t||t|}R",	{ XX } },
  { "cR{t||t|}O",	{ XX } },
  { "Jcall{T|}",	{ Ap } },
d896 2
a897 2
  { "sahf{|}",		{ XX } },
  { "lahf{|}",		{ XX } },
d903 4
a906 4
  { "movs{b||b|}",	{ Ybr, Xb } },
  { "movs{R||R|}",	{ Yvr, Xv } },
  { "cmps{b||b|}",	{ Xb, Yb } },
  { "cmps{R||R|}",	{ Xv, Yv } },
d950 1
a950 1
  { "into{|}",		{ XX } },
d957 2
a958 2
  { "aam{|}",		{ sIb } },
  { "aad{|}",		{ sIb } },
d982 1
a982 1
  { "Jjmp{T|}",		{ Ap } },
d1214 2
a1215 2
  { "movz{bR|x|bR|x}",	{ Gv, Eb } },
  { "movz{wR|x|wR|x}",	{ Gv, Ew } }, /* yes, there really is movzww ! */
d1223 2
a1224 2
  { "movs{bR|x|bR|x}",	{ Gv, Eb } },
  { "movs{wR|x|wR|x}",	{ Gv, Ew } }, /* yes, there really is movsww ! */
d2526 1
d2531 2
d2537 2
d2543 2
d2547 145
a2691 1
    { "movs{||lq|xd}", { Gv, Ed } },
d4452 1
a4452 1
    { "les{S|}",	{ Gv, Mp } },
d4457 1
a4457 1
    { "ldsS",		{ Gv, Mp } },
d4477 1
a4477 1
    { "sgdt{Q|IQ||}",	{ M } },
d4482 1
a4482 1
    { "sidt{Q|IQ||}",	{ M } },
d4487 1
a4487 1
    { "lgdt{Q|Q||}",	{ M } },
d4642 1
a4642 1
    { "lidt{Q|Q||}",	{ M } },
d5470 8
a5477 8
  "fadd{s||s|}",
  "fmul{s||s|}",
  "fcom{s||s|}",
  "fcomp{s||s|}",
  "fsub{s||s|}",
  "fsubr{s||s|}",
  "fdiv{s||s|}",
  "fdivr{s||s|}",
d5479 1
a5479 1
  "fld{s||s|}",
d5481 2
a5482 2
  "fst{s||s|}",
  "fstp{s||s|}",
d5488 8
a5495 8
  "fiadd{l||l|}",
  "fimul{l||l|}",
  "ficom{l||l|}",
  "ficomp{l||l|}",
  "fisub{l||l|}",
  "fisubr{l||l|}",
  "fidiv{l||l|}",
  "fidivr{l||l|}",
d5497 4
a5500 4
  "fild{l||l|}",
  "fisttp{l||l|}",
  "fist{l||l|}",
  "fistp{l||l|}",
d5506 8
a5513 8
  "fadd{l||l|}",
  "fmul{l||l|}",
  "fcom{l||l|}",
  "fcomp{l||l|}",
  "fsub{l||l|}",
  "fsubr{l||l|}",
  "fdiv{l||l|}",
  "fdivr{l||l|}",
d5515 4
a5518 4
  "fld{l||l|}",
  "fisttp{ll||ll|}",
  "fst{l||l|}",
  "fstp{l||l|}",
d5538 1
a5538 1
  "fild{ll||ll|}",
d5540 1
a5540 1
  "fistp{ll||ll|}",
a5869 4
	    alt += 1;
	  if (address_mode == mode_64bit)
	    alt += 2;
	  while (alt != 0)
d5872 2
a5873 12
		{
		  if (*p == '}')
		    {
		      /* Alternative not valid.  */
		      strcpy (obuf, "(bad)");
		      obufp = obuf + 5;
		      return 1;
		    }
		  else if (*p == '\0')
		    abort ();
		}
	      alt--;
@


1.146
log
@gas/testsuite/

2007-09-20  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/sib.s: Add more eiz tests.
	* gas/i386/x86-64-sib.s: Add more riz tests.

	* gas/i386/sib-intel.d: Updated.
	* gas/i386/sib.d: Likewise.
	* gas/i386/x86-64-sib-intel.d: Likewise.
	* gas/i386/x86-64-sib.d: Likewise.

opcodes/

2007-09-20  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_E_extended): Display eiz for [eiz*1 + offset].
@
text
@d6393 1
a6393 1
		oappend ("(%rip)");
d6397 3
d6406 1
a6406 1
	      oappend ("rip");
@


1.145
log
@gas/

2007-09-20  H.J. Lu  <hongjiu.lu@@intel.com>

	PR 658
	* config/tc-i386.c (SCALE1_WHEN_NO_INDEX): Removed.
	(set_allow_index_reg): New.
	(allow_index_reg): Likewise.
	(md_pseudo_table): Add "allow_index_reg" and
	"disallow_index_reg".
	(build_modrm_byte): Set i.sib.index to NO_INDEX_REGISTER for
	fake index registers.
	(i386_scale): Updated.
	(i386_index_check): Support fake index registers.
	(parse_real_register): Return NULL on eiz/riz if fake index
	registers aren't allowed.

gas/testsuite/

2007-09-20  H.J. Lu  <hongjiu.lu@@intel.com>

	PR 658
	* gas/i386/i386.exp: Run sib-intel, x86-64-sib and
	x86-64-sib-intel.

	* gas/i386/nops-1-i386-i686.d: Updated.
	* gas/i386/nops-1-i386.d: Likewise.
	* gas/i386/nops-1.d: Likewise.
	* gas/i386/nops-2-i386.d: Likewise.
	* gas/i386/nops-2-merom.d: Likewise.
	* gas/i386/nops-2.d: Likewise.
	* gas/i386/nops-3-i386.d: Likewise.
	* gas/i386/nops-3.d : Likewise.
	* gas/i386/sib.d: Likewise.

	* gas/i386/sib.s: Use %eiz in testcases.

	* gas/i386/sib-intel.d: New.
	* gas/i386/x86-64-sib-intel.d: Likewise.
	* gas/i386/x86-64-sib.d: Likewise.
	* gas/i386/x86-64-sib.s: Likewise.

ld/testsuite/

2007-09-20  H.J. Lu  <hongjiu.lu@@intel.com>

	PR 658
	* ld-i386/tlsbin.dd: Updated.
	* ld-i386/tlsld1.dd: Likewise.

opcodes/

2007-09-20  H.J. Lu  <hongjiu.lu@@intel.com>

	PR 658
	* 386-dis.c (index64): New.
	(index32): Likewise.
	(intel_index64): Likewise.
	(intel_index32): Likewise.
	(att_index64): Likewise.
	(att_index32): Likewise.
	(print_insn): Set index64 and index32.
	(OP_E_extended): Use index64/index32 for index register for
	SIB with INDEX == 4.

	* i386-opc.h (RegEiz): New.
	(RegRiz): Likewise.

	* i386-reg.tbl: Add eiz and riz.
	* i386-tbl.h: Regenerated.
@
text
@d6317 1
d6372 9
a6380 1
      havedisp = havebase || (havesib && (haveindex || scale != 0));
d6414 1
@


1.144
log
@gas/testsuite/gas/

2007-09-19  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/intelok.s: Add tests for memory without base.
	* gas/i386/intelok.d: Updated.
	* gas/i386/intelok.e: Likewise.

opcodes/

2007-09-19  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_E_extended): Always display scale for memory.
@
text
@d1356 2
d1382 2
d1410 2
d5010 2
d5026 2
d6331 1
a6331 3
	  if (address_mode == mode_64bit || index != 0x4)
	    /* When INDEX == 0x4 in 32 bit mode, SCALE is ignored.  */
	    scale = (*codep >> 6) & 3;
d6402 5
a6406 1
	      if (haveindex)
d6413 9
a6421 6
		  oappend (address_mode == mode_64bit 
			   && (sizeflag & AFLAG)
			   ? names64[index] : names32[index]);
		}
	      if (scale != 0 || haveindex)
		{
d6431 1
a6431 1
	      if ((bfd_signed_vma) disp >= 0)
d6443 4
a6446 1
	      print_displacement (scratchbuf, disp);
@


1.143
log
@Add AMD SSE5 support
@
text
@d6306 1
d6313 1
d6328 1
d6363 1
a6363 1
      havedisp = havebase || (havesib && (index != 4 || scale != 0));
d6394 1
a6394 1
	      if (index != 4)
d6405 1
a6405 1
	      if (scale != 0 || (!intel_syntax && index != 4))
@


1.142
log
@2007-09-13  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (get_valid_dis386): Take a pointer to
	disassemble_info.  Handle IS_3BYTE_OPCODE.
	(print_insn): Updated.  Don't handle IS_3BYTE_OPCODE here.
@
text
@d40 1
d56 1
d104 5
d150 14
d384 5
d584 4
d1030 1
a1030 1
  { "(bad)",		{ XX } },
d1126 2
a1127 2
  { "(bad)",		{ XX } },
  { "(bad)",		{ XX } },
d1306 1
a1306 1
  /* 20 */ 1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1, /* 2f */
d1311 1
a1311 1
  /* 70 */ 1,1,1,1,1,1,1,0,1,1,0,0,1,1,1,1, /* 7f */
d2510 1224
a3733 24
  },
  {
    { "arpl", { Ew, Gw } },
    { "movs{||lq|xd}", { Gv, Ed } },
  },
};

static const struct dis386 three_byte_table[][256] = {
  /* THREE_BYTE_0 */
  {
    /* 00 */
    { "pshufb", { MX, EM } },
    { "phaddw", { MX, EM } },
    { "phaddd",	{ MX, EM } },
    { "phaddsw", { MX, EM } },
    { "pmaddubsw", { MX, EM } },
    { "phsubw", { MX, EM } },
    { "phsubd", { MX, EM } },
    { "phsubsw", { MX, EM } },
    /* 08 */
    { "psignb", { MX, EM } },
    { "psignw", { MX, EM } },
    { "psignd", { MX, EM } },
    { "pmulhrsw", { MX, EM } },
d3738 3
a3740 2
    /* 10 */
    { PREGRP39 },
a3743 2
    { PREGRP40 },
    { PREGRP41 },
a3744 2
    { PREGRP42 },
    /* 18 */
d3747 1
a3749 12
    { "pabsb", { MX, EM } },
    { "pabsw", { MX, EM } },
    { "pabsd", { MX, EM } },
    { "(bad)", { XX } },
    /* 20 */
    { PREGRP43 },
    { PREGRP44 },
    { PREGRP45 },
    { PREGRP46 },
    { PREGRP47 },
    { PREGRP48 },
    { "(bad)", { XX } },
a3750 5
    /* 28 */
    { PREGRP49 },
    { PREGRP50 },
    { PREGRP51 },
    { PREGRP52 },
a3754 7
    /* 30 */
    { PREGRP53 },
    { PREGRP54 },
    { PREGRP55 },
    { PREGRP56 },
    { PREGRP57 },
    { PREGRP58 },
a3755 10
    { PREGRP86 },
    /* 38 */
    { PREGRP59 },
    { PREGRP60 },
    { PREGRP61 },
    { PREGRP62 },
    { PREGRP63 },
    { PREGRP64 },
    { PREGRP65 },
    { PREGRP66 },
a3756 5
    { PREGRP67 },
    { PREGRP68 },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3758 3
d3763 2
d3769 1
a3769 1
    { "(bad)", { XX } },
d3776 3
d3781 2
a3782 5
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3787 1
a3787 1
    { "(bad)", { XX } },
d3794 3
a3796 3
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d3955 2
a3956 2
    { PREGRP87 },
    { PREGRP88 },
d3973 1
a3973 1
  /* THREE_BYTE_1 */
a3984 9
    { PREGRP69 },
    { PREGRP70 },
    { PREGRP71 },
    { PREGRP72 },
    { PREGRP73 },
    { PREGRP74 },
    { PREGRP75 },
    { "palignr", { MX, EM, Ib } },
    /* 10 */
a3988 5
    { PREGRP76 },
    { PREGRP77 },
    { PREGRP78 },
    { PREGRP79 },
    /* 18 */
d3993 1
a3997 4
    /* 20 */
    { PREGRP80 },
    { PREGRP81 },
    { PREGRP82 },
d4002 1
a4003 1
    /* 28 */
d4011 1
a4012 1
    /* 30 */
d4020 1
a4021 1
    /* 38 */
d4029 1
a4030 4
    /* 40 */
    { PREGRP83 },
    { PREGRP84 },
    { PREGRP85 },
d4036 6
a4041 1
    /* 48 */
d4047 15
d4084 4
a4087 4
    { PREGRP89 },
    { PREGRP90 },
    { PREGRP91 },
    { PREGRP92 },
d4489 1
a4489 1
    { "(bad)",		{ XX } },
d6224 1
a6224 1
OP_E (int bytemode, int sizeflag)
d6330 8
d6398 2
a6399 1
		  oappend (address_mode == mode_64bit && (sizeflag & AFLAG)
d6525 7
d7681 341
@


1.141
log
@2007-08-31  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OPC_EXT_40...OPC_EXT_45): New.
	(dis386_twobyte): Use OPC_EXT_40...OPC_EXT_45.
	(opc_ext_table): Add OPC_EXT_40...OPC_EXT_45.
@
text
@d3632 1
a3632 1
get_valid_dis386 (const struct dis386 *dp)
d3681 9
d3708 1
a3708 1
    return get_valid_dis386 (dp);
a3908 5
      if (dp->name == NULL && dp->op[0].bytemode == IS_3BYTE_OPCODE)
	{
	  FETCH_DATA (info, codep + 2);
	  op = *codep++;
	}
d3971 1
a3971 8
  if (dp->name == NULL && dp->op[0].bytemode == IS_3BYTE_OPCODE)
    {
      dp = &three_byte_table[dp->op[1].bytemode][op];
      modrm.mod = (*codep >> 6) & 3;
      modrm.reg = (*codep >> 3) & 7;
      modrm.rm = *codep & 7;
    }
  else if (need_modrm)
d3985 1
a3985 1
      dp = get_valid_dis386 (dp);
@


1.140
log
@gas/testsuite/

2007-08-31  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/svme.s: Updated to accept eax in 32bit and rax in
	64bit.
	* gas/i386/svme.d: Updated.
	* gas/i386/svme64.d: Likewise.

opcodes/

2007-08-31  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (SVME_Fixup): Removed.
	(OPC_EXT_39): New.
	(OPC_EXT_RM_6): Likewise.
	(grps): Use OPC_EXT_39.
	(opc_ext_table): Add OPC_EXT_39.
	(opc_ext_rm_table): Add OPC_EXT_RM_6.

	* i386-opc.tbl: Correct SVME instructions to take register
	operand only.
	* i386-tbl.h: Regenerated.
@
text
@d599 6
d995 5
a999 5
  { "movZ",		{ Rm, Cm } },
  { "movZ",		{ Rm, Dm } },
  { "movZ",		{ Cm, Rm } },
  { "movZ",		{ Dm, Rm } },
  { "movL",		{ Rd, Td } },
d1001 1
a1001 1
  { "movL",		{ Td, Rd } },
d3273 30
@


1.139
log
@2007-08-31  H.J. Lu  <hongjiu.lu@@intel.com>

	* Makefile.am (INCLUDES): Remove -D_GNU_SOURCE.
	* Makefile.in: Regenerated.

	* configure.in (AC_GNU_SOURCE): Added.
	(AC_PROG_CC): Moved before AC_GNU_SOURCE.
	(AC_CHECK_DECLS): Add stpcpy.
	* configure: Regenerated.
	* config.in: Likewise.

	* i386-dis.c: Include "sysdep.h" before "dis-asm.h".

	* sysdep.h (stpcpy): New.
@
text
@a96 1
static void SVME_Fixup (int, int);
d598 1
d606 1
d1545 1
a1545 1
    { "lidt{Q|Q||}",	 { { SVME_Fixup, 0 } } },
d3262 5
d3336 11
a6317 70
SVME_Fixup (int bytemode, int sizeflag)
{
  const char *alt;
  char *p;

  switch (*codep)
    {
    case 0xd8:
      alt = "vmrun";
      break;
    case 0xd9:
      alt = "vmmcall";
      break;
    case 0xda:
      alt = "vmload";
      break;
    case 0xdb:
      alt = "vmsave";
      break;
    case 0xdc:
      alt = "stgi";
      break;
    case 0xdd:
      alt = "clgi";
      break;
    case 0xde:
      alt = "skinit";
      break;
    case 0xdf:
      alt = "invlpga";
      break;
    default:
      OP_M (bytemode, sizeflag);
      return;
    }
  /* Override "lidt".  */
  p = obuf + strlen (obuf) - 4;
  /* We might have a suffix.  */
  if (*p == 'i')
    --p;
  strcpy (p, alt);
  if (!(prefixes & PREFIX_ADDR))
    {
      ++codep;
      return;
    }
  used_prefixes |= PREFIX_ADDR;
  switch (*codep++)
    {
    case 0xdf:
      strcpy (op_out[1], names32[1]);
      two_source_ops = 1;
	  /* Fall through.  */
    case 0xd8:
    case 0xda:
    case 0xdb:
      *obufp++ = open_char;
      if (address_mode == mode_64bit || (sizeflag & AFLAG))
        alt = names32[0];
      else
        alt = names16[0];
      strcpy (obufp, alt);
      obufp += strlen (alt);
      *obufp++ = close_char;
      *obufp = '\0';
      break;
    }
}

static void
@


1.138
log
@gas/testsuite/

2007-08-30  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/amd.s: Add rdtscp.
	* gas/i386/amd.d: Updated.

	* gas/i386/mem-intel.d: Update invlpg for BYTE PTR.
	* gas/i386/x86-64-mem-intel.d: Likewise.

	* gas/i386/x86-64-opcode.s: Add swapgs.
	* gas/i386/x86-64-opcode.d: Updated.

opcodes/

2007-08-30  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (INVLPG_Fixup): Removed.
	(OPC_EXT_38): New.
	(OPC_EXT_RM_5): Likewise.
	(grps): Use OPC_EXT_38.
	(opc_ext_table): Add OPC_EXT_38.
	(opc_ext_rm_table): Add OPC_EXT_RM_5.
@
text
@d36 1
a37 1
#include "sysdep.h"
@


1.137
log
@2007-08-29  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (SIMD_Fixup): Removed.
	(OPC_EXT_34...OPC_EXT_37): New.
	(dis386_twobyte): Use OPC_EXT_34 and OPC_EXT_35.
	(prefix_user_table): Use OPC_EXT_36 and OPC_EXT_37.
	(opc_ext_table): Add OPC_EXT_34...OPC_EXT_37.
@
text
@a97 1
static void INVLPG_Fixup (int, int);
d598 1
d605 1
d1548 1
a1548 1
    { "invlpg",	{ { INVLPG_Fixup, 0 } } },
d3256 5
d3319 11
a6370 22
INVLPG_Fixup (int bytemode, int sizeflag)
{
  const char *alt;

  switch (*codep)
    {
    case 0xf8:
      alt = "swapgs";
      break;
    case 0xf9:
      alt = "rdtscp";
      break;
    default:
      OP_M (bytemode, sizeflag);
      return;
    }
  /* Override "invlpg".  */
  strcpy (obuf + strlen (obuf) - 6, alt);
  codep++;
}

static void
@


1.136
log
@2007-08-29  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OPC_EXT_25...OPC_EXT_33): New.
	(dis386): Use OPC_EXT_0...OPC_EXT_2.
	(dis386_twobyte): Use OPC_EXT_3...OPC_EXT_5.
	(grps): Updated to use OPC_EXT_6...OPC_EXT_31.
	(prefix_user_table): Use OPC_EXT_32.
	(x86_64_table): Use OPC_EXT_33.
	(opc_ext_table): Reorder and add OPC_EXT_25...OPC_EXT_33.
@
text
@a96 1
static void SIMD_Fixup (int, int);
d595 4
d972 1
a972 1
  { "movlpX",		{ EXq, XM, { SIMD_Fixup, 'h' } } },
d976 1
a976 1
  { "movhpX",		{ EXq, XM, { SIMD_Fixup, 'l' } } },
d1896 1
a1896 1
    { "movlpX",	{ XM, EXq, { SIMD_Fixup, 'h' } } }, /* really only 2 operands */
d1903 1
a1903 1
    { "movhpX",	{ XM, EXq, { SIMD_Fixup, 'l' } } },
d3235 20
a6233 16
SIMD_Fixup (int extrachar, int sizeflag ATTRIBUTE_UNUSED)
{
  /* Change movlps/movhps to movhlps/movlhps for 2 register operand
     forms of these instructions.  */
  if (modrm.mod == 3)
    {
      char *p = obuf + strlen (obuf);
      *(p + 1) = '\0';
      *p       = *(p - 1);
      *(p - 1) = *(p - 2);
      *(p - 2) = *(p - 3);
      *(p - 3) = extrachar;
    }
}

static void
@


1.135
log
@2007-08-29  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (prefix_user_table): Fix comment.
@
text
@d587 9
d815 1
a815 1
  { "leaS",		{ Gv, M } },
d877 2
a878 2
  { "les{S|}",		{ Gv, Mp } },
  { "ldsS",		{ Gv, Mp } },
d1148 1
a1148 1
  { "lssS",		{ Gv, Mp } },
d1150 2
a1151 2
  { "lfsS",		{ Gv, Mp } },
  { "lgsS",		{ Gv, Mp } },
d1537 3
a1539 3
    { OPC_EXT_0 },
    { OPC_EXT_1 },
    { "lgdt{Q|Q||}",	 { M } },
d1565 2
a1566 2
    { OPC_EXT_2 },
    { OPC_EXT_3 },
d1594 1
a1594 1
    { OPC_EXT_4 },
d1596 1
a1596 1
    { OPC_EXT_5 },
d1598 1
a1598 1
    { OPC_EXT_6 },
d1605 1
a1605 1
    { OPC_EXT_7 },
d1607 1
a1607 1
    { OPC_EXT_8 },
d1609 1
a1609 1
    { OPC_EXT_9 },
d1616 2
a1617 3
    { OPC_EXT_10 },
    { OPC_EXT_11 },
    { "(bad)",	{ XX } },
a1618 9
    { OPC_EXT_12 },
    { OPC_EXT_13 },
  },
  /* GRP15 */
  {
    { OPC_EXT_14 },
    { OPC_EXT_15 },
    { OPC_EXT_16 },
    { OPC_EXT_17 },
a1619 1
    { OPC_EXT_18 },
d1623 1
a1623 1
  /* GRP16 */
d1630 11
d1910 1
a1910 1
    { "lddqu",	{ XM, M } },
d2467 1
a2467 1
    { "bound{S|}", { Gv, Ma } },
d3064 30
d3098 1
a3098 1
    /* OPC_EXT_1 */
d3103 6
a3108 1
    /* OPC_EXT_2 */
d3113 1
a3113 1
    /* OPC_EXT_3 */
d3118 1
a3118 1
    /* OPC_EXT_4 */
d3123 1
a3123 1
    /* OPC_EXT_5 */
d3128 1
a3128 1
    /* OPC_EXT_6 */
d3133 1
a3133 1
    /* OPC_EXT_7 */
d3138 1
a3138 1
    /* OPC_EXT_8 */
d3143 1
a3143 1
    /* OPC_EXT_9 */
d3148 1
a3148 1
    /* OPC_EXT_10 */
d3153 1
a3153 1
    /* OPC_EXT_11 */
d3158 1
a3158 1
    /* OPC_EXT_12 */
d3163 1
a3163 1
    /* OPC_EXT_13 */
d3168 1
a3168 1
    /* OPC_EXT_14 */
d3173 1
a3173 1
    /* OPC_EXT_15 */
d3178 1
a3178 1
    /* OPC_EXT_16 */
d3183 1
a3183 1
    /* OPC_EXT_17 */
d3188 1
a3188 1
    /* OPC_EXT_18 */
d3193 1
a3193 1
    /* OPC_EXT_19 */
d3198 1
a3198 1
    /* OPC_EXT_20 */
d3203 1
a3203 1
    /* OPC_EXT_21 */
d3208 1
a3208 1
    /* OPC_EXT_22 */
d3213 1
a3213 1
    /* OPC_EXT_23 */
d3218 1
a3218 1
    /* OPC_EXT_24 */
d3222 10
@


1.134
log
@gas/testsuite/

2007-08-29  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run reg and reg-intel.

	* gas/i386/katmai.d: Update bad instructions.

	* gas/i386/reg.s: New. Add tests for instructions with one
	register operand.
	* gas/i386/reg-intel.d: Likewise.
	* gas/i386/reg.d: Likewise.

opcodes/

2007-08-29  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_Skip_MODRM): New.
	(OP_Monitor): Likewise.
	(OP_Mwait): Likewise.
	(Mb): Likewise.
	(Skip_MODRM): Likewise.
	(USE_OPC_EXT_TABLE): Likewise.
	(USE_OPC_EXT_RM_TABLE): Likewise.
	(PREGRP98...PREGRP100): Likewise.
	(OPC_EXT_0...OPC_EXT_24): Likewise.
	(OPC_EXT_RM_0...OPC_EXT_RM_4): Likewise.
	(lock_prefix): Likewise.
	(data_prefix): Likewise.
	(addr_prefix): Likewise.
	(repz_prefix): Likewise.
	(repnz_prefix): Likewise.
	(opc_ext_table): Likewise.
	(opc_ext_rm_table): Likewise.
	(get_valid_dis386): Likewise.
	(OP_VMX): Removed.
	(OP_0fae): Likewise.
	(PNI_Fixup): Likewise.
	(VMX_Fixup): Likewise.
	(VM): Likewise.
	(twobyte_uses_DATA_prefix): Likewise.
	(twobyte_uses_REPNZ_prefix): Likewise.
	(twobyte_uses_REPZ_prefix): Likewise.
	(threebyte_0x38_uses_DATA_prefix): Likewise.
	(threebyte_0x38_uses_REPNZ_prefix): Likewise.
	(threebyte_0x38_uses_REPZ_prefix): Likewise.
	(threebyte_0x3a_uses_DATA_prefix): Likewise.
	(threebyte_0x3a_uses_REPNZ_prefix): Likewise.
	(threebyte_0x3a_uses_REPZ_prefix): Likewise.
	(grps): Use OPC_EXT_0...OPC_EXT_24.
	(prefix_user_table): Use PREGRP98.
	(print_insn): Remove uses_DATA_prefix, uses_LOCK_prefix,
	uses_REPNZ_prefix and uses_REPZ_prefix.  Initialize
	repz_prefix, repnz_prefix, lock_prefix, addr_prefix and
	data_prefix based on prefixes.  Call get_valid_dis386 to
	get a pointer to the valid dis386.  Print out prefixes if
	they aren't NULL.
	(OP_C): Clear lock_prefix if PREFIX_LOCK is used.
	(REP_Fixup): Set repz_prefix to "rep " when seeing
	PREFIX_REPZ.
@
text
@d2439 1
a2439 1
  /* PREGRP99 */
@


1.133
log
@gas/

2007-08-28  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c (process_suffix): Handle cmpxchg8b in
	Intel mode.

gas/testsuite/

2007-08-28  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/mem.s: New. Add tests for instructions with one
	memory operand.
	* gas/i386/x86-64-mem.s: Likewise.

	* gas/i386/mem-intel.d: Updated.
	* gas/i386/mem.d: Likewise.
	* gas/i386/x86-64-mem-intel.d: Likewise.
	* gas/i386/x86-64-mem.d: Likewise.

opcodes/

2007-08-28  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (Md): New.
	(grps): Use 0 on invlpg.  Use M on fxsave and fxrstor.  Use
	Md on ldmxcsr and stmxcsr.  Use b_mode on clflush.
	(OP_0fae): Clear bytemode for sfence.
@
text
@d63 1
a89 2
static void OP_VMX (int, int);
static void OP_0fae (int, int);
d91 2
a97 1
static void PNI_Fixup (int, int);
a100 1
static void VMX_Fixup (int, int);
d217 1
d241 1
a323 1
#define VM { OP_VMX, q_mode }
d417 2
d549 3
d562 32
a1273 213
static const unsigned char twobyte_uses_DATA_prefix[256] = {
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
  /*       -------------------------------        */
  /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 0f */
  /* 10 */ 1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0, /* 1f */
  /* 20 */ 0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0, /* 2f */
  /* 30 */ 0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0, /* 3f */
  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
  /* 50 */ 0,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1, /* 5f */
  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1, /* 6f */
  /* 70 */ 1,0,0,0,0,0,0,0,1,1,0,0,1,1,1,1, /* 7f */
  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
  /* c0 */ 0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
  /* d0 */ 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0, /* df */
  /* e0 */ 0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0, /* ef */
  /* f0 */ 1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0  /* ff */
  /*       -------------------------------        */
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
};

static const unsigned char twobyte_uses_REPNZ_prefix[256] = {
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
  /*       -------------------------------        */
  /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 0f */
  /* 10 */ 1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 1f */
  /* 20 */ 0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0, /* 2f */
  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
  /* 50 */ 0,1,0,0,0,0,0,0,1,1,1,0,1,1,1,1, /* 5f */
  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
  /* 70 */ 1,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0, /* 7f */
  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
  /* c0 */ 0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
  /* d0 */ 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0, /* df */
  /* e0 */ 0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0, /* ef */
  /* f0 */ 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
  /*       -------------------------------        */
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
};

static const unsigned char twobyte_uses_REPZ_prefix[256] = {
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
  /*       -------------------------------        */
  /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 0f */
  /* 10 */ 1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0, /* 1f */
  /* 20 */ 0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0, /* 2f */
  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
  /* 50 */ 0,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1, /* 5f */
  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1, /* 6f */
  /* 70 */ 1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1, /* 7f */
  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
  /* b0 */ 0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0, /* bf */
  /* c0 */ 0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
  /* d0 */ 0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0, /* df */
  /* e0 */ 0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0, /* ef */
  /* f0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
  /*       -------------------------------        */
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
};

/* This is used to determine if opcode 0f 38 XX uses DATA prefix.  */
static const unsigned char threebyte_0x38_uses_DATA_prefix[256] = {
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
  /*       -------------------------------        */
  /* 00 */ 1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0, /* 0f */
  /* 10 */ 1,0,0,0,1,1,0,1,0,0,0,0,1,1,1,0, /* 1f */
  /* 20 */ 1,1,1,1,1,1,0,0,1,1,1,1,0,0,0,0, /* 2f */
  /* 30 */ 1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1, /* 3f */
  /* 40 */ 1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
  /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 5f */
  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
  /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 7f */
  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
  /* c0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
  /* d0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* df */
  /* e0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ef */
  /* f0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
  /*       -------------------------------        */
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
};

/* This is used to determine if opcode 0f 38 XX uses REPNZ prefix.  */
static const unsigned char threebyte_0x38_uses_REPNZ_prefix[256] = {
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
  /*       -------------------------------        */
  /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 0f */
  /* 10 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 1f */
  /* 20 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 2f */
  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
  /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 5f */
  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
  /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 7f */
  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
  /* c0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
  /* d0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* df */
  /* e0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ef */
  /* f0 */ 1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
  /*       -------------------------------        */
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
};

/* This is used to determine if opcode 0f 38 XX uses REPZ prefix.  */
static const unsigned char threebyte_0x38_uses_REPZ_prefix[256] = {
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
  /*       -------------------------------        */
  /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 0f */
  /* 10 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 1f */
  /* 20 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 2f */
  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
  /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 5f */
  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
  /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 7f */
  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
  /* c0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
  /* d0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* df */
  /* e0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ef */
  /* f0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
  /*       -------------------------------        */
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
};

/* This is used to determine if opcode 0f 3a XX uses DATA prefix.  */
static const unsigned char threebyte_0x3a_uses_DATA_prefix[256] = {
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
  /*       -------------------------------        */
  /* 00 */ 0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1, /* 0f */
  /* 10 */ 0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0, /* 1f */
  /* 20 */ 1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 2f */
  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
  /* 40 */ 1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
  /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 5f */
  /* 60 */ 1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
  /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 7f */
  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
  /* c0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
  /* d0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* df */
  /* e0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ef */
  /* f0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
  /*       -------------------------------        */
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
};

/* This is used to determine if opcode 0f 3a XX uses REPNZ prefix.  */
static const unsigned char threebyte_0x3a_uses_REPNZ_prefix[256] = {
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
  /*       -------------------------------        */
  /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 0f */
  /* 10 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 1f */
  /* 20 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 2f */
  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
  /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 5f */
  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
  /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 7f */
  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
  /* c0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
  /* d0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* df */
  /* e0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ef */
  /* f0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
  /*       -------------------------------        */
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
};

/* This is used to determine if opcode 0f 3a XX uses REPZ prefix.  */
static const unsigned char threebyte_0x3a_uses_REPZ_prefix[256] = {
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
  /*       -------------------------------        */
  /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 0f */
  /* 10 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 1f */
  /* 20 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 2f */
  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
  /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 5f */
  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
  /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 7f */
  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
  /* c0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
  /* d0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* df */
  /* e0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ef */
  /* f0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
  /*       -------------------------------        */
  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
};

d1280 5
d1528 2
a1529 2
    { "sgdt{Q|IQ||}", { { VMX_Fixup, 0 } } },
    { "sidt{Q|IQ||}", { { PNI_Fixup, 0 } } },
d1556 2
a1557 2
    { "",	{ VM } },		/* See OP_VMX.  */
    { "vmptrst", { Mq } },
d1585 1
a1585 1
    { "psrlw",	{ MS, Ib } },
d1587 1
a1587 1
    { "psraw",	{ MS, Ib } },
d1589 1
a1589 1
    { "psllw",	{ MS, Ib } },
d1596 1
a1596 1
    { "psrld",	{ MS, Ib } },
d1598 1
a1598 1
    { "psrad",	{ MS, Ib } },
d1600 1
a1600 1
    { "pslld",	{ MS, Ib } },
d1607 2
a1608 2
    { "psrlq",	{ MS, Ib } },
    { "psrldq",	{ MS, Ib } },
d1611 2
a1612 2
    { "psllq",	{ MS, Ib } },
    { "pslldq",	{ MS, Ib } },
d1616 8
a1623 8
    { "fxsave",		{ M } },
    { "fxrstor",	{ M } },
    { "ldmxcsr",	{ Md } },
    { "stmxcsr",	{ Md } },
    { "(bad)",		{ XX } },
    { "lfence",		{ { OP_0fae, 0 } } },
    { "mfence",		{ { OP_0fae, 0 } } },
    { "clflush",	{ { OP_0fae, b_mode } } },
d1627 8
a1634 8
    { "prefetchnta",	{ Ev } },
    { "prefetcht0",	{ Ev } },
    { "prefetcht1",	{ Ev } },
    { "prefetcht2",	{ Ev } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
    { "(bad)",		{ XX } },
d2422 24
d3052 186
d3482 73
a3561 2
  unsigned char uses_DATA_prefix, uses_LOCK_prefix;
  unsigned char uses_REPNZ_prefix, uses_REPZ_prefix;
d3566 2
a3751 4
      uses_DATA_prefix = twobyte_uses_DATA_prefix[*codep];
      uses_REPNZ_prefix = twobyte_uses_REPNZ_prefix[*codep];
      uses_REPZ_prefix = twobyte_uses_REPZ_prefix[*codep];
      uses_LOCK_prefix = (*codep & ~0x02) == 0x20;
a3756 15
	  switch (threebyte)
	    {
	    case 0x38:
	      uses_DATA_prefix = threebyte_0x38_uses_DATA_prefix[op];
	      uses_REPNZ_prefix = threebyte_0x38_uses_REPNZ_prefix[op];
	      uses_REPZ_prefix = threebyte_0x38_uses_REPZ_prefix[op];
	      break;
	    case 0x3a:
	      uses_DATA_prefix = threebyte_0x3a_uses_DATA_prefix[op];
	      uses_REPNZ_prefix = threebyte_0x3a_uses_REPNZ_prefix[op];
	      uses_REPZ_prefix = threebyte_0x3a_uses_REPZ_prefix[op];
	      break;
	    default:
	      break;
	    }
a3762 5
      uses_DATA_prefix = 0;
      uses_REPNZ_prefix = 0;
      /* pause is 0xf3 0x90.  */
      uses_REPZ_prefix = *codep == 0x90;
      uses_LOCK_prefix = 0;
d3766 1
a3766 1
  if (!uses_REPZ_prefix && (prefixes & PREFIX_REPZ))
d3768 1
a3768 1
      oappend ("repz ");
d3771 4
a3774 1
  if (!uses_REPNZ_prefix && (prefixes & PREFIX_REPNZ))
d3776 1
a3776 1
      oappend ("repnz ");
d3779 2
d3782 1
a3782 1
  if (!uses_LOCK_prefix && (prefixes & PREFIX_LOCK))
d3784 1
a3784 1
      oappend ("lock ");
d3787 2
d3790 1
d3797 1
a3797 1
	    oappend ("addr32 ");
d3799 1
a3799 1
	    oappend ("addr16 ");
d3804 2
a3805 1
  if (!uses_DATA_prefix && (prefixes & PREFIX_DATA))
d3813 1
a3813 1
	    oappend ("data32 ");
d3815 1
a3815 1
	    oappend ("data16 ");
d3841 2
a3842 43
      int index;
      if (dp->name == NULL)
	{
	  switch (dp->op[0].bytemode)
	    {
	    case USE_GROUPS:
	      dp = &grps[dp->op[1].bytemode][modrm.reg];
	      break;

	    case USE_PREFIX_USER_TABLE:
	      index = 0;
	      used_prefixes |= (prefixes & PREFIX_REPZ);
	      if (prefixes & PREFIX_REPZ)
		index = 1;
	      else
		{
		  /* We should check PREFIX_REPNZ and PREFIX_REPZ
		     before PREFIX_DATA.  */
		  used_prefixes |= (prefixes & PREFIX_REPNZ);
		  if (prefixes & PREFIX_REPNZ)
		    index = 3;
		  else
		    {
		      used_prefixes |= (prefixes & PREFIX_DATA);
		      if (prefixes & PREFIX_DATA)
			index = 2;
		    }
		}
	      dp = &prefix_user_table[dp->op[1].bytemode][index];
	      break;

	    case X86_64_SPECIAL:
	      index = address_mode == mode_64bit ? 1 : 0;
	      dp = &x86_64_table[dp->op[1].bytemode][index];
	      break;

	    default:
	      oappend (INTERNAL_DISASSEMBLER_ERROR);
	      break;
	    }
	}

      if (dp->name != NULL && putop (dp->name, sizeflag) == 0)
d3877 16
d3894 1
a3894 1
  for (i = strlen (obuf); i < 6; i++)
d4265 9
d5798 1
a5987 27
static void
OP_0fae (int bytemode, int sizeflag)
{
  if (modrm.mod == 3)
    {
      if (modrm.reg == 7)
	{
	  bytemode = 0;
	  strcpy (obuf + strlen (obuf) - sizeof ("clflush") + 1,
		  "sfence");
	}

      if (modrm.reg < 5 || modrm.rm != 0)
	{
	  BadOp ();	/* bad sfence, mfence, or lfence */
	  return;
	}
    }
  else if (modrm.reg != 7)
    {
      BadOp ();		/* bad clflush */
      return;
    }

  OP_E (bytemode, sizeflag);
}

d6173 20
a6192 1
PNI_Fixup (int extrachar ATTRIBUTE_UNUSED, int sizeflag)
d6194 2
a6195 1
  if (modrm.mod == 3 && modrm.reg == 1 && modrm.rm <= 1)
d6197 1
a6197 3
      /* Override "sidt".  */
      size_t olen = strlen (obuf);
      char *p = obuf + olen - 4;
d6201 3
a6203 21
      /* We might have a suffix when disassembling with -Msuffix.  */
      if (*p == 'i')
	--p;

      /* Remove "addr16/addr32" if we aren't in Intel mode.  */
      if (!intel_syntax
	  && (prefixes & PREFIX_ADDR)
	  && olen >= (4 + 7)
	  && *(p - 1) == ' '
	  && CONST_STRNEQ (p - 7, "addr")
	  && (CONST_STRNEQ (p - 3, "16")
	      || CONST_STRNEQ (p - 3, "32")))
	p -= 7;

      if (modrm.rm)
	{
	  /* mwait %eax,%ecx  */
	  strcpy (p, "mwait");
	  if (!intel_syntax)
	    strcpy (op_out[0], names[0]);
	}
d6206 5
a6210 17
	  /* monitor %eax,%ecx,%edx"  */
	  strcpy (p, "monitor");
	  if (!intel_syntax)
	    {
	      const char **op1_names;
	      if (!(prefixes & PREFIX_ADDR))
		op1_names = (address_mode == mode_16bit
			     ? names16 : names);
	      else
		{
		  op1_names = (address_mode != mode_32bit
			       ? names32 : names16);
		  used_prefixes |= PREFIX_ADDR;
		}
	      strcpy (op_out[0], op1_names[0]);
	      strcpy (op_out[2], names[2]);
	    }
d6212 4
a6215 7
      if (!intel_syntax)
	{
	  strcpy (op_out[1], names[1]);
	  two_source_ops = 1;
	}

      codep++;
d6217 3
a6219 2
  else
    OP_M (0, sizeflag);
a6322 50
VMX_Fixup (int extrachar ATTRIBUTE_UNUSED, int sizeflag)
{
  if (modrm.mod == 3
      && modrm.reg == 0
      && modrm.rm >=1
      && modrm.rm <= 4)
    {
      /* Override "sgdt".  */
      char *p = obuf + strlen (obuf) - 4;

      /* We might have a suffix when disassembling with -Msuffix.  */
      if (*p == 'g')
	--p;

      switch (modrm.rm)
	{
	case 1:
	  strcpy (p, "vmcall");
	  break;
	case 2:
	  strcpy (p, "vmlaunch");
	  break;
	case 3:
	  strcpy (p, "vmresume");
	  break;
	case 4:
	  strcpy (p, "vmxoff");
	  break;
	}

      codep++;
    }
  else
    OP_E (0, sizeflag);
}

static void
OP_VMX (int bytemode, int sizeflag)
{
  used_prefixes |= (prefixes & (PREFIX_DATA | PREFIX_REPZ));
  if (prefixes & PREFIX_DATA)
    strcpy (obuf, "vmclear");
  else if (prefixes & PREFIX_REPZ)
    strcpy (obuf, "vmxon");
  else
    strcpy (obuf, "vmptrld");
  OP_E (bytemode, sizeflag);
}

static void
a6326 2
  size_t ilen = 0;

d6328 1
a6328 45
    switch (*insn_codep)
      {
      case 0x6e:	/* outsb */
      case 0x6f:	/* outsw/outsl */
      case 0xa4:	/* movsb */
      case 0xa5:	/* movsw/movsl/movsq */
	if (!intel_syntax)
	  ilen = 5;
	else
	  ilen = 4;
	break;
      case 0xaa:	/* stosb */
      case 0xab:	/* stosw/stosl/stosq */
      case 0xac:	/* lodsb */
      case 0xad:	/* lodsw/lodsl/lodsq */
	if (!intel_syntax && (sizeflag & SUFFIX_ALWAYS))
	  ilen = 5;
	else
	  ilen = 4;
	break;
      case 0x6c:	/* insb */
      case 0x6d:	/* insl/insw */
	if (!intel_syntax)
	  ilen = 4;
	else
	  ilen = 3;
	break;
      default:
	abort ();
	break;
      }

  if (ilen != 0)
    {
      size_t olen;
      char *p;

      olen = strlen (obuf);
      p = obuf + olen - ilen - 1 - 4;
      /* Handle "repz [addr16|addr32]".  */
      if ((prefixes & PREFIX_ADDR))
	p -= 1 + 6;

      memmove (p + 3, p + 4, olen - (p + 3 - obuf));
    }
@


1.132
log
@2007-08-01  Michael Snyder  <msnyder@@access-company.com>

	* i386-dis.c (print_insn): Guard against NULL.
@
text
@d218 1
d1706 1
a1706 1
    { "invlpg",	{ { INVLPG_Fixup, w_mode } } },
d1787 4
a1790 4
    { "fxsave",		{ Ev } },
    { "fxrstor",	{ Ev } },
    { "ldmxcsr",	{ Ev } },
    { "stmxcsr",	{ Ev } },
d1794 1
a1794 1
    { "clflush",	{ { OP_0fae, 0 } } },
d5912 5
a5916 1
	strcpy (obuf + strlen (obuf) - sizeof ("clflush") + 1, "sfence");
@


1.131
log
@gas/testsuite/

2007-07-29  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4834
	* gas/i386/simd-intel.d: Updated.
	* gas/i386/simd.d: Likewise.
	* gas/i386/x86-64-simd-intel.d: Likewise.
	* gas/i386/x86-64-simd.d: Likewise.

	* gas/i386/simd.s: Add tests for SSE4 instructions.
	* gas/i386/x86-64-simd.s: Likewise.

opcodes/

2007-07-29  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4834
	* i386-dis.c (EXw): New.
	(prefix_user_table): Updated to use EXw, EXd and EXq for SSE4
	instructions when appropriated.
@
text
@d3785 1
a3785 1
      if (putop (dp->name, sizeflag) == 0)
@


1.130
log
@gas/testsuite/

2007-07-28  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4835
	* gas/i386/simd-intel.d: Updated.
	* gas/i386/simd.d: Likewise.
	* gas/i386/x86-64-simd-intel.d: Likewise.
	* gas/i386/x86-64-simd.d: Likewise.

	* gas/i386/simd.s: Add new tests.
	* gas/i386/x86-64-simd.s: Likewise.

opcodes/

2007-07-28  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4835
	* i386-dis.c (Eq): New.
	(EMC): Renamed to ...
	(EMCq): This.  Use q_mode instead of v_mode.
	(prefix_user_table): Updated to use EXd, EXq, EMCq, Ed and Eq
	when appropriated.
@
text
@d314 1
d2157 1
a2157 1
    { "pmovsxbw", { XM, EXx } },
d2165 1
a2165 1
    { "pmovsxbd", { XM, EXx } },
d2173 1
a2173 1
    { "pmovsxbq", { XM, EXx } },
d2181 1
a2181 1
    { "pmovsxwd", { XM, EXx } },
d2189 1
a2189 1
    { "pmovsxwq", { XM, EXx } },
d2197 1
a2197 1
    { "pmovsxdq", { XM, EXx } },
d2237 1
a2237 1
    { "pmovzxbw", { XM, EXx } },
d2245 1
a2245 1
    { "pmovzxbd", { XM, EXx } },
d2253 1
a2253 1
    { "pmovzxbq", { XM, EXx } },
d2261 1
a2261 1
    { "pmovzxwd", { XM, EXx } },
d2269 1
a2269 1
    { "pmovzxwq", { XM, EXx } },
d2277 1
a2277 1
    { "pmovzxdq", { XM, EXx } },
d2461 1
a2461 1
    { "insertps", { XM, EXx, Ib } },
@


1.129
log
@gas/testsuite/

2007-07-28  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/x86-64-opcode.d: Updated.
	* gas/i386/x86-64-simd-intel.d: Likewise.
	* gas/i386/x86-64-simd.d: Likewise.

	* gas/i386/x86-64-simd.s: Add movq.

opcodes/

2007-07-28  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (dis386_twobyte): Change "movd" to "movK".
	(prefix_user_table): Likewise.  Use EXq instead of EXx on
	"movq".
@
text
@d210 1
d319 1
a319 1
#define EMC { OP_EMC, v_mode }
d1851 1
d1853 1
a1853 2
    { "", { XM, EXx, OPSIMD } },
    { "", { XM, EXx, OPSIMD } },
d1857 1
a1857 1
    { "cvtpi2ps", { XM, EMC } },
d1859 1
a1859 1
    { "cvtpi2pd", { XM, EMC } },
d1864 2
a1865 2
    { "cvtps2pi", { MXC, EXx } },
    { "cvtss2siY", { Gv, EXx } },
d1867 1
a1867 1
    { "cvtsd2siY", { Gv, EXx } },
d1871 2
a1872 2
    { "cvttps2pi", { MXC, EXx } },
    { "cvttss2siY", { Gv, EXx } },
d1874 1
a1874 1
    { "cvttsd2siY", { Gv, EXx } },
d1879 1
a1879 1
    { "divss",	{ XM, EXx } },
d1881 1
a1881 1
    { "divsd",	{ XM, EXx } },
d1886 1
a1886 1
    { "maxss",	{ XM, EXx } },
d1888 1
a1888 1
    { "maxsd",	{ XM, EXx } },
d1893 1
a1893 1
    { "minss",	{ XM, EXx } },
d1895 1
a1895 1
    { "minsd",	{ XM, EXx } },
d1900 1
a1900 1
    { "movss",	{ XM, EXx } },
d1902 1
a1902 1
    { "movsd",	{ XM, EXx } },
d1907 1
a1907 1
    { "movss",	{ EXx,  XM } },
d1909 1
a1909 1
    { "movsd",	{ EXx,  XM } },
d1914 1
a1914 1
    { "mulss",	{ XM, EXx } },
d1916 1
a1916 1
    { "mulsd",	{ XM, EXx } },
d1921 1
a1921 1
    { "rcpss",	{ XM, EXx } },
d1928 1
a1928 1
    { "rsqrtss",{ XM, EXx } },
d1935 1
a1935 1
    { "sqrtss", { XM, EXx } },
d1937 1
a1937 1
    { "sqrtsd",	{ XM, EXx } },
d1942 1
a1942 1
    { "subss",	{ XM, EXx } },
d1944 1
a1944 1
    { "subsd",	{ XM, EXx } },
d1963 1
a1963 1
    { "cvtss2sd", { XM, EXx } },
d1965 1
a1965 1
    { "cvtsd2ss", { XM, EXx } },
d2075 1
a2075 1
    {"movntss", { Ev, XM } },
d2077 1
a2077 1
    {"movntsd", { Ev, XM } },
d2380 1
a2380 1
    { "roundss", { XM, EXx, Ib } },
d2388 1
a2388 1
    { "roundsd", { XM, EXx, Ib } },
@


1.128
log
@gas/testsuite/

2007-07-16  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/simd.s: Add tests for punpcklbw, punpckldq,
	punpcklwd and punpcklqdq.
	* gas/i386/x86-64-simd.s: Likewise.

	* gas/i386/simd-intel.d: Updated.
	* gas/i386/simd.d: Likewise.
	* gas/i386/x86-64-simd-intel.d: Likewise.
	* gas/i386/x86-64-simd.d: Likewise.

opcodes/

2007-07-16  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (EMq): Removed.
	(EMx): New.
	(prefix_user_table): Replace EMq with EMx.
@
text
@d1022 1
a1022 1
  { "movd",		{ MX, Edq } },
d1991 1
a1991 1
    { "movq",	{ EXx,  XM } },
d2003 3
a2005 3
    { "movd",	{ Edq, MX } },
    { "movq",	{ XM, EXx } },
    { "movd",	{ Edq, XM } },
@


1.127
log
@Change source files over to GPLv3.
@
text
@d312 1
a312 1
#define EMq { OP_EM, q_mode }
d2571 1
a2571 1
    { "punpcklbw",{ MX, EMq } },
d2579 1
a2579 1
    { "punpcklwd",{ MX, EMq } },
d2587 1
a2587 1
    { "punpckldq",{ MX, EMq } },
@


1.126
log
@gas/testsuite/

2007-06-23  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4667
	* gas/i386/i386.exp: Run simd, simd-intel, x86-64-simd
	and x86-64-simd-intel.

	* gas/i386/opcode-intel.d: Updated.

	* gas/i386/simd-intel.d: New.
	* gas/i386/simd.d: Likewise.
	* gas/i386/simd.s: Likewise.
	* gas/i386/x86-64-simd-intel.d: Likewise.
	* gas/i386/x86-64-simd.d: Likewise.
	* gas/i386/x86-64-simd.s: Likewise.

opcodes/

2007-06-23  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4667
	* i386-dis.c (EX): Removed.
	(EMd): New.
	(EMq): Likewise.
	(EXd): Likewise.
	(EXq): Likewise.
	(EXx): Likewise.
	(PREGRP93...PREGRP97): Likewise.
	(dis386_twobyte): Updated.
	(prefix_user_table): Updated. Add PREGRP93...PREGRP97.
	(OP_EX): Remove Intel syntax handling.
@
text
@d3 1
a3 1
   2001, 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
d5 1
a5 1
   This file is part of GDB.
d7 1
a7 1
   This program is free software; you can redistribute it and/or modify
d9 2
a10 2
   the Free Software Foundation; either version 2 of the License, or
   (at your option) any later version.
d12 4
a15 4
   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.
d19 3
a21 1
   Foundation, Inc., 51 Franklin Street - Fifth Floor, Boston, MA 02110-1301, USA.  */
@


1.125
log
@gas/testsuite/

2007-05-14  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4502
	* gas/i386/amd.d: Replace "pfmulhrw" with "pmulhrw".

opcodes/

2007-05-14  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4502
	* i386-dis.c (Suffix3DNow): Replace "pfmulhrw" with "pmulhrw".
@
text
@d309 5
a313 1
#define EX { OP_EX, v_mode }
d537 5
d918 3
a920 3
  { "movlpX",		{ EX, XM, { SIMD_Fixup, 'h' } } },
  { "unpcklpX",		{ XM, EX } },
  { "unpckhpX",		{ XM, EX } },
d922 1
a922 1
  { "movhpX",		{ EX, XM, { SIMD_Fixup, 'l' } } },
d942 2
a943 2
  { "movapX",		{ XM, EX } },
  { "movapX",		{ EX, XM } },
d948 2
a949 2
  { "ucomisX",		{ XM,EX } },
  { "comisX",		{ XM,EX } },
d991 4
a994 4
  { "andpX",		{ XM, EX } },
  { "andnpX",		{ XM, EX } },
  { "orpX",		{ XM, EX } },
  { "xorpX",		{ XM, EX } },
d1005 3
a1007 3
  { "punpcklbw",	{ MX, EM } },
  { "punpcklwd",	{ MX, EM } },
  { "punpckldq",	{ MX, EM } },
d1119 1
a1119 1
  { "shufpX",		{ XM, EX, Ib } },
d1840 4
a1843 4
    { "addps", { XM, EX } },
    { "addss", { XM, EX } },
    { "addpd", { XM, EX } },
    { "addsd", { XM, EX } },
d1847 4
a1850 4
    { "", { XM, EX, OPSIMD } },	/* See OP_SIMD_SUFFIX.  */
    { "", { XM, EX, OPSIMD } },
    { "", { XM, EX, OPSIMD } },
    { "", { XM, EX, OPSIMD } },
d1861 4
a1864 4
    { "cvtps2pi", { MXC, EX } },
    { "cvtss2siY", { Gv, EX } },
    { "cvtpd2pi", { MXC, EX } },
    { "cvtsd2siY", { Gv, EX } },
d1868 4
a1871 4
    { "cvttps2pi", { MXC, EX } },
    { "cvttss2siY", { Gv, EX } },
    { "cvttpd2pi", { MXC, EX } },
    { "cvttsd2siY", { Gv, EX } },
d1875 4
a1878 4
    { "divps",	{ XM, EX } },
    { "divss",	{ XM, EX } },
    { "divpd",	{ XM, EX } },
    { "divsd",	{ XM, EX } },
d1882 4
a1885 4
    { "maxps",	{ XM, EX } },
    { "maxss",	{ XM, EX } },
    { "maxpd",	{ XM, EX } },
    { "maxsd",	{ XM, EX } },
d1889 4
a1892 4
    { "minps",	{ XM, EX } },
    { "minss",	{ XM, EX } },
    { "minpd",	{ XM, EX } },
    { "minsd",	{ XM, EX } },
d1896 4
a1899 4
    { "movups",	{ XM, EX } },
    { "movss",	{ XM, EX } },
    { "movupd",	{ XM, EX } },
    { "movsd",	{ XM, EX } },
d1903 4
a1906 4
    { "movups",	{ EX, XM } },
    { "movss",	{ EX, XM } },
    { "movupd",	{ EX, XM } },
    { "movsd",	{ EX, XM } },
d1910 4
a1913 4
    { "mulps",	{ XM, EX } },
    { "mulss",	{ XM, EX } },
    { "mulpd",	{ XM, EX } },
    { "mulsd",	{ XM, EX } },
d1917 4
a1920 4
    { "rcpps",	{ XM, EX } },
    { "rcpss",	{ XM, EX } },
    { "(bad)",	{ XM, EX } },
    { "(bad)",	{ XM, EX } },
d1924 4
a1927 4
    { "rsqrtps",{ XM, EX } },
    { "rsqrtss",{ XM, EX } },
    { "(bad)",	{ XM, EX } },
    { "(bad)",	{ XM, EX } },
d1931 4
a1934 4
    { "sqrtps", { XM, EX } },
    { "sqrtss", { XM, EX } },
    { "sqrtpd", { XM, EX } },
    { "sqrtsd",	{ XM, EX } },
d1938 4
a1941 4
    { "subps",	{ XM, EX } },
    { "subss",	{ XM, EX } },
    { "subpd",	{ XM, EX } },
    { "subsd",	{ XM, EX } },
d1945 4
a1948 4
    { "(bad)",	{ XM, EX } },
    { "cvtdq2pd", { XM, EX } },
    { "cvttpd2dq", { XM, EX } },
    { "cvtpd2dq", { XM, EX } },
d1952 4
a1955 4
    { "cvtdq2ps", { XM, EX } },
    { "cvttps2dq", { XM, EX } },
    { "cvtps2dq", { XM, EX } },
    { "(bad)",	{ XM, EX } },
d1959 4
a1962 4
    { "cvtps2pd", { XM, EX } },
    { "cvtss2sd", { XM, EX } },
    { "cvtpd2ps", { XM, EX } },
    { "cvtsd2ss", { XM, EX } },
d1967 1
a1967 1
    { "(bad)",	{ XM, EX } },
d1969 1
a1969 1
    { "(bad)",	{ XM, EX } },
d1974 3
a1976 3
    { "movdqu",	{ XM, EX } },
    { "movdqa",	{ XM, EX } },
    { "(bad)",	{ XM, EX } },
d1981 3
a1983 3
    { "movdqu",	{ EX, XM } },
    { "movdqa",	{ EX, XM } },
    { "(bad)",	{ EX, XM } },
d1987 1
a1987 1
    { "(bad)",	{ EX, XM } },
d1989 1
a1989 1
    { "movq",	{ EX, XM } },
d1995 3
a1997 3
    { "pshufhw",{ XM, EX, Ib } },
    { "pshufd",	{ XM, EX, Ib } },
    { "pshuflw",{ XM, EX, Ib } },
d2002 1
a2002 1
    { "movq",	{ XM, EX } },
d2008 4
a2011 4
    { "(bad)",	{ MX, EX } },
    { "(bad)",	{ XM, EX } },
    { "punpckhqdq", { XM, EX } },
    { "(bad)",	{ XM, EX } },
d2022 4
a2025 4
    { "(bad)",	{ MX, EX } },
    { "(bad)",	{ XM, EX } },
    { "punpcklqdq", { XM, EX } },
    { "(bad)",	{ XM, EX } },
d2029 4
a2032 4
    { "(bad)",	{ MX, EX } },
    { "(bad)",	{ XM, EX } },
    { "addsubpd", { XM, EX } },
    { "addsubps", { XM, EX } },
d2036 4
a2039 4
    { "(bad)",	{ MX, EX } },
    { "(bad)",	{ XM, EX } },
    { "haddpd",	{ XM, EX } },
    { "haddps",	{ XM, EX } },
d2043 4
a2046 4
    { "(bad)",	{ MX, EX } },
    { "(bad)",	{ XM, EX } },
    { "hsubpd",	{ XM, EX } },
    { "hsubps",	{ XM, EX } },
d2050 4
a2053 4
    { "movlpX",	{ XM, EX, { SIMD_Fixup, 'h' } } }, /* really only 2 operands */
    { "movsldup", { XM, EX } },
    { "movlpd",	{ XM, EX } },
    { "movddup", { XM, EX } },
d2057 4
a2060 4
    { "movhpX",	{ XM, EX, { SIMD_Fixup, 'l' } } },
    { "movshdup", { XM, EX } },
    { "movhpd",	{ XM, EX } },
    { "(bad)",	{ XM, EX } },
d2064 3
a2066 3
    { "(bad)",	{ XM, EX } },
    { "(bad)",	{ XM, EX } },
    { "(bad)",	{ XM, EX } },
d2121 1
a2121 1
    { "pblendvb", {XM, EX, XMM0 } },
d2129 1
a2129 1
    { "blendvps", {XM, EX, XMM0 } },
d2137 1
a2137 1
    { "blendvpd", { XM, EX, XMM0 } },
d2145 1
a2145 1
    { "ptest",  { XM, EX } },
d2153 1
a2153 1
    { "pmovsxbw", { XM, EX } },
d2161 1
a2161 1
    { "pmovsxbd", { XM, EX } },
d2169 1
a2169 1
    { "pmovsxbq", { XM, EX } },
d2177 1
a2177 1
    { "pmovsxwd", { XM, EX } },
d2185 1
a2185 1
    { "pmovsxwq", { XM, EX } },
d2193 1
a2193 1
    { "pmovsxdq", { XM, EX } },
d2201 1
a2201 1
    { "pmuldq", { XM, EX } },
d2209 1
a2209 1
    { "pcmpeqq", { XM, EX } },
d2225 1
a2225 1
    { "packusdw", { XM, EX } },
d2233 1
a2233 1
    { "pmovzxbw", { XM, EX } },
d2241 1
a2241 1
    { "pmovzxbd", { XM, EX } },
d2249 1
a2249 1
    { "pmovzxbq", { XM, EX } },
d2257 1
a2257 1
    { "pmovzxwd", { XM, EX } },
d2265 1
a2265 1
    { "pmovzxwq", { XM, EX } },
d2273 1
a2273 1
    { "pmovzxdq", { XM, EX } },
d2281 1
a2281 1
    { "pminsb",	{ XM, EX } },
d2289 1
a2289 1
    { "pminsd",	{ XM, EX } },
d2297 1
a2297 1
    { "pminuw",	{ XM, EX } },
d2305 1
a2305 1
    { "pminud",	{ XM, EX } },
d2313 1
a2313 1
    { "pmaxsb",	{ XM, EX } },
d2321 1
a2321 1
    { "pmaxsd",	{ XM, EX } },
d2329 1
a2329 1
    { "pmaxuw", { XM, EX } },
d2337 1
a2337 1
    { "pmaxud", { XM, EX } },
d2345 1
a2345 1
    { "pmulld", { XM, EX } },
d2353 1
a2353 1
    { "phminposuw", { XM, EX } },
d2361 1
a2361 1
    { "roundps", { XM, EX, Ib } },
d2369 1
a2369 1
    { "roundpd", { XM, EX, Ib } },
d2377 1
a2377 1
    { "roundss", { XM, EX, Ib } },
d2385 1
a2385 1
    { "roundsd", { XM, EX, Ib } },
d2393 1
a2393 1
    { "blendps", { XM, EX, Ib } },
d2401 1
a2401 1
    { "blendpd", { XM, EX, Ib } },
d2409 1
a2409 1
    { "pblendw", { XM, EX, Ib } },
d2457 1
a2457 1
    { "insertps", { XM, EX, Ib } },
d2473 1
a2473 1
    { "dpps",	{ XM, EX, Ib } },
d2481 1
a2481 1
    { "dppd",	{ XM, EX, Ib } },
d2489 1
a2489 1
    { "mpsadbw", { XM, EX, Ib } },
d2497 1
a2497 1
    { "pcmpgtq", { XM, EX } },
d2521 1
a2521 1
    { "pcmpestrm", { XM, EX, Ib } },
d2529 1
a2529 1
    { "pcmpestri", { XM, EX, Ib } },
d2537 1
a2537 1
    { "pcmpistrm", { XM, EX, Ib } },
d2545 41
a2585 1
    { "pcmpistri", { XM, EX, Ib } },
a5849 11
      if (intel_syntax && bytemode == v_mode)
	{
	  switch (prefixes & (PREFIX_DATA|PREFIX_REPZ|PREFIX_REPNZ))
	    {
	    case 0:            bytemode = x_mode; break;
	    case PREFIX_REPZ:  bytemode = d_mode; used_prefixes |= PREFIX_REPZ;  break;
	    case PREFIX_DATA:  bytemode = x_mode; used_prefixes |= PREFIX_DATA;  break;
	    case PREFIX_REPNZ: bytemode = q_mode; used_prefixes |= PREFIX_REPNZ; break;
	    default:           bytemode = 0; break;
	    }
	}
@


1.124
log
@2007-05-07  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (threebyte_0x38_uses_DATA_prefix): Correct entries
	for some SSE4 instructions.
	(threebyte_0x3a_uses_DATA_prefix): Likewise.
@
text
@d5957 1
a5957 1
/* B4 */	"pfmul",	NULL,		"pfrcpit2",	"pfmulhrw",
@


1.123
log
@gas/

2007-05-03  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c (match_template): Don't explicitly check
	suffix for crc32 in Intel mode.
	(process_suffix): Issue an error for crc32 if the operand size
	is ambiguous.

gas/testsuite/

2007-05-03  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/crc32-intel.d: Updated.
	* gas/i386/crc32.d: Likewise.
	* gas/i386/sse4_2.d: Likewise.
	* gas/i386/x86-64-crc32-intel.d: Likewise.
	* gas/i386/x86-64-crc32.d: Likewise.
	* gas/i386/x86-64-sse4_2.d: Likewise.

	* gas/i386/crc32.s: Remove crc32 instructions with ambiguous
	operand size and suffix in crc32 instructions in Intel mode.
	* gas/i386/x86-64-crc32.s: Likewise.

	* gas/i386/sse4_2.s: Remove crc32 instructions with ambiguous
	operand size.
	* gas/i386/x86-64-sse4_2.s: Likewise.

	* gas/i386/i386.exp: Run inval-crc32 and x86-64-inval-crc32.

	* gas/i386/inval-crc32.l: New.
	* gas/i386/inval-crc32.s: Likewise.
	* gas/i386/x86-64-inval-crc32.l: Likewise.
	* gas/i386/x86-64-inval-crc32.s: Likewise.

opcodes/

2007-05-03  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (CRC32_Fixup): Don't print suffix in Intel mode.

	* i386-opc.c (i386_optab): Remove IgnoreSize and correct operand
	type for crc32.
@
text
@d1297 1
a1297 1
  /* 10 */ 0,0,0,0,1,1,0,1,0,0,0,0,1,1,1,0, /* 1f */
d1374 1
a1374 1
  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
@


1.122
log
@gas/config/

2007-05-01  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c (match_template): Check suffix for crc32 in
	Intel mdoe.
	(process_suffix): Default the suffix of 8bit crc32 to
	BYTE_MNEM_SUFFIX.
	(check_byte_reg): Skip check for 8bit crc32.

gas/testsuite/

2007-05-01  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/crc32-intel.d: New file.
	* gas/i386/crc32.d:Likewise.
	* gas/i386/crc32.s:Likewise.
	* gas/i386/x86-64-crc32-intel.d:Likewise.
	* gas/i386/x86-64-crc32.d:Likewise.
	* gas/i386/x86-64-crc32.s:Likewise.

	* gas/i386/i386.exp: Run crc32, crc32-intel, x86-64-crc32
	and x86-64-crc32-intel.

opcodes/

2007-05-01  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (CRC32_Fixup): Properly handle Intel mode and
	check data size prefix in 16bit mode.

	* i386-opc.c (i386_optab): Default crc32 to non-8bit and
	support Intel mode.
@
text
@d6387 3
d6393 3
d6400 1
a6400 1
	*p++ = intel_syntax ? 'd' : 'l';
@


1.121
log
@2007-04-27  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (modrm): Put reg before rm.
@
text
@d6393 2
a6394 5
      else if ((prefixes & PREFIX_DATA))
	{
	  *p++ = 'w';
	  used_prefixes |= (prefixes & PREFIX_DATA);
	}
d6396 2
a6397 1
	*p++ = 'l';
d6435 1
a6435 1
    OP_E (v_mode, sizeflag);
@


1.120
log
@gas/testsuite/

2007-04-26  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4430
	* gas/i386/amd.d: Updated.
	* gas/i386/immed32.d: Likewise.
	* gas/i386/intel.d: Likewise.
	* gas/i386/intel16.d: Likewise.
	* gas/i386/intelok.d: Likewise.
	* gas/i386/jump16.d: Likewise.
	* gas/i386/naked.d: Likewise.
	* gas/i386/opcode-suffix.d: Likewise.
	* gas/i386/opcode.d: Likewise.
	* gas/i386/prescott.d: Likewise.
	* gas/i386/ssemmx2.d: Likewise.
	* gas/i386/tlsd.d: Likewise.
	* gas/i386/tlspic.d: Likewise.
	* gas/i386/x86-64-addr32.d: Likewise.
	* gas/i386/x86-64-prescott.d: Likewise.
	* gas/i386/x86-64-rip.d: Likewise.
	* gas/i386/x86_64.d: Likewise.

ld/testsuite/

2007-04-26  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4430
	* ld-i386/tlsbin.dd: Updated.
	* ld-i386/tlsbindesc.dd: Likewise
	* ld-i386/tlsdesc.dd: Likewise
	* ld-i386/tlsgdesc.dd: Likewise
	* ld-i386/tlsnopic.dd: Likewise
	* ld-i386/tlspic.dd: Likewise
	* ld-x86-64/tlsbin.dd: Likewise
	* ld-x86-64/tlsbindesc.dd: Likewise
	* ld-x86-64/tlsdesc.dd: Likewise
	* ld-x86-64/tlsgdesc.dd: Likewise
	* ld-x86-64/tlspic.dd: Likewise

opcodes/

2007-04-26  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4430
	* i386-dis.c (print_displacement): New.
	(OP_E): Call print_displacement instead of print_operand_value
	to output displacement when either base or index exist.  Print
	the explicit zero displacement in 16bit mode.
@
text
@d1446 1
a1447 1
    int reg;
@


1.119
log
@gas/testsuite/

2007-04-26  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4429
	* gas/i386/i386.exp: Run "x86-64-addr32-intel" and
	"x86-64-rip-intel".

	* gas/i386/intelok.d: Updated.

	* gas/i386/x86-64-addr32-intel.d: New file.
	* gas/i386/x86-64-rip-intel.d: Likewise.

opcodes/

2007-04-26  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4429
	* i386-dis.c (print_insn): Also swap the order of op_riprel
	when swapping op_index.  Break when the RIP relative address
	is printed.
	(OP_E): Properly handle RIP relative addressing and print the
	explicit zero displacement for Intel mode.
@
text
@d53 1
d4633 44
d4827 1
a4827 1
  if ((sizeflag & AFLAG) || address_mode == mode_64bit) /* 32 bit address mode */
d4829 2
d4879 2
d4884 4
a4887 1
	    print_operand_value (scratchbuf, !riprel, disp);
d4896 1
a4896 3
      if (havebase
	  || (intel_syntax && riprel)
	  || (havesib && (index != 4 || scale != 0)))
d4943 1
a4943 1
	      print_operand_value (scratchbuf, modrm.mod != 1, disp);
d4995 1
a4995 1
	    print_operand_value (scratchbuf, 0, disp);
d5004 2
a5005 1
	  if (intel_syntax && disp)
d5007 1
a5007 1
	      if ((bfd_signed_vma) disp > 0)
d5019 1
a5019 1
	      print_operand_value (scratchbuf, modrm.mod != 1, disp);
@


1.118
log
@gas/

2007-04-18  H.J. Lu <hongjiu.lu@@intel.com>

	* config/tc-i386.c (cpu_arch): Add .sse4.2 and .sse4.
	(match_template): Handle operand size for crc32 in SSE4.2.
	(process_suffix): Handle operand type for crc32 in SSE4.2.
	(output_insn): Support SSE4.2.

gas/testsuite/

2007-04-18  H.J. Lu <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Add sse4.2 and x86-64-sse4.2.

	* gas/i386/sse4_2.d: New file.
	* gas/i386/sse4_2.s: Likewise.
	* gas/i386/x86-64-sse4_2.d: Likewise.
	* gas/i386/x86-64-sse4_2.s: Likewise.

opcodes/

2007-04-18  H.J. Lu <hongjiu.lu@@intel.com>

	* i386-dis.c (CRC32_Fixup): New.
	(PREGRP85, PREGRP86, PREGRP87, PREGRP88, PREGRP89, PREGRP90,
	 PREGRP91): New.
	(threebyte_0x38_uses_DATA_prefix): Updated for SSE4.2.
	(threebyte_0x3a_uses_DATA_prefix): Likewise.
	(prefix_user_table): Add PREGRP85, PREGRP86, PREGRP87,
	PREGRP88, PREGRP89, PREGRP90 and PREGRP91.
	(three_byte_table): Likewise.

	* i386-opc.c (i386_optab): Add SSE4.2 opcodes.

	* gas/config/tc-i386.h (CpuSSE4_2): New.
	(CpuSSE4): Likewise.
	(CpuUnknownFlags): Add CpuSSE4_2.
@
text
@d3776 2
d3786 3
d3816 1
d4844 3
a4846 1
      if (havebase || (havesib && (index != 4 || scale != 0)))
d4850 4
a4853 1
	    oappend ("rip + ");
d4878 2
a4879 1
	  if (intel_syntax && disp)
d4881 1
a4881 1
	      if ((bfd_signed_vma) disp > 0)
@


1.117
log
@gas/

2007-04-18  H.J. Lu <hongjiu.lu@@intel.com>

	* config/tc-i386.c (cpu_arch): Add .sse4.1.
	(process_operands): Adjust implicit operand for blendvpd,
	blendvps and pblendvb in SSE4.1.
	(output_insn): Support SSE4.1.

gas/testsuite/

2007-04-18  H.J. Lu <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Add sse4.1 and x86-64-sse4.1.

	* gas/i386/sse4_1.d: New file.
	* gas/i386/sse4_1.s: Likewise.
	* gas/i386/x86-64-sse4_1.d: Likewise.
	* gas/i386/x86-64-sse4_1.s: Likewise.

opcodes/

2007-04-18  H.J. Lu <hongjiu.lu@@intel.com>

	* i386-dis.c (XMM_Fixup): New.
	(Edqb): New.
	(Edqd): New.
	(XMM0): New.
	(dqb_mode): New.
	(dqd_mode): New.
	(PREGRP39 ... PREGRP85): New.
	(threebyte_0x38_uses_DATA_prefix): Updated for SSE4.
	(threebyte_0x3a_uses_DATA_prefix): Likewise.
	(prefix_user_table): Add PREGRP39 ... PREGRP85.
	(three_byte_table): Likewise.
	(putop): Handle 'K'.
	(intel_operand_size): Handle dqb_mode, dqd_mode):
	(OP_E): Likewise.
	(OP_G): Likewise.

	* i386-opc.c (i386_optab): Add SSE4.1 opcodes.

	* i386-opc.h (CpuSSE4_1): New.
	(CpuUnknownFlags): Add CpuSSE4_1.
	(regKludge): Update comment.
@
text
@d102 1
d525 7
d1298 1
a1298 1
  /* 30 */ 1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1, /* 3f */
d1334 1
a1334 1
  /* f0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
d2482 56
d2624 1
a2624 1
    { "(bad)", { XX } },
d2833 2
a2834 2
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2962 4
a2965 4
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d6314 62
@


1.116
log
@2007-04-13  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c: Remove trailing white spaces.
@
text
@d101 1
d204 2
d315 1
d352 2
d477 47
d559 1
d1288 4
a1291 4
  /* 10 */ 0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0, /* 1f */
  /* 20 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 2f */
  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
d1359 3
a1361 3
  /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1, /* 0f */
  /* 10 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 1f */
  /* 20 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 2f */
d1363 1
a1363 1
  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
d2098 376
d2517 1
d2521 2
d2524 1
a2524 4
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2535 6
a2540 6
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2544 4
a2547 4
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2553 6
a2558 6
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2562 8
a2569 8
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2571 2
a2572 2
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2799 7
a2805 7
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2812 4
a2815 4
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2826 3
a2828 3
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d2862 3
a2864 3
    { "(bad)", { XX } },
    { "(bad)", { XX } },
    { "(bad)", { XX } },
d4272 7
d4568 1
d4602 1
d4686 2
d4942 2
d6243 7
@


1.115
log
@2007-04-11  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4333
	* i386-dis.c (GRP1a): New.
	(GRP1b ... GRPPADLCK2): Update index.
	(dis386): Use GRP1a for entry 0x8f.
	(mod, rm, reg): Removed. Replaced by ...
	(modrm): This.
	(grps): Add GRP1a.
@
text
@d1229 1
a1229 1
/* This is used to determine if opcode 0f 38 XX uses DATA prefix.  */ 
d1253 1
a1253 1
/* This is used to determine if opcode 0f 38 XX uses REPNZ prefix.  */ 
d1277 1
a1277 1
/* This is used to determine if opcode 0f 38 XX uses REPZ prefix.  */ 
d1301 1
a1301 1
/* This is used to determine if opcode 0f 3a XX uses DATA prefix.  */ 
d1325 1
a1325 1
/* This is used to determine if opcode 0f 3a XX uses REPNZ prefix.  */ 
d1349 1
a1349 1
/* This is used to determine if opcode 0f 3a XX uses REPZ prefix.  */ 
d2012 2
a2013 2
  
 /* PREGRP35 */  
d2019 1
a2019 1
  }, 
d2034 1
a2034 1
    { "(bad)", { XX } },    
d2042 1
a2042 1
    { "(bad)", { XX } },    
d3128 1
a3128 1
  
d3241 1
a3241 1
	      obufp = op_out[i];		  
d3284 1
a3284 1
	
d5190 4
a5193 4
/* cvt* are the only instructions in sse2 which have 
   both SSE and MMX operands and also have 0x66 prefix 
   in their opcode. 0x66 was originally used to differentiate 
   between SSE and MMX instruction(operands). So we have to handle the 
d5208 1
a5208 1
  
d5317 1
a5317 1
   32bit mode and "xchg %rax,%rax" in 64bit mode.  */  
d5722 1
a5722 1
    switch (*insn_codep) 
@


1.114
log
@gas/

2003-03-23  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c (md_begin): Allow '.' in mnemonic.

gas/testsuite/

2003-03-23  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/rex.s: Add tests for rex.WRXB.
	* gas/i386/rex.d: Updated.

	* gas/i386/rex.d: Replace rex64XYZ with rex.WRXB.
	* gas/i386/x86-64-io-intel.d : Likewise.
	* gas/i386/x86-64-io-suffix.d: Likewise.
	* gas/i386/x86-64-io.d: Likewise.
	* gas/i386/x86-64-opcode.d: Likewise.

opcodes/

2003-03-23  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (prefix_name): Replace rex64XYZ with rex.WRXB.

	* i386-opc.c (i386_optab): Add rex.wrxb.
@
text
@d403 28
a430 27
#define GRP1b	  NULL, { { NULL, USE_GROUPS }, { NULL,  0 } }
#define GRP1S	  NULL, { { NULL, USE_GROUPS }, { NULL,  1 } }
#define GRP1Ss	  NULL, { { NULL, USE_GROUPS }, { NULL,  2 } }
#define GRP2b	  NULL, { { NULL, USE_GROUPS }, { NULL,  3 } }
#define GRP2S	  NULL, { { NULL, USE_GROUPS }, { NULL,  4 } }
#define GRP2b_one NULL, { { NULL, USE_GROUPS }, { NULL,  5 } }
#define GRP2S_one NULL, { { NULL, USE_GROUPS }, { NULL,  6 } }
#define GRP2b_cl  NULL, { { NULL, USE_GROUPS }, { NULL,  7 } }
#define GRP2S_cl  NULL, { { NULL, USE_GROUPS }, { NULL,  8 } }
#define GRP3b	  NULL, { { NULL, USE_GROUPS }, { NULL,  9 } }
#define GRP3S	  NULL, { { NULL, USE_GROUPS }, { NULL, 10 } }
#define GRP4	  NULL, { { NULL, USE_GROUPS }, { NULL, 11 } }
#define GRP5	  NULL, { { NULL, USE_GROUPS }, { NULL, 12 } }
#define GRP6	  NULL, { { NULL, USE_GROUPS }, { NULL, 13 } }
#define GRP7	  NULL, { { NULL, USE_GROUPS }, { NULL, 14 } }
#define GRP8	  NULL, { { NULL, USE_GROUPS }, { NULL, 15 } }
#define GRP9	  NULL, { { NULL, USE_GROUPS }, { NULL, 16 } }
#define GRP11_C6  NULL, { { NULL, USE_GROUPS }, { NULL, 17 } }
#define GRP11_C7  NULL, { { NULL, USE_GROUPS }, { NULL, 18 } }
#define GRP12	  NULL, { { NULL, USE_GROUPS }, { NULL, 19 } }
#define GRP13	  NULL, { { NULL, USE_GROUPS }, { NULL, 20 } }
#define GRP14	  NULL, { { NULL, USE_GROUPS }, { NULL, 21 } }
#define GRP15	  NULL, { { NULL, USE_GROUPS }, { NULL, 22 } }
#define GRP16	  NULL, { { NULL, USE_GROUPS }, { NULL, 23 } }
#define GRPAMD	  NULL, { { NULL, USE_GROUPS }, { NULL, 24 } }
#define GRPPADLCK1 NULL, { { NULL, USE_GROUPS }, { NULL, 25 } }
#define GRPPADLCK2 NULL, { { NULL, USE_GROUPS }, { NULL, 26 } }
d694 1
a694 1
  { "popU",		{ stackEv } },
d1380 7
a1386 3
static int mod;
static int rm;
static int reg;
d1455 11
d3177 3
a3179 3
      mod = (*codep >> 6) & 3;
      reg = (*codep >> 3) & 7;
      rm = *codep & 7;
d3184 3
a3186 3
      mod = (*codep >> 6) & 3;
      reg = (*codep >> 3) & 7;
      rm = *codep & 7;
d3201 1
a3201 1
	      dp = &grps[dp->op[1].bytemode][reg];
d3645 1
a3645 1
  if (mod != 3)
d3647 1
a3647 1
      int fp_indx = (floatop - 0xd8) * 8 + reg;
d3659 1
a3659 1
  dp = &float_reg[floatop - 0xd8][reg];
d3662 1
a3662 1
      putop (fgrps[dp->op[0].bytemode][rm], sizeflag);
d3693 1
a3693 1
  sprintf (scratchbuf, "%%st(%d)", rm);
d3749 1
a3749 1
	  if (mod != 3 || (sizeflag & SUFFIX_ALWAYS))
d3774 1
a3774 1
	  if (mod == 3)
d3908 1
a3908 1
	      if (mod != 3 || (sizeflag & SUFFIX_ALWAYS))
d3917 1
a3917 1
	  if (mod != 3 || (sizeflag & SUFFIX_ALWAYS))
d4210 1
a4210 1
  if (mod == 3)
d4217 1
a4217 1
	    oappend (names8rex[rm + add]);
d4219 1
a4219 1
	    oappend (names8[rm + add]);
d4222 1
a4222 1
	  oappend (names16[rm + add]);
d4225 1
a4225 1
	  oappend (names32[rm + add]);
d4228 1
a4228 1
	  oappend (names64[rm + add]);
d4232 1
a4232 1
	    oappend (names64[rm + add]);
d4234 1
a4234 1
	    oappend (names32[rm + add]);
d4239 1
a4239 1
	      oappend (names64[rm + add]);
d4250 1
a4250 1
	    oappend (names64[rm + add]);
d4252 1
a4252 1
	    oappend (names32[rm + add]);
d4254 1
a4254 1
	    oappend (names16[rm + add]);
d4281 1
a4281 1
      base = rm;
d4299 1
a4299 1
      switch (mod)
d4322 1
a4322 1
	if (mod != 0 || (base & 7) == 5)
d4369 1
a4369 1
	      else if (mod != 1)
d4376 1
a4376 1
	      print_operand_value (scratchbuf, mod != 1, disp);
d4385 1
a4385 1
	  if (mod != 0 || (base & 7) == 5)
d4402 1
a4402 1
      switch (mod)
d4405 1
a4405 1
	  if (rm == 6)
d4426 1
a4426 1
	if (mod != 0 || rm == 6)
d4432 1
a4432 1
      if (mod != 0 || rm != 6)
d4436 1
a4436 1
	  oappend (index16[rm]);
d4444 1
a4444 1
	      else if (mod != 1)
d4451 1
a4451 1
	      print_operand_value (scratchbuf, mod != 1, disp);
d4486 1
a4486 1
	oappend (names8rex[reg + add]);
d4488 1
a4488 1
	oappend (names8[reg + add]);
d4491 1
a4491 1
      oappend (names16[reg + add]);
d4494 1
a4494 1
      oappend (names32[reg + add]);
d4497 1
a4497 1
      oappend (names64[reg + add]);
d4504 1
a4504 1
	oappend (names64[reg + add]);
d4506 1
a4506 1
	oappend (names32[reg + add]);
d4508 1
a4508 1
	oappend (names16[reg + add]);
d4513 1
a4513 1
	oappend (names64[reg + add]);
d4515 1
a4515 1
	oappend (names32[reg + add]);
d4918 1
a4918 1
    oappend (names_seg[reg]);
d4920 1
a4920 1
    OP_E (mod == 3 ? bytemode : w_mode, sizeflag);
d5096 1
a5096 1
  sprintf (scratchbuf, "%%cr%d", reg + add);
d5108 1
a5108 1
    sprintf (scratchbuf, "db%d", reg + add);
d5110 1
a5110 1
    sprintf (scratchbuf, "%%db%d", reg + add);
d5117 1
a5117 1
  sprintf (scratchbuf, "%%tr%d", reg);
d5124 1
a5124 1
  if (mod == 3)
d5140 1
a5140 1
      sprintf (scratchbuf, "%%xmm%d", reg + add);
d5143 1
a5143 1
    sprintf (scratchbuf, "%%mm%d", reg);
d5154 1
a5154 1
  sprintf (scratchbuf, "%%xmm%d", reg + add);
d5161 1
a5161 1
  if (mod != 3)
d5183 1
a5183 1
      sprintf (scratchbuf, "%%xmm%d", rm + add);
d5186 1
a5186 1
    sprintf (scratchbuf, "%%mm%d", rm);
d5198 1
a5198 1
  if (mod != 3)
d5213 1
a5213 1
  sprintf (scratchbuf, "%%mm%d", rm);
d5221 1
a5221 1
  sprintf (scratchbuf, "%%mm%d", reg);
d5229 1
a5229 1
  if (mod != 3)
d5252 1
a5252 1
  sprintf (scratchbuf, "%%xmm%d", rm + add);
d5259 1
a5259 1
  if (mod == 3)
d5268 1
a5268 1
  if (mod == 3)
d5277 1
a5277 1
  if (mod == 3)
d5287 1
a5287 1
  if (mod != 3 || rm != 0)
d5296 1
a5296 1
  if (mod == 3)
d5298 1
a5298 1
      if (reg == 7)
d5301 1
a5301 1
      if (reg < 5 || rm != 0)
d5307 1
a5307 1
  else if (reg != 7)
d5489 1
a5489 1
  if (mod == 3)
d5503 1
a5503 1
  if (mod == 3 && reg == 1 && rm <= 1)
d5525 1
a5525 1
      if (rm)
d5667 4
a5670 1
  if (mod == 3 && reg == 0 && rm >=1 && rm <= 4)
d5679 1
a5679 1
      switch (rm)
@


1.113
log
@gas/

2003-03-21  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c: Replace REX_MODE64, REX_EXTX, REX_EXTY
	and REX_EXTZ with REX_W, REX_R, REX_X and REX_B respectively.

include/opcode/

2003-03-21  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386.h (REX_MODE64): Renamed to ...
	(REX_W): This.
	(REX_EXTX): Renamed to ...
	(REX_R): This.
	(REX_EXTY): Renamed to ...
	(REX_X): This.
	(REX_EXTZ): Renamed to ...
	(REX_B): This.

opcodes/

2003-03-21  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (REX_MODE64): Remove definition.
	(REX_EXTX): Likewise.
	(REX_EXTY): Likewise.
	(REX_EXTZ): Likewise.
	(USED_REX): Use REX_OPCODE instead of 0x40.
	Replace REX_MODE64, REX_EXTX, REX_EXTY and REX_EXTZ with REX_W,
	REX_R, REX_X and REX_B respectively.
@
text
@d2737 20
a2760 1
      return "rex";
a2761 1
      return "rexZ";
a2762 1
      return "rexY";
a2763 1
      return "rexYZ";
a2764 1
      return "rexX";
a2765 1
      return "rexXZ";
a2766 1
      return "rexXY";
a2767 1
      return "rexXYZ";
a2768 1
      return "rex64";
a2769 1
      return "rex64Z";
a2770 1
      return "rex64Y";
a2771 1
      return "rex64YZ";
a2772 1
      return "rex64X";
a2773 1
      return "rex64XZ";
a2774 1
      return "rex64XY";
d2776 1
a2776 1
      return "rex64XYZ";
@


1.112
log
@gas/

2003-03-21  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4218
	* config/tc-i386.c (match_template): Properly handle 64bit mode
	"xchg %eax, %eax".

gas/testsuite/

2003-03-21  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4218
	* gas/i386/nops.s: Add testcases for nop r/m.
	* gas/i386/x86-64-nops.s: Likewise.

	* gas/i386/x86-64-opcode.s: Add testcases for xchg with %ax,
	%eax and %rax.

	* gas/i386/nops.d: Updated.
	* gas/i386/x86-64-nops.d: Likewise.
	* gas/i386/x86-64-opcode.d: Likewise.

opcodes/

2003-03-21  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/4218
	* i386-dis.c (PREGRP38): New.
	(dis386): Use PREGRP38 for 0x90.
	(prefix_user_table): Add PREGRP38.
	(print_insn): Set uses_REPZ_prefix to 1 for pause.
	(NOP_Fixup1): Properly handle REX bits.
	(NOP_Fixup2): Likewise.

	* i386-opc.c (i386_optab): Allow %eax with xchg in 64bit.
	Allow register with nop.
@
text
@a126 4
#define REX_MODE64	8
#define REX_EXTX	4
#define REX_EXTY	2
#define REX_EXTZ	1
d134 4
a137 1
      rex_used |= (rex & value) ? (value) | 0x40 : 0;	\
d139 1
a139 1
      rex_used |= 0x40;					\
d3752 1
a3752 1
	  USED_REX (REX_MODE64);
d3755 1
a3755 1
	      if (rex & REX_MODE64)
d3794 1
a3794 1
	  if ((rex & REX_MODE64) || (sizeflag & DFLAG))
d3798 1
a3798 1
	  if (!(rex & REX_MODE64))
d3843 2
a3844 2
	  USED_REX (REX_MODE64);
	  if (rex & REX_MODE64)
d3850 1
a3850 1
	  if (!(rex & REX_MODE64))
d3866 1
a3866 1
	      || (rex & REX_MODE64)
d3869 2
a3870 2
	      USED_REX (REX_MODE64);
	      if (rex & REX_MODE64)
d3895 1
a3895 1
	  USED_REX (REX_MODE64);
d3898 1
a3898 1
	      if (rex & REX_MODE64)
d3911 2
a3912 2
	  USED_REX (REX_MODE64);
	  if (rex & REX_MODE64)
d3924 1
a3924 1
	      && ((rex & REX_MODE64) || (sizeflag & DFLAG)))
d3926 1
a3926 1
	  if (!(rex & REX_MODE64))
d3944 1
a3944 1
	      if (rex & REX_MODE64)
d3966 1
a3966 1
	  if (rex & REX_MODE64)
d3968 1
a3968 1
	      USED_REX (REX_MODE64);
d3975 2
a3976 2
	  USED_REX (REX_MODE64);
	  if (rex & REX_MODE64)
d3987 1
a3987 1
	  if (!(rex & REX_MODE64))
d4126 2
a4127 2
      USED_REX (REX_MODE64);
      if (rex & REX_MODE64)
d4136 1
a4136 1
      if ((rex & REX_MODE64) || (sizeflag & DFLAG))
d4139 1
a4139 1
      if (!(rex & REX_MODE64))
d4181 2
a4182 2
  USED_REX (REX_EXTZ);
  if (rex & REX_EXTZ)
d4227 2
a4228 2
	  USED_REX (REX_MODE64);
	  if (rex & REX_MODE64)
d4271 2
a4272 2
	  USED_REX (REX_EXTY);
	  if (rex & REX_EXTY)
d4457 2
a4458 2
  USED_REX (REX_EXTX);
  if (rex & REX_EXTX)
d4481 2
a4482 2
      USED_REX (REX_MODE64);
      if (rex & REX_MODE64)
d4589 2
a4590 2
  USED_REX (REX_EXTZ);
  if (rex & REX_EXTZ)
d4622 2
a4623 2
      USED_REX (REX_MODE64);
      if (rex & REX_MODE64)
d4669 2
a4670 2
      USED_REX (REX_MODE64);
      if (rex & REX_MODE64)
d4679 1
a4679 1
      if ((rex & REX_MODE64) || (sizeflag & DFLAG))
d4683 1
a4683 1
      if (!(rex & REX_MODE64))
d4714 2
a4715 2
      USED_REX (REX_MODE64);
      if (rex & REX_MODE64)
d4769 2
a4770 2
      USED_REX (REX_MODE64);
      if (rex & REX_MODE64)
d4816 2
a4817 2
      USED_REX (REX_MODE64);
      if (rex & REX_MODE64)
d4865 1
a4865 1
      if ((sizeflag & DFLAG) || (rex & REX_MODE64))
d5065 1
a5065 1
  if (rex & REX_EXTX)
d5067 1
a5067 1
      USED_REX (REX_EXTX);
d5083 2
a5084 2
  USED_REX (REX_EXTX);
  if (rex & REX_EXTX)
d5116 2
a5117 2
      USED_REX (REX_EXTX);
      if (rex & REX_EXTX)
d5130 2
a5131 2
  USED_REX (REX_EXTX);
  if (rex & REX_EXTX)
d5159 2
a5160 2
      USED_REX (REX_EXTZ);
      if (rex & REX_EXTZ)
d5224 2
a5225 2
  USED_REX (REX_EXTZ);
  if (rex & REX_EXTZ)
d5766 2
a5767 2
  USED_REX (REX_MODE64);
  if (rex & REX_MODE64)
@


1.111
log
@gas/

2007-03-15  H.J. Lu  <hongjiu.lu@@intel.com>

	* Makefile.am: Run "make dep-am".
	* Makefile.in: Regenerated.

	* config/tc-i386.c: Include "opcodes/i386-opc.h" instead of
	"opcode/i386.h".
	(md_begin): Check reg_name != NULL for the last entry in
	i386_regtab.

	* config/tc-i386.h: Move many entries to opcode/i386.h and
	opcodes/i386-opc.h.

	* configure.in (need_opcodes): Set true for i386.
	* configure: Regenerated.

include/opcode/

2007-03-15  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386.h: Add entries from config/tc-i386.h and move tables
	to opcodes/i386-opc.h.

opcodes/

2007-03-15  H.J. Lu  <hongjiu.lu@@intel.com>

	* Makefile.am (CFILES): Add i386-opc.c.
	(ALL_MACHINES): Add i386-opc.lo.
	Run "make dep-am".
	* Makefile.in: Regenerated.

	* configure.in: Add i386-opc.lo for bfd_i386_arch.
	* configure: Regenerated.

	* i386-dis.c: Include "opcode/i386.h".
	(MAXLEN): Renamed to MAX_MNEM_SIZE. Remove definition.
	(FWAIT_OPCODE): Remove definition.
	(UNIXWARE_COMPAT): Renamed to SYSV386_COMPAT. Remove definition.
	(MAX_OPERANDS): Remove definition.

	* i386-opc.c: New file.
	* i386-opc.h: Likewise.
@
text
@d470 1
d696 1
a696 1
  { "xchgS",		{ { NOP_Fixup1, eAX_reg }, { NOP_Fixup2, eAX_reg } } },
d2021 8
d3103 2
a3104 1
      uses_REPZ_prefix = 0;
d5297 1
a5297 3
   32bit mode and "xchg %rax,%rax" in 64bit mode.  NOP with REPZ prefix
   is called PAUSE.  We display "xchg %ax,%ax" instead of "data16 nop".
 */
d5302 4
a5305 4
  if (prefixes == PREFIX_REPZ)
    strcpy (obuf, "pause");
  else if (prefixes == PREFIX_DATA
	   || ((rex & REX_MODE64) && rex != 0x48))
d5314 4
a5317 2
  if (prefixes == PREFIX_DATA
      || ((rex & REX_MODE64) && rex != 0x48))
@


1.110
log
@2007-03-09  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_Rd): Renamed to ...
	(OP_R): This.
	(Rd): Updated.
	(Rm): Likewise.
@
text
@d37 1
a37 2

#define MAXLEN 15
a40 6
#ifndef UNIXWARE_COMPAT
/* Set non-zero for broken, compatible instructions.  Set to zero for
   non-broken opcodes.  */
#define UNIXWARE_COMPAT 1
#endif

d105 1
a105 1
  bfd_byte the_buffer[MAXLEN];
a110 4
/* The opcode for the fwait instruction, which we treat as a prefix
   when we can.  */
#define FWAIT_OPCODE (0x9b)

d175 1
a175 1
  if (addr <= priv->the_buffer + MAXLEN)
a481 2
#define MAX_OPERANDS 4

d3505 1
a3505 1
#if UNIXWARE_COMPAT
d3534 1
a3534 1
#if UNIXWARE_COMPAT
@


1.109
log
@Remove extra space.
@
text
@d83 1
a83 1
static void OP_Rd (int, int);
d230 2
a231 2
#define Rd { OP_Rd, d_mode }
#define Rm { OP_Rd, m_mode }
d5105 1
a5105 1
OP_Rd (int bytemode, int sizeflag)
@


1.108
log
@Remove trailing zeros in array initializers.
@
text
@d2028 1
a2028 1
    { "(bad)", {   XX } },
d2030 2
a2031 2
    { "(bad)", {   XX } },
    { "(bad)", {   XX } },    
@


1.107
log
@Add a space before `}' in struct initializer.
@
text
@d413 1
a413 1
#define FLOAT	  NULL, { { NULL, FLOATCODE }, { NULL, 0 }, { NULL, 0 }, { NULL, 0 } }
d415 72
a486 72
#define GRP1b	  NULL, { { NULL, USE_GROUPS }, { NULL,  0 }, { NULL, 0 }, { NULL, 0 } }
#define GRP1S	  NULL, { { NULL, USE_GROUPS }, { NULL,  1 }, { NULL, 0 }, { NULL, 0 } }
#define GRP1Ss	  NULL, { { NULL, USE_GROUPS }, { NULL,  2 }, { NULL, 0 }, { NULL, 0 } }
#define GRP2b	  NULL, { { NULL, USE_GROUPS }, { NULL,  3 }, { NULL, 0 }, { NULL, 0 } }
#define GRP2S	  NULL, { { NULL, USE_GROUPS }, { NULL,  4 }, { NULL, 0 }, { NULL, 0 } }
#define GRP2b_one NULL, { { NULL, USE_GROUPS }, { NULL,  5 }, { NULL, 0 }, { NULL, 0 } }
#define GRP2S_one NULL, { { NULL, USE_GROUPS }, { NULL,  6 }, { NULL, 0 }, { NULL, 0 } }
#define GRP2b_cl  NULL, { { NULL, USE_GROUPS }, { NULL,  7 }, { NULL, 0 }, { NULL, 0 } }
#define GRP2S_cl  NULL, { { NULL, USE_GROUPS }, { NULL,  8 }, { NULL, 0 }, { NULL, 0 } }
#define GRP3b	  NULL, { { NULL, USE_GROUPS }, { NULL,  9 }, { NULL, 0 }, { NULL, 0 } }
#define GRP3S	  NULL, { { NULL, USE_GROUPS }, { NULL, 10 }, { NULL, 0 }, { NULL, 0 } }
#define GRP4	  NULL, { { NULL, USE_GROUPS }, { NULL, 11 }, { NULL, 0 }, { NULL, 0 } }
#define GRP5	  NULL, { { NULL, USE_GROUPS }, { NULL, 12 }, { NULL, 0 }, { NULL, 0 } }
#define GRP6	  NULL, { { NULL, USE_GROUPS }, { NULL, 13 }, { NULL, 0 }, { NULL, 0 } }
#define GRP7	  NULL, { { NULL, USE_GROUPS }, { NULL, 14 }, { NULL, 0 }, { NULL, 0 } }
#define GRP8	  NULL, { { NULL, USE_GROUPS }, { NULL, 15 }, { NULL, 0 }, { NULL, 0 } }
#define GRP9	  NULL, { { NULL, USE_GROUPS }, { NULL, 16 }, { NULL, 0 }, { NULL, 0 } }
#define GRP11_C6  NULL, { { NULL, USE_GROUPS }, { NULL, 17 }, { NULL, 0 }, { NULL, 0 } }
#define GRP11_C7  NULL, { { NULL, USE_GROUPS }, { NULL, 18 }, { NULL, 0 }, { NULL, 0 } }
#define GRP12	  NULL, { { NULL, USE_GROUPS }, { NULL, 19 }, { NULL, 0 }, { NULL, 0 } }
#define GRP13	  NULL, { { NULL, USE_GROUPS }, { NULL, 20 }, { NULL, 0 }, { NULL, 0 } }
#define GRP14	  NULL, { { NULL, USE_GROUPS }, { NULL, 21 }, { NULL, 0 }, { NULL, 0 } }
#define GRP15	  NULL, { { NULL, USE_GROUPS }, { NULL, 22 }, { NULL, 0 }, { NULL, 0 } }
#define GRP16	  NULL, { { NULL, USE_GROUPS }, { NULL, 23 }, { NULL, 0 }, { NULL, 0 } }
#define GRPAMD	  NULL, { { NULL, USE_GROUPS }, { NULL, 24 }, { NULL, 0 }, { NULL, 0 } }
#define GRPPADLCK1 NULL, { { NULL, USE_GROUPS }, { NULL, 25 }, { NULL, 0 }, { NULL, 0 } }
#define GRPPADLCK2 NULL, { { NULL, USE_GROUPS }, { NULL, 26 }, { NULL, 0 }, { NULL, 0 } }

#define PREGRP0   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  0 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP1   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  1 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP2   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  2 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP3   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  3 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP4   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  4 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP5   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  5 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP6   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  6 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP7   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  7 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP8   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  8 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP9   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  9 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP10  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 10 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP11  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 11 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP12  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 12 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP13  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 13 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP14  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 14 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP15  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 15 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP16  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 16 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP17  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 17 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP18  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 18 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP19  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 19 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP20  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 20 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP21  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 21 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP22  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 22 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP23  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 23 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP24  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 24 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP25  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 25 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP26  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 26 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP27  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 27 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP28  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 28 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP29  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 29 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP30  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 30 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP31  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 31 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP32  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 32 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP33  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 33 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP34  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 34 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP35  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 35 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP36  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 36 }, { NULL, 0 }, { NULL, 0 } }
#define PREGRP37  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 37 }, { NULL, 0 }, { NULL, 0 } }


#define X86_64_0  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 0 }, { NULL, 0 }, { NULL, 0 } }
#define X86_64_1  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 1 }, { NULL, 0 }, { NULL, 0 } }
#define X86_64_2  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 2 }, { NULL, 0 }, { NULL, 0 } }
#define X86_64_3  NULL, { { NULL, X86_64_SPECIAL }, { NULL, 3 }, { NULL, 0 }, { NULL, 0 } }
d488 2
a489 2
#define THREE_BYTE_0 NULL, { { NULL, IS_3BYTE_OPCODE }, { NULL, 0 }, { NULL, 0 }, { NULL, 0 } }
#define THREE_BYTE_1 NULL, { { NULL, IS_3BYTE_OPCODE }, { NULL, 1 }, { NULL, 0 }, { NULL, 0 } }
d3457 9
a3465 9
#define FGRPd9_2 NULL, { { NULL, 0 }, { NULL, 0 }, { NULL, 0 }, { NULL, 0 } }
#define FGRPd9_4 NULL, { { NULL, 1 }, { NULL, 0 }, { NULL, 0 }, { NULL, 0 } }
#define FGRPd9_5 NULL, { { NULL, 2 }, { NULL, 0 }, { NULL, 0 }, { NULL, 0 } }
#define FGRPd9_6 NULL, { { NULL, 3 }, { NULL, 0 }, { NULL, 0 }, { NULL, 0 } }
#define FGRPd9_7 NULL, { { NULL, 4 }, { NULL, 0 }, { NULL, 0 }, { NULL, 0 } }
#define FGRPda_5 NULL, { { NULL, 5 }, { NULL, 0 }, { NULL, 0 }, { NULL, 0 } }
#define FGRPdb_4 NULL, { { NULL, 6 }, { NULL, 0 }, { NULL, 0 }, { NULL, 0 } }
#define FGRPde_3 NULL, { { NULL, 7 }, { NULL, 0 }, { NULL, 0 }, { NULL, 0 } }
#define FGRPdf_4 NULL, { { NULL, 8 }, { NULL, 0 }, { NULL, 0 }, { NULL, 0 } }
@


1.106
log
@2007-02-13  H.J. Lu  <hongjiu.lu@@intel.com>

	 * i386-dis.c: Updated to use an array of MAX_OPERANDS operands
	 in struct dis386.
@
text
@d415 66
a480 66
#define GRP1b	  NULL, { { NULL, USE_GROUPS }, { NULL,  0}, { NULL, 0 }, { NULL, 0 } }
#define GRP1S	  NULL, { { NULL, USE_GROUPS }, { NULL,  1}, { NULL, 0 }, { NULL, 0 } }
#define GRP1Ss	  NULL, { { NULL, USE_GROUPS }, { NULL,  2}, { NULL, 0 }, { NULL, 0 } }
#define GRP2b	  NULL, { { NULL, USE_GROUPS }, { NULL,  3}, { NULL, 0 }, { NULL, 0 } }
#define GRP2S	  NULL, { { NULL, USE_GROUPS }, { NULL,  4}, { NULL, 0 }, { NULL, 0 } }
#define GRP2b_one NULL, { { NULL, USE_GROUPS }, { NULL,  5}, { NULL, 0 }, { NULL, 0 } }
#define GRP2S_one NULL, { { NULL, USE_GROUPS }, { NULL,  6}, { NULL, 0 }, { NULL, 0 } }
#define GRP2b_cl  NULL, { { NULL, USE_GROUPS }, { NULL,  7}, { NULL, 0 }, { NULL, 0 } }
#define GRP2S_cl  NULL, { { NULL, USE_GROUPS }, { NULL,  8}, { NULL, 0 }, { NULL, 0 } }
#define GRP3b	  NULL, { { NULL, USE_GROUPS }, { NULL,  9}, { NULL, 0 }, { NULL, 0 } }
#define GRP3S	  NULL, { { NULL, USE_GROUPS }, { NULL, 10}, { NULL, 0 }, { NULL, 0 } }
#define GRP4	  NULL, { { NULL, USE_GROUPS }, { NULL, 11}, { NULL, 0 }, { NULL, 0 } }
#define GRP5	  NULL, { { NULL, USE_GROUPS }, { NULL, 12}, { NULL, 0 }, { NULL, 0 } }
#define GRP6	  NULL, { { NULL, USE_GROUPS }, { NULL, 13}, { NULL, 0 }, { NULL, 0 } }
#define GRP7	  NULL, { { NULL, USE_GROUPS }, { NULL, 14}, { NULL, 0 }, { NULL, 0 } }
#define GRP8	  NULL, { { NULL, USE_GROUPS }, { NULL, 15}, { NULL, 0 }, { NULL, 0 } }
#define GRP9	  NULL, { { NULL, USE_GROUPS }, { NULL, 16}, { NULL, 0 }, { NULL, 0 } }
#define GRP11_C6  NULL, { { NULL, USE_GROUPS }, { NULL, 17}, { NULL, 0 }, { NULL, 0 } }
#define GRP11_C7  NULL, { { NULL, USE_GROUPS }, { NULL, 18}, { NULL, 0 }, { NULL, 0 } }
#define GRP12	  NULL, { { NULL, USE_GROUPS }, { NULL, 19}, { NULL, 0 }, { NULL, 0 } }
#define GRP13	  NULL, { { NULL, USE_GROUPS }, { NULL, 20}, { NULL, 0 }, { NULL, 0 } }
#define GRP14	  NULL, { { NULL, USE_GROUPS }, { NULL, 21}, { NULL, 0 }, { NULL, 0 } }
#define GRP15	  NULL, { { NULL, USE_GROUPS }, { NULL, 22}, { NULL, 0 }, { NULL, 0 } }
#define GRP16	  NULL, { { NULL, USE_GROUPS }, { NULL, 23}, { NULL, 0 }, { NULL, 0 } }
#define GRPAMD	  NULL, { { NULL, USE_GROUPS }, { NULL, 24}, { NULL, 0 }, { NULL, 0 } }
#define GRPPADLCK1 NULL, { { NULL, USE_GROUPS }, { NULL, 25}, { NULL, 0 }, { NULL, 0 } }
#define GRPPADLCK2 NULL, { { NULL, USE_GROUPS }, { NULL, 26}, { NULL, 0 }, { NULL, 0 } }

#define PREGRP0   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  0}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP1   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  1}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP2   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  2}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP3   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  3}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP4   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  4}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP5   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  5}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP6   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  6}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP7   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  7}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP8   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  8}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP9   NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL,  9}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP10  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 10}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP11  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 11}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP12  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 12}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP13  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 13}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP14  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 14}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP15  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 15}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP16  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 16}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP17  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 17}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP18  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 18}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP19  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 19}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP20  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 20}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP21  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 21}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP22  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 22}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP23  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 23}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP24  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 24}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP25  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 25}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP26  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 26}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP27  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 27}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP28  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 28}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP29  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 29}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP30  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 30}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP31  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 31}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP32  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 32}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP33  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 33}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP34  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 34}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP35  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 35}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP36  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 36}, { NULL, 0 }, { NULL, 0 } }
#define PREGRP37  NULL, { { NULL, USE_PREFIX_USER_TABLE }, { NULL, 37}, { NULL, 0 }, { NULL, 0 } }
@


1.105
log
@ld/testsuite/

2076-02-05  H.J. Lu  <hongjiu.lu@@intel.com>

	* ld-i386/pcrel16.d: Undo the last change.
	* ld-x86-64/pcrel16.d: Likewise.

opcodes/

2076-02-05  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_J): Undo the last change. Properly handle 64K
	wrap around within the same segment in 16bit mode.
@
text
@d208 1
a208 1
#define XX NULL, 0
d210 114
a323 114
#define Eb OP_E, b_mode
#define Ev OP_E, v_mode
#define Ed OP_E, d_mode
#define Edq OP_E, dq_mode
#define Edqw OP_E, dqw_mode
#define indirEv OP_indirE, stack_v_mode
#define indirEp OP_indirE, f_mode
#define stackEv OP_E, stack_v_mode
#define Em OP_E, m_mode
#define Ew OP_E, w_mode
#define M OP_M, 0		/* lea, lgdt, etc. */
#define Ma OP_M, v_mode
#define Mp OP_M, f_mode		/* 32 or 48 bit memory operand for LDS, LES etc */
#define Mq OP_M, q_mode
#define Gb OP_G, b_mode
#define Gv OP_G, v_mode
#define Gd OP_G, d_mode
#define Gdq OP_G, dq_mode
#define Gm OP_G, m_mode
#define Gw OP_G, w_mode
#define Rd OP_Rd, d_mode
#define Rm OP_Rd, m_mode
#define Ib OP_I, b_mode
#define sIb OP_sI, b_mode	/* sign extened byte */
#define Iv OP_I, v_mode
#define Iq OP_I, q_mode
#define Iv64 OP_I64, v_mode
#define Iw OP_I, w_mode
#define I1 OP_I, const_1_mode
#define Jb OP_J, b_mode
#define Jv OP_J, v_mode
#define Cm OP_C, m_mode
#define Dm OP_D, m_mode
#define Td OP_T, d_mode

#define RMeAX OP_REG, eAX_reg
#define RMeBX OP_REG, eBX_reg
#define RMeCX OP_REG, eCX_reg
#define RMeDX OP_REG, eDX_reg
#define RMeSP OP_REG, eSP_reg
#define RMeBP OP_REG, eBP_reg
#define RMeSI OP_REG, eSI_reg
#define RMeDI OP_REG, eDI_reg
#define RMrAX OP_REG, rAX_reg
#define RMrBX OP_REG, rBX_reg
#define RMrCX OP_REG, rCX_reg
#define RMrDX OP_REG, rDX_reg
#define RMrSP OP_REG, rSP_reg
#define RMrBP OP_REG, rBP_reg
#define RMrSI OP_REG, rSI_reg
#define RMrDI OP_REG, rDI_reg
#define RMAL OP_REG, al_reg
#define RMAL OP_REG, al_reg
#define RMCL OP_REG, cl_reg
#define RMDL OP_REG, dl_reg
#define RMBL OP_REG, bl_reg
#define RMAH OP_REG, ah_reg
#define RMCH OP_REG, ch_reg
#define RMDH OP_REG, dh_reg
#define RMBH OP_REG, bh_reg
#define RMAX OP_REG, ax_reg
#define RMDX OP_REG, dx_reg

#define eAX OP_IMREG, eAX_reg
#define eBX OP_IMREG, eBX_reg
#define eCX OP_IMREG, eCX_reg
#define eDX OP_IMREG, eDX_reg
#define eSP OP_IMREG, eSP_reg
#define eBP OP_IMREG, eBP_reg
#define eSI OP_IMREG, eSI_reg
#define eDI OP_IMREG, eDI_reg
#define AL OP_IMREG, al_reg
#define CL OP_IMREG, cl_reg
#define DL OP_IMREG, dl_reg
#define BL OP_IMREG, bl_reg
#define AH OP_IMREG, ah_reg
#define CH OP_IMREG, ch_reg
#define DH OP_IMREG, dh_reg
#define BH OP_IMREG, bh_reg
#define AX OP_IMREG, ax_reg
#define DX OP_IMREG, dx_reg
#define zAX OP_IMREG, z_mode_ax_reg
#define indirDX OP_IMREG, indir_dx_reg

#define Sw OP_SEG, w_mode
#define Sv OP_SEG, v_mode
#define Ap OP_DIR, 0
#define Ob OP_OFF64, b_mode
#define Ov OP_OFF64, v_mode
#define Xb OP_DSreg, eSI_reg
#define Xv OP_DSreg, eSI_reg
#define Xz OP_DSreg, eSI_reg
#define Yb OP_ESreg, eDI_reg
#define Yv OP_ESreg, eDI_reg
#define DSBX OP_DSreg, eBX_reg

#define es OP_REG, es_reg
#define ss OP_REG, ss_reg
#define cs OP_REG, cs_reg
#define ds OP_REG, ds_reg
#define fs OP_REG, fs_reg
#define gs OP_REG, gs_reg

#define MX OP_MMX, 0
#define XM OP_XMM, 0
#define EM OP_EM, v_mode
#define EX OP_EX, v_mode
#define MS OP_MS, v_mode
#define XS OP_XS, v_mode
#define EMC OP_EMC, v_mode
#define MXC OP_MXC, 0
#define VM OP_VMX, q_mode
#define OPSUF OP_3DNowSuffix, 0
#define OPSIMD OP_SIMD_Suffix, 0
d326 8
a333 8
#define Xbr REP_Fixup, eSI_reg
#define Xvr REP_Fixup, eSI_reg
#define Ybr REP_Fixup, eDI_reg
#define Yvr REP_Fixup, eDI_reg
#define Yzr REP_Fixup, eDI_reg
#define indirDXr REP_Fixup, indir_dx_reg
#define ALr REP_Fixup, al_reg
#define eAXr REP_Fixup, eAX_reg
d335 2
a336 2
#define cond_jump_flag NULL, cond_jump_mode
#define loop_jcxz_flag NULL, loop_jcxz_mode
d413 1
a413 1
#define FLOAT	  NULL, NULL, FLOATCODE, NULL, 0, NULL, 0, NULL, 0
d415 72
a486 72
#define GRP1b	  NULL, NULL, USE_GROUPS, NULL,  0, NULL, 0, NULL, 0
#define GRP1S	  NULL, NULL, USE_GROUPS, NULL,  1, NULL, 0, NULL, 0
#define GRP1Ss	  NULL, NULL, USE_GROUPS, NULL,  2, NULL, 0, NULL, 0
#define GRP2b	  NULL, NULL, USE_GROUPS, NULL,  3, NULL, 0, NULL, 0
#define GRP2S	  NULL, NULL, USE_GROUPS, NULL,  4, NULL, 0, NULL, 0
#define GRP2b_one NULL, NULL, USE_GROUPS, NULL,  5, NULL, 0, NULL, 0
#define GRP2S_one NULL, NULL, USE_GROUPS, NULL,  6, NULL, 0, NULL, 0
#define GRP2b_cl  NULL, NULL, USE_GROUPS, NULL,  7, NULL, 0, NULL, 0
#define GRP2S_cl  NULL, NULL, USE_GROUPS, NULL,  8, NULL, 0, NULL, 0
#define GRP3b	  NULL, NULL, USE_GROUPS, NULL,  9, NULL, 0, NULL, 0
#define GRP3S	  NULL, NULL, USE_GROUPS, NULL, 10, NULL, 0, NULL, 0
#define GRP4	  NULL, NULL, USE_GROUPS, NULL, 11, NULL, 0, NULL, 0
#define GRP5	  NULL, NULL, USE_GROUPS, NULL, 12, NULL, 0, NULL, 0
#define GRP6	  NULL, NULL, USE_GROUPS, NULL, 13, NULL, 0, NULL, 0
#define GRP7	  NULL, NULL, USE_GROUPS, NULL, 14, NULL, 0, NULL, 0
#define GRP8	  NULL, NULL, USE_GROUPS, NULL, 15, NULL, 0, NULL, 0
#define GRP9	  NULL, NULL, USE_GROUPS, NULL, 16, NULL, 0, NULL, 0
#define GRP11_C6  NULL, NULL, USE_GROUPS, NULL, 17, NULL, 0, NULL, 0
#define GRP11_C7  NULL, NULL, USE_GROUPS, NULL, 18, NULL, 0, NULL, 0
#define GRP12	  NULL, NULL, USE_GROUPS, NULL, 19, NULL, 0, NULL, 0
#define GRP13	  NULL, NULL, USE_GROUPS, NULL, 20, NULL, 0, NULL, 0
#define GRP14	  NULL, NULL, USE_GROUPS, NULL, 21, NULL, 0, NULL, 0
#define GRP15	  NULL, NULL, USE_GROUPS, NULL, 22, NULL, 0, NULL, 0
#define GRP16	  NULL, NULL, USE_GROUPS, NULL, 23, NULL, 0, NULL, 0
#define GRPAMD	  NULL, NULL, USE_GROUPS, NULL, 24, NULL, 0, NULL, 0
#define GRPPADLCK1 NULL, NULL, USE_GROUPS, NULL, 25, NULL, 0, NULL, 0
#define GRPPADLCK2 NULL, NULL, USE_GROUPS, NULL, 26, NULL, 0, NULL, 0

#define PREGRP0   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  0, NULL, 0, NULL, 0
#define PREGRP1   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  1, NULL, 0, NULL, 0
#define PREGRP2   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  2, NULL, 0, NULL, 0
#define PREGRP3   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  3, NULL, 0, NULL, 0
#define PREGRP4   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  4, NULL, 0, NULL, 0
#define PREGRP5   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  5, NULL, 0, NULL, 0
#define PREGRP6   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  6, NULL, 0, NULL, 0
#define PREGRP7   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  7, NULL, 0, NULL, 0
#define PREGRP8   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  8, NULL, 0, NULL, 0
#define PREGRP9   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  9, NULL, 0, NULL, 0
#define PREGRP10  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 10, NULL, 0, NULL, 0
#define PREGRP11  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 11, NULL, 0, NULL, 0
#define PREGRP12  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 12, NULL, 0, NULL, 0
#define PREGRP13  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 13, NULL, 0, NULL, 0
#define PREGRP14  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 14, NULL, 0, NULL, 0
#define PREGRP15  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 15, NULL, 0, NULL, 0
#define PREGRP16  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 16, NULL, 0, NULL, 0
#define PREGRP17  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 17, NULL, 0, NULL, 0
#define PREGRP18  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 18, NULL, 0, NULL, 0
#define PREGRP19  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 19, NULL, 0, NULL, 0
#define PREGRP20  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 20, NULL, 0, NULL, 0
#define PREGRP21  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 21, NULL, 0, NULL, 0
#define PREGRP22  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 22, NULL, 0, NULL, 0
#define PREGRP23  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 23, NULL, 0, NULL, 0
#define PREGRP24  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 24, NULL, 0, NULL, 0
#define PREGRP25  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 25, NULL, 0, NULL, 0
#define PREGRP26  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 26, NULL, 0, NULL, 0
#define PREGRP27  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 27, NULL, 0, NULL, 0
#define PREGRP28  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 28, NULL, 0, NULL, 0
#define PREGRP29  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 29, NULL, 0, NULL, 0
#define PREGRP30  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 30, NULL, 0, NULL, 0
#define PREGRP31  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 31, NULL, 0, NULL, 0
#define PREGRP32  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 32, NULL, 0, NULL, 0
#define PREGRP33  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 33, NULL, 0, NULL, 0
#define PREGRP34  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 34, NULL, 0, NULL, 0
#define PREGRP35  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 35, NULL, 0, NULL, 0
#define PREGRP36  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 36, NULL, 0, NULL, 0
#define PREGRP37  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 37, NULL, 0, NULL, 0


#define X86_64_0  NULL, NULL, X86_64_SPECIAL, NULL, 0, NULL, 0, NULL, 0
#define X86_64_1  NULL, NULL, X86_64_SPECIAL, NULL, 1, NULL, 0, NULL, 0
#define X86_64_2  NULL, NULL, X86_64_SPECIAL, NULL, 2, NULL, 0, NULL, 0
#define X86_64_3  NULL, NULL, X86_64_SPECIAL, NULL, 3, NULL, 0, NULL, 0
d488 2
a489 2
#define THREE_BYTE_0 NULL, NULL, IS_3BYTE_OPCODE, NULL, 0, NULL, 0, NULL, 0
#define THREE_BYTE_1 NULL, NULL, IS_3BYTE_OPCODE, NULL, 1, NULL, 0, NULL, 0
d493 2
d497 5
a501 8
  op_rtn op1;
  int bytemode1;
  op_rtn op2;
  int bytemode2;
  op_rtn op3;
  int bytemode3;
  op_rtn op4;
  int bytemode4;
d546 8
a553 8
  { "addB",		Eb, Gb, XX, XX },
  { "addS",		Ev, Gv, XX, XX },
  { "addB",		Gb, Eb, XX, XX },
  { "addS",		Gv, Ev, XX, XX },
  { "addB",		AL, Ib, XX, XX },
  { "addS",		eAX, Iv, XX, XX },
  { "push{T|}",		es, XX, XX, XX },
  { "pop{T|}",		es, XX, XX, XX },
d555 8
a562 8
  { "orB",		Eb, Gb, XX, XX },
  { "orS",		Ev, Gv, XX, XX },
  { "orB",		Gb, Eb, XX, XX },
  { "orS",		Gv, Ev, XX, XX },
  { "orB",		AL, Ib, XX, XX },
  { "orS",		eAX, Iv, XX, XX },
  { "push{T|}",		cs, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },	/* 0x0f extended opcode escape */
d564 8
a571 8
  { "adcB",		Eb, Gb, XX, XX },
  { "adcS",		Ev, Gv, XX, XX },
  { "adcB",		Gb, Eb, XX, XX },
  { "adcS",		Gv, Ev, XX, XX },
  { "adcB",		AL, Ib, XX, XX },
  { "adcS",		eAX, Iv, XX, XX },
  { "push{T|}",		ss, XX, XX, XX },
  { "pop{T|}",		ss, XX, XX, XX },
d573 8
a580 8
  { "sbbB",		Eb, Gb, XX, XX },
  { "sbbS",		Ev, Gv, XX, XX },
  { "sbbB",		Gb, Eb, XX, XX },
  { "sbbS",		Gv, Ev, XX, XX },
  { "sbbB",		AL, Ib, XX, XX },
  { "sbbS",		eAX, Iv, XX, XX },
  { "push{T|}",		ds, XX, XX, XX },
  { "pop{T|}",		ds, XX, XX, XX },
d582 8
a589 8
  { "andB",		Eb, Gb, XX, XX },
  { "andS",		Ev, Gv, XX, XX },
  { "andB",		Gb, Eb, XX, XX },
  { "andS",		Gv, Ev, XX, XX },
  { "andB",		AL, Ib, XX, XX },
  { "andS",		eAX, Iv, XX, XX },
  { "(bad)",		XX, XX, XX, XX },	/* SEG ES prefix */
  { "daa{|}",		XX, XX, XX, XX },
d591 8
a598 8
  { "subB",		Eb, Gb, XX, XX },
  { "subS",		Ev, Gv, XX, XX },
  { "subB",		Gb, Eb, XX, XX },
  { "subS",		Gv, Ev, XX, XX },
  { "subB",		AL, Ib, XX, XX },
  { "subS",		eAX, Iv, XX, XX },
  { "(bad)",		XX, XX, XX, XX },	/* SEG CS prefix */
  { "das{|}",		XX, XX, XX, XX },
d600 8
a607 8
  { "xorB",		Eb, Gb, XX, XX },
  { "xorS",		Ev, Gv, XX, XX },
  { "xorB",		Gb, Eb, XX, XX },
  { "xorS",		Gv, Ev, XX, XX },
  { "xorB",		AL, Ib, XX, XX },
  { "xorS",		eAX, Iv, XX, XX },
  { "(bad)",		XX, XX, XX, XX },	/* SEG SS prefix */
  { "aaa{|}",		XX, XX, XX, XX },
d609 8
a616 8
  { "cmpB",		Eb, Gb, XX, XX },
  { "cmpS",		Ev, Gv, XX, XX },
  { "cmpB",		Gb, Eb, XX, XX },
  { "cmpS",		Gv, Ev, XX, XX },
  { "cmpB",		AL, Ib, XX, XX },
  { "cmpS",		eAX, Iv, XX, XX },
  { "(bad)",		XX, XX, XX, XX },	/* SEG DS prefix */
  { "aas{|}",		XX, XX, XX, XX },
d618 8
a625 8
  { "inc{S|}",		RMeAX, XX, XX, XX },
  { "inc{S|}",		RMeCX, XX, XX, XX },
  { "inc{S|}",		RMeDX, XX, XX, XX },
  { "inc{S|}",		RMeBX, XX, XX, XX },
  { "inc{S|}",		RMeSP, XX, XX, XX },
  { "inc{S|}",		RMeBP, XX, XX, XX },
  { "inc{S|}",		RMeSI, XX, XX, XX },
  { "inc{S|}",		RMeDI, XX, XX, XX },
d627 8
a634 8
  { "dec{S|}",		RMeAX, XX, XX, XX },
  { "dec{S|}",		RMeCX, XX, XX, XX },
  { "dec{S|}",		RMeDX, XX, XX, XX },
  { "dec{S|}",		RMeBX, XX, XX, XX },
  { "dec{S|}",		RMeSP, XX, XX, XX },
  { "dec{S|}",		RMeBP, XX, XX, XX },
  { "dec{S|}",		RMeSI, XX, XX, XX },
  { "dec{S|}",		RMeDI, XX, XX, XX },
d636 8
a643 8
  { "pushV",		RMrAX, XX, XX, XX },
  { "pushV",		RMrCX, XX, XX, XX },
  { "pushV",		RMrDX, XX, XX, XX },
  { "pushV",		RMrBX, XX, XX, XX },
  { "pushV",		RMrSP, XX, XX, XX },
  { "pushV",		RMrBP, XX, XX, XX },
  { "pushV",		RMrSI, XX, XX, XX },
  { "pushV",		RMrDI, XX, XX, XX },
d645 8
a652 8
  { "popV",		RMrAX, XX, XX, XX },
  { "popV",		RMrCX, XX, XX, XX },
  { "popV",		RMrDX, XX, XX, XX },
  { "popV",		RMrBX, XX, XX, XX },
  { "popV",		RMrSP, XX, XX, XX },
  { "popV",		RMrBP, XX, XX, XX },
  { "popV",		RMrSI, XX, XX, XX },
  { "popV",		RMrDI, XX, XX, XX },
d658 4
a661 4
  { "(bad)",		XX, XX, XX, XX },	/* seg fs */
  { "(bad)",		XX, XX, XX, XX },	/* seg gs */
  { "(bad)",		XX, XX, XX, XX },	/* op size prefix */
  { "(bad)",		XX, XX, XX, XX },	/* adr size prefix */
d663 8
a670 8
  { "pushT",		Iq, XX, XX, XX },
  { "imulS",		Gv, Ev, Iv, XX },
  { "pushT",		sIb, XX, XX, XX },
  { "imulS",		Gv, Ev, sIb, XX },
  { "ins{b||b|}",	Ybr, indirDX, XX, XX },
  { "ins{R||G|}",	Yzr, indirDX, XX, XX },
  { "outs{b||b|}",	indirDXr, Xb, XX, XX },
  { "outs{R||G|}",	indirDXr, Xz, XX, XX },
d672 8
a679 8
  { "joH",		Jb, XX, cond_jump_flag, XX },
  { "jnoH",		Jb, XX, cond_jump_flag, XX },
  { "jbH",		Jb, XX, cond_jump_flag, XX },
  { "jaeH",		Jb, XX, cond_jump_flag, XX },
  { "jeH",		Jb, XX, cond_jump_flag, XX },
  { "jneH",		Jb, XX, cond_jump_flag, XX },
  { "jbeH",		Jb, XX, cond_jump_flag, XX },
  { "jaH",		Jb, XX, cond_jump_flag, XX },
d681 8
a688 8
  { "jsH",		Jb, XX, cond_jump_flag, XX },
  { "jnsH",		Jb, XX, cond_jump_flag, XX },
  { "jpH",		Jb, XX, cond_jump_flag, XX },
  { "jnpH",		Jb, XX, cond_jump_flag, XX },
  { "jlH",		Jb, XX, cond_jump_flag, XX },
  { "jgeH",		Jb, XX, cond_jump_flag, XX },
  { "jleH",		Jb, XX, cond_jump_flag, XX },
  { "jgH",		Jb, XX, cond_jump_flag, XX },
d692 1
a692 1
  { "(bad)",		XX, XX, XX, XX },
d694 4
a697 4
  { "testB",		Eb, Gb, XX, XX },
  { "testS",		Ev, Gv, XX, XX },
  { "xchgB",		Eb, Gb, XX, XX },
  { "xchgS",		Ev, Gv, XX, XX },
d699 8
a706 8
  { "movB",		Eb, Gb, XX, XX },
  { "movS",		Ev, Gv, XX, XX },
  { "movB",		Gb, Eb, XX, XX },
  { "movS",		Gv, Ev, XX, XX },
  { "movD",		Sv, Sw, XX, XX },
  { "leaS",		Gv, M, XX, XX },
  { "movD",		Sw, Sv, XX, XX },
  { "popU",		stackEv, XX, XX, XX },
d708 8
a715 8
  { "xchgS",		NOP_Fixup1, eAX_reg, NOP_Fixup2, eAX_reg, XX, XX },
  { "xchgS",		RMeCX, eAX, XX, XX },
  { "xchgS",		RMeDX, eAX, XX, XX },
  { "xchgS",		RMeBX, eAX, XX, XX },
  { "xchgS",		RMeSP, eAX, XX, XX },
  { "xchgS",		RMeBP, eAX, XX, XX },
  { "xchgS",		RMeSI, eAX, XX, XX },
  { "xchgS",		RMeDI, eAX, XX, XX },
d717 8
a724 8
  { "cW{t||t|}R",	XX, XX, XX, XX },
  { "cR{t||t|}O",	XX, XX, XX, XX },
  { "Jcall{T|}",	Ap, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },	/* fwait */
  { "pushfT",		XX, XX, XX, XX },
  { "popfT",		XX, XX, XX, XX },
  { "sahf{|}",		XX, XX, XX, XX },
  { "lahf{|}",		XX, XX, XX, XX },
d726 8
a733 8
  { "movB",		AL, Ob, XX, XX },
  { "movS",		eAX, Ov, XX, XX },
  { "movB",		Ob, AL, XX, XX },
  { "movS",		Ov, eAX, XX, XX },
  { "movs{b||b|}",	Ybr, Xb, XX, XX },
  { "movs{R||R|}",	Yvr, Xv, XX, XX },
  { "cmps{b||b|}",	Xb, Yb, XX, XX },
  { "cmps{R||R|}",	Xv, Yv, XX, XX },
d735 8
a742 8
  { "testB",		AL, Ib, XX, XX },
  { "testS",		eAX, Iv, XX, XX },
  { "stosB",		Ybr, AL, XX, XX },
  { "stosS",		Yvr, eAX, XX, XX },
  { "lodsB",		ALr, Xb, XX, XX },
  { "lodsS",		eAXr, Xv, XX, XX },
  { "scasB",		AL, Yb, XX, XX },
  { "scasS",		eAX, Yv, XX, XX },
d744 8
a751 8
  { "movB",		RMAL, Ib, XX, XX },
  { "movB",		RMCL, Ib, XX, XX },
  { "movB",		RMDL, Ib, XX, XX },
  { "movB",		RMBL, Ib, XX, XX },
  { "movB",		RMAH, Ib, XX, XX },
  { "movB",		RMCH, Ib, XX, XX },
  { "movB",		RMDH, Ib, XX, XX },
  { "movB",		RMBH, Ib, XX, XX },
d753 8
a760 8
  { "movS",		RMeAX, Iv64, XX, XX },
  { "movS",		RMeCX, Iv64, XX, XX },
  { "movS",		RMeDX, Iv64, XX, XX },
  { "movS",		RMeBX, Iv64, XX, XX },
  { "movS",		RMeSP, Iv64, XX, XX },
  { "movS",		RMeBP, Iv64, XX, XX },
  { "movS",		RMeSI, Iv64, XX, XX },
  { "movS",		RMeDI, Iv64, XX, XX },
d764 4
a767 4
  { "retT",		Iw, XX, XX, XX },
  { "retT",		XX, XX, XX, XX },
  { "les{S|}",		Gv, Mp, XX, XX },
  { "ldsS",		Gv, Mp, XX, XX },
d771 8
a778 8
  { "enterT",		Iw, Ib, XX, XX },
  { "leaveT",		XX, XX, XX, XX },
  { "lretP",		Iw, XX, XX, XX },
  { "lretP",		XX, XX, XX, XX },
  { "int3",		XX, XX, XX, XX },
  { "int",		Ib, XX, XX, XX },
  { "into{|}",		XX, XX, XX, XX },
  { "iretP",		XX, XX, XX, XX },
d784 4
a787 4
  { "aam{|}",		sIb, XX, XX, XX },
  { "aad{|}",		sIb, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
  { "xlat",		DSBX, XX, XX, XX },
d798 8
a805 8
  { "loopneFH",		Jb, XX, loop_jcxz_flag, XX },
  { "loopeFH",		Jb, XX, loop_jcxz_flag, XX },
  { "loopFH",		Jb, XX, loop_jcxz_flag, XX },
  { "jEcxzH",		Jb, XX, loop_jcxz_flag, XX },
  { "inB",		AL, Ib, XX, XX },
  { "inG",		zAX, Ib, XX, XX },
  { "outB",		Ib, AL, XX, XX },
  { "outG",		Ib, zAX, XX, XX },
d807 8
a814 8
  { "callT",		Jv, XX, XX, XX },
  { "jmpT",		Jv, XX, XX, XX },
  { "Jjmp{T|}",		Ap, XX, XX, XX },
  { "jmp",		Jb, XX, XX, XX },
  { "inB",		AL, indirDX, XX, XX },
  { "inG",		zAX, indirDX, XX, XX },
  { "outB",		indirDX, AL, XX, XX },
  { "outG",		indirDX, zAX, XX, XX },
d816 6
a821 6
  { "(bad)",		XX, XX, XX, XX },	/* lock prefix */
  { "icebp",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },	/* repne */
  { "(bad)",		XX, XX, XX, XX },	/* repz */
  { "hlt",		XX, XX, XX, XX },
  { "cmc",		XX, XX, XX, XX },
d825 6
a830 6
  { "clc",		XX, XX, XX, XX },
  { "stc",		XX, XX, XX, XX },
  { "cli",		XX, XX, XX, XX },
  { "sti",		XX, XX, XX, XX },
  { "cld",		XX, XX, XX, XX },
  { "std",		XX, XX, XX, XX },
d839 6
a844 6
  { "larS",		Gv, Ew, XX, XX },
  { "lslS",		Gv, Ew, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
  { "syscall",		XX, XX, XX, XX },
  { "clts",		XX, XX, XX, XX },
  { "sysretP",		XX, XX, XX, XX },
d846 5
a850 5
  { "invd",		XX, XX, XX, XX },
  { "wbinvd",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
  { "ud2a",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
d852 2
a853 2
  { "femms",		XX, XX, XX, XX },
  { "",			MX, EM, OPSUF, XX }, /* See OP_3DNowSuffix.  */
d858 3
a860 3
  { "movlpX",		EX, XM, SIMD_Fixup, 'h', XX },
  { "unpcklpX",		XM, EX, XX, XX },
  { "unpckhpX",		XM, EX, XX, XX },
d862 1
a862 1
  { "movhpX",		EX, XM, SIMD_Fixup, 'l', XX },
d865 7
a871 7
  { "(bad)",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
  { "nopQ",		Ev, XX, XX, XX },
d873 8
a880 8
  { "movZ",		Rm, Cm, XX, XX },
  { "movZ",		Rm, Dm, XX, XX },
  { "movZ",		Cm, Rm, XX, XX },
  { "movZ",		Dm, Rm, XX, XX },
  { "movL",		Rd, Td, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
  { "movL",		Td, Rd, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
d882 2
a883 2
  { "movapX",		XM, EX, XX, XX },
  { "movapX",		EX, XM, XX, XX },
d888 2
a889 2
  { "ucomisX",		XM,EX, XX, XX },
  { "comisX",		XM,EX, XX, XX },
d891 8
a898 8
  { "wrmsr",		XX, XX, XX, XX },
  { "rdtsc",		XX, XX, XX, XX },
  { "rdmsr",		XX, XX, XX, XX },
  { "rdpmc",		XX, XX, XX, XX },
  { "sysenter",		XX, XX, XX, XX },
  { "sysexit",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
d901 1
a901 1
  { "(bad)",		XX, XX, XX, XX },
d903 5
a907 5
  { "(bad)",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
d909 8
a916 8
  { "cmovo",		Gv, Ev, XX, XX },
  { "cmovno",		Gv, Ev, XX, XX },
  { "cmovb",		Gv, Ev, XX, XX },
  { "cmovae",		Gv, Ev, XX, XX },
  { "cmove",		Gv, Ev, XX, XX },
  { "cmovne",		Gv, Ev, XX, XX },
  { "cmovbe",		Gv, Ev, XX, XX },
  { "cmova",		Gv, Ev, XX, XX },
d918 8
a925 8
  { "cmovs",		Gv, Ev, XX, XX },
  { "cmovns",		Gv, Ev, XX, XX },
  { "cmovp",		Gv, Ev, XX, XX },
  { "cmovnp",		Gv, Ev, XX, XX },
  { "cmovl",		Gv, Ev, XX, XX },
  { "cmovge",		Gv, Ev, XX, XX },
  { "cmovle",		Gv, Ev, XX, XX },
  { "cmovg",		Gv, Ev, XX, XX },
d927 1
a927 1
  { "movmskpX",		Gdq, XS, XX, XX },
d931 4
a934 4
  { "andpX",		XM, EX, XX, XX },
  { "andnpX",		XM, EX, XX, XX },
  { "orpX",		XM, EX, XX, XX },
  { "xorpX",		XM, EX, XX, XX },
d945 8
a952 8
  { "punpcklbw",	MX, EM, XX, XX },
  { "punpcklwd",	MX, EM, XX, XX },
  { "punpckldq",	MX, EM, XX, XX },
  { "packsswb",		MX, EM, XX, XX },
  { "pcmpgtb",		MX, EM, XX, XX },
  { "pcmpgtw",		MX, EM, XX, XX },
  { "pcmpgtd",		MX, EM, XX, XX },
  { "packuswb",		MX, EM, XX, XX },
d954 4
a957 4
  { "punpckhbw",	MX, EM, XX, XX },
  { "punpckhwd",	MX, EM, XX, XX },
  { "punpckhdq",	MX, EM, XX, XX },
  { "packssdw",		MX, EM, XX, XX },
d960 1
a960 1
  { "movd",		MX, Edq, XX, XX },
d967 4
a970 4
  { "pcmpeqb",		MX, EM, XX, XX },
  { "pcmpeqw",		MX, EM, XX, XX },
  { "pcmpeqd",		MX, EM, XX, XX },
  { "emms",		XX, XX, XX, XX },
d974 2
a975 2
  { "(bad)",		XX, XX, XX, XX },
  { "(bad)",		XX, XX, XX, XX },
d981 8
a988 8
  { "joH",		Jv, XX, cond_jump_flag, XX },
  { "jnoH",		Jv, XX, cond_jump_flag, XX },
  { "jbH",		Jv, XX, cond_jump_flag, XX },
  { "jaeH",		Jv, XX, cond_jump_flag, XX },
  { "jeH",		Jv, XX, cond_jump_flag, XX },
  { "jneH",		Jv, XX, cond_jump_flag, XX },
  { "jbeH",		Jv, XX, cond_jump_flag, XX },
  { "jaH",		Jv, XX, cond_jump_flag, XX },
d990 8
a997 8
  { "jsH",		Jv, XX, cond_jump_flag, XX },
  { "jnsH",		Jv, XX, cond_jump_flag, XX },
  { "jpH",		Jv, XX, cond_jump_flag, XX },
  { "jnpH",		Jv, XX, cond_jump_flag, XX },
  { "jlH",		Jv, XX, cond_jump_flag, XX },
  { "jgeH",		Jv, XX, cond_jump_flag, XX },
  { "jleH",		Jv, XX, cond_jump_flag, XX },
  { "jgH",		Jv, XX, cond_jump_flag, XX },
d999 8
a1006 8
  { "seto",		Eb, XX, XX, XX },
  { "setno",		Eb, XX, XX, XX },
  { "setb",		Eb, XX, XX, XX },
  { "setae",		Eb, XX, XX, XX },
  { "sete",		Eb, XX, XX, XX },
  { "setne",		Eb, XX, XX, XX },
  { "setbe",		Eb, XX, XX, XX },
  { "seta",		Eb, XX, XX, XX },
d1008 8
a1015 8
  { "sets",		Eb, XX, XX, XX },
  { "setns",		Eb, XX, XX, XX },
  { "setp",		Eb, XX, XX, XX },
  { "setnp",		Eb, XX, XX, XX },
  { "setl",		Eb, XX, XX, XX },
  { "setge",		Eb, XX, XX, XX },
  { "setle",		Eb, XX, XX, XX },
  { "setg",		Eb, XX, XX, XX },
d1017 6
a1022 6
  { "pushT",		fs, XX, XX, XX },
  { "popT",		fs, XX, XX, XX },
  { "cpuid",		XX, XX, XX, XX },
  { "btS",		Ev, Gv, XX, XX },
  { "shldS",		Ev, Gv, Ib, XX },
  { "shldS",		Ev, Gv, CL, XX },
d1026 6
a1031 6
  { "pushT",		gs, XX, XX, XX },
  { "popT",		gs, XX, XX, XX },
  { "rsm",		XX, XX, XX, XX },
  { "btsS",		Ev, Gv, XX, XX },
  { "shrdS",		Ev, Gv, Ib, XX },
  { "shrdS",		Ev, Gv, CL, XX },
d1033 1
a1033 1
  { "imulS",		Gv, Ev, XX, XX },
d1035 8
a1042 8
  { "cmpxchgB",		Eb, Gb, XX, XX },
  { "cmpxchgS",		Ev, Gv, XX, XX },
  { "lssS",		Gv, Mp, XX, XX },
  { "btrS",		Ev, Gv, XX, XX },
  { "lfsS",		Gv, Mp, XX, XX },
  { "lgsS",		Gv, Mp, XX, XX },
  { "movz{bR|x|bR|x}",	Gv, Eb, XX, XX },
  { "movz{wR|x|wR|x}",	Gv, Ew, XX, XX }, /* yes, there really is movzww ! */
d1045 1
a1045 1
  { "ud2b",		XX, XX, XX, XX },
d1047 2
a1048 2
  { "btcS",		Ev, Gv, XX, XX },
  { "bsfS",		Gv, Ev, XX, XX },
d1050 2
a1051 2
  { "movs{bR|x|bR|x}",	Gv, Eb, XX, XX },
  { "movs{wR|x|wR|x}",	Gv, Ew, XX, XX }, /* yes, there really is movsww ! */
d1053 2
a1054 2
  { "xaddB",		Eb, Gb, XX, XX },
  { "xaddS",		Ev, Gv, XX, XX },
d1056 4
a1059 4
  { "movntiS",		Ev, Gv, XX, XX },
  { "pinsrw",		MX, Edqw, Ib, XX },
  { "pextrw",		Gdq, MS, Ib, XX },
  { "shufpX",		XM, EX, Ib, XX },
d1062 8
a1069 8
  { "bswap",		RMeAX, XX, XX, XX },
  { "bswap",		RMeCX, XX, XX, XX },
  { "bswap",		RMeDX, XX, XX, XX },
  { "bswap",		RMeBX, XX, XX, XX },
  { "bswap",		RMeSP, XX, XX, XX },
  { "bswap",		RMeBP, XX, XX, XX },
  { "bswap",		RMeSI, XX, XX, XX },
  { "bswap",		RMeDI, XX, XX, XX },
d1072 5
a1076 5
  { "psrlw",		MX, EM, XX, XX },
  { "psrld",		MX, EM, XX, XX },
  { "psrlq",		MX, EM, XX, XX },
  { "paddq",		MX, EM, XX, XX },
  { "pmullw",		MX, EM, XX, XX },
d1078 1
a1078 1
  { "pmovmskb",		Gdq, MS, XX, XX },
d1080 8
a1087 8
  { "psubusb",		MX, EM, XX, XX },
  { "psubusw",		MX, EM, XX, XX },
  { "pminub",		MX, EM, XX, XX },
  { "pand",		MX, EM, XX, XX },
  { "paddusb",		MX, EM, XX, XX },
  { "paddusw",		MX, EM, XX, XX },
  { "pmaxub",		MX, EM, XX, XX },
  { "pandn",		MX, EM, XX, XX },
d1089 6
a1094 6
  { "pavgb",		MX, EM, XX, XX },
  { "psraw",		MX, EM, XX, XX },
  { "psrad",		MX, EM, XX, XX },
  { "pavgw",		MX, EM, XX, XX },
  { "pmulhuw",		MX, EM, XX, XX },
  { "pmulhw",		MX, EM, XX, XX },
d1098 8
a1105 8
  { "psubsb",		MX, EM, XX, XX },
  { "psubsw",		MX, EM, XX, XX },
  { "pminsw",		MX, EM, XX, XX },
  { "por",		MX, EM, XX, XX },
  { "paddsb",		MX, EM, XX, XX },
  { "paddsw",		MX, EM, XX, XX },
  { "pmaxsw",		MX, EM, XX, XX },
  { "pxor",		MX, EM, XX, XX },
d1108 6
a1113 6
  { "psllw",		MX, EM, XX, XX },
  { "pslld",		MX, EM, XX, XX },
  { "psllq",		MX, EM, XX, XX },
  { "pmuludq",		MX, EM, XX, XX },
  { "pmaddwd",		MX, EM, XX, XX },
  { "psadbw",		MX, EM, XX, XX },
d1116 8
a1123 8
  { "psubb",		MX, EM, XX, XX },
  { "psubw",		MX, EM, XX, XX },
  { "psubd",		MX, EM, XX, XX },
  { "psubq",		MX, EM, XX, XX },
  { "paddb",		MX, EM, XX, XX },
  { "paddw",		MX, EM, XX, XX },
  { "paddd",		MX, EM, XX, XX },
  { "(bad)",		XX, XX, XX, XX }
d1465 8
a1472 8
    { "addA",	Eb, Ib, XX, XX },
    { "orA",	Eb, Ib, XX, XX },
    { "adcA",	Eb, Ib, XX, XX },
    { "sbbA",	Eb, Ib, XX, XX },
    { "andA",	Eb, Ib, XX, XX },
    { "subA",	Eb, Ib, XX, XX },
    { "xorA",	Eb, Ib, XX, XX },
    { "cmpA",	Eb, Ib, XX, XX }
d1476 8
a1483 8
    { "addQ",	Ev, Iv, XX, XX },
    { "orQ",	Ev, Iv, XX, XX },
    { "adcQ",	Ev, Iv, XX, XX },
    { "sbbQ",	Ev, Iv, XX, XX },
    { "andQ",	Ev, Iv, XX, XX },
    { "subQ",	Ev, Iv, XX, XX },
    { "xorQ",	Ev, Iv, XX, XX },
    { "cmpQ",	Ev, Iv, XX, XX }
d1487 8
a1494 8
    { "addQ",	Ev, sIb, XX, XX },
    { "orQ",	Ev, sIb, XX, XX },
    { "adcQ",	Ev, sIb, XX, XX },
    { "sbbQ",	Ev, sIb, XX, XX },
    { "andQ",	Ev, sIb, XX, XX },
    { "subQ",	Ev, sIb, XX, XX },
    { "xorQ",	Ev, sIb, XX, XX },
    { "cmpQ",	Ev, sIb, XX, XX }
d1498 8
a1505 8
    { "rolA",	Eb, Ib, XX, XX },
    { "rorA",	Eb, Ib, XX, XX },
    { "rclA",	Eb, Ib, XX, XX },
    { "rcrA",	Eb, Ib, XX, XX },
    { "shlA",	Eb, Ib, XX, XX },
    { "shrA",	Eb, Ib, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "sarA",	Eb, Ib, XX, XX },
d1509 8
a1516 8
    { "rolQ",	Ev, Ib, XX, XX },
    { "rorQ",	Ev, Ib, XX, XX },
    { "rclQ",	Ev, Ib, XX, XX },
    { "rcrQ",	Ev, Ib, XX, XX },
    { "shlQ",	Ev, Ib, XX, XX },
    { "shrQ",	Ev, Ib, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "sarQ",	Ev, Ib, XX, XX },
d1520 8
a1527 8
    { "rolA",	Eb, I1, XX, XX },
    { "rorA",	Eb, I1, XX, XX },
    { "rclA",	Eb, I1, XX, XX },
    { "rcrA",	Eb, I1, XX, XX },
    { "shlA",	Eb, I1, XX, XX },
    { "shrA",	Eb, I1, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "sarA",	Eb, I1, XX, XX },
d1531 8
a1538 8
    { "rolQ",	Ev, I1, XX, XX },
    { "rorQ",	Ev, I1, XX, XX },
    { "rclQ",	Ev, I1, XX, XX },
    { "rcrQ",	Ev, I1, XX, XX },
    { "shlQ",	Ev, I1, XX, XX },
    { "shrQ",	Ev, I1, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "sarQ",	Ev, I1, XX, XX },
d1542 8
a1549 8
    { "rolA",	Eb, CL, XX, XX },
    { "rorA",	Eb, CL, XX, XX },
    { "rclA",	Eb, CL, XX, XX },
    { "rcrA",	Eb, CL, XX, XX },
    { "shlA",	Eb, CL, XX, XX },
    { "shrA",	Eb, CL, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "sarA",	Eb, CL, XX, XX },
d1553 8
a1560 8
    { "rolQ",	Ev, CL, XX, XX },
    { "rorQ",	Ev, CL, XX, XX },
    { "rclQ",	Ev, CL, XX, XX },
    { "rcrQ",	Ev, CL, XX, XX },
    { "shlQ",	Ev, CL, XX, XX },
    { "shrQ",	Ev, CL, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "sarQ",	Ev, CL, XX, XX }
d1564 8
a1571 8
    { "testA",	Eb, Ib, XX, XX },
    { "(bad)",	Eb, XX, XX, XX },
    { "notA",	Eb, XX, XX, XX },
    { "negA",	Eb, XX, XX, XX },
    { "mulA",	Eb, XX, XX, XX },	/* Don't print the implicit %al register,  */
    { "imulA",	Eb, XX, XX, XX },	/* to distinguish these opcodes from other */
    { "divA",	Eb, XX, XX, XX },	/* mul/imul opcodes.  Do the same for div  */
    { "idivA",	Eb, XX, XX, XX }	/* and idiv for consistency.		   */
d1575 8
a1582 8
    { "testQ",	Ev, Iv, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "notQ",	Ev, XX, XX, XX },
    { "negQ",	Ev, XX, XX, XX },
    { "mulQ",	Ev, XX, XX, XX },	/* Don't print the implicit register.  */
    { "imulQ",	Ev, XX, XX, XX },
    { "divQ",	Ev, XX, XX, XX },
    { "idivQ",	Ev, XX, XX, XX },
d1586 8
a1593 8
    { "incA",	Eb, XX, XX, XX },
    { "decA",	Eb, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d1597 8
a1604 8
    { "incQ",	Ev, XX, XX, XX },
    { "decQ",	Ev, XX, XX, XX },
    { "callT",	indirEv, XX, XX, XX },
    { "JcallT",	indirEp, XX, XX, XX },
    { "jmpT",	indirEv, XX, XX, XX },
    { "JjmpT",	indirEp, XX, XX, XX },
    { "pushU",	stackEv, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d1608 8
a1615 8
    { "sldtD",	Sv, XX, XX, XX },
    { "strD",	Sv, XX, XX, XX },
    { "lldt",	Ew, XX, XX, XX },
    { "ltr",	Ew, XX, XX, XX },
    { "verr",	Ew, XX, XX, XX },
    { "verw",	Ew, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX }
d1619 8
a1626 8
    { "sgdt{Q|IQ||}", VMX_Fixup, 0, XX, XX, XX },
    { "sidt{Q|IQ||}", PNI_Fixup, 0, XX, XX, XX },
    { "lgdt{Q|Q||}",	 M, XX, XX, XX },
    { "lidt{Q|Q||}",	 SVME_Fixup, 0, XX, XX, XX },
    { "smswD",	Sv, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "lmsw",	Ew, XX, XX, XX },
    { "invlpg",	INVLPG_Fixup, w_mode, XX, XX, XX },
d1630 8
a1637 8
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "btQ",	Ev, Ib, XX, XX },
    { "btsQ",	Ev, Ib, XX, XX },
    { "btrQ",	Ev, Ib, XX, XX },
    { "btcQ",	Ev, Ib, XX, XX },
d1641 8
a1648 8
    { "(bad)",	XX, XX, XX, XX },
    { "cmpxchg8b", CMPXCHG8B_Fixup, q_mode, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "",	VM, XX, XX, XX },		/* See OP_VMX.  */
    { "vmptrst", Mq, XX, XX, XX },
d1652 8
a1659 8
    { "movA",	Eb, Ib, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d1663 8
a1670 8
    { "movQ",	Ev, Iv, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d1674 8
a1681 8
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "psrlw",	MS, Ib, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "psraw",	MS, Ib, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "psllw",	MS, Ib, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d1685 8
a1692 8
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "psrld",	MS, Ib, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "psrad",	MS, Ib, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "pslld",	MS, Ib, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d1696 8
a1703 8
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "psrlq",	MS, Ib, XX, XX },
    { "psrldq",	MS, Ib, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "psllq",	MS, Ib, XX, XX },
    { "pslldq",	MS, Ib, XX, XX },
d1707 8
a1714 8
    { "fxsave", Ev, XX, XX, XX },
    { "fxrstor", Ev, XX, XX, XX },
    { "ldmxcsr", Ev, XX, XX, XX },
    { "stmxcsr", Ev, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "lfence", OP_0fae, 0, XX, XX, XX },
    { "mfence", OP_0fae, 0, XX, XX, XX },
    { "clflush", OP_0fae, 0, XX, XX, XX },
d1718 8
a1725 8
    { "prefetchnta", Ev, XX, XX, XX },
    { "prefetcht0", Ev, XX, XX, XX },
    { "prefetcht1", Ev, XX, XX, XX },
    { "prefetcht2", Ev, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d1729 8
a1736 8
    { "prefetch", Eb, XX, XX, XX },
    { "prefetchw", Eb, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d1740 8
a1747 8
    { "xstore-rng", OP_0f07, 0, XX, XX, XX },
    { "xcrypt-ecb", OP_0f07, 0, XX, XX, XX },
    { "xcrypt-cbc", OP_0f07, 0, XX, XX, XX },
    { "xcrypt-ctr", OP_0f07, 0, XX, XX, XX },
    { "xcrypt-cfb", OP_0f07, 0, XX, XX, XX },
    { "xcrypt-ofb", OP_0f07, 0, XX, XX, XX },
    { "(bad)",	OP_0f07, 0, XX, XX, XX },
    { "(bad)",	OP_0f07, 0, XX, XX, XX },
d1751 8
a1758 8
    { "montmul", OP_0f07, 0, XX, XX, XX },
    { "xsha1",   OP_0f07, 0, XX, XX, XX },
    { "xsha256", OP_0f07, 0, XX, XX, XX },
    { "(bad)",	 OP_0f07, 0, XX, XX, XX },
    { "(bad)",   OP_0f07, 0, XX, XX, XX },
    { "(bad)",   OP_0f07, 0, XX, XX, XX },
    { "(bad)",	 OP_0f07, 0, XX, XX, XX },
    { "(bad)",	 OP_0f07, 0, XX, XX, XX },
d1765 4
a1768 4
    { "addps", XM, EX, XX, XX },
    { "addss", XM, EX, XX, XX },
    { "addpd", XM, EX, XX, XX },
    { "addsd", XM, EX, XX, XX },
d1772 4
a1775 4
    { "", XM, EX, OPSIMD, XX },	/* See OP_SIMD_SUFFIX.  */
    { "", XM, EX, OPSIMD, XX },
    { "", XM, EX, OPSIMD, XX },
    { "", XM, EX, OPSIMD, XX },
d1779 4
a1782 4
    { "cvtpi2ps", XM, EMC, XX, XX },
    { "cvtsi2ssY", XM, Ev, XX, XX },
    { "cvtpi2pd", XM, EMC, XX, XX },
    { "cvtsi2sdY", XM, Ev, XX, XX },
d1786 4
a1789 4
    { "cvtps2pi", MXC, EX, XX, XX },
    { "cvtss2siY", Gv, EX, XX, XX },
    { "cvtpd2pi", MXC, EX, XX, XX },
    { "cvtsd2siY", Gv, EX, XX, XX },
d1793 4
a1796 4
    { "cvttps2pi", MXC, EX, XX, XX },
    { "cvttss2siY", Gv, EX, XX, XX },
    { "cvttpd2pi", MXC, EX, XX, XX },
    { "cvttsd2siY", Gv, EX, XX, XX },
d1800 4
a1803 4
    { "divps", XM, EX, XX, XX },
    { "divss", XM, EX, XX, XX },
    { "divpd", XM, EX, XX, XX },
    { "divsd", XM, EX, XX, XX },
d1807 4
a1810 4
    { "maxps", XM, EX, XX, XX },
    { "maxss", XM, EX, XX, XX },
    { "maxpd", XM, EX, XX, XX },
    { "maxsd", XM, EX, XX, XX },
d1814 4
a1817 4
    { "minps", XM, EX, XX, XX },
    { "minss", XM, EX, XX, XX },
    { "minpd", XM, EX, XX, XX },
    { "minsd", XM, EX, XX, XX },
d1821 4
a1824 4
    { "movups", XM, EX, XX, XX },
    { "movss", XM, EX, XX, XX },
    { "movupd", XM, EX, XX, XX },
    { "movsd", XM, EX, XX, XX },
d1828 4
a1831 4
    { "movups", EX, XM, XX, XX },
    { "movss", EX, XM, XX, XX },
    { "movupd", EX, XM, XX, XX },
    { "movsd", EX, XM, XX, XX },
d1835 4
a1838 4
    { "mulps", XM, EX, XX, XX },
    { "mulss", XM, EX, XX, XX },
    { "mulpd", XM, EX, XX, XX },
    { "mulsd", XM, EX, XX, XX },
d1842 4
a1845 4
    { "rcpps", XM, EX, XX, XX },
    { "rcpss", XM, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
d1849 4
a1852 4
    { "rsqrtps", XM, EX, XX, XX },
    { "rsqrtss", XM, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
d1856 4
a1859 4
    { "sqrtps", XM, EX, XX, XX },
    { "sqrtss", XM, EX, XX, XX },
    { "sqrtpd", XM, EX, XX, XX },
    { "sqrtsd", XM, EX, XX, XX },
d1863 4
a1866 4
    { "subps", XM, EX, XX, XX },
    { "subss", XM, EX, XX, XX },
    { "subpd", XM, EX, XX, XX },
    { "subsd", XM, EX, XX, XX },
d1870 4
a1873 4
    { "(bad)", XM, EX, XX, XX },
    { "cvtdq2pd", XM, EX, XX, XX },
    { "cvttpd2dq", XM, EX, XX, XX },
    { "cvtpd2dq", XM, EX, XX, XX },
d1877 4
a1880 4
    { "cvtdq2ps", XM, EX, XX, XX },
    { "cvttps2dq",XM, EX, XX, XX },
    { "cvtps2dq",XM, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
d1884 4
a1887 4
    { "cvtps2pd", XM, EX, XX, XX },
    { "cvtss2sd", XM, EX, XX, XX },
    { "cvtpd2ps", XM, EX, XX, XX },
    { "cvtsd2ss", XM, EX, XX, XX },
d1891 4
a1894 4
    { "maskmovq", MX, MS, XX, XX },
    { "(bad)", XM, EX, XX, XX },
    { "maskmovdqu", XM, XS, XX, XX },
    { "(bad)", XM, EX, XX, XX },
d1898 4
a1901 4
    { "movq", MX, EM, XX, XX },
    { "movdqu", XM, EX, XX, XX },
    { "movdqa", XM, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
d1905 4
a1908 4
    { "movq", EM, MX, XX, XX },
    { "movdqu", EX, XM, XX, XX },
    { "movdqa", EX, XM, XX, XX },
    { "(bad)", EX, XM, XX, XX },
d1912 4
a1915 4
    { "(bad)", EX, XM, XX, XX },
    { "movq2dq", XM, MS, XX, XX },
    { "movq", EX, XM, XX, XX },
    { "movdq2q", MX, XS, XX, XX },
d1919 4
a1922 4
    { "pshufw", MX, EM, Ib, XX },
    { "pshufhw", XM, EX, Ib, XX },
    { "pshufd", XM, EX, Ib, XX },
    { "pshuflw", XM, EX, Ib, XX },
d1926 4
a1929 4
    { "movd", Edq, MX, XX, XX },
    { "movq", XM, EX, XX, XX },
    { "movd", Edq, XM, XX, XX },
    { "(bad)", Ed, XM, XX, XX },
d1933 4
a1936 4
    { "(bad)", MX, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
    { "punpckhqdq", XM, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
d1940 4
a1943 4
    { "movntq", EM, MX, XX, XX },
    { "(bad)", EM, XM, XX, XX },
    { "movntdq", EM, XM, XX, XX },
    { "(bad)", EM, XM, XX, XX },
d1947 4
a1950 4
    { "(bad)", MX, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
    { "punpcklqdq", XM, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
d1954 4
a1957 4
    { "(bad)", MX, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
    { "addsubpd", XM, EX, XX, XX },
    { "addsubps", XM, EX, XX, XX },
d1961 4
a1964 4
    { "(bad)", MX, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
    { "haddpd", XM, EX, XX, XX },
    { "haddps", XM, EX, XX, XX },
d1968 4
a1971 4
    { "(bad)", MX, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
    { "hsubpd", XM, EX, XX, XX },
    { "hsubps", XM, EX, XX, XX },
d1975 4
a1978 4
    { "movlpX", XM, EX, SIMD_Fixup, 'h', XX }, /* really only 2 operands */
    { "movsldup", XM, EX, XX, XX },
    { "movlpd", XM, EX, XX, XX },
    { "movddup", XM, EX, XX, XX },
d1982 4
a1985 4
    { "movhpX", XM, EX, SIMD_Fixup, 'l', XX },
    { "movshdup", XM, EX, XX, XX },
    { "movhpd", XM, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
d1989 4
a1992 4
    { "(bad)", XM, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
    { "(bad)", XM, EX, XX, XX },
    { "lddqu", XM, M, XX, XX },
d1996 4
a1999 4
    {"movntps",Ev, XM, XX, XX },
    {"movntss",Ev, XM, XX, XX },
    {"movntpd",Ev, XM, XX, XX },
    {"movntsd",Ev, XM, XX, XX },
d2004 4
a2007 4
    {"vmread", Em, Gm, XX, XX },
    {"(bad)",  XX, XX, XX, XX },
    {"extrq",  XS, Ib, Ib, XX },
    {"insertq",XM, XS, Ib, Ib },
d2012 4
a2015 4
    {"vmwrite", Gm, Em, XX, XX },
    {"(bad)",   XX, XX, XX, XX },
    {"extrq",   XM, XS, XX, XX },
    {"insertq", XM, XS, XX, XX },
d2020 4
a2023 4
    { "bsrS",   Gv, Ev, XX, XX },
    { "lzcntS", Gv, Ev, XX, XX },
    { "bsrS",  Gv, Ev, XX, XX },
    { "(bad)",  XX, XX, XX, XX },
d2028 4
a2031 4
    { "(bad)",  XX, XX, XX, XX },
    { "popcntS",Gv, Ev, XX, XX },
    { "(bad)",  XX, XX, XX, XX },
    { "(bad)",  XX, XX, XX, XX },    
d2037 2
a2038 2
    { "pusha{P|}",	XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2041 2
a2042 2
    { "popa{P|}",	XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2045 2
a2046 2
    { "bound{S|}",	Gv, Ma, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2049 2
a2050 2
    { "arpl",		Ew, Gw, XX, XX },
    { "movs{||lq|xd}",	Gv, Ed, XX, XX },
d2058 8
a2065 8
    { "pshufb",		MX, EM, XX, XX },
    { "phaddw",		MX, EM, XX, XX },
    { "phaddd",		MX, EM, XX, XX },
    { "phaddsw",	MX, EM, XX, XX },
    { "pmaddubsw",	MX, EM, XX, XX },
    { "phsubw",		MX, EM, XX, XX },
    { "phsubd",		MX, EM, XX, XX },
    { "phsubsw",	MX, EM, XX, XX },
d2067 8
a2074 8
    { "psignb",		MX, EM, XX, XX },
    { "psignw",		MX, EM, XX, XX },
    { "psignd",		MX, EM, XX, XX },
    { "pmulhrsw",	MX, EM, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2076 8
a2083 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2085 8
a2092 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "pabsb",		MX, EM, XX, XX },
    { "pabsw",		MX, EM, XX, XX },
    { "pabsd",		MX, EM, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2094 8
a2101 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2103 8
a2110 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2112 8
a2119 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2121 8
a2128 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2130 8
a2137 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2139 8
a2146 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2148 8
a2155 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2157 8
a2164 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2166 8
a2173 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2175 8
a2182 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2184 8
a2191 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2193 8
a2200 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2202 8
a2209 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2211 8
a2218 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2220 8
a2227 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2229 8
a2236 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2238 8
a2245 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2247 8
a2254 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2256 8
a2263 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2265 8
a2272 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2274 8
a2281 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2283 8
a2290 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2292 8
a2299 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2301 8
a2308 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2310 8
a2317 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2319 8
a2326 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2328 8
a2335 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2337 8
a2344 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX }
d2349 8
a2356 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2358 8
a2365 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "palignr",	MX, EM, Ib, XX },
d2367 8
a2374 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2376 8
a2383 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2385 8
a2392 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2394 8
a2401 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2403 8
a2410 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2412 8
a2419 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2421 8
a2428 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2430 8
a2437 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2439 8
a2446 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2448 8
a2455 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2457 8
a2464 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2466 8
a2473 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2475 8
a2482 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2484 8
a2491 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2493 8
a2500 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2502 8
a2509 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2511 8
a2518 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2520 8
a2527 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2529 8
a2536 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2538 8
a2545 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2547 8
a2554 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2556 8
a2563 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2565 8
a2572 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2574 8
a2581 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2583 8
a2590 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2592 8
a2599 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2601 8
a2608 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2610 8
a2617 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2619 8
a2626 8
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
d2628 9
a2636 9
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX },
    { "(bad)",		XX, XX, XX, XX }
  },
d2809 2
a2810 2
static char op1out[100], op2out[100], op3out[100], op4out[100];
static int op_ad, op_index[4];
d2812 2
a2813 2
static bfd_vma op_address[4];
static bfd_vma op_riprel[4];
d2815 1
a2815 1

d2883 1
a2883 1
  char *first, *second, *third, *fourth;
d3007 5
a3011 6
  op1out[0] = 0;
  op2out[0] = 0;
  op3out[0] = 0;
  op4out[0] = 0;

  op_index[0] = op_index[1] = op_index[2] = op_index[3] = -1;
d3080 1
a3080 1
      if (dp->name == NULL && dp->bytemode1 == IS_3BYTE_OPCODE)
d3132 1
a3132 1
      if (dp->bytemode3 != loop_jcxz_mode || intel_syntax)
d3145 2
a3146 2
      if (dp->bytemode3 == cond_jump_mode
	  && dp->bytemode1 == v_mode
d3157 1
a3157 1
  if (dp->name == NULL && dp->bytemode1 == IS_3BYTE_OPCODE)
d3159 1
a3159 1
      dp = &three_byte_table[dp->bytemode2][op];
d3172 1
a3172 1
  if (dp->name == NULL && dp->bytemode1 == FLOATCODE)
d3181 1
a3181 1
	  switch (dp->bytemode1)
d3184 1
a3184 1
	      dp = &grps[dp->bytemode2][reg];
d3206 1
a3206 1
	      dp = &prefix_user_table[dp->bytemode2][index];
d3211 1
a3211 1
	      dp = &x86_64_table[dp->bytemode2][index];
d3221 8
a3228 20
	{
	  obufp = op1out;
	  op_ad = 3;
	  if (dp->op1)
	    (*dp->op1) (dp->bytemode1, sizeflag);

	  obufp = op2out;
	  op_ad = 2;
	  if (dp->op2)
	    (*dp->op2) (dp->bytemode2, sizeflag);

	  obufp = op3out;
	  op_ad = 1;
	  if (dp->op3)
	    (*dp->op3) (dp->bytemode3, sizeflag);

	  obufp = op4out;
	  op_ad = 0;
	  if (dp->op4)
	    (*dp->op4) (dp->bytemode4, sizeflag);
d3265 9
a3273 11
      first = op1out;
      second = op2out;
      third = op3out;
      fourth = op4out;
      op_ad = op_index[0];
      op_index[0] = op_index[3];
      op_index[3] = op_ad;
      op_ad = op_index[1];
      op_index[1] = op_index[2];
      op_index[2] = op_ad;

d3277 2
a3278 4
      first = op4out;
      second = op3out;
      third = op2out;
      fourth = op1out;
d3280 1
d3282 11
a3292 40
  if (*first)
    {
      if (op_index[0] != -1 && !op_riprel[0])
	(*info->print_address_func) ((bfd_vma) op_address[op_index[0]], info);
      else
	(*info->fprintf_func) (info->stream, "%s", first);
      needcomma = 1;
    }
  
  if (*second)
    {
      if (needcomma)
	(*info->fprintf_func) (info->stream, ",");
      if (op_index[1] != -1 && !op_riprel[1])
	(*info->print_address_func) ((bfd_vma) op_address[op_index[1]], info);
      else
	(*info->fprintf_func) (info->stream, "%s", second);
      needcomma = 1;
    }

  if (*third)
    {
      if (needcomma)
	(*info->fprintf_func) (info->stream, ",");
      if (op_index[2] != -1 && !op_riprel[2])
	(*info->print_address_func) ((bfd_vma) op_address[op_index[2]], info);
      else
	(*info->fprintf_func) (info->stream, "%s", third);
      needcomma = 1;
    }

  if (*fourth)
    {
      if (needcomma)
	(*info->fprintf_func) (info->stream, ",");
      if (op_index[3] != -1 && !op_riprel[3])
	(*info->print_address_func) ((bfd_vma) op_address[op_index[3]], info);
      else
	(*info->fprintf_func) (info->stream, "%s", fourth);
    }
d3294 1
a3294 1
  for (i = 0; i < 4; i++)
d3454 2
a3455 2
#define ST OP_ST, 0
#define STi OP_STi, 0
d3457 9
a3465 9
#define FGRPd9_2 NULL, NULL, 0, NULL, 0, NULL, 0, NULL, 0
#define FGRPd9_4 NULL, NULL, 1, NULL, 0, NULL, 0, NULL, 0
#define FGRPd9_5 NULL, NULL, 2, NULL, 0, NULL, 0, NULL, 0
#define FGRPd9_6 NULL, NULL, 3, NULL, 0, NULL, 0, NULL, 0
#define FGRPd9_7 NULL, NULL, 4, NULL, 0, NULL, 0, NULL, 0
#define FGRPda_5 NULL, NULL, 5, NULL, 0, NULL, 0, NULL, 0
#define FGRPdb_4 NULL, NULL, 6, NULL, 0, NULL, 0, NULL, 0
#define FGRPde_3 NULL, NULL, 7, NULL, 0, NULL, 0, NULL, 0
#define FGRPdf_4 NULL, NULL, 8, NULL, 0, NULL, 0, NULL, 0
d3470 8
a3477 8
    { "fadd",	ST, STi, XX, XX },
    { "fmul",	ST, STi, XX, XX },
    { "fcom",	STi, XX, XX, XX },
    { "fcomp",	STi, XX, XX, XX },
    { "fsub",	ST, STi, XX, XX },
    { "fsubr",	ST, STi, XX, XX },
    { "fdiv",	ST, STi, XX, XX },
    { "fdivr",	ST, STi, XX, XX },
d3481 2
a3482 2
    { "fld",	STi, XX, XX, XX },
    { "fxch",	STi, XX, XX, XX },
d3484 1
a3484 1
    { "(bad)",	XX, XX, XX, XX },
d3492 5
a3496 5
    { "fcmovb",	ST, STi, XX, XX },
    { "fcmove",	ST, STi, XX, XX },
    { "fcmovbe",ST, STi, XX, XX },
    { "fcmovu",	ST, STi, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d3498 2
a3499 2
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d3503 4
a3506 4
    { "fcmovnb",ST, STi, XX, XX },
    { "fcmovne",ST, STi, XX, XX },
    { "fcmovnbe",ST, STi, XX, XX },
    { "fcmovnu",ST, STi, XX, XX },
d3508 3
a3510 3
    { "fucomi",	ST, STi, XX, XX },
    { "fcomi",	ST, STi, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d3514 4
a3517 4
    { "fadd",	STi, ST, XX, XX },
    { "fmul",	STi, ST, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d3519 4
a3522 4
    { "fsub",	STi, ST, XX, XX },
    { "fsubr",	STi, ST, XX, XX },
    { "fdiv",	STi, ST, XX, XX },
    { "fdivr",	STi, ST, XX, XX },
d3524 4
a3527 4
    { "fsubr",	STi, ST, XX, XX },
    { "fsub",	STi, ST, XX, XX },
    { "fdivr",	STi, ST, XX, XX },
    { "fdiv",	STi, ST, XX, XX },
d3532 8
a3539 8
    { "ffree",	STi, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "fst",	STi, XX, XX, XX },
    { "fstp",	STi, XX, XX, XX },
    { "fucom",	STi, XX, XX, XX },
    { "fucomp",	STi, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d3543 3
a3545 3
    { "faddp",	STi, ST, XX, XX },
    { "fmulp",	STi, ST, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d3548 4
a3551 4
    { "fsubp",	STi, ST, XX, XX },
    { "fsubrp",	STi, ST, XX, XX },
    { "fdivp",	STi, ST, XX, XX },
    { "fdivrp",	STi, ST, XX, XX },
d3553 4
a3556 4
    { "fsubrp",	STi, ST, XX, XX },
    { "fsubp",	STi, ST, XX, XX },
    { "fdivrp",	STi, ST, XX, XX },
    { "fdivp",	STi, ST, XX, XX },
d3561 4
a3564 4
    { "ffreep",	STi, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d3566 3
a3568 3
    { "fucomip",ST, STi, XX, XX },
    { "fcomip", ST, STi, XX, XX },
    { "(bad)",	XX, XX, XX, XX },
d3633 1
a3633 1
      obufp = op1out;
d3645 1
a3645 1
      putop (fgrps[dp->bytemode1][rm], sizeflag);
d3649 1
a3649 1
	strcpy (op1out, names16[0]);
d3655 1
a3655 1
      obufp = op1out;
d3657 2
a3658 2
      if (dp->op1)
	(*dp->op1) (dp->bytemode1, sizeflag);
d3660 1
a3660 1
      obufp = op2out;
d3662 2
a3663 2
      if (dp->op2)
	(*dp->op2) (dp->bytemode2, sizeflag);
d5410 2
a5411 2
      op1out[0] = '\0';
      op2out[0] = '\0';
d5461 2
a5462 2
      op1out[0] = '\0';
      op2out[0] = '\0';
d5513 1
a5513 1
	    strcpy (op1out, names[0]);
d5531 2
a5532 2
	      strcpy (op1out, op1_names[0]);
	      strcpy (op3out, names[2]);
d5537 1
a5537 1
	  strcpy (op2out, names[1]);
d5598 1
a5598 1
      strcpy (op2out, names32[1]);
@


1.104
log
@Cosmetic change.
@
text
@d4904 1
d4922 8
a4929 5
	  /* For some reason, a data16 prefix on a jump instruction
	     means that the pc is masked to 16 bits after the
	     displacement is added!  */
	  if ((prefixes & PREFIX_DATA) != 0)
	    mask = 0xffff;
d4937 1
a4937 1
  disp = (start_pc + codep - start_codep + disp) & mask;
@


1.103
log
@ld/testsuite/

2076-02-02  H.J. Lu  <hongjiu.lu@@intel.com>

	* ld-i386/pcrel16.d: Updated.
	* ld-x86-64/pcrel16.d: Likewise.

opcodes/

2076-02-02  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_J): Mask to 16bit only if there is a data16
	prefix.
@
text
@d4924 1
a4924 1
	  if ((prefixes & PREFIX_DATA))
@


1.102
log
@binutils/

2076-02-02  H.J. Lu  <hongjiu.lu@@intel.com>

	* doc/binutils.texi (objdump): Document the new addr64 option
	for i386 disassembler.

include/

2076-02-02  H.J. Lu  <hongjiu.lu@@intel.com>

	* dis-asm.h (print_i386_disassembler_options): New.

opcodes/

2076-02-02  H.J. Lu  <hongjiu.lu@@intel.com>

	* disassemble.c (disassembler_usage): Call
	print_i386_disassembler_options for i386 disassembler.

	* i386-dis.c (print_i386_disassembler_options): New.
	(print_insn): Support the new addr64 option.
@
text
@d4919 2
d4924 2
a4925 1
	  mask = 0xffff;
@


1.101
log
@gas/testsuite/

2006-12-15  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/x86-64-inval.s: cmpxchg16b needs oword ptr, instead
	of xmmword ptr.
	* gas/i386/x86_64.s: Likewise.
	* gas/i386/x86-64-inval.l: Updated.

opcodes/

2006-12-15  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (o_mode): New for 16-byte operand.
	(intel_operand_size): Generate "OWORD PTR " for o_mode.
	(CMPXCHG8B_Fixup): Set bytemode to o_mode instead of x_mode.
@
text
@d2859 20
d2940 14
a2953 4
	  if (p[4] == '1' && p[5] == '6')
	    priv.orig_sizeflag &= ~AFLAG;
	  else if (p[4] == '3' && p[5] == '2')
	    priv.orig_sizeflag |= AFLAG;
@


1.100
log
@gas/testsuite/

2006-12-14  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/x86-64-inval.s: Add cmpxchg16b.
	* gas/i386/x86_64.s: Likewise.
	* gas/i386/x86-64-inval.l: Updated.
	* gas/i386/x86_64.d: Likewise.

opcodes/

2006-12-14  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (CMPXCHG8B_Fixup): New.
	(grps): Use CMPXCHG8B_Fixup for cmpxchg8b.
@
text
@d359 1
d4187 3
d5785 1
a5785 1
      bytemode = x_mode;
@


1.99
log
@2006-12-11  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (Eq): Replaced by ...
	(Mq): New. This.
	(Ma): Defined with OP_M instead of OP_E.
	(grps): Updated cmpxchg8b and vmptrst for Eq -> Mq.
	(OP_M): Added bound, cmpxchg8b and vmptrst to bad modrm list.
@
text
@d107 1
d1642 1
a1642 1
    { "cmpxchg8b", Mq, XX, XX, XX },
d5771 14
@


1.98
log
@2006-12-09  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (X86_64_1): New.
	(X86_64_2): Likewise.
	(X86_64_3): Likewise.
	(dis386): Replace 0x60, 0x61 and 0x62 entries with x86-64
	tables.
	(x86_64_table): Add entries for 0x60, 0x61 and 0x62.
@
text
@a211 1
#define Eq OP_E, q_mode
a218 1
#define Ma OP_E, v_mode
d220 1
d222 1
d1641 1
a1641 1
    { "cmpxchg8b", Eq, XX, XX, XX },
d1647 1
a1647 1
    { "vmptrst", Eq, XX, XX, XX },
d5265 2
a5266 1
    BadOp ();	/* bad lea,lds,les,lfs,lgs,lss modrm */
@


1.97
log
@2006-12-09  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c: Adjust white spaces.
@
text
@d482 3
a652 3
  { "pusha{P|}",	XX, XX, XX, XX },
  { "popa{P|}",		XX, XX, XX, XX },
  { "bound{S|}",	Gv, Ma, XX, XX },
d654 3
d2036 14
a2049 2
    { "arpl", Ew, Gw, XX, XX },
    { "movs{||lq|xd}", Gv, Ed, XX, XX },
@


1.96
log
@opcodes/
2006-12-04  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (OP_J): Update used_prefixes in v_mode.

gas/testsuite/
2006-12-04  Jan Beulich  <jbeulich@@novell.com>

	* gas/i386/opcode-intel.d: Fix wrong expectation. Make white space
	expectations more consistent.
@
text
@d430 2
a431 2
#define GRP11_C6	  NULL, NULL, USE_GROUPS, NULL, 17, NULL, 0, NULL, 0
#define GRP11_C7	  NULL, NULL, USE_GROUPS, NULL, 18, NULL, 0, NULL, 0
d481 1
a481 1
#define X86_64_0  NULL, NULL, X86_64_SPECIAL, NULL,  0, NULL, 0, NULL, 0
d554 1
a554 1
  { "orS",		Gv, Ev, XX , XX},
d588 1
a588 1
  { "subS",		Ev, Gv, XX, XX},
d650 1
a650 1
  { "pusha{P|}",	XX, XX, XX, XX},
d842 1
a842 1
  { "invd",		XX, XX, XX, XX},
d1866 1
a1866 1
    { "(bad)", XM, EX, XX, XX},
d1918 1
a1918 1
    { "pshuflw", XM, EX, Ib, XX},
d1992 4
a1995 4
    {"movntps",Ev, XM, XX, XX},
    {"movntss",Ev, XM, XX, XX},
    {"movntpd",Ev, XM, XX, XX},
    {"movntsd",Ev, XM, XX, XX},
d2000 4
a2003 4
    {"vmread", Em, Gm, XX, XX},
    {"(bad)",  XX, XX, XX, XX},
    {"extrq",  XS, Ib, Ib, XX},
    {"insertq",XM, XS, Ib, Ib},
d2008 4
a2011 4
    {"vmwrite", Gm, Em, XX, XX},
    {"(bad)",   XX, XX, XX, XX},
    {"extrq",   XM, XS, XX, XX},
    {"insertq", XM, XS, XX, XX},
@


1.95
log
@opcodes/
2006-11-30  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (SEG_Fixup): Delete.
	(Sv): Use OP_SEG.
	(putop): New suffix character 'D'.
	(dis386): Use it.
	(grps): Likewise.
	(OP_SEG): Handle bytemode other than w_mode.

gas/testsuite/
2006-11-30  Jan Beulich  <jbeulich@@novell.com>

	* gas/i386/intel.d: Adjust.
	* gas/i386/naked.d: Adjust.
	* gas/i386/opcode.d: Adjust.
@
text
@d4874 1
@


1.94
log
@opcodes/
2006-11-30  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (zAX): New.
	(Xz): New.
	(Yzr): New.
	(z_mode): New.
	(z_mode_ax_reg): New.
	(putop): New suffix character 'G'.
	(dis386): Use it for in, out, ins, and outs.
	(intel_operand_size): Handle z_mode.
	(OP_REG): Delete unreachable case indir_dx_reg.
	(OP_IMREG): Fix Intel syntax output for case indir_dx_reg. Handle
	z_mode_ax_reg.
	(OP_ESreg): Fix Intel syntax operand size handling.
	(OP_DSreg): Likewise.

gas/testsuite/
2006-11-30  Jan Beulich  <jbeulich@@novell.com>

	* gas/i386/x86-64-io.[sd]: New.
	* gas/i386/x86-64-io-intel.d: New.
	* gas/i386/x86-64-io-suffix.d: New.
	* gas/i386/i386.exp: Run new tests.
@
text
@a104 1
static void SEG_Fixup (int, int);
a242 1
#define Sv SEG_Fixup, v_mode
d294 1
d505 2
d699 1
a699 1
  { "movQ",		Sv, Sw, XX, XX },
d701 1
a701 1
  { "movQ",		Sw, Sv, XX, XX },
d1604 2
a1605 2
    { "sldt",	Ev, XX, XX, XX },
    { "str",	Ev, XX, XX, XX },
d1619 1
a1619 1
    { "smsw",	Ev, XX, XX, XX },
d3752 17
d4886 1
a4886 1
OP_SEG (int dummy ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d4888 4
a4891 1
  oappend (names_seg[reg]);
a5634 49
SEG_Fixup (int extrachar, int sizeflag)
{
  if (mod == 3)
    {
      /* We need to add a proper suffix with

		movw %ds,%ax
		movl %ds,%eax
		movq %ds,%rax
		movw %ax,%ds
		movl %eax,%ds
		movq %rax,%ds
       */
      const char *suffix;

      if (prefixes & PREFIX_DATA)
	suffix = "w";
      else
	{
	  USED_REX (REX_MODE64);
	  if (rex & REX_MODE64)
	    suffix = "q";
	  else
	    suffix = "l";
	}
      strcat (obuf, suffix);
    }
  else
    {
      /* We need to fix the suffix for

		movw %ds,(%eax)
		movw %ds,(%rax)
		movw (%eax),%ds
		movw (%rax),%ds

	 Override "mov[l|q]".  */
      char *p = obuf + strlen (obuf) - 1;

      /* We might not have a suffix.  */
      if (*p == 'v')
	++p;
      *p = 'w';
    }

  OP_E (extrachar, sizeflag);
}

static void
@


1.93
log
@opcodes/
2006-11-30  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (dis386): Use 'R' and 'O' for cbw/cwd unconditionally.
	(putop): For 'O' suffix, print 'q' in Intel mode, and mark data prefix
	used. For 'R' and 'W' suffix, simplify and fix Intel mode.

gas/testsuite/
2006-11-30  Jan Beulich  <jbeulich@@novell.com>

	* gas/i386/intel.s: Use Intel syntax in Intel syntax test.
	* gas/i386/x86-64-cbw.[sd]: New.
	* gas/i386/x86-64-cbw-intel.d: New.
	* gas/i386/i386.exp: Run new tests.
@
text
@d292 1
d301 1
d330 1
d358 1
d403 1
d508 1
d663 1
a663 1
  { "ins{R||R|}",	Yvr, indirDX, XX, XX },
d665 1
a665 1
  { "outs{R||R|}",	indirDXr, Xv, XX, XX },
d798 1
a798 1
  { "inS",		eAX, Ib, XX, XX },
d800 1
a800 1
  { "outS",		Ib, eAX, XX, XX },
d807 1
a807 1
  { "inS",		eAX, indirDX, XX, XX },
d809 1
a809 1
  { "outS",		indirDX, eAX, XX, XX },
d3776 10
d4120 7
a4576 6
    case indir_dx_reg:
      if (intel_syntax)
	s = "[dx]";
      else
	s = "(%dx)";
      break;
d4629 1
a4629 1
	s = "[dx]";
d4660 8
d4981 16
a4996 1
    intel_operand_size (codep[-1] & 1 ? v_mode : b_mode, sizeflag);
d5005 15
a5019 4
    intel_operand_size (codep[-1] != 0xd7 && (codep[-1] & 1)
			? v_mode
			: b_mode,
			sizeflag);
@


1.92
log
@2006-11-09  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (print_insn): Check PREFIX_REPNZ before
	PREFIX_DATA when prefix user table is used.
@
text
@d509 1
a509 1
   'O' => print 'd', or 'o'
d514 1
a514 1
   'R' => print 'w', 'l' or 'q' ("wd" or "dq" in intel mode)
d519 1
a519 1
   'W' => print 'b' or 'w' ("w" or "de" in intel mode)
d706 2
a707 2
  { "cW{tR||tR|}",	XX, XX, XX, XX },
  { "cR{tO||tO|}",	XX, XX, XX, XX },
d3815 2
d3819 2
d3881 3
a3883 1
	  if (intel_syntax)
d3885 1
a3885 7
	      if (rex & REX_MODE64)
		{
		  *obufp++ = 'q';
		  *obufp++ = 't';
		}
	      else if (sizeflag & DFLAG)
		{
a3886 2
		  *obufp++ = 'q';
		}
d3888 1
a3888 4
		{
		  *obufp++ = 'w';
		  *obufp++ = 'd';
		}
d3891 4
a3894 8
	    {
	      if (rex & REX_MODE64)
		*obufp++ = 'q';
	      else if (sizeflag & DFLAG)
		*obufp++ = 'l';
	      else
		*obufp++ = 'w';
	    }
d3944 8
a3951 3
	  USED_REX (0);
	  if (rex)
	    *obufp++ = 'l';
d3956 1
a3956 18
	  if (intel_syntax)
	    {
	      if (rex)
		{
		  *obufp++ = 'q';
		  *obufp++ = 'e';
		}
	      if (sizeflag & DFLAG)
		{
		  *obufp++ = 'd';
		  *obufp++ = 'e';
		}
	      else
		{
		  *obufp++ = 'w';
		}
	    }
	  if (!rex)
@


1.91
log
@2006-11-09  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (twobyte_uses_SSE_prefix): Renamed to ...
	(twobyte_uses_DATA_prefix): This.
	(twobyte_uses_REPNZ_prefix): New.
	(twobyte_uses_REPZ_prefix): Likewise.
	(threebyte_0x38_uses_DATA_prefix): Likewise.
	(threebyte_0x38_uses_REPNZ_prefix): Likewise.
	(threebyte_0x38_uses_REPZ_prefix): Likewise.
	(threebyte_0x3a_uses_DATA_prefix): Likewise.
	(threebyte_0x3a_uses_REPNZ_prefix): Likewise.
	(threebyte_0x3a_uses_REPZ_prefix): Likewise.
	(print_insn): Updated checking usages of DATA/REPNZ/REPZ
	prefixes.
@
text
@d3142 5
a3146 3
		  used_prefixes |= (prefixes & PREFIX_DATA);
		  if (prefixes & PREFIX_DATA)
		    index = 2;
d3149 3
a3151 3
		      used_prefixes |= (prefixes & PREFIX_REPNZ);
		      if (prefixes & PREFIX_REPNZ)
			index = 3;
@


1.90
log
@Fix AMDFAM10 POPCNT instruction
@
text
@d1161 1
a1161 1
static const unsigned char twobyte_uses_SSE_prefix[256] = {
d1184 190
d2842 2
a2843 1
  unsigned char uses_SSE_prefix, uses_LOCK_prefix;
d2847 1
d3015 1
d3018 1
d3020 2
a3021 1
      dp = &dis386_twobyte[*++codep];
d3023 3
a3025 1
      uses_SSE_prefix = twobyte_uses_SSE_prefix[*codep];
d3027 21
d3053 3
a3055 1
      uses_SSE_prefix = 0;
d3057 1
d3060 1
a3060 3
  /*"lzcnt"=0xBD and "popcnt"=0xB8 are the only two non-sse 
    instruction which uses F3 in the opcode without any "rep(z|nz)"*/
  if (!uses_SSE_prefix && (prefixes & PREFIX_REPZ) && *codep != 0xBD && *codep != 0xB8)
d3065 1
a3065 1
  if (!uses_SSE_prefix && (prefixes & PREFIX_REPNZ) && *codep != 0xBD && *codep != 0xB8)
a3070 2
  codep++;

d3090 1
a3090 1
  if (!uses_SSE_prefix && (prefixes & PREFIX_DATA))
d3107 1
a3107 2
      FETCH_DATA (info, codep + 2);
      dp = &three_byte_table[dp->bytemode2][*codep++];
@


1.89
log
@2006-09-24  Dwarakanath Rajagopal  <dwarak.rajagopal@@amd.com>

	PR binutils/3100
	* i386-dis.c (prefix_user_table): Fix the second operand of
	maskmovdqu instruction to allow only %xmm register instead of
	both %xmm register and memory.
@
text
@d474 2
d1033 1
a1033 1
  { "popcntS",          Gv, Ev, XX, XX },
d1825 7
d2839 3
a2841 2
  /*"lzcnt"=0xBD is the only non-sse instruction which uses F3 in the opcode without any "rep(z|nz)"*/
  if (!uses_SSE_prefix && (prefixes & PREFIX_REPZ) && *codep !=0xBD)
d2846 1
a2846 1
  if (!uses_SSE_prefix && (prefixes & PREFIX_REPNZ) && *codep !=0xBD)
@


1.88
log
@gas/

2006-09-23  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/3235
	* config/tc-i386.c (match_template): Check address size prefix
	to turn Disp64/Disp32/Disp16 operand into Disp32/Disp16/Disp32
	operand.

gas/testsuite/

2006-09-23  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/3235
	* gas/i386/addr16.d: New file.
	* gas/i386/addr16.s: Likewise.
	* gas/i386/addr32.d: Likewise.
	* gas/i386/addr32.s: Likewise.

	* gas/i386/i386.exp: Add "addr16" and "addr32".

	* gas/i386/x86-64-addr32.s: Add tests for "add32 mov".
	* gas/i386/x86-64-addr32.d: Updated.

opcodes/

2006-09-23  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/3235
	* i386-dis.c (OP_OFF64): Get 32bit offset if there is an
	address size prefix.
@
text
@d1690 1
a1690 1
    { "maskmovdqu", XM, EX, XX, XX },
@


1.87
log
@* bfd-in.h (STRING_AND_COMMA): New macro.  Takes one constant string as its
  argument and emits the string followed by a comma and then the length of
  the string.
  (CONST_STRNEQ): New macro.  Checks to see if a variable string has a constant
  string as its initial characters.
  (CONST_STRNCPY): New macro.  Copies a constant string to the start of a
  variable string.
* bfd-in2.h: Regenerate.
* <remainign files>: Make use of the new macros.
@
text
@d4696 2
a4697 1
  if (address_mode != mode_64bit)
@


1.86
log
@2006-08-23  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (three_byte_table): Expand to 256 elements.
@
text
@d3 1
a3 1
   2001, 2002, 2003, 2004, 2005 Free Software Foundation, Inc.
d2670 1
a2670 1
      if (strncmp (p, "x86-64", 6) == 0)
d2675 1
a2675 1
      else if (strncmp (p, "i386", 4) == 0)
d2680 1
a2680 1
      else if (strncmp (p, "i8086", 5) == 0)
d2685 1
a2685 1
      else if (strncmp (p, "intel", 5) == 0)
d2689 1
a2689 1
      else if (strncmp (p, "att", 3) == 0)
d2693 1
a2693 1
      else if (strncmp (p, "addr", 4) == 0)
d2700 1
a2700 1
      else if (strncmp (p, "data", 4) == 0)
d2707 1
a2707 1
      else if (strncmp (p, "suffix", 6) == 0)
d5210 3
a5212 3
	  && strncmp (p - 7, "addr", 4) == 0
	  && (strncmp (p - 3, "16", 2) == 0
	      || strncmp (p - 3, "32", 2) == 0))
@


1.85
log
@Fix bug 3000
@
text
@d1832 1
a1832 1
static const struct dis386 three_byte_table[][32] = {
d1835 1
d1844 1
d1853 1
d1862 1
d1870 252
d2126 1
d2135 1
d2144 253
d2405 1
@


1.84
log
@gas/testsuite/

2006-07-18  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/opcode.s: Add sldt, smsw and str.
	* gas/i386/x86-64-opcode.s: Likewise.

	* gas/i386/opcode.d: Updated.
	* gas/i386/x86-64-opcode.d: Likewise.

opcodes/

2006-07-18  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (grps): Change "sldtQ", "strQ" and "smswQ" to
	"sldt", "str" and "smsw".
@
text
@d88 2
d317 2
d1576 1
a1576 1
    { "cvtpi2ps", XM, EM, XX, XX },
d1578 1
a1578 1
    { "cvtpi2pd", XM, EM, XX, XX },
d1583 1
a1583 1
    { "cvtps2pi", MX, EX, XX, XX },
d1585 1
a1585 1
    { "cvtpd2pi", MX, EX, XX, XX },
d1590 1
a1590 1
    { "cvttps2pi", MX, EX, XX, XX },
d1592 1
a1592 1
    { "cvttpd2pi", MX, EX, XX, XX },
d4369 35
@


1.83
log
@2006-07-15  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/2829
	* i386-dis.c (GRP11_C6): NEW.
	(GRP11_C7): Likewise.
	(GRP12): Updated.
	(GRP13): Likewise.
	(GRP14): Likewise.
	(GRP15): Likewise.
	(GRP16): Likewise.
	(GRPAMD): Likewise.
	(GRPPADLCK1): Likewise.
	(GRPPADLCK2): Likewise.
	(dis386): Use GRP11_C6 and GRP11_C7 for entres 0xc6 and 0xc7,
	respectively.
	(grps): Add entries for GRP11_C6 and GRP11_C7.
@
text
@d1401 2
a1402 2
    { "sldtQ",	Ev, XX, XX, XX },
    { "strQ",	Ev, XX, XX, XX },
d1416 1
a1416 1
    { "smswQ",	Ev, XX, XX, XX },
@


1.82
log
@Add amdfam10 instructions
@
text
@d422 10
a431 8
#define GRP12	  NULL, NULL, USE_GROUPS, NULL, 17, NULL, 0, NULL, 0
#define GRP13	  NULL, NULL, USE_GROUPS, NULL, 18, NULL, 0, NULL, 0
#define GRP14	  NULL, NULL, USE_GROUPS, NULL, 19, NULL, 0, NULL, 0
#define GRP15	  NULL, NULL, USE_GROUPS, NULL, 20, NULL, 0, NULL, 0
#define GRP16	  NULL, NULL, USE_GROUPS, NULL, 21, NULL, 0, NULL, 0
#define GRPAMD	  NULL, NULL, USE_GROUPS, NULL, 22, NULL, 0, NULL, 0
#define GRPPADLCK1 NULL, NULL, USE_GROUPS, NULL, 23, NULL, 0, NULL, 0
#define GRPPADLCK2 NULL, NULL, USE_GROUPS, NULL, 24, NULL, 0, NULL, 0
d751 2
a752 2
  { "movA",		Eb, Ib, XX, XX },
  { "movQ",		Ev, Iv, XX, XX },
d1443 22
@


1.81
log
@gas/testsuite/

2006-06-12  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run nops and x86-64-nops.

	* gas/i386/nops.d: New file.
	* gas/i386/nops.s: Likewise.
	* gas/i386/x86-64-nops.d: Likewise.
	* gas/i386/x86-64-nops.s: Likewise.

include/opcode/

2006-06-12  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386.h (i386_optab): Add "nop" with memory reference.

opcodes/

2006-06-12  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (dis386_twobyte): Use "nopQ" for 0x1f.
	(twobyte_has_modrm): Set 1 for 0x1f.
@
text
@d403 1
a403 1
#define FLOAT	  NULL, NULL, FLOATCODE, NULL, 0, NULL, 0
d405 63
a467 59
#define GRP1b	  NULL, NULL, USE_GROUPS, NULL,  0, NULL, 0
#define GRP1S	  NULL, NULL, USE_GROUPS, NULL,  1, NULL, 0
#define GRP1Ss	  NULL, NULL, USE_GROUPS, NULL,  2, NULL, 0
#define GRP2b	  NULL, NULL, USE_GROUPS, NULL,  3, NULL, 0
#define GRP2S	  NULL, NULL, USE_GROUPS, NULL,  4, NULL, 0
#define GRP2b_one NULL, NULL, USE_GROUPS, NULL,  5, NULL, 0
#define GRP2S_one NULL, NULL, USE_GROUPS, NULL,  6, NULL, 0
#define GRP2b_cl  NULL, NULL, USE_GROUPS, NULL,  7, NULL, 0
#define GRP2S_cl  NULL, NULL, USE_GROUPS, NULL,  8, NULL, 0
#define GRP3b	  NULL, NULL, USE_GROUPS, NULL,  9, NULL, 0
#define GRP3S	  NULL, NULL, USE_GROUPS, NULL, 10, NULL, 0
#define GRP4	  NULL, NULL, USE_GROUPS, NULL, 11, NULL, 0
#define GRP5	  NULL, NULL, USE_GROUPS, NULL, 12, NULL, 0
#define GRP6	  NULL, NULL, USE_GROUPS, NULL, 13, NULL, 0
#define GRP7	  NULL, NULL, USE_GROUPS, NULL, 14, NULL, 0
#define GRP8	  NULL, NULL, USE_GROUPS, NULL, 15, NULL, 0
#define GRP9	  NULL, NULL, USE_GROUPS, NULL, 16, NULL, 0
#define GRP12	  NULL, NULL, USE_GROUPS, NULL, 17, NULL, 0
#define GRP13	  NULL, NULL, USE_GROUPS, NULL, 18, NULL, 0
#define GRP14	  NULL, NULL, USE_GROUPS, NULL, 19, NULL, 0
#define GRP15	  NULL, NULL, USE_GROUPS, NULL, 20, NULL, 0
#define GRP16	  NULL, NULL, USE_GROUPS, NULL, 21, NULL, 0
#define GRPAMD	  NULL, NULL, USE_GROUPS, NULL, 22, NULL, 0
#define GRPPADLCK1 NULL, NULL, USE_GROUPS, NULL, 23, NULL, 0
#define GRPPADLCK2 NULL, NULL, USE_GROUPS, NULL, 24, NULL, 0

#define PREGRP0   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  0, NULL, 0
#define PREGRP1   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  1, NULL, 0
#define PREGRP2   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  2, NULL, 0
#define PREGRP3   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  3, NULL, 0
#define PREGRP4   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  4, NULL, 0
#define PREGRP5   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  5, NULL, 0
#define PREGRP6   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  6, NULL, 0
#define PREGRP7   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  7, NULL, 0
#define PREGRP8   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  8, NULL, 0
#define PREGRP9   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  9, NULL, 0
#define PREGRP10  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 10, NULL, 0
#define PREGRP11  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 11, NULL, 0
#define PREGRP12  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 12, NULL, 0
#define PREGRP13  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 13, NULL, 0
#define PREGRP14  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 14, NULL, 0
#define PREGRP15  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 15, NULL, 0
#define PREGRP16  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 16, NULL, 0
#define PREGRP17  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 17, NULL, 0
#define PREGRP18  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 18, NULL, 0
#define PREGRP19  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 19, NULL, 0
#define PREGRP20  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 20, NULL, 0
#define PREGRP21  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 21, NULL, 0
#define PREGRP22  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 22, NULL, 0
#define PREGRP23  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 23, NULL, 0
#define PREGRP24  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 24, NULL, 0
#define PREGRP25  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 25, NULL, 0
#define PREGRP26  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 26, NULL, 0
#define PREGRP27  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 27, NULL, 0
#define PREGRP28  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 28, NULL, 0
#define PREGRP29  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 29, NULL, 0
#define PREGRP30  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 30, NULL, 0
#define PREGRP31  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 31, NULL, 0
#define PREGRP32  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 32, NULL, 0
d469 1
a469 1
#define X86_64_0  NULL, NULL, X86_64_SPECIAL, NULL,  0, NULL, 0
d471 2
a472 2
#define THREE_BYTE_0 NULL, NULL, IS_3BYTE_OPCODE, NULL, 0, NULL, 0
#define THREE_BYTE_1 NULL, NULL, IS_3BYTE_OPCODE, NULL, 1, NULL, 0
d484 2
d527 8
a534 8
  { "addB",		Eb, Gb, XX },
  { "addS",		Ev, Gv, XX },
  { "addB",		Gb, Eb, XX },
  { "addS",		Gv, Ev, XX },
  { "addB",		AL, Ib, XX },
  { "addS",		eAX, Iv, XX },
  { "push{T|}",		es, XX, XX },
  { "pop{T|}",		es, XX, XX },
d536 8
a543 8
  { "orB",		Eb, Gb, XX },
  { "orS",		Ev, Gv, XX },
  { "orB",		Gb, Eb, XX },
  { "orS",		Gv, Ev, XX },
  { "orB",		AL, Ib, XX },
  { "orS",		eAX, Iv, XX },
  { "push{T|}",		cs, XX, XX },
  { "(bad)",		XX, XX, XX },	/* 0x0f extended opcode escape */
d545 8
a552 8
  { "adcB",		Eb, Gb, XX },
  { "adcS",		Ev, Gv, XX },
  { "adcB",		Gb, Eb, XX },
  { "adcS",		Gv, Ev, XX },
  { "adcB",		AL, Ib, XX },
  { "adcS",		eAX, Iv, XX },
  { "push{T|}",		ss, XX, XX },
  { "pop{T|}",		ss, XX, XX },
d554 8
a561 8
  { "sbbB",		Eb, Gb, XX },
  { "sbbS",		Ev, Gv, XX },
  { "sbbB",		Gb, Eb, XX },
  { "sbbS",		Gv, Ev, XX },
  { "sbbB",		AL, Ib, XX },
  { "sbbS",		eAX, Iv, XX },
  { "push{T|}",		ds, XX, XX },
  { "pop{T|}",		ds, XX, XX },
d563 8
a570 8
  { "andB",		Eb, Gb, XX },
  { "andS",		Ev, Gv, XX },
  { "andB",		Gb, Eb, XX },
  { "andS",		Gv, Ev, XX },
  { "andB",		AL, Ib, XX },
  { "andS",		eAX, Iv, XX },
  { "(bad)",		XX, XX, XX },	/* SEG ES prefix */
  { "daa{|}",		XX, XX, XX },
d572 8
a579 8
  { "subB",		Eb, Gb, XX },
  { "subS",		Ev, Gv, XX },
  { "subB",		Gb, Eb, XX },
  { "subS",		Gv, Ev, XX },
  { "subB",		AL, Ib, XX },
  { "subS",		eAX, Iv, XX },
  { "(bad)",		XX, XX, XX },	/* SEG CS prefix */
  { "das{|}",		XX, XX, XX },
d581 8
a588 8
  { "xorB",		Eb, Gb, XX },
  { "xorS",		Ev, Gv, XX },
  { "xorB",		Gb, Eb, XX },
  { "xorS",		Gv, Ev, XX },
  { "xorB",		AL, Ib, XX },
  { "xorS",		eAX, Iv, XX },
  { "(bad)",		XX, XX, XX },	/* SEG SS prefix */
  { "aaa{|}",		XX, XX, XX },
d590 8
a597 8
  { "cmpB",		Eb, Gb, XX },
  { "cmpS",		Ev, Gv, XX },
  { "cmpB",		Gb, Eb, XX },
  { "cmpS",		Gv, Ev, XX },
  { "cmpB",		AL, Ib, XX },
  { "cmpS",		eAX, Iv, XX },
  { "(bad)",		XX, XX, XX },	/* SEG DS prefix */
  { "aas{|}",		XX, XX, XX },
d599 8
a606 8
  { "inc{S|}",		RMeAX, XX, XX },
  { "inc{S|}",		RMeCX, XX, XX },
  { "inc{S|}",		RMeDX, XX, XX },
  { "inc{S|}",		RMeBX, XX, XX },
  { "inc{S|}",		RMeSP, XX, XX },
  { "inc{S|}",		RMeBP, XX, XX },
  { "inc{S|}",		RMeSI, XX, XX },
  { "inc{S|}",		RMeDI, XX, XX },
d608 8
a615 8
  { "dec{S|}",		RMeAX, XX, XX },
  { "dec{S|}",		RMeCX, XX, XX },
  { "dec{S|}",		RMeDX, XX, XX },
  { "dec{S|}",		RMeBX, XX, XX },
  { "dec{S|}",		RMeSP, XX, XX },
  { "dec{S|}",		RMeBP, XX, XX },
  { "dec{S|}",		RMeSI, XX, XX },
  { "dec{S|}",		RMeDI, XX, XX },
d617 8
a624 8
  { "pushV",		RMrAX, XX, XX },
  { "pushV",		RMrCX, XX, XX },
  { "pushV",		RMrDX, XX, XX },
  { "pushV",		RMrBX, XX, XX },
  { "pushV",		RMrSP, XX, XX },
  { "pushV",		RMrBP, XX, XX },
  { "pushV",		RMrSI, XX, XX },
  { "pushV",		RMrDI, XX, XX },
d626 8
a633 8
  { "popV",		RMrAX, XX, XX },
  { "popV",		RMrCX, XX, XX },
  { "popV",		RMrDX, XX, XX },
  { "popV",		RMrBX, XX, XX },
  { "popV",		RMrSP, XX, XX },
  { "popV",		RMrBP, XX, XX },
  { "popV",		RMrSI, XX, XX },
  { "popV",		RMrDI, XX, XX },
d635 3
a637 3
  { "pusha{P|}",	XX, XX, XX },
  { "popa{P|}",		XX, XX, XX },
  { "bound{S|}",	Gv, Ma, XX },
d639 4
a642 4
  { "(bad)",		XX, XX, XX },	/* seg fs */
  { "(bad)",		XX, XX, XX },	/* seg gs */
  { "(bad)",		XX, XX, XX },	/* op size prefix */
  { "(bad)",		XX, XX, XX },	/* adr size prefix */
d644 8
a651 8
  { "pushT",		Iq, XX, XX },
  { "imulS",		Gv, Ev, Iv },
  { "pushT",		sIb, XX, XX },
  { "imulS",		Gv, Ev, sIb },
  { "ins{b||b|}",	Ybr, indirDX, XX },
  { "ins{R||R|}",	Yvr, indirDX, XX },
  { "outs{b||b|}",	indirDXr, Xb, XX },
  { "outs{R||R|}",	indirDXr, Xv, XX },
d653 8
a660 8
  { "joH",		Jb, XX, cond_jump_flag },
  { "jnoH",		Jb, XX, cond_jump_flag },
  { "jbH",		Jb, XX, cond_jump_flag },
  { "jaeH",		Jb, XX, cond_jump_flag },
  { "jeH",		Jb, XX, cond_jump_flag },
  { "jneH",		Jb, XX, cond_jump_flag },
  { "jbeH",		Jb, XX, cond_jump_flag },
  { "jaH",		Jb, XX, cond_jump_flag },
d662 8
a669 8
  { "jsH",		Jb, XX, cond_jump_flag },
  { "jnsH",		Jb, XX, cond_jump_flag },
  { "jpH",		Jb, XX, cond_jump_flag },
  { "jnpH",		Jb, XX, cond_jump_flag },
  { "jlH",		Jb, XX, cond_jump_flag },
  { "jgeH",		Jb, XX, cond_jump_flag },
  { "jleH",		Jb, XX, cond_jump_flag },
  { "jgH",		Jb, XX, cond_jump_flag },
d673 1
a673 1
  { "(bad)",		XX, XX, XX },
d675 4
a678 4
  { "testB",		Eb, Gb, XX },
  { "testS",		Ev, Gv, XX },
  { "xchgB",		Eb, Gb, XX },
  { "xchgS",		Ev, Gv, XX },
d680 8
a687 8
  { "movB",		Eb, Gb, XX },
  { "movS",		Ev, Gv, XX },
  { "movB",		Gb, Eb, XX },
  { "movS",		Gv, Ev, XX },
  { "movQ",		Sv, Sw, XX },
  { "leaS",		Gv, M, XX },
  { "movQ",		Sw, Sv, XX },
  { "popU",		stackEv, XX, XX },
d689 8
a696 8
  { "xchgS",		NOP_Fixup1, eAX_reg, NOP_Fixup2, eAX_reg, XX },
  { "xchgS",		RMeCX, eAX, XX },
  { "xchgS",		RMeDX, eAX, XX },
  { "xchgS",		RMeBX, eAX, XX },
  { "xchgS",		RMeSP, eAX, XX },
  { "xchgS",		RMeBP, eAX, XX },
  { "xchgS",		RMeSI, eAX, XX },
  { "xchgS",		RMeDI, eAX, XX },
d698 8
a705 8
  { "cW{tR||tR|}",	XX, XX, XX },
  { "cR{tO||tO|}",	XX, XX, XX },
  { "Jcall{T|}",	Ap, XX, XX },
  { "(bad)",		XX, XX, XX },	/* fwait */
  { "pushfT",		XX, XX, XX },
  { "popfT",		XX, XX, XX },
  { "sahf{|}",		XX, XX, XX },
  { "lahf{|}",		XX, XX, XX },
d707 8
a714 8
  { "movB",		AL, Ob, XX },
  { "movS",		eAX, Ov, XX },
  { "movB",		Ob, AL, XX },
  { "movS",		Ov, eAX, XX },
  { "movs{b||b|}",	Ybr, Xb, XX },
  { "movs{R||R|}",	Yvr, Xv, XX },
  { "cmps{b||b|}",	Xb, Yb, XX },
  { "cmps{R||R|}",	Xv, Yv, XX },
d716 8
a723 8
  { "testB",		AL, Ib, XX },
  { "testS",		eAX, Iv, XX },
  { "stosB",		Ybr, AL, XX },
  { "stosS",		Yvr, eAX, XX },
  { "lodsB",		ALr, Xb, XX },
  { "lodsS",		eAXr, Xv, XX },
  { "scasB",		AL, Yb, XX },
  { "scasS",		eAX, Yv, XX },
d725 8
a732 8
  { "movB",		RMAL, Ib, XX },
  { "movB",		RMCL, Ib, XX },
  { "movB",		RMDL, Ib, XX },
  { "movB",		RMBL, Ib, XX },
  { "movB",		RMAH, Ib, XX },
  { "movB",		RMCH, Ib, XX },
  { "movB",		RMDH, Ib, XX },
  { "movB",		RMBH, Ib, XX },
d734 8
a741 8
  { "movS",		RMeAX, Iv64, XX },
  { "movS",		RMeCX, Iv64, XX },
  { "movS",		RMeDX, Iv64, XX },
  { "movS",		RMeBX, Iv64, XX },
  { "movS",		RMeSP, Iv64, XX },
  { "movS",		RMeBP, Iv64, XX },
  { "movS",		RMeSI, Iv64, XX },
  { "movS",		RMeDI, Iv64, XX },
d745 6
a750 6
  { "retT",		Iw, XX, XX },
  { "retT",		XX, XX, XX },
  { "les{S|}",		Gv, Mp, XX },
  { "ldsS",		Gv, Mp, XX },
  { "movA",		Eb, Ib, XX },
  { "movQ",		Ev, Iv, XX },
d752 8
a759 8
  { "enterT",		Iw, Ib, XX },
  { "leaveT",		XX, XX, XX },
  { "lretP",		Iw, XX, XX },
  { "lretP",		XX, XX, XX },
  { "int3",		XX, XX, XX },
  { "int",		Ib, XX, XX },
  { "into{|}",		XX, XX, XX },
  { "iretP",		XX, XX, XX },
d765 4
a768 4
  { "aam{|}",		sIb, XX, XX },
  { "aad{|}",		sIb, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "xlat",		DSBX, XX, XX },
d779 8
a786 8
  { "loopneFH",		Jb, XX, loop_jcxz_flag },
  { "loopeFH",		Jb, XX, loop_jcxz_flag },
  { "loopFH",		Jb, XX, loop_jcxz_flag },
  { "jEcxzH",		Jb, XX, loop_jcxz_flag },
  { "inB",		AL, Ib, XX },
  { "inS",		eAX, Ib, XX },
  { "outB",		Ib, AL, XX },
  { "outS",		Ib, eAX, XX },
d788 8
a795 8
  { "callT",		Jv, XX, XX },
  { "jmpT",		Jv, XX, XX },
  { "Jjmp{T|}",		Ap, XX, XX },
  { "jmp",		Jb, XX, XX },
  { "inB",		AL, indirDX, XX },
  { "inS",		eAX, indirDX, XX },
  { "outB",		indirDX, AL, XX },
  { "outS",		indirDX, eAX, XX },
d797 6
a802 6
  { "(bad)",		XX, XX, XX },	/* lock prefix */
  { "icebp",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },	/* repne */
  { "(bad)",		XX, XX, XX },	/* repz */
  { "hlt",		XX, XX, XX },
  { "cmc",		XX, XX, XX },
d806 6
a811 6
  { "clc",		XX, XX, XX },
  { "stc",		XX, XX, XX },
  { "cli",		XX, XX, XX },
  { "sti",		XX, XX, XX },
  { "cld",		XX, XX, XX },
  { "std",		XX, XX, XX },
d820 6
a825 6
  { "larS",		Gv, Ew, XX },
  { "lslS",		Gv, Ew, XX },
  { "(bad)",		XX, XX, XX },
  { "syscall",		XX, XX, XX },
  { "clts",		XX, XX, XX },
  { "sysretP",		XX, XX, XX },
d827 5
a831 5
  { "invd",		XX, XX, XX },
  { "wbinvd",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "ud2a",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
d833 2
a834 2
  { "femms",		XX, XX, XX },
  { "",			MX, EM, OPSUF }, /* See OP_3DNowSuffix.  */
d839 3
a841 3
  { "movlpX",		EX, XM, SIMD_Fixup, 'h' },
  { "unpcklpX",		XM, EX, XX },
  { "unpckhpX",		XM, EX, XX },
d843 1
a843 1
  { "movhpX",		EX, XM, SIMD_Fixup, 'l' },
d846 7
a852 7
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "nopQ",		Ev, XX, XX },
d854 8
a861 8
  { "movZ",		Rm, Cm, XX },
  { "movZ",		Rm, Dm, XX },
  { "movZ",		Cm, Rm, XX },
  { "movZ",		Dm, Rm, XX },
  { "movL",		Rd, Td, XX },
  { "(bad)",		XX, XX, XX },
  { "movL",		Td, Rd, XX },
  { "(bad)",		XX, XX, XX },
d863 2
a864 2
  { "movapX",		XM, EX, XX },
  { "movapX",		EX, XM, XX },
d866 1
a866 1
  { "movntpX",		Ev, XM, XX },
d869 2
a870 2
  { "ucomisX",		XM,EX, XX },
  { "comisX",		XM,EX, XX },
d872 8
a879 8
  { "wrmsr",		XX, XX, XX },
  { "rdtsc",		XX, XX, XX },
  { "rdmsr",		XX, XX, XX },
  { "rdpmc",		XX, XX, XX },
  { "sysenter",		XX, XX, XX },
  { "sysexit",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
d882 1
a882 1
  { "(bad)",		XX, XX, XX },
d884 5
a888 5
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
d890 8
a897 8
  { "cmovo",		Gv, Ev, XX },
  { "cmovno",		Gv, Ev, XX },
  { "cmovb",		Gv, Ev, XX },
  { "cmovae",		Gv, Ev, XX },
  { "cmove",		Gv, Ev, XX },
  { "cmovne",		Gv, Ev, XX },
  { "cmovbe",		Gv, Ev, XX },
  { "cmova",		Gv, Ev, XX },
d899 8
a906 8
  { "cmovs",		Gv, Ev, XX },
  { "cmovns",		Gv, Ev, XX },
  { "cmovp",		Gv, Ev, XX },
  { "cmovnp",		Gv, Ev, XX },
  { "cmovl",		Gv, Ev, XX },
  { "cmovge",		Gv, Ev, XX },
  { "cmovle",		Gv, Ev, XX },
  { "cmovg",		Gv, Ev, XX },
d908 1
a908 1
  { "movmskpX",		Gdq, XS, XX },
d912 4
a915 4
  { "andpX",		XM, EX, XX },
  { "andnpX",		XM, EX, XX },
  { "orpX",		XM, EX, XX },
  { "xorpX",		XM, EX, XX },
d926 8
a933 8
  { "punpcklbw",	MX, EM, XX },
  { "punpcklwd",	MX, EM, XX },
  { "punpckldq",	MX, EM, XX },
  { "packsswb",		MX, EM, XX },
  { "pcmpgtb",		MX, EM, XX },
  { "pcmpgtw",		MX, EM, XX },
  { "pcmpgtd",		MX, EM, XX },
  { "packuswb",		MX, EM, XX },
d935 4
a938 4
  { "punpckhbw",	MX, EM, XX },
  { "punpckhwd",	MX, EM, XX },
  { "punpckhdq",	MX, EM, XX },
  { "packssdw",		MX, EM, XX },
d941 1
a941 1
  { "movd",		MX, Edq, XX },
d948 4
a951 4
  { "pcmpeqb",		MX, EM, XX },
  { "pcmpeqw",		MX, EM, XX },
  { "pcmpeqd",		MX, EM, XX },
  { "emms",		XX, XX, XX },
d953 4
a956 4
  { "vmread",		Em, Gm, XX },
  { "vmwrite",		Gm, Em, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
d962 8
a969 8
  { "joH",		Jv, XX, cond_jump_flag },
  { "jnoH",		Jv, XX, cond_jump_flag },
  { "jbH",		Jv, XX, cond_jump_flag },
  { "jaeH",		Jv, XX, cond_jump_flag },
  { "jeH",		Jv, XX, cond_jump_flag },
  { "jneH",		Jv, XX, cond_jump_flag },
  { "jbeH",		Jv, XX, cond_jump_flag },
  { "jaH",		Jv, XX, cond_jump_flag },
d971 8
a978 8
  { "jsH",		Jv, XX, cond_jump_flag },
  { "jnsH",		Jv, XX, cond_jump_flag },
  { "jpH",		Jv, XX, cond_jump_flag },
  { "jnpH",		Jv, XX, cond_jump_flag },
  { "jlH",		Jv, XX, cond_jump_flag },
  { "jgeH",		Jv, XX, cond_jump_flag },
  { "jleH",		Jv, XX, cond_jump_flag },
  { "jgH",		Jv, XX, cond_jump_flag },
d980 8
a987 8
  { "seto",		Eb, XX, XX },
  { "setno",		Eb, XX, XX },
  { "setb",		Eb, XX, XX },
  { "setae",		Eb, XX, XX },
  { "sete",		Eb, XX, XX },
  { "setne",		Eb, XX, XX },
  { "setbe",		Eb, XX, XX },
  { "seta",		Eb, XX, XX },
d989 8
a996 8
  { "sets",		Eb, XX, XX },
  { "setns",		Eb, XX, XX },
  { "setp",		Eb, XX, XX },
  { "setnp",		Eb, XX, XX },
  { "setl",		Eb, XX, XX },
  { "setge",		Eb, XX, XX },
  { "setle",		Eb, XX, XX },
  { "setg",		Eb, XX, XX },
d998 6
a1003 6
  { "pushT",		fs, XX, XX },
  { "popT",		fs, XX, XX },
  { "cpuid",		XX, XX, XX },
  { "btS",		Ev, Gv, XX },
  { "shldS",		Ev, Gv, Ib },
  { "shldS",		Ev, Gv, CL },
d1007 6
a1012 6
  { "pushT",		gs, XX, XX },
  { "popT",		gs, XX, XX },
  { "rsm",		XX, XX, XX },
  { "btsS",		Ev, Gv, XX },
  { "shrdS",		Ev, Gv, Ib },
  { "shrdS",		Ev, Gv, CL },
d1014 1
a1014 1
  { "imulS",		Gv, Ev, XX },
d1016 8
a1023 8
  { "cmpxchgB",		Eb, Gb, XX },
  { "cmpxchgS",		Ev, Gv, XX },
  { "lssS",		Gv, Mp, XX },
  { "btrS",		Ev, Gv, XX },
  { "lfsS",		Gv, Mp, XX },
  { "lgsS",		Gv, Mp, XX },
  { "movz{bR|x|bR|x}",	Gv, Eb, XX },
  { "movz{wR|x|wR|x}",	Gv, Ew, XX }, /* yes, there really is movzww ! */
d1025 2
a1026 2
  { "(bad)",		XX, XX, XX },
  { "ud2b",		XX, XX, XX },
d1028 5
a1032 5
  { "btcS",		Ev, Gv, XX },
  { "bsfS",		Gv, Ev, XX },
  { "bsrS",		Gv, Ev, XX },
  { "movs{bR|x|bR|x}",	Gv, Eb, XX },
  { "movs{wR|x|wR|x}",	Gv, Ew, XX }, /* yes, there really is movsww ! */
d1034 2
a1035 2
  { "xaddB",		Eb, Gb, XX },
  { "xaddS",		Ev, Gv, XX },
d1037 4
a1040 4
  { "movntiS",		Ev, Gv, XX },
  { "pinsrw",		MX, Edqw, Ib },
  { "pextrw",		Gdq, MS, Ib },
  { "shufpX",		XM, EX, Ib },
d1043 8
a1050 8
  { "bswap",		RMeAX, XX, XX },
  { "bswap",		RMeCX, XX, XX },
  { "bswap",		RMeDX, XX, XX },
  { "bswap",		RMeBX, XX, XX },
  { "bswap",		RMeSP, XX, XX },
  { "bswap",		RMeBP, XX, XX },
  { "bswap",		RMeSI, XX, XX },
  { "bswap",		RMeDI, XX, XX },
d1053 5
a1057 5
  { "psrlw",		MX, EM, XX },
  { "psrld",		MX, EM, XX },
  { "psrlq",		MX, EM, XX },
  { "paddq",		MX, EM, XX },
  { "pmullw",		MX, EM, XX },
d1059 1
a1059 1
  { "pmovmskb",		Gdq, MS, XX },
d1061 8
a1068 8
  { "psubusb",		MX, EM, XX },
  { "psubusw",		MX, EM, XX },
  { "pminub",		MX, EM, XX },
  { "pand",		MX, EM, XX },
  { "paddusb",		MX, EM, XX },
  { "paddusw",		MX, EM, XX },
  { "pmaxub",		MX, EM, XX },
  { "pandn",		MX, EM, XX },
d1070 6
a1075 6
  { "pavgb",		MX, EM, XX },
  { "psraw",		MX, EM, XX },
  { "psrad",		MX, EM, XX },
  { "pavgw",		MX, EM, XX },
  { "pmulhuw",		MX, EM, XX },
  { "pmulhw",		MX, EM, XX },
d1079 8
a1086 8
  { "psubsb",		MX, EM, XX },
  { "psubsw",		MX, EM, XX },
  { "pminsw",		MX, EM, XX },
  { "por",		MX, EM, XX },
  { "paddsb",		MX, EM, XX },
  { "paddsw",		MX, EM, XX },
  { "pmaxsw",		MX, EM, XX },
  { "pxor",		MX, EM, XX },
d1089 6
a1094 6
  { "psllw",		MX, EM, XX },
  { "pslld",		MX, EM, XX },
  { "psllq",		MX, EM, XX },
  { "pmuludq",		MX, EM, XX },
  { "pmaddwd",		MX, EM, XX },
  { "psadbw",		MX, EM, XX },
d1097 8
a1104 8
  { "psubb",		MX, EM, XX },
  { "psubw",		MX, EM, XX },
  { "psubd",		MX, EM, XX },
  { "psubq",		MX, EM, XX },
  { "paddb",		MX, EM, XX },
  { "paddw",		MX, EM, XX },
  { "paddd",		MX, EM, XX },
  { "(bad)",		XX, XX, XX }
d1144 1
a1144 1
  /* b0 */ 1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1, /* bf */
d1158 1
a1158 1
  /* 20 */ 0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0, /* 2f */
d1163 1
a1163 1
  /* 70 */ 1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1, /* 7f */
d1256 8
a1263 8
    { "addA",	Eb, Ib, XX },
    { "orA",	Eb, Ib, XX },
    { "adcA",	Eb, Ib, XX },
    { "sbbA",	Eb, Ib, XX },
    { "andA",	Eb, Ib, XX },
    { "subA",	Eb, Ib, XX },
    { "xorA",	Eb, Ib, XX },
    { "cmpA",	Eb, Ib, XX }
d1267 8
a1274 8
    { "addQ",	Ev, Iv, XX },
    { "orQ",	Ev, Iv, XX },
    { "adcQ",	Ev, Iv, XX },
    { "sbbQ",	Ev, Iv, XX },
    { "andQ",	Ev, Iv, XX },
    { "subQ",	Ev, Iv, XX },
    { "xorQ",	Ev, Iv, XX },
    { "cmpQ",	Ev, Iv, XX }
d1278 8
a1285 8
    { "addQ",	Ev, sIb, XX },
    { "orQ",	Ev, sIb, XX },
    { "adcQ",	Ev, sIb, XX },
    { "sbbQ",	Ev, sIb, XX },
    { "andQ",	Ev, sIb, XX },
    { "subQ",	Ev, sIb, XX },
    { "xorQ",	Ev, sIb, XX },
    { "cmpQ",	Ev, sIb, XX }
d1289 8
a1296 8
    { "rolA",	Eb, Ib, XX },
    { "rorA",	Eb, Ib, XX },
    { "rclA",	Eb, Ib, XX },
    { "rcrA",	Eb, Ib, XX },
    { "shlA",	Eb, Ib, XX },
    { "shrA",	Eb, Ib, XX },
    { "(bad)",	XX, XX, XX },
    { "sarA",	Eb, Ib, XX },
d1300 8
a1307 8
    { "rolQ",	Ev, Ib, XX },
    { "rorQ",	Ev, Ib, XX },
    { "rclQ",	Ev, Ib, XX },
    { "rcrQ",	Ev, Ib, XX },
    { "shlQ",	Ev, Ib, XX },
    { "shrQ",	Ev, Ib, XX },
    { "(bad)",	XX, XX, XX },
    { "sarQ",	Ev, Ib, XX },
d1311 8
a1318 8
    { "rolA",	Eb, I1, XX },
    { "rorA",	Eb, I1, XX },
    { "rclA",	Eb, I1, XX },
    { "rcrA",	Eb, I1, XX },
    { "shlA",	Eb, I1, XX },
    { "shrA",	Eb, I1, XX },
    { "(bad)",	XX, XX, XX },
    { "sarA",	Eb, I1, XX },
d1322 8
a1329 8
    { "rolQ",	Ev, I1, XX },
    { "rorQ",	Ev, I1, XX },
    { "rclQ",	Ev, I1, XX },
    { "rcrQ",	Ev, I1, XX },
    { "shlQ",	Ev, I1, XX },
    { "shrQ",	Ev, I1, XX },
    { "(bad)",	XX, XX, XX},
    { "sarQ",	Ev, I1, XX },
d1333 8
a1340 8
    { "rolA",	Eb, CL, XX },
    { "rorA",	Eb, CL, XX },
    { "rclA",	Eb, CL, XX },
    { "rcrA",	Eb, CL, XX },
    { "shlA",	Eb, CL, XX },
    { "shrA",	Eb, CL, XX },
    { "(bad)",	XX, XX, XX },
    { "sarA",	Eb, CL, XX },
d1344 8
a1351 8
    { "rolQ",	Ev, CL, XX },
    { "rorQ",	Ev, CL, XX },
    { "rclQ",	Ev, CL, XX },
    { "rcrQ",	Ev, CL, XX },
    { "shlQ",	Ev, CL, XX },
    { "shrQ",	Ev, CL, XX },
    { "(bad)",	XX, XX, XX },
    { "sarQ",	Ev, CL, XX }
d1355 8
a1362 8
    { "testA",	Eb, Ib, XX },
    { "(bad)",	Eb, XX, XX },
    { "notA",	Eb, XX, XX },
    { "negA",	Eb, XX, XX },
    { "mulA",	Eb, XX, XX },	/* Don't print the implicit %al register,  */
    { "imulA",	Eb, XX, XX },	/* to distinguish these opcodes from other */
    { "divA",	Eb, XX, XX },	/* mul/imul opcodes.  Do the same for div  */
    { "idivA",	Eb, XX, XX }	/* and idiv for consistency.		   */
d1366 8
a1373 8
    { "testQ",	Ev, Iv, XX },
    { "(bad)",	XX, XX, XX },
    { "notQ",	Ev, XX, XX },
    { "negQ",	Ev, XX, XX },
    { "mulQ",	Ev, XX, XX },	/* Don't print the implicit register.  */
    { "imulQ",	Ev, XX, XX },
    { "divQ",	Ev, XX, XX },
    { "idivQ",	Ev, XX, XX },
d1377 8
a1384 8
    { "incA",	Eb, XX, XX },
    { "decA",	Eb, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
d1388 8
a1395 8
    { "incQ",	Ev, XX, XX },
    { "decQ",	Ev, XX, XX },
    { "callT",	indirEv, XX, XX },
    { "JcallT",	indirEp, XX, XX },
    { "jmpT",	indirEv, XX, XX },
    { "JjmpT",	indirEp, XX, XX },
    { "pushU",	stackEv, XX, XX },
    { "(bad)",	XX, XX, XX },
d1399 8
a1406 8
    { "sldtQ",	Ev, XX, XX },
    { "strQ",	Ev, XX, XX },
    { "lldt",	Ew, XX, XX },
    { "ltr",	Ew, XX, XX },
    { "verr",	Ew, XX, XX },
    { "verw",	Ew, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX }
d1410 8
a1417 8
    { "sgdt{Q|IQ||}", VMX_Fixup, 0, XX, XX },
    { "sidt{Q|IQ||}", PNI_Fixup, 0, XX, XX },
    { "lgdt{Q|Q||}",	 M, XX, XX },
    { "lidt{Q|Q||}",	 SVME_Fixup, 0, XX, XX },
    { "smswQ",	Ev, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "lmsw",	Ew, XX, XX },
    { "invlpg",	INVLPG_Fixup, w_mode, XX, XX },
d1421 8
a1428 8
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "btQ",	Ev, Ib, XX },
    { "btsQ",	Ev, Ib, XX },
    { "btrQ",	Ev, Ib, XX },
    { "btcQ",	Ev, Ib, XX },
d1432 8
a1439 8
    { "(bad)",	XX, XX, XX },
    { "cmpxchg8b", Eq, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "",	VM, XX, XX },		/* See OP_VMX.  */
    { "vmptrst", Eq, XX, XX },
d1443 8
a1450 8
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "psrlw",	MS, Ib, XX },
    { "(bad)",	XX, XX, XX },
    { "psraw",	MS, Ib, XX },
    { "(bad)",	XX, XX, XX },
    { "psllw",	MS, Ib, XX },
    { "(bad)",	XX, XX, XX },
d1454 8
a1461 8
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "psrld",	MS, Ib, XX },
    { "(bad)",	XX, XX, XX },
    { "psrad",	MS, Ib, XX },
    { "(bad)",	XX, XX, XX },
    { "pslld",	MS, Ib, XX },
    { "(bad)",	XX, XX, XX },
d1465 8
a1472 8
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "psrlq",	MS, Ib, XX },
    { "psrldq",	MS, Ib, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "psllq",	MS, Ib, XX },
    { "pslldq",	MS, Ib, XX },
d1476 8
a1483 8
    { "fxsave", Ev, XX, XX },
    { "fxrstor", Ev, XX, XX },
    { "ldmxcsr", Ev, XX, XX },
    { "stmxcsr", Ev, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "lfence", OP_0fae, 0, XX, XX },
    { "mfence", OP_0fae, 0, XX, XX },
    { "clflush", OP_0fae, 0, XX, XX },
d1487 8
a1494 8
    { "prefetchnta", Ev, XX, XX },
    { "prefetcht0", Ev, XX, XX },
    { "prefetcht1", Ev, XX, XX },
    { "prefetcht2", Ev, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
d1498 8
a1505 8
    { "prefetch", Eb, XX, XX },
    { "prefetchw", Eb, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
d1509 8
a1516 8
    { "xstore-rng", OP_0f07, 0, XX, XX },
    { "xcrypt-ecb", OP_0f07, 0, XX, XX },
    { "xcrypt-cbc", OP_0f07, 0, XX, XX },
    { "xcrypt-ctr", OP_0f07, 0, XX, XX },
    { "xcrypt-cfb", OP_0f07, 0, XX, XX },
    { "xcrypt-ofb", OP_0f07, 0, XX, XX },
    { "(bad)",	OP_0f07, 0, XX, XX },
    { "(bad)",	OP_0f07, 0, XX, XX },
d1520 8
a1527 8
    { "montmul", OP_0f07, 0, XX, XX },
    { "xsha1",   OP_0f07, 0, XX, XX },
    { "xsha256", OP_0f07, 0, XX, XX },
    { "(bad)",	 OP_0f07, 0, XX, XX },
    { "(bad)",   OP_0f07, 0, XX, XX },
    { "(bad)",   OP_0f07, 0, XX, XX },
    { "(bad)",	 OP_0f07, 0, XX, XX },
    { "(bad)",	 OP_0f07, 0, XX, XX },
d1534 4
a1537 4
    { "addps", XM, EX, XX },
    { "addss", XM, EX, XX },
    { "addpd", XM, EX, XX },
    { "addsd", XM, EX, XX },
d1541 4
a1544 4
    { "", XM, EX, OPSIMD },	/* See OP_SIMD_SUFFIX.  */
    { "", XM, EX, OPSIMD },
    { "", XM, EX, OPSIMD },
    { "", XM, EX, OPSIMD },
d1548 4
a1551 4
    { "cvtpi2ps", XM, EM, XX },
    { "cvtsi2ssY", XM, Ev, XX },
    { "cvtpi2pd", XM, EM, XX },
    { "cvtsi2sdY", XM, Ev, XX },
d1555 4
a1558 4
    { "cvtps2pi", MX, EX, XX },
    { "cvtss2siY", Gv, EX, XX },
    { "cvtpd2pi", MX, EX, XX },
    { "cvtsd2siY", Gv, EX, XX },
d1562 4
a1565 4
    { "cvttps2pi", MX, EX, XX },
    { "cvttss2siY", Gv, EX, XX },
    { "cvttpd2pi", MX, EX, XX },
    { "cvttsd2siY", Gv, EX, XX },
d1569 4
a1572 4
    { "divps", XM, EX, XX },
    { "divss", XM, EX, XX },
    { "divpd", XM, EX, XX },
    { "divsd", XM, EX, XX },
d1576 4
a1579 4
    { "maxps", XM, EX, XX },
    { "maxss", XM, EX, XX },
    { "maxpd", XM, EX, XX },
    { "maxsd", XM, EX, XX },
d1583 4
a1586 4
    { "minps", XM, EX, XX },
    { "minss", XM, EX, XX },
    { "minpd", XM, EX, XX },
    { "minsd", XM, EX, XX },
d1590 4
a1593 4
    { "movups", XM, EX, XX },
    { "movss", XM, EX, XX },
    { "movupd", XM, EX, XX },
    { "movsd", XM, EX, XX },
d1597 4
a1600 4
    { "movups", EX, XM, XX },
    { "movss", EX, XM, XX },
    { "movupd", EX, XM, XX },
    { "movsd", EX, XM, XX },
d1604 4
a1607 4
    { "mulps", XM, EX, XX },
    { "mulss", XM, EX, XX },
    { "mulpd", XM, EX, XX },
    { "mulsd", XM, EX, XX },
d1611 4
a1614 4
    { "rcpps", XM, EX, XX },
    { "rcpss", XM, EX, XX },
    { "(bad)", XM, EX, XX },
    { "(bad)", XM, EX, XX },
d1618 4
a1621 4
    { "rsqrtps", XM, EX, XX },
    { "rsqrtss", XM, EX, XX },
    { "(bad)", XM, EX, XX },
    { "(bad)", XM, EX, XX },
d1625 4
a1628 4
    { "sqrtps", XM, EX, XX },
    { "sqrtss", XM, EX, XX },
    { "sqrtpd", XM, EX, XX },
    { "sqrtsd", XM, EX, XX },
d1632 4
a1635 4
    { "subps", XM, EX, XX },
    { "subss", XM, EX, XX },
    { "subpd", XM, EX, XX },
    { "subsd", XM, EX, XX },
d1639 4
a1642 4
    { "(bad)", XM, EX, XX },
    { "cvtdq2pd", XM, EX, XX },
    { "cvttpd2dq", XM, EX, XX },
    { "cvtpd2dq", XM, EX, XX },
d1646 4
a1649 4
    { "cvtdq2ps", XM, EX, XX },
    { "cvttps2dq",XM, EX, XX },
    { "cvtps2dq",XM, EX, XX },
    { "(bad)", XM, EX, XX },
d1653 4
a1656 4
    { "cvtps2pd", XM, EX, XX },
    { "cvtss2sd", XM, EX, XX },
    { "cvtpd2ps", XM, EX, XX },
    { "cvtsd2ss", XM, EX, XX },
d1660 4
a1663 4
    { "maskmovq", MX, MS, XX },
    { "(bad)", XM, EX, XX },
    { "maskmovdqu", XM, EX, XX },
    { "(bad)", XM, EX, XX },
d1667 4
a1670 4
    { "movq", MX, EM, XX },
    { "movdqu", XM, EX, XX },
    { "movdqa", XM, EX, XX },
    { "(bad)", XM, EX, XX },
d1674 4
a1677 4
    { "movq", EM, MX, XX },
    { "movdqu", EX, XM, XX },
    { "movdqa", EX, XM, XX },
    { "(bad)", EX, XM, XX },
d1681 4
a1684 4
    { "(bad)", EX, XM, XX },
    { "movq2dq", XM, MS, XX },
    { "movq", EX, XM, XX },
    { "movdq2q", MX, XS, XX },
d1688 4
a1691 4
    { "pshufw", MX, EM, Ib },
    { "pshufhw", XM, EX, Ib },
    { "pshufd", XM, EX, Ib },
    { "pshuflw", XM, EX, Ib },
d1695 4
a1698 4
    { "movd", Edq, MX, XX },
    { "movq", XM, EX, XX },
    { "movd", Edq, XM, XX },
    { "(bad)", Ed, XM, XX },
d1702 4
a1705 4
    { "(bad)", MX, EX, XX },
    { "(bad)", XM, EX, XX },
    { "punpckhqdq", XM, EX, XX },
    { "(bad)", XM, EX, XX },
d1709 4
a1712 4
    { "movntq", EM, MX, XX },
    { "(bad)", EM, XM, XX },
    { "movntdq", EM, XM, XX },
    { "(bad)", EM, XM, XX },
d1716 4
a1719 4
    { "(bad)", MX, EX, XX },
    { "(bad)", XM, EX, XX },
    { "punpcklqdq", XM, EX, XX },
    { "(bad)", XM, EX, XX },
d1723 4
a1726 4
    { "(bad)", MX, EX, XX },
    { "(bad)", XM, EX, XX },
    { "addsubpd", XM, EX, XX },
    { "addsubps", XM, EX, XX },
d1730 4
a1733 4
    { "(bad)", MX, EX, XX },
    { "(bad)", XM, EX, XX },
    { "haddpd", XM, EX, XX },
    { "haddps", XM, EX, XX },
d1737 4
a1740 4
    { "(bad)", MX, EX, XX },
    { "(bad)", XM, EX, XX },
    { "hsubpd", XM, EX, XX },
    { "hsubps", XM, EX, XX },
d1744 4
a1747 4
    { "movlpX", XM, EX, SIMD_Fixup, 'h' }, /* really only 2 operands */
    { "movsldup", XM, EX, XX },
    { "movlpd", XM, EX, XX },
    { "movddup", XM, EX, XX },
d1751 4
a1754 4
    { "movhpX", XM, EX, SIMD_Fixup, 'l' },
    { "movshdup", XM, EX, XX },
    { "movhpd", XM, EX, XX },
    { "(bad)", XM, EX, XX },
d1758 4
a1761 4
    { "(bad)", XM, EX, XX },
    { "(bad)", XM, EX, XX },
    { "(bad)", XM, EX, XX },
    { "lddqu", XM, M, XX },
d1763 32
d1799 2
a1800 2
    { "arpl", Ew, Gw, XX },
    { "movs{||lq|xd}", Gv, Ed, XX },
d1807 32
a1838 32
    { "pshufb",		MX, EM, XX },
    { "phaddw",		MX, EM, XX },
    { "phaddd",		MX, EM, XX },
    { "phaddsw",	MX, EM, XX },
    { "pmaddubsw",	MX, EM, XX },
    { "phsubw",		MX, EM, XX },
    { "phsubd",		MX, EM, XX },
    { "phsubsw",	MX, EM, XX },
    { "psignb",		MX, EM, XX },
    { "psignw",		MX, EM, XX },
    { "psignd",		MX, EM, XX },
    { "pmulhrsw",	MX, EM, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "pabsb",		MX, EM, XX },
    { "pabsw",		MX, EM, XX },
    { "pabsd",		MX, EM, XX },
    { "(bad)",		XX, XX, XX }
d1842 32
a1873 32
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "palignr",	MX, EM, Ib },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX },
    { "(bad)",		XX, XX, XX }
d2047 2
a2048 2
static char op1out[100], op2out[100], op3out[100];
static int op_ad, op_index[3];
d2050 2
a2051 2
static bfd_vma op_address[3];
static bfd_vma op_riprel[3];
d2101 1
a2101 1
  char *first, *second, *third;
d2216 1
d2218 1
a2218 1
  op_index[0] = op_index[1] = op_index[2] = -1;
d2289 3
a2291 3
  codep++;

  if (!uses_SSE_prefix && (prefixes & PREFIX_REPZ))
d2296 1
a2296 1
  if (!uses_SSE_prefix && (prefixes & PREFIX_REPNZ))
d2301 3
d2403 1
a2403 1
	  op_ad = 2;
d2408 1
a2408 1
	  op_ad = 1;
d2413 1
a2413 1
	  op_ad = 0;
d2416 5
d2460 1
d2462 4
a2465 1
      op_index[0] = op_index[2];
d2467 1
d2471 4
a2474 3
      first = op3out;
      second = op2out;
      third = op1out;
d2485 1
d2496 1
d2505 11
d2517 2
a2518 1
  for (i = 0; i < 3; i++)
d2681 9
a2689 9
#define FGRPd9_2 NULL, NULL, 0, NULL, 0, NULL, 0
#define FGRPd9_4 NULL, NULL, 1, NULL, 0, NULL, 0
#define FGRPd9_5 NULL, NULL, 2, NULL, 0, NULL, 0
#define FGRPd9_6 NULL, NULL, 3, NULL, 0, NULL, 0
#define FGRPd9_7 NULL, NULL, 4, NULL, 0, NULL, 0
#define FGRPda_5 NULL, NULL, 5, NULL, 0, NULL, 0
#define FGRPdb_4 NULL, NULL, 6, NULL, 0, NULL, 0
#define FGRPde_3 NULL, NULL, 7, NULL, 0, NULL, 0
#define FGRPdf_4 NULL, NULL, 8, NULL, 0, NULL, 0
d2694 8
a2701 8
    { "fadd",	ST, STi, XX },
    { "fmul",	ST, STi, XX },
    { "fcom",	STi, XX, XX },
    { "fcomp",	STi, XX, XX },
    { "fsub",	ST, STi, XX },
    { "fsubr",	ST, STi, XX },
    { "fdiv",	ST, STi, XX },
    { "fdivr",	ST, STi, XX },
d2705 2
a2706 2
    { "fld",	STi, XX, XX },
    { "fxch",	STi, XX, XX },
d2708 1
a2708 1
    { "(bad)",	XX, XX, XX },
d2716 5
a2720 5
    { "fcmovb",	ST, STi, XX },
    { "fcmove",	ST, STi, XX },
    { "fcmovbe",ST, STi, XX },
    { "fcmovu",	ST, STi, XX },
    { "(bad)",	XX, XX, XX },
d2722 2
a2723 2
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
d2727 4
a2730 4
    { "fcmovnb",ST, STi, XX },
    { "fcmovne",ST, STi, XX },
    { "fcmovnbe",ST, STi, XX },
    { "fcmovnu",ST, STi, XX },
d2732 3
a2734 3
    { "fucomi",	ST, STi, XX },
    { "fcomi",	ST, STi, XX },
    { "(bad)",	XX, XX, XX },
d2738 4
a2741 4
    { "fadd",	STi, ST, XX },
    { "fmul",	STi, ST, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
d2743 4
a2746 4
    { "fsub",	STi, ST, XX },
    { "fsubr",	STi, ST, XX },
    { "fdiv",	STi, ST, XX },
    { "fdivr",	STi, ST, XX },
d2748 4
a2751 4
    { "fsubr",	STi, ST, XX },
    { "fsub",	STi, ST, XX },
    { "fdivr",	STi, ST, XX },
    { "fdiv",	STi, ST, XX },
d2756 8
a2763 8
    { "ffree",	STi, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "fst",	STi, XX, XX },
    { "fstp",	STi, XX, XX },
    { "fucom",	STi, XX, XX },
    { "fucomp",	STi, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
d2767 3
a2769 3
    { "faddp",	STi, ST, XX },
    { "fmulp",	STi, ST, XX },
    { "(bad)",	XX, XX, XX },
d2772 4
a2775 4
    { "fsubp",	STi, ST, XX },
    { "fsubrp",	STi, ST, XX },
    { "fdivp",	STi, ST, XX },
    { "fdivrp",	STi, ST, XX },
d2777 4
a2780 4
    { "fsubrp",	STi, ST, XX },
    { "fsubp",	STi, ST, XX },
    { "fdivrp",	STi, ST, XX },
    { "fdivp",	STi, ST, XX },
d2785 4
a2788 4
    { "ffreep",	STi, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
d2790 3
a2792 3
    { "fucomip",ST, STi, XX },
    { "fcomip", ST, STi, XX },
    { "(bad)",	XX, XX, XX },
@


1.80
log
@gas/

2006-06-12  H.J. Lu  <hongjiu.lu@@intel.com>

	* config/tc-i386.c (process_suffix): Don't add rex64 for
	"xchg %rax,%rax".

gas/testsuite/

2006-06-12  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/opcode.s: Add "xchg %ax,%ax".
	* gas/i386/opcode.d: Updated.

	* gas/i386/x86-64-opcode.s: Add xchg %ax,%ax, xchg %eax,%eax,
	xchg %rax,%rax, rex64 xchg %rax,%rax and xchg %rax,%r8.
	* gas/i386/x86-64-opcode.d: Updated.

include/opcode/

2006-06-12  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386.h (i386_optab): Update comment for 64bit NOP.

opcodes/

2006-06-12  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (NOP_Fixup): Removed.
	(NOP_Fixup1): New.
	(NOP_Fixup2): Likewise.
	(dis386): Use NOP_Fixup1 and NOP_Fixup2 on 0x90.
@
text
@d846 1
a846 1
  { "(bad)",		XX, XX, XX },
d1128 1
a1128 1
  /* 10 */ 1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0, /* 1f */
@


1.79
log
@2006-06-10  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386.c (GRP10): Renamed to ...
	(GRP12): This.
	(GRP11): Renamed to ...
	(GRP13): This.
	(GRP12): Renamed to ...
	(GRP14): This.
	(GRP13): Renamed to ...
	(GRP15): This.
	(GRP14): Renamed to ...
	(GRP16): This.
	(dis386_twobyte): Updated.
	(grps): Likewise.
@
text
@d94 2
a95 1
static void NOP_Fixup (int, int);
d683 1
a683 1
  { "nop",		NOP_Fixup, 0, XX, XX },
d4364 5
d4370 1
a4370 1
NOP_Fixup (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
a4371 1
  /* NOP with REPZ prefix is called PAUSE.  */
d4374 13
@


1.78
log
@gas/testsuite/

2006-05-09  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run x86-64-gidt.

	* gas/i386/x86-64-gidt.d: New file.
	* gas/i386/x86-64-gidt.s: Likewise.

opcodes/

2006-05-09  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (grps): Update sgdt/sidt for 64bit.
@
text
@d421 5
a425 5
#define GRP10	  NULL, NULL, USE_GROUPS, NULL, 17, NULL, 0
#define GRP11	  NULL, NULL, USE_GROUPS, NULL, 18, NULL, 0
#define GRP12	  NULL, NULL, USE_GROUPS, NULL, 19, NULL, 0
#define GRP13	  NULL, NULL, USE_GROUPS, NULL, 20, NULL, 0
#define GRP14	  NULL, NULL, USE_GROUPS, NULL, 21, NULL, 0
d838 1
a838 1
  { GRP14 },
a937 2
  { GRP10 },
  { GRP11 },
d939 2
d1006 1
a1006 1
  { GRP13 },
d1434 1
a1434 1
  /* GRP10 */
d1445 1
a1445 1
  /* GRP11 */
d1456 1
a1456 1
  /* GRP12 */
d1467 1
a1467 1
  /* GRP13 */
d1478 1
a1478 1
  /* GRP14 */
@


1.77
log
@gas/testsuite/

2006-03-07  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/2428
	* gas/i386/i386.exp: Add rep, rep-suffix, x86-64-rep and
	x86-64-rep-suffix.

	* gas/i386/naked.d: Replace repz with rep.
	* gas/i386/x86_64.d: Likewise.

	* gas/i386/rep-suffix.d: New file.
	* gas/i386/rep-suffix.s: Likewise.
	* gas/i386/rep.d: Likewise.
	* gas/i386/rep.s: Likewise.
	* gas/i386/x86-64-rep-suffix.d: Likewise.
	* gas/i386/x86-64-rep-suffix.s: Likewise.
	* gas/i386/x86-64-rep.d: Likewise.
	* gas/i386/x86-64-rep.s: Likewise.

opcodes/

2006-03-07  H.J. Lu  <hongjiu.lu@@intel.com>

	PR binutils/2428
	* i386-dis.c (REP_Fixup): New function.
	(AL): Remove duplicate.
	(Xbr): New.
	(Xvr): Likewise.
	(Ybr): Likewise.
	(Yvr): Likewise.
	(indirDXr): Likewise.
	(ALr): Likewise.
	(eAXr): Likewise.
	(dis386): Updated entries of ins, outs, movs, lods and stos.
@
text
@d1403 2
a1404 2
    { "sgdtIQ", VMX_Fixup, 0, XX, XX },
    { "sidtIQ", PNI_Fixup, 0, XX, XX },
@


1.76
log
@gas/

2006-02-27  H.J. Lu <hongjiu.lu@@intel.com>

	* gas/config/tc-i386.c (output_insn): Support Intel Merom New
	Instructions.

	* gas/config/tc-i386.h (CpuMNI): New.
	(CpuUnknownFlags): Add CpuMNI.

gas/testsuite/

2006-02-27  H.J. Lu <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Add merom and x86-64-merom.

	* gas/i386/merom.d: New file.
	* gas/i386/merom.s: Likewise.
	* gas/i386/x86-64-merom.d: Likewise.
	* gas/i386/x86-64-merom.s: Likewise.

include/opcode/

2006-02-27  H.J. Lu <hongjiu.lu@@intel.com>

	* i386.h (i386_optab): Support Intel Merom New Instructions.

opcodes/

2006-02-27  H.J. Lu <hongjiu.lu@@intel.com>

	* i386-dis.c (IS_3BYTE_OPCODE): New for 3-byte opcodes used by
	Intel Merom New Instructions.
	(THREE_BYTE_0): Likewise.
	(THREE_BYTE_1): Likewise.
	(three_byte_table): Likewise.
	(dis386_twobyte): Use THREE_BYTE_0 for entry 0x38. Use
	THREE_BYTE_1 for entry 0x3a.
	(twobyte_has_modrm): Updated.
	(twobyte_uses_SSE_prefix): Likewise.
	(print_insn): Handle 3-byte opcodes used by Intel Merom New
	Instructions.
@
text
@d104 1
a279 1
#define AL OP_IMREG, al_reg
d318 9
d641 4
a644 4
  { "ins{b||b|}",	Yb, indirDX, XX },
  { "ins{R||R|}",	Yv, indirDX, XX },
  { "outs{b||b|}",	indirDX, Xb, XX },
  { "outs{R||R|}",	indirDX, Xv, XX },
d704 2
a705 2
  { "movs{b||b|}",	Yb, Xb, XX },
  { "movs{R||R|}",	Yv, Xv, XX },
d711 4
a714 4
  { "stosB",		Yb, AL, XX },
  { "stosS",		Yv, eAX, XX },
  { "lodsB",		AL, Xb, XX },
  { "lodsS",		eAX, Xv, XX },
d4789 73
@


1.75
log
@gas/testsuite/

2006-02-11  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Add "x86-64-drx" and "x86-64-drx-suffix".

	* gas/i386/x86-64-crx-suffix.d: Minor update.

	* gas/i386/x86-64-drx-suffix.d: New file.
	* gas/i386/x86-64-drx.d: Likewise.
	* gas/i386/x86-64-drx.s: Likewise.

opcodes/

2006-02-11  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (dis386_twobyte): Use "movZ" for debug register
	moves.
@
text
@d391 1
d457 3
d865 1
d867 1
a867 2
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
d1120 1
a1120 1
  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
d1143 1
a1143 1
  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
d1756 73
d2286 9
a2294 1
  if (need_modrm)
@


1.74
log
@gas/testsuite/

2006-02-11  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Add "x86-64-crx" and "x86-64-crx-suffix".

	* gas/i386/x86-64-crx-suffix.d: New file.
	* gas/i386/x86-64-crx.d: Likewise.
	* gas/i386/x86-64-crx.s: Likewise.

opcodes/

2006-02-11  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c ('Z'): Add a new macro.
	(dis386_twobyte): Use "movZ" for control register moves.
@
text
@d835 1
a835 1
  { "movL",		Rm, Dm, XX },
d837 1
a837 1
  { "movL",		Dm, Rm, XX },
@


1.73
log
@opcodes/
2005-12-08  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (MAXLEN): Reduce to architectural limit.
	(fetch_data): Check for sufficient buffer size.
@
text
@d494 1
d834 1
a834 1
  { "movL",		Rm, Cm, XX },
d836 1
a836 1
  { "movL",		Cm, Rm, XX },
d2860 9
@


1.72
log
@opcodes/
2005-12-08  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (OP_ST): Remove prefix in Intel mode.
@
text
@d38 1
a38 1
#define MAXLEN 20
d182 7
a188 4
  status = (*info->read_memory_func) (start,
				      priv->max_fetched,
				      addr - priv->max_fetched,
				      info);
@


1.71
log
@	* i386-dis.c (dofloat): Handle %rip-relative floating point addressing.
@
text
@d2728 1
a2728 1
  oappend ("%st");
@


1.70
log
@gas/

2005-12-06  H.J. Lu  <hongjiu.lu@@intel.com>

	PR gas/1874
	* config/tc-i386.c (match_template): Handle monitor.
	(process_suffix): Likewise.

gas/testsuite/

2005-12-06  H.J. Lu  <hongjiu.lu@@intel.com>

	PR gas/1874
	* gas/i386/i386.exp: Add x86-64-prescott for 64bit.

	* gas/i386/prescott.s: Test address size override for monitor.
	* gas/i386/prescott.d: Updated.

	* gas/i386/x86-64-prescott.d: New file.
	* gas/i386/x86-64-prescott.s: Likewise.

include/opcode/

2005-12-06  H.J. Lu  <hongjiu.lu@@intel.com>

	PR gas/1874
	* i386.h (i386_optab): Add 64bit support for monitor and mwait.

opcodes/

2005-12-06  H.J. Lu  <hongjiu.lu@@intel.com>

	PR gas/1874
	* i386-dis.c (address_mode): New enum type.
	(address_mode): New variable.
	(mode_64bit): Removed.
	(ckprefix): Updated to check address_mode instead of mode_64bit.
	(prefix_name): Likewise.
	(print_insn): Likewise.
	(putop): Likewise.
	(print_operand_value): Likewise.
	(intel_operand_size): Likewise.
	(OP_E): Likewise.
	(OP_G): Likewise.
	(set_op): Likewise.
	(OP_REG): Likewise.
	(OP_I): Likewise.
	(OP_I64): Likewise.
	(OP_OFF): Likewise.
	(OP_OFF64): Likewise.
	(ptr_reg): Likewise.
	(OP_C): Likewise.
	(SVME_Fixup): Likewise.
	(print_insn): Set address_mode.
	(PNI_Fixup): Add 64bit and address size override support for
	monitor and mwait.
@
text
@d2692 1
d2714 1
d2717 1
d2719 1
@


1.69
log
@	* i386-dis.c (ckprefix): Handle rex on fwait.  Don't print
	ignored rex prefixes here.
	(print_insn): Instead, handle them similarly to fwait followed
	by non-fp insns.
@
text
@d118 8
a125 2
/* Set to 1 for 64bit mode disassembly.  */
static int mode_64bit;
d1781 1
a1781 1
	    if (mode_64bit)
d1907 1
a1907 1
      if (mode_64bit)
d1979 5
a1983 2
  mode_64bit = (info->mach == bfd_mach_x86_64_intel_syntax
		|| info->mach == bfd_mach_x86_64);
d2003 1
a2003 1
	  mode_64bit = 1;
d2008 1
a2008 1
	  mode_64bit = 0;
d2013 1
a2013 1
	  mode_64bit = 0;
d2182 1
a2182 1
	  if ((sizeflag & AFLAG) || mode_64bit)
d2249 2
a2250 1
	      dp = &x86_64_table[dp->bytemode2][mode_64bit];
d2752 1
a2752 1
	  if (mode_64bit)
d2808 1
a2808 1
	  if (mode_64bit)
d2826 1
a2826 1
		*obufp++ = mode_64bit ? 'q' : 'l';
d2828 1
a2828 1
		*obufp++ = mode_64bit ? 'l' : 'w';
d2874 1
a2874 1
	  if (mode_64bit && (sizeflag & DFLAG))
d2903 1
a2903 1
	  if (mode_64bit && (sizeflag & DFLAG))
d2963 1
a2963 1
	  if (mode_64bit && (sizeflag & DFLAG))
d3093 1
a3093 1
  if (mode_64bit)
d3160 1
a3160 1
      if (mode_64bit && (sizeflag & DFLAG))
d3185 1
a3185 1
      if (mode_64bit)
d3243 1
a3243 1
	  if (mode_64bit)
d3249 1
a3249 1
	  if (mode_64bit && (sizeflag & DFLAG))
d3283 1
a3283 1
  if ((sizeflag & AFLAG) || mode_64bit) /* 32 bit address mode */
d3300 1
a3300 1
	  if (mode_64bit || index != 0x4)
d3317 1
a3317 1
	      if (mode_64bit && !havesib)
d3352 1
a3352 1
	    oappend (mode_64bit && (sizeflag & AFLAG)
d3363 1
a3363 1
		  oappend (mode_64bit && (sizeflag & AFLAG)
d3524 1
a3524 1
      if (mode_64bit)
d3604 1
a3604 1
  if (mode_64bit)
d3652 1
a3652 1
      if (mode_64bit && (sizeflag & DFLAG))
d3738 1
a3738 1
      if (mode_64bit)
d3786 1
a3786 1
  if (!mode_64bit)
d3954 1
a3954 1
  if ((sizeflag & AFLAG) || mode_64bit)
d3977 1
a3977 1
  if (!mode_64bit)
d4009 1
a4009 1
  if (mode_64bit)
d4063 1
a4063 1
  else if (!mode_64bit && (prefixes & PREFIX_LOCK))
d4425 4
a4428 1
      char *p = obuf + strlen (obuf) - 4;
d4434 10
d4449 1
a4449 1
	    strcpy (op1out, names32[0]);
d4457 4
a4460 4
	      if (!mode_64bit)
		strcpy (op1out, names32[0]);
	      else if (!(prefixes & PREFIX_ADDR))
		strcpy (op1out, names64[0]);
d4463 2
a4464 1
		  strcpy (op1out, names32[0]);
d4467 2
a4468 1
	      strcpy (op3out, names32[2]);
d4473 1
a4473 1
	  strcpy (op2out, names32[1]);
d4541 1
a4541 1
      if (mode_64bit || (sizeflag & AFLAG))
@


1.68
log
@gas/testsuite/
2005-09-28  Jan Beulich  <jbeulich@@novell.com>

	* gas/i386/x86-64-stack.s, gas/i386/x86-64-stack.d,
	gas/i386/x86-64-stack-suffix.d, gas/i386/x86-64-stack-intel.d: New.
	* gas/i386/i386.exp: Run new tests.

ld/testsuite/
2005-09-28  Jan Beulich  <jbeulich@@novell.com>

	* ld-x86-64/tlspic.dd: Adjust.

opcodes/
2005-09-28  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (stack_v_mode): Renamed from branch_v_mode.
	(indirEv): Use it.
	(stackEv): New.
	(Ob64, Ov64): Rename to Ob, Ov. Delete unused original definitions.
	(dis386): Document and use new 'V' meta character. Use it for
	single-byte push/pop opcode forms. Use stackEv for mod-r/m push/pop
	opcode forms. Correct typo in 'pop ss'. Replace Ob64/Ov64 by Ob/Ov.
	(putop): 'q' suffix for 'T' and 'U' meta depends on DFLAG. Mark
	data prefix as used whenever DFLAG was examined. Handle 'V'.
	(intel_operand_size): Use stack_v_mode.
	(OP_E): Use stack_v_mode, but handle only the special case of
	64-bit mode without operand size override here; fall through to
	v_mode case otherwise.
	(OP_REG): Special case rAX_reg ... rDI_reg only when 64-bit mode
	and no operand size override is present.
	(OP_J): Use get32s for obtaining the displacement also when rex64
	is present.
@
text
@d1817 1
a1817 1
	  if (prefixes)
d1831 2
a1832 2
	  oappend (prefix_name (rex, 0));
	  oappend (" ");
d2120 3
a2122 2
  if ((prefixes & PREFIX_FWAIT)
      && ((*codep < 0xd8) || (*codep > 0xdf)))
d2126 2
a2127 2
      /* fwait not followed by floating point instruction.  Print the
	 first prefix, which is probably fwait itself.  */
@


1.67
log
@opcodes/
2005-08-26  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (intel_operand_size): New, broken out from OP_E for
	re-use.
	(OP_E): Call intel_operand_size, move call site out of mode
	dependent code.
	(OP_OFF): Call intel_operand_size if suffix_always. Remove
	ATTRIBUTE_UNUSED from parameters.
	(OP_OFF64): Likewise.
	(OP_ESreg): Call intel_operand_size.
	(OP_DSreg): Likewise.
	(OP_DIR): Use colon rather than semicolon as separator of far
	jump/call operands.

gas/testsuite/
2005-08-26  Jan Beulich  <jbeulich@@novell.com>

	* gas/i386/intelok.d: Adjust.
@
text
@d203 1
a203 1
#define indirEv OP_indirE, branch_v_mode
d205 1
d284 2
a285 4
#define Ob OP_OFF, b_mode
#define Ob64 OP_OFF64, b_mode
#define Ov OP_OFF, v_mode
#define Ov64 OP_OFF64, v_mode
d331 1
a331 1
#define branch_v_mode 15 /* v_mode for branch.  */
d481 1
d522 1
a522 1
  { "popT|}",		ss, XX, XX },
d587 8
a594 8
  { "pushS",		RMrAX, XX, XX },
  { "pushS",		RMrCX, XX, XX },
  { "pushS",		RMrDX, XX, XX },
  { "pushS",		RMrBX, XX, XX },
  { "pushS",		RMrSP, XX, XX },
  { "pushS",		RMrBP, XX, XX },
  { "pushS",		RMrSI, XX, XX },
  { "pushS",		RMrDI, XX, XX },
d596 8
a603 8
  { "popS",		RMrAX, XX, XX },
  { "popS",		RMrCX, XX, XX },
  { "popS",		RMrDX, XX, XX },
  { "popS",		RMrBX, XX, XX },
  { "popS",		RMrSP, XX, XX },
  { "popS",		RMrBP, XX, XX },
  { "popS",		RMrSI, XX, XX },
  { "popS",		RMrDI, XX, XX },
d657 1
a657 1
  { "popU",		Ev, XX, XX },
d677 4
a680 4
  { "movB",		AL, Ob64, XX },
  { "movS",		eAX, Ov64, XX },
  { "movB",		Ob64, AL, XX },
  { "movS",		Ov64, eAX, XX },
d1364 1
a1364 1
    { "pushU",	Ev, XX, XX },
d2863 1
a2863 1
	  if (mode_64bit)
a2884 1
		   used_prefixes |= (prefixes & PREFIX_DATA);
d2886 1
d2892 1
a2892 1
	  if (mode_64bit)
d2894 2
a2895 1
	      *obufp++ = 'q';
a2912 1
		  used_prefixes |= (prefixes & PREFIX_DATA);
d2914 1
d2949 10
d3148 1
a3148 1
    case branch_v_mode:
d3237 2
a3238 4
	case branch_v_mode:
	  if (mode_64bit)
	    oappend (names64[rm + add]);
	  else
d3240 1
a3240 4
	      if ((sizeflag & DFLAG) || bytemode != branch_v_mode)
		oappend (names32[rm + add]);
	      else
		oappend (names16[rm + add]);
d3242 1
d3244 2
a3245 1
	  break;
d3641 1
a3641 1
      if (mode_64bit)
d3884 1
a3884 1
      if (sizeflag & DFLAG)
@


1.66
log
@gas/testsuite/

2005-07-18  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Add suffix.

	* gas/i386/suffix.d: New file.
	* gas/i386/suffix.s: Likewise.

opcodes/

2005-07-18  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (PNI_Fixup): Update comment.
	(VMX_Fixup): Properly handle the suffix check.
@
text
@d3126 61
d3260 2
a3327 54
	  if (intel_syntax)
	    {
	      switch (bytemode)
		{
		case b_mode:
		  oappend ("BYTE PTR ");
		  break;
		case w_mode:
		case dqw_mode:
		  oappend ("WORD PTR ");
		  break;
		case branch_v_mode:
		case v_mode:
		case dq_mode:
		  USED_REX (REX_MODE64);
		  if (rex & REX_MODE64)
		    oappend ("QWORD PTR ");
		  else if ((sizeflag & DFLAG) || bytemode == dq_mode)
		    oappend ("DWORD PTR ");
		  else
		    oappend ("WORD PTR ");
		  used_prefixes |= (prefixes & PREFIX_DATA);
		  break;
		case d_mode:
		  oappend ("DWORD PTR ");
		  break;
		case q_mode:
		  oappend ("QWORD PTR ");
		  break;
		case m_mode:
		  if (mode_64bit)
		    oappend ("QWORD PTR ");
		  else
		    oappend ("DWORD PTR ");
		  break;
		case f_mode:
		  if (sizeflag & DFLAG)
		    {
		      used_prefixes |= (prefixes & PREFIX_DATA);
		      oappend ("FWORD PTR ");
		    }
		  else
		    oappend ("DWORD PTR ");
		  break;
		case t_mode:
		  oappend ("TBYTE PTR ");
		  break;
		case x_mode:
		  oappend ("XMMWORD PTR ");
		  break;
		default:
		  break;
		}
	    }
d3920 1
a3920 1
    sprintf (scratchbuf, "0x%x,0x%x", seg, offset);
d3927 1
a3927 1
OP_OFF (int bytemode ATTRIBUTE_UNUSED, int sizeflag)
d3931 2
d3954 1
a3954 1
OP_OFF64 (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3964 2
d4010 1
a4010 16
    {
      if (codep[-1] & 1)
	{
	  USED_REX (REX_MODE64);
	  used_prefixes |= (prefixes & PREFIX_DATA);
	  if (rex & REX_MODE64)
	    oappend ("QWORD PTR ");
	  else if ((sizeflag & DFLAG))
	    oappend ("DWORD PTR ");
	  else
	    oappend ("WORD PTR ");
	}
      else
	oappend ("BYTE PTR ");
    }

d4019 4
a4022 16
    {
      if (codep[-1] != 0xd7 && (codep[-1] & 1))
	{
	  USED_REX (REX_MODE64);
	  used_prefixes |= (prefixes & PREFIX_DATA);
	  if (rex & REX_MODE64)
	    oappend ("QWORD PTR ");
	  else if ((sizeflag & DFLAG))
	    oappend ("DWORD PTR ");
	  else
	    oappend ("WORD PTR ");
	}
      else
	oappend ("BYTE PTR ");
    }

@


1.65
log
@gas/

2007-07-15  H.J. Lu <hongjiu.lu@@intel.com>

	* gas/config/tc-i386.h (CpuVMX): New.
	(CpuUnknownFlags): Add CpuVMX.

gas/testsuite/

2007-07-15  H.J. Lu <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Add vmx and x86-64-vmx.

	* gas/i386/vmx.d: New file.
	* gas/i386/vmx.s: Likewise.
	* gas/i386/x86-64-vmx.d: Likewise.
	* gas/i386/x86-64-vmx.s: Likewise.

include/opcode/

2007-07-15  H.J. Lu <hongjiu.lu@@intel.com>

	* i386.h (i386_optab): Support Intel VMX Instructions.

opcodes/

2007-07-15  H.J. Lu <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_VMX): New. Handle Intel VMX Instructions.
	(VMX_Fixup): New. Fix up Intel VMX Instructions.
	(Em): New.
	(Gm): New.
	(VM): New.
	(dis386_twobyte): Updated entries 0x78 and 0x79.
	(twobyte_has_modrm): Likewise.
	(grps): Use OP_VMX in the "sgdtIQ" entry. Updated GRP9.
	(OP_G): Handle m_mode.
@
text
@d4422 1
a4422 1
      /* We might have a suffix.  */
d4620 2
a4621 2
      /* We might have a suffix.  */
      if (*p == 'i')
@


1.64
log
@gas/
2005-07-05  Jan Beulich  <jbeulich@@novell.com>

	* config/tc-i386.h (CpuSVME): New.
	(CpuUnknownFlags): Include CpuSVME.
	* config/tc-i386.c (cpu_arch): Add .pacifica and .svme. Add opteron
	as alias of sledgehammer.
	(md_assemble): Include invlpga in the check for insns with two source
	operands.
	(process_operands): Include SVME insns in the check for ignored
	segment overrides. Adjust diagnostic.
	(i386_index_check): Special-case SVME insns with memory operands.

gas/testsuite/
2005-07-05  Jan Beulich  <jbeulich@@novell.com>

	* gas/i386/svme.d: New.
	* gas/i386/svme.s: New.
	* gas/i386/svme64.d: New.
	* gas/i386/i386.exp: Run new tests.

include/opcode/
2005-07-05  Jan Beulich  <jbeulich@@novell.com>

	* i386.h (i386_optab): Add new insns.

opcodes/
2005-07-05  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (SVME_Fixup): New.
	(grps): Use it for the lidt entry.
	(PNI_Fixup): Call OP_M rather than OP_E.
	(INVLPG_Fixup): Likewise.
@
text
@d91 1
d103 1
d205 1
d214 1
d306 1
d923 2
a924 2
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
d1110 1
a1110 1
  /* 70 */ 1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1, /* 7f */
d1380 1
a1380 1
    { "sgdtIQ",	 M, XX, XX },
d1408 2
a1409 2
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
d3495 6
d4611 47
@


1.63
log
@gas/testsuite/
2005-05-25  Jan Beulich  <jbeulich@@novell.com>

	* gas/i386/intelok.d: Account for 32-bit displacements being shown
	in hex.

opcodes/
2005-05-25  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (OP_E): In Intel mode, display 32-bit displacements in
	hex (but retain it being displayed as signed). Remove redundant
	checks. Add handling of displacements for 16-bit addressing in Intel
	mode.
@
text
@d98 1
d1378 1
a1378 1
    { "lidt{Q|Q||}",	 M, XX, XX },
d4449 71
a4519 1
    OP_E (0, sizeflag);
d4536 1
a4536 1
      OP_E (bytemode, sizeflag);
@


1.62
log
@opcodes/
2005-05-25  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (prefix_name): Remove pointless mode_64bit check.
	(OP_E): Remove redundant REX_EXTZ handling. Remove pointless
	masking of 'rm' in 16-bit memory address handling.
@
text
@d3340 17
a3356 16
	  if (intel_syntax)
	    if (mod != 0 || (base & 7) == 5)
	      {
		/* Don't print zero displacements.  */
		if (disp != 0)
		  {
		    if ((bfd_signed_vma) disp > 0)
		      {
			*obufp++ = '+';
			*obufp = '\0';
		      }

		    print_operand_value (scratchbuf, 0, disp);
		    oappend (scratchbuf);
		  }
	      }
d3414 19
a3432 1
	  oappend (index16[rm + add]);
d3436 13
@


1.61
log
@gas/testsuite/

2005-05-07  H.J. Lu  <hongjiu.lu@@intel.com>

	PR 843
	* gas/i386/i386.exp: Add x86-64-branch.

	* gas/i386/x86-64-branch.d: New.
	* gas/i386/x86-64-branch.s: New.

opcodes/

2005-05-07  H.J. Lu  <hongjiu.lu@@intel.com>

	PR 843
	* i386-dis.c (branch_v_mode): New.
	(indirEv): Use branch_v_mode instead of v_mode.
	(OP_E): Handle branch_v_mode.
@
text
@d1898 1
a1898 1
	return ((sizeflag & AFLAG) && !mode_64bit) ? "addr16" : "addr32";
a3216 1
	  USED_REX (REX_EXTZ);
a3218 2
	  if (rex & REX_EXTZ)
	    base += 8;
d3221 1
a3316 3
	  USED_REX (REX_EXTZ);
	  if (!havesib && (rex & REX_EXTZ))
	    base += 8;
d3382 1
a3382 1
	  if ((rm & 7) == 6)
d3403 1
a3403 1
	if (mod != 0 || (rm & 7) == 6)
d3409 1
a3409 1
      if (mod != 0 || (rm & 7) != 6)
@


1.60
log
@Update the address and phone number of the FSF
@
text
@d200 1
a200 1
#define indirEv OP_indirE, v_mode
d326 1
d3159 12
d3272 1
@


1.59
log
@gas/ChangeLog:
* config/tc-i386.c (md_begin): Allow hyphens in mnemonics.
include/opcode/ChangeLog:
* i386.h: Insert hyphens into selected VIA PadLock extensions.
Add xcrypt-ctr.  Provide aliases without hyphens.
opcodes/ChangeLog:
* i386-dis.c: Insert hyphens into selected VIA PadLock extensions.
Add xcrypt-ctr.
@
text
@d19 1
a19 1
   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
@


1.58
log
@opcodes/
2005-04-01  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (PNI_Fixup): Neither mwait nor monitor have any
	visible operands in Intel mode. The first operand of monitor is
	%rax in 64-bit mode.
@
text
@d1472 8
a1479 8
    { "xstorerng", OP_0f07, 0, XX, XX },
    { "xcryptecb", OP_0f07, 0, XX, XX },
    { "xcryptcbc", OP_0f07, 0, XX, XX },
    { "(bad)",	   OP_0f07, 0, XX, XX },
    { "xcryptcfb", OP_0f07, 0, XX, XX },
    { "xcryptofb", OP_0f07, 0, XX, XX },
    { "(bad)",	   OP_0f07, 0, XX, XX },
    { "(bad)",	   OP_0f07, 0, XX, XX },
@


1.57
log
@include/opcode/
2005-04-01  Jan Beulich  <jbeulich@@novell.com>

	* i386.h (i386_optab): Add rdtscp.

opcodes/
2005-04-01  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (INVLPG_Fixup): Decode rdtscp; change code to allow for
	easier future additions.
@
text
@d4377 2
d4384 18
a4401 1
	  strcpy (op3out, names32[2]);
a4402 3
      strcpy (op1out, names32[0]);
      strcpy (op2out, names32[1]);
      two_source_ops = 1;
@


1.56
log
@gas/testsuite/

2005-03-29  H.J. Lu  <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Run segment and inval-seg for i386. Run
	x86-64-segment and x86-64-inval-seg for x86-64.

	* gas/i386/intel.d: Expect movw for moving between memory and
	segment register.
	* gas/i386/naked.d: Likewise.
	* gas/i386/opcode.d: Likewise.
	* gas/i386/x86-64-opcode.d: Likewise.

	* gas/i386/opcode.s: Use movw for moving between memory and
	segment register.
	* gas/i386/x86-64-opcode.s: Likewise.

	* : Likewise.

	* gas/i386/inval-seg.l: New.
	* gas/i386/inval-seg.s: New.
	* gas/i386/segment.l: New.
	* gas/i386/segment.s: New.
	* gas/i386/x86-64-inval-seg.l: New.
	* gas/i386/x86-64-inval-seg.s: New.
	* gas/i386/x86-64-segment.l: New.
	* gas/i386/x86-64-segment.s: New.

include/opcode/

2005-03-29  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386.h (i386_optab): Don't allow the `l' suffix for moving
	moving between memory and segment register. Allow movq for
	moving between general-purpose register and segment register.

opcodes/

2005-03-29  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (SEG_Fixup): New.
	(Sv): New.
	(dis386): Use "Sv" for 0x8c and 0x8e.
@
text
@d4397 3
a4399 1
  if (*codep == 0xf8)
d4401 9
a4409 5
      char *p = obuf + strlen (obuf);

      /* Override "invlpg".  */
      strcpy (p - 6, "swapgs");
      codep++;
d4411 3
a4413 2
  else
    OP_E (bytemode, sizeflag);
@


1.55
log
@update copyright dates
@
text
@d100 1
d225 1
d647 1
a647 1
  { "movQ",		Ev, Sw, XX },
d649 1
a649 1
  { "movQ",		Sw, Ev, XX },
d4416 49
@


1.55.2.1
log
@include/opcode/
2005-03-15  Jan Beulich  <jbeulich@@novell.com>

	* i386.h (i386_optab): Add rdtscp.

opcodes/
2005-03-15  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (INVLPG_Fixup): Decode rdtscp; change code to allow for
	easier future additions.
@
text
@d4395 3
a4397 1
  const char *alt;
d4399 3
a4401 11
  switch (*codep)
    {
    case 0xf8:
      alt = "swapgs";
      break;
    case 0xf9:
      alt = "rdtscp";
      break;
    default:
      OP_E (bytemode, sizeflag);
      return;
d4403 2
a4404 3
  /* Override "invlpg".  */
  strcpy (obuf + strlen (obuf) - 6, alt);
  codep++;
@


1.55.2.2
log
@opcodes/
2005-03-15  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (PNI_Fixup): Neither mwait nor monitor have any
	visible operands in Intel mode. The first operand of monitor is
	%rax in 64-bit mode.
@
text
@a4374 2
	  if (!intel_syntax)
	    strcpy (op1out, names32[0]);
d4380 1
a4380 18
	  if (!intel_syntax)
	    {
	      if (!mode_64bit)
		strcpy (op1out, names32[0]);
	      else if (!(prefixes & PREFIX_ADDR))
		strcpy (op1out, names64[0]);
	      else
		{
		  strcpy (op1out, names32[0]);
		  used_prefixes |= PREFIX_ADDR;
		}
	      strcpy (op3out, names32[2]);
	    }
	}
      if (!intel_syntax)
	{
	  strcpy (op2out, names32[1]);
	  two_source_ops = 1;
d4382 3
@


1.54
log
@gas/
2005-03-02  Jan Beulich  <jbeulich@@novell.com>

	* config/tc-i386.c (build_modrm_byte): Add lock prefix for cr8...15
	accesses.
	(parse_register): Allow cr8...15 in all modes.

gas/testsuite/
2005-03-02  Jan Beulich  <jbeulich@@novell.com>

	* gas/i386/cr-err.[ls]: New.
	* gas/i386/crx.[ds]: New.
	* gas/i386/i386.exp: Run new tests.

opcodes/
2005-03-02  Jan Beulich  <jbeulich@@novell.com>

	* i386-dis.c (print_insn): Suppress lock prefix printing for cr8...15
	accesses.
	(OP_C): Consider lock prefix in non-64-bit modes.
@
text
@d3 1
a3 1
   2001, 2002, 2003, 2004 Free Software Foundation, Inc.
@


1.53
log
@2005-01-12  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_E): Don't ignore scale in SIB for 64 bit mode.
@
text
@d1959 1
a1959 1
  unsigned char uses_SSE_prefix;
d2131 1
d2138 1
d2152 1
a2152 1
  if (prefixes & PREFIX_LOCK)
a3997 1
  USED_REX (REX_EXTX);
d3999 9
a4007 1
    add = 8;
@


1.52
log
@gas/testsuite/

2005-01-12  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386/i386.exp: Run "sib".

	* gas/i386/sib.d: New file.
	* gas/i386/sib.s: Likewise.

opcodes/

2005-01-12  H.J. Lu  <hongjiu.lu@@intel.com>

	* i386-dis.c (OP_E): Ignore scale when index == 0x4 in SIB.
@
text
@d3195 2
a3196 2
	  if (index != 0x4)
	    /* When INDEX == 0x4, scale is ignored.  */
@


1.51
log
@gas/
2004-11-04 Jan Beulich <jbeulich@@novell.com>

	* config/tc-i386.c (set_intel_syntax): Allow % in symbol names when
	intel syntax and no register prefix, allow $ in symbol names when
	intel syntax.
	(set_16bit_gcc_code_flag): Replace literal 'l' by LONG_MNEM_SUFFIX.
	(intel_float_operand): Add fourth return value indicating math control
	operations. Make classification more precise.
	(md_assemble): Complain if memory operand of mov[sz]x has no size
	specified.
	(parse_insn): Translate word operands to floating point instructions
	operating on integers as well as control instructions to short ones
	as expected by AT&T syntax. Translate 'd' suffix to short one only for
	floating point instructions operating on non-integer operands.
	(match_template): Remove fldcw special case. Adjust q-suffix handling
	to permit it on fild/fistp/fisttp in AT&T mode.
	(process_suffix): Don't guess DefaultSize insns' suffix from
	stackop_size for certain floating point control instructions. Guess
	suffix for branch and [ls][gi]dt based on flag_code. Split error
	messages for Intel and AT&T syntax, and make the condition more strict
	for the former. Adjust suppressing of generation of operand size
	overrides.
	(intel parser): Allow the full set of MASM operators. Add FWORD, TBYTE,
	OWORD, and XMMWORD operand size specifiers (TBYTE replaces XWORD). Add
	more error checking.
	* config/tc-i386.h (BYTE_PTR WORD_PTR DWORD_PTR QWORD_PTR XWORD_PTR
	SHORT OFFSET_FLAT FLAT NONE_FOUND): Remove unused defines.

gas/testsuite/
2004-11-04 Jan Beulich <jbeulich@@novell.com>
	* gas/i386/i386.exp: Execute new tests intelbad and intelok.
	* gas/i386/intelbad.[sl]: New test to check for various things not
	permitted in Intel mode.
	* gas/i386/intel.d, gas/i386/opcode.d, gas/i386/x86-64-opcode.d:
	Adjust for change to segment register store.
	* gas/i386/intelok.[sd]: New test to check various Intel mode specific
	things get handled correctly.
	* gas/i386/x86_64.[sd]: Remove unsupported constructs referring to
	'high' and 'low' parts of an operand, which the parser previously
	accepted while neither telling that it's not supported nor that it
	ignored the remainder of the line following these supposed keywords.

include/opcode/
2004-11-04 Jan Beulich <jbeulich@@novell.com>

	* i386.h (sldx_Suf): Remove.
	(FP, l_FP, sl_FP, x_FP): Don't imply IgnoreSize.
	(q_FP): Define, implying no REX64.
	(x_FP, sl_FP): Imply FloatMF.
	(i386_optab): Split reg and mem forms of moving from segment registers
	so that the memory forms can ignore the 16-/32-bit operand size
	distinction. Adjust a few others for Intel mode. Remove *FP uses from
	all non-floating-point instructions. Unite 32- and 64-bit forms of
	movsx, movzx, and movd. Adjust floating point operations for the above
	changes to the *FP macros. Add DefaultSize to floating point control
	insns operating on larger memory ranges. Remove left over comments
	hinting at certain insns being Intel-syntax ones where the ones
	actually meant are already gone.

opcodes/
2004-11-04 Jan Beulich <jbeulich@@novell.com>

	* i386-dis.c (Eq, Edqw, indirEp, Gdq, I1): Define.
	(indirEb): Remove.
	(Mp): Use f_mode rather than none at all.
	(t_mode, dq_mode, dqw_mode, f_mode, const_1_mode): Define. t_mode
	replaces what previously was x_mode; x_mode now means 128-bit SSE
	operands.
	(dis386): Make far jumps and calls have an 'l' prefix only in AT&T
	mode. movmskpX's, pextrw's, and pmovmskb's first operands are Gdq.
	pinsrw's second operand is Edqw.
	(grps): 1-bit shifts' and rotates' second operands are I1. cmpxchg8b's
	operand is Eq. movntq's and movntdq's first operands are EM. s[gi]dt,
	fldenv, frstor, fsave, fstenv all should also have suffixes in Intel
	mode when an operand size override is present or always suffixing.
	More instructions will need to be added to this group.
	(putop): Handle new macro chars 'C' (short/long suffix selector),
	'I' (Intel mode override for following macro char), and 'J' (for
	adding the 'l' prefix to far branches in AT&T mode). When an
	alternative was specified in the template, honor macro character when
	specified for Intel mode.
	(OP_E): Handle new *_mode values. Correct pointer specifications for
	memory operands. Consolidate output of index register.
	(OP_G): Handle new *_mode values.
	(OP_I): Handle const_1_mode.
	(OP_ESreg, OP_DSreg): Generate pointer specifications. Indicate
	respective opcode prefix bits have been consumed.
	(OP_EM, OP_EX): Provide some default handling for generating pointer
	specifications.
@
text
@a3193 1
	  scale = (*codep >> 6) & 3;
d3195 3
@


1.50
log
@Added new instructions for next version of VIA PadLock core.
@
text
@d196 1
d198 1
a198 1
#define indirEb OP_indirE, b_mode
d200 1
d204 1
a204 1
#define Mp OP_M, 0		/* 32 or 48 bit memory operand for LDS, LES etc */
d208 1
d218 1
d315 9
a323 5
#define x_mode 6  /* 80 bit float operand */
#define m_mode 7  /* d_mode in 32bit, q_mode in 64bit mode.  */
#define cond_jump_mode 8
#define loop_jcxz_mode 9
#define dq_mode 10 /* operand size depends on REX prefixes.  */
d454 2
d459 3
d473 1
a474 1
   'W' => print 'b' or 'w' ("w" or "de" in intel mode)
d661 1
a661 1
  { "lcall{T|}",	Ap, XX, XX },
d751 1
a751 1
  { "ljmp{T|}",		Ap, XX, XX },
d869 1
a869 1
  { "movmskpX",		Gd, XS, XX },
d999 2
a1000 2
  { "pinsrw",		MX, Ed, Ib },
  { "pextrw",		Gd, MS, Ib },
d1020 1
a1020 1
  { "pmovmskb",		Gd, MS, XX },
d1272 6
a1277 6
    { "rolA",	Eb, XX, XX },
    { "rorA",	Eb, XX, XX },
    { "rclA",	Eb, XX, XX },
    { "rcrA",	Eb, XX, XX },
    { "shlA",	Eb, XX, XX },
    { "shrA",	Eb, XX, XX },
d1279 1
a1279 1
    { "sarA",	Eb, XX, XX },
d1283 6
a1288 6
    { "rolQ",	Ev, XX, XX },
    { "rorQ",	Ev, XX, XX },
    { "rclQ",	Ev, XX, XX },
    { "rcrQ",	Ev, XX, XX },
    { "shlQ",	Ev, XX, XX },
    { "shrQ",	Ev, XX, XX },
d1290 1
a1290 1
    { "sarQ",	Ev, XX, XX },
d1352 1
a1352 1
    { "lcallT",	indirEv, XX, XX },
d1354 1
a1354 1
    { "ljmpT",	indirEv, XX, XX },
d1371 4
a1374 4
    { "sgdtQ",	 M, XX, XX },
    { "sidtQ", PNI_Fixup, 0, XX, XX },
    { "lgdtQ",	 M, XX, XX },
    { "lidtQ",	 M, XX, XX },
d1394 1
a1394 1
    { "cmpxchg8b", Ev, XX, XX },
d1670 4
a1673 4
  { "movntq", Ev, MX, XX },
  { "(bad)", Ev, XM, XX },
  { "movntdq", Ev, XM, XX },
  { "(bad)", Ev, XM, XX },
d2355 1
a2355 1
  "fldenv",
d2357 1
a2357 1
  "fNstenv",
d2391 1
a2391 1
  "frstor",
d2393 1
a2393 1
  "fNsave",
d2449 1
a2449 1
  x_mode,
d2451 1
a2451 1
  x_mode,
d2484 1
a2484 1
  x_mode,
d2486 1
a2486 1
  x_mode,
d2717 1
a2717 1
  int alt;
d2748 4
a2751 1
	  break;
d2773 12
d2825 5
d2888 1
a2888 1
	  if (intel_syntax)
d2898 1
a2898 1
		    *obufp++ = 'l';
d3001 1
d3156 1
d3160 1
a3160 1
	  else if ((sizeflag & DFLAG) || bytemode == dq_mode)
d3250 1
d3254 5
a3258 1
		  if (sizeflag & DFLAG)
d3262 1
d3272 2
d3275 7
d3283 4
a3286 1
		    oappend ("QWORD PTR ");
d3289 1
a3289 1
		  oappend ("XWORD PTR ");
d3294 1
a3294 1
	     }
d3309 1
a3309 1
		  if (intel_syntax)
d3311 2
a3312 8
		      if (havebase)
			{
			  *obufp++ = separator_char;
			  *obufp = '\0';
			}
		      sprintf (scratchbuf, "%s",
			       mode_64bit && (sizeflag & AFLAG)
			       ? names64[index] : names32[index]);
d3314 2
a3315 5
		  else
		    sprintf (scratchbuf, ",%s",
			     mode_64bit && (sizeflag & AFLAG)
			     ? names64[index] : names32[index]);
		  oappend (scratchbuf);
d3431 2
d3436 1
a3436 1
      else if (sizeflag & DFLAG)
d3677 4
d3937 17
d3961 17
d4064 5
d4097 11
@


1.49
log
@Corrections for x86_64 assembly.
@
text
@d392 2
a393 1
#define GRPPADLCK NULL, NULL, USE_GROUPS, NULL, 23, NULL, 0
d952 2
a953 2
  { "(bad)",		XX, XX, XX },
  { GRPPADLCK },
d1091 1
a1091 1
  /* a0 */ 0,0,0,1,1,1,0,1,0,0,0,1,1,1,1,1, /* af */
d1455 1
a1455 1
  /* GRPPADLCK */
d1465 11
@


1.48
log
@include/opcode/
	* i386.h (i386_optab): Remove fildd, fistpd and fisttpd.

opcodes/
	* i386-dis.c (x_mode): Comment.
	(two_source_ops): File scope.
	(float_mem): Correct fisttpll and fistpll.
	(float_mem_mode): New table.
	(dofloat): Use it.
	(OP_E): Correct intel mode PTR output.
	(ptr_reg): Use open_char and close_char.
	(PNI_Fixup): Handle possible suffix on sidt.  Use op1out etc. for
	operands.  Set two_source_ops.

gas/testsuite/
	* gas/i386/prescott.s: Remove fisttpd and fisttpq.
	* gas/i386/prescott.d: Update.
@
text
@d5 1
a5 1
This file is part of GDB.
d7 26
a32 30
This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */

/*
 * 80386 instruction printer by Pace Willisson (pace@@prep.ai.mit.edu)
 * July 1988
 *  modified by John Hassey (hassey@@dg-rtp.dg.com)
 *  x86-64 support added by Jan Hubicka (jh@@suse.cz)
 *  VIA PadLock support by Michal Ludvig (mludvig@@suse.cz)
 */

/*
 * The main tables describing the instructions is essentially a copy
 * of the "Opcode Map" chapter (Appendix A) of the Intel 80386
 * Programmers Manual.  Usually, there is a capital letter, followed
 * by a small letter.  The capital letter tell the addressing mode,
 * and the small letter tells about the operand size.  Refer to
 * the Intel manual for details.
 */
d3165 1
a3165 1
	      if (mode_64bit && !havesib && (sizeflag & AFLAG))
d3855 2
a3856 2
  USED_REX (REX_MODE64);
  if (rex & REX_MODE64)
a3937 4
  int add = 0;
  USED_REX (REX_EXTX);
  if (rex & REX_EXTX)
    add = 8;
d3940 7
a3946 1
    sprintf (scratchbuf, "%%xmm%d", reg + add);
d3948 1
a3948 1
    sprintf (scratchbuf, "%%mm%d", reg + add);
a3965 1
  int add = 0;
a3970 3
  USED_REX (REX_EXTZ);
  if (rex & REX_EXTZ)
    add = 8;
d3977 8
a3984 1
    sprintf (scratchbuf, "%%xmm%d", rm + add);
d3986 1
a3986 1
    sprintf (scratchbuf, "%%mm%d", rm + add);
@


1.47
log
@2004-03-12  Michal Ludvig  <mludvig@@suse.cz>

	* i386-dis.c (GRPPLOCK): Delete.
	(grps): Detele GRPPLOCK entry.
@
text
@d315 1
a315 1
#define x_mode 6
d1884 1
a1935 1
  int two_source_ops;
d2367 1
a2367 1
  "fisttpll",
d2391 76
a2466 1
  "fistpll",
d2645 3
a2647 1
      putop (float_mem[(floatop - 0xd8) * 8 + reg], sizeflag);
d2649 1
a2649 6
      if (floatop == 0xdb)
	OP_E (x_mode, sizeflag);
      else if (floatop == 0xdd)
	OP_E (d_mode, sizeflag);
      else
	OP_E (v_mode, sizeflag);
d3210 6
d3218 1
a3218 1
		case d_mode:
a3856 4
  if (intel_syntax)
    oappend ("[");
  else
    oappend ("(");
d3858 1
d3872 2
a3873 4
  if (intel_syntax)
    oappend ("]");
  else
    oappend (")");
d4238 1
a4238 1
  if (mod == 3 && reg == 1)
d4240 6
a4245 1
      char *p = obuf + strlen (obuf);
a4246 1
      /* Override "sidt".  */
d4250 1
a4250 1
	  strcpy (p - 4, "mwait   %eax,%ecx");
d4255 2
a4256 1
	  strcpy (p - 4, "monitor %eax,%ecx,%edx");
d4258 3
@


1.46
log
@	* i386-dis.c (OP_M, OP_0f0e, OP_0fae, NOP_Fixup): New functions.
	(M, Mp): Use OP_M.
	(None, PADLOCK_SPECIAL, PADLOCK_0): Delete.
	(GRPPADLCK): Define.
	(dis386): Use NOP_Fixup on "nop".
	(dis386_twobyte): Use GRPPADLCK on opcode 0xa7.
	(twobyte_has_modrm): Set for 0xa7.
	(padlock_table): Delete.  Move to..
	(grps): ..here, using OP_0f07.  Use OP_Ofae on lfence, mfence
	and clflush.
	(print_insn): Revert PADLOCK_SPECIAL code.
	(OP_E): Delete sfence, lfence, mfence checks.

	* gas/i386/katmai.d: Revert last change.
@
text
@d396 1
a396 2
#define GRPPLOCK  NULL, NULL, USE_GROUPS, NULL, 23, NULL, 0
#define GRPPADLCK NULL, NULL, USE_GROUPS, NULL, 24, NULL, 0
a1454 11
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
  },
  /* GRPPLOCK */
  {
    { "xstore", XX, XX, XX },
    { "xcryptecb", XX, XX, XX },
    { "xcryptcbc", XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "xcryptcfb", XX, XX, XX },
    { "xcryptofb", XX, XX, XX },
@


1.45
log
@	* i386-dis.c (grps): Use INVLPG_Fixup instead of OP_E for invlpg.
	(INVLPG_Fixup): New function.
	(PNI_Fixup): Remove ATTRIBUTE_UNUSED from sizeflag.

	* opcode/i386.h (i386_optab): Remove CpuNo64 from sysenter and
	sysexit.
@
text
@d94 4
d205 2
a206 2
#define M OP_E, 0		/* lea, lgdt, etc. */
#define Mp OP_E, 0		/* 32 or 48 bit memory operand for LDS, LES etc */
a298 1
#define None OP_E, 0
a369 1
#define PADLOCK_SPECIAL 5
d397 1
a434 2
#define PADLOCK_0  NULL, NULL, PADLOCK_SPECIAL, NULL,  0, NULL, 0

d641 1
a641 2
  { "nop",		XX, XX, XX },
  /* FIXME: NOP with REPz prefix is called PAUSE.  */
d957 1
a957 1
  { PADLOCK_0 },
d1095 1
a1095 1
  /* a0 */ 0,0,0,1,1,1,0,0,0,0,0,1,1,1,1,1, /* af */
d1433 3
a1435 3
    { "lfence", None, XX, XX },
    { "mfence", None, XX, XX },
    { "clflush", None, XX, XX },
d1469 11
a1723 13
static const struct dis386 padlock_table[][8] = {
  {
    { "xstorerng", XX, XX, XX },
    { "xcryptecb", XX, XX, XX },
    { "xcryptcbc", XX, XX, XX },
    { "(bad)", XX, XX, XX },
    { "xcryptcfb", XX, XX, XX },
    { "xcryptofb", XX, XX, XX },
    { "(bad)", XX, XX, XX },
    { "(bad)", XX, XX, XX },
  },
};

a2221 6
	    case PADLOCK_SPECIAL:
	      FETCH_DATA (info, codep + 1);
	      index = (*codep++ >> 3) & 0x07;
	      dp = &padlock_table[dp->bytemode2][index];
	      break;

a3063 11
	  if (codep[-2] == 0xAE && codep[-1] == 0xF8)
	    /* sfence */
	    strcpy (obuf + strlen (obuf) - sizeof ("clflush") + 1, "sfence");
	  else if (codep[-2] == 0xAE && codep[-1] == 0xF0)
	    /* mfence */
	    ;
	  else if (codep[-2] == 0xAE && codep[-1] == 0xe8)
	    /* lfence */
	    ;
	  else
	    BadOp ();	/* bad sfence,lea,lds,les,lfs,lgs,lss modrm */
d3964 49
@


1.44
log
@2004-03-12  Michal Ludvig  <mludvig@@suse.cz>

	* gas/config/tc-i386.c (output_insn): Handle PadLock instructions.
	* gas/config/tc-i386.h (CpuPadLock): New define.
	(CpuUnknownFlags): Added CpuPadLock.
	* include/opcode/i386.h (i386_optab): Added xstore/xcrypt insns.
	* opcodes/i386-dis.c (PADLOCK_SPECIAL, PADLOCK_0): New defines.
	(dis386_twobyte): Opcode 0xa7 is PADLOCK_0.
	(padlock_table): New struct with PadLock instructions.
	(print_insn): Handle PADLOCK_SPECIAL.
@
text
@d98 1
d1369 1
a1369 1
    { "invlpg",	Ew, XX, XX },
d4145 1
a4145 1
PNI_Fixup (int extrachar ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d4167 15
@


1.43
log
@opcodes/
	* i386-dis.c (grps): Use clflush by default for 0x0fae/7.
	(OP_E): Twiddle clflush to sfence here.

gas/testsuite/
	* gas/i386/katmai.d: Adjust for clflush change.
@
text
@d3 1
a3 1
   2001, 2002, 2003 Free Software Foundation, Inc.
d26 1
d366 1
d393 1
d431 2
d956 1
a956 1
  { "(bad)",		XX, XX, XX },
d1457 11
d1712 13
d2221 6
@


1.42
log
@	* i386-dis.c (OP_E): Print scale factor on intel mode sib when not
	1.  Don't print scale factor on AT&T mode when index missing.
@
text
@d1429 1
a1429 2
    { "sfence", None, XX, XX },
    /* FIXME: the sfence with memory operand is clflush!  */
d3036 10
a3045 3
	  if (!(codep[-2] == 0xAE && codep[-1] == 0xF8 /* sfence */)
	      && !(codep[-2] == 0xAE && codep[-1] == 0xF0 /* mfence */)
	      && !(codep[-2] == 0xAE && codep[-1] == 0xe8 /* lfence */))
@


1.42.8.1
log
@Merge mainline to intercu branch.
@
text
@d3 1
a3 1
   2001, 2002, 2003, 2004 Free Software Foundation, Inc.
a25 1
 *  VIA PadLock support by Michal Ludvig (mludvig@@suse.cz)
a92 4
static void OP_M (int, int);
static void OP_0fae (int, int);
static void OP_0f07 (int, int);
static void NOP_Fixup (int, int);
a96 1
static void INVLPG_Fixup (int, int);
d199 2
a200 2
#define M OP_M, 0		/* lea, lgdt, etc. */
#define Mp OP_M, 0		/* 32 or 48 bit memory operand for LDS, LES etc */
d293 1
a390 1
#define GRPPADLCK NULL, NULL, USE_GROUPS, NULL, 23, NULL, 0
d634 2
a635 1
  { "nop",		NOP_Fixup, 0, XX, XX },
d951 1
a951 1
  { GRPPADLCK },
d1089 1
a1089 1
  /* a0 */ 0,0,0,1,1,1,0,1,0,0,0,1,1,1,1,1, /* af */
d1363 1
a1363 1
    { "invlpg",	INVLPG_Fixup, w_mode, XX, XX },
d1427 4
a1430 3
    { "lfence", OP_0fae, 0, XX, XX },
    { "mfence", OP_0fae, 0, XX, XX },
    { "clflush", OP_0fae, 0, XX, XX },
a1452 11
  },
  /* GRPPADLCK */
  {
    { "xstorerng", OP_0f07, 0, XX, XX },
    { "xcryptecb", OP_0f07, 0, XX, XX },
    { "xcryptcbc", OP_0f07, 0, XX, XX },
    { "(bad)",	   OP_0f07, 0, XX, XX },
    { "xcryptcfb", OP_0f07, 0, XX, XX },
    { "xcryptofb", OP_0f07, 0, XX, XX },
    { "(bad)",	   OP_0f07, 0, XX, XX },
    { "(bad)",	   OP_0f07, 0, XX, XX },
d3037 4
a3942 49
static void
OP_M (int bytemode, int sizeflag)
{
  if (mod == 3)
    BadOp ();	/* bad lea,lds,les,lfs,lgs,lss modrm */
  else
    OP_E (bytemode, sizeflag);
}

static void
OP_0f07 (int bytemode, int sizeflag)
{
  if (mod != 3 || rm != 0)
    BadOp ();
  else
    OP_E (bytemode, sizeflag);
}

static void
OP_0fae (int bytemode, int sizeflag)
{
  if (mod == 3)
    {
      if (reg == 7)
	strcpy (obuf + strlen (obuf) - sizeof ("clflush") + 1, "sfence");

      if (reg < 5 || rm != 0)
	{
	  BadOp ();	/* bad sfence, mfence, or lfence */
	  return;
	}
    }
  else if (reg != 7)
    {
      BadOp ();		/* bad clflush */
      return;
    }

  OP_E (bytemode, sizeflag);
}

static void
NOP_Fixup (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  /* NOP with REPZ prefix is called PAUSE.  */
  if (prefixes == PREFIX_REPZ)
    strcpy (obuf, "pause");
}

d4103 1
a4103 1
PNI_Fixup (int extrachar ATTRIBUTE_UNUSED, int sizeflag)
a4124 15
}

static void
INVLPG_Fixup (int bytemode, int sizeflag)
{
  if (*codep == 0xf8)
    {
      char *p = obuf + strlen (obuf);

      /* Override "invlpg".  */
      strcpy (p - 6, "swapgs");
      codep++;
    }
  else
    OP_E (bytemode, sizeflag);
@


1.42.8.2
log
@Merge mainline to intercu branch - 2004-09-15
@
text
@d5 1
a5 1
   This file is part of GDB.
d7 30
a36 26
   This program is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 2 of the License, or
   (at your option) any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with this program; if not, write to the Free Software
   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */

/* 80386 instruction printer by Pace Willisson (pace@@prep.ai.mit.edu)
   July 1988
    modified by John Hassey (hassey@@dg-rtp.dg.com)
    x86-64 support added by Jan Hubicka (jh@@suse.cz)
    VIA PadLock support by Michal Ludvig (mludvig@@suse.cz).  */

/* The main tables describing the instructions is essentially a copy
   of the "Opcode Map" chapter (Appendix A) of the Intel 80386
   Programmers Manual.  Usually, there is a capital letter, followed
   by a small letter.  The capital letter tell the addressing mode,
   and the small letter tells about the operand size.  Refer to
   the Intel manual for details.  */
d315 1
a315 1
#define x_mode 6  /* 80 bit float operand */
d396 1
a396 2
#define GRPPADLCK1 NULL, NULL, USE_GROUPS, NULL, 23, NULL, 0
#define GRPPADLCK2 NULL, NULL, USE_GROUPS, NULL, 24, NULL, 0
d955 2
a956 2
  { GRPPADLCK2 },
  { GRPPADLCK1 },
d1094 1
a1094 1
  /* a0 */ 0,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1, /* af */
d1458 1
a1458 1
  /* GRPPADLCK1 */
a1467 11
  },
  /* GRPPADLCK2 */
  {
    { "montmul", OP_0f07, 0, XX, XX },
    { "xsha1",   OP_0f07, 0, XX, XX },
    { "xsha256", OP_0f07, 0, XX, XX },
    { "(bad)",	 OP_0f07, 0, XX, XX },
    { "(bad)",   OP_0f07, 0, XX, XX },
    { "(bad)",   OP_0f07, 0, XX, XX },
    { "(bad)",	 OP_0f07, 0, XX, XX },
    { "(bad)",	 OP_0f07, 0, XX, XX },
a1883 1
static int two_source_ops;
d1935 1
d2367 1
a2367 1
  "fisttp{ll||ll|}",
d2391 1
a2391 76
  "fistp{ll||ll|}",
};

static const unsigned char float_mem_mode[] = {
  /* d8 */
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  /* d9 */
  d_mode,
  0,
  d_mode,
  d_mode,
  0,
  w_mode,
  0,
  w_mode,
  /* da */
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  /* db */
  d_mode,
  d_mode,
  d_mode,
  d_mode,
  0,
  x_mode,
  0,
  x_mode,
  /* dc */
  q_mode,
  q_mode,
  q_mode,
  q_mode,
  q_mode,
  q_mode,
  q_mode,
  q_mode,
  /* dd */
  q_mode,
  q_mode,
  q_mode,
  q_mode,
  0,
  0,
  0,
  w_mode,
  /* de */
  w_mode,
  w_mode,
  w_mode,
  w_mode,
  w_mode,
  w_mode,
  w_mode,
  w_mode,
  /* df */
  w_mode,
  w_mode,
  w_mode,
  w_mode,
  x_mode,
  q_mode,
  x_mode,
  q_mode
d2570 1
a2570 3
      int fp_indx = (floatop - 0xd8) * 8 + reg;

      putop (float_mem[fp_indx], sizeflag);
d2572 6
a2577 1
      OP_E (float_mem_mode[fp_indx], sizeflag);
d3097 1
a3097 1
	      if (mode_64bit && !havesib)
d3138 1
a3138 4
		  if (sizeflag & DFLAG)
		    oappend ("DWORD PTR ");
		  else
		    oappend ("WORD PTR ");
a3140 3
		  oappend ("DWORD PTR ");
		  break;
		case q_mode:
d3779 4
d3784 2
a3785 3
  *obufp++ = open_char;
  used_prefixes |= (prefixes & PREFIX_ADDR);
  if (mode_64bit)
d3797 4
a3800 2
  *obufp++ = close_char;
  *obufp = 0;
d3869 4
d3875 1
a3875 7
    {
      int add = 0;
      USED_REX (REX_EXTX);
      if (rex & REX_EXTX)
	add = 8;
      sprintf (scratchbuf, "%%xmm%d", reg + add);
    }
d3877 1
a3877 1
    sprintf (scratchbuf, "%%mm%d", reg);
d3895 1
d3901 3
d3910 1
a3910 8
    {
      int add = 0;

      USED_REX (REX_EXTZ);
      if (rex & REX_EXTZ)
	add = 8;
      sprintf (scratchbuf, "%%xmm%d", rm + add);
    }
d3912 1
a3912 1
    sprintf (scratchbuf, "%%mm%d", rm);
d4165 1
a4165 1
  if (mod == 3 && reg == 1 && rm <= 1)
d4167 2
a4169 6
      char *p = obuf + strlen (obuf) - 4;

      /* We might have a suffix.  */
      if (*p == 'i')
	--p;

d4173 1
a4173 1
	  strcpy (p, "mwait");
d4178 1
a4178 2
	  strcpy (p, "monitor");
	  strcpy (op3out, names32[2]);
a4179 3
      strcpy (op1out, names32[0]);
      strcpy (op2out, names32[1]);
      two_source_ops = 1;
@


1.42.12.1
log
@Merge with mainline cagney_tramp-20040321-mergepoint.
@
text
@d3 1
a3 1
   2001, 2002, 2003, 2004 Free Software Foundation, Inc.
a25 1
 *  VIA PadLock support by Michal Ludvig (mludvig@@suse.cz)
a92 4
static void OP_M (int, int);
static void OP_0fae (int, int);
static void OP_0f07 (int, int);
static void NOP_Fixup (int, int);
a96 1
static void INVLPG_Fixup (int, int);
d199 2
a200 2
#define M OP_M, 0		/* lea, lgdt, etc. */
#define Mp OP_M, 0		/* 32 or 48 bit memory operand for LDS, LES etc */
d293 1
a390 1
#define GRPPADLCK NULL, NULL, USE_GROUPS, NULL, 23, NULL, 0
d634 2
a635 1
  { "nop",		NOP_Fixup, 0, XX, XX },
d951 1
a951 1
  { GRPPADLCK },
d1089 1
a1089 1
  /* a0 */ 0,0,0,1,1,1,0,1,0,0,0,1,1,1,1,1, /* af */
d1363 1
a1363 1
    { "invlpg",	INVLPG_Fixup, w_mode, XX, XX },
d1427 4
a1430 3
    { "lfence", OP_0fae, 0, XX, XX },
    { "mfence", OP_0fae, 0, XX, XX },
    { "clflush", OP_0fae, 0, XX, XX },
a1452 11
  },
  /* GRPPADLCK */
  {
    { "xstorerng", OP_0f07, 0, XX, XX },
    { "xcryptecb", OP_0f07, 0, XX, XX },
    { "xcryptcbc", OP_0f07, 0, XX, XX },
    { "(bad)",	   OP_0f07, 0, XX, XX },
    { "xcryptcfb", OP_0f07, 0, XX, XX },
    { "xcryptofb", OP_0f07, 0, XX, XX },
    { "(bad)",	   OP_0f07, 0, XX, XX },
    { "(bad)",	   OP_0f07, 0, XX, XX },
d3037 4
a3942 49
static void
OP_M (int bytemode, int sizeflag)
{
  if (mod == 3)
    BadOp ();	/* bad lea,lds,les,lfs,lgs,lss modrm */
  else
    OP_E (bytemode, sizeflag);
}

static void
OP_0f07 (int bytemode, int sizeflag)
{
  if (mod != 3 || rm != 0)
    BadOp ();
  else
    OP_E (bytemode, sizeflag);
}

static void
OP_0fae (int bytemode, int sizeflag)
{
  if (mod == 3)
    {
      if (reg == 7)
	strcpy (obuf + strlen (obuf) - sizeof ("clflush") + 1, "sfence");

      if (reg < 5 || rm != 0)
	{
	  BadOp ();	/* bad sfence, mfence, or lfence */
	  return;
	}
    }
  else if (reg != 7)
    {
      BadOp ();		/* bad clflush */
      return;
    }

  OP_E (bytemode, sizeflag);
}

static void
NOP_Fixup (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  /* NOP with REPZ prefix is called PAUSE.  */
  if (prefixes == PREFIX_REPZ)
    strcpy (obuf, "pause");
}

d4103 1
a4103 1
PNI_Fixup (int extrachar ATTRIBUTE_UNUSED, int sizeflag)
a4124 15
}

static void
INVLPG_Fixup (int bytemode, int sizeflag)
{
  if (*codep == 0xf8)
    {
      char *p = obuf + strlen (obuf);

      /* Override "invlpg".  */
      strcpy (p - 6, "swapgs");
      codep++;
    }
  else
    OP_E (bytemode, sizeflag);
@


1.42.6.1
log
@2004-03-12  Michal Ludvig  <mludvig@@suse.cz>

	* gas/config/tc-i386.c (output_insn): Handle PadLock instructions.
	* gas/config/tc-i386.h (CpuPadLock): New define.
	(CpuUnknownFlags): Added CpuPadLock.
	* include/opcode/i386.h (i386_optab): Added xstore/xcrypt insns.
	* opcodes/i386-dis.c (PADLOCK_SPECIAL, PADLOCK_0): New defines.
	(dis386_twobyte): Opcode 0xa7 is PADLOCK_0.
	(padlock_table): New struct with PadLock instructions.
	(print_insn): Handle PADLOCK_SPECIAL.
@
text
@d3 1
a3 1
   2001, 2002, 2003, 2004 Free Software Foundation, Inc.
a25 1
 *  VIA PadLock support by Michal Ludvig (mludvig@@suse.cz)
a364 1
#define PADLOCK_SPECIAL 5
a390 1
#define GRPPLOCK  NULL, NULL, USE_GROUPS, NULL, 23, NULL, 0
a427 2
#define PADLOCK_0  NULL, NULL, PADLOCK_SPECIAL, NULL,  0, NULL, 0

d951 1
a951 1
  { PADLOCK_0 },
a1452 11
  },
  /* GRPPLOCK */
  {
    { "xstore", XX, XX, XX },
    { "xcryptecb", XX, XX, XX },
    { "xcryptcbc", XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "xcryptcfb", XX, XX, XX },
    { "xcryptofb", XX, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
a1696 13
static const struct dis386 padlock_table[][8] = {
  {
    { "xstorerng", XX, XX, XX },
    { "xcryptecb", XX, XX, XX },
    { "xcryptcbc", XX, XX, XX },
    { "(bad)", XX, XX, XX },
    { "xcryptcfb", XX, XX, XX },
    { "xcryptofb", XX, XX, XX },
    { "(bad)", XX, XX, XX },
    { "(bad)", XX, XX, XX },
  },
};

a2192 6
	      break;

	    case PADLOCK_SPECIAL:
	      FETCH_DATA (info, codep + 1);
	      index = (*codep++ >> 3) & 0x07;
	      dp = &padlock_table[dp->bytemode2][index];
@


1.42.6.2
log
@	Apply the following patches from mainline
	2004-03-12  Michal Ludvig  <mludvig@@suse.cz>
	* i386-dis.c (GRPPLOCK): Delete.
	(grps): Delete GRPPLOCK entry.

	2004-03-12  Alan Modra  <amodra@@bigpond.net.au>
	* i386-dis.c (OP_M, OP_0f0e, OP_0fae, NOP_Fixup): New functions.
	(M, Mp): Use OP_M.
	(None, PADLOCK_SPECIAL, PADLOCK_0): Delete.
	(GRPPADLCK): Define.
	(dis386): Use NOP_Fixup on "nop".
	(dis386_twobyte): Use GRPPADLCK on opcode 0xa7.
	(twobyte_has_modrm): Set for 0xa7.
	(padlock_table): Delete.  Move to..
	(grps): ..here, using OP_0f07.  Use OP_Ofae on lfence, mfence
	and clflush.
	(print_insn): Revert PADLOCK_SPECIAL code.
	(OP_E): Delete sfence, lfence, mfence checks.

	2004-03-12  Jakub Jelinek  <jakub@@redhat.com>
	* i386-dis.c (grps): Use INVLPG_Fixup instead of OP_E for invlpg.
	(INVLPG_Fixup): New function.
	(PNI_Fixup): Remove ATTRIBUTE_UNUSED from sizeflag.

	2004-03-12  Alan Modra  <amodra@@bigpond.net.au>
	* i386-dis.c (grps): Use clflush by default for 0x0fae/7.
	(OP_E): Twiddle clflush to sfence here.
@
text
@a93 4
static void OP_M (int, int);
static void OP_0fae (int, int);
static void OP_0f07 (int, int);
static void NOP_Fixup (int, int);
a97 1
static void INVLPG_Fixup (int, int);
d200 2
a201 2
#define M OP_M, 0		/* lea, lgdt, etc. */
#define Mp OP_M, 0		/* 32 or 48 bit memory operand for LDS, LES etc */
d294 1
d366 1
d393 1
a393 1
#define GRPPADLCK NULL, NULL, USE_GROUPS, NULL, 23, NULL, 0
d431 2
d639 2
a640 1
  { "nop",		NOP_Fixup, 0, XX, XX },
d956 1
a956 1
  { GRPPADLCK },
d1094 1
a1094 1
  /* a0 */ 0,0,0,1,1,1,0,1,0,0,0,1,1,1,1,1, /* af */
d1368 1
a1368 1
    { "invlpg",	INVLPG_Fixup, w_mode, XX, XX },
d1432 4
a1435 3
    { "lfence", OP_0fae, 0, XX, XX },
    { "mfence", OP_0fae, 0, XX, XX },
    { "clflush", OP_0fae, 0, XX, XX },
d1459 1
a1459 1
  /* GRPPADLCK */
d1461 8
a1468 8
    { "xstorerng", OP_0f07, 0, XX, XX },
    { "xcryptecb", OP_0f07, 0, XX, XX },
    { "xcryptcbc", OP_0f07, 0, XX, XX },
    { "(bad)",	   OP_0f07, 0, XX, XX },
    { "xcryptcfb", OP_0f07, 0, XX, XX },
    { "xcryptofb", OP_0f07, 0, XX, XX },
    { "(bad)",	   OP_0f07, 0, XX, XX },
    { "(bad)",	   OP_0f07, 0, XX, XX },
d1713 13
d2224 6
d3072 4
a3977 49
static void
OP_M (int bytemode, int sizeflag)
{
  if (mod == 3)
    BadOp ();	/* bad lea,lds,les,lfs,lgs,lss modrm */
  else
    OP_E (bytemode, sizeflag);
}

static void
OP_0f07 (int bytemode, int sizeflag)
{
  if (mod != 3 || rm != 0)
    BadOp ();
  else
    OP_E (bytemode, sizeflag);
}

static void
OP_0fae (int bytemode, int sizeflag)
{
  if (mod == 3)
    {
      if (reg == 7)
	strcpy (obuf + strlen (obuf) - sizeof ("clflush") + 1, "sfence");

      if (reg < 5 || rm != 0)
	{
	  BadOp ();	/* bad sfence, mfence, or lfence */
	  return;
	}
    }
  else if (reg != 7)
    {
      BadOp ();		/* bad clflush */
      return;
    }

  OP_E (bytemode, sizeflag);
}

static void
NOP_Fixup (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  /* NOP with REPZ prefix is called PAUSE.  */
  if (prefixes == PREFIX_REPZ)
    strcpy (obuf, "pause");
}

d4138 1
a4138 1
PNI_Fixup (int extrachar ATTRIBUTE_UNUSED, int sizeflag)
a4159 15
}

static void
INVLPG_Fixup (int bytemode, int sizeflag)
{
  if (*codep == 0xf8)
    {
      char *p = obuf + strlen (obuf);

      /* Override "invlpg".  */
      strcpy (p - 6, "swapgs");
      codep++;
    }
  else
    OP_E (bytemode, sizeflag);
@


1.42.6.3
log
@Added new instructions for new version of VIA PadLock.
@
text
@d396 1
a396 2
#define GRPPADLCK1 NULL, NULL, USE_GROUPS, NULL, 23, NULL, 0
#define GRPPADLCK2 NULL, NULL, USE_GROUPS, NULL, 24, NULL, 0
d955 2
a956 2
  { GRPPADLCK2 },
  { GRPPADLCK1 },
d1094 1
a1094 1
  /* a0 */ 0,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1, /* af */
d1458 1
a1458 1
  /* GRPPADLCK1 */
a1467 11
  },
  /* GRPPADLCK2 */
  {
    { "montmul", OP_0f07, 0, XX, XX },
    { "xsha1",   OP_0f07, 0, XX, XX },
    { "xsha256", OP_0f07, 0, XX, XX },
    { "(bad)",	 OP_0f07, 0, XX, XX },
    { "(bad)",   OP_0f07, 0, XX, XX },
    { "(bad)",   OP_0f07, 0, XX, XX },
    { "(bad)",	 OP_0f07, 0, XX, XX },
    { "(bad)",	 OP_0f07, 0, XX, XX },
@


1.41
log
@
	* i386-dis.c: Convert to ISO C90 prototypes.
	* i370-dis.c: Likewise.
	* i370-opc.c: Likewiwse.
	* i960-dis.c: Likewise.
	* ia64-opc.c: Likewise.
@
text
@d3176 1
a3176 5
	      if (!intel_syntax
		  || (intel_syntax
		      && bytemode != b_mode
		      && bytemode != w_mode
		      && bytemode != v_mode))
@


1.40
log
@gas/

2003-06-23  H.J. Lu <hongjiu.lu@@intel.com>

	* gas/config/tc-i386.c (md_assemble): Support Intel Precott New
	Instructions.

	* gas/config/tc-i386.h (CpuPNI): New.
	(CpuUnknownFlags): Add CpuPNI.

gas/testsuite/

2003-06-23  H.J. Lu <hongjiu.lu@@intel.com>

	* gas/i386/i386.exp: Add prescott.

	* gas/i386/prescott.d: New file.
	* gas/i386/prescott.s: Likewise.

include/opcode/

2003-06-23  H.J. Lu <hongjiu.lu@@intel.com>

	* i386.h (i386_optab): Support Intel Precott New Instructions.

opcodes/

2003-06-23  H.J. Lu <hongjiu.lu@@intel.com>

	* i386-dis.c (PNI_Fixup): New. Fix up "mwait" and "monitor" in
	Intel Precott New Instructions.
	(PREGRP27): New. Added for "addsubpd" and "addsubps".
	(PREGRP28): New. Added for "haddpd" and "haddps".
	(PREGRP29): New. Added for "hsubpd" and "hsubps".
	(PREGRP30): New. Added for "movsldup" and "movddup".
	(PREGRP31): New. Added for "movshdup" and "movhpd".
	(PREGRP32): New. Added for "lddqu".
	(dis386_twobyte): Use PREGRP30 to replace the "movlpX" entry.
	Use PREGRP31 to replace the "movhpX" entry. Use PREGRP28 for
	entry 0x7c. Use PREGRP29 for entry 0x7d. Use PREGRP27 for
	entry 0xd0. Use PREGRP32 for entry 0xf0.
	(twobyte_has_modrm): Updated.
	(twobyte_uses_SSE_prefix): Likewise.
	(grps): Use PNI_Fixup in the "sidtQ" entry.
	(prefix_user_table): Add PREGRP27, PREGRP28, PREGRP29, PREGRP30,
	PREGRP31 and PREGRP32.
	(float_mem): Use "fisttp{l||l|}" in entry 1 in opcode 0xdb.
	Use "fisttpll" in entry 1 in opcode 0xdd.
	Use "fisttp" in entry 1 in opcode 0xdf.
@
text
@d51 47
a97 47
static int fetch_data PARAMS ((struct disassemble_info *, bfd_byte *));
static void ckprefix PARAMS ((void));
static const char *prefix_name PARAMS ((int, int));
static int print_insn PARAMS ((bfd_vma, disassemble_info *));
static void dofloat PARAMS ((int));
static void OP_ST PARAMS ((int, int));
static void OP_STi  PARAMS ((int, int));
static int putop PARAMS ((const char *, int));
static void oappend PARAMS ((const char *));
static void append_seg PARAMS ((void));
static void OP_indirE PARAMS ((int, int));
static void print_operand_value PARAMS ((char *, int, bfd_vma));
static void OP_E PARAMS ((int, int));
static void OP_G PARAMS ((int, int));
static bfd_vma get64 PARAMS ((void));
static bfd_signed_vma get32 PARAMS ((void));
static bfd_signed_vma get32s PARAMS ((void));
static int get16 PARAMS ((void));
static void set_op PARAMS ((bfd_vma, int));
static void OP_REG PARAMS ((int, int));
static void OP_IMREG PARAMS ((int, int));
static void OP_I PARAMS ((int, int));
static void OP_I64 PARAMS ((int, int));
static void OP_sI PARAMS ((int, int));
static void OP_J PARAMS ((int, int));
static void OP_SEG PARAMS ((int, int));
static void OP_DIR PARAMS ((int, int));
static void OP_OFF PARAMS ((int, int));
static void OP_OFF64 PARAMS ((int, int));
static void ptr_reg PARAMS ((int, int));
static void OP_ESreg PARAMS ((int, int));
static void OP_DSreg PARAMS ((int, int));
static void OP_C PARAMS ((int, int));
static void OP_D PARAMS ((int, int));
static void OP_T PARAMS ((int, int));
static void OP_Rd PARAMS ((int, int));
static void OP_MMX PARAMS ((int, int));
static void OP_XMM PARAMS ((int, int));
static void OP_EM PARAMS ((int, int));
static void OP_EX PARAMS ((int, int));
static void OP_MS PARAMS ((int, int));
static void OP_XS PARAMS ((int, int));
static void OP_3DNowSuffix PARAMS ((int, int));
static void OP_SIMD_Suffix PARAMS ((int, int));
static void SIMD_Fixup PARAMS ((int, int));
static void PNI_Fixup PARAMS ((int, int));
static void BadOp PARAMS ((void));
d164 1
a164 3
fetch_data (info, addr)
     struct disassemble_info *info;
     bfd_byte *addr;
d428 1
a428 1
typedef void (*op_rtn) PARAMS ((int bytemode, int sizeflag));
d1700 1
a1700 1
ckprefix ()
d1798 1
a1798 3
prefix_name (pref, sizeflag)
     int pref;
     int sizeflag;
d1892 1
a1892 3
print_insn_i386_att (pc, info)
     bfd_vma pc;
     disassemble_info *info;
d1900 1
a1900 3
print_insn_i386_intel (pc, info)
     bfd_vma pc;
     disassemble_info *info;
d1908 1
a1908 3
print_insn_i386 (pc, info)
     bfd_vma pc;
     disassemble_info *info;
d1916 1
a1916 3
print_insn (pc, info)
     bfd_vma pc;
     disassemble_info *info;
d2025 1
a2025 1
  info->private_data = (PTR) &priv;
d2546 1
a2546 2
dofloat (sizeflag)
     int sizeflag;
d2592 1
a2592 3
OP_ST (bytemode, sizeflag)
     int bytemode ATTRIBUTE_UNUSED;
     int sizeflag ATTRIBUTE_UNUSED;
d2598 1
a2598 3
OP_STi (bytemode, sizeflag)
     int bytemode ATTRIBUTE_UNUSED;
     int sizeflag ATTRIBUTE_UNUSED;
d2606 1
a2606 3
putop (template, sizeflag)
     const char *template;
     int sizeflag;
d2879 1
a2879 2
oappend (s)
     const char *s;
d2886 1
a2886 1
append_seg ()
d2921 1
a2921 3
OP_indirE (bytemode, sizeflag)
     int bytemode;
     int sizeflag;
d2929 1
a2929 4
print_operand_value (buf, hex, disp)
  char *buf;
  int hex;
  bfd_vma disp;
d2986 1
a2986 3
OP_E (bytemode, sizeflag)
     int bytemode;
     int sizeflag;
d3269 1
a3269 3
OP_G (bytemode, sizeflag)
     int bytemode;
     int sizeflag;
d3310 1
a3310 1
get64 ()
d3335 1
a3335 1
get32 ()
d3348 1
a3348 1
get32s ()
d3364 1
a3364 1
get16 ()
d3375 1
a3375 3
set_op (op, riprel)
     bfd_vma op;
     int riprel;
d3392 1
a3392 3
OP_REG (code, sizeflag)
     int code;
     int sizeflag;
d3452 1
a3452 3
OP_IMREG (code, sizeflag)
     int code;
     int sizeflag;
d3499 1
a3499 3
OP_I (bytemode, sizeflag)
     int bytemode;
     int sizeflag;
d3551 1
a3551 3
OP_I64 (bytemode, sizeflag)
     int bytemode;
     int sizeflag;
d3602 1
a3602 3
OP_sI (bytemode, sizeflag)
     int bytemode;
     int sizeflag;
d3651 1
a3651 3
OP_J (bytemode, sizeflag)
     int bytemode;
     int sizeflag;
d3687 1
a3687 3
OP_SEG (dummy, sizeflag)
     int dummy ATTRIBUTE_UNUSED;
     int sizeflag ATTRIBUTE_UNUSED;
d3693 1
a3693 3
OP_DIR (dummy, sizeflag)
     int dummy ATTRIBUTE_UNUSED;
     int sizeflag;
d3716 1
a3716 3
OP_OFF (bytemode, sizeflag)
     int bytemode ATTRIBUTE_UNUSED;
     int sizeflag;
d3741 1
a3741 3
OP_OFF64 (bytemode, sizeflag)
     int bytemode ATTRIBUTE_UNUSED;
     int sizeflag ATTRIBUTE_UNUSED;
d3769 1
a3769 3
ptr_reg (code, sizeflag)
     int code;
     int sizeflag;
d3797 1
a3797 3
OP_ESreg (code, sizeflag)
     int code;
     int sizeflag;
d3804 1
a3804 3
OP_DSreg (code, sizeflag)
     int code;
     int sizeflag;
d3819 1
a3819 3
OP_C (dummy, sizeflag)
     int dummy ATTRIBUTE_UNUSED;
     int sizeflag ATTRIBUTE_UNUSED;
d3830 1
a3830 3
OP_D (dummy, sizeflag)
     int dummy ATTRIBUTE_UNUSED;
     int sizeflag ATTRIBUTE_UNUSED;
d3844 1
a3844 3
OP_T (dummy, sizeflag)
     int dummy ATTRIBUTE_UNUSED;
     int sizeflag ATTRIBUTE_UNUSED;
d3851 1
a3851 3
OP_Rd (bytemode, sizeflag)
     int bytemode;
     int sizeflag;
d3860 1
a3860 3
OP_MMX (bytemode, sizeflag)
     int bytemode ATTRIBUTE_UNUSED;
     int sizeflag ATTRIBUTE_UNUSED;
d3875 1
a3875 3
OP_XMM (bytemode, sizeflag)
     int bytemode ATTRIBUTE_UNUSED;
     int sizeflag ATTRIBUTE_UNUSED;
d3886 1
a3886 3
OP_EM (bytemode, sizeflag)
     int bytemode;
     int sizeflag;
d3910 1
a3910 3
OP_EX (bytemode, sizeflag)
     int bytemode;
     int sizeflag;
d3930 1
a3930 3
OP_MS (bytemode, sizeflag)
     int bytemode;
     int sizeflag;
d3939 1
a3939 3
OP_XS (bytemode, sizeflag)
     int bytemode;
     int sizeflag;
d4015 1
a4015 3
OP_3DNowSuffix (bytemode, sizeflag)
     int bytemode ATTRIBUTE_UNUSED;
     int sizeflag ATTRIBUTE_UNUSED;
d4051 1
a4051 3
OP_SIMD_Suffix (bytemode, sizeflag)
     int bytemode ATTRIBUTE_UNUSED;
     int sizeflag ATTRIBUTE_UNUSED;
d4091 1
a4091 3
SIMD_Fixup (extrachar, sizeflag)
     int extrachar;
     int sizeflag ATTRIBUTE_UNUSED;
d4107 1
a4107 3
PNI_Fixup (extrachar, sizeflag)
     int extrachar ATTRIBUTE_UNUSED;
     int sizeflag ATTRIBUTE_UNUSED;
@


1.39
log
@	* i386-dis.c (print_insn): Test intel_syntax against (char) -1 in
	case char is unsigned.
@
text
@d96 1
d421 6
d786 1
a786 1
  { "movlpX",		XM, EX, SIMD_Fixup, 'h' }, /* really only 2 operands */
d790 1
a790 1
  { "movhpX",		XM, EX, SIMD_Fixup, 'l' },
d905 2
a906 2
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
d1000 1
a1000 1
  { "(bad)",		XX, XX, XX },
d1036 1
a1036 1
  { "(bad)",		XX, XX, XX },
d1088 1
a1088 1
  /* 70 */ 1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1, /* 7f */
d1094 1
a1094 1
  /* d0 */ 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* df */
d1096 1
a1096 1
  /* f0 */ 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0  /* ff */
d1105 1
a1105 1
  /* 10 */ 1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 1f */
d1111 1
a1111 1
  /* 70 */ 1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1, /* 7f */
d1117 1
a1117 1
  /* d0 */ 0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0, /* df */
d1119 1
a1119 1
  /* f0 */ 0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0  /* ff */
d1359 1
a1359 1
    { "sidtQ",	 M, XX, XX },
d1648 42
d2346 1
a2346 1
  "(bad)",
d2364 1
a2364 1
  "(bad)",
d2382 1
a2382 1
  "(bad)",
d4187 27
@


1.38
log
@	* i386-dis.c (dis386): Recognize icebp (0xf1).
@
text
@d1894 1
a1894 1
  if (intel_syntax == -1)
@


1.38.8.1
log
@2003-05-18  Mark Kettenis  <kettenis@@gnu.org>

	Merge from mainline.
	* i386-tdep.h (I386_SIZEOF_GREGS, I386_SIZEOF_FREGS,
	I386_SIZEOF_XREGS): Remove defenitions.
	(IS_FP_REGNUM, IS_SSE_REGNUM): Remove definitions.
	* i386-tdep.c (i386_gdbarch_init): Don't set register_bytes,
	register_size, call_dummy_words and sizeof_call_dummy.
	* i386-linux-tdep.c (i386_linux_init_abi): Don't set register_bytes.
	* x86-64-tdep.c (x86_64_init_abi): Don't set register_bytes and
	register_size.
	(x86_64_register_bytes): Remove variable.
	(_initialize_x86_64_tdep): Remove function.

	* i386-linux-tdep.c (i386_linux_sigcontext_addr): Call read_memory
	with correct arguments.
	* config/i386/x86-64linux.mt (TDEPFILES): Add i386-linux-tdep.o.
@
text
@d1894 1
a1894 1
  if (intel_syntax == (char) -1)
@


1.38.10.1
log
@	* i386-dis.c (print_insn): Test intel_syntax against (char) -1 in
	case char is unsigned.
@
text
@d1894 1
a1894 1
  if (intel_syntax == (char) -1)
@


1.37
log
@	* i386-dis.c (dq_mode, Edq): Define.
	(dis386_twobyte): Correct movd operands.
	(OP_E): Handle dq_mode case.
@
text
@d739 1
a739 1
  { "(bad)",		XX, XX, XX },
@


1.36
log
@2002-11-18  Klee Dienes  <kdienes@@apple.com>

	* arc.h (arc_ext_opcodes): Declare as extern.
	(arc_ext_operands): Declare as extern.
	* i860.h (i860_opcodes): Declare as const.

2002-11-18  Klee Dienes  <kdienes@@apple.com>

	* arc-opc.c (arc_ext_opcodes): Define.
	(arc_ext_operands): Define.
	* i386-dis.c (Suffix3DNow): Declare as const.
	* arm-opc.h (arm_opcodes): Declare as const.
	(thumb_opcodes): Declare as const.
	* h8500-opc.h (h8500_table): Declare as const.
	(h8500_table): Use a NULL for the opcode in the terminator, so
	that code testing (opcode->name) behaves correctly.
	* mcore-opc.h (mcore_table): Declare as const.
	* sh-opc.h (sh_table): Declare as const.
	* w65-opc.h (optable): Declare as const.
	* z8k-opc.h (z8k_table): Declare as const.
@
text
@d3 1
a3 2
   2001
   Free Software Foundation, Inc.
d178 3
a180 3
         print_insn_i386 will do something sensible.  Otherwise, print
         an error.  We do that here because this is where we know
         STATUS.  */
d195 1
d315 1
d882 1
a882 1
  { "movd",		MX, Ed, XX },
d1615 1
a1615 1
    { "movd", Ed, MX, XX },
d1617 1
a1617 1
    { "movd", Ed, XM, XX },
d1812 1
a1812 1
        return (sizeflag & AFLAG) ? "addr32" : "addr64";
d1814 1
a1814 1
        return ((sizeflag & AFLAG) && !mode_64bit) ? "addr16" : "addr32";
d2044 1
a2044 1
         first prefix, which is probably fwait itself.  */
d2277 1
a2277 1
  /*  d9 */
d2522 1
a2522 1
        OP_E (x_mode, sizeflag);
d2524 1
a2524 1
        OP_E (d_mode, sizeflag);
d2526 1
a2526 1
        OP_E (v_mode, sizeflag);
d2621 2
a2622 2
          if (intel_syntax)
            break;
d2627 2
a2628 2
          if (intel_syntax)
            break;
d2646 2
a2647 2
          if (intel_syntax)
            break;
d2658 2
a2659 2
          if (intel_syntax)
            break;
d2673 2
a2674 2
          if (intel_syntax)
            break;
d2692 2
a2693 2
          if (intel_syntax)
            break;
d2701 2
a2702 2
          if (intel_syntax)
            break;
d2721 2
a2722 2
          if (intel_syntax)
            break;
d2730 2
a2731 2
          if (intel_syntax)
            break;
d2749 1
a2749 1
          if (intel_syntax)
d2780 2
a2781 2
          if (intel_syntax)
            break;
d2801 1
a2801 1
          used_prefixes |= (prefixes & PREFIX_DATA);
d2804 2
a2805 2
          if (intel_syntax)
            break;
d2822 1
a2822 1
          if (intel_syntax)
d3004 1
d3008 1
a3008 1
	  else if (sizeflag & DFLAG)
d3081 2
a3082 2
        if (mod != 0 || (base & 7) == 5)
          {
d3084 1
a3084 1
            oappend (scratchbuf);
d3090 1
a3090 1
          }
d3094 17
a3110 17
          if (intel_syntax)
            {
              switch (bytemode)
                {
                case b_mode:
                  oappend ("BYTE PTR ");
                  break;
                case w_mode:
                  oappend ("WORD PTR ");
                  break;
                case v_mode:
                  oappend ("DWORD PTR ");
                  break;
                case d_mode:
                  oappend ("QWORD PTR ");
                  break;
                case m_mode:
d3116 7
a3122 7
                case x_mode:
                  oappend ("XWORD PTR ");
                  break;
                default:
                  break;
                }
             }
d3126 1
a3126 1
          *obufp = '\0';
d3137 8
a3144 8
                  if (intel_syntax)
                    {
                      if (havebase)
                        {
                          *obufp++ = separator_char;
                          *obufp = '\0';
                        }
                      sprintf (scratchbuf, "%s",
d3147 2
a3148 2
                    }
                  else
d3154 15
a3168 15
              if (!intel_syntax
                  || (intel_syntax
                      && bytemode != b_mode
                      && bytemode != w_mode
                      && bytemode != v_mode))
                {
                  *obufp++ = scale_char;
                  *obufp = '\0';
	          sprintf (scratchbuf, "%d", 1 << scale);
	          oappend (scratchbuf);
                }
	    }
          if (intel_syntax)
            if (mod != 0 || (base & 7) == 5)
              {
d3170 2
a3171 2
                if (disp != 0)
                  {
d3179 3
a3181 3
                    oappend (scratchbuf);
                  }
              }
d3184 1
a3184 1
          *obufp = '\0';
d3187 3
a3189 3
        {
          if (mod != 0 || (base & 7) == 5)
            {
d3199 3
a3201 3
              oappend (scratchbuf);
            }
        }
d3229 2
a3230 2
        if (mod != 0 || (rm & 7) == 6)
          {
d3232 2
a3233 2
            oappend (scratchbuf);
          }
d3238 1
a3238 1
          *obufp = '\0';
d3240 2
a3241 2
          *obufp++ = close_char;
          *obufp = '\0';
d3388 1
a3388 1
        s = "[dx]";
d3390 1
a3390 1
        s = "(%dx)";
d3446 1
a3446 1
        s = "[dx]";
d3448 1
a3448 1
        s = "(%dx)";
d3730 1
a3730 1
		        | PREFIX_ES | PREFIX_FS | PREFIX_GS)))
d3760 1
a3760 1
		        | PREFIX_ES | PREFIX_FS | PREFIX_GS)))
d3785 1
a3785 1
        s = names32[code - eAX_reg];
d3787 1
a3787 1
        s = names64[code - eAX_reg];
@


1.35
log
@	* i386-dis.c (prefix_name): Fix handling of 32bit address prefix
	in 64bit mode.
	(print_insn) Likewise.
	(putop): Fix handling of 'E'
	(OP_E, OP_OFF): handle 32bit addressing mode in 64bit.
	(ptr_reg): Likewise.
@
text
@d3973 1
a3973 1
static const char *Suffix3DNow[] = {
@


1.35.20.1
log
@Merge drow-cplus-branch to:
  cvs rtag -D 2003-12-14 00:00:00 UTC drow-cplus-merge-20031214 gdb+dejagnu
@
text
@d3 2
a4 1
   2001, 2002, 2003 Free Software Foundation, Inc.
d52 46
a97 47
static int fetch_data (struct disassemble_info *, bfd_byte *);
static void ckprefix (void);
static const char *prefix_name (int, int);
static int print_insn (bfd_vma, disassemble_info *);
static void dofloat (int);
static void OP_ST (int, int);
static void OP_STi (int, int);
static int putop (const char *, int);
static void oappend (const char *);
static void append_seg (void);
static void OP_indirE (int, int);
static void print_operand_value (char *, int, bfd_vma);
static void OP_E (int, int);
static void OP_G (int, int);
static bfd_vma get64 (void);
static bfd_signed_vma get32 (void);
static bfd_signed_vma get32s (void);
static int get16 (void);
static void set_op (bfd_vma, int);
static void OP_REG (int, int);
static void OP_IMREG (int, int);
static void OP_I (int, int);
static void OP_I64 (int, int);
static void OP_sI (int, int);
static void OP_J (int, int);
static void OP_SEG (int, int);
static void OP_DIR (int, int);
static void OP_OFF (int, int);
static void OP_OFF64 (int, int);
static void ptr_reg (int, int);
static void OP_ESreg (int, int);
static void OP_DSreg (int, int);
static void OP_C (int, int);
static void OP_D (int, int);
static void OP_T (int, int);
static void OP_Rd (int, int);
static void OP_MMX (int, int);
static void OP_XMM (int, int);
static void OP_EM (int, int);
static void OP_EX (int, int);
static void OP_MS (int, int);
static void OP_XS (int, int);
static void OP_3DNowSuffix (int, int);
static void OP_SIMD_Suffix (int, int);
static void SIMD_Fixup (int, int);
static void PNI_Fixup (int, int);
static void BadOp (void);
d164 3
a166 1
fetch_data (struct disassemble_info *info, bfd_byte *addr)
d179 3
a181 3
	 print_insn_i386 will do something sensible.  Otherwise, print
	 an error.  We do that here because this is where we know
	 STATUS.  */
a195 1
#define Edq OP_E, dq_mode
a314 1
#define dq_mode 10 /* operand size depends on REX prefixes.  */
a418 6
#define PREGRP27  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 27, NULL, 0
#define PREGRP28  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 28, NULL, 0
#define PREGRP29  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 29, NULL, 0
#define PREGRP30  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 30, NULL, 0
#define PREGRP31  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 31, NULL, 0
#define PREGRP32  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 32, NULL, 0
d422 1
a422 1
typedef void (*op_rtn) (int bytemode, int sizeflag);
d738 1
a738 1
  { "icebp",		XX, XX, XX },
d778 1
a778 1
  { PREGRP30 },
d782 1
a782 1
  { PREGRP31 },
d881 1
a881 1
  { "movd",		MX, Edq, XX },
d897 2
a898 2
  { PREGRP28 },
  { PREGRP29 },
d992 1
a992 1
  { PREGRP27 },
d1028 1
a1028 1
  { PREGRP32 },
d1080 1
a1080 1
  /* 70 */ 1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1, /* 7f */
d1086 1
a1086 1
  /* d0 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* df */
d1088 1
a1088 1
  /* f0 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0  /* ff */
d1097 1
a1097 1
  /* 10 */ 1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0, /* 1f */
d1103 1
a1103 1
  /* 70 */ 1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1, /* 7f */
d1109 1
a1109 1
  /* d0 */ 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0, /* df */
d1111 1
a1111 1
  /* f0 */ 1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0  /* ff */
d1351 1
a1351 1
    { "sidtQ", PNI_Fixup, 0, XX, XX },
d1614 1
a1614 1
    { "movd", Edq, MX, XX },
d1616 1
a1616 1
    { "movd", Edq, XM, XX },
a1639 42
  /* PREGRP27 */
  {
    { "(bad)", MX, EX, XX },
    { "(bad)", XM, EX, XX },
    { "addsubpd", XM, EX, XX },
    { "addsubps", XM, EX, XX },
  },
  /* PREGRP28 */
  {
    { "(bad)", MX, EX, XX },
    { "(bad)", XM, EX, XX },
    { "haddpd", XM, EX, XX },
    { "haddps", XM, EX, XX },
  },
  /* PREGRP29 */
  {
    { "(bad)", MX, EX, XX },
    { "(bad)", XM, EX, XX },
    { "hsubpd", XM, EX, XX },
    { "hsubps", XM, EX, XX },
  },
  /* PREGRP30 */
  {
    { "movlpX", XM, EX, SIMD_Fixup, 'h' }, /* really only 2 operands */
    { "movsldup", XM, EX, XX },
    { "movlpd", XM, EX, XX },
    { "movddup", XM, EX, XX },
  },
  /* PREGRP31 */
  {
    { "movhpX", XM, EX, SIMD_Fixup, 'l' },
    { "movshdup", XM, EX, XX },
    { "movhpd", XM, EX, XX },
    { "(bad)", XM, EX, XX },
  },
  /* PREGRP32 */
  {
    { "(bad)", XM, EX, XX },
    { "(bad)", XM, EX, XX },
    { "(bad)", XM, EX, XX },
    { "lddqu", XM, M, XX },
  },
d1652 1
a1652 1
ckprefix (void)
d1750 3
a1752 1
prefix_name (int pref, int sizeflag)
d1811 1
a1811 1
	return (sizeflag & AFLAG) ? "addr32" : "addr64";
d1813 1
a1813 1
	return ((sizeflag & AFLAG) && !mode_64bit) ? "addr16" : "addr32";
d1846 3
a1848 1
print_insn_i386_att (bfd_vma pc, disassemble_info *info)
d1856 3
a1858 1
print_insn_i386_intel (bfd_vma pc, disassemble_info *info)
d1866 3
a1868 1
print_insn_i386 (bfd_vma pc, disassemble_info *info)
d1876 3
a1878 1
print_insn (bfd_vma pc, disassemble_info *info)
d1893 1
a1893 1
  if (intel_syntax == (char) -1)
d1987 1
a1987 1
  info->private_data = &priv;
d2043 1
a2043 1
	 first prefix, which is probably fwait itself.  */
d2276 1
a2276 1
  /* d9 */
d2296 1
a2296 1
  "fisttp{l||l|}",
d2314 1
a2314 1
  "fisttpll",
d2332 1
a2332 1
  "fisttp",
d2508 2
a2509 1
dofloat (int sizeflag)
d2521 1
a2521 1
	OP_E (x_mode, sizeflag);
d2523 1
a2523 1
	OP_E (d_mode, sizeflag);
d2525 1
a2525 1
	OP_E (v_mode, sizeflag);
d2555 3
a2557 1
OP_ST (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d2563 3
a2565 1
OP_STi (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d2573 3
a2575 1
putop (const char *template, int sizeflag)
d2620 2
a2621 2
	  if (intel_syntax)
	    break;
d2626 2
a2627 2
	  if (intel_syntax)
	    break;
d2645 2
a2646 2
	  if (intel_syntax)
	    break;
d2657 2
a2658 2
	  if (intel_syntax)
	    break;
d2672 2
a2673 2
	  if (intel_syntax)
	    break;
d2691 2
a2692 2
	  if (intel_syntax)
	    break;
d2700 2
a2701 2
	  if (intel_syntax)
	    break;
d2720 2
a2721 2
	  if (intel_syntax)
	    break;
d2729 2
a2730 2
	  if (intel_syntax)
	    break;
d2748 1
a2748 1
	  if (intel_syntax)
d2779 2
a2780 2
	  if (intel_syntax)
	    break;
d2800 1
a2800 1
	  used_prefixes |= (prefixes & PREFIX_DATA);
d2803 2
a2804 2
	  if (intel_syntax)
	    break;
d2821 1
a2821 1
	  if (intel_syntax)
d2848 2
a2849 1
oappend (const char *s)
d2856 1
a2856 1
append_seg (void)
d2891 3
a2893 1
OP_indirE (int bytemode, int sizeflag)
d2901 4
a2904 1
print_operand_value (char *buf, int hex, bfd_vma disp)
d2961 3
a2963 1
OP_E (int bytemode, int sizeflag)
a3002 1
	case dq_mode:
d3006 1
a3006 1
	  else if ((sizeflag & DFLAG) || bytemode == dq_mode)
d3079 2
a3080 2
	if (mod != 0 || (base & 7) == 5)
	  {
d3082 1
a3082 1
	    oappend (scratchbuf);
d3088 1
a3088 1
	  }
d3092 17
a3108 17
	  if (intel_syntax)
	    {
	      switch (bytemode)
		{
		case b_mode:
		  oappend ("BYTE PTR ");
		  break;
		case w_mode:
		  oappend ("WORD PTR ");
		  break;
		case v_mode:
		  oappend ("DWORD PTR ");
		  break;
		case d_mode:
		  oappend ("QWORD PTR ");
		  break;
		case m_mode:
d3114 7
a3120 7
		case x_mode:
		  oappend ("XWORD PTR ");
		  break;
		default:
		  break;
		}
	     }
d3124 1
a3124 1
	  *obufp = '\0';
d3135 8
a3142 8
		  if (intel_syntax)
		    {
		      if (havebase)
			{
			  *obufp++ = separator_char;
			  *obufp = '\0';
			}
		      sprintf (scratchbuf, "%s",
d3145 2
a3146 2
		    }
		  else
d3152 11
a3162 11
	      if (!intel_syntax
		  || (intel_syntax
		      && bytemode != b_mode
		      && bytemode != w_mode
		      && bytemode != v_mode))
		{
		  *obufp++ = scale_char;
		  *obufp = '\0';
		  sprintf (scratchbuf, "%d", 1 << scale);
		  oappend (scratchbuf);
		}
d3164 3
a3166 3
	  if (intel_syntax)
	    if (mod != 0 || (base & 7) == 5)
	      {
d3168 2
a3169 2
		if (disp != 0)
		  {
d3177 3
a3179 3
		    oappend (scratchbuf);
		  }
	      }
d3182 1
a3182 1
	  *obufp = '\0';
d3185 3
a3187 3
	{
	  if (mod != 0 || (base & 7) == 5)
	    {
d3197 3
a3199 3
	      oappend (scratchbuf);
	    }
	}
d3227 2
a3228 2
	if (mod != 0 || (rm & 7) == 6)
	  {
d3230 2
a3231 2
	    oappend (scratchbuf);
	  }
d3236 1
a3236 1
	  *obufp = '\0';
d3238 2
a3239 2
	  *obufp++ = close_char;
	  *obufp = '\0';
d3245 3
a3247 1
OP_G (int bytemode, int sizeflag)
d3288 1
a3288 1
get64 (void)
d3313 1
a3313 1
get32 (void)
d3326 1
a3326 1
get32s (void)
d3342 1
a3342 1
get16 (void)
d3353 3
a3355 1
set_op (bfd_vma op, int riprel)
d3372 3
a3374 1
OP_REG (int code, int sizeflag)
d3386 1
a3386 1
	s = "[dx]";
d3388 1
a3388 1
	s = "(%dx)";
d3434 3
a3436 1
OP_IMREG (int code, int sizeflag)
d3444 1
a3444 1
	s = "[dx]";
d3446 1
a3446 1
	s = "(%dx)";
d3483 3
a3485 1
OP_I (int bytemode, int sizeflag)
d3537 3
a3539 1
OP_I64 (int bytemode, int sizeflag)
d3590 3
a3592 1
OP_sI (int bytemode, int sizeflag)
d3641 3
a3643 1
OP_J (int bytemode, int sizeflag)
d3679 3
a3681 1
OP_SEG (int dummy ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3687 3
a3689 1
OP_DIR (int dummy ATTRIBUTE_UNUSED, int sizeflag)
d3712 3
a3714 1
OP_OFF (int bytemode ATTRIBUTE_UNUSED, int sizeflag)
d3728 1
a3728 1
			| PREFIX_ES | PREFIX_FS | PREFIX_GS)))
d3739 3
a3741 1
OP_OFF64 (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3758 1
a3758 1
			| PREFIX_ES | PREFIX_FS | PREFIX_GS)))
d3769 3
a3771 1
ptr_reg (int code, int sizeflag)
d3783 1
a3783 1
	s = names32[code - eAX_reg];
d3785 1
a3785 1
	s = names64[code - eAX_reg];
d3799 3
a3801 1
OP_ESreg (int code, int sizeflag)
d3808 3
a3810 1
OP_DSreg (int code, int sizeflag)
d3825 3
a3827 1
OP_C (int dummy ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3838 3
a3840 1
OP_D (int dummy ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3854 3
a3856 1
OP_T (int dummy ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3863 3
a3865 1
OP_Rd (int bytemode, int sizeflag)
d3874 3
a3876 1
OP_MMX (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3891 3
a3893 1
OP_XMM (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3904 3
a3906 1
OP_EM (int bytemode, int sizeflag)
d3930 3
a3932 1
OP_EX (int bytemode, int sizeflag)
d3952 3
a3954 1
OP_MS (int bytemode, int sizeflag)
d3963 3
a3965 1
OP_XS (int bytemode, int sizeflag)
d3973 1
a3973 1
static const char *const Suffix3DNow[] = {
d4041 3
a4043 1
OP_3DNowSuffix (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d4079 3
a4081 1
OP_SIMD_Suffix (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d4121 3
a4123 1
SIMD_Fixup (int extrachar, int sizeflag ATTRIBUTE_UNUSED)
a4135 25
}

static void
PNI_Fixup (int extrachar ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
{
  if (mod == 3 && reg == 1)
    {
      char *p = obuf + strlen (obuf);

      /* Override "sidt".  */
      if (rm)
	{
	  /* mwait %eax,%ecx  */
	  strcpy (p - 4, "mwait   %eax,%ecx");
	}
      else
	{
	  /* monitor %eax,%ecx,%edx"  */
	  strcpy (p - 4, "monitor %eax,%ecx,%edx");
	}

      codep++;
    }
  else
    OP_E (0, sizeflag);
@


1.35.20.2
log
@Merge drow-cplus-merge-20040208 to drow-cplus-branch.
@
text
@d3176 5
a3180 1
	      if (scale != 0 || (!intel_syntax && index != 4))
@


1.35.18.1
log
@2002-12-23  David Carlton  <carlton@@math.stanford.edu>

	* Merge from mainline; tag is carlton_dictionary-20021223-merge.
@
text
@d3973 1
a3973 1
static const char *const Suffix3DNow[] = {
@


1.35.18.2
log
@2003-02-07  David Carlton  <carlton@@math.stanford.edu>

	* Merge with mainline; tag is carlton_dictionary-20030207-merge.
@
text
@d3 2
a4 1
   2001, 2002, 2003 Free Software Foundation, Inc.
d179 3
a181 3
	 print_insn_i386 will do something sensible.  Otherwise, print
	 an error.  We do that here because this is where we know
	 STATUS.  */
a195 1
#define Edq OP_E, dq_mode
a314 1
#define dq_mode 10 /* operand size depends on REX prefixes.  */
d881 1
a881 1
  { "movd",		MX, Edq, XX },
d1614 1
a1614 1
    { "movd", Edq, MX, XX },
d1616 1
a1616 1
    { "movd", Edq, XM, XX },
d1811 1
a1811 1
	return (sizeflag & AFLAG) ? "addr32" : "addr64";
d1813 1
a1813 1
	return ((sizeflag & AFLAG) && !mode_64bit) ? "addr16" : "addr32";
d2043 1
a2043 1
	 first prefix, which is probably fwait itself.  */
d2276 1
a2276 1
  /* d9 */
d2521 1
a2521 1
	OP_E (x_mode, sizeflag);
d2523 1
a2523 1
	OP_E (d_mode, sizeflag);
d2525 1
a2525 1
	OP_E (v_mode, sizeflag);
d2620 2
a2621 2
	  if (intel_syntax)
	    break;
d2626 2
a2627 2
	  if (intel_syntax)
	    break;
d2645 2
a2646 2
	  if (intel_syntax)
	    break;
d2657 2
a2658 2
	  if (intel_syntax)
	    break;
d2672 2
a2673 2
	  if (intel_syntax)
	    break;
d2691 2
a2692 2
	  if (intel_syntax)
	    break;
d2700 2
a2701 2
	  if (intel_syntax)
	    break;
d2720 2
a2721 2
	  if (intel_syntax)
	    break;
d2729 2
a2730 2
	  if (intel_syntax)
	    break;
d2748 1
a2748 1
	  if (intel_syntax)
d2779 2
a2780 2
	  if (intel_syntax)
	    break;
d2800 1
a2800 1
	  used_prefixes |= (prefixes & PREFIX_DATA);
d2803 2
a2804 2
	  if (intel_syntax)
	    break;
d2821 1
a2821 1
	  if (intel_syntax)
a3002 1
	case dq_mode:
d3006 1
a3006 1
	  else if ((sizeflag & DFLAG) || bytemode == dq_mode)
d3079 2
a3080 2
	if (mod != 0 || (base & 7) == 5)
	  {
d3082 1
a3082 1
	    oappend (scratchbuf);
d3088 1
a3088 1
	  }
d3092 17
a3108 17
	  if (intel_syntax)
	    {
	      switch (bytemode)
		{
		case b_mode:
		  oappend ("BYTE PTR ");
		  break;
		case w_mode:
		  oappend ("WORD PTR ");
		  break;
		case v_mode:
		  oappend ("DWORD PTR ");
		  break;
		case d_mode:
		  oappend ("QWORD PTR ");
		  break;
		case m_mode:
d3114 7
a3120 7
		case x_mode:
		  oappend ("XWORD PTR ");
		  break;
		default:
		  break;
		}
	     }
d3124 1
a3124 1
	  *obufp = '\0';
d3135 8
a3142 8
		  if (intel_syntax)
		    {
		      if (havebase)
			{
			  *obufp++ = separator_char;
			  *obufp = '\0';
			}
		      sprintf (scratchbuf, "%s",
d3145 2
a3146 2
		    }
		  else
d3152 15
a3166 15
	      if (!intel_syntax
		  || (intel_syntax
		      && bytemode != b_mode
		      && bytemode != w_mode
		      && bytemode != v_mode))
		{
		  *obufp++ = scale_char;
		  *obufp = '\0';
		  sprintf (scratchbuf, "%d", 1 << scale);
		  oappend (scratchbuf);
		}
	    }
	  if (intel_syntax)
	    if (mod != 0 || (base & 7) == 5)
	      {
d3168 2
a3169 2
		if (disp != 0)
		  {
d3177 3
a3179 3
		    oappend (scratchbuf);
		  }
	      }
d3182 1
a3182 1
	  *obufp = '\0';
d3185 3
a3187 3
	{
	  if (mod != 0 || (base & 7) == 5)
	    {
d3197 3
a3199 3
	      oappend (scratchbuf);
	    }
	}
d3227 2
a3228 2
	if (mod != 0 || (rm & 7) == 6)
	  {
d3230 2
a3231 2
	    oappend (scratchbuf);
	  }
d3236 1
a3236 1
	  *obufp = '\0';
d3238 2
a3239 2
	  *obufp++ = close_char;
	  *obufp = '\0';
d3386 1
a3386 1
	s = "[dx]";
d3388 1
a3388 1
	s = "(%dx)";
d3444 1
a3444 1
	s = "[dx]";
d3446 1
a3446 1
	s = "(%dx)";
d3728 1
a3728 1
			| PREFIX_ES | PREFIX_FS | PREFIX_GS)))
d3758 1
a3758 1
			| PREFIX_ES | PREFIX_FS | PREFIX_GS)))
d3783 1
a3783 1
	s = names32[code - eAX_reg];
d3785 1
a3785 1
	s = names64[code - eAX_reg];
@


1.35.18.3
log
@2003-04-16  David Carlton  <carlton@@bactrian.org>

	* Merge with mainline; tag is carlton_dictionary-20030416-merge.
@
text
@d739 1
a739 1
  { "icebp",		XX, XX, XX },
@


1.35.18.4
log
@2003-05-23  David Carlton  <carlton@@bactrian.org>

	* Merge with mainline; tag is carlton_dictionary-20030523-merge.
@
text
@d1894 1
a1894 1
  if (intel_syntax == (char) -1)
@


1.35.18.5
log
@2003-06-27  David Carlton  <carlton@@kealia.com>

	* Merge with mainline; tag is carlton_dictionary-20030627-merge.
@
text
@a95 1
static void PNI_Fixup PARAMS ((int, int));
a419 6
#define PREGRP27  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 27, NULL, 0
#define PREGRP28  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 28, NULL, 0
#define PREGRP29  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 29, NULL, 0
#define PREGRP30  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 30, NULL, 0
#define PREGRP31  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 31, NULL, 0
#define PREGRP32  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 32, NULL, 0
d779 1
a779 1
  { PREGRP30 },
d783 1
a783 1
  { PREGRP31 },
d898 2
a899 2
  { PREGRP28 },
  { PREGRP29 },
d993 1
a993 1
  { PREGRP27 },
d1029 1
a1029 1
  { PREGRP32 },
d1081 1
a1081 1
  /* 70 */ 1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1, /* 7f */
d1087 1
a1087 1
  /* d0 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* df */
d1089 1
a1089 1
  /* f0 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0  /* ff */
d1098 1
a1098 1
  /* 10 */ 1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0, /* 1f */
d1104 1
a1104 1
  /* 70 */ 1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1, /* 7f */
d1110 1
a1110 1
  /* d0 */ 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0, /* df */
d1112 1
a1112 1
  /* f0 */ 1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0  /* ff */
d1352 1
a1352 1
    { "sidtQ", PNI_Fixup, 0, XX, XX },
a1640 42
  /* PREGRP27 */
  {
    { "(bad)", MX, EX, XX },
    { "(bad)", XM, EX, XX },
    { "addsubpd", XM, EX, XX },
    { "addsubps", XM, EX, XX },
  },
  /* PREGRP28 */
  {
    { "(bad)", MX, EX, XX },
    { "(bad)", XM, EX, XX },
    { "haddpd", XM, EX, XX },
    { "haddps", XM, EX, XX },
  },
  /* PREGRP29 */
  {
    { "(bad)", MX, EX, XX },
    { "(bad)", XM, EX, XX },
    { "hsubpd", XM, EX, XX },
    { "hsubps", XM, EX, XX },
  },
  /* PREGRP30 */
  {
    { "movlpX", XM, EX, SIMD_Fixup, 'h' }, /* really only 2 operands */
    { "movsldup", XM, EX, XX },
    { "movlpd", XM, EX, XX },
    { "movddup", XM, EX, XX },
  },
  /* PREGRP31 */
  {
    { "movhpX", XM, EX, SIMD_Fixup, 'l' },
    { "movshdup", XM, EX, XX },
    { "movhpd", XM, EX, XX },
    { "(bad)", XM, EX, XX },
  },
  /* PREGRP32 */
  {
    { "(bad)", XM, EX, XX },
    { "(bad)", XM, EX, XX },
    { "(bad)", XM, EX, XX },
    { "lddqu", XM, M, XX },
  },
d2297 1
a2297 1
  "fisttp{l||l|}",
d2315 1
a2315 1
  "fisttpll",
d2333 1
a2333 1
  "fisttp",
a4137 27
}

static void
PNI_Fixup (extrachar, sizeflag)
     int extrachar ATTRIBUTE_UNUSED;
     int sizeflag ATTRIBUTE_UNUSED;
{
  if (mod == 3 && reg == 1)
    {
      char *p = obuf + strlen (obuf);

      /* Override "sidt".  */
      if (rm)
	{
	  /* mwait %eax,%ecx  */
	  strcpy (p - 4, "mwait   %eax,%ecx");
	}
      else
	{
	  /* monitor %eax,%ecx,%edx"  */
	  strcpy (p - 4, "monitor %eax,%ecx,%edx");
	}

      codep++;
    }
  else
    OP_E (0, sizeflag);
@


1.35.18.6
log
@2003-09-17  David Carlton  <carlton@@kealia.com>

	* Merge with mainline; tag is carlton_dictionary-20030917-merge.
@
text
@d51 47
a97 47
static int fetch_data (struct disassemble_info *, bfd_byte *);
static void ckprefix (void);
static const char *prefix_name (int, int);
static int print_insn (bfd_vma, disassemble_info *);
static void dofloat (int);
static void OP_ST (int, int);
static void OP_STi (int, int);
static int putop (const char *, int);
static void oappend (const char *);
static void append_seg (void);
static void OP_indirE (int, int);
static void print_operand_value (char *, int, bfd_vma);
static void OP_E (int, int);
static void OP_G (int, int);
static bfd_vma get64 (void);
static bfd_signed_vma get32 (void);
static bfd_signed_vma get32s (void);
static int get16 (void);
static void set_op (bfd_vma, int);
static void OP_REG (int, int);
static void OP_IMREG (int, int);
static void OP_I (int, int);
static void OP_I64 (int, int);
static void OP_sI (int, int);
static void OP_J (int, int);
static void OP_SEG (int, int);
static void OP_DIR (int, int);
static void OP_OFF (int, int);
static void OP_OFF64 (int, int);
static void ptr_reg (int, int);
static void OP_ESreg (int, int);
static void OP_DSreg (int, int);
static void OP_C (int, int);
static void OP_D (int, int);
static void OP_T (int, int);
static void OP_Rd (int, int);
static void OP_MMX (int, int);
static void OP_XMM (int, int);
static void OP_EM (int, int);
static void OP_EX (int, int);
static void OP_MS (int, int);
static void OP_XS (int, int);
static void OP_3DNowSuffix (int, int);
static void OP_SIMD_Suffix (int, int);
static void SIMD_Fixup (int, int);
static void PNI_Fixup (int, int);
static void BadOp (void);
d164 3
a166 1
fetch_data (struct disassemble_info *info, bfd_byte *addr)
d430 1
a430 1
typedef void (*op_rtn) (int bytemode, int sizeflag);
d1702 1
a1702 1
ckprefix (void)
d1800 3
a1802 1
prefix_name (int pref, int sizeflag)
d1896 3
a1898 1
print_insn_i386_att (bfd_vma pc, disassemble_info *info)
d1906 3
a1908 1
print_insn_i386_intel (bfd_vma pc, disassemble_info *info)
d1916 3
a1918 1
print_insn_i386 (bfd_vma pc, disassemble_info *info)
d1926 3
a1928 1
print_insn (bfd_vma pc, disassemble_info *info)
d2037 1
a2037 1
  info->private_data = &priv;
d2558 2
a2559 1
dofloat (int sizeflag)
d2605 3
a2607 1
OP_ST (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d2613 3
a2615 1
OP_STi (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d2623 3
a2625 1
putop (const char *template, int sizeflag)
d2898 2
a2899 1
oappend (const char *s)
d2906 1
a2906 1
append_seg (void)
d2941 3
a2943 1
OP_indirE (int bytemode, int sizeflag)
d2951 4
a2954 1
print_operand_value (char *buf, int hex, bfd_vma disp)
d3011 3
a3013 1
OP_E (int bytemode, int sizeflag)
d3296 3
a3298 1
OP_G (int bytemode, int sizeflag)
d3339 1
a3339 1
get64 (void)
d3364 1
a3364 1
get32 (void)
d3377 1
a3377 1
get32s (void)
d3393 1
a3393 1
get16 (void)
d3404 3
a3406 1
set_op (bfd_vma op, int riprel)
d3423 3
a3425 1
OP_REG (int code, int sizeflag)
d3485 3
a3487 1
OP_IMREG (int code, int sizeflag)
d3534 3
a3536 1
OP_I (int bytemode, int sizeflag)
d3588 3
a3590 1
OP_I64 (int bytemode, int sizeflag)
d3641 3
a3643 1
OP_sI (int bytemode, int sizeflag)
d3692 3
a3694 1
OP_J (int bytemode, int sizeflag)
d3730 3
a3732 1
OP_SEG (int dummy ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3738 3
a3740 1
OP_DIR (int dummy ATTRIBUTE_UNUSED, int sizeflag)
d3763 3
a3765 1
OP_OFF (int bytemode ATTRIBUTE_UNUSED, int sizeflag)
d3790 3
a3792 1
OP_OFF64 (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3820 3
a3822 1
ptr_reg (int code, int sizeflag)
d3850 3
a3852 1
OP_ESreg (int code, int sizeflag)
d3859 3
a3861 1
OP_DSreg (int code, int sizeflag)
d3876 3
a3878 1
OP_C (int dummy ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3889 3
a3891 1
OP_D (int dummy ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3905 3
a3907 1
OP_T (int dummy ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3914 3
a3916 1
OP_Rd (int bytemode, int sizeflag)
d3925 3
a3927 1
OP_MMX (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3942 3
a3944 1
OP_XMM (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d3955 3
a3957 1
OP_EM (int bytemode, int sizeflag)
d3981 3
a3983 1
OP_EX (int bytemode, int sizeflag)
d4003 3
a4005 1
OP_MS (int bytemode, int sizeflag)
d4014 3
a4016 1
OP_XS (int bytemode, int sizeflag)
d4092 3
a4094 1
OP_3DNowSuffix (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d4130 3
a4132 1
OP_SIMD_Suffix (int bytemode ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
d4172 3
a4174 1
SIMD_Fixup (int extrachar, int sizeflag ATTRIBUTE_UNUSED)
d4190 3
a4192 1
PNI_Fixup (int extrachar ATTRIBUTE_UNUSED, int sizeflag ATTRIBUTE_UNUSED)
@


1.35.18.7
log
@2004-01-26  David Carlton  <carlton@@kealia.com>

	* Merge with mainline; tag is carlton_dictionary-20040126-merge.
@
text
@d3176 5
a3180 1
	      if (scale != 0 || (!intel_syntax && index != 4))
@


1.34
log
@	* i386-dis.c (print_insn): Use x86-64 as option.
@
text
@d1810 4
a1813 1
      return (sizeflag & AFLAG) ? "addr16" : "addr32";
d2087 1
a2087 1
	  if (sizeflag & AFLAG)
d2632 10
a2641 2
	  if (sizeflag & AFLAG)
	    *obufp++ = 'e';
d2650 1
a2650 1
		*obufp++ = 'l';
d2652 1
a2652 1
		*obufp++ = 'w';
d3028 1
a3028 1
  if (sizeflag & AFLAG) /* 32 bit address mode */
d3062 1
a3062 1
	      if (mode_64bit && !havesib)
d3129 2
a3130 1
	    oappend (mode_64bit ? names64[base] : names32[base]);
d3143 2
a3144 1
			       mode_64bit ? names64[index] : names32[index]);
d3148 2
a3149 1
			     mode_64bit ? names64[index] : names32[index]);
d3720 1
a3720 1
  if (sizeflag & AFLAG)
d3781 6
a3786 1
    s = names64[code - eAX_reg];
@


1.34.2.1
log
@	* i386-dis.c (prefix_name): Fix handling of 32bit address prefix
	in 64bit mode.
	(print_insn) Likewise.
	(putop): Fix handling of 'E'
	(OP_E, OP_OFF): handle 32bit addressing mode in 64bit.
	(ptr_reg): Likewise.
@
text
@d1810 1
a1810 4
      if (mode_64bit)
        return (sizeflag & AFLAG) ? "addr32" : "addr64";
      else
        return ((sizeflag & AFLAG) && !mode_64bit) ? "addr16" : "addr32";
d2084 1
a2084 1
	  if ((sizeflag & AFLAG) || mode_64bit)
d2629 2
a2630 10
	  if (mode_64bit)
	    {
	      if (sizeflag & AFLAG)
		*obufp++ = 'r';
	      else
		*obufp++ = 'e';
	    }
	  else
	    if (sizeflag & AFLAG)
	      *obufp++ = 'e';
d2639 1
a2639 1
		*obufp++ = mode_64bit ? 'q' : 'l';
d2641 1
a2641 1
		*obufp++ = mode_64bit ? 'l' : 'w';
d3017 1
a3017 1
  if ((sizeflag & AFLAG) || mode_64bit) /* 32 bit address mode */
d3051 1
a3051 1
	      if (mode_64bit && !havesib && (sizeflag & AFLAG))
d3118 1
a3118 2
	    oappend (mode_64bit && (sizeflag & AFLAG)
		     ? names64[base] : names32[base]);
d3131 1
a3131 2
			       mode_64bit && (sizeflag & AFLAG)
			       ? names64[index] : names32[index]);
d3135 1
a3135 2
			     mode_64bit && (sizeflag & AFLAG)
			     ? names64[index] : names32[index]);
d3706 1
a3706 1
  if ((sizeflag & AFLAG) || mode_64bit)
d3767 1
a3767 6
    {
      if (!(sizeflag & AFLAG))
        s = names32[code - eAX_reg];
      else
        s = names64[code - eAX_reg];
    }
@


1.33
log
@binutils/ChangeLog
	* doc/binutils.texi (objdump): Document x86 -M options.
include/ChangeLog
 	* dis-asm.h (print_insn_i386): Declare.
opcodes/ChangeLog
	* disassemble.c (disassembler): Call print_insn_i386.
	* i386-dis.c (SUFFIX_ALWAYS): Define.
	(struct dis_private): Add orig_sizeflag.
	(print_insn_i386): Make it a wrapper, calling..
	(print_insn): ..The old body of print_insn_i386.  Avoid longjmp
	warning without using volatile by moving orig_sizeflag to priv,
	and removing inbuf.  Parse disassembler_options.
	(print_insn_i386_att, print_insn_i386_intel): Move initialisation
	code to print_insn.
	(putop): Remove #ifdef SUFFIX_ALWAYS.
@
text
@d1906 1
a1906 1
      if (strncmp (p, "x86_64", 6) == 0)
@


1.32
log
@	* i386.h (i386_optab): Add entries for "sldr", "smsw" and "str" to
	accept WordReg.
	* i386-dis.c (grps): Change "sldt", "str", and "smsw" entries
	to "sldtQ", "strQ", "smswQ" respectively; all with Ev operand
	category instead of Ew.
@
text
@d55 1
a55 1
static int print_insn_i386 PARAMS ((bfd_vma, disassemble_info *));
d104 1
a301 1
#if 0 /* Leave undefined until someone adds the extra flag to objdump.  */
a302 1
#endif
d444 3
a446 3
                              or suffix_always is true
	  print 'q' if rex prefix is present.
   'Q' => print 'w', 'l' or 'q' if no register operands or suffix_always is true
d1839 3
a1847 11
  names64 = att_names64;
  names32 = att_names32;
  names16 = att_names16;
  names8 = att_names8;
  names8rex = att_names8rex;
  names_seg = att_names_seg;
  index16 = att_index16;
  open_char = '(';
  close_char =  ')';
  separator_char = ',';
  scale_char = ',';
d1849 1
a1849 1
  return print_insn_i386 (pc, info);
a1857 11
  names64 = intel_names64;
  names32 = intel_names32;
  names16 = intel_names16;
  names8 = intel_names8;
  names8rex = intel_names8rex;
  names_seg = intel_names_seg;
  index16 = intel_index16;
  open_char = '[';
  close_char = ']';
  separator_char = '+';
  scale_char = '*';
d1859 11
a1869 1
  return print_insn_i386 (pc, info);
d1873 1
a1873 1
print_insn_i386 (pc, info)
d1883 2
a1884 3
  VOLATILE int sizeflag;
  VOLATILE int orig_sizeflag;

a1885 1
  bfd_byte *inbuf = priv.the_buffer;
d1890 4
d1898 1
a1898 1
    sizeflag = AFLAG | DFLAG;
d1900 1
a1900 1
    sizeflag = 0;
d1903 76
a1978 1
  orig_sizeflag = sizeflag;
d1997 2
a1998 2
  start_codep = inbuf;
  codep = inbuf;
d2005 3
a2007 3
         means we have an incomplete instruction of some sort.  Just
         print the first byte as a prefix or a .byte pseudo-op.  */
      if (codep > inbuf)
d2009 1
a2009 1
	  name = prefix_name (inbuf[0], orig_sizeflag);
d2016 1
a2016 1
				     (unsigned int) inbuf[0]);
d2029 1
d2041 1
a2041 1
      name = prefix_name (inbuf[0], orig_sizeflag);
d2187 1
a2187 1
      name = prefix_name (inbuf[0], orig_sizeflag);
d2196 1
a2196 1
      name = prefix_name (rex | 0x40, orig_sizeflag);
d2260 1
a2260 1
  return codep - inbuf;
d2619 1
a2619 5
	  if (mod != 3
#ifdef SUFFIX_ALWAYS
	      || (sizeflag & SUFFIX_ALWAYS)
#endif
	      )
a2624 1
#ifdef SUFFIX_ALWAYS
a2626 1
#endif
d2636 1
a2636 5
	  if ((prefixes & PREFIX_ADDR)
#ifdef SUFFIX_ALWAYS
	      || (sizeflag & SUFFIX_ALWAYS)
#endif
	      )
a2662 1
#ifdef SUFFIX_ALWAYS
a2664 1
#endif
d2693 1
a2693 4
#ifdef SUFFIX_ALWAYS
	      || (sizeflag & SUFFIX_ALWAYS)
#endif
	      )
d2721 1
a2721 5
	  if (mod != 3
#ifdef SUFFIX_ALWAYS
	      || (sizeflag & SUFFIX_ALWAYS)
#endif
	      )
a2769 1
#ifdef SUFFIX_ALWAYS
a2782 1
#endif
@


1.31
log
@	* i386-dis.c (grps): Don't print the implicit al/ax/eax register
	for opcode 0xf6 or 0xf7 forms of mul, imul, div, idiv insns.
@
text
@d1340 2
a1341 2
    { "sldt",	Ew, XX, XX },
    { "str",	Ew, XX, XX },
d1355 1
a1355 1
    { "smsw",	Ew, XX, XX },
@


1.30
log
@	* i386-dis.c: Fix formatting.
@
text
@d1300 4
a1303 4
    { "mulB",	AL, Eb, XX },
    { "imulB",	AL, Eb, XX },
    { "divB",	AL, Eb, XX },
    { "idivB",	AL, Eb, XX }
d1311 4
a1314 4
    { "mulS",	eAX, Ev, XX },
    { "imulS",	eAX, Ev, XX },
    { "divS",	eAX, Ev, XX },
    { "idivS",	eAX, Ev, XX },
@


1.29
log
@	* i386-dis.c: Change formatting conventions for architecture
	i386:intel to better match the format of various intel i386
	assemblers, like nasm, tasm or masm.
@
text
@d99 1
a99 2
struct dis_private
{
d159 1
a159 1
  ((addr) <= ((struct dis_private *)(info->private_data))->max_fetched \
d168 1
a168 1
  struct dis_private *priv = (struct dis_private *)info->private_data;
d301 1
a301 1
#if 0 /* leave undefined until someone adds the extra flag to objdump */
d775 1
a775 1
  { "",			MX, EM, OPSUF }, /* See OP_3DNowSuffix */
d1425 1
a1425 1
    /* FIXME: the sfence with memory operand is clflush! */
a1448 1

d1461 1
a1461 1
    { "", XM, EX, OPSIMD },	/* See OP_SIMD_SUFFIX */
a1823 1

d1906 1
a1906 1
    sizeflag = AFLAG|DFLAG;
d2097 1
a2097 1
	    (*dp->op1)(dp->bytemode1, sizeflag);
d2102 1
a2102 1
	    (*dp->op2)(dp->bytemode2, sizeflag);
d2107 1
a2107 1
	    (*dp->op3)(dp->bytemode3, sizeflag);
a2387 1

d2447 1
a2447 1
      putop (float_mem[(floatop - 0xd8 ) * 8 + reg], sizeflag);
d2457 1
a2457 1
  /* skip mod/rm byte */
d2466 1
a2466 1
      /* instruction fnstsw is only one with strange arg */
d2476 1
a2476 1
	(*dp->op1)(dp->bytemode1, sizeflag);
d2479 1
a2479 1
	(*dp->op2)(dp->bytemode2, sizeflag);
d2500 1
a2500 1
/* capital letters in template are macros */
d2631 1
a2631 1
	  /* Fall through */
d2663 1
a2663 1
	  /* Fall through */
d2857 1
a2857 1
	  for (i = 0; tmp[i] == '0' && tmp[i+1]; i++);
d2869 1
a2869 1
	      /* Check for possible overflow on 0x8000000000000000 */
d2886 1
a2886 1
	      tmp[28-i] = (v % 10) + '0';
d2914 1
a2914 1
  /* skip mod/rm byte */
d2955 1
a2955 1
	  if ( !(codep[-2] == 0xAE && codep[-1] == 0xF8 /* sfence */)
d2958 1
a2958 1
	    BadOp();	/* bad sfence,lea,lds,les,lfs,lgs,lss modrm */
d3106 1
a3106 1
                /* Don't print zero displacements */
d3245 1
a3245 1
  abort();
d3353 1
a3353 1
      /* Fall through */
d3442 1
a3442 1
      /* Fall through */
d3557 1
a3557 1
	  op = get16();
d3601 1
a3601 1
	  /* for some reason, a data16 prefix on a jump instruction
d3692 1
a3692 1
  off = get64();
d3713 1
a3713 1
  if(intel_syntax)
d3726 1
a3726 1
  if(intel_syntax)
d3754 1
a3754 1
  append_seg();
d3781 1
a3781 1
    sprintf (scratchbuf, "db%d", reg+add);
d3783 1
a3783 1
    sprintf (scratchbuf, "%%db%d", reg+add);
d3804 1
a3804 1
    BadOp();
d3852 1
a3852 1
  /* skip mod/rm byte */
d3878 1
a3878 1
  /* skip mod/rm byte */
d3893 1
a3893 1
    BadOp();
d3904 1
a3904 1
    BadOp();
d3985 1
a3985 1
  obufp = obuf + strlen(obuf);
d3997 1
a3997 1
      BadOp();
d4001 1
a4001 2

static const char *simd_cmp_op [] = {
d4020 1
a4020 1
  obufp = obuf + strlen(obuf);
d4050 1
a4050 1
      BadOp();
d4063 6
a4068 6
      char *p = obuf + strlen(obuf);
      *(p+1) = '\0';
      *p     = *(p-1);
      *(p-1) = *(p-2);
      *(p-2) = *(p-3);
      *(p-3) = extrachar;
d4072 2
a4073 1
static void BadOp (void)
d4075 2
a4076 1
  codep = insn_codep + 1;	/* throw away prefixes and 1st. opcode byte */
@


1.28
log
@	* i386-dis.c (grps): Print l or w suffix, and require mem modrm
	for lgdt, lidt, sgdt, sidt.
@
text
@d1135 36
a1170 2
static const char *names64[] = {
  "%rax","%rcx","%rdx","%rbx", "%rsp","%rbp","%rsi","%rdi",
d1173 2
a1174 2
static const char *names32[] = {
  "%eax","%ecx","%edx","%ebx", "%esp","%ebp","%esi","%edi",
d1177 2
a1178 2
static const char *names16[] = {
  "%ax","%cx","%dx","%bx","%sp","%bp","%si","%di",
d1181 2
a1182 2
static const char *names8[] = {
  "%al","%cl","%dl","%bl","%ah","%ch","%dh","%bh",
d1184 2
a1185 2
static const char *names8rex[] = {
  "%al","%cl","%dl","%bl","%spl", "%bpl", "%sil", "%dil",
d1188 2
a1189 2
static const char *names_seg[] = {
  "%es","%cs","%ss","%ds","%fs","%gs","%?","%?",
d1191 2
a1192 2
static const char *index16[] = {
  "%bx,%si","%bx,%di","%bp,%si","%bp,%di","%si","%di","%bp","%bx"
d1849 7
d1870 7
d2501 1
a2501 1
  oappend (scratchbuf);
a2805 1
      oappend ("%cs:");
d2807 1
a2810 1
      oappend ("%ds:");
d2812 1
a2815 1
      oappend ("%ss:");
d2817 1
a2820 1
      oappend ("%es:");
d2822 1
a2825 1
      oappend ("%fs:");
d2827 1
a2830 1
      oappend ("%gs:");
d2832 1
d3087 2
a3088 1
                      sprintf (scratchbuf, "%s", mode_64bit ? names64[index] : names32[index]);
d3091 2
a3092 1
		    sprintf (scratchbuf, ",%s", mode_64bit ? names64[index] : names32[index]);
d3113 6
d3136 1
a3136 1
		  oappend (names_seg[3]);
d3328 4
a3331 1
      s = "(%dx)";
d3386 4
a3389 1
      s = "(%dx)";
d3474 2
a3475 2
  print_operand_value (scratchbuf + !intel_syntax, 1, op);
  oappend (scratchbuf);
d3527 2
a3528 2
  print_operand_value (scratchbuf + !intel_syntax, 1, op);
  oappend (scratchbuf);
d3580 1
a3580 1
  oappend (scratchbuf);
d3626 1
a3626 5
  static char *sreg[] = {
    "%es","%cs","%ss","%ds","%fs","%gs","%?","%?",
  };

  oappend (sreg[reg]);
d3647 4
a3650 1
  sprintf (scratchbuf, "$0x%x,$0x%x", seg, offset);
d3673 1
a3673 1
	  oappend (names_seg[3]);
d3703 1
a3703 1
	  oappend (names_seg[3]);
d3717 5
a3721 1
  oappend ("(");
d3730 4
a3733 1
  oappend (")");
d3741 1
a3741 1
  oappend ("%es:");
d3771 2
a3772 2
  sprintf (scratchbuf, "%%cr%d", reg+add);
  oappend (scratchbuf);
d3784 4
a3787 1
  sprintf (scratchbuf, "%%db%d", reg+add);
d3797 1
a3797 1
  oappend (scratchbuf);
d3825 1
a3825 1
  oappend (scratchbuf);
d3838 1
a3838 1
  oappend (scratchbuf);
d3864 1
a3864 1
  oappend (scratchbuf);
d3886 1
a3886 1
  oappend (scratchbuf);
@


1.27
log
@2001-07-09  Andreas Jaeger  <aj@@suse.de>, Karsten Keil <kkeil@@suse.de>

	* i386-dis.c (set_op): Handle 64 bit and 32 bit mode.
	(OP_J): Use bfd_vma for mask to work properly with 64 bits.
	(op_address,op_riprel): Use bfd_vma to handle 64 bits.
@
text
@d200 1
a200 1
#define M OP_E, 0		/* lea */
d1318 8
a1325 8
    { "sgdt", Ew, XX, XX },
    { "sidt", Ew, XX, XX },
    { "lgdt", Ew, XX, XX },
    { "lidt", Ew, XX, XX },
    { "smsw", Ew, XX, XX },
    { "(bad)", XX, XX, XX },
    { "lmsw", Ew, XX, XX },
    { "invlpg", Ew, XX, XX },
@


1.26
log
@Merge insn decode tables, and generally tidy.
@
text
@d70 1
a70 1
static void set_op PARAMS ((unsigned int, int));
d1789 2
a1790 2
static unsigned int op_address[3];
static unsigned int op_riprel[3];
d3241 1
a3241 1
     unsigned int op;
d3245 11
a3255 2
  op_address[op_ad] = op;
  op_riprel[op_ad] = riprel;
d3527 1
a3527 1
  int mask = -1;
@


1.25
log
@Branch hints for Pentium4 as insn modifiers, and some minor tweaks
to formatting.
@
text
@d53 45
a307 48
typedef void (*op_rtn) PARAMS ((int bytemode, int sizeflag));

static void OP_E PARAMS ((int, int));
static void OP_G PARAMS ((int, int));
static void OP_I PARAMS ((int, int));
static void OP_I64 PARAMS ((int, int));
static void OP_OFF PARAMS ((int, int));
static void OP_REG PARAMS ((int, int));
static void OP_IMREG PARAMS ((int, int));
static void OP_OFF64 PARAMS ((int, int));
static void OP_indirE PARAMS ((int, int));
static void OP_sI PARAMS ((int, int));
static void OP_REG PARAMS ((int, int));
static void OP_J PARAMS ((int, int));
static void OP_DIR PARAMS ((int, int));
static void OP_OFF PARAMS ((int, int));
static void OP_ESreg PARAMS ((int, int));
static void OP_DSreg PARAMS ((int, int));
static void OP_SEG PARAMS ((int, int));
static void OP_C PARAMS ((int, int));
static void OP_D PARAMS ((int, int));
static void OP_T PARAMS ((int, int));
static void OP_Rd PARAMS ((int, int));
static void OP_ST PARAMS ((int, int));
static void OP_STi  PARAMS ((int, int));
static void OP_MMX PARAMS ((int, int));
static void OP_XMM PARAMS ((int, int));
static void OP_EM PARAMS ((int, int));
static void OP_EX PARAMS ((int, int));
static void OP_MS PARAMS ((int, int));
static void OP_XS PARAMS ((int, int));
static void OP_3DNowSuffix PARAMS ((int, int));
static void OP_SIMD_Suffix PARAMS ((int, int));
static void SIMD_Fixup PARAMS ((int, int));

static void append_seg PARAMS ((void));
static void set_op PARAMS ((unsigned int op, int));
static void putop PARAMS ((const char *template, int sizeflag));
static void dofloat PARAMS ((int sizeflag));
static int get16 PARAMS ((void));
static bfd_vma get64 PARAMS ((void));
static bfd_signed_vma get32 PARAMS ((void));
static bfd_signed_vma get32s PARAMS ((void));
static void ckprefix PARAMS ((void));
static const char *prefix_name PARAMS ((int, int));
static void ptr_reg PARAMS ((int, int));
static void BadOp PARAMS ((void));

d363 58
a420 2
#define USE_GROUPS 1
#define USE_PREFIX_USER_TABLE 2
d422 1
a422 51
#define GRP1b NULL, NULL, 0, NULL, USE_GROUPS, NULL, 0
#define GRP1S NULL, NULL, 1, NULL, USE_GROUPS, NULL, 0
#define GRP1Ss NULL, NULL, 2, NULL, USE_GROUPS, NULL, 0
#define GRP2b NULL, NULL, 3, NULL, USE_GROUPS, NULL, 0
#define GRP2S NULL, NULL, 4, NULL, USE_GROUPS, NULL, 0
#define GRP2b_one NULL, NULL, 5, NULL, USE_GROUPS, NULL, 0
#define GRP2S_one NULL, NULL, 6, NULL, USE_GROUPS, NULL, 0
#define GRP2b_cl NULL, NULL, 7, NULL, USE_GROUPS, NULL, 0
#define GRP2S_cl NULL, NULL, 8, NULL, USE_GROUPS, NULL, 0
#define GRP3b NULL, NULL, 9, NULL, USE_GROUPS, NULL, 0
#define GRP3S NULL, NULL, 10, NULL, USE_GROUPS, NULL, 0
#define GRP4  NULL, NULL, 11, NULL, USE_GROUPS, NULL, 0
#define GRP5  NULL, NULL, 12, NULL, USE_GROUPS, NULL, 0
#define GRP6  NULL, NULL, 13, NULL, USE_GROUPS, NULL, 0
#define GRP7 NULL, NULL, 14, NULL, USE_GROUPS, NULL, 0
#define GRP8 NULL, NULL, 15, NULL, USE_GROUPS, NULL, 0
#define GRP9 NULL, NULL, 16, NULL, USE_GROUPS, NULL, 0
#define GRP10 NULL, NULL, 17, NULL, USE_GROUPS, NULL, 0
#define GRP11 NULL, NULL, 18, NULL, USE_GROUPS, NULL, 0
#define GRP12 NULL, NULL, 19, NULL, USE_GROUPS, NULL, 0
#define GRP13 NULL, NULL, 20, NULL, USE_GROUPS, NULL, 0
#define GRP14 NULL, NULL, 21, NULL, USE_GROUPS, NULL, 0
#define GRPAMD NULL, NULL, 22, NULL, USE_GROUPS, NULL, 0

#define PREGRP0 NULL, NULL, 0, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP1 NULL, NULL, 1, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP2 NULL, NULL, 2, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP3 NULL, NULL, 3, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP4 NULL, NULL, 4, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP5 NULL, NULL, 5, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP6 NULL, NULL, 6, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP7 NULL, NULL, 7, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP8 NULL, NULL, 8, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP9 NULL, NULL, 9, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP10 NULL, NULL, 10, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP11 NULL, NULL, 11, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP12 NULL, NULL, 12, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP13 NULL, NULL, 13, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP14 NULL, NULL, 14, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP15 NULL, NULL, 15, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP16 NULL, NULL, 16, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP17 NULL, NULL, 17, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP18 NULL, NULL, 18, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP19 NULL, NULL, 19, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP20 NULL, NULL, 20, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP21 NULL, NULL, 21, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP22 NULL, NULL, 22, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP23 NULL, NULL, 23, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP24 NULL, NULL, 24, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP25 NULL, NULL, 25, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP26 NULL, NULL, 26, NULL, USE_PREFIX_USER_TABLE, NULL, 0
d424 1
a424 2
#define FLOATCODE 50
#define FLOAT NULL, NULL, FLOATCODE, NULL, 0, NULL, 0
a447 1
   'I' => print 'q' in 64bit mode and behave as 'P' otherwise
d451 2
a452 1
   'T' => print 'q' in 64bit mode and behave as 'I' otherwise
a455 293
*/

static const struct dis386 dis386_att[] = {
  /* 00 */
  { "addB",	Eb, Gb, XX },
  { "addS",	Ev, Gv, XX },
  { "addB",	Gb, Eb, XX },
  { "addS",	Gv, Ev, XX },
  { "addB",	AL, Ib, XX },
  { "addS",	eAX, Iv, XX },
  { "pushI",	es, XX, XX },
  { "popI",	es, XX, XX },
  /* 08 */
  { "orB",	Eb, Gb, XX },
  { "orS",	Ev, Gv, XX },
  { "orB",	Gb, Eb, XX },
  { "orS",	Gv, Ev, XX },
  { "orB",	AL, Ib, XX },
  { "orS",	eAX, Iv, XX },
  { "pushI",	cs, XX, XX },
  { "(bad)",	XX, XX, XX },	/* 0x0f extended opcode escape */
  /* 10 */
  { "adcB",	Eb, Gb, XX },
  { "adcS",	Ev, Gv, XX },
  { "adcB",	Gb, Eb, XX },
  { "adcS",	Gv, Ev, XX },
  { "adcB",	AL, Ib, XX },
  { "adcS",	eAX, Iv, XX },
  { "pushI",	ss, XX, XX },
  { "popI",	ss, XX, XX },
  /* 18 */
  { "sbbB",	Eb, Gb, XX },
  { "sbbS",	Ev, Gv, XX },
  { "sbbB",	Gb, Eb, XX },
  { "sbbS",	Gv, Ev, XX },
  { "sbbB",	AL, Ib, XX },
  { "sbbS",	eAX, Iv, XX },
  { "pushI",	ds, XX, XX },
  { "popI",	ds, XX, XX },
  /* 20 */
  { "andB",	Eb, Gb, XX },
  { "andS",	Ev, Gv, XX },
  { "andB",	Gb, Eb, XX },
  { "andS",	Gv, Ev, XX },
  { "andB",	AL, Ib, XX },
  { "andS",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG ES prefix */
  { "daa",	XX, XX, XX },
  /* 28 */
  { "subB",	Eb, Gb, XX },
  { "subS",	Ev, Gv, XX },
  { "subB",	Gb, Eb, XX },
  { "subS",	Gv, Ev, XX },
  { "subB",	AL, Ib, XX },
  { "subS",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG CS prefix */
  { "das",	XX, XX, XX },
  /* 30 */
  { "xorB",	Eb, Gb, XX },
  { "xorS",	Ev, Gv, XX },
  { "xorB",	Gb, Eb, XX },
  { "xorS",	Gv, Ev, XX },
  { "xorB",	AL, Ib, XX },
  { "xorS",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG SS prefix */
  { "aaa",	XX, XX, XX },
  /* 38 */
  { "cmpB",	Eb, Gb, XX },
  { "cmpS",	Ev, Gv, XX },
  { "cmpB",	Gb, Eb, XX },
  { "cmpS",	Gv, Ev, XX },
  { "cmpB",	AL, Ib, XX },
  { "cmpS",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG DS prefix */
  { "aas",	XX, XX, XX },
  /* 40 */
  { "incS",	RMeAX, XX, XX },
  { "incS",	RMeCX, XX, XX },
  { "incS",	RMeDX, XX, XX },
  { "incS",	RMeBX, XX, XX },
  { "incS",	RMeSP, XX, XX },
  { "incS",	RMeBP, XX, XX },
  { "incS",	RMeSI, XX, XX },
  { "incS",	RMeDI, XX, XX },
  /* 48 */
  { "decS",	RMeAX, XX, XX },
  { "decS",	RMeCX, XX, XX },
  { "decS",	RMeDX, XX, XX },
  { "decS",	RMeBX, XX, XX },
  { "decS",	RMeSP, XX, XX },
  { "decS",	RMeBP, XX, XX },
  { "decS",	RMeSI, XX, XX },
  { "decS",	RMeDI, XX, XX },
  /* 50 */
  { "pushS",	RMeAX, XX, XX },
  { "pushS",	RMeCX, XX, XX },
  { "pushS",	RMeDX, XX, XX },
  { "pushS",	RMeBX, XX, XX },
  { "pushS",	RMeSP, XX, XX },
  { "pushS",	RMeBP, XX, XX },
  { "pushS",	RMeSI, XX, XX },
  { "pushS",	RMeDI, XX, XX },
  /* 58 */
  { "popS",	RMeAX, XX, XX },
  { "popS",	RMeCX, XX, XX },
  { "popS",	RMeDX, XX, XX },
  { "popS",	RMeBX, XX, XX },
  { "popS",	RMeSP, XX, XX },
  { "popS",	RMeBP, XX, XX },
  { "popS",	RMeSI, XX, XX },
  { "popS",	RMeDI, XX, XX },
  /* 60 */
  { "pushaP",	XX, XX, XX },
  { "popaP",	XX, XX, XX },
  { "boundS",	Gv, Ma, XX },
  { "arpl",	Ew, Gw, XX },
  { "(bad)",	XX, XX, XX },			/* seg fs */
  { "(bad)",	XX, XX, XX },			/* seg gs */
  { "(bad)",	XX, XX, XX },			/* op size prefix */
  { "(bad)",	XX, XX, XX },			/* adr size prefix */
  /* 68 */
  { "pushI",	Iv, XX, XX },		/* 386 book wrong */
  { "imulS",	Gv, Ev, Iv },
  { "pushI",	sIb, XX, XX },	/* push of byte really pushes 2 or 4 bytes */
  { "imulS",	Gv, Ev, sIb },
  { "insb",	Yb, indirDX, XX },
  { "insR",	Yv, indirDX, XX },
  { "outsb",	indirDX, Xb, XX },
  { "outsR",	indirDX, Xv, XX },
  /* 70 */
  { "joH",	Jb, cond_jump_flag, XX },
  { "jnoH",	Jb, cond_jump_flag, XX },
  { "jbH",	Jb, cond_jump_flag, XX },
  { "jaeH",	Jb, cond_jump_flag, XX },
  { "jeH",	Jb, cond_jump_flag, XX },
  { "jneH",	Jb, cond_jump_flag, XX },
  { "jbeH",	Jb, cond_jump_flag, XX },
  { "jaH",	Jb, cond_jump_flag, XX },
  /* 78 */
  { "jsH",	Jb, cond_jump_flag, XX },
  { "jnsH",	Jb, cond_jump_flag, XX },
  { "jpH",	Jb, cond_jump_flag, XX },
  { "jnpH",	Jb, cond_jump_flag, XX },
  { "jlH",	Jb, cond_jump_flag, XX },
  { "jgeH",	Jb, cond_jump_flag, XX },
  { "jleH",	Jb, cond_jump_flag, XX },
  { "jgH",	Jb, cond_jump_flag, XX },
  /* 80 */
  { GRP1b },
  { GRP1S },
  { "(bad)",	XX, XX, XX },
  { GRP1Ss },
  { "testB",	Eb, Gb, XX },
  { "testS",	Ev, Gv, XX },
  { "xchgB",	Eb, Gb, XX },
  { "xchgS",	Ev, Gv, XX },
  /* 88 */
  { "movB",	Eb, Gb, XX },
  { "movS",	Ev, Gv, XX },
  { "movB",	Gb, Eb, XX },
  { "movS",	Gv, Ev, XX },
  { "movQ",	Ev, Sw, XX },
  { "leaS",	Gv, M, XX },
  { "movQ",	Sw, Ev, XX },
  { "popT",	Ev, XX, XX },
  /* 90 */
  { "nop",	XX, XX, XX },
  /* FIXME: NOP with REPz prefix is called PAUSE.  */
  { "xchgS",	RMeCX, eAX, XX },
  { "xchgS",	RMeDX, eAX, XX },
  { "xchgS",	RMeBX, eAX, XX },
  { "xchgS",	RMeSP, eAX, XX },
  { "xchgS",	RMeBP, eAX, XX },
  { "xchgS",	RMeSI, eAX, XX },
  { "xchgS",	RMeDI, eAX, XX },
  /* 98 */
  { "cWtR",	XX, XX, XX },
  { "cRtO",	XX, XX, XX },
  { "lcallI",	Ap, XX, XX },
  { "(bad)",	XX, XX, XX },		/* fwait */
  { "pushfI",	XX, XX, XX },
  { "popfI",	XX, XX, XX },
  { "sahf",	XX, XX, XX },
  { "lahf",	XX, XX, XX },
  /* a0 */
  { "movB",	AL, Ob, XX },
  { "movS",	eAX, Ov, XX },
  { "movB",	Ob, AL, XX },
  { "movS",	Ov, eAX, XX },
  { "movsb",	Yb, Xb, XX },
  { "movsR",	Yv, Xv, XX },
  { "cmpsb",	Xb, Yb, XX },
  { "cmpsR",	Xv, Yv, XX },
  /* a8 */
  { "testB",	AL, Ib, XX },
  { "testS",	eAX, Iv, XX },
  { "stosB",	Yb, AL, XX },
  { "stosS",	Yv, eAX, XX },
  { "lodsB",	AL, Xb, XX },
  { "lodsS",	eAX, Xv, XX },
  { "scasB",	AL, Yb, XX },
  { "scasS",	eAX, Yv, XX },
  /* b0 */
  { "movB",	RMAL, Ib, XX },
  { "movB",	RMCL, Ib, XX },
  { "movB",	RMDL, Ib, XX },
  { "movB",	RMBL, Ib, XX },
  { "movB",	RMAH, Ib, XX },
  { "movB",	RMCH, Ib, XX },
  { "movB",	RMDH, Ib, XX },
  { "movB",	RMBH, Ib, XX },
  /* b8 */
  { "movS",	RMeAX, Iv, XX },
  { "movS",	RMeCX, Iv, XX },
  { "movS",	RMeDX, Iv, XX },
  { "movS",	RMeBX, Iv, XX },
  { "movS",	RMeSP, Iv, XX },
  { "movS",	RMeBP, Iv, XX },
  { "movS",	RMeSI, Iv, XX },
  { "movS",	RMeDI, Iv, XX },
  /* c0 */
  { GRP2b },
  { GRP2S },
  { "retI",	Iw, XX, XX },
  { "retI",	XX, XX, XX },
  { "lesS",	Gv, Mp, XX },
  { "ldsS",	Gv, Mp, XX },
  { "movA",	Eb, Ib, XX },
  { "movQ",	Ev, Iv, XX },
  /* c8 */
  { "enterI",	Iw, Ib, XX },
  { "leaveI",	XX, XX, XX },
  { "lretP",	Iw, XX, XX },
  { "lretP",	XX, XX, XX },
  { "int3",	XX, XX, XX },
  { "int",	Ib, XX, XX },
  { "into",	XX, XX, XX},
  { "iretP",	XX, XX, XX },
  /* d0 */
  { GRP2b_one },
  { GRP2S_one },
  { GRP2b_cl },
  { GRP2S_cl },
  { "aam",	sIb, XX, XX },
  { "aad",	sIb, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "xlat",	DSBX, XX, XX },
  /* d8 */
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  /* e0 */
  { "loopneFH",	Jb, loop_jcxz_flag, XX },
  { "loopeFH",	Jb, loop_jcxz_flag, XX },
  { "loopFH",	Jb, loop_jcxz_flag, XX },
  { "jEcxzH",	Jb, loop_jcxz_flag, XX },
  { "inB",	AL, Ib, XX },
  { "inS",	eAX, Ib, XX },
  { "outB",	Ib, AL, XX },
  { "outS",	Ib, eAX, XX },
  /* e8 */
  { "callI",	Jv, XX, XX },
  { "jmpI",	Jv, XX, XX },
  { "ljmpI",	Ap, XX, XX },
  { "jmp",	Jb, XX, XX },
  { "inB",	AL, indirDX, XX },
  { "inS",	eAX, indirDX, XX },
  { "outB",	indirDX, AL, XX },
  { "outS",	indirDX, eAX, XX },
  /* f0 */
  { "(bad)",	XX, XX, XX },			/* lock prefix */
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },			/* repne */
  { "(bad)",	XX, XX, XX },			/* repz */
  { "hlt",	XX, XX, XX },
  { "cmc",	XX, XX, XX },
  { GRP3b },
  { GRP3S },
  /* f8 */
  { "clc",	XX, XX, XX },
  { "stc",	XX, XX, XX },
  { "cli",	XX, XX, XX },
  { "sti",	XX, XX, XX },
  { "cld",	XX, XX, XX },
  { "std",	XX, XX, XX },
  { GRP4 },
  { GRP5 },
};
d457 2
a458 291
static const struct dis386 dis386_intel[] = {
  /* 00 */
  { "add",	Eb, Gb, XX },
  { "add",	Ev, Gv, XX },
  { "add",	Gb, Eb, XX },
  { "add",	Gv, Ev, XX },
  { "add",	AL, Ib, XX },
  { "add",	eAX, Iv, XX },
  { "push",	es, XX, XX },
  { "pop",	es, XX, XX },
  /* 08 */
  { "or",	Eb, Gb, XX },
  { "or",	Ev, Gv, XX },
  { "or",	Gb, Eb, XX },
  { "or",	Gv, Ev, XX },
  { "or",	AL, Ib, XX },
  { "or",	eAX, Iv, XX },
  { "push",	cs, XX, XX },
  { "(bad)",	XX, XX, XX },	/* 0x0f extended opcode escape */
  /* 10 */
  { "adc",	Eb, Gb, XX },
  { "adc",	Ev, Gv, XX },
  { "adc",	Gb, Eb, XX },
  { "adc",	Gv, Ev, XX },
  { "adc",	AL, Ib, XX },
  { "adc",	eAX, Iv, XX },
  { "push",	ss, XX, XX },
  { "pop",	ss, XX, XX },
  /* 18 */
  { "sbb",	Eb, Gb, XX },
  { "sbb",	Ev, Gv, XX },
  { "sbb",	Gb, Eb, XX },
  { "sbb",	Gv, Ev, XX },
  { "sbb",	AL, Ib, XX },
  { "sbb",	eAX, Iv, XX },
  { "push",	ds, XX, XX },
  { "pop",	ds, XX, XX },
  /* 20 */
  { "and",	Eb, Gb, XX },
  { "and",	Ev, Gv, XX },
  { "and",	Gb, Eb, XX },
  { "and",	Gv, Ev, XX },
  { "and",	AL, Ib, XX },
  { "and",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG ES prefix */
  { "daa",	XX, XX, XX },
  /* 28 */
  { "sub",	Eb, Gb, XX },
  { "sub",	Ev, Gv, XX },
  { "sub",	Gb, Eb, XX },
  { "sub",	Gv, Ev, XX },
  { "sub",	AL, Ib, XX },
  { "sub",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG CS prefix */
  { "das",	XX, XX, XX },
  /* 30 */
  { "xor",	Eb, Gb, XX },
  { "xor",	Ev, Gv, XX },
  { "xor",	Gb, Eb, XX },
  { "xor",	Gv, Ev, XX },
  { "xor",	AL, Ib, XX },
  { "xor",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG SS prefix */
  { "aaa",	XX, XX, XX },
  /* 38 */
  { "cmp",	Eb, Gb, XX },
  { "cmp",	Ev, Gv, XX },
  { "cmp",	Gb, Eb, XX },
  { "cmp",	Gv, Ev, XX },
  { "cmp",	AL, Ib, XX },
  { "cmp",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG DS prefix */
  { "aas",	XX, XX, XX },
  /* 40 */
  { "inc",	RMeAX, XX, XX },
  { "inc",	RMeCX, XX, XX },
  { "inc",	RMeDX, XX, XX },
  { "inc",	RMeBX, XX, XX },
  { "inc",	RMeSP, XX, XX },
  { "inc",	RMeBP, XX, XX },
  { "inc",	RMeSI, XX, XX },
  { "inc",	RMeDI, XX, XX },
  /* 48 */
  { "dec",	RMeAX, XX, XX },
  { "dec",	RMeCX, XX, XX },
  { "dec",	RMeDX, XX, XX },
  { "dec",	RMeBX, XX, XX },
  { "dec",	RMeSP, XX, XX },
  { "dec",	RMeBP, XX, XX },
  { "dec",	RMeSI, XX, XX },
  { "dec",	RMeDI, XX, XX },
  /* 50 */
  { "push",	RMeAX, XX, XX },
  { "push",	RMeCX, XX, XX },
  { "push",	RMeDX, XX, XX },
  { "push",	RMeBX, XX, XX },
  { "push",	RMeSP, XX, XX },
  { "push",	RMeBP, XX, XX },
  { "push",	RMeSI, XX, XX },
  { "push",	RMeDI, XX, XX },
  /* 58 */
  { "pop",	RMeAX, XX, XX },
  { "pop",	RMeCX, XX, XX },
  { "pop",	RMeDX, XX, XX },
  { "pop",	RMeBX, XX, XX },
  { "pop",	RMeSP, XX, XX },
  { "pop",	RMeBP, XX, XX },
  { "pop",	RMeSI, XX, XX },
  { "pop",	RMeDI, XX, XX },
  /* 60 */
  { "pusha",	XX, XX, XX },
  { "popa",	XX, XX, XX },
  { "bound",	Gv, Ma, XX },
  { "arpl",	Ew, Gw, XX },
  { "(bad)",	XX, XX, XX },			/* seg fs */
  { "(bad)",	XX, XX, XX },			/* seg gs */
  { "(bad)",	XX, XX, XX },			/* op size prefix */
  { "(bad)",	XX, XX, XX },			/* adr size prefix */
  /* 68 */
  { "push",	Iv, XX, XX },		/* 386 book wrong */
  { "imul",	Gv, Ev, Iv },
  { "push",	sIb, XX, XX },	/* push of byte really pushes 2 or 4 bytes */
  { "imul",	Gv, Ev, sIb },
  { "ins",	Yb, indirDX, XX },
  { "ins",	Yv, indirDX, XX },
  { "outs",	indirDX, Xb, XX },
  { "outs",	indirDX, Xv, XX },
  /* 70 */
  { "jo",	Jb, XX, XX },
  { "jno",	Jb, XX, XX },
  { "jb",	Jb, XX, XX },
  { "jae",	Jb, XX, XX },
  { "je",	Jb, XX, XX },
  { "jne",	Jb, XX, XX },
  { "jbe",	Jb, XX, XX },
  { "ja",	Jb, XX, XX },
  /* 78 */
  { "js",	Jb, XX, XX },
  { "jns",	Jb, XX, XX },
  { "jp",	Jb, XX, XX },
  { "jnp",	Jb, XX, XX },
  { "jl",	Jb, XX, XX },
  { "jge",	Jb, XX, XX },
  { "jle",	Jb, XX, XX },
  { "jg",	Jb, XX, XX },
  /* 80 */
  { GRP1b },
  { GRP1S },
  { "(bad)",	XX, XX, XX },
  { GRP1Ss },
  { "test",	Eb, Gb, XX },
  { "test",	Ev, Gv, XX },
  { "xchg",	Eb, Gb, XX },
  { "xchg",	Ev, Gv, XX },
  /* 88 */
  { "mov",	Eb, Gb, XX },
  { "mov",	Ev, Gv, XX },
  { "mov",	Gb, Eb, XX },
  { "mov",	Gv, Ev, XX },
  { "mov",	Ev, Sw, XX },
  { "lea",	Gv, M, XX },
  { "mov",	Sw, Ev, XX },
  { "pop",	Ev, XX, XX },
  /* 90 */
  { "nop",	XX, XX, XX },
  /* FIXME: NOP with REPz prefix is called PAUSE.  */
  { "xchg",	RMeCX, eAX, XX },
  { "xchg",	RMeDX, eAX, XX },
  { "xchg",	RMeBX, eAX, XX },
  { "xchg",	RMeSP, eAX, XX },
  { "xchg",	RMeBP, eAX, XX },
  { "xchg",	RMeSI, eAX, XX },
  { "xchg",	RMeDI, eAX, XX },
  /* 98 */
  { "cW",	XX, XX, XX },		/* cwde and cbw */
  { "cR",	XX, XX, XX },		/* cdq and cwd */
  { "lcall",	Ap, XX, XX },
  { "(bad)",	XX, XX, XX },		/* fwait */
  { "pushf",	XX, XX, XX },
  { "popf",	XX, XX, XX },
  { "sahf",	XX, XX, XX },
  { "lahf",	XX, XX, XX },
  /* a0 */
  { "mov",	AL, Ob, XX },
  { "mov",	eAX, Ov, XX },
  { "mov",	Ob, AL, XX },
  { "mov",	Ov, eAX, XX },
  { "movs",	Yb, Xb, XX },
  { "movs",	Yv, Xv, XX },
  { "cmps",	Xb, Yb, XX },
  { "cmps",	Xv, Yv, XX },
  /* a8 */
  { "test",	AL, Ib, XX },
  { "test",	eAX, Iv, XX },
  { "stos",	Yb, AL, XX },
  { "stos",	Yv, eAX, XX },
  { "lods",	AL, Xb, XX },
  { "lods",	eAX, Xv, XX },
  { "scas",	AL, Yb, XX },
  { "scas",	eAX, Yv, XX },
  /* b0 */
  { "mov",	RMAL, Ib, XX },
  { "mov",	RMCL, Ib, XX },
  { "mov",	RMDL, Ib, XX },
  { "mov",	RMBL, Ib, XX },
  { "mov",	RMAH, Ib, XX },
  { "mov",	RMCH, Ib, XX },
  { "mov",	RMDH, Ib, XX },
  { "mov",	RMBH, Ib, XX },
  /* b8 */
  { "mov",	RMeAX, Iv, XX },
  { "mov",	RMeCX, Iv, XX },
  { "mov",	RMeDX, Iv, XX },
  { "mov",	RMeBX, Iv, XX },
  { "mov",	RMeSP, Iv, XX },
  { "mov",	RMeBP, Iv, XX },
  { "mov",	RMeSI, Iv, XX },
  { "mov",	RMeDI, Iv, XX },
  /* c0 */
  { GRP2b },
  { GRP2S },
  { "ret",	Iw, XX, XX },
  { "ret",	XX, XX, XX },
  { "les",	Gv, Mp, XX },
  { "lds",	Gv, Mp, XX },
  { "mov",	Eb, Ib, XX },
  { "mov",	Ev, Iv, XX },
  /* c8 */
  { "enter",	Iw, Ib, XX },
  { "leave",	XX, XX, XX },
  { "lret",	Iw, XX, XX },
  { "lret",	XX, XX, XX },
  { "int3",	XX, XX, XX },
  { "int",	Ib, XX, XX },
  { "into",	XX, XX, XX },
  { "iret",	XX, XX, XX },
  /* d0 */
  { GRP2b_one },
  { GRP2S_one },
  { GRP2b_cl },
  { GRP2S_cl },
  { "aam",	sIb, XX, XX },
  { "aad",	sIb, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "xlat",	DSBX, XX, XX },
  /* d8 */
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  /* e0 */
  { "loopne",	Jb, XX, XX },
  { "loope",	Jb, XX, XX },
  { "loop",	Jb, XX, XX },
  { "jEcxz",	Jb, XX, XX },
  { "in",	AL, Ib, XX },
  { "in",	eAX, Ib, XX },
  { "out",	Ib, AL, XX },
  { "out",	Ib, eAX, XX },
  /* e8 */
  { "call",	Jv, XX, XX },
  { "jmp",	Jv, XX, XX },
  { "ljmp",	Ap, XX, XX },
  { "jmp",	Jb, XX, XX },
  { "in",	AL, indirDX, XX },
  { "in",	eAX, indirDX, XX },
  { "out",	indirDX, AL, XX },
  { "out",	indirDX, eAX, XX },
  /* f0 */
  { "(bad)",	XX, XX, XX },			/* lock prefix */
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },			/* repne */
  { "(bad)",	XX, XX, XX },			/* repz */
  { "hlt",	XX, XX, XX },
  { "cmc",	XX, XX, XX },
  { GRP3b },
  { GRP3S },
  /* f8 */
  { "clc",	XX, XX, XX },
  { "stc",	XX, XX, XX },
  { "cli",	XX, XX, XX },
  { "sti",	XX, XX, XX },
  { "cld",	XX, XX, XX },
  { "std",	XX, XX, XX },
  { GRP4 },
  { GRP5 },
};
d460 5
a464 293
/* 64bit mode is having some instruction set differences, so separate table is
   needed.  */
static const struct dis386 disx86_64_att[] = {
  /* 00 */
  { "addB",	Eb, Gb, XX },
  { "addS",	Ev, Gv, XX },
  { "addB",	Gb, Eb, XX },
  { "addS",	Gv, Ev, XX },
  { "addB",	AL, Ib, XX },
  { "addS",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  /* 08 */
  { "orB",	Eb, Gb, XX },
  { "orS",	Ev, Gv, XX },
  { "orB",	Gb, Eb, XX },
  { "orS",	Gv, Ev, XX },
  { "orB",	AL, Ib, XX },
  { "orS",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "(bad)",	XX, XX, XX },	/* 0x0f extended opcode escape */
  /* 10 */
  { "adcB",	Eb, Gb, XX },
  { "adcS",	Ev, Gv, XX },
  { "adcB",	Gb, Eb, XX },
  { "adcS",	Gv, Ev, XX },
  { "adcB",	AL, Ib, XX },
  { "adcS",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  /* 18 */
  { "sbbB",	Eb, Gb, XX },
  { "sbbS",	Ev, Gv, XX },
  { "sbbB",	Gb, Eb, XX },
  { "sbbS",	Gv, Ev, XX },
  { "sbbB",	AL, Ib, XX },
  { "sbbS",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  /* 20 */
  { "andB",	Eb, Gb, XX },
  { "andS",	Ev, Gv, XX },
  { "andB",	Gb, Eb, XX },
  { "andS",	Gv, Ev, XX },
  { "andB",	AL, Ib, XX },
  { "andS",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG ES prefix */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  /* 28 */
  { "subB",	Eb, Gb, XX },
  { "subS",	Ev, Gv, XX },
  { "subB",	Gb, Eb, XX },
  { "subS",	Gv, Ev, XX },
  { "subB",	AL, Ib, XX },
  { "subS",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG CS prefix */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  /* 30 */
  { "xorB",	Eb, Gb, XX },
  { "xorS",	Ev, Gv, XX },
  { "xorB",	Gb, Eb, XX },
  { "xorS",	Gv, Ev, XX },
  { "xorB",	AL, Ib, XX },
  { "xorS",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG SS prefix */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  /* 38 */
  { "cmpB",	Eb, Gb, XX },
  { "cmpS",	Ev, Gv, XX },
  { "cmpB",	Gb, Eb, XX },
  { "cmpS",	Gv, Ev, XX },
  { "cmpB",	AL, Ib, XX },
  { "cmpS",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG DS prefix */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  /* 40 */
  { "(bad)",	XX, XX, XX },			/* REX prefix area.  */
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  /* 48 */
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  /* 50 */
  { "pushI",	RMrAX, XX, XX },
  { "pushI",	RMrCX, XX, XX },
  { "pushI",	RMrDX, XX, XX },
  { "pushI",	RMrBX, XX, XX },
  { "pushI",	RMrSP, XX, XX },
  { "pushI",	RMrBP, XX, XX },
  { "pushI",	RMrSI, XX, XX },
  { "pushI",	RMrDI, XX, XX },
  /* 58 */
  { "popI",	RMrAX, XX, XX },
  { "popI",	RMrCX, XX, XX },
  { "popI",	RMrDX, XX, XX },
  { "popI",	RMrBX, XX, XX },
  { "popI",	RMrSP, XX, XX },
  { "popI",	RMrBP, XX, XX },
  { "popI",	RMrSI, XX, XX },
  { "popI",	RMrDI, XX, XX },
  /* 60 */
  { "(bad)",	XX, XX, XX },   /* reserved.  */
  { "(bad)",	XX, XX, XX },   /* reserved.  */
  { "(bad)",	XX, XX, XX },   /* reserved.  */
  { "movslR",   Gv, Ed, XX },
  { "(bad)",	XX, XX, XX },			/* seg fs */
  { "(bad)",	XX, XX, XX },			/* seg gs */
  { "(bad)",	XX, XX, XX },			/* op size prefix */
  { "(bad)",	XX, XX, XX },			/* adr size prefix */
  /* 68 */
  { "pushI",	Iq, XX, XX },		/* 386 book wrong */
  { "imulS",	Gv, Ev, Iv },
  { "pushI",	sIb, XX, XX },	/* push of byte really pushes 2 or 4 bytes */
  { "imulS",	Gv, Ev, sIb },
  { "insb",	Yb, indirDX, XX },
  { "insR",	Yv, indirDX, XX },
  { "outsb",	indirDX, Xb, XX },
  { "outsR",	indirDX, Xv, XX },
  /* 70 */
  { "joH",	Jb, cond_jump_flag, XX },
  { "jnoH",	Jb, cond_jump_flag, XX },
  { "jbH",	Jb, cond_jump_flag, XX },
  { "jaeH",	Jb, cond_jump_flag, XX },
  { "jeH",	Jb, cond_jump_flag, XX },
  { "jneH",	Jb, cond_jump_flag, XX },
  { "jbeH",	Jb, cond_jump_flag, XX },
  { "jaH",	Jb, cond_jump_flag, XX },
  /* 78 */
  { "jsH",	Jb, cond_jump_flag, XX },
  { "jnsH",	Jb, cond_jump_flag, XX },
  { "jpH",	Jb, cond_jump_flag, XX },
  { "jnpH",	Jb, cond_jump_flag, XX },
  { "jlH",	Jb, cond_jump_flag, XX },
  { "jgeH",	Jb, cond_jump_flag, XX },
  { "jleH",	Jb, cond_jump_flag, XX },
  { "jgH",	Jb, cond_jump_flag, XX },
  /* 80 */
  { GRP1b },
  { GRP1S },
  { "(bad)",	XX, XX, XX },
  { GRP1Ss },
  { "testB",	Eb, Gb, XX },
  { "testS",	Ev, Gv, XX },
  { "xchgB",	Eb, Gb, XX },
  { "xchgS",	Ev, Gv, XX },
  /* 88 */
  { "movB",	Eb, Gb, XX },
  { "movS",	Ev, Gv, XX },
  { "movB",	Gb, Eb, XX },
  { "movS",	Gv, Ev, XX },
  { "movQ",	Ev, Sw, XX },
  { "leaS",	Gv, M, XX },
  { "movQ",	Sw, Ev, XX },
  { "popI",	Ev, XX, XX },
  /* 90 */
  { "nop",	XX, XX, XX },
  /* FIXME: NOP with REPz prefix is called PAUSE.  */
  { "xchgS",	RMeCX, eAX, XX },
  { "xchgS",	RMeDX, eAX, XX },
  { "xchgS",	RMeBX, eAX, XX },
  { "xchgS",	RMeSP, eAX, XX },
  { "xchgS",	RMeBP, eAX, XX },
  { "xchgS",	RMeSI, eAX, XX },
  { "xchgS",	RMeDI, eAX, XX },
  /* 98 */
  { "cWtR",	XX, XX, XX },
  { "cRtO",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },   /* reserved.  */
  { "(bad)",	XX, XX, XX },		/* fwait */
  { "pushfI",	XX, XX, XX },
  { "popfI",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },   /* reserved.  */
  { "(bad)",	XX, XX, XX },   /* reserved.  */
  /* a0 */
  { "movB",	AL, Ob64, XX },
  { "movS",	eAX, Ov64, XX },
  { "movB",	Ob64, AL, XX },
  { "movS",	Ov64, eAX, XX },
  { "movsb",	Yb, Xb, XX },
  { "movsR",	Yv, Xv, XX },
  { "cmpsb",	Xb, Yb, XX },
  { "cmpsR",	Xv, Yv, XX },
  /* a8 */
  { "testB",	AL, Ib, XX },
  { "testS",	eAX, Iv, XX },
  { "stosB",	Yb, AL, XX },
  { "stosS",	Yv, eAX, XX },
  { "lodsB",	AL, Xb, XX },
  { "lodsS",	eAX, Xv, XX },
  { "scasB",	AL, Yb, XX },
  { "scasS",	eAX, Yv, XX },
  /* b0 */
  { "movB",	RMAL, Ib, XX },
  { "movB",	RMCL, Ib, XX },
  { "movB",	RMDL, Ib, XX },
  { "movB",	RMBL, Ib, XX },
  { "movB",	RMAH, Ib, XX },
  { "movB",	RMCH, Ib, XX },
  { "movB",	RMDH, Ib, XX },
  { "movB",	RMBH, Ib, XX },
  /* b8 */
  { "movS",	RMeAX, Iv64, XX },
  { "movS",	RMeCX, Iv64, XX },
  { "movS",	RMeDX, Iv64, XX },
  { "movS",	RMeBX, Iv64, XX },
  { "movS",	RMeSP, Iv64, XX },
  { "movS",	RMeBP, Iv64, XX },
  { "movS",	RMeSI, Iv64, XX },
  { "movS",	RMeDI, Iv64, XX },
  /* c0 */
  { GRP2b },
  { GRP2S },
  { "retI",	Iw, XX, XX },
  { "retI",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },   /* reserved.  */
  { "ldsS",	Gv, Mp, XX },
  { "movA",	Eb, Ib, XX },
  { "movQ",	Ev, Iv, XX },
  /* c8 */
  { "enterI",	Iw, Ib, XX },
  { "leaveI",	XX, XX, XX },
  { "lretP",	Iw, XX, XX },
  { "lretP",	XX, XX, XX },
  { "int3",	XX, XX, XX },
  { "int",	Ib, XX, XX },
  { "(bad)",	XX, XX, XX },   /* reserved.  */
  { "iretP",	XX, XX, XX },
  /* d0 */
  { GRP2b_one },
  { GRP2S_one },
  { GRP2b_cl },
  { GRP2S_cl },
  { "(bad)",	XX, XX, XX },   /* reserved.  */
  { "(bad)",	XX, XX, XX },   /* reserved.  */
  { "(bad)",	XX, XX, XX },   /* reserved.  */
  { "xlat",	DSBX, XX, XX },
  /* d8 */
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  /* e0 */
  { "loopneFH",	Jb, loop_jcxz_flag, XX },
  { "loopeFH",	Jb, loop_jcxz_flag, XX },
  { "loopFH",	Jb, loop_jcxz_flag, XX },
  { "jEcxzH",	Jb, loop_jcxz_flag, XX },
  { "inB",	AL, Ib, XX },
  { "inS",	eAX, Ib, XX },
  { "outB",	Ib, AL, XX },
  { "outS",	Ib, eAX, XX },
  /* e8 */
  { "callI",	Jv, XX, XX },
  { "jmpI",	Jv, XX, XX },
  { "(bad)",	XX, XX, XX },   /* reserved.  */
  { "jmp",	Jb, XX, XX },
  { "inB",	AL, indirDX, XX },
  { "inS",	eAX, indirDX, XX },
  { "outB",	indirDX, AL, XX },
  { "outS",	indirDX, eAX, XX },
  /* f0 */
  { "(bad)",	XX, XX, XX },			/* lock prefix */
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },			/* repne */
  { "(bad)",	XX, XX, XX },			/* repz */
  { "hlt",	XX, XX, XX },
  { "cmc",	XX, XX, XX },
  { GRP3b },
  { GRP3S },
  /* f8 */
  { "clc",	XX, XX, XX },
  { "stc",	XX, XX, XX },
  { "cli",	XX, XX, XX },
  { "sti",	XX, XX, XX },
  { "cld",	XX, XX, XX },
  { "std",	XX, XX, XX },
  { GRP4 },
  { GRP5 },
};
d466 1
a466 1
static const struct dis386 dis386_64_intel[] = {
d468 8
a475 8
  { "add",	Eb, Gb, XX },
  { "add",	Ev, Gv, XX },
  { "add",	Gb, Eb, XX },
  { "add",	Gv, Ev, XX },
  { "add",	AL, Ib, XX },
  { "add",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
d477 8
a484 8
  { "or",	Eb, Gb, XX },
  { "or",	Ev, Gv, XX },
  { "or",	Gb, Eb, XX },
  { "or",	Gv, Ev, XX },
  { "or",	AL, Ib, XX },
  { "or",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "(bad)",	XX, XX, XX },	/* 0x0f extended opcode escape */
d486 8
a493 8
  { "adc",	Eb, Gb, XX },
  { "adc",	Ev, Gv, XX },
  { "adc",	Gb, Eb, XX },
  { "adc",	Gv, Ev, XX },
  { "adc",	AL, Ib, XX },
  { "adc",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
d495 8
a502 8
  { "sbb",	Eb, Gb, XX },
  { "sbb",	Ev, Gv, XX },
  { "sbb",	Gb, Eb, XX },
  { "sbb",	Gv, Ev, XX },
  { "sbb",	AL, Ib, XX },
  { "sbb",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
d504 8
a511 8
  { "and",	Eb, Gb, XX },
  { "and",	Ev, Gv, XX },
  { "and",	Gb, Eb, XX },
  { "and",	Gv, Ev, XX },
  { "and",	AL, Ib, XX },
  { "and",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG ES prefix */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
d513 8
a520 8
  { "sub",	Eb, Gb, XX },
  { "sub",	Ev, Gv, XX },
  { "sub",	Gb, Eb, XX },
  { "sub",	Gv, Ev, XX },
  { "sub",	AL, Ib, XX },
  { "sub",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG CS prefix */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
d522 8
a529 8
  { "xor",	Eb, Gb, XX },
  { "xor",	Ev, Gv, XX },
  { "xor",	Gb, Eb, XX },
  { "xor",	Gv, Ev, XX },
  { "xor",	AL, Ib, XX },
  { "xor",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG SS prefix */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
d531 8
a538 8
  { "cmp",	Eb, Gb, XX },
  { "cmp",	Ev, Gv, XX },
  { "cmp",	Gb, Eb, XX },
  { "cmp",	Gv, Ev, XX },
  { "cmp",	AL, Ib, XX },
  { "cmp",	eAX, Iv, XX },
  { "(bad)",	XX, XX, XX },			/* SEG DS prefix */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
d540 8
a547 8
  { "(bad)",	XX, XX, XX },			/* REX prefix area.  */
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
d549 8
a556 8
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },
d558 8
a565 8
  { "push",	RMrAX, XX, XX },
  { "push",	RMrCX, XX, XX },
  { "push",	RMrDX, XX, XX },
  { "push",	RMrBX, XX, XX },
  { "push",	RMrSP, XX, XX },
  { "push",	RMrBP, XX, XX },
  { "push",	RMrSI, XX, XX },
  { "push",	RMrDI, XX, XX },
d567 8
a574 8
  { "pop",	RMrAX, XX, XX },
  { "pop",	RMrCX, XX, XX },
  { "pop",	RMrDX, XX, XX },
  { "pop",	RMrBX, XX, XX },
  { "pop",	RMrSP, XX, XX },
  { "pop",	RMrBP, XX, XX },
  { "pop",	RMrSI, XX, XX },
  { "pop",	RMrDI, XX, XX },
d576 8
a583 8
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "movsx",	Gv, Ed, XX },
  { "(bad)",	XX, XX, XX },			/* seg fs */
  { "(bad)",	XX, XX, XX },			/* seg gs */
  { "(bad)",	XX, XX, XX },			/* op size prefix */
  { "(bad)",	XX, XX, XX },			/* adr size prefix */
d585 8
a592 8
  { "push",	Iq, XX, XX },		/* 386 book wrong */
  { "imul",	Gv, Ev, Iv },
  { "push",	sIb, XX, XX },	/* push of byte really pushes 2 or 4 bytes */
  { "imul",	Gv, Ev, sIb },
  { "ins",	Yb, indirDX, XX },
  { "ins",	Yv, indirDX, XX },
  { "outs",	indirDX, Xb, XX },
  { "outs",	indirDX, Xv, XX },
d594 8
a601 8
  { "jo",	Jb, XX, XX },
  { "jno",	Jb, XX, XX },
  { "jb",	Jb, XX, XX },
  { "jae",	Jb, XX, XX },
  { "je",	Jb, XX, XX },
  { "jne",	Jb, XX, XX },
  { "jbe",	Jb, XX, XX },
  { "ja",	Jb, XX, XX },
d603 8
a610 8
  { "js",	Jb, XX, XX },
  { "jns",	Jb, XX, XX },
  { "jp",	Jb, XX, XX },
  { "jnp",	Jb, XX, XX },
  { "jl",	Jb, XX, XX },
  { "jge",	Jb, XX, XX },
  { "jle",	Jb, XX, XX },
  { "jg",	Jb, XX, XX },
d614 1
a614 1
  { "(bad)",	XX, XX, XX },
d616 4
a619 4
  { "test",	Eb, Gb, XX },
  { "test",	Ev, Gv, XX },
  { "xchg",	Eb, Gb, XX },
  { "xchg",	Ev, Gv, XX },
d621 8
a628 8
  { "mov",	Eb, Gb, XX },
  { "mov",	Ev, Gv, XX },
  { "mov",	Gb, Eb, XX },
  { "mov",	Gv, Ev, XX },
  { "mov",	Ev, Sw, XX },
  { "lea",	Gv, M, XX },
  { "mov",	Sw, Ev, XX },
  { "pop",	Ev, XX, XX },
d630 1
a630 1
  { "nop",	XX, XX, XX },
d632 7
a638 7
  { "xchg",	RMeCX, eAX, XX },
  { "xchg",	RMeDX, eAX, XX },
  { "xchg",	RMeBX, eAX, XX },
  { "xchg",	RMeSP, eAX, XX },
  { "xchg",	RMeBP, eAX, XX },
  { "xchg",	RMeSI, eAX, XX },
  { "xchg",	RMeDI, eAX, XX },
d640 8
a647 8
  { "cW",	XX, XX, XX },		/* cwde and cbw */
  { "cR",	XX, XX, XX },		/* cdq and cwd */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "(bad)",	XX, XX, XX },		/* fwait */
  { "pushf",	XX, XX, XX },
  { "popf",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
d649 8
a656 8
  { "mov",	AL, Ob, XX },
  { "mov",	eAX, Ov, XX },
  { "mov",	Ob, AL, XX },
  { "mov",	Ov, eAX, XX },
  { "movs",	Yb, Xb, XX },
  { "movs",	Yv, Xv, XX },
  { "cmps",	Xb, Yb, XX },
  { "cmps",	Xv, Yv, XX },
d658 8
a665 8
  { "test",	AL, Ib, XX },
  { "test",	eAX, Iv, XX },
  { "stos",	Yb, AL, XX },
  { "stos",	Yv, eAX, XX },
  { "lods",	AL, Xb, XX },
  { "lods",	eAX, Xv, XX },
  { "scas",	AL, Yb, XX },
  { "scas",	eAX, Yv, XX },
d667 8
a674 8
  { "mov",	RMAL, Ib, XX },
  { "mov",	RMCL, Ib, XX },
  { "mov",	RMDL, Ib, XX },
  { "mov",	RMBL, Ib, XX },
  { "mov",	RMAH, Ib, XX },
  { "mov",	RMCH, Ib, XX },
  { "mov",	RMDH, Ib, XX },
  { "mov",	RMBH, Ib, XX },
d676 8
a683 8
  { "mov",	RMeAX, Iv, XX },
  { "mov",	RMeCX, Iv, XX },
  { "mov",	RMeDX, Iv, XX },
  { "mov",	RMeBX, Iv, XX },
  { "mov",	RMeSP, Iv, XX },
  { "mov",	RMeBP, Iv, XX },
  { "mov",	RMeSI, Iv, XX },
  { "mov",	RMeDI, Iv, XX },
d687 6
a692 6
  { "ret",	Iw, XX, XX },
  { "ret",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "lds",	Gv, Mp, XX },
  { "mov",	Eb, Ib, XX },
  { "mov",	Ev, Iv, XX },
d694 8
a701 8
  { "enter",	Iw, Ib, XX },
  { "leave",	XX, XX, XX },
  { "lret",	Iw, XX, XX },
  { "lret",	XX, XX, XX },
  { "int3",	XX, XX, XX },
  { "int",	Ib, XX, XX },
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "iret",	XX, XX, XX },
d707 4
a710 4
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "xlat",	DSBX, XX, XX },
d721 8
a728 8
  { "loopne",	Jb, XX, XX },
  { "loope",	Jb, XX, XX },
  { "loop",	Jb, XX, XX },
  { "jEcxz",	Jb, XX, XX },
  { "in",	AL, Ib, XX },
  { "in",	eAX, Ib, XX },
  { "out",	Ib, AL, XX },
  { "out",	Ib, eAX, XX },
d730 8
a737 8
  { "call",	Jv, XX, XX },
  { "jmp",	Jv, XX, XX },
  { "(bad)",	XX, XX, XX },   /* Reserved.  */
  { "jmp",	Jb, XX, XX },
  { "in",	AL, indirDX, XX },
  { "in",	eAX, indirDX, XX },
  { "out",	indirDX, AL, XX },
  { "out",	indirDX, eAX, XX },
d739 6
a744 6
  { "(bad)",	XX, XX, XX },			/* lock prefix */
  { "(bad)",	XX, XX, XX },
  { "(bad)",	XX, XX, XX },			/* repne */
  { "(bad)",	XX, XX, XX },			/* repz */
  { "hlt",	XX, XX, XX },
  { "cmc",	XX, XX, XX },
d748 6
a753 6
  { "clc",	XX, XX, XX },
  { "stc",	XX, XX, XX },
  { "cli",	XX, XX, XX },
  { "sti",	XX, XX, XX },
  { "cld",	XX, XX, XX },
  { "std",	XX, XX, XX },
d758 1
a758 1
static const struct dis386 dis386_twobyte_att[] = {
d762 6
a767 6
  { "larS", Gv, Ew, XX },
  { "lslS", Gv, Ew, XX },
  { "(bad)", XX, XX, XX },
  { "syscall", XX, XX, XX },
  { "clts", XX, XX, XX },
  { "sysretP", XX, XX, XX },
d769 5
a773 5
  { "invd", XX, XX, XX },
  { "wbinvd", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "ud2a", XX, XX, XX },
  { "(bad)", XX, XX, XX },
d775 2
a776 2
  { "femms", XX, XX, XX },
  { "", MX, EM, OPSUF }, /* See OP_3DNowSuffix */
d780 6
a785 6
  { "movlpX", XM, EX, SIMD_Fixup, 'h' },  /* really only 2 operands */
  { "movlpX", EX, XM, SIMD_Fixup, 'h' },
  { "unpcklpX", XM, EX, XX },
  { "unpckhpX", XM, EX, XX },
  { "movhpX", XM, EX, SIMD_Fixup, 'l' },
  { "movhpX", EX, XM, SIMD_Fixup, 'l' },
d788 7
a794 7
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
d796 8
a803 9
  /* these are all backward in appendix A of the intel book */
  { "movL", Rm, Cm, XX },
  { "movL", Rm, Dm, XX },
  { "movL", Cm, Rm, XX },
  { "movL", Dm, Rm, XX },
  { "movL", Rd, Td, XX },
  { "(bad)", XX, XX, XX },
  { "movL", Td, Rd, XX },
  { "(bad)", XX, XX, XX },
d805 2
a806 2
  { "movapX", XM, EX, XX },
  { "movapX", EX, XM, XX },
d808 1
a808 1
  { "movntpX", Ev, XM, XX },
d811 2
a812 2
  { "ucomisX", XM,EX, XX },
  { "comisX", XM,EX, XX },
d814 8
a821 8
  { "wrmsr", XX, XX, XX },
  { "rdtsc", XX, XX, XX },
  { "rdmsr", XX, XX, XX },
  { "rdpmc", XX, XX, XX },
  { "sysenter", XX, XX, XX },
  { "sysexit", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
d823 8
a830 8
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
d832 8
a839 8
  { "cmovo", Gv, Ev, XX },
  { "cmovno", Gv, Ev, XX },
  { "cmovb", Gv, Ev, XX },
  { "cmovae", Gv, Ev, XX },
  { "cmove", Gv, Ev, XX },
  { "cmovne", Gv, Ev, XX },
  { "cmovbe", Gv, Ev, XX },
  { "cmova", Gv, Ev, XX },
d841 8
a848 8
  { "cmovs", Gv, Ev, XX },
  { "cmovns", Gv, Ev, XX },
  { "cmovp", Gv, Ev, XX },
  { "cmovnp", Gv, Ev, XX },
  { "cmovl", Gv, Ev, XX },
  { "cmovge", Gv, Ev, XX },
  { "cmovle", Gv, Ev, XX },
  { "cmovg", Gv, Ev, XX },
d850 1
a850 1
  { "movmskpX", Gd, XS, XX },
d854 4
a857 4
  { "andpX", XM, EX, XX },
  { "andnpX", XM, EX, XX },
  { "orpX", XM, EX, XX },
  { "xorpX", XM, EX, XX },
d868 8
a875 8
  { "punpcklbw", MX, EM, XX },
  { "punpcklwd", MX, EM, XX },
  { "punpckldq", MX, EM, XX },
  { "packsswb", MX, EM, XX },
  { "pcmpgtb", MX, EM, XX },
  { "pcmpgtw", MX, EM, XX },
  { "pcmpgtd", MX, EM, XX },
  { "packuswb", MX, EM, XX },
d877 4
a880 4
  { "punpckhbw", MX, EM, XX },
  { "punpckhwd", MX, EM, XX },
  { "punpckhdq", MX, EM, XX },
  { "packssdw", MX, EM, XX },
d883 1
a883 1
  { "movd", MX, Ed, XX },
d890 4
a893 4
  { "pcmpeqb", MX, EM, XX },
  { "pcmpeqw", MX, EM, XX },
  { "pcmpeqd", MX, EM, XX },
  { "emms", XX, XX, XX },
d895 6
a900 6
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
d904 8
a911 8
  { "joH",  Jv, cond_jump_flag, XX },
  { "jnoH", Jv, cond_jump_flag, XX },
  { "jbH",  Jv, cond_jump_flag, XX },
  { "jaeH", Jv, cond_jump_flag, XX },
  { "jeH",  Jv, cond_jump_flag, XX },
  { "jneH", Jv, cond_jump_flag, XX },
  { "jbeH", Jv, cond_jump_flag, XX },
  { "jaH",  Jv, cond_jump_flag, XX },
d913 8
a920 8
  { "jsH",  Jv, cond_jump_flag, XX },
  { "jnsH", Jv, cond_jump_flag, XX },
  { "jpH",  Jv, cond_jump_flag, XX },
  { "jnpH", Jv, cond_jump_flag, XX },
  { "jlH",  Jv, cond_jump_flag, XX },
  { "jgeH", Jv, cond_jump_flag, XX },
  { "jleH", Jv, cond_jump_flag, XX },
  { "jgH",  Jv, cond_jump_flag, XX },
d922 8
a929 8
  { "seto", Eb, XX, XX },
  { "setno", Eb, XX, XX },
  { "setb", Eb, XX, XX },
  { "setae", Eb, XX, XX },
  { "sete", Eb, XX, XX },
  { "setne", Eb, XX, XX },
  { "setbe", Eb, XX, XX },
  { "seta", Eb, XX, XX },
d931 8
a938 8
  { "sets", Eb, XX, XX },
  { "setns", Eb, XX, XX },
  { "setp", Eb, XX, XX },
  { "setnp", Eb, XX, XX },
  { "setl", Eb, XX, XX },
  { "setge", Eb, XX, XX },
  { "setle", Eb, XX, XX },
  { "setg", Eb, XX, XX },
d940 8
a947 8
  { "pushI", fs, XX, XX },
  { "popI", fs, XX, XX },
  { "cpuid", XX, XX, XX },
  { "btS", Ev, Gv, XX },
  { "shldS", Ev, Gv, Ib },
  { "shldS", Ev, Gv, CL },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
d949 6
a954 6
  { "pushI", gs, XX, XX },
  { "popI", gs, XX, XX },
  { "rsm", XX, XX, XX },
  { "btsS", Ev, Gv, XX },
  { "shrdS", Ev, Gv, Ib },
  { "shrdS", Ev, Gv, CL },
d956 1
a956 1
  { "imulS", Gv, Ev, XX },
d958 8
a965 8
  { "cmpxchgB", Eb, Gb, XX },
  { "cmpxchgS", Ev, Gv, XX },
  { "lssS", Gv, Mp, XX },
  { "btrS", Ev, Gv, XX },
  { "lfsS", Gv, Mp, XX },
  { "lgsS", Gv, Mp, XX },
  { "movzbR", Gv, Eb, XX },
  { "movzwR", Gv, Ew, XX }, /* yes, there really is movzww ! */
d967 2
a968 2
  { "(bad)", XX, XX, XX },
  { "ud2b", XX, XX, XX },
d970 5
a974 5
  { "btcS", Ev, Gv, XX },
  { "bsfS", Gv, Ev, XX },
  { "bsrS", Gv, Ev, XX },
  { "movsbR", Gv, Eb, XX },
  { "movswR", Gv, Ew, XX }, /* yes, there really is movsww ! */
d976 2
a977 2
  { "xaddB", Eb, Gb, XX },
  { "xaddS", Ev, Gv, XX },
d979 4
a982 4
  { "movntiS", Ev, Gv, XX },
  { "pinsrw", MX, Ed, Ib },
  { "pextrw", Gd, MS, Ib },
  { "shufpX", XM, EX, Ib },
d985 8
a992 8
  { "bswap", RMeAX, XX, XX },	/* bswap doesn't support 16 bit regs */
  { "bswap", RMeCX, XX, XX },
  { "bswap", RMeDX, XX, XX },
  { "bswap", RMeBX, XX, XX },
  { "bswap", RMeSP, XX, XX },
  { "bswap", RMeBP, XX, XX },
  { "bswap", RMeSI, XX, XX },
  { "bswap", RMeDI, XX, XX },
d994 6
a999 6
  { "(bad)", XX, XX, XX },
  { "psrlw", MX, EM, XX },
  { "psrld", MX, EM, XX },
  { "psrlq", MX, EM, XX },
  { "paddq", MX, EM, XX },
  { "pmullw", MX, EM, XX },
d1001 1
a1001 1
  { "pmovmskb", Gd, MS, XX },
d1003 8
a1010 8
  { "psubusb", MX, EM, XX },
  { "psubusw", MX, EM, XX },
  { "pminub", MX, EM, XX },
  { "pand", MX, EM, XX },
  { "paddusb", MX, EM, XX },
  { "paddusw", MX, EM, XX },
  { "pmaxub", MX, EM, XX },
  { "pandn", MX, EM, XX },
d1012 6
a1017 6
  { "pavgb", MX, EM, XX },
  { "psraw", MX, EM, XX },
  { "psrad", MX, EM, XX },
  { "pavgw", MX, EM, XX },
  { "pmulhuw", MX, EM, XX },
  { "pmulhw", MX, EM, XX },
d1021 8
a1028 8
  { "psubsb", MX, EM, XX },
  { "psubsw", MX, EM, XX },
  { "pminsw", MX, EM, XX },
  { "por", MX, EM, XX },
  { "paddsb", MX, EM, XX },
  { "paddsw", MX, EM, XX },
  { "pmaxsw", MX, EM, XX },
  { "pxor", MX, EM, XX },
d1030 7
a1036 7
  { "(bad)", XX, XX, XX },
  { "psllw", MX, EM, XX },
  { "pslld", MX, EM, XX },
  { "psllq", MX, EM, XX },
  { "pmuludq", MX, EM, XX },
  { "pmaddwd", MX, EM, XX },
  { "psadbw", MX, EM, XX },
d1039 8
a1046 300
  { "psubb", MX, EM, XX },
  { "psubw", MX, EM, XX },
  { "psubd", MX, EM, XX },
  { "psubq", MX, EM, XX },
  { "paddb", MX, EM, XX },
  { "paddw", MX, EM, XX },
  { "paddd", MX, EM, XX },
  { "(bad)", XX, XX, XX }
};

static const struct dis386 dis386_twobyte_intel[] = {
  /* 00 */
  { GRP6 },
  { GRP7 },
  { "lar", Gv, Ew, XX },
  { "lsl", Gv, Ew, XX },
  { "(bad)", XX, XX, XX },
  { "syscall", XX, XX, XX },
  { "clts", XX, XX, XX },
  { "sysretP", XX, XX, XX },
  /* 08 */
  { "invd", XX, XX, XX },
  { "wbinvd", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "ud2a", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { GRPAMD },
  { "femms" , XX, XX, XX},
  { "", MX, EM, OPSUF }, /* See OP_3DNowSuffix */
  /* 10 */
  { PREGRP8 },
  { PREGRP9 },
  { "movlpX", XM, EX, SIMD_Fixup, 'h' },  /* really only 2 operands */
  { "movlpX", EX, XM, SIMD_Fixup, 'h' },
  { "unpcklpX", XM, EX, XX },
  { "unpckhpX", XM, EX, XX },
  { "movhpX", XM, EX, SIMD_Fixup, 'l' },
  { "movhpX", EX, XM, SIMD_Fixup, 'l' },
  /* 18 */
  { GRP14 },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  /* 20 */
  /* these are all backward in appendix A of the intel book */
  { "mov", Rm, Cm, XX },
  { "mov", Rm, Dm, XX },
  { "mov", Cm, Rm, XX },
  { "mov", Dm, Rm, XX },
  { "mov", Rd, Td, XX },
  { "(bad)", XX, XX, XX },
  { "mov", Td, Rd, XX },
  { "(bad)", XX, XX, XX },
  /* 28 */
  { "movapX", XM, EX, XX },
  { "movapX", EX, XM, XX },
  { PREGRP2 },
  { "movntpX", Ev, XM, XX },
  { PREGRP4 },
  { PREGRP3 },
  { "ucomisX", XM,EX, XX },
  { "comisX", XM,EX, XX },
  /* 30 */
  { "wrmsr", XX, XX, XX },
  { "rdtsc", XX, XX, XX },
  { "rdmsr", XX, XX, XX },
  { "rdpmc", XX, XX, XX },
  { "sysenter", XX, XX, XX },
  { "sysexit", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  /* 38 */
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  /* 40 */
  { "cmovo", Gv, Ev, XX },
  { "cmovno", Gv, Ev, XX },
  { "cmovb", Gv, Ev, XX },
  { "cmovae", Gv, Ev, XX },
  { "cmove", Gv, Ev, XX },
  { "cmovne", Gv, Ev, XX },
  { "cmovbe", Gv, Ev, XX },
  { "cmova", Gv, Ev, XX },
  /* 48 */
  { "cmovs", Gv, Ev, XX },
  { "cmovns", Gv, Ev, XX },
  { "cmovp", Gv, Ev, XX },
  { "cmovnp", Gv, Ev, XX },
  { "cmovl", Gv, Ev, XX },
  { "cmovge", Gv, Ev, XX },
  { "cmovle", Gv, Ev, XX },
  { "cmovg", Gv, Ev, XX },
  /* 50 */
  { "movmskpX", Gd, XS, XX },
  { PREGRP13 },
  { PREGRP12 },
  { PREGRP11 },
  { "andpX", XM, EX, XX },
  { "andnpX", XM, EX, XX },
  { "orpX", XM, EX, XX },
  { "xorpX", XM, EX, XX },
  /* 58 */
  { PREGRP0 },
  { PREGRP10 },
  { PREGRP17 },
  { PREGRP16 },
  { PREGRP14 },
  { PREGRP7 },
  { PREGRP5 },
  { PREGRP6 },
  /* 60 */
  { "punpcklbw", MX, EM, XX },
  { "punpcklwd", MX, EM, XX },
  { "punpckldq", MX, EM, XX },
  { "packsswb", MX, EM, XX },
  { "pcmpgtb", MX, EM, XX },
  { "pcmpgtw", MX, EM, XX },
  { "pcmpgtd", MX, EM, XX },
  { "packuswb", MX, EM, XX },
  /* 68 */
  { "punpckhbw", MX, EM, XX },
  { "punpckhwd", MX, EM, XX },
  { "punpckhdq", MX, EM, XX },
  { "packssdw", MX, EM, XX },
  { PREGRP26 },
  { PREGRP24 },
  { "movd", MX, Ed, XX },
  { PREGRP19 },
  /* 70 */
  { PREGRP22 },
  { GRP10 },
  { GRP11 },
  { GRP12 },
  { "pcmpeqb", MX, EM, XX },
  { "pcmpeqw", MX, EM, XX },
  { "pcmpeqd", MX, EM, XX },
  { "emms", XX, XX, XX },
  /* 78 */
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  { PREGRP23 },
  { PREGRP20 },
  /* 80 */
  { "jo", Jv, XX, XX },
  { "jno", Jv, XX, XX },
  { "jb", Jv, XX, XX },
  { "jae", Jv, XX, XX },
  { "je", Jv, XX, XX },
  { "jne", Jv, XX, XX },
  { "jbe", Jv, XX, XX },
  { "ja", Jv, XX, XX },
  /* 88 */
  { "js", Jv, XX, XX },
  { "jns", Jv, XX, XX },
  { "jp", Jv, XX, XX },
  { "jnp", Jv, XX, XX },
  { "jl", Jv, XX, XX },
  { "jge", Jv, XX, XX },
  { "jle", Jv, XX, XX },
  { "jg", Jv, XX, XX },
  /* 90 */
  { "seto", Eb, XX, XX },
  { "setno", Eb, XX, XX },
  { "setb", Eb, XX, XX },
  { "setae", Eb, XX, XX },
  { "sete", Eb, XX, XX },
  { "setne", Eb, XX, XX },
  { "setbe", Eb, XX, XX },
  { "seta", Eb, XX, XX },
  /* 98 */
  { "sets", Eb, XX, XX },
  { "setns", Eb, XX, XX },
  { "setp", Eb, XX, XX },
  { "setnp", Eb, XX, XX },
  { "setl", Eb, XX, XX },
  { "setge", Eb, XX, XX },
  { "setle", Eb, XX, XX },
  { "setg", Eb, XX, XX },
  /* a0 */
  { "push", fs, XX, XX },
  { "pop", fs, XX, XX },
  { "cpuid", XX, XX, XX },
  { "bt", Ev, Gv, XX },
  { "shld", Ev, Gv, Ib },
  { "shld", Ev, Gv, CL },
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
  /* a8 */
  { "push", gs, XX, XX },
  { "pop", gs, XX, XX },
  { "rsm" , XX, XX, XX},
  { "bts", Ev, Gv, XX },
  { "shrd", Ev, Gv, Ib },
  { "shrd", Ev, Gv, CL },
  { GRP13 },
  { "imul", Gv, Ev, XX },
  /* b0 */
  { "cmpxchg", Eb, Gb, XX },
  { "cmpxchg", Ev, Gv, XX },
  { "lss", Gv, Mp, XX },
  { "btr", Ev, Gv, XX },
  { "lfs", Gv, Mp, XX },
  { "lgs", Gv, Mp, XX },
  { "movzx", Gv, Eb, XX },
  { "movzx", Gv, Ew, XX },
  /* b8 */
  { "(bad)", XX, XX, XX },
  { "ud2b", XX, XX, XX },
  { GRP8 },
  { "btc", Ev, Gv, XX },
  { "bsf", Gv, Ev, XX },
  { "bsr", Gv, Ev, XX },
  { "movsx", Gv, Eb, XX },
  { "movsx", Gv, Ew, XX },
  /* c0 */
  { "xadd", Eb, Gb, XX },
  { "xadd", Ev, Gv, XX },
  { PREGRP1 },
  { "movnti", Ev, Gv, XX },
  { "pinsrw", MX, Ed, Ib },
  { "pextrw", Gd, MS, Ib },
  { "shufpX", XM, EX, Ib },
  { GRP9 },
  /* c8 */
  { "bswap", RMeAX, XX, XX },	/* bswap doesn't support 16 bit regs */
  { "bswap", RMeCX, XX, XX },
  { "bswap", RMeDX, XX, XX },
  { "bswap", RMeBX, XX, XX },
  { "bswap", RMeSP, XX, XX },
  { "bswap", RMeBP, XX, XX },
  { "bswap", RMeSI, XX, XX },
  { "bswap", RMeDI, XX, XX },
  /* d0 */
  { "(bad)", XX, XX, XX },
  { "psrlw", MX, EM, XX },
  { "psrld", MX, EM, XX },
  { "psrlq", MX, EM, XX },
  { "paddq", MX, EM, XX },
  { "pmullw", MX, EM, XX },
  { PREGRP21 },
  { "pmovmskb", Gd, MS, XX },
  /* d8 */
  { "psubusb", MX, EM, XX },
  { "psubusw", MX, EM, XX },
  { "pminub", MX, EM, XX },
  { "pand", MX, EM, XX },
  { "paddusb", MX, EM, XX },
  { "paddusw", MX, EM, XX },
  { "pmaxub", MX, EM, XX },
  { "pandn", MX, EM, XX },
  /* e0 */
  { "pavgb", MX, EM, XX },
  { "psraw", MX, EM, XX },
  { "psrad", MX, EM, XX },
  { "pavgw", MX, EM, XX },
  { "pmulhuw", MX, EM, XX },
  { "pmulhw", MX, EM, XX },
  { PREGRP15 },
  { PREGRP25 },
  /* e8 */
  { "psubsb", MX, EM, XX },
  { "psubsw", MX, EM, XX },
  { "pminsw", MX, EM, XX },
  { "por", MX, EM, XX },
  { "paddsb", MX, EM, XX },
  { "paddsw", MX, EM, XX },
  { "pmaxsw", MX, EM, XX },
  { "pxor", MX, EM, XX },
  /* f0 */
  { "(bad)", XX, XX, XX },
  { "psllw", MX, EM, XX },
  { "pslld", MX, EM, XX },
  { "psllq", MX, EM, XX },
  { "pmuludq", MX, EM, XX },
  { "pmaddwd", MX, EM, XX },
  { "psadbw", MX, EM, XX },
  { PREGRP18 },
  /* f8 */
  { "psubb", MX, EM, XX },
  { "psubw", MX, EM, XX },
  { "psubd", MX, EM, XX },
  { "psubq", MX, EM, XX },
  { "paddb", MX, EM, XX },
  { "paddw", MX, EM, XX },
  { "paddd", MX, EM, XX },
  { "(bad)", XX, XX, XX }
a1128 1
static void oappend PARAMS ((const char *s));
d1298 5
a1302 5
    { "callI",	indirEv, XX, XX },
    { "lcallI",	indirEv, XX, XX },
    { "jmpI",	indirEv, XX, XX },
    { "ljmpI",	indirEv, XX, XX },
    { "pushT",	Ev, XX, XX },
d1611 7
a1802 3
static int print_insn_i386
  PARAMS ((bfd_vma pc, disassemble_info *info));

d1938 1
a1938 4
      if (intel_syntax)
        dp = &dis386_twobyte_intel[*++codep];
      else
        dp = &dis386_twobyte_att[*++codep];
d1944 1
a1944 10
      if (intel_syntax)
	if (mode_64bit)
	  dp = &dis386_64_intel[*codep];
	else
	  dp = &dis386_intel[*codep];
      else
	if (mode_64bit)
	  dp = &disx86_64_att[*codep];
	else
	  dp = &dis386_att[*codep];
d1969 1
a1969 1
      if (dp->bytemode2 != loop_jcxz_mode)
d1982 3
a1984 1
      if (dp->bytemode2 == cond_jump_mode && dp->bytemode1 == v_mode)
a2000 6
  else
    {
      mod = 0;
      reg = 0;
      rm = 0;
    }
d2011 1
a2011 1
	  switch(dp->bytemode2)
d2013 31
a2043 25
	      case USE_GROUPS:
	        dp = &grps[dp->bytemode1][reg];
		break;
	      case USE_PREFIX_USER_TABLE:
		index = 0;
		used_prefixes |= (prefixes & PREFIX_REPZ);
		if (prefixes & PREFIX_REPZ)
		  index = 1;
		else
		  {
		    used_prefixes |= (prefixes & PREFIX_DATA);
		    if (prefixes & PREFIX_DATA)
		      index = 2;
		    else
		      {
			used_prefixes |= (prefixes & PREFIX_REPNZ);
			if (prefixes & PREFIX_REPNZ)
			  index = 3;
		      }
		  }
		dp = &prefix_user_table[dp->bytemode1][index];
		break;
	      default:
		oappend (INTERNAL_DISASSEMBLER_ERROR);
		break;
d2047 17
a2063 16
      putop (dp->name, sizeflag);

      obufp = op1out;
      op_ad = 2;
      if (dp->op1)
	(*dp->op1)(dp->bytemode1, sizeflag);

      obufp = op2out;
      op_ad = 1;
      if (dp->op2)
	(*dp->op2)(dp->bytemode2, sizeflag);

      obufp = op3out;
      op_ad = 0;
      if (dp->op3)
	(*dp->op3)(dp->bytemode3, sizeflag);
d2150 1
a2150 76
static const char *float_mem_att[] = {
  /* d8 */
  "fadds",
  "fmuls",
  "fcoms",
  "fcomps",
  "fsubs",
  "fsubrs",
  "fdivs",
  "fdivrs",
  /*  d9 */
  "flds",
  "(bad)",
  "fsts",
  "fstps",
  "fldenv",
  "fldcw",
  "fNstenv",
  "fNstcw",
  /* da */
  "fiaddl",
  "fimull",
  "ficoml",
  "ficompl",
  "fisubl",
  "fisubrl",
  "fidivl",
  "fidivrl",
  /* db */
  "fildl",
  "(bad)",
  "fistl",
  "fistpl",
  "(bad)",
  "fldt",
  "(bad)",
  "fstpt",
  /* dc */
  "faddl",
  "fmull",
  "fcoml",
  "fcompl",
  "fsubl",
  "fsubrl",
  "fdivl",
  "fdivrl",
  /* dd */
  "fldl",
  "(bad)",
  "fstl",
  "fstpl",
  "frstor",
  "(bad)",
  "fNsave",
  "fNstsw",
  /* de */
  "fiadd",
  "fimul",
  "ficom",
  "ficomp",
  "fisub",
  "fisubr",
  "fidiv",
  "fidivr",
  /* df */
  "fild",
  "(bad)",
  "fist",
  "fistp",
  "fbld",
  "fildll",
  "fbstp",
  "fistpll",
};

static const char *float_mem_intel[] = {
d2152 8
a2159 8
  "fadd",
  "fmul",
  "fcom",
  "fcomp",
  "fsub",
  "fsubr",
  "fdiv",
  "fdivr",
d2161 1
a2161 1
  "fld",
d2163 2
a2164 2
  "fst",
  "fstp",
d2170 8
a2177 8
  "fiadd",
  "fimul",
  "ficom",
  "ficomp",
  "fisub",
  "fisubr",
  "fidiv",
  "fidivr",
d2179 1
a2179 1
  "fild",
d2181 2
a2182 2
  "fist",
  "fistp",
d2184 1
a2184 1
  "fld",
d2186 1
a2186 1
  "fstp",
d2188 8
a2195 8
  "fadd",
  "fmul",
  "fcom",
  "fcomp",
  "fsub",
  "fsubr",
  "fdiv",
  "fdivr",
d2197 1
a2197 1
  "fld",
d2199 2
a2200 2
  "fst",
  "fstp",
d2220 1
a2220 1
  "fild",
d2403 1
a2403 4
      if (intel_syntax)
        putop (float_mem_intel[(floatop - 0xd8 ) * 8 + reg], sizeflag);
      else
        putop (float_mem_att[(floatop - 0xd8 ) * 8 + reg], sizeflag);
a2438 1
/* ARGSUSED */
d2440 2
a2441 2
OP_ST (ignore, sizeflag)
     int ignore ATTRIBUTE_UNUSED;
a2446 1
/* ARGSUSED */
d2448 2
a2449 2
OP_STi (ignore, sizeflag)
     int ignore ATTRIBUTE_UNUSED;
a2455 1

d2457 1
a2457 1
static void
d2463 1
d2472 32
d2528 2
d2544 2
a2557 21
	case 'I':
          if (intel_syntax)
            break;
	  if (mode_64bit)
	    *obufp++ = 'q';
	  else
	    {
	      if ((prefixes & PREFIX_DATA)
#ifdef SUFFIX_ALWAYS
		  || (sizeflag & SUFFIX_ALWAYS)
#endif
		  )
		{
		  if (sizeflag & DFLAG)
		    *obufp++ = 'l';
		  else
		    *obufp++ = 'w';
		  used_prefixes |= (prefixes & PREFIX_DATA);
	      }
	    }
	  break;
d2575 1
a2575 1
	      *obufp++ = 'o';
d2579 9
d2611 9
a2692 18
	case 'T':
          if (intel_syntax)
            break;
	  if (mode_64bit)
	    *obufp++ = 'q';
	  else if (mod != 3
#ifdef SUFFIX_ALWAYS
		   || (sizeflag & SUFFIX_ALWAYS)
#endif
		  )
	    {
	      if (sizeflag & DFLAG)
		*obufp++ = 'l';
	      else
		*obufp++ = 'w';
	      used_prefixes |= (prefixes & PREFIX_DATA);
	    }
	  break;
d2742 1
d3281 9
a3300 4
    case rAX_reg: case rCX_reg: case rDX_reg: case rBX_reg:
    case rSP_reg: case rBP_reg: case rSI_reg: case rDI_reg:
      s = names64[code - rAX_reg + add];
      break;
d3370 6
a3375 2
      op = get32s ();
      break;
d3416 6
a3549 1
/* ARGSUSED */
a3561 1
/* ARGSUSED */
a3583 1
/* ARGSUSED */
d3585 2
a3586 2
OP_OFF (ignored, sizeflag)
     int ignored ATTRIBUTE_UNUSED;
d3610 1
a3610 1
/* ARGSUSED */
d3612 2
a3613 2
OP_OFF64 (ignored, sizeflag)
     int ignored ATTRIBUTE_UNUSED;
d3618 6
a3684 1
/* ARGSUSED */
a3697 1
/* ARGSUSED */
a3710 1
/* ARGSUSED */
d3732 2
a3733 2
OP_MMX (ignore, sizeflag)
     int ignore ATTRIBUTE_UNUSED;
@


1.24
log
@	* i386-dis.c (cond_jump_flag, loop_jcxz_flag): Define.
	(cond_jump_mode, loop_jcxz_mode): Define.
	(dis386_att): Add cond_jump_flag and loop_jcxz_flag as
	appropriate, and 'F' suffix to loop insns.
	(disx86_64_att): Likewise.
	(dis386_twobyte_att): Likewise.
	(print_insn_i386): Don't output addr prefix for loop, jcxz insns.
	Output data size prefix for long conditional jumps.  Output cs and
	ds branch hints.
	(putop): Handle 'F', and mark PREFIX_ADDR used for case 'E'.
	(OP_J): Don't make PREFIX_DATA used.
@
text
@d439 1
d584 8
a591 8
  { "jo",	Jb, cond_jump_flag, XX },
  { "jno",	Jb, cond_jump_flag, XX },
  { "jb",	Jb, cond_jump_flag, XX },
  { "jae",	Jb, cond_jump_flag, XX },
  { "je",	Jb, cond_jump_flag, XX },
  { "jne",	Jb, cond_jump_flag, XX },
  { "jbe",	Jb, cond_jump_flag, XX },
  { "ja",	Jb, cond_jump_flag, XX },
d593 8
a600 8
  { "js",	Jb, cond_jump_flag, XX },
  { "jns",	Jb, cond_jump_flag, XX },
  { "jp",	Jb, cond_jump_flag, XX },
  { "jnp",	Jb, cond_jump_flag, XX },
  { "jl",	Jb, cond_jump_flag, XX },
  { "jge",	Jb, cond_jump_flag, XX },
  { "jle",	Jb, cond_jump_flag, XX },
  { "jg",	Jb, cond_jump_flag, XX },
d711 4
a714 4
  { "loopneF",	Jb, loop_jcxz_flag, XX },
  { "loopeF",	Jb, loop_jcxz_flag, XX },
  { "loopF",	Jb, loop_jcxz_flag, XX },
  { "jEcxz",	Jb, loop_jcxz_flag, XX },
d1170 8
a1177 8
  { "jo",	Jb, cond_jump_flag, XX },
  { "jno",	Jb, cond_jump_flag, XX },
  { "jb",	Jb, cond_jump_flag, XX },
  { "jae",	Jb, cond_jump_flag, XX },
  { "je",	Jb, cond_jump_flag, XX },
  { "jne",	Jb, cond_jump_flag, XX },
  { "jbe",	Jb, cond_jump_flag, XX },
  { "ja",	Jb, cond_jump_flag, XX },
d1179 8
a1186 8
  { "js",	Jb, cond_jump_flag, XX },
  { "jns",	Jb, cond_jump_flag, XX },
  { "jp",	Jb, cond_jump_flag, XX },
  { "jnp",	Jb, cond_jump_flag, XX },
  { "jl",	Jb, cond_jump_flag, XX },
  { "jge",	Jb, cond_jump_flag, XX },
  { "jle",	Jb, cond_jump_flag, XX },
  { "jg",	Jb, cond_jump_flag, XX },
d1297 4
a1300 4
  { "loopneF",	Jb, loop_jcxz_flag, XX },
  { "loopeF",	Jb, loop_jcxz_flag, XX },
  { "loopF",	Jb, loop_jcxz_flag, XX },
  { "jEcxz",	Jb, loop_jcxz_flag, XX },
d1773 8
a1780 8
  { "jo",  Jv, cond_jump_flag, XX },
  { "jno", Jv, cond_jump_flag, XX },
  { "jb",  Jv, cond_jump_flag, XX },
  { "jae", Jv, cond_jump_flag, XX },
  { "je",  Jv, cond_jump_flag, XX },
  { "jne", Jv, cond_jump_flag, XX },
  { "jbe", Jv, cond_jump_flag, XX },
  { "ja",  Jv, cond_jump_flag, XX },
d1782 8
a1789 8
  { "js",  Jv, cond_jump_flag, XX },
  { "jns", Jv, cond_jump_flag, XX },
  { "jp",  Jv, cond_jump_flag, XX },
  { "jnp", Jv, cond_jump_flag, XX },
  { "jl",  Jv, cond_jump_flag, XX },
  { "jge", Jv, cond_jump_flag, XX },
  { "jle", Jv, cond_jump_flag, XX },
  { "jg",  Jv, cond_jump_flag, XX },
a3161 14
  if (dp->bytemode2 == cond_jump_mode || dp->bytemode2 == loop_jcxz_mode)
    {
      if ((prefixes & (PREFIX_CS | PREFIX_DS)) == PREFIX_CS)
	{
	  oappend ("cs ");
	  used_prefixes |= PREFIX_CS;
	}
      if ((prefixes & (PREFIX_CS | PREFIX_DS)) == PREFIX_DS)
	{
	  oappend ("ds ");
	  used_prefixes |= PREFIX_DS;
	}
    }

d3756 13
d4408 4
a4411 3
  unsigned int a = 0;
  unsigned int b = 0;
  bfd_vma x = 0;
a4412 1
#ifdef BFD64
d4418 1
a4418 1
  b |= (*codep++ & 0xff);
d4425 1
@


1.23
log
@2001-05-12  H.J. Lu  <hjl@@gnu.org>

	* i386-dis.c (print_insn_i386): Always set `mod', `reg' and
	`rm'.
@
text
@d253 3
d318 2
d438 1
d583 8
a590 8
  { "jo",	Jb, XX, XX },
  { "jno",	Jb, XX, XX },
  { "jb",	Jb, XX, XX },
  { "jae",	Jb, XX, XX },
  { "je",	Jb, XX, XX },
  { "jne",	Jb, XX, XX },
  { "jbe",	Jb, XX, XX },
  { "ja",	Jb, XX, XX },
d592 8
a599 8
  { "js",	Jb, XX, XX },
  { "jns",	Jb, XX, XX },
  { "jp",	Jb, XX, XX },
  { "jnp",	Jb, XX, XX },
  { "jl",	Jb, XX, XX },
  { "jge",	Jb, XX, XX },
  { "jle",	Jb, XX, XX },
  { "jg",	Jb, XX, XX },
d710 4
a713 4
  { "loopne",	Jb, XX, XX },
  { "loope",	Jb, XX, XX },
  { "loop",	Jb, XX, XX },
  { "jEcxz",	Jb, XX, XX },
d1169 8
a1176 8
  { "jo",	Jb, XX, XX },
  { "jno",	Jb, XX, XX },
  { "jb",	Jb, XX, XX },
  { "jae",	Jb, XX, XX },
  { "je",	Jb, XX, XX },
  { "jne",	Jb, XX, XX },
  { "jbe",	Jb, XX, XX },
  { "ja",	Jb, XX, XX },
d1178 8
a1185 8
  { "js",	Jb, XX, XX },
  { "jns",	Jb, XX, XX },
  { "jp",	Jb, XX, XX },
  { "jnp",	Jb, XX, XX },
  { "jl",	Jb, XX, XX },
  { "jge",	Jb, XX, XX },
  { "jle",	Jb, XX, XX },
  { "jg",	Jb, XX, XX },
d1296 4
a1299 4
  { "loopne",	Jb, XX, XX },
  { "loope",	Jb, XX, XX },
  { "loop",	Jb, XX, XX },
  { "jEcxz",	Jb, XX, XX },
d1772 8
a1779 8
  { "jo", Jv, XX, XX },
  { "jno", Jv, XX, XX },
  { "jb", Jv, XX, XX },
  { "jae", Jv, XX, XX },
  { "je", Jv, XX, XX },
  { "jne", Jv, XX, XX },
  { "jbe", Jv, XX, XX },
  { "ja", Jv, XX, XX },
d1781 8
a1788 8
  { "js", Jv, XX, XX },
  { "jns", Jv, XX, XX },
  { "jp", Jv, XX, XX },
  { "jnp", Jv, XX, XX },
  { "jl", Jv, XX, XX },
  { "jge", Jv, XX, XX },
  { "jle", Jv, XX, XX },
  { "jg", Jv, XX, XX },
d3135 13
d3149 11
a3159 1
    sizeflag ^= DFLAG;
d3161 1
a3161 1
  if (prefixes & PREFIX_ADDR)
d3163 10
a3172 6
      sizeflag ^= AFLAG;
      if (sizeflag & AFLAG)
        oappend ("addr32 ");
      else
	oappend ("addr16 ");
      used_prefixes |= PREFIX_ADDR;
d3753 15
a4753 1
      used_prefixes |= (prefixes & PREFIX_DATA);
@


1.22
log
@	* i386-dis.c (twobyte_has_modrm): Update table.
	(need_modrm): Give it file scope.
	(MODRM_CHECK): Define.
	(dofloat): Use MODRM_CHECK.
	(OP_E): Likewise.
	(OP_EM): Likewise.
	(OP_EX): Likewise.
and fix testsuite yet again now that we are getting correct disassembly.
@
text
@d3149 6
@


1.21
log
@Correct cvtps2dq, movdq2q, movq2dq, and movq problems.
@
text
@d2231 1
a2231 1
  /* 20 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* 2f */
d2234 2
a2235 2
  /* 50 */ 1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1, /* 5f */
  /* 60 */ 1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1, /* 6f */
d2239 1
a2239 1
  /* a0 */ 0,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1, /* af */
d2242 3
a2244 3
  /* d0 */ 0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1, /* df */
  /* e0 */ 1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1, /* ef */
  /* f0 */ 0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,0  /* ff */
d2282 1
d2285 5
a2997 1
  unsigned char need_modrm;
d3632 2
d4048 1
d4938 2
d4964 2
@


1.20
log
@Assorted fixes to pinsrw, pextrw, pmovmskb, movmskp, maskmovq.
@
text
@d2719 1
a2719 1
    { "movq2dq", EX, EM, XX },
d2721 1
a2721 1
    { "movdq2q", EM, MX, XX },
d2733 1
a2733 1
    { "movq", Ed, XM, XX },
@


1.19
log
@	* i386-dis.c: Add ffreep instruction.
@
text
@a151 3
#define Gb OP_G, b_mode
#define Ev OP_E, v_mode
#define Ed OP_E, d_mode
d157 1
d159 1
d248 1
d290 1
d1712 1
a1712 1
  { "movmskpX", Gv, EX, XX },
d1842 2
a1843 2
  { "pinsrw", MX, Ev, Ib },
  { "pextrw", Ev, MX, Ib },
d1863 1
a1863 1
  { "pmovmskb", Ev, MX, XX },
d2004 1
a2004 1
  { "movmskpX", Gv, EX, XX },
d2134 2
a2135 2
  { "pinsrw", MX, Ev, Ib },
  { "pextrw", Ev, MX, Ib },
d2155 1
a2155 1
  { "pmovmskb", Ev, MX, XX },
d2697 1
a2697 1
    { "maskmovq", MX, EM, XX },
a3173 1

d4966 11
@


1.18
log
@Small tweaks to sse2 instructions.
@
text
@d1930 2
a1931 2
  { PREGRP8 },                                              
  { PREGRP9 },                                                               
d2299 1
a2299 1
  "%al","%cl","%dl","%bl","%spl", "%bpl", "%sil", "%dil", 
d3173 1
a3173 1
			
d3543 1
a3543 1
    { "(bad)",	XX, XX, XX },
d3763 1
a3763 1
	      else 
@


1.17
log
@paddq and psubq support.
@
text
@d412 2
d1742 1
a1742 1
  { "(bad)", XX, XX, XX },
d1880 1
a1880 1
  { "movntq", Ev, MX, XX },
d2034 1
a2034 1
  { "(bad)", XX, XX, XX },
d2172 1
a2172 1
  { "movntq", Ev, MX, XX },
d2698 1
a2698 1
    { "maskmovdqu", MX, EX, XX },
d2734 1
a2734 1
    { "(bad)", EX, XM, XX },
d2738 2
a2739 2
    { "(bad)", EX, XM, XX },
    { "(bad)", EX, XM, XX },
d2741 15
a2755 1
    { "(bad)", EX, XM, XX },
@


1.16
log
@Fix typos in ChangeLogs; fix dates in copyright notices
@
text
@d1857 1
a1857 1
  { "(bad)", XX, XX, XX },
d1901 1
a1901 1
  { "(bad)", XX, XX, XX },
d2149 1
a2149 1
  { "(bad)", XX, XX, XX },
d2193 1
a2193 1
  { "(bad)", XX, XX, XX },
d2239 1
a2239 1
  /* d0 */ 0,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1, /* df */
d2241 1
a2241 1
  /* f0 */ 0,1,1,1,0,1,1,1,1,1,1,0,1,1,1,0  /* ff */
@


1.15
log
@	* i386.h (i386_optab): SSE integer converison instructions have
	64bit versions on x86-64.
	* i386-dis.c (prefix_user_t): Add 'Y' to SSE ineger converison
	instructions.
	(putop): Handle 'Y'
@
text
@d2 2
a3 1
   Copyright (C) 1988, 89, 91, 93, 94, 95, 96, 97, 98, 1999
@


1.14
log
@	* (dis386_att, grps): Use 'T' for push/pop
	(putop): Handle 'T', alphabetize order, fix 'I' handling in Intel syntax
@
text
@d442 1
d2582 1
a2582 1
    { "cvtsi2ss", XM, Ev, XX },
d2584 1
a2584 1
    { "cvtsi2sd", XM, Ev, XX },
d2589 1
a2589 1
    { "cvtss2si", Gv, EX, XX },
d2591 1
a2591 1
    { "cvtsd2si", Gv, EX, XX },
d2596 1
a2596 1
    { "cvttss2si", Gv, EX, XX },
d2598 1
a2598 1
    { "cvttsd2si", Gv, EX, XX },
d3853 9
@


1.13
log
@
	* i386.c (md_assemble): Check cpu_flags even for nullary instructions.

	* i386.h (i386_optab): Fix pusha and ret templates.

	* i386-dis.c (dis386_att, disx86_64_att): Fix ret, lret and iret
	templates.
@
text
@d439 1
d606 1
a606 1
  { "popQ",	Ev, XX, XX },
d2446 1
a2446 1
    { "pushQ",	Ev, XX, XX },
d3690 21
a3755 1
	  USED_REX (REX_MODE64);
d3758 1
d3828 18
a3853 19
	case 'I':
	  if (mode_64bit)
	    *obufp++ = 'q';
	  else
	    {
	      if ((prefixes & PREFIX_DATA)
#ifdef SUFFIX_ALWAYS
		  || (sizeflag & SUFFIX_ALWAYS)
#endif
		  )
		{
		  if (sizeflag & DFLAG)
		    *obufp++ = 'l';
		  else
		    *obufp++ = 'w';
		  used_prefixes |= (prefixes & PREFIX_DATA);
	      }
	    }
	  break;
@


1.13.2.1
log
@
	* (dis386_att, grps): Use 'T' for push/pop
	(putop): Handle 'T', alphabetize order, fix 'I' handling in Intel syntax
@
text
@a438 1
   'T' => print 'q' in 64bit mode and behave as 'I' otherwise
d605 1
a605 1
  { "popT",	Ev, XX, XX },
d2445 1
a2445 1
    { "pushT",	Ev, XX, XX },
a3688 21
	case 'I':
          if (intel_syntax)
            break;
	  if (mode_64bit)
	    *obufp++ = 'q';
	  else
	    {
	      if ((prefixes & PREFIX_DATA)
#ifdef SUFFIX_ALWAYS
		  || (sizeflag & SUFFIX_ALWAYS)
#endif
		  )
		{
		  if (sizeflag & DFLAG)
		    *obufp++ = 'l';
		  else
		    *obufp++ = 'w';
		  used_prefixes |= (prefixes & PREFIX_DATA);
	      }
	    }
	  break;
d3734 1
a3736 1
	  USED_REX (REX_MODE64);
a3805 18
	case 'T':
          if (intel_syntax)
            break;
	  if (mode_64bit)
	    *obufp++ = 'q';
	  else if (mod != 3
#ifdef SUFFIX_ALWAYS
		   || (sizeflag & SUFFIX_ALWAYS)
#endif
		  )
	    {
	      if (sizeflag & DFLAG)
		*obufp++ = 'l';
	      else
		*obufp++ = 'w';
	      used_prefixes |= (prefixes & PREFIX_DATA);
	    }
	  break;
d3814 19
@


1.13.2.2
log
@
	* i386.h (i386_optab): SSE integer converison instructions have
	64bit versions on x86-64.
	* i386-dis.c (prefix_user_t): Add 'Y' to SSE ineger converison
	instructions.
	(putop): Handle 'Y'
@
text
@a441 1
   'Y' => 'q' if instruction has an REX 64bit overwrite prefix
d2581 1
a2581 1
    { "cvtsi2ssY", XM, Ev, XX },
d2583 1
a2583 1
    { "cvtsi2sdY", XM, Ev, XX },
d2588 1
a2588 1
    { "cvtss2siY", Gv, EX, XX },
d2590 1
a2590 1
    { "cvtsd2siY", Gv, EX, XX },
d2595 1
a2595 1
    { "cvttss2siY", Gv, EX, XX },
d2597 1
a2597 1
    { "cvttsd2siY", Gv, EX, XX },
a3851 9
	  break;
	case 'Y':
          if (intel_syntax)
            break;
	  if (rex & REX_MODE64)
	    {
	      USED_REX (REX_MODE64);
	      *obufp++ = 'q';
	    }
@


1.13.2.3
log
@paddq and psubq support.
@
text
@d2 1
a2 2
   Copyright 1988, 1989, 1991, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
   2001
d1856 1
a1856 1
  { "paddq", MX, EM, XX },
d1900 1
a1900 1
  { "psubq", MX, EM, XX },
d2148 1
a2148 1
  { "paddq", MX, EM, XX },
d2192 1
a2192 1
  { "psubq", MX, EM, XX },
d2238 1
a2238 1
  /* d0 */ 0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1, /* df */
d2240 1
a2240 1
  /* f0 */ 0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,0  /* ff */
@


1.13.2.4
log
@Small tweaks to sse2 instructions.
@
text
@a411 2
#define PREGRP25 NULL, NULL, 25, NULL, USE_PREFIX_USER_TABLE, NULL, 0
#define PREGRP26 NULL, NULL, 26, NULL, USE_PREFIX_USER_TABLE, NULL, 0
d1740 1
a1740 1
  { PREGRP26 },
d1878 1
a1878 1
  { PREGRP25 },
d2032 1
a2032 1
  { PREGRP26 },
d2170 1
a2170 1
  { PREGRP25 },
d2696 1
a2696 1
    { "maskmovdqu", XM, EX, XX },
d2732 1
a2732 1
    { "(bad)", Ed, XM, XX },
d2736 2
a2737 2
    { "(bad)", MX, EX, XX },
    { "(bad)", XM, EX, XX },
d2739 1
a2739 15
    { "(bad)", XM, EX, XX },
  },
  /* PREGRP25 */
  {
  { "movntq", Ev, MX, XX },
  { "(bad)", Ev, XM, XX },
  { "movntdq", Ev, XM, XX },
  { "(bad)", Ev, XM, XX },
  },
  /* PREGRP26 */
  {
    { "(bad)", MX, EX, XX },
    { "(bad)", XM, EX, XX },
    { "punpcklqdq", XM, EX, XX },
    { "(bad)", XM, EX, XX },
@


1.13.2.5
log
@Assorted fixes to pinsrw, pextrw, pmovmskb, movmskp, maskmovq.
Merge 2001-04-06 i386-dis.c ffreep addition.
@
text
@d152 3
a159 1
#define Gb OP_G, b_mode
a160 1
#define Gd OP_G, d_mode
a248 1
#define XS OP_XS, v_mode
a289 1
static void OP_XS PARAMS ((int, int));
d1711 1
a1711 1
  { "movmskpX", Gd, XS, XX },
d1841 2
a1842 2
  { "pinsrw", MX, Ed, Ib },
  { "pextrw", Gd, MS, Ib },
d1862 1
a1862 1
  { "pmovmskb", Gd, MS, XX },
d1930 2
a1931 2
  { PREGRP8 },
  { PREGRP9 },
d2003 1
a2003 1
  { "movmskpX", Gd, XS, XX },
d2133 2
a2134 2
  { "pinsrw", MX, Ed, Ib },
  { "pextrw", Gd, MS, Ib },
d2154 1
a2154 1
  { "pmovmskb", Gd, MS, XX },
d2299 1
a2299 1
  "%al","%cl","%dl","%bl","%spl", "%bpl", "%sil", "%dil",
d2696 1
a2696 1
    { "maskmovq", MX, MS, XX },
d3173 1
d3543 1
a3543 1
    { "ffreep",	STi, XX, XX },
d3763 1
a3763 1
	      else
a4965 11
  else
    BadOp();
}

static void
OP_XS (bytemode, sizeflag)
     int bytemode;
     int sizeflag;
{
  if (mod == 3)
    OP_EX (bytemode, sizeflag);
@


1.13.2.6
log
@Correct cvtps2dq, movdq2q, movq2dq, and movq problems.
@
text
@d2719 1
a2719 1
    { "movq2dq", XM, MS, XX },
d2721 1
a2721 1
    { "movdq2q", MX, XS, XX },
d2733 1
a2733 1
    { "movq", XM, EX, XX },
@


1.13.2.7
log
@	* i386-dis.c (twobyte_has_modrm): Update table.
	(need_modrm): Give it file scope.
	(MODRM_CHECK): Define.
	(dofloat): Use MODRM_CHECK.
	(OP_E): Likewise.
	(OP_EM): Likewise.
	(OP_EX): Likewise.
and fix testsuite yet again now that we are getting correct disassembly.
@
text
@d2231 1
a2231 1
  /* 20 */ 1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1, /* 2f */
d2234 2
a2235 2
  /* 50 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* 5f */
  /* 60 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* 6f */
d2239 1
a2239 1
  /* a0 */ 0,0,0,1,1,1,0,0,0,0,0,1,1,1,1,1, /* af */
d2242 3
a2244 3
  /* d0 */ 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* df */
  /* e0 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, /* ef */
  /* f0 */ 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0  /* ff */
a2281 1
static unsigned char need_modrm;
a2283 5
/* If we are accessing mod/rm/reg without need_modrm set, then the
   values are stale.  Hitting this abort likely indicates that you
   need to update onebyte_has_modrm or twobyte_has_modrm.  */
#define MODRM_CHECK  if (!need_modrm) abort ()

d2992 1
a3626 2
  /* skip mod/rm byte */
  MODRM_CHECK;
a4040 1
  MODRM_CHECK;
a4929 2
  /* skip mod/rm byte */
  MODRM_CHECK;
a4953 2
  /* skip mod/rm byte */
  MODRM_CHECK;
@


1.13.2.8
log
@Merge from mainline.
@
text
@a252 3
#define cond_jump_flag NULL, cond_jump_mode
#define loop_jcxz_flag NULL, loop_jcxz_mode

a314 2
#define cond_jump_mode 8
#define loop_jcxz_mode 9
a432 1
   'F' => print 'w' or 'l' depending on address size prefix (loop insns)
d577 8
a584 8
  { "jo",	Jb, cond_jump_flag, XX },
  { "jno",	Jb, cond_jump_flag, XX },
  { "jb",	Jb, cond_jump_flag, XX },
  { "jae",	Jb, cond_jump_flag, XX },
  { "je",	Jb, cond_jump_flag, XX },
  { "jne",	Jb, cond_jump_flag, XX },
  { "jbe",	Jb, cond_jump_flag, XX },
  { "ja",	Jb, cond_jump_flag, XX },
d586 8
a593 8
  { "js",	Jb, cond_jump_flag, XX },
  { "jns",	Jb, cond_jump_flag, XX },
  { "jp",	Jb, cond_jump_flag, XX },
  { "jnp",	Jb, cond_jump_flag, XX },
  { "jl",	Jb, cond_jump_flag, XX },
  { "jge",	Jb, cond_jump_flag, XX },
  { "jle",	Jb, cond_jump_flag, XX },
  { "jg",	Jb, cond_jump_flag, XX },
d704 4
a707 4
  { "loopneF",	Jb, loop_jcxz_flag, XX },
  { "loopeF",	Jb, loop_jcxz_flag, XX },
  { "loopF",	Jb, loop_jcxz_flag, XX },
  { "jEcxz",	Jb, loop_jcxz_flag, XX },
d1163 8
a1170 8
  { "jo",	Jb, cond_jump_flag, XX },
  { "jno",	Jb, cond_jump_flag, XX },
  { "jb",	Jb, cond_jump_flag, XX },
  { "jae",	Jb, cond_jump_flag, XX },
  { "je",	Jb, cond_jump_flag, XX },
  { "jne",	Jb, cond_jump_flag, XX },
  { "jbe",	Jb, cond_jump_flag, XX },
  { "ja",	Jb, cond_jump_flag, XX },
d1172 8
a1179 8
  { "js",	Jb, cond_jump_flag, XX },
  { "jns",	Jb, cond_jump_flag, XX },
  { "jp",	Jb, cond_jump_flag, XX },
  { "jnp",	Jb, cond_jump_flag, XX },
  { "jl",	Jb, cond_jump_flag, XX },
  { "jge",	Jb, cond_jump_flag, XX },
  { "jle",	Jb, cond_jump_flag, XX },
  { "jg",	Jb, cond_jump_flag, XX },
d1290 4
a1293 4
  { "loopneF",	Jb, loop_jcxz_flag, XX },
  { "loopeF",	Jb, loop_jcxz_flag, XX },
  { "loopF",	Jb, loop_jcxz_flag, XX },
  { "jEcxz",	Jb, loop_jcxz_flag, XX },
d1766 8
a1773 8
  { "jo",  Jv, cond_jump_flag, XX },
  { "jno", Jv, cond_jump_flag, XX },
  { "jb",  Jv, cond_jump_flag, XX },
  { "jae", Jv, cond_jump_flag, XX },
  { "je",  Jv, cond_jump_flag, XX },
  { "jne", Jv, cond_jump_flag, XX },
  { "jbe", Jv, cond_jump_flag, XX },
  { "ja",  Jv, cond_jump_flag, XX },
d1775 8
a1782 8
  { "js",  Jv, cond_jump_flag, XX },
  { "jns", Jv, cond_jump_flag, XX },
  { "jp",  Jv, cond_jump_flag, XX },
  { "jnp", Jv, cond_jump_flag, XX },
  { "jl",  Jv, cond_jump_flag, XX },
  { "jge", Jv, cond_jump_flag, XX },
  { "jle", Jv, cond_jump_flag, XX },
  { "jg",  Jv, cond_jump_flag, XX },
d3129 3
d3135 5
a3139 35
      if (dp->bytemode2 != loop_jcxz_mode)
	{
	  if (sizeflag & AFLAG)
	    oappend ("addr32 ");
	  else
	    oappend ("addr16 ");
	  used_prefixes |= PREFIX_ADDR;
	}
    }

  if (!uses_SSE_prefix && (prefixes & PREFIX_DATA))
    {
      sizeflag ^= DFLAG;
      if (dp->bytemode2 == cond_jump_mode && dp->bytemode1 == v_mode)
	{
	  if (sizeflag & DFLAG)
	    oappend ("data32 ");
	  else
	    oappend ("data16 ");
	  used_prefixes |= PREFIX_DATA;
	}
    }

  if (dp->bytemode2 == cond_jump_mode || dp->bytemode2 == loop_jcxz_mode)
    {
      if ((prefixes & (PREFIX_CS | PREFIX_DS)) == PREFIX_CS)
	{
	  oappend ("cs ");
	  used_prefixes |= PREFIX_CS;
	}
      if ((prefixes & (PREFIX_CS | PREFIX_DS)) == PREFIX_DS)
	{
	  oappend ("ds ");
	  used_prefixes |= PREFIX_DS;
	}
a3713 15
	  used_prefixes |= (prefixes & PREFIX_ADDR);
	  break;
	case 'F':
	  if ((prefixes & PREFIX_ADDR)
#ifdef SUFFIX_ALWAYS
	      || (sizeflag & SUFFIX_ALWAYS)
#endif
	      )
	    {
	      if (sizeflag & AFLAG)
		*obufp++ = 'l';
	      else
		*obufp++ = 'w';
	      used_prefixes |= (prefixes & PREFIX_ADDR);
	    }
d4700 1
@


1.13.2.9
log
@	* i386-dis.c (grps): Don't print the implicit al/ax/eax register
	for opcode 0xf6 or 0xf7 forms of mul, imul, div, idiv insns.

	Merge from mainline.
	2001-07-28  Kazu Hirata  <kazu@@hxi.com>
	* i386-dis.c: Fix formatting.

	2001-07-28  Matthias Kramm <kramm@@quiss.org>
	* i386-dis.c: Change formatting conventions for architecture
	i386:intel to better match the format of various intel i386
	assemblers, like nasm, tasm or masm.

	2001-07-18  Alan Modra  <amodra@@bigpond.net.au>
	* i386-dis.c (grps): Print l or w suffix, and require mem modrm
	for lgdt, lidt, sgdt, sidt.

	2001-07-09  Andreas Jaeger  <aj@@suse.de>, Karsten Keil <kkeil@@suse.de>
	* i386-dis.c (set_op): Handle 64 bit and 32 bit mode.
	(OP_J): Use bfd_vma for mask to work properly with 64 bits.
	(op_address,op_riprel): Use bfd_vma to handle 64 bits.

	2001-06-11  Alan Modra  <amodra@@bigpond.net.au>
	* i386-dis.c: Group function prototypes in one place.
	(FLOATCODE): Redefine as 1.
	(USE_GROUPS): Redefine as 2.
	(USE_PREFIX_USER_TABLE): Redefine as 3.
	(X86_64_SPECIAL): Define as 4.
	(GRP1b..GRPAMD): Move USE_GROUPS to bytecode1, index to bytecode2.
	(PREGRP0..PREGRP26): Similarly with USE_PREFIX_USER_TABLE.
	(dis386_att, dis386_intel, disx86_64_att, disx86_64_intel): Delete.
	(dis386): New table combining above four tables.
	(dis386_twobyte_att, dis386_twobyte_intel): Delete.
	(dis386_twobyte): New table combining above two tables.
	(x86_64_table): New table to handle x86_64.
	(X86_64_0): Define.
	(float_mem_att, float_mem_intel): Delet.
	(float_mem): New table combining above two tables.
	(print_insn_i386): Modify for above.
	(dofloat): Likewise.
	(putop): Handle '{', '|' and '}' to select alternative mnemonics.
	Return 0 on success, 1 if no valid alternative.
	(putop <case 'F'>, <case 'H'>): Print nothing for intel_syntax.
	(putop <case 'T'>): Move to case 'U', and share case 'Q' code.
	(putop <case 'I'>): Move to case 'T', and share case 'P' code.
	(OP_REG <case rAX_reg .. rDI_reg>): Handle as for eAX_reg .. eDI_reg
	if not 64-bit mode.
	(OP_I <case q_mode>): Handle as for v_mode if not 64-bit mode.
	(OP_I64): If not 64-bit mode, call OP_I.
	OP_OFF64): If not 64-bit mode, call OP_OFF.
	(OP_ST, OP_STi, OP_SEG, OP_DIR, OP_OFF, OP_OFF64, OP_MMX): Rename
	'ignore'/'ignored' to 'bytemode'.

	2001-06-10  Alan Modra  <amodra@@bigpond.net.au>
	* i386-dis.c (dis386_att): Add 'H' to conditional branch and
	loop,jcxz insns.
	(disx86_64_att): Likewise.
	(dis386_twobyte_att): Likewise.
	(print_insn_i386): Don't print branch hints as a prefix.
	(putop): 'H' macro prints branch hints.
	(get64): Kill compile warnings.
@
text
@a52 45
static void ckprefix PARAMS ((void));
static const char *prefix_name PARAMS ((int, int));
static int print_insn_i386 PARAMS ((bfd_vma, disassemble_info *));
static void dofloat PARAMS ((int));
static void OP_ST PARAMS ((int, int));
static void OP_STi  PARAMS ((int, int));
static int putop PARAMS ((const char *, int));
static void oappend PARAMS ((const char *));
static void append_seg PARAMS ((void));
static void OP_indirE PARAMS ((int, int));
static void print_operand_value PARAMS ((char *, int, bfd_vma));
static void OP_E PARAMS ((int, int));
static void OP_G PARAMS ((int, int));
static bfd_vma get64 PARAMS ((void));
static bfd_signed_vma get32 PARAMS ((void));
static bfd_signed_vma get32s PARAMS ((void));
static int get16 PARAMS ((void));
static void set_op PARAMS ((bfd_vma, int));
static void OP_REG PARAMS ((int, int));
static void OP_IMREG PARAMS ((int, int));
static void OP_I PARAMS ((int, int));
static void OP_I64 PARAMS ((int, int));
static void OP_sI PARAMS ((int, int));
static void OP_J PARAMS ((int, int));
static void OP_SEG PARAMS ((int, int));
static void OP_DIR PARAMS ((int, int));
static void OP_OFF PARAMS ((int, int));
static void OP_OFF64 PARAMS ((int, int));
static void ptr_reg PARAMS ((int, int));
static void OP_ESreg PARAMS ((int, int));
static void OP_DSreg PARAMS ((int, int));
static void OP_C PARAMS ((int, int));
static void OP_D PARAMS ((int, int));
static void OP_T PARAMS ((int, int));
static void OP_Rd PARAMS ((int, int));
static void OP_MMX PARAMS ((int, int));
static void OP_XMM PARAMS ((int, int));
static void OP_EM PARAMS ((int, int));
static void OP_EX PARAMS ((int, int));
static void OP_MS PARAMS ((int, int));
static void OP_XS PARAMS ((int, int));
static void OP_3DNowSuffix PARAMS ((int, int));
static void OP_SIMD_Suffix PARAMS ((int, int));
static void SIMD_Fixup PARAMS ((int, int));
static void BadOp PARAMS ((void));
d54 2
a55 1
struct dis_private {
d115 1
a115 1
  ((addr) <= ((struct dis_private *) (info->private_data))->max_fetched \
d124 1
a124 1
  struct dis_private *priv = (struct dis_private *) info->private_data;
d155 1
a155 1
#define M OP_E, 0		/* lea, lgdt, etc. */
d257 1
a257 1
#if 0 /* Leave undefined until someone adds the extra flag to objdump.  */
d263 48
d366 2
a367 58
#define FLOATCODE 1
#define USE_GROUPS 2
#define USE_PREFIX_USER_TABLE 3
#define X86_64_SPECIAL 4

#define FLOAT	  NULL, NULL, FLOATCODE, NULL, 0, NULL, 0

#define GRP1b	  NULL, NULL, USE_GROUPS, NULL,  0, NULL, 0
#define GRP1S	  NULL, NULL, USE_GROUPS, NULL,  1, NULL, 0
#define GRP1Ss	  NULL, NULL, USE_GROUPS, NULL,  2, NULL, 0
#define GRP2b	  NULL, NULL, USE_GROUPS, NULL,  3, NULL, 0
#define GRP2S	  NULL, NULL, USE_GROUPS, NULL,  4, NULL, 0
#define GRP2b_one NULL, NULL, USE_GROUPS, NULL,  5, NULL, 0
#define GRP2S_one NULL, NULL, USE_GROUPS, NULL,  6, NULL, 0
#define GRP2b_cl  NULL, NULL, USE_GROUPS, NULL,  7, NULL, 0
#define GRP2S_cl  NULL, NULL, USE_GROUPS, NULL,  8, NULL, 0
#define GRP3b	  NULL, NULL, USE_GROUPS, NULL,  9, NULL, 0
#define GRP3S	  NULL, NULL, USE_GROUPS, NULL, 10, NULL, 0
#define GRP4	  NULL, NULL, USE_GROUPS, NULL, 11, NULL, 0
#define GRP5	  NULL, NULL, USE_GROUPS, NULL, 12, NULL, 0
#define GRP6	  NULL, NULL, USE_GROUPS, NULL, 13, NULL, 0
#define GRP7	  NULL, NULL, USE_GROUPS, NULL, 14, NULL, 0
#define GRP8	  NULL, NULL, USE_GROUPS, NULL, 15, NULL, 0
#define GRP9	  NULL, NULL, USE_GROUPS, NULL, 16, NULL, 0
#define GRP10	  NULL, NULL, USE_GROUPS, NULL, 17, NULL, 0
#define GRP11	  NULL, NULL, USE_GROUPS, NULL, 18, NULL, 0
#define GRP12	  NULL, NULL, USE_GROUPS, NULL, 19, NULL, 0
#define GRP13	  NULL, NULL, USE_GROUPS, NULL, 20, NULL, 0
#define GRP14	  NULL, NULL, USE_GROUPS, NULL, 21, NULL, 0
#define GRPAMD	  NULL, NULL, USE_GROUPS, NULL, 22, NULL, 0

#define PREGRP0   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  0, NULL, 0
#define PREGRP1   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  1, NULL, 0
#define PREGRP2   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  2, NULL, 0
#define PREGRP3   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  3, NULL, 0
#define PREGRP4   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  4, NULL, 0
#define PREGRP5   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  5, NULL, 0
#define PREGRP6   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  6, NULL, 0
#define PREGRP7   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  7, NULL, 0
#define PREGRP8   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  8, NULL, 0
#define PREGRP9   NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  9, NULL, 0
#define PREGRP10  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 10, NULL, 0
#define PREGRP11  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 11, NULL, 0
#define PREGRP12  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 12, NULL, 0
#define PREGRP13  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 13, NULL, 0
#define PREGRP14  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 14, NULL, 0
#define PREGRP15  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 15, NULL, 0
#define PREGRP16  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 16, NULL, 0
#define PREGRP17  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 17, NULL, 0
#define PREGRP18  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 18, NULL, 0
#define PREGRP19  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 19, NULL, 0
#define PREGRP20  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 20, NULL, 0
#define PREGRP21  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 21, NULL, 0
#define PREGRP22  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 22, NULL, 0
#define PREGRP23  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 23, NULL, 0
#define PREGRP24  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 24, NULL, 0
#define PREGRP25  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 25, NULL, 0
#define PREGRP26  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 26, NULL, 0
d369 51
a419 1
#define X86_64_0  NULL, NULL, X86_64_SPECIAL, NULL,  0, NULL, 0
d421 2
a422 1
typedef void (*op_rtn) PARAMS ((int bytemode, int sizeflag));
a438 1
   'H' => print ",pt" or ",pn" branch hint
d445 1
d449 1
a449 2
   'T' => print 'q' in 64bit mode and behave as 'P' otherwise
   'U' => print 'q' in 64bit mode and behave as 'Q' otherwise
d453 1
d455 291
a745 2
   Many of the above letters print nothing in Intel mode.  See "putop"
   for the details.
d747 877
a1623 5
   Braces '{' and '}', and vertical bars '|', indicate alternative
   mnemonic strings for AT&T, Intel, X86_64 AT&T, and X86_64 Intel
   modes.  In cases where there are only two alternatives, the X86_64
   instruction is reserved, and "(bad)" is printed.
*/
d1625 1
a1625 1
static const struct dis386 dis386[] = {
d1627 8
a1634 8
  { "addB",		Eb, Gb, XX },
  { "addS",		Ev, Gv, XX },
  { "addB",		Gb, Eb, XX },
  { "addS",		Gv, Ev, XX },
  { "addB",		AL, Ib, XX },
  { "addS",		eAX, Iv, XX },
  { "push{T|}",		es, XX, XX },
  { "pop{T|}",		es, XX, XX },
d1636 8
a1643 8
  { "orB",		Eb, Gb, XX },
  { "orS",		Ev, Gv, XX },
  { "orB",		Gb, Eb, XX },
  { "orS",		Gv, Ev, XX },
  { "orB",		AL, Ib, XX },
  { "orS",		eAX, Iv, XX },
  { "push{T|}",		cs, XX, XX },
  { "(bad)",		XX, XX, XX },	/* 0x0f extended opcode escape */
d1645 8
a1652 8
  { "adcB",		Eb, Gb, XX },
  { "adcS",		Ev, Gv, XX },
  { "adcB",		Gb, Eb, XX },
  { "adcS",		Gv, Ev, XX },
  { "adcB",		AL, Ib, XX },
  { "adcS",		eAX, Iv, XX },
  { "push{T|}",		ss, XX, XX },
  { "popT|}",		ss, XX, XX },
d1654 8
a1661 8
  { "sbbB",		Eb, Gb, XX },
  { "sbbS",		Ev, Gv, XX },
  { "sbbB",		Gb, Eb, XX },
  { "sbbS",		Gv, Ev, XX },
  { "sbbB",		AL, Ib, XX },
  { "sbbS",		eAX, Iv, XX },
  { "push{T|}",		ds, XX, XX },
  { "pop{T|}",		ds, XX, XX },
d1663 9
a1671 8
  { "andB",		Eb, Gb, XX },
  { "andS",		Ev, Gv, XX },
  { "andB",		Gb, Eb, XX },
  { "andS",		Gv, Ev, XX },
  { "andB",		AL, Ib, XX },
  { "andS",		eAX, Iv, XX },
  { "(bad)",		XX, XX, XX },	/* SEG ES prefix */
  { "daa{|}",		XX, XX, XX },
d1673 8
a1680 8
  { "subB",		Eb, Gb, XX },
  { "subS",		Ev, Gv, XX },
  { "subB",		Gb, Eb, XX },
  { "subS",		Gv, Ev, XX },
  { "subB",		AL, Ib, XX },
  { "subS",		eAX, Iv, XX },
  { "(bad)",		XX, XX, XX },	/* SEG CS prefix */
  { "das{|}",		XX, XX, XX },
d1682 8
a1689 8
  { "xorB",		Eb, Gb, XX },
  { "xorS",		Ev, Gv, XX },
  { "xorB",		Gb, Eb, XX },
  { "xorS",		Gv, Ev, XX },
  { "xorB",		AL, Ib, XX },
  { "xorS",		eAX, Iv, XX },
  { "(bad)",		XX, XX, XX },	/* SEG SS prefix */
  { "aaa{|}",		XX, XX, XX },
d1691 8
a1698 8
  { "cmpB",		Eb, Gb, XX },
  { "cmpS",		Ev, Gv, XX },
  { "cmpB",		Gb, Eb, XX },
  { "cmpS",		Gv, Ev, XX },
  { "cmpB",		AL, Ib, XX },
  { "cmpS",		eAX, Iv, XX },
  { "(bad)",		XX, XX, XX },	/* SEG DS prefix */
  { "aas{|}",		XX, XX, XX },
d1700 8
a1707 8
  { "inc{S|}",		RMeAX, XX, XX },
  { "inc{S|}",		RMeCX, XX, XX },
  { "inc{S|}",		RMeDX, XX, XX },
  { "inc{S|}",		RMeBX, XX, XX },
  { "inc{S|}",		RMeSP, XX, XX },
  { "inc{S|}",		RMeBP, XX, XX },
  { "inc{S|}",		RMeSI, XX, XX },
  { "inc{S|}",		RMeDI, XX, XX },
d1709 8
a1716 8
  { "dec{S|}",		RMeAX, XX, XX },
  { "dec{S|}",		RMeCX, XX, XX },
  { "dec{S|}",		RMeDX, XX, XX },
  { "dec{S|}",		RMeBX, XX, XX },
  { "dec{S|}",		RMeSP, XX, XX },
  { "dec{S|}",		RMeBP, XX, XX },
  { "dec{S|}",		RMeSI, XX, XX },
  { "dec{S|}",		RMeDI, XX, XX },
d1718 17
a1734 17
  { "pushS",		RMrAX, XX, XX },
  { "pushS",		RMrCX, XX, XX },
  { "pushS",		RMrDX, XX, XX },
  { "pushS",		RMrBX, XX, XX },
  { "pushS",		RMrSP, XX, XX },
  { "pushS",		RMrBP, XX, XX },
  { "pushS",		RMrSI, XX, XX },
  { "pushS",		RMrDI, XX, XX },
  /* 58 */
  { "popS",		RMrAX, XX, XX },
  { "popS",		RMrCX, XX, XX },
  { "popS",		RMrDX, XX, XX },
  { "popS",		RMrBX, XX, XX },
  { "popS",		RMrSP, XX, XX },
  { "popS",		RMrBP, XX, XX },
  { "popS",		RMrSI, XX, XX },
  { "popS",		RMrDI, XX, XX },
d1736 8
a1743 8
  { "pusha{P|}",	XX, XX, XX },
  { "popa{P|}",		XX, XX, XX },
  { "bound{S|}",	Gv, Ma, XX },
  { X86_64_0 },
  { "(bad)",		XX, XX, XX },	/* seg fs */
  { "(bad)",		XX, XX, XX },	/* seg gs */
  { "(bad)",		XX, XX, XX },	/* op size prefix */
  { "(bad)",		XX, XX, XX },	/* adr size prefix */
d1745 8
a1752 8
  { "pushT",		Iq, XX, XX },
  { "imulS",		Gv, Ev, Iv },
  { "pushT",		sIb, XX, XX },
  { "imulS",		Gv, Ev, sIb },
  { "ins{b||b|}",	Yb, indirDX, XX },
  { "ins{R||R|}",	Yv, indirDX, XX },
  { "outs{b||b|}",	indirDX, Xb, XX },
  { "outs{R||R|}",	indirDX, Xv, XX },
d1754 8
a1761 8
  { "joH",		Jb, XX, cond_jump_flag },
  { "jnoH",		Jb, XX, cond_jump_flag },
  { "jbH",		Jb, XX, cond_jump_flag },
  { "jaeH",		Jb, XX, cond_jump_flag },
  { "jeH",		Jb, XX, cond_jump_flag },
  { "jneH",		Jb, XX, cond_jump_flag },
  { "jbeH",		Jb, XX, cond_jump_flag },
  { "jaH",		Jb, XX, cond_jump_flag },
d1763 8
a1770 8
  { "jsH",		Jb, XX, cond_jump_flag },
  { "jnsH",		Jb, XX, cond_jump_flag },
  { "jpH",		Jb, XX, cond_jump_flag },
  { "jnpH",		Jb, XX, cond_jump_flag },
  { "jlH",		Jb, XX, cond_jump_flag },
  { "jgeH",		Jb, XX, cond_jump_flag },
  { "jleH",		Jb, XX, cond_jump_flag },
  { "jgH",		Jb, XX, cond_jump_flag },
d1772 8
a1779 8
  { GRP1b },
  { GRP1S },
  { "(bad)",		XX, XX, XX },
  { GRP1Ss },
  { "testB",		Eb, Gb, XX },
  { "testS",		Ev, Gv, XX },
  { "xchgB",		Eb, Gb, XX },
  { "xchgS",		Ev, Gv, XX },
d1781 8
a1788 8
  { "movB",		Eb, Gb, XX },
  { "movS",		Ev, Gv, XX },
  { "movB",		Gb, Eb, XX },
  { "movS",		Gv, Ev, XX },
  { "movQ",		Ev, Sw, XX },
  { "leaS",		Gv, M, XX },
  { "movQ",		Sw, Ev, XX },
  { "popU",		Ev, XX, XX },
d1790 8
a1797 9
  { "nop",		XX, XX, XX },
  /* FIXME: NOP with REPz prefix is called PAUSE.  */
  { "xchgS",		RMeCX, eAX, XX },
  { "xchgS",		RMeDX, eAX, XX },
  { "xchgS",		RMeBX, eAX, XX },
  { "xchgS",		RMeSP, eAX, XX },
  { "xchgS",		RMeBP, eAX, XX },
  { "xchgS",		RMeSI, eAX, XX },
  { "xchgS",		RMeDI, eAX, XX },
d1799 8
a1806 8
  { "cW{tR||tR|}",	XX, XX, XX },
  { "cR{tO||tO|}",	XX, XX, XX },
  { "lcall{T|}",	Ap, XX, XX },
  { "(bad)",		XX, XX, XX },	/* fwait */
  { "pushfT",		XX, XX, XX },
  { "popfT",		XX, XX, XX },
  { "sahf{|}",		XX, XX, XX },
  { "lahf{|}",		XX, XX, XX },
d1808 8
a1815 8
  { "movB",		AL, Ob64, XX },
  { "movS",		eAX, Ov64, XX },
  { "movB",		Ob64, AL, XX },
  { "movS",		Ov64, eAX, XX },
  { "movs{b||b|}",	Yb, Xb, XX },
  { "movs{R||R|}",	Yv, Xv, XX },
  { "cmps{b||b|}",	Xb, Yb, XX },
  { "cmps{R||R|}",	Xv, Yv, XX },
d1817 8
a1824 8
  { "testB",		AL, Ib, XX },
  { "testS",		eAX, Iv, XX },
  { "stosB",		Yb, AL, XX },
  { "stosS",		Yv, eAX, XX },
  { "lodsB",		AL, Xb, XX },
  { "lodsS",		eAX, Xv, XX },
  { "scasB",		AL, Yb, XX },
  { "scasS",		eAX, Yv, XX },
d1826 8
a1833 8
  { "movB",		RMAL, Ib, XX },
  { "movB",		RMCL, Ib, XX },
  { "movB",		RMDL, Ib, XX },
  { "movB",		RMBL, Ib, XX },
  { "movB",		RMAH, Ib, XX },
  { "movB",		RMCH, Ib, XX },
  { "movB",		RMDH, Ib, XX },
  { "movB",		RMBH, Ib, XX },
d1835 8
a1842 8
  { "movS",		RMeAX, Iv64, XX },
  { "movS",		RMeCX, Iv64, XX },
  { "movS",		RMeDX, Iv64, XX },
  { "movS",		RMeBX, Iv64, XX },
  { "movS",		RMeSP, Iv64, XX },
  { "movS",		RMeBP, Iv64, XX },
  { "movS",		RMeSI, Iv64, XX },
  { "movS",		RMeDI, Iv64, XX },
d1844 8
a1851 8
  { GRP2b },
  { GRP2S },
  { "retT",		Iw, XX, XX },
  { "retT",		XX, XX, XX },
  { "les{S|}",		Gv, Mp, XX },
  { "ldsS",		Gv, Mp, XX },
  { "movA",		Eb, Ib, XX },
  { "movQ",		Ev, Iv, XX },
d1853 8
a1860 8
  { "enterT",		Iw, Ib, XX },
  { "leaveT",		XX, XX, XX },
  { "lretP",		Iw, XX, XX },
  { "lretP",		XX, XX, XX },
  { "int3",		XX, XX, XX },
  { "int",		Ib, XX, XX },
  { "into{|}",		XX, XX, XX },
  { "iretP",		XX, XX, XX },
d1862 8
a1869 8
  { GRP2b_one },
  { GRP2S_one },
  { GRP2b_cl },
  { GRP2S_cl },
  { "aam{|}",		sIb, XX, XX },
  { "aad{|}",		sIb, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "xlat",		DSBX, XX, XX },
d1871 8
a1878 8
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
  { FLOAT },
d1880 8
a1887 8
  { "loopneFH",		Jb, XX, loop_jcxz_flag },
  { "loopeFH",		Jb, XX, loop_jcxz_flag },
  { "loopFH",		Jb, XX, loop_jcxz_flag },
  { "jEcxzH",		Jb, XX, loop_jcxz_flag },
  { "inB",		AL, Ib, XX },
  { "inS",		eAX, Ib, XX },
  { "outB",		Ib, AL, XX },
  { "outS",		Ib, eAX, XX },
d1889 8
a1896 8
  { "callT",		Jv, XX, XX },
  { "jmpT",		Jv, XX, XX },
  { "ljmp{T|}",		Ap, XX, XX },
  { "jmp",		Jb, XX, XX },
  { "inB",		AL, indirDX, XX },
  { "inS",		eAX, indirDX, XX },
  { "outB",		indirDX, AL, XX },
  { "outS",		indirDX, eAX, XX },
d1898 8
a1905 8
  { "(bad)",		XX, XX, XX },	/* lock prefix */
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },	/* repne */
  { "(bad)",		XX, XX, XX },	/* repz */
  { "hlt",		XX, XX, XX },
  { "cmc",		XX, XX, XX },
  { GRP3b },
  { GRP3S },
d1907 8
a1914 8
  { "clc",		XX, XX, XX },
  { "stc",		XX, XX, XX },
  { "cli",		XX, XX, XX },
  { "sti",		XX, XX, XX },
  { "cld",		XX, XX, XX },
  { "std",		XX, XX, XX },
  { GRP4 },
  { GRP5 },
d1917 1
a1917 1
static const struct dis386 dis386_twobyte[] = {
d1921 6
a1926 6
  { "larS",		Gv, Ew, XX },
  { "lslS",		Gv, Ew, XX },
  { "(bad)",		XX, XX, XX },
  { "syscall",		XX, XX, XX },
  { "clts",		XX, XX, XX },
  { "sysretP",		XX, XX, XX },
d1928 5
a1932 5
  { "invd",		XX, XX, XX },
  { "wbinvd",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "ud2a",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
d1934 2
a1935 2
  { "femms",		XX, XX, XX },
  { "",			MX, EM, OPSUF }, /* See OP_3DNowSuffix.  */
d1939 6
a1944 6
  { "movlpX",		XM, EX, SIMD_Fixup, 'h' }, /* really only 2 operands */
  { "movlpX",		EX, XM, SIMD_Fixup, 'h' },
  { "unpcklpX",		XM, EX, XX },
  { "unpckhpX",		XM, EX, XX },
  { "movhpX",		XM, EX, SIMD_Fixup, 'l' },
  { "movhpX",		EX, XM, SIMD_Fixup, 'l' },
d1947 7
a1953 7
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
d1955 9
a1963 8
  { "movL",		Rm, Cm, XX },
  { "movL",		Rm, Dm, XX },
  { "movL",		Cm, Rm, XX },
  { "movL",		Dm, Rm, XX },
  { "movL",		Rd, Td, XX },
  { "(bad)",		XX, XX, XX },
  { "movL",		Td, Rd, XX },
  { "(bad)",		XX, XX, XX },
d1965 2
a1966 2
  { "movapX",		XM, EX, XX },
  { "movapX",		EX, XM, XX },
d1968 1
a1968 1
  { "movntpX",		Ev, XM, XX },
d1971 2
a1972 2
  { "ucomisX",		XM,EX, XX },
  { "comisX",		XM,EX, XX },
d1974 8
a1981 8
  { "wrmsr",		XX, XX, XX },
  { "rdtsc",		XX, XX, XX },
  { "rdmsr",		XX, XX, XX },
  { "rdpmc",		XX, XX, XX },
  { "sysenter",		XX, XX, XX },
  { "sysexit",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
d1983 8
a1990 8
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
d1992 8
a1999 8
  { "cmovo",		Gv, Ev, XX },
  { "cmovno",		Gv, Ev, XX },
  { "cmovb",		Gv, Ev, XX },
  { "cmovae",		Gv, Ev, XX },
  { "cmove",		Gv, Ev, XX },
  { "cmovne",		Gv, Ev, XX },
  { "cmovbe",		Gv, Ev, XX },
  { "cmova",		Gv, Ev, XX },
d2001 8
a2008 8
  { "cmovs",		Gv, Ev, XX },
  { "cmovns",		Gv, Ev, XX },
  { "cmovp",		Gv, Ev, XX },
  { "cmovnp",		Gv, Ev, XX },
  { "cmovl",		Gv, Ev, XX },
  { "cmovge",		Gv, Ev, XX },
  { "cmovle",		Gv, Ev, XX },
  { "cmovg",		Gv, Ev, XX },
d2010 1
a2010 1
  { "movmskpX",		Gd, XS, XX },
d2014 4
a2017 4
  { "andpX",		XM, EX, XX },
  { "andnpX",		XM, EX, XX },
  { "orpX",		XM, EX, XX },
  { "xorpX",		XM, EX, XX },
d2028 8
a2035 8
  { "punpcklbw",	MX, EM, XX },
  { "punpcklwd",	MX, EM, XX },
  { "punpckldq",	MX, EM, XX },
  { "packsswb",		MX, EM, XX },
  { "pcmpgtb",		MX, EM, XX },
  { "pcmpgtw",		MX, EM, XX },
  { "pcmpgtd",		MX, EM, XX },
  { "packuswb",		MX, EM, XX },
d2037 4
a2040 4
  { "punpckhbw",	MX, EM, XX },
  { "punpckhwd",	MX, EM, XX },
  { "punpckhdq",	MX, EM, XX },
  { "packssdw",		MX, EM, XX },
d2043 1
a2043 1
  { "movd",		MX, Ed, XX },
d2050 4
a2053 4
  { "pcmpeqb",		MX, EM, XX },
  { "pcmpeqw",		MX, EM, XX },
  { "pcmpeqd",		MX, EM, XX },
  { "emms",		XX, XX, XX },
d2055 6
a2060 6
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
d2064 8
a2071 8
  { "joH",		Jv, XX, cond_jump_flag },
  { "jnoH",		Jv, XX, cond_jump_flag },
  { "jbH",		Jv, XX, cond_jump_flag },
  { "jaeH",		Jv, XX, cond_jump_flag },
  { "jeH",		Jv, XX, cond_jump_flag },
  { "jneH",		Jv, XX, cond_jump_flag },
  { "jbeH",		Jv, XX, cond_jump_flag },
  { "jaH",		Jv, XX, cond_jump_flag },
d2073 8
a2080 8
  { "jsH",		Jv, XX, cond_jump_flag },
  { "jnsH",		Jv, XX, cond_jump_flag },
  { "jpH",		Jv, XX, cond_jump_flag },
  { "jnpH",		Jv, XX, cond_jump_flag },
  { "jlH",		Jv, XX, cond_jump_flag },
  { "jgeH",		Jv, XX, cond_jump_flag },
  { "jleH",		Jv, XX, cond_jump_flag },
  { "jgH",		Jv, XX, cond_jump_flag },
d2082 8
a2089 8
  { "seto",		Eb, XX, XX },
  { "setno",		Eb, XX, XX },
  { "setb",		Eb, XX, XX },
  { "setae",		Eb, XX, XX },
  { "sete",		Eb, XX, XX },
  { "setne",		Eb, XX, XX },
  { "setbe",		Eb, XX, XX },
  { "seta",		Eb, XX, XX },
d2091 8
a2098 8
  { "sets",		Eb, XX, XX },
  { "setns",		Eb, XX, XX },
  { "setp",		Eb, XX, XX },
  { "setnp",		Eb, XX, XX },
  { "setl",		Eb, XX, XX },
  { "setge",		Eb, XX, XX },
  { "setle",		Eb, XX, XX },
  { "setg",		Eb, XX, XX },
d2100 8
a2107 8
  { "pushT",		fs, XX, XX },
  { "popT",		fs, XX, XX },
  { "cpuid",		XX, XX, XX },
  { "btS",		Ev, Gv, XX },
  { "shldS",		Ev, Gv, Ib },
  { "shldS",		Ev, Gv, CL },
  { "(bad)",		XX, XX, XX },
  { "(bad)",		XX, XX, XX },
d2109 6
a2114 6
  { "pushT",		gs, XX, XX },
  { "popT",		gs, XX, XX },
  { "rsm",		XX, XX, XX },
  { "btsS",		Ev, Gv, XX },
  { "shrdS",		Ev, Gv, Ib },
  { "shrdS",		Ev, Gv, CL },
d2116 1
a2116 1
  { "imulS",		Gv, Ev, XX },
d2118 8
a2125 8
  { "cmpxchgB",		Eb, Gb, XX },
  { "cmpxchgS",		Ev, Gv, XX },
  { "lssS",		Gv, Mp, XX },
  { "btrS",		Ev, Gv, XX },
  { "lfsS",		Gv, Mp, XX },
  { "lgsS",		Gv, Mp, XX },
  { "movz{bR|x|bR|x}",	Gv, Eb, XX },
  { "movz{wR|x|wR|x}",	Gv, Ew, XX }, /* yes, there really is movzww ! */
d2127 2
a2128 2
  { "(bad)",		XX, XX, XX },
  { "ud2b",		XX, XX, XX },
d2130 5
a2134 5
  { "btcS",		Ev, Gv, XX },
  { "bsfS",		Gv, Ev, XX },
  { "bsrS",		Gv, Ev, XX },
  { "movs{bR|x|bR|x}",	Gv, Eb, XX },
  { "movs{wR|x|wR|x}",	Gv, Ew, XX }, /* yes, there really is movsww ! */
d2136 2
a2137 2
  { "xaddB",		Eb, Gb, XX },
  { "xaddS",		Ev, Gv, XX },
d2139 4
a2142 4
  { "movntiS",		Ev, Gv, XX },
  { "pinsrw",		MX, Ed, Ib },
  { "pextrw",		Gd, MS, Ib },
  { "shufpX",		XM, EX, Ib },
d2145 8
a2152 8
  { "bswap",		RMeAX, XX, XX },
  { "bswap",		RMeCX, XX, XX },
  { "bswap",		RMeDX, XX, XX },
  { "bswap",		RMeBX, XX, XX },
  { "bswap",		RMeSP, XX, XX },
  { "bswap",		RMeBP, XX, XX },
  { "bswap",		RMeSI, XX, XX },
  { "bswap",		RMeDI, XX, XX },
d2154 6
a2159 6
  { "(bad)",		XX, XX, XX },
  { "psrlw",		MX, EM, XX },
  { "psrld",		MX, EM, XX },
  { "psrlq",		MX, EM, XX },
  { "paddq",		MX, EM, XX },
  { "pmullw",		MX, EM, XX },
d2161 1
a2161 1
  { "pmovmskb",		Gd, MS, XX },
d2163 8
a2170 8
  { "psubusb",		MX, EM, XX },
  { "psubusw",		MX, EM, XX },
  { "pminub",		MX, EM, XX },
  { "pand",		MX, EM, XX },
  { "paddusb",		MX, EM, XX },
  { "paddusw",		MX, EM, XX },
  { "pmaxub",		MX, EM, XX },
  { "pandn",		MX, EM, XX },
d2172 6
a2177 6
  { "pavgb",		MX, EM, XX },
  { "psraw",		MX, EM, XX },
  { "psrad",		MX, EM, XX },
  { "pavgw",		MX, EM, XX },
  { "pmulhuw",		MX, EM, XX },
  { "pmulhw",		MX, EM, XX },
d2181 8
a2188 8
  { "psubsb",		MX, EM, XX },
  { "psubsw",		MX, EM, XX },
  { "pminsw",		MX, EM, XX },
  { "por",		MX, EM, XX },
  { "paddsb",		MX, EM, XX },
  { "paddsw",		MX, EM, XX },
  { "pmaxsw",		MX, EM, XX },
  { "pxor",		MX, EM, XX },
d2190 7
a2196 7
  { "(bad)",		XX, XX, XX },
  { "psllw",		MX, EM, XX },
  { "pslld",		MX, EM, XX },
  { "psllq",		MX, EM, XX },
  { "pmuludq",		MX, EM, XX },
  { "pmaddwd",		MX, EM, XX },
  { "psadbw",		MX, EM, XX },
d2199 8
a2206 8
  { "psubb",		MX, EM, XX },
  { "psubw",		MX, EM, XX },
  { "psubd",		MX, EM, XX },
  { "psubq",		MX, EM, XX },
  { "paddb",		MX, EM, XX },
  { "paddw",		MX, EM, XX },
  { "paddd",		MX, EM, XX },
  { "(bad)",		XX, XX, XX }
d2289 1
d2296 2
a2297 36
static const char **names64;
static const char **names32;
static const char **names16;
static const char **names8;
static const char **names8rex;
static const char **names_seg;
static const char **index16;

static const char *intel_names64[] = {
  "rax", "rcx", "rdx", "rbx", "rsp", "rbp", "rsi", "rdi",
  "r8", "r9", "r10", "r11", "r12", "r13", "r14", "r15"
};
static const char *intel_names32[] = {
  "eax", "ecx", "edx", "ebx", "esp", "ebp", "esi", "edi",
  "r8d", "r9d", "r10d", "r11d", "r12d", "r13d", "r14d", "r15d"
};
static const char *intel_names16[] = {
  "ax", "cx", "dx", "bx", "sp", "bp", "si", "di",
  "r8w", "r9w", "r10w", "r11w", "r12w", "r13w", "r14w", "r15w"
};
static const char *intel_names8[] = {
  "al", "cl", "dl", "bl", "ah", "ch", "dh", "bh",
};
static const char *intel_names8rex[] = {
  "al", "cl", "dl", "bl", "spl", "bpl", "sil", "dil",
  "r8b", "r9b", "r10b", "r11b", "r12b", "r13b", "r14b", "r15b"
};
static const char *intel_names_seg[] = {
  "es", "cs", "ss", "ds", "fs", "gs", "?", "?",
};
static const char *intel_index16[] = {
  "bx+si", "bx+di", "bp+si", "bp+di", "si", "di", "bp", "bx"
};

static const char *att_names64[] = {
  "%rax", "%rcx", "%rdx", "%rbx", "%rsp", "%rbp", "%rsi", "%rdi",
d2300 2
a2301 2
static const char *att_names32[] = {
  "%eax", "%ecx", "%edx", "%ebx", "%esp", "%ebp", "%esi", "%edi",
d2304 2
a2305 2
static const char *att_names16[] = {
  "%ax", "%cx", "%dx", "%bx", "%sp", "%bp", "%si", "%di",
d2308 2
a2309 2
static const char *att_names8[] = {
  "%al", "%cl", "%dl", "%bl", "%ah", "%ch", "%dh", "%bh",
d2311 2
a2312 2
static const char *att_names8rex[] = {
  "%al", "%cl", "%dl", "%bl", "%spl", "%bpl", "%sil", "%dil",
d2315 2
a2316 2
static const char *att_names_seg[] = {
  "%es", "%cs", "%ss", "%ds", "%fs", "%gs", "%?", "%?",
d2318 2
a2319 2
static const char *att_index16[] = {
  "%bx,%si", "%bx,%di", "%bp,%si", "%bp,%di", "%si", "%di", "%bp", "%bx"
d2428 4
a2431 4
    { "mulA",	Eb, XX, XX },	/* Don't print the implicit %al register,  */
    { "imulA",	Eb, XX, XX },	/* to distinguish these opcodes from other */
    { "divA",	Eb, XX, XX },	/* mul/imul opcodes.  Do the same for div  */
    { "idivA",	Eb, XX, XX }	/* and idiv for consistency.		   */
d2439 4
a2442 4
    { "mulQ",	Ev, XX, XX },	/* Don't print the implicit register.  */
    { "imulQ",	Ev, XX, XX },
    { "divQ",	Ev, XX, XX },
    { "idivQ",	Ev, XX, XX },
d2459 5
a2463 5
    { "callT",	indirEv, XX, XX },
    { "lcallT",	indirEv, XX, XX },
    { "jmpT",	indirEv, XX, XX },
    { "ljmpT",	indirEv, XX, XX },
    { "pushU",	Ev, XX, XX },
d2479 8
a2486 8
    { "sgdtQ",	 M, XX, XX },
    { "sidtQ",	 M, XX, XX },
    { "lgdtQ",	 M, XX, XX },
    { "lidtQ",	 M, XX, XX },
    { "smsw",	Ew, XX, XX },
    { "(bad)",	XX, XX, XX },
    { "lmsw",	Ew, XX, XX },
    { "invlpg",	Ew, XX, XX },
d2553 1
a2553 1
    /* FIXME: the sfence with memory operand is clflush!  */
d2577 1
d2590 1
a2590 1
    { "", XM, EX, OPSIMD },	/* See OP_SIMD_SUFFIX.  */
a2771 7
static const struct dis386 x86_64_table[][2] = {
  {
    { "arpl", Ew, Gw, XX },
    { "movs{||lq|xd}", Gv, Ed, XX },
  },
};

d2943 2
a2944 2
static bfd_vma op_address[3];
static bfd_vma op_riprel[3];
d2946 1
d2957 3
a2971 7
  names64 = att_names64;
  names32 = att_names32;
  names16 = att_names16;
  names8 = att_names8;
  names8rex = att_names8rex;
  names_seg = att_names_seg;
  index16 = att_index16;
a2985 7
  names64 = intel_names64;
  names32 = intel_names32;
  names16 = intel_names16;
  names8 = intel_names8;
  names8rex = intel_names8rex;
  names_seg = intel_names_seg;
  index16 = intel_index16;
d3018 1
a3018 1
    sizeflag = AFLAG | DFLAG;
d3095 4
a3098 1
      dp = &dis386_twobyte[*++codep];
d3104 10
a3113 1
      dp = &dis386[*codep];
d3138 1
a3138 1
      if (dp->bytemode3 != loop_jcxz_mode || intel_syntax)
d3151 1
a3151 3
      if (dp->bytemode3 == cond_jump_mode
	  && dp->bytemode1 == v_mode
	  && !intel_syntax)
d3161 14
d3192 1
a3192 1
	  switch (dp->bytemode1)
d3194 25
a3218 31
	    case USE_GROUPS:
	      dp = &grps[dp->bytemode2][reg];
	      break;

	    case USE_PREFIX_USER_TABLE:
	      index = 0;
	      used_prefixes |= (prefixes & PREFIX_REPZ);
	      if (prefixes & PREFIX_REPZ)
		index = 1;
	      else
		{
		  used_prefixes |= (prefixes & PREFIX_DATA);
		  if (prefixes & PREFIX_DATA)
		    index = 2;
		  else
		    {
		      used_prefixes |= (prefixes & PREFIX_REPNZ);
		      if (prefixes & PREFIX_REPNZ)
			index = 3;
		    }
		}
	      dp = &prefix_user_table[dp->bytemode2][index];
	      break;

	    case X86_64_SPECIAL:
	      dp = &x86_64_table[dp->bytemode2][mode_64bit];
	      break;

	    default:
	      oappend (INTERNAL_DISASSEMBLER_ERROR);
	      break;
d3222 16
a3237 17
      if (putop (dp->name, sizeflag) == 0)
	{
	  obufp = op1out;
	  op_ad = 2;
	  if (dp->op1)
	    (*dp->op1) (dp->bytemode1, sizeflag);

	  obufp = op2out;
	  op_ad = 1;
	  if (dp->op2)
	    (*dp->op2) (dp->bytemode2, sizeflag);

	  obufp = op3out;
	  op_ad = 0;
	  if (dp->op3)
	    (*dp->op3) (dp->bytemode3, sizeflag);
	}
d3324 76
a3399 1
static const char *float_mem[] = {
d3401 8
a3408 8
  "fadd{s||s|}",
  "fmul{s||s|}",
  "fcom{s||s|}",
  "fcomp{s||s|}",
  "fsub{s||s|}",
  "fsubr{s||s|}",
  "fdiv{s||s|}",
  "fdivr{s||s|}",
d3410 1
a3410 1
  "fld{s||s|}",
d3412 2
a3413 2
  "fst{s||s|}",
  "fstp{s||s|}",
d3419 8
a3426 8
  "fiadd{l||l|}",
  "fimul{l||l|}",
  "ficom{l||l|}",
  "ficomp{l||l|}",
  "fisub{l||l|}",
  "fisubr{l||l|}",
  "fidiv{l||l|}",
  "fidivr{l||l|}",
d3428 1
a3428 1
  "fild{l||l|}",
d3430 2
a3431 2
  "fist{l||l|}",
  "fistp{l||l|}",
d3433 1
a3433 1
  "fld{t||t|}",
d3435 1
a3435 1
  "fstp{t||t|}",
d3437 8
a3444 8
  "fadd{l||l|}",
  "fmul{l||l|}",
  "fcom{l||l|}",
  "fcomp{l||l|}",
  "fsub{l||l|}",
  "fsubr{l||l|}",
  "fdiv{l||l|}",
  "fdivr{l||l|}",
d3446 1
a3446 1
  "fld{l||l|}",
d3448 2
a3449 2
  "fst{l||l|}",
  "fstp{l||l|}",
d3469 1
a3469 1
  "fild{ll||ll|}",
d3592 1
d3652 4
a3655 1
      putop (float_mem[(floatop - 0xd8) * 8 + reg], sizeflag);
d3665 1
a3665 1
  /* Skip mod/rm byte.  */
d3674 1
a3674 1
      /* Instruction fnstsw is only one with strange arg.  */
d3684 1
a3684 1
	(*dp->op1) (dp->bytemode1, sizeflag);
d3687 1
a3687 1
	(*dp->op2) (dp->bytemode2, sizeflag);
d3691 1
d3693 2
a3694 2
OP_ST (bytemode, sizeflag)
     int bytemode ATTRIBUTE_UNUSED;
d3700 1
d3702 2
a3703 2
OP_STi (bytemode, sizeflag)
     int bytemode ATTRIBUTE_UNUSED;
d3707 1
a3707 1
  oappend (scratchbuf + intel_syntax);
d3710 3
a3712 2
/* Capital letters in template are macros.  */
static int
a3717 1
  int alt;
a3725 32
	case '{':
	  alt = 0;
	  if (intel_syntax)
	    alt += 1;
	  if (mode_64bit)
	    alt += 2;
	  while (alt != 0)
	    {
	      while (*++p != '|')
		{
		  if (*p == '}')
		    {
		      /* Alternative not valid.  */
		      strcpy (obuf, "(bad)");
		      obufp = obuf + 5;
		      return 1;
		    }
		  else if (*p == '\0')
		    abort ();
		}
	      alt--;
	    }
	  break;
	case '|':
	  while (*++p != '}')
	    {
	      if (*p == '\0')
		abort ();
	    }
	  break;
	case '}':
	  break;
a3749 2
          if (intel_syntax)
            break;
d3763 1
a3763 1
	case 'H':
d3766 3
a3768 2
	  if ((prefixes & (PREFIX_CS | PREFIX_DS)) == PREFIX_CS
	      || (prefixes & (PREFIX_CS | PREFIX_DS)) == PREFIX_DS)
d3770 12
a3781 7
	      used_prefixes |= prefixes & (PREFIX_CS | PREFIX_DS);
	      *obufp++ = ',';
	      *obufp++ = 'p';
	      if (prefixes & PREFIX_DS)
		*obufp++ = 't';
	      else
		*obufp++ = 'n';
d3801 1
a3801 1
	    *obufp++ = 'o';
a3804 9
	case 'T':
          if (intel_syntax)
            break;
	  if (mode_64bit)
	    {
	      *obufp++ = 'q';
	      break;
	    }
	  /* Fall through.  */
a3827 9
	case 'U':
          if (intel_syntax)
            break;
	  if (mode_64bit)
	    {
	      *obufp++ = 'q';
	      break;
	    }
	  /* Fall through.  */
d3901 18
a3967 1
  return 0;
d3983 1
a3984 1
      oappend ("%cs:" + intel_syntax);
d3988 1
a3989 1
      oappend ("%ds:" + intel_syntax);
d3993 1
a3994 1
      oappend ("%ss:" + intel_syntax);
d3998 1
a3999 1
      oappend ("%es:" + intel_syntax);
d4003 1
a4004 1
      oappend ("%fs:" + intel_syntax);
d4008 1
a4009 1
      oappend ("%gs:" + intel_syntax);
d4038 1
a4038 1
	  for (i = 0; tmp[i] == '0' && tmp[i + 1]; i++);
d4050 1
a4050 1
	      /* Check for possible overflow on 0x8000000000000000.  */
d4067 1
a4067 1
	      tmp[28 - i] = (v % 10) + '0';
d4095 1
a4095 1
  /* Skip mod/rm byte.  */
d4136 1
a4136 1
	  if (!(codep[-2] == 0xAE && codep[-1] == 0xF8 /* sfence */)
d4139 1
a4139 1
	    BadOp ();	/* bad sfence,lea,lds,les,lfs,lgs,lss modrm */
d4264 1
a4264 2
                      sprintf (scratchbuf, "%s",
			       mode_64bit ? names64[index] : names32[index]);
d4267 1
a4267 2
		    sprintf (scratchbuf, ",%s",
			     mode_64bit ? names64[index] : names32[index]);
d4285 1
a4285 1
		/* Don't print zero displacements.  */
a4287 6
		    if ((bfd_signed_vma) disp > 0)
		      {
			*obufp++ = '+';
			*obufp = '\0';
		      }

d4305 1
a4305 1
		  oappend (names_seg[ds_reg - es_reg]);
d4402 4
a4405 1
  bfd_vma x;
a4406 3
  unsigned int a;
  unsigned int b;

d4412 1
a4412 1
  b = *codep++ & 0xff;
d4418 1
a4418 2
  abort ();
  x = 0;
d4465 1
a4465 1
     bfd_vma op;
d4469 2
a4470 11
  if (mode_64bit)
    {
      op_address[op_ad] = op;
      op_riprel[op_ad] = riprel;
    }
  else
    {
      /* Mask to get a 32-bit address.  */
      op_address[op_ad] = op & 0xffffffff;
      op_riprel[op_ad] = riprel & 0xffffffff;
    }
d4487 1
a4487 4
      if (intel_syntax)
        s = "[dx]";
      else
        s = "(%dx)";
a4504 9
    case rAX_reg: case rCX_reg: case rDX_reg: case rBX_reg:
    case rSP_reg: case rBP_reg: case rSI_reg: case rDI_reg:
      if (mode_64bit)
	{
	  s = names64[code - rAX_reg + add];
	  break;
	}
      code += eAX_reg - rAX_reg;
      /* Fall through.  */
d4516 4
d4537 1
a4537 4
      if (intel_syntax)
        s = "[dx]";
      else
        s = "(%dx)";
d4589 2
a4590 6
      if (mode_64bit)
	{
	  op = get32s ();
	  break;
	}
      /* Fall through.  */
d4618 2
a4619 2
  print_operand_value (scratchbuf + 1, 1, op);
  oappend (scratchbuf + intel_syntax);
a4630 6
  if (!mode_64bit)
    {
      OP_I (bytemode, sizeflag);
      return;
    }

d4665 2
a4666 2
  print_operand_value (scratchbuf + 1, 1, op);
  oappend (scratchbuf + intel_syntax);
d4699 1
a4699 1
	  op = get16 ();
d4718 1
a4718 1
  oappend (scratchbuf + intel_syntax);
d4727 1
a4727 1
  bfd_vma mask = -1;
d4743 1
a4743 1
	  /* For some reason, a data16 prefix on a jump instruction
d4759 1
d4765 5
a4769 1
  oappend (names_seg[reg]);
d4772 1
d4791 1
a4791 4
  if (intel_syntax)
    sprintf (scratchbuf, "0x%x,0x%x", seg, offset);
  else
    sprintf (scratchbuf, "$0x%x,$0x%x", seg, offset);
d4795 1
d4797 2
a4798 2
OP_OFF (bytemode, sizeflag)
     int bytemode ATTRIBUTE_UNUSED;
d4815 1
a4815 1
	  oappend (names_seg[ds_reg - es_reg]);
d4822 1
a4822 1

d4824 2
a4825 2
OP_OFF64 (bytemode, sizeflag)
     int bytemode ATTRIBUTE_UNUSED;
a4829 6
  if (!mode_64bit)
    {
      OP_OFF (bytemode, sizeflag);
      return;
    }

d4832 1
a4832 1
  off = get64 ();
d4839 1
a4839 1
	  oappend (names_seg[ds_reg - es_reg]);
d4853 1
a4853 5
  if (intel_syntax)
    oappend ("[");
  else
    oappend ("(");

d4862 1
a4862 4
  if (intel_syntax)
    oappend ("]");
  else
    oappend (")");
d4870 1
a4870 1
  oappend ("%es:" + intel_syntax);
d4887 1
a4887 1
  append_seg ();
d4891 1
d4901 2
a4902 2
  sprintf (scratchbuf, "%%cr%d", reg + add);
  oappend (scratchbuf + intel_syntax);
d4905 1
d4915 1
a4915 4
  if (intel_syntax)
    sprintf (scratchbuf, "db%d", reg + add);
  else
    sprintf (scratchbuf, "%%db%d", reg + add);
d4919 1
d4926 1
a4926 1
  oappend (scratchbuf + intel_syntax);
d4937 1
a4937 1
    BadOp ();
d4941 2
a4942 2
OP_MMX (bytemode, sizeflag)
     int bytemode ATTRIBUTE_UNUSED;
d4954 1
a4954 1
  oappend (scratchbuf + intel_syntax);
d4967 1
a4967 1
  oappend (scratchbuf + intel_syntax);
d4985 1
a4985 1
  /* Skip mod/rm byte.  */
d4993 1
a4993 1
  oappend (scratchbuf + intel_syntax);
d5011 1
a5011 1
  /* Skip mod/rm byte.  */
d5015 1
a5015 1
  oappend (scratchbuf + intel_syntax);
d5026 1
a5026 1
    BadOp ();
d5037 1
a5037 1
    BadOp ();
d5118 1
a5118 1
  obufp = obuf + strlen (obuf);
d5130 1
a5130 1
      BadOp ();
d5134 2
a5135 1
static const char *simd_cmp_op[] = {
d5154 1
a5154 1
  obufp = obuf + strlen (obuf);
d5184 1
a5184 1
      BadOp ();
d5197 6
a5202 6
      char *p = obuf + strlen (obuf);
      *(p + 1) = '\0';
      *p       = *(p - 1);
      *(p - 1) = *(p - 2);
      *(p - 2) = *(p - 3);
      *(p - 3) = extrachar;
d5206 1
a5206 2
static void
BadOp (void)
d5208 1
a5208 2
  /* Throw away prefixes and 1st. opcode byte.  */
  codep = insn_codep + 1;
@


1.12
log
@
	* i386-dis.c (PREGRP15 - PREGRP24): New.
	(dis386_twobyt): Add SSE2 instructions.
	(twobyte_uses_SSE_prefix: Rename from ... ; add new SSE instructions.
	(twobyte_uses_f3_prefix): ... this one.
	(grps): Add SSE instructions.
	(prefix_user_table): Add two new slots; add SSE2 instructions.
	(print_insn_i386): Rename uses_f3_prefix to uses_SSE_prefix;
	Handle the REPNZ and Data16 prefixes as well; do proper lookup
	to prefix_user_table.
	(OP_E): Accept mfence and lfence as well.
	(OP_MMX): Data16 prefix turns MMX to SSE; support REX extensions.
	(OP_XMM): Support REX extensions.
	(OP_EM): Likewise.
	(OP_EX): Likewise.
@
text
@d664 2
a665 2
  { "retP",	Iw, XX, XX },
  { "retP",	XX, XX, XX },
d673 2
a674 2
  { "lretI",	Iw, XX, XX },
  { "lretI",	XX, XX, XX },
d678 1
a678 1
  { "iretI",	XX, XX, XX },
d1259 2
a1260 2
  { "lretI",	Iw, XX, XX },
  { "lretI",	XX, XX, XX },
d1264 1
a1264 1
  { "iretI",	XX, XX, XX },
@


1.11
log
@
	* i386-dis.c: Add x86_64 support.
	(rex): New static variable.
	(REX_MODE64, REX_EXTX, REX_EXTY, REX_EXTZ): New constants.
	(USED_REX): New macro.
	(Ev, Ed, Rm, Iq, Iv64, Cm, Dm, Rm*, Ob64, Ov64): New macros.
	(OP_I64, OP_OFF64, OP_IMREG): New functions.
	(OP_REG, OP_OFF): Declare.
	(get64, get32, get32s): New functions.
	(r??_reg): New constants.
	(dis386_att): Change templates of instruction implicitly promoted
	to 64bit; change e?? to RMe?? for unwind RM byte instructions.
	(grps): Likewise.
	(dis386_intel): Likewise.
	(dixx86_64_att): New table based on dis386_att.
	(dixx86_64_intel): New table based on dis386_intel.
	(names64, names8rex): New global variable.
	(names32, names16): Add extended registers.
	(prefix_user_t): Recognize rex prefixes.
	(prefix_name): Print REX prefixes nicely.
	(op_riprel): New global variable.
	(start_pc): Set type to bfd_vma.
	(print_insn_i386): Detect the 64bit mode and use proper table;
	move ckprefix after initializing the buffer; output unused rex prefixes;
	output information about target of RIP relative addresses.
	(putop): Support 'O' and 'I'. Update handling of "P', 'Q', 'R' and 'S';
	(print_operand_value): New function.
	(OP_E, OP_G, OP_REG, OP_I, OP_J, OP_DIR, OP_OFF, OP_D): Add support for
	REX prefix and new modes.
	(get64, get32s): New.
	(get32): Return bfd_signed_vma type.
	(set_op): Initialize the op_riprel.
	* disassemble.c (disassembler): Recognize the x86-64 disassembly.
@
text
@d401 10
d439 1
d608 1
d900 1
d1194 1
d1272 1
a1272 1
  { "(bad)",	XX, XX, XX },
d1486 1
d1564 1
a1564 1
  { "(bad)",	XX, XX, XX },
d1635 6
a1640 6
  { "movlps", XM, EX, SIMD_Fixup, 'h' },  /* really only 2 operands */
  { "movlps", EX, XM, SIMD_Fixup, 'h' },
  { "unpcklps", XM, EX, XX },
  { "unpckhps", XM, EX, XX },
  { "movhps", XM, EX, SIMD_Fixup, 'l' },
  { "movhps", EX, XM, SIMD_Fixup, 'l' },
d1661 2
a1662 2
  { "movaps", XM, EX, XX },
  { "movaps", EX, XM, XX },
d1664 1
a1664 1
  { "movntps", Ev, XM, XX },
d1667 2
a1668 2
  { "ucomiss", XM, EX, XX },
  { "comiss", XM, EX, XX },
d1706 1
a1706 1
  { "movmskps", Gv, EX, XX },
d1710 4
a1713 4
  { "andps", XM, EX, XX },
  { "andnps", XM, EX, XX },
  { "orps", XM, EX, XX },
  { "xorps", XM, EX, XX },
d1717 2
a1718 2
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
d1738 1
a1738 1
  { "(bad)", XX, XX, XX },
d1740 1
a1740 1
  { "movq", MX, EM, XX },
d1742 1
a1742 1
  { "pshufw", MX, EM, Ib },
d1757 2
a1758 2
  { "movd", Ed, MX, XX },
  { "movq", EM, MX, XX },
d1835 1
a1835 1
  { "(bad)", XX, XX, XX },
d1838 1
a1838 1
  { "shufps", XM, EX, Ib },
d1856 1
a1856 1
  { "(bad)", XX, XX, XX },
d1874 1
a1874 1
  { "(bad)", XX, XX, XX },
d1890 1
a1890 1
  { "(bad)", XX, XX, XX },
d1893 1
a1893 1
  { "maskmovq", MX, EM, XX },
d1925 8
a1932 8
  { PREGRP8 },
  { PREGRP9 },
  { "movlps", XM, EX, SIMD_Fixup, 'h' },  /* really only 2 operands */
  { "movlps", EX, XM, SIMD_Fixup, 'h' },
  { "unpcklps", XM, EX, XX },
  { "unpckhps", XM, EX, XX },
  { "movhps", XM, EX, SIMD_Fixup, 'l' },
  { "movhps", EX, XM, SIMD_Fixup, 'l' },
d1953 2
a1954 2
  { "movaps", XM, EX, XX },
  { "movaps", EX, XM, XX },
d1956 1
a1956 1
  { "movntps", Ev, XM, XX },
d1959 2
a1960 2
  { "ucomiss", XM, EX, XX },
  { "comiss", XM, EX, XX },
d1998 1
a1998 1
  { "movmskps", Gv, EX, XX },
d2002 4
a2005 4
  { "andps", XM, EX, XX },
  { "andnps", XM, EX, XX },
  { "orps", XM, EX, XX },
  { "xorps", XM, EX, XX },
d2009 2
a2010 2
  { "(bad)", XX, XX, XX },
  { "(bad)", XX, XX, XX },
d2030 1
a2030 1
  { "(bad)", XX, XX, XX },
d2032 1
a2032 1
  { "movq", MX, EM, XX },
d2034 1
a2034 1
  { "pshufw", MX, EM, Ib },
d2049 2
a2050 2
  { "movd", Ed, MX, XX },
  { "movq", EM, MX, XX },
d2127 1
a2127 1
  { "(bad)", XX, XX, XX },
d2130 1
a2130 1
  { "shufps", XM, EX, Ib },
d2148 1
a2148 1
  { "(bad)", XX, XX, XX },
d2166 1
a2166 1
  { "(bad)", XX, XX, XX },
d2182 1
a2182 1
  { "(bad)", XX, XX, XX },
d2185 1
a2185 1
  { "maskmovq", MX, EM, XX },
d2243 1
a2243 1
static const unsigned char twobyte_uses_f3_prefix[256] = {
d2251 3
a2253 3
  /* 50 */ 0,1,1,1,0,0,0,0,1,1,0,0,1,1,1,1, /* 5f */
  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
  /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 7f */
d2259 3
a2261 3
  /* d0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* df */
  /* e0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ef */
  /* f0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0  /* ff */
d2519 1
a2519 1
    { "(bad)",	XX, XX, XX },
d2523 1
a2523 1
    { "(bad)",	XX, XX, XX },
d2532 2
a2533 2
    { "(bad)",	XX, XX, XX },
    { "(bad)",	XX, XX, XX },
d2535 1
d2562 1
a2562 1
static const struct dis386 prefix_user_table[][2] = {
d2567 2
d2574 2
d2581 2
d2588 2
d2595 2
d2602 2
d2609 2
d2616 2
d2623 2
d2630 2
d2637 2
d2644 2
d2651 2
d2658 2
d2665 73
a2737 1
  }
d2973 1
a2973 1
  unsigned char uses_f3_prefix;
d3069 1
a3069 1
      uses_f3_prefix = twobyte_uses_f3_prefix[*codep];
d3084 1
a3084 1
      uses_f3_prefix = 0;
d3088 1
a3088 1
  if (!uses_f3_prefix && (prefixes & PREFIX_REPZ))
d3093 1
a3093 1
  if (prefixes & PREFIX_REPNZ)
d3104 1
a3104 1
  if (prefixes & PREFIX_DATA)
d3131 1
d3140 1
a3140 1
		dp = &prefix_user_table[dp->bytemode1][prefixes & PREFIX_REPZ ? 1 : 0];
d3142 16
d3806 7
d4032 3
a4034 1
	  if ( !(codep[-2] == 0xAE && codep[-1] == 0xF8 /* sfence */))
d4842 9
a4850 1
  sprintf (scratchbuf, "%%mm%d", reg);
d4859 5
a4863 1
  sprintf (scratchbuf, "%%xmm%d", reg);
d4872 1
d4878 3
d4883 5
a4887 1
  sprintf (scratchbuf, "%%mm%d", rm);
d4896 1
d4902 3
d4907 1
a4907 1
  sprintf (scratchbuf, "%%xmm%d", rm);
d5040 18
a5057 3
      sprintf (scratchbuf, "cmp%s%cs",
	       simd_cmp_op[cmp_type],
	       prefixes & PREFIX_REPZ ? 's' : 'p');
@


1.10
log
@x86 indirect jump/call syntax fixes.  Disassembly fix for lcall.
@
text
@d25 1
d66 3
d72 20
d148 2
d162 1
d166 2
d171 2
a172 2
#define Cd OP_C, d_mode
#define Dd OP_D, d_mode
d175 48
a222 19
#define eAX OP_REG, eAX_reg
#define eBX OP_REG, eBX_reg
#define eCX OP_REG, eCX_reg
#define eDX OP_REG, eDX_reg
#define eSP OP_REG, eSP_reg
#define eBP OP_REG, eBP_reg
#define eSI OP_REG, eSI_reg
#define eDI OP_REG, eDI_reg
#define AL OP_REG, al_reg
#define CL OP_REG, cl_reg
#define DL OP_REG, dl_reg
#define BL OP_REG, bl_reg
#define AH OP_REG, ah_reg
#define CH OP_REG, ch_reg
#define DH OP_REG, dh_reg
#define BH OP_REG, bh_reg
#define AX OP_REG, ax_reg
#define DX OP_REG, dx_reg
#define indirDX OP_REG, indir_dx_reg
d227 1
d229 1
d264 5
d294 1
a294 1
static void set_op PARAMS ((unsigned int op));
d298 3
a300 1
static int get32 PARAMS ((void));
d306 7
a312 5
#define b_mode 1
#define v_mode 2
#define w_mode 3
#define d_mode 4
#define x_mode 5
d348 9
d421 2
a422 1
   'P' => print 'w' or 'l' if instruction has an operand size prefix,
d424 5
a428 3
   'Q' => print 'w' or 'l' if no register operands or suffix_always is true
   'R' => print 'w' or 'l' ("wd" or "dq" in intel mode)
   'S' => print 'w' or 'l' if suffix_always is true
d440 2
a441 2
  { "pushP",	es, XX, XX },
  { "popP",	es, XX, XX },
d449 1
a449 1
  { "pushP",	cs, XX, XX },
d458 2
a459 2
  { "pushP",	ss, XX, XX },
  { "popP",	ss, XX, XX },
d467 2
a468 2
  { "pushP",	ds, XX, XX },
  { "popP",	ds, XX, XX },
d506 8
a513 8
  { "incS",	eAX, XX, XX },
  { "incS",	eCX, XX, XX },
  { "incS",	eDX, XX, XX },
  { "incS",	eBX, XX, XX },
  { "incS",	eSP, XX, XX },
  { "incS",	eBP, XX, XX },
  { "incS",	eSI, XX, XX },
  { "incS",	eDI, XX, XX },
d515 8
a522 8
  { "decS",	eAX, XX, XX },
  { "decS",	eCX, XX, XX },
  { "decS",	eDX, XX, XX },
  { "decS",	eBX, XX, XX },
  { "decS",	eSP, XX, XX },
  { "decS",	eBP, XX, XX },
  { "decS",	eSI, XX, XX },
  { "decS",	eDI, XX, XX },
d524 8
a531 8
  { "pushS",	eAX, XX, XX },
  { "pushS",	eCX, XX, XX },
  { "pushS",	eDX, XX, XX },
  { "pushS",	eBX, XX, XX },
  { "pushS",	eSP, XX, XX },
  { "pushS",	eBP, XX, XX },
  { "pushS",	eSI, XX, XX },
  { "pushS",	eDI, XX, XX },
d533 8
a540 8
  { "popS",	eAX, XX, XX },
  { "popS",	eCX, XX, XX },
  { "popS",	eDX, XX, XX },
  { "popS",	eBX, XX, XX },
  { "popS",	eSP, XX, XX },
  { "popS",	eBP, XX, XX },
  { "popS",	eSI, XX, XX },
  { "popS",	eDI, XX, XX },
d551 1
a551 1
  { "pushP",	Iv, XX, XX },		/* 386 book wrong */
d553 1
a553 1
  { "pushP",	sIb, XX, XX },	/* push of byte really pushes 2 or 4 bytes */
d597 7
a603 7
  { "xchgS",	eCX, eAX, XX },
  { "xchgS",	eDX, eAX, XX },
  { "xchgS",	eBX, eAX, XX },
  { "xchgS",	eSP, eAX, XX },
  { "xchgS",	eBP, eAX, XX },
  { "xchgS",	eSI, eAX, XX },
  { "xchgS",	eDI, eAX, XX },
d606 2
a607 2
  { "cRtd",	XX, XX, XX },
  { "lcallP",	Ap, XX, XX },
d609 2
a610 2
  { "pushfP",	XX, XX, XX },
  { "popfP",	XX, XX, XX },
d632 8
a639 8
  { "movB",	AL, Ib, XX },
  { "movB",	CL, Ib, XX },
  { "movB",	DL, Ib, XX },
  { "movB",	BL, Ib, XX },
  { "movB",	AH, Ib, XX },
  { "movB",	CH, Ib, XX },
  { "movB",	DH, Ib, XX },
  { "movB",	BH, Ib, XX },
d641 8
a648 8
  { "movS",	eAX, Iv, XX },
  { "movS",	eCX, Iv, XX },
  { "movS",	eDX, Iv, XX },
  { "movS",	eBX, Iv, XX },
  { "movS",	eSP, Iv, XX },
  { "movS",	eBP, Iv, XX },
  { "movS",	eSI, Iv, XX },
  { "movS",	eDI, Iv, XX },
d654 585
a1238 1
  { "lesS",	Gv, Mp, XX },
d1243 4
a1246 4
  { "enterP",	Iw, Ib, XX },
  { "leaveP",	XX, XX, XX },
  { "lretP",	Iw, XX, XX },
  { "lretP",	XX, XX, XX },
d1249 2
a1250 2
  { "into",	XX, XX, XX},
  { "iretP",	XX, XX, XX },
d1256 2
a1257 2
  { "aam",	sIb, XX, XX },
  { "aad",	sIb, XX, XX },
d1279 3
a1281 3
  { "callP",	Jv, XX, XX },
  { "jmpP",	Jv, XX, XX },
  { "ljmpP",	Ap, XX, XX },
d1307 1
a1307 1
static const struct dis386 dis386_intel[] = {
d1315 2
a1316 2
  { "push",	es, XX, XX },
  { "pop",	es, XX, XX },
d1324 1
a1324 1
  { "push",	cs, XX, XX },
d1333 2
a1334 2
  { "push",	ss, XX, XX },
  { "pop",	ss, XX, XX },
d1342 2
a1343 2
  { "push",	ds, XX, XX },
  { "pop",	ds, XX, XX },
d1352 1
a1352 1
  { "daa",	XX, XX, XX },
d1361 1
a1361 1
  { "das",	XX, XX, XX },
d1370 1
a1370 1
  { "aaa",	XX, XX, XX },
d1379 1
a1379 1
  { "aas",	XX, XX, XX },
d1381 8
a1388 8
  { "inc",	eAX, XX, XX },
  { "inc",	eCX, XX, XX },
  { "inc",	eDX, XX, XX },
  { "inc",	eBX, XX, XX },
  { "inc",	eSP, XX, XX },
  { "inc",	eBP, XX, XX },
  { "inc",	eSI, XX, XX },
  { "inc",	eDI, XX, XX },
d1390 8
a1397 8
  { "dec",	eAX, XX, XX },
  { "dec",	eCX, XX, XX },
  { "dec",	eDX, XX, XX },
  { "dec",	eBX, XX, XX },
  { "dec",	eSP, XX, XX },
  { "dec",	eBP, XX, XX },
  { "dec",	eSI, XX, XX },
  { "dec",	eDI, XX, XX },
d1399 8
a1406 8
  { "push",	eAX, XX, XX },
  { "push",	eCX, XX, XX },
  { "push",	eDX, XX, XX },
  { "push",	eBX, XX, XX },
  { "push",	eSP, XX, XX },
  { "push",	eBP, XX, XX },
  { "push",	eSI, XX, XX },
  { "push",	eDI, XX, XX },
d1408 8
a1415 8
  { "pop",	eAX, XX, XX },
  { "pop",	eCX, XX, XX },
  { "pop",	eDX, XX, XX },
  { "pop",	eBX, XX, XX },
  { "pop",	eSP, XX, XX },
  { "pop",	eBP, XX, XX },
  { "pop",	eSI, XX, XX },
  { "pop",	eDI, XX, XX },
d1417 4
a1420 4
  { "pusha",	XX, XX, XX },
  { "popa",	XX, XX, XX },
  { "bound",	Gv, Ma, XX },
  { "arpl",	Ew, Gw, XX },
d1426 1
a1426 1
  { "push",	Iv, XX, XX },		/* 386 book wrong */
d1472 7
a1478 7
  { "xchg",	eCX, eAX, XX },
  { "xchg",	eDX, eAX, XX },
  { "xchg",	eBX, eAX, XX },
  { "xchg",	eSP, eAX, XX },
  { "xchg",	eBP, eAX, XX },
  { "xchg",	eSI, eAX, XX },
  { "xchg",	eDI, eAX, XX },
d1482 1
a1482 1
  { "lcall",	Ap, XX, XX },
d1486 2
a1487 2
  { "sahf",	XX, XX, XX },
  { "lahf",	XX, XX, XX },
d1507 8
a1514 8
  { "mov",	AL, Ib, XX },
  { "mov",	CL, Ib, XX },
  { "mov",	DL, Ib, XX },
  { "mov",	BL, Ib, XX },
  { "mov",	AH, Ib, XX },
  { "mov",	CH, Ib, XX },
  { "mov",	DH, Ib, XX },
  { "mov",	BH, Ib, XX },
d1516 8
a1523 8
  { "mov",	eAX, Iv, XX },
  { "mov",	eCX, Iv, XX },
  { "mov",	eDX, Iv, XX },
  { "mov",	eBX, Iv, XX },
  { "mov",	eSP, Iv, XX },
  { "mov",	eBP, Iv, XX },
  { "mov",	eSI, Iv, XX },
  { "mov",	eDI, Iv, XX },
d1529 1
a1529 1
  { "les",	Gv, Mp, XX },
d1540 1
a1540 1
  { "into",	XX, XX, XX },
d1547 2
a1548 2
  { "aam",	sIb, XX, XX },
  { "aad",	sIb, XX, XX },
d1572 1
a1572 1
  { "ljmp",	Ap, XX, XX },
d1605 1
a1605 1
  { "(bad)", XX, XX, XX },
d1607 1
a1607 1
  { "(bad)", XX, XX, XX },
d1637 4
a1640 4
  { "movL", Rd, Cd, XX },
  { "movL", Rd, Dd, XX },
  { "movL", Cd, Rd, XX },
  { "movL", Dd, Rd, XX },
d1781 2
a1782 2
  { "pushP", fs, XX, XX },
  { "popP", fs, XX, XX },
d1790 2
a1791 2
  { "pushP", gs, XX, XX },
  { "popP", gs, XX, XX },
d1826 8
a1833 8
  { "bswap", eAX, XX, XX },	/* bswap doesn't support 16 bit regs */
  { "bswap", eCX, XX, XX },
  { "bswap", eDX, XX, XX },
  { "bswap", eBX, XX, XX },
  { "bswap", eSP, XX, XX },
  { "bswap", eBP, XX, XX },
  { "bswap", eSI, XX, XX },
  { "bswap", eDI, XX, XX },
d1897 1
a1897 1
  { "(bad)", XX, XX, XX },
d1899 1
a1899 1
  { "(bad)", XX, XX, XX },
d1929 4
a1932 4
  { "mov", Rd, Cd, XX },
  { "mov", Rd, Dd, XX },
  { "mov", Cd, Rd, XX },
  { "mov", Dd, Rd, XX },
d2118 8
a2125 8
  { "bswap", eAX, XX, XX },	/* bswap doesn't support 16 bit regs */
  { "bswap", eCX, XX, XX },
  { "bswap", eDX, XX, XX },
  { "bswap", eBX, XX, XX },
  { "bswap", eSP, XX, XX },
  { "bswap", eBP, XX, XX },
  { "bswap", eSI, XX, XX },
  { "bswap", eDI, XX, XX },
d2263 5
a2267 1
static const char *names32[]={
d2269 1
d2273 1
d2278 4
d2426 4
a2429 4
    { "callP",	indirEv, XX, XX },
    { "lcallP",	indirEv, XX, XX },
    { "jmpP",	indirEv, XX, XX },
    { "ljmpP",	indirEv, XX, XX },
d2629 2
d2633 1
d2637 1
d2640 22
d2710 7
d2731 33
d2796 2
a2797 1
static unsigned int start_pc;
d2864 3
d2868 3
a2870 1
      || info->mach == bfd_mach_i386_i386_intel_syntax)
d2923 1
a2930 2
  obufp = obuf;

d2958 4
a2961 1
        dp = &dis386_intel[*codep];
d2963 4
a2966 1
        dp = &dis386_att[*codep];
d3064 8
d3099 1
a3099 1
      if (op_index[0] != -1)
d3109 1
a3109 1
      if (op_index[1] != -1)
d3119 1
a3119 1
      if (op_index[2] != -1)
d3124 7
d3570 7
d3581 1
d3587 11
a3597 5
	      if (sizeflag & DFLAG)
		*obufp++ = 'l';
	      else
		*obufp++ = 'w';
	      used_prefixes |= (prefixes & PREFIX_DATA);
d3601 1
d3610 2
a3611 2
	      if (sizeflag & DFLAG)
		*obufp++ = 'l';
d3613 7
a3619 2
		*obufp++ = 'w';
	      used_prefixes |= (prefixes & PREFIX_DATA);
d3623 1
d3626 6
a3631 1
	      if (sizeflag & DFLAG)
d3644 3
a3646 1
	      if (sizeflag & DFLAG)
d3651 2
a3652 1
	  used_prefixes |= (prefixes & PREFIX_DATA);
d3660 2
a3661 2
	      if (sizeflag & DFLAG)
		*obufp++ = 'l';
d3663 7
a3669 2
		*obufp++ = 'w';
	      used_prefixes |= (prefixes & PREFIX_DATA);
d3673 20
d3695 4
a3698 1
	  if (sizeflag & DFLAG)
d3704 5
d3719 2
a3720 1
	  used_prefixes |= (prefixes & PREFIX_DATA);
d3781 60
d3845 6
a3850 1
  int disp;
d3860 5
a3864 1
	  oappend (names8[rm]);
d3867 1
a3867 1
	  oappend (names16[rm]);
d3870 10
a3879 1
	  oappend (names32[rm]);
d3882 5
a3886 2
	  if (sizeflag & DFLAG)
	    oappend (names32[rm]);
d3888 1
a3888 1
	    oappend (names16[rm]);
d3924 6
d3936 1
a3936 1
	  if (base == 5)
d3939 3
a3941 1
	      disp = get32 ();
d3951 1
a3951 1
	  disp = get32 ();
d3956 1
a3956 1
        if (mod != 0 || base == 5)
d3958 1
a3958 1
            sprintf (scratchbuf, "0x%x", disp);
d3960 5
d3974 1
a3974 1
                  oappend("BYTE PTR ");
d3977 1
a3977 1
                  oappend("WORD PTR ");
d3980 1
a3980 1
                  oappend("DWORD PTR ");
d3983 1
a3983 1
                  oappend("QWORD PTR ");
d3985 6
d3992 1
a3992 1
                  oappend("XWORD PTR ");
d3999 2
d4002 3
d4006 1
a4006 1
	    oappend (names32[base]);
d4018 1
a4018 1
                      sprintf (scratchbuf, "%s", names32[index]);
d4021 1
a4021 1
		    sprintf (scratchbuf, ",%s", names32[index]);
d4037 1
a4037 1
            if (mod != 0 || base == 5)
d4040 1
a4040 6
                if (disp > 0)
                  {
                    sprintf (scratchbuf, "+%d", disp);
                    oappend (scratchbuf);
                  }
                else if (disp < 0)
d4042 1
a4042 1
                    sprintf (scratchbuf, "%d", disp);
d4052 1
a4052 1
          if (mod != 0 || base == 5)
d4062 1
a4062 1
              sprintf (scratchbuf, "0x%x", disp);
d4072 1
a4072 1
	  if (rm == 6)
d4093 1
a4093 1
        if (mod != 0 || rm == 6)
d4095 1
a4095 1
            sprintf (scratchbuf, "%d", disp);
d4099 1
a4099 1
      if (mod != 0 || rm != 6)
d4103 1
a4103 1
	  oappend (index16[rm]);
d4115 4
d4122 5
a4126 1
      oappend (names8[reg]);
d4129 1
a4129 1
      oappend (names16[reg]);
d4132 4
a4135 1
      oappend (names32[reg]);
d4138 5
a4142 2
      if (sizeflag & DFLAG)
	oappend (names32[reg]);
d4144 1
a4144 1
	oappend (names16[reg]);
d4153 25
a4177 1
static int
d4180 14
a4193 1
  int x = 0;
d4196 7
a4202 4
  x = *codep++ & 0xff;
  x |= (*codep++ & 0xff) << 8;
  x |= (*codep++ & 0xff) << 16;
  x |= (*codep++ & 0xff) << 24;
d4218 1
a4218 1
set_op (op)
d4220 1
d4224 1
d4233 54
d4303 5
a4307 1
      s = names8[code - al_reg];
d4311 4
a4314 1
      if (sizeflag & DFLAG)
d4332 52
a4383 1
  int op;
d4389 2
a4390 1
      op = *codep++ & 0xff;
d4393 8
a4400 2
      if (sizeflag & DFLAG)
	op = get32 ();
d4402 4
a4405 1
	op = get16 ();
d4409 1
d4417 3
a4419 4
  if (intel_syntax)
    sprintf (scratchbuf, "0x%x", op);
  else
    sprintf (scratchbuf, "$0x%x", op);
d4429 2
a4430 1
  int op;
d4439 1
d4442 8
a4449 2
      if (sizeflag & DFLAG)
	op = get32 ();
d4452 1
d4461 1
d4469 3
a4471 4
  if (intel_syntax)
    sprintf (scratchbuf, "%d", op);
  else
    sprintf (scratchbuf, "$0x%x", op);
d4480 1
a4480 1
  int disp;
d4493 1
a4493 1
	disp = get32 ();
d4509 2
a4510 2
  set_op (disp);
  sprintf (scratchbuf, "0x%x", disp);
d4552 2
a4553 2
OP_OFF (ignore, sizeflag)
     int ignore ATTRIBUTE_UNUSED;
d4556 1
a4556 1
  int off;
d4574 25
a4598 1
  sprintf (scratchbuf, "0x%x", off);
d4609 4
a4612 1
  if (sizeflag & AFLAG)
d4652 5
a4656 1
  sprintf (scratchbuf, "%%cr%d", reg);
d4666 5
a4670 1
  sprintf (scratchbuf, "%%db%d", reg);
@


1.9
log
@1999-09-04  H.J. Lu  <hjl@@gnu.org>

	* i386-dis.c (print_insn_i386): Set bytes_per_line to 7.
@
text
@d1752 1
a1752 1
    { "callP",	indirEv, XX, XX },
@


1.8
log
@
Add AMD athlon support to x86 assembler and disassembler.
@
text
@d2131 1
a2131 1
  /* The output looks better if we put 6 bytes on a line, since that
d2133 1
a2133 1
  info->bytes_per_line = 6;
@


1.7
log
@	* dis-buf.c: Add ATTRIBUTE_UNUSED as appropriate.
	(generic_strcat_address): Add cast to avoid warning.
	* i386-dis.c: Initialize all structure fields to avoid warnings.
	Add ATTRIBUTE_UNUSED as appropriate.
@
text
@d3608 1
a3608 1
/* 0C */	NULL,		"pi2fd",	NULL,		NULL,
d3612 1
a3612 1
/* 1C */	NULL,		"pf2id",	NULL,		NULL,
d3639 2
a3640 2
/* 88 */	NULL,		NULL,		NULL,		NULL,
/* 8C */	NULL,		NULL,		NULL,		NULL,
d3651 1
a3651 1
/* B8 */	NULL,		NULL,		NULL,		NULL,
@


1.6
log
@P
include/opcode/i386.h: Allow bswapl, arplw, and other dodgy insns.
opcodes/i386-dis.c: Fix a comment
@
text
@d121 2
d284 39
a322 39
#define GRP1b NULL, NULL, 0, NULL, USE_GROUPS
#define GRP1S NULL, NULL, 1, NULL, USE_GROUPS
#define GRP1Ss NULL, NULL, 2, NULL, USE_GROUPS
#define GRP2b NULL, NULL, 3, NULL, USE_GROUPS
#define GRP2S NULL, NULL, 4, NULL, USE_GROUPS
#define GRP2b_one NULL, NULL, 5, NULL, USE_GROUPS
#define GRP2S_one NULL, NULL, 6, NULL, USE_GROUPS
#define GRP2b_cl NULL, NULL, 7, NULL, USE_GROUPS
#define GRP2S_cl NULL, NULL, 8, NULL, USE_GROUPS
#define GRP3b NULL, NULL, 9, NULL, USE_GROUPS
#define GRP3S NULL, NULL, 10, NULL, USE_GROUPS
#define GRP4  NULL, NULL, 11, NULL, USE_GROUPS
#define GRP5  NULL, NULL, 12, NULL, USE_GROUPS
#define GRP6  NULL, NULL, 13, NULL, USE_GROUPS
#define GRP7 NULL, NULL, 14, NULL, USE_GROUPS
#define GRP8 NULL, NULL, 15, NULL, USE_GROUPS
#define GRP9 NULL, NULL, 16, NULL, USE_GROUPS
#define GRP10 NULL, NULL, 17, NULL, USE_GROUPS
#define GRP11 NULL, NULL, 18, NULL, USE_GROUPS
#define GRP12 NULL, NULL, 19, NULL, USE_GROUPS
#define GRP13 NULL, NULL, 20, NULL, USE_GROUPS
#define GRP14 NULL, NULL, 21, NULL, USE_GROUPS
#define GRPAMD NULL, NULL, 22, NULL, USE_GROUPS

#define PREGRP0 NULL, NULL, 0, NULL, USE_PREFIX_USER_TABLE
#define PREGRP1 NULL, NULL, 1, NULL, USE_PREFIX_USER_TABLE
#define PREGRP2 NULL, NULL, 2, NULL, USE_PREFIX_USER_TABLE
#define PREGRP3 NULL, NULL, 3, NULL, USE_PREFIX_USER_TABLE
#define PREGRP4 NULL, NULL, 4, NULL, USE_PREFIX_USER_TABLE
#define PREGRP5 NULL, NULL, 5, NULL, USE_PREFIX_USER_TABLE
#define PREGRP6 NULL, NULL, 6, NULL, USE_PREFIX_USER_TABLE
#define PREGRP7 NULL, NULL, 7, NULL, USE_PREFIX_USER_TABLE
#define PREGRP8 NULL, NULL, 8, NULL, USE_PREFIX_USER_TABLE
#define PREGRP9 NULL, NULL, 9, NULL, USE_PREFIX_USER_TABLE
#define PREGRP10 NULL, NULL, 10, NULL, USE_PREFIX_USER_TABLE
#define PREGRP11 NULL, NULL, 11, NULL, USE_PREFIX_USER_TABLE
#define PREGRP12 NULL, NULL, 12, NULL, USE_PREFIX_USER_TABLE
#define PREGRP13 NULL, NULL, 13, NULL, USE_PREFIX_USER_TABLE
#define PREGRP14 NULL, NULL, 14, NULL, USE_PREFIX_USER_TABLE
d325 1
a325 1
#define FLOAT NULL, NULL, FLOATCODE
d353 8
a360 8
  { "addB",	Eb, Gb },
  { "addS",	Ev, Gv },
  { "addB",	Gb, Eb },
  { "addS",	Gv, Ev },
  { "addB",	AL, Ib },
  { "addS",	eAX, Iv },
  { "pushP",	es },
  { "popP",	es },
d362 8
a369 8
  { "orB",	Eb, Gb },
  { "orS",	Ev, Gv },
  { "orB",	Gb, Eb },
  { "orS",	Gv, Ev },
  { "orB",	AL, Ib },
  { "orS",	eAX, Iv },
  { "pushP",	cs },
  { "(bad)" },	/* 0x0f extended opcode escape */
d371 8
a378 8
  { "adcB",	Eb, Gb },
  { "adcS",	Ev, Gv },
  { "adcB",	Gb, Eb },
  { "adcS",	Gv, Ev },
  { "adcB",	AL, Ib },
  { "adcS",	eAX, Iv },
  { "pushP",	ss },
  { "popP",	ss },
d380 8
a387 8
  { "sbbB",	Eb, Gb },
  { "sbbS",	Ev, Gv },
  { "sbbB",	Gb, Eb },
  { "sbbS",	Gv, Ev },
  { "sbbB",	AL, Ib },
  { "sbbS",	eAX, Iv },
  { "pushP",	ds },
  { "popP",	ds },
d389 8
a396 8
  { "andB",	Eb, Gb },
  { "andS",	Ev, Gv },
  { "andB",	Gb, Eb },
  { "andS",	Gv, Ev },
  { "andB",	AL, Ib },
  { "andS",	eAX, Iv },
  { "(bad)" },			/* SEG ES prefix */
  { "daa" },
d398 8
a405 8
  { "subB",	Eb, Gb },
  { "subS",	Ev, Gv },
  { "subB",	Gb, Eb },
  { "subS",	Gv, Ev },
  { "subB",	AL, Ib },
  { "subS",	eAX, Iv },
  { "(bad)" },			/* SEG CS prefix */
  { "das" },
d407 8
a414 8
  { "xorB",	Eb, Gb },
  { "xorS",	Ev, Gv },
  { "xorB",	Gb, Eb },
  { "xorS",	Gv, Ev },
  { "xorB",	AL, Ib },
  { "xorS",	eAX, Iv },
  { "(bad)" },			/* SEG SS prefix */
  { "aaa" },
d416 8
a423 8
  { "cmpB",	Eb, Gb },
  { "cmpS",	Ev, Gv },
  { "cmpB",	Gb, Eb },
  { "cmpS",	Gv, Ev },
  { "cmpB",	AL, Ib },
  { "cmpS",	eAX, Iv },
  { "(bad)" },			/* SEG DS prefix */
  { "aas" },
d425 8
a432 8
  { "incS",	eAX },
  { "incS",	eCX },
  { "incS",	eDX },
  { "incS",	eBX },
  { "incS",	eSP },
  { "incS",	eBP },
  { "incS",	eSI },
  { "incS",	eDI },
d434 8
a441 8
  { "decS",	eAX },
  { "decS",	eCX },
  { "decS",	eDX },
  { "decS",	eBX },
  { "decS",	eSP },
  { "decS",	eBP },
  { "decS",	eSI },
  { "decS",	eDI },
d443 8
a450 8
  { "pushS",	eAX },
  { "pushS",	eCX },
  { "pushS",	eDX },
  { "pushS",	eBX },
  { "pushS",	eSP },
  { "pushS",	eBP },
  { "pushS",	eSI },
  { "pushS",	eDI },
d452 8
a459 8
  { "popS",	eAX },
  { "popS",	eCX },
  { "popS",	eDX },
  { "popS",	eBX },
  { "popS",	eSP },
  { "popS",	eBP },
  { "popS",	eSI },
  { "popS",	eDI },
d461 8
a468 8
  { "pushaP" },
  { "popaP" },
  { "boundS",	Gv, Ma },
  { "arpl",	Ew, Gw },
  { "(bad)" },			/* seg fs */
  { "(bad)" },			/* seg gs */
  { "(bad)" },			/* op size prefix */
  { "(bad)" },			/* adr size prefix */
d470 1
a470 1
  { "pushP",	Iv },		/* 386 book wrong */
d472 1
a472 1
  { "pushP",	sIb },		/* push of byte really pushes 2 or 4 bytes */
d474 4
a477 4
  { "insb",	Yb, indirDX },
  { "insR",	Yv, indirDX },
  { "outsb",	indirDX, Xb },
  { "outsR",	indirDX, Xv },
d479 8
a486 8
  { "jo",	Jb },
  { "jno",	Jb },
  { "jb",	Jb },
  { "jae",	Jb },
  { "je",	Jb },
  { "jne",	Jb },
  { "jbe",	Jb },
  { "ja",	Jb },
d488 8
a495 8
  { "js",	Jb },
  { "jns",	Jb },
  { "jp",	Jb },
  { "jnp",	Jb },
  { "jl",	Jb },
  { "jge",	Jb },
  { "jle",	Jb },
  { "jg",	Jb },
d499 1
a499 1
  { "(bad)" },
d501 4
a504 4
  { "testB",	Eb, Gb },
  { "testS",	Ev, Gv },
  { "xchgB",	Eb, Gb },
  { "xchgS",	Ev, Gv },
d506 8
a513 8
  { "movB",	Eb, Gb },
  { "movS",	Ev, Gv },
  { "movB",	Gb, Eb },
  { "movS",	Gv, Ev },
  { "movQ",	Ev, Sw },
  { "leaS",	Gv, M },
  { "movQ",	Sw, Ev },
  { "popQ",	Ev },
d515 8
a522 8
  { "nop" },
  { "xchgS",	eCX, eAX },
  { "xchgS",	eDX, eAX },
  { "xchgS",	eBX, eAX },
  { "xchgS",	eSP, eAX },
  { "xchgS",	eBP, eAX },
  { "xchgS",	eSI, eAX },
  { "xchgS",	eDI, eAX },
d524 8
a531 8
  { "cWtR" },
  { "cRtd" },
  { "lcallP",	Ap },
  { "(bad)" },		/* fwait */
  { "pushfP" },
  { "popfP" },
  { "sahf" },
  { "lahf" },
d533 8
a540 8
  { "movB",	AL, Ob },
  { "movS",	eAX, Ov },
  { "movB",	Ob, AL },
  { "movS",	Ov, eAX },
  { "movsb",	Yb, Xb },
  { "movsR",	Yv, Xv },
  { "cmpsb",	Xb, Yb },
  { "cmpsR",	Xv, Yv },
d542 8
a549 8
  { "testB",	AL, Ib },
  { "testS",	eAX, Iv },
  { "stosB",	Yb, AL },
  { "stosS",	Yv, eAX },
  { "lodsB",	AL, Xb },
  { "lodsS",	eAX, Xv },
  { "scasB",	AL, Yb },
  { "scasS",	eAX, Yv },
d551 8
a558 8
  { "movB",	AL, Ib },
  { "movB",	CL, Ib },
  { "movB",	DL, Ib },
  { "movB",	BL, Ib },
  { "movB",	AH, Ib },
  { "movB",	CH, Ib },
  { "movB",	DH, Ib },
  { "movB",	BH, Ib },
d560 8
a567 8
  { "movS",	eAX, Iv },
  { "movS",	eCX, Iv },
  { "movS",	eDX, Iv },
  { "movS",	eBX, Iv },
  { "movS",	eSP, Iv },
  { "movS",	eBP, Iv },
  { "movS",	eSI, Iv },
  { "movS",	eDI, Iv },
d571 6
a576 6
  { "retP",	Iw },
  { "retP" },
  { "lesS",	Gv, Mp },
  { "ldsS",	Gv, Mp },
  { "movA",	Eb, Ib },
  { "movQ",	Ev, Iv },
d578 8
a585 8
  { "enterP",	Iw, Ib },
  { "leaveP" },
  { "lretP",	Iw },
  { "lretP" },
  { "int3" },
  { "int",	Ib },
  { "into" },
  { "iretP" },
d591 4
a594 4
  { "aam",	sIb },
  { "aad",	sIb },
  { "(bad)" },
  { "xlat",	DSBX },
d605 8
a612 8
  { "loopne",	Jb },
  { "loope",	Jb },
  { "loop",	Jb },
  { "jEcxz",	Jb },
  { "inB",	AL, Ib },
  { "inS",	eAX, Ib },
  { "outB",	Ib, AL },
  { "outS",	Ib, eAX },
d614 8
a621 8
  { "callP",	Jv },
  { "jmpP",	Jv },
  { "ljmpP",	Ap },
  { "jmp",	Jb },
  { "inB",	AL, indirDX },
  { "inS",	eAX, indirDX },
  { "outB",	indirDX, AL },
  { "outS",	indirDX, eAX },
d623 6
a628 6
  { "(bad)" },			/* lock prefix */
  { "(bad)" },
  { "(bad)" },			/* repne */
  { "(bad)" },			/* repz */
  { "hlt" },
  { "cmc" },
d632 6
a637 6
  { "clc" },
  { "stc" },
  { "cli" },
  { "sti" },
  { "cld" },
  { "std" },
d644 8
a651 8
  { "add",	Eb, Gb },
  { "add",	Ev, Gv },
  { "add",	Gb, Eb },
  { "add",	Gv, Ev },
  { "add",	AL, Ib },
  { "add",	eAX, Iv },
  { "push",	es },
  { "pop",	es },
d653 8
a660 8
  { "or",	Eb, Gb },
  { "or",	Ev, Gv },
  { "or",	Gb, Eb },
  { "or",	Gv, Ev },
  { "or",	AL, Ib },
  { "or",	eAX, Iv },
  { "push",	cs },
  { "(bad)" },	/* 0x0f extended opcode escape */
d662 8
a669 8
  { "adc",	Eb, Gb },
  { "adc",	Ev, Gv },
  { "adc",	Gb, Eb },
  { "adc",	Gv, Ev },
  { "adc",	AL, Ib },
  { "adc",	eAX, Iv },
  { "push",	ss },
  { "pop",	ss },
d671 8
a678 8
  { "sbb",	Eb, Gb },
  { "sbb",	Ev, Gv },
  { "sbb",	Gb, Eb },
  { "sbb",	Gv, Ev },
  { "sbb",	AL, Ib },
  { "sbb",	eAX, Iv },
  { "push",	ds },
  { "pop",	ds },
d680 8
a687 8
  { "and",	Eb, Gb },
  { "and",	Ev, Gv },
  { "and",	Gb, Eb },
  { "and",	Gv, Ev },
  { "and",	AL, Ib },
  { "and",	eAX, Iv },
  { "(bad)" },			/* SEG ES prefix */
  { "daa" },
d689 8
a696 8
  { "sub",	Eb, Gb },
  { "sub",	Ev, Gv },
  { "sub",	Gb, Eb },
  { "sub",	Gv, Ev },
  { "sub",	AL, Ib },
  { "sub",	eAX, Iv },
  { "(bad)" },			/* SEG CS prefix */
  { "das" },
d698 8
a705 8
  { "xor",	Eb, Gb },
  { "xor",	Ev, Gv },
  { "xor",	Gb, Eb },
  { "xor",	Gv, Ev },
  { "xor",	AL, Ib },
  { "xor",	eAX, Iv },
  { "(bad)" },			/* SEG SS prefix */
  { "aaa" },
d707 8
a714 8
  { "cmp",	Eb, Gb },
  { "cmp",	Ev, Gv },
  { "cmp",	Gb, Eb },
  { "cmp",	Gv, Ev },
  { "cmp",	AL, Ib },
  { "cmp",	eAX, Iv },
  { "(bad)" },			/* SEG DS prefix */
  { "aas" },
d716 8
a723 8
  { "inc",	eAX },
  { "inc",	eCX },
  { "inc",	eDX },
  { "inc",	eBX },
  { "inc",	eSP },
  { "inc",	eBP },
  { "inc",	eSI },
  { "inc",	eDI },
d725 8
a732 8
  { "dec",	eAX },
  { "dec",	eCX },
  { "dec",	eDX },
  { "dec",	eBX },
  { "dec",	eSP },
  { "dec",	eBP },
  { "dec",	eSI },
  { "dec",	eDI },
d734 8
a741 8
  { "push",	eAX },
  { "push",	eCX },
  { "push",	eDX },
  { "push",	eBX },
  { "push",	eSP },
  { "push",	eBP },
  { "push",	eSI },
  { "push",	eDI },
d743 8
a750 8
  { "pop",	eAX },
  { "pop",	eCX },
  { "pop",	eDX },
  { "pop",	eBX },
  { "pop",	eSP },
  { "pop",	eBP },
  { "pop",	eSI },
  { "pop",	eDI },
d752 8
a759 8
  { "pusha" },
  { "popa" },
  { "bound",	Gv, Ma },
  { "arpl",	Ew, Gw },
  { "(bad)" },			/* seg fs */
  { "(bad)" },			/* seg gs */
  { "(bad)" },			/* op size prefix */
  { "(bad)" },			/* adr size prefix */
d761 1
a761 1
  { "push",	Iv },		/* 386 book wrong */
d763 1
a763 1
  { "push",	sIb },		/* push of byte really pushes 2 or 4 bytes */
d765 4
a768 4
  { "ins",	Yb, indirDX },
  { "ins",	Yv, indirDX },
  { "outs",	indirDX, Xb },
  { "outs",	indirDX, Xv },
d770 8
a777 8
  { "jo",	Jb },
  { "jno",	Jb },
  { "jb",	Jb },
  { "jae",	Jb },
  { "je",	Jb },
  { "jne",	Jb },
  { "jbe",	Jb },
  { "ja",	Jb },
d779 8
a786 8
  { "js",	Jb },
  { "jns",	Jb },
  { "jp",	Jb },
  { "jnp",	Jb },
  { "jl",	Jb },
  { "jge",	Jb },
  { "jle",	Jb },
  { "jg",	Jb },
d790 1
a790 1
  { "(bad)" },
d792 4
a795 4
  { "test",	Eb, Gb },
  { "test",	Ev, Gv },
  { "xchg",	Eb, Gb },
  { "xchg",	Ev, Gv },
d797 8
a804 8
  { "mov",	Eb, Gb },
  { "mov",	Ev, Gv },
  { "mov",	Gb, Eb },
  { "mov",	Gv, Ev },
  { "mov",	Ev, Sw },
  { "lea",	Gv, M },
  { "mov",	Sw, Ev },
  { "pop",	Ev },
d806 8
a813 8
  { "nop" },
  { "xchg",	eCX, eAX },
  { "xchg",	eDX, eAX },
  { "xchg",	eBX, eAX },
  { "xchg",	eSP, eAX },
  { "xchg",	eBP, eAX },
  { "xchg",	eSI, eAX },
  { "xchg",	eDI, eAX },
d815 8
a822 8
  { "cW" },		/* cwde and cbw */
  { "cR" },		/* cdq and cwd */
  { "lcall",	Ap },
  { "(bad)" },		/* fwait */
  { "pushf" },
  { "popf" },
  { "sahf" },
  { "lahf" },
d824 8
a831 8
  { "mov",	AL, Ob },
  { "mov",	eAX, Ov },
  { "mov",	Ob, AL },
  { "mov",	Ov, eAX },
  { "movs",	Yb, Xb },
  { "movs",	Yv, Xv },
  { "cmps",	Xb, Yb },
  { "cmps",	Xv, Yv },
d833 8
a840 8
  { "test",	AL, Ib },
  { "test",	eAX, Iv },
  { "stos",	Yb, AL },
  { "stos",	Yv, eAX },
  { "lods",	AL, Xb },
  { "lods",	eAX, Xv },
  { "scas",	AL, Yb },
  { "scas",	eAX, Yv },
d842 8
a849 8
  { "mov",	AL, Ib },
  { "mov",	CL, Ib },
  { "mov",	DL, Ib },
  { "mov",	BL, Ib },
  { "mov",	AH, Ib },
  { "mov",	CH, Ib },
  { "mov",	DH, Ib },
  { "mov",	BH, Ib },
d851 8
a858 8
  { "mov",	eAX, Iv },
  { "mov",	eCX, Iv },
  { "mov",	eDX, Iv },
  { "mov",	eBX, Iv },
  { "mov",	eSP, Iv },
  { "mov",	eBP, Iv },
  { "mov",	eSI, Iv },
  { "mov",	eDI, Iv },
d862 6
a867 6
  { "ret",	Iw },
  { "ret" },
  { "les",	Gv, Mp },
  { "lds",	Gv, Mp },
  { "mov",	Eb, Ib },
  { "mov",	Ev, Iv },
d869 8
a876 8
  { "enter",	Iw, Ib },
  { "leave" },
  { "lret",	Iw },
  { "lret" },
  { "int3" },
  { "int",	Ib },
  { "into" },
  { "iret" },
d882 4
a885 4
  { "aam",	sIb },
  { "aad",	sIb },
  { "(bad)" },
  { "xlat",	DSBX },
d896 8
a903 8
  { "loopne",	Jb },
  { "loope",	Jb },
  { "loop",	Jb },
  { "jEcxz",	Jb },
  { "in",	AL, Ib },
  { "in",	eAX, Ib },
  { "out",	Ib, AL },
  { "out",	Ib, eAX },
d905 8
a912 8
  { "call",	Jv },
  { "jmp",	Jv },
  { "ljmp",	Ap },
  { "jmp",	Jb },
  { "in",	AL, indirDX },
  { "in",	eAX, indirDX },
  { "out",	indirDX, AL },
  { "out",	indirDX, eAX },
d914 6
a919 6
  { "(bad)" },			/* lock prefix */
  { "(bad)" },
  { "(bad)" },			/* repne */
  { "(bad)" },			/* repz */
  { "hlt" },
  { "cmc" },
d923 6
a928 6
  { "clc" },
  { "stc" },
  { "cli" },
  { "sti" },
  { "cld" },
  { "std" },
d937 6
a942 6
  { "larS", Gv, Ew },
  { "lslS", Gv, Ew },
  { "(bad)" },
  { "(bad)" },
  { "clts" },
  { "(bad)" },
d944 5
a948 5
  { "invd" },
  { "wbinvd" },
  { "(bad)" },
  { "ud2a" },
  { "(bad)" },
d950 1
a950 1
  { "femms" },
d957 2
a958 2
  { "unpcklps", XM, EX },
  { "unpckhps", XM, EX },
d963 7
a969 2
  { "(bad)" },  { "(bad)" },  { "(bad)" },
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
d972 8
a979 8
  { "movL", Rd, Cd },
  { "movL", Rd, Dd },
  { "movL", Cd, Rd },
  { "movL", Dd, Rd },
  { "movL", Rd, Td },
  { "(bad)" },
  { "movL", Td, Rd },
  { "(bad)" },
d981 2
a982 2
  { "movaps", XM, EX },
  { "movaps", EX, XM },
d984 1
a984 1
  { "movntps", Ev, XM },
d987 2
a988 2
  { "ucomiss", XM, EX },
  { "comiss", XM, EX },
d990 8
a997 2
  { "wrmsr" },  { "rdtsc" },  { "rdmsr" },  { "rdpmc" },
  { "sysenter" },  { "sysexit" },  { "(bad)" },  { "(bad)" },
d999 8
a1006 2
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
d1008 8
a1015 2
  { "cmovo", Gv,Ev }, { "cmovno", Gv,Ev }, { "cmovb", Gv,Ev }, { "cmovae", Gv,Ev },
  { "cmove", Gv,Ev }, { "cmovne", Gv,Ev }, { "cmovbe", Gv,Ev }, { "cmova", Gv,Ev },
d1017 8
a1024 2
  { "cmovs", Gv,Ev }, { "cmovns", Gv,Ev }, { "cmovp", Gv,Ev }, { "cmovnp", Gv,Ev },
  { "cmovl", Gv,Ev }, { "cmovge", Gv,Ev }, { "cmovle", Gv,Ev }, { "cmovg", Gv,Ev },
d1026 1
a1026 1
  { "movmskps", Gv, EX },
d1030 4
a1033 4
  { "andps", XM, EX },
  { "andnps", XM, EX },
  { "orps", XM, EX },
  { "xorps", XM, EX },
d1037 2
a1038 2
  { "(bad)" },
  { "(bad)" },
d1044 8
a1051 8
  { "punpcklbw", MX, EM },
  { "punpcklwd", MX, EM },
  { "punpckldq", MX, EM },
  { "packsswb", MX, EM },
  { "pcmpgtb", MX, EM },
  { "pcmpgtw", MX, EM },
  { "pcmpgtd", MX, EM },
  { "packuswb", MX, EM },
d1053 8
a1060 7
  { "punpckhbw", MX, EM },
  { "punpckhwd", MX, EM },
  { "punpckhdq", MX, EM },
  { "packssdw", MX, EM },
  { "(bad)" },  { "(bad)" },
  { "movd", MX, Ed },
  { "movq", MX, EM },
d1066 4
a1069 4
  { "pcmpeqb", MX, EM },
  { "pcmpeqw", MX, EM },
  { "pcmpeqd", MX, EM },
  { "emms" },
d1071 8
a1078 4
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
  { "(bad)" },  { "(bad)" },
  { "movd", Ed, MX },
  { "movq", EM, MX },
d1080 8
a1087 8
  { "jo", Jv },
  { "jno", Jv },
  { "jb", Jv },
  { "jae", Jv },
  { "je", Jv },
  { "jne", Jv },
  { "jbe", Jv },
  { "ja", Jv },
d1089 8
a1096 8
  { "js", Jv },
  { "jns", Jv },
  { "jp", Jv },
  { "jnp", Jv },
  { "jl", Jv },
  { "jge", Jv },
  { "jle", Jv },
  { "jg", Jv },
d1098 8
a1105 8
  { "seto", Eb },
  { "setno", Eb },
  { "setb", Eb },
  { "setae", Eb },
  { "sete", Eb },
  { "setne", Eb },
  { "setbe", Eb },
  { "seta", Eb },
d1107 8
a1114 8
  { "sets", Eb },
  { "setns", Eb },
  { "setp", Eb },
  { "setnp", Eb },
  { "setl", Eb },
  { "setge", Eb },
  { "setle", Eb },
  { "setg", Eb },
d1116 4
a1119 4
  { "pushP", fs },
  { "popP", fs },
  { "cpuid" },
  { "btS", Ev, Gv },
d1122 2
a1123 2
  { "(bad)" },
  { "(bad)" },
d1125 4
a1128 4
  { "pushP", gs },
  { "popP", gs },
  { "rsm" },
  { "btsS", Ev, Gv },
d1132 1
a1132 1
  { "imulS", Gv, Ev },
d1134 8
a1141 8
  { "cmpxchgB", Eb, Gb },
  { "cmpxchgS", Ev, Gv },
  { "lssS", Gv, Mp },
  { "btrS", Ev, Gv },
  { "lfsS", Gv, Mp },
  { "lgsS", Gv, Mp },
  { "movzbR", Gv, Eb },
  { "movzwR", Gv, Ew }, /* yes, there really is movzww ! */
d1143 2
a1144 2
  { "(bad)" },
  { "ud2b" },
d1146 5
a1150 5
  { "btcS", Ev, Gv },
  { "bsfS", Gv, Ev },
  { "bsrS", Gv, Ev },
  { "movsbR", Gv, Eb },
  { "movswR", Gv, Ew }, /* yes, there really is movsww ! */
d1152 2
a1153 2
  { "xaddB", Eb, Gb },
  { "xaddS", Ev, Gv },
d1155 1
a1155 1
  { "(bad)" },
d1161 8
a1168 8
  { "bswap", eAX },	/* bswap doesn't support 16 bit regs */
  { "bswap", eCX },
  { "bswap", eDX },
  { "bswap", eBX },
  { "bswap", eSP },
  { "bswap", eBP },
  { "bswap", eSI },
  { "bswap", eDI },
d1170 8
a1177 8
  { "(bad)" },
  { "psrlw", MX, EM },
  { "psrld", MX, EM },
  { "psrlq", MX, EM },
  { "(bad)" },
  { "pmullw", MX, EM },
  { "(bad)" },
  { "pmovmskb", Ev, MX },
d1179 8
a1186 8
  { "psubusb", MX, EM },
  { "psubusw", MX, EM },
  { "pminub", MX, EM },
  { "pand", MX, EM },
  { "paddusb", MX, EM },
  { "paddusw", MX, EM },
  { "pmaxub", MX, EM },
  { "pandn", MX, EM },
d1188 8
a1195 8
  { "pavgb", MX, EM },
  { "psraw", MX, EM },
  { "psrad", MX, EM },
  { "pavgw", MX, EM },
  { "pmulhuw", MX, EM },
  { "pmulhw", MX, EM },
  { "(bad)" },
  { "movntq", Ev, MX },
d1197 8
a1204 8
  { "psubsb", MX, EM },
  { "psubsw", MX, EM },
  { "pminsw", MX, EM },
  { "por", MX, EM },
  { "paddsb", MX, EM },
  { "paddsw", MX, EM },
  { "pmaxsw", MX, EM },
  { "pxor", MX, EM },
d1206 8
a1213 8
  { "(bad)" },
  { "psllw", MX, EM },
  { "pslld", MX, EM },
  { "psllq", MX, EM },
  { "(bad)" },
  { "pmaddwd", MX, EM },
  { "psadbw", MX, EM },
  { "maskmovq", MX, EM },
d1215 8
a1222 8
  { "psubb", MX, EM },
  { "psubw", MX, EM },
  { "psubd", MX, EM },
  { "(bad)" },
  { "paddb", MX, EM },
  { "paddw", MX, EM },
  { "paddd", MX, EM },
  { "(bad)" }
d1229 6
a1234 6
  { "lar", Gv, Ew },
  { "lsl", Gv, Ew },
  { "(bad)" },
  { "(bad)" },
  { "clts" },
  { "(bad)" },
d1236 5
a1240 5
  { "invd" },
  { "wbinvd" },
  { "(bad)" },
  { "ud2a" },
  { "(bad)" },
d1242 1
a1242 1
  { "femms" },
d1249 2
a1250 2
  { "unpcklps", XM, EX },
  { "unpckhps", XM, EX },
d1255 7
a1261 2
  { "(bad)" },  { "(bad)" },  { "(bad)" },
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
d1264 8
a1271 8
  { "mov", Rd, Cd },
  { "mov", Rd, Dd },
  { "mov", Cd, Rd },
  { "mov", Dd, Rd },
  { "mov", Rd, Td },
  { "(bad)" },
  { "mov", Td, Rd },
  { "(bad)" },
d1273 2
a1274 2
  { "movaps", XM, EX },
  { "movaps", EX, XM },
d1276 1
a1276 1
  { "movntps", Ev, XM },
d1279 2
a1280 2
  { "ucomiss", XM, EX },
  { "comiss", XM, EX },
d1282 8
a1289 2
  { "wrmsr" },  { "rdtsc" },  { "rdmsr" },  { "rdpmc" },
  { "sysenter" },  { "sysexit" },  { "(bad)" },  { "(bad)" },
d1291 8
a1298 2
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
d1300 8
a1307 2
  { "cmovo", Gv,Ev }, { "cmovno", Gv,Ev }, { "cmovb", Gv,Ev }, { "cmovae", Gv,Ev },
  { "cmove", Gv,Ev }, { "cmovne", Gv,Ev }, { "cmovbe", Gv,Ev }, { "cmova", Gv,Ev },
d1309 8
a1316 2
  { "cmovs", Gv,Ev }, { "cmovns", Gv,Ev }, { "cmovp", Gv,Ev }, { "cmovnp", Gv,Ev },
  { "cmovl", Gv,Ev }, { "cmovge", Gv,Ev }, { "cmovle", Gv,Ev }, { "cmovg", Gv,Ev },
d1318 1
a1318 1
  { "movmskps", Gv, EX },
d1322 4
a1325 4
  { "andps", XM, EX },
  { "andnps", XM, EX },
  { "orps", XM, EX },
  { "xorps", XM, EX },
d1329 2
a1330 2
  { "(bad)" },
  { "(bad)" },
d1336 8
a1343 8
  { "punpcklbw", MX, EM },
  { "punpcklwd", MX, EM },
  { "punpckldq", MX, EM },
  { "packsswb", MX, EM },
  { "pcmpgtb", MX, EM },
  { "pcmpgtw", MX, EM },
  { "pcmpgtd", MX, EM },
  { "packuswb", MX, EM },
d1345 8
a1352 7
  { "punpckhbw", MX, EM },
  { "punpckhwd", MX, EM },
  { "punpckhdq", MX, EM },
  { "packssdw", MX, EM },
  { "(bad)" },  { "(bad)" },
  { "movd", MX, Ed },
  { "movq", MX, EM },
d1358 4
a1361 4
  { "pcmpeqb", MX, EM },
  { "pcmpeqw", MX, EM },
  { "pcmpeqd", MX, EM },
  { "emms" },
d1363 8
a1370 4
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
  { "(bad)" },  { "(bad)" },
  { "movd", Ed, MX },
  { "movq", EM, MX },
d1372 8
a1379 8
  { "jo", Jv },
  { "jno", Jv },
  { "jb", Jv },
  { "jae", Jv },
  { "je", Jv },
  { "jne", Jv },
  { "jbe", Jv },
  { "ja", Jv },
d1381 8
a1388 8
  { "js", Jv },
  { "jns", Jv },
  { "jp", Jv },
  { "jnp", Jv },
  { "jl", Jv },
  { "jge", Jv },
  { "jle", Jv },
  { "jg", Jv },
d1390 8
a1397 8
  { "seto", Eb },
  { "setno", Eb },
  { "setb", Eb },
  { "setae", Eb },
  { "sete", Eb },
  { "setne", Eb },
  { "setbe", Eb },
  { "seta", Eb },
d1399 8
a1406 8
  { "sets", Eb },
  { "setns", Eb },
  { "setp", Eb },
  { "setnp", Eb },
  { "setl", Eb },
  { "setge", Eb },
  { "setle", Eb },
  { "setg", Eb },
d1408 4
a1411 4
  { "push", fs },
  { "pop", fs },
  { "cpuid" },
  { "bt", Ev, Gv },
d1414 2
a1415 2
  { "(bad)" },
  { "(bad)" },
d1417 4
a1420 4
  { "push", gs },
  { "pop", gs },
  { "rsm" },
  { "bts", Ev, Gv },
d1424 1
a1424 1
  { "imul", Gv, Ev },
d1426 8
a1433 8
  { "cmpxchg", Eb, Gb },
  { "cmpxchg", Ev, Gv },
  { "lss", Gv, Mp },
  { "btr", Ev, Gv },
  { "lfs", Gv, Mp },
  { "lgs", Gv, Mp },
  { "movzx", Gv, Eb },
  { "movzx", Gv, Ew },
d1435 2
a1436 2
  { "(bad)" },
  { "ud2b" },
d1438 5
a1442 5
  { "btc", Ev, Gv },
  { "bsf", Gv, Ev },
  { "bsr", Gv, Ev },
  { "movsx", Gv, Eb },
  { "movsx", Gv, Ew },
d1444 2
a1445 2
  { "xadd", Eb, Gb },
  { "xadd", Ev, Gv },
d1447 1
a1447 1
  { "(bad)" },
d1453 8
a1460 8
  { "bswap", eAX },	/* bswap doesn't support 16 bit regs */
  { "bswap", eCX },
  { "bswap", eDX },
  { "bswap", eBX },
  { "bswap", eSP },
  { "bswap", eBP },
  { "bswap", eSI },
  { "bswap", eDI },
d1462 8
a1469 8
  { "(bad)" },
  { "psrlw", MX, EM },
  { "psrld", MX, EM },
  { "psrlq", MX, EM },
  { "(bad)" },
  { "pmullw", MX, EM },
  { "(bad)" },
  { "pmovmskb", Ev, MX },
d1471 8
a1478 8
  { "psubusb", MX, EM },
  { "psubusw", MX, EM },
  { "pminub", MX, EM },
  { "pand", MX, EM },
  { "paddusb", MX, EM },
  { "paddusw", MX, EM },
  { "pmaxub", MX, EM },
  { "pandn", MX, EM },
d1480 8
a1487 8
  { "pavgb", MX, EM },
  { "psraw", MX, EM },
  { "psrad", MX, EM },
  { "pavgw", MX, EM },
  { "pmulhuw", MX, EM },
  { "pmulhw", MX, EM },
  { "(bad)" },
  { "movntq", Ev, MX },
d1489 8
a1496 8
  { "psubsb", MX, EM },
  { "psubsw", MX, EM },
  { "pminsw", MX, EM },
  { "por", MX, EM },
  { "paddsb", MX, EM },
  { "paddsw", MX, EM },
  { "pmaxsw", MX, EM },
  { "pxor", MX, EM },
d1498 8
a1505 8
  { "(bad)" },
  { "psllw", MX, EM },
  { "pslld", MX, EM },
  { "psllq", MX, EM },
  { "(bad)" },
  { "pmaddwd", MX, EM },
  { "psadbw", MX, EM },
  { "maskmovq", MX, EM },
d1507 8
a1514 8
  { "psubb", MX, EM },
  { "psubw", MX, EM },
  { "psubd", MX, EM },
  { "(bad)" },
  { "paddb", MX, EM },
  { "paddw", MX, EM },
  { "paddd", MX, EM },
  { "(bad)" }
d1617 8
a1624 8
    { "addA",	Eb, Ib },
    { "orA",	Eb, Ib },
    { "adcA",	Eb, Ib },
    { "sbbA",	Eb, Ib },
    { "andA",	Eb, Ib },
    { "subA",	Eb, Ib },
    { "xorA",	Eb, Ib },
    { "cmpA",	Eb, Ib }
d1628 8
a1635 8
    { "addQ",	Ev, Iv },
    { "orQ",	Ev, Iv },
    { "adcQ",	Ev, Iv },
    { "sbbQ",	Ev, Iv },
    { "andQ",	Ev, Iv },
    { "subQ",	Ev, Iv },
    { "xorQ",	Ev, Iv },
    { "cmpQ",	Ev, Iv }
d1639 8
a1646 8
    { "addQ",	Ev, sIb },
    { "orQ",	Ev, sIb },
    { "adcQ",	Ev, sIb },
    { "sbbQ",	Ev, sIb },
    { "andQ",	Ev, sIb },
    { "subQ",	Ev, sIb },
    { "xorQ",	Ev, sIb },
    { "cmpQ",	Ev, sIb }
d1650 8
a1657 8
    { "rolA",	Eb, Ib },
    { "rorA",	Eb, Ib },
    { "rclA",	Eb, Ib },
    { "rcrA",	Eb, Ib },
    { "shlA",	Eb, Ib },
    { "shrA",	Eb, Ib },
    { "(bad)" },
    { "sarA",	Eb, Ib },
d1661 8
a1668 8
    { "rolQ",	Ev, Ib },
    { "rorQ",	Ev, Ib },
    { "rclQ",	Ev, Ib },
    { "rcrQ",	Ev, Ib },
    { "shlQ",	Ev, Ib },
    { "shrQ",	Ev, Ib },
    { "(bad)" },
    { "sarQ",	Ev, Ib },
d1672 8
a1679 8
    { "rolA",	Eb },
    { "rorA",	Eb },
    { "rclA",	Eb },
    { "rcrA",	Eb },
    { "shlA",	Eb },
    { "shrA",	Eb },
    { "(bad)" },
    { "sarA",	Eb },
d1683 8
a1690 8
    { "rolQ",	Ev },
    { "rorQ",	Ev },
    { "rclQ",	Ev },
    { "rcrQ",	Ev },
    { "shlQ",	Ev },
    { "shrQ",	Ev },
    { "(bad)" },
    { "sarQ",	Ev },
d1694 8
a1701 8
    { "rolA",	Eb, CL },
    { "rorA",	Eb, CL },
    { "rclA",	Eb, CL },
    { "rcrA",	Eb, CL },
    { "shlA",	Eb, CL },
    { "shrA",	Eb, CL },
    { "(bad)" },
    { "sarA",	Eb, CL },
d1705 8
a1712 8
    { "rolQ",	Ev, CL },
    { "rorQ",	Ev, CL },
    { "rclQ",	Ev, CL },
    { "rcrQ",	Ev, CL },
    { "shlQ",	Ev, CL },
    { "shrQ",	Ev, CL },
    { "(bad)" },
    { "sarQ",	Ev, CL }
d1716 8
a1723 8
    { "testA",	Eb, Ib },
    { "(bad)",	Eb },
    { "notA",	Eb },
    { "negA",	Eb },
    { "mulB",	AL, Eb },
    { "imulB",	AL, Eb },
    { "divB",	AL, Eb },
    { "idivB",	AL, Eb }
d1727 8
a1734 8
    { "testQ",	Ev, Iv },
    { "(bad)" },
    { "notQ",	Ev },
    { "negQ",	Ev },
    { "mulS",	eAX, Ev },
    { "imulS",	eAX, Ev },
    { "divS",	eAX, Ev },
    { "idivS",	eAX, Ev },
d1738 8
a1745 8
    { "incA", Eb },
    { "decA", Eb },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
d1749 8
a1756 8
    { "incQ",	Ev },
    { "decQ",	Ev },
    { "callP",	indirEv },
    { "callP",	indirEv },
    { "jmpP",	indirEv },
    { "ljmpP",	indirEv },
    { "pushQ",	Ev },
    { "(bad)" },
d1760 8
a1767 8
    { "sldt",	Ew },
    { "str",	Ew },
    { "lldt",	Ew },
    { "ltr",	Ew },
    { "verr",	Ew },
    { "verw",	Ew },
    { "(bad)" },
    { "(bad)" }
d1771 8
a1778 8
    { "sgdt", Ew },
    { "sidt", Ew },
    { "lgdt", Ew },
    { "lidt", Ew },
    { "smsw", Ew },
    { "(bad)" },
    { "lmsw", Ew },
    { "invlpg", Ew },
d1782 8
a1789 8
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "btQ",	Ev, Ib },
    { "btsQ",	Ev, Ib },
    { "btrQ",	Ev, Ib },
    { "btcQ",	Ev, Ib },
d1793 8
a1800 8
    { "(bad)" },
    { "cmpxchg8b", Ev },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
d1804 8
a1811 8
    { "(bad)" },
    { "(bad)" },
    { "psrlw", MS, Ib },
    { "(bad)" },
    { "psraw", MS, Ib },
    { "(bad)" },
    { "psllw", MS, Ib },
    { "(bad)" },
d1815 8
a1822 8
    { "(bad)" },
    { "(bad)" },
    { "psrld", MS, Ib },
    { "(bad)" },
    { "psrad", MS, Ib },
    { "(bad)" },
    { "pslld", MS, Ib },
    { "(bad)" },
d1826 8
a1833 8
    { "(bad)" },
    { "(bad)" },
    { "psrlq", MS, Ib },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "psllq", MS, Ib },
    { "(bad)" },
d1837 8
a1844 8
    { "fxsave", Ev },
    { "fxrstor", Ev },
    { "ldmxcsr", Ev },
    { "stmxcsr", Ev },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "sfence", None },
d1848 8
a1855 8
    { "prefetchnta", Ev },
    { "prefetcht0", Ev },
    { "prefetcht1", Ev },
    { "prefetcht2", Ev },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
d1859 8
a1866 8
    { "prefetch", Eb },
    { "prefetchw", Eb },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
d1874 2
a1875 2
    { "addps", XM, EX },
    { "addss", XM, EX },
d1884 2
a1885 2
    { "cvtpi2ps", XM, EM },
    { "cvtsi2ss", XM, Ev },
d1889 2
a1890 2
    { "cvtps2pi", MX, EX },
    { "cvtss2si", Gv, EX },
d1894 2
a1895 2
    { "cvttps2pi", MX, EX },
    { "cvttss2si", Gv, EX },
d1899 2
a1900 2
    { "divps", XM, EX },
    { "divss", XM, EX },
d1904 2
a1905 2
    { "maxps", XM, EX },
    { "maxss", XM, EX },
d1909 2
a1910 2
    { "minps", XM, EX },
    { "minss", XM, EX },
d1914 2
a1915 2
    { "movups", XM, EX },
    { "movss", XM, EX },
d1919 2
a1920 2
    { "movups", EX, XM },
    { "movss", EX, XM },
d1924 2
a1925 2
    { "mulps", XM, EX },
    { "mulss", XM, EX },
d1929 2
a1930 2
    { "rcpps", XM, EX },
    { "rcpss", XM, EX },
d1934 2
a1935 2
    { "rsqrtps", XM, EX },
    { "rsqrtss", XM, EX },
d1939 2
a1940 2
    { "sqrtps", XM, EX },
    { "sqrtss", XM, EX },
d1944 2
a1945 2
    { "subps", XM, EX },
    { "subss", XM, EX },
d2116 2
a2117 1
  int sizeflag, orig_sizeflag;
d2520 9
a2528 9
#define FGRPd9_2 NULL, NULL, 0
#define FGRPd9_4 NULL, NULL, 1
#define FGRPd9_5 NULL, NULL, 2
#define FGRPd9_6 NULL, NULL, 3
#define FGRPd9_7 NULL, NULL, 4
#define FGRPda_5 NULL, NULL, 5
#define FGRPdb_4 NULL, NULL, 6
#define FGRPde_3 NULL, NULL, 7
#define FGRPdf_4 NULL, NULL, 8
d2533 8
a2540 8
    { "fadd",	ST, STi },
    { "fmul",	ST, STi },
    { "fcom",	STi },
    { "fcomp",	STi },
    { "fsub",	ST, STi },
    { "fsubr",	ST, STi },
    { "fdiv",	ST, STi },
    { "fdivr",	ST, STi },
d2544 2
a2545 2
    { "fld",	STi },
    { "fxch",	STi },
d2547 1
a2547 1
    { "(bad)" },
d2555 5
a2559 5
    { "fcmovb",	ST, STi },
    { "fcmove",	ST, STi },
    { "fcmovbe",ST, STi },
    { "fcmovu",	ST, STi },
    { "(bad)" },
d2561 2
a2562 2
    { "(bad)" },
    { "(bad)" },
d2566 4
a2569 4
    { "fcmovnb",ST, STi },
    { "fcmovne",ST, STi },
    { "fcmovnbe",ST, STi },
    { "fcmovnu",ST, STi },
d2571 3
a2573 3
    { "fucomi",	ST, STi },
    { "fcomi",	ST, STi },
    { "(bad)" },
d2577 4
a2580 4
    { "fadd",	STi, ST },
    { "fmul",	STi, ST },
    { "(bad)" },
    { "(bad)" },
d2582 4
a2585 4
    { "fsub",	STi, ST },
    { "fsubr",	STi, ST },
    { "fdiv",	STi, ST },
    { "fdivr",	STi, ST },
d2587 4
a2590 4
    { "fsubr",	STi, ST },
    { "fsub",	STi, ST },
    { "fdivr",	STi, ST },
    { "fdiv",	STi, ST },
d2595 8
a2602 8
    { "ffree",	STi },
    { "(bad)" },
    { "fst",	STi },
    { "fstp",	STi },
    { "fucom",	STi },
    { "fucomp",	STi },
    { "(bad)" },
    { "(bad)" },
d2606 3
a2608 3
    { "faddp",	STi, ST },
    { "fmulp",	STi, ST },
    { "(bad)" },
d2611 4
a2614 4
    { "fsubp",	STi, ST },
    { "fsubrp",	STi, ST },
    { "fdivp",	STi, ST },
    { "fdivrp",	STi, ST },
d2616 4
a2619 4
    { "fsubrp",	STi, ST },
    { "fsubp",	STi, ST },
    { "fdivrp",	STi, ST },
    { "fdivp",	STi, ST },
d2624 4
a2627 4
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
    { "(bad)" },
d2629 3
a2631 3
    { "fucomip",ST, STi },
    { "fcomip", ST, STi },
    { "(bad)" },
d2735 2
a2736 2
     int ignore;
     int sizeflag;
d2744 2
a2745 2
     int ignore;
     int sizeflag;
d3400 2
a3401 2
     int dummy;
     int sizeflag;
d3413 1
a3413 1
     int dummy;
d3436 1
a3436 1
     int ignore;
d3505 2
a3506 2
     int dummy;
     int sizeflag;
d3515 2
a3516 2
     int dummy;
     int sizeflag;
d3525 2
a3526 2
     int dummy;
     int sizeflag;
d3545 2
a3546 2
     int ignore;
     int sizeflag;
d3554 2
a3555 2
     int bytemode;
     int sizeflag;
d3673 2
a3674 2
     int bytemode;
     int sizeflag;
d3712 2
a3713 2
     int bytemode;
     int sizeflag;
d3740 1
a3740 1
     int sizeflag;
@


1.5
log
@Rework last checkin to the following:
	* i386-dis.c (FWAIT_OPCODE): Define.
	(used_prefixes): New static variable.
	(fetch_data): Don't print an error message if we have already
	fetched some bytes successfully.
	(ckprefix): Clear used_prefixes.  Use FWAIT_OPCODE, not 0x9b.
	(prefix_name): New static function.
	(print_insn_i386): If setjmp fails, indicating a data error, but
	we have managed to fetch some bytes, print the first one as a
	prefix or a .byte pseudo-op.  If fwait is followed by a non
	floating point instruction, print the first prefix.  Set
	used_prefixes when prefixes are used.  If any prefixes were not
	used after disassembling the instruction, print the first prefix
	instead of printing the instruction.
	(putop): Set used_prefixes when prefixes are used.
	(append_seg, OP_E, OP_G, OP_REG, OP_I, OP_sI, OP_J): Likewise.
	(OP_DIR, OP_SIMD_Suffix): Likewise.
@
text
@d344 1
a344 1
   'R' => print 'w' or 'l'
d346 1
a346 1
   'W' => print 'b' or 'w'
@


1.4
log
@	* i386-dis.c (FWAIT_OPCODE): Define.
	(fetch_data): Don't print an error message if we have already
	found an fwait prefix.
	(ckprefix): Use FWAIT_OPCODE rather than 0x9b.
	(print_insn_i386): If setjmp fails, indicating a data error, but
	we have found an fwait prefix, then print it as an fwait
	instruction.  In any case, return the number of bytes consumed, if
	any, rather than always returning -1.
@
text
@d68 4
d108 5
a112 9
      /* If we have found an fwait prefix and an fwait opcode, then
	 print_insn_i386 will arrange to print an instruction after we
	 longjmp, and we don't want to print an error message here.
	 This hack is required because we treat fwait as a prefix, but
	 since fwait is really an instruction we want to print a
	 standalone fwait correctly.  */
      if ((prefixes & PREFIX_FWAIT) == 0
	  || memchr (priv->the_buffer, FWAIT_OPCODE,
		     priv->max_fetched - priv->the_buffer) == NULL)
d233 1
d1885 1
d1943 39
d2046 1
a2046 1
  int sizeflag;
d2058 1
d2082 2
d2085 3
a2087 4
         means we have an incomplete instruction of some sort.
         However, we need to check at least one case here: fwait is a
         complete instruction, although we treat it as a prefix.  */
      if (prefixes & PREFIX_FWAIT)
d2089 4
a2092 4
	  unsigned char *p;

	  p = memchr (inbuf, FWAIT_OPCODE, codep - inbuf);
	  if (p != NULL)
d2094 3
a2096 2
	      (*info->fprintf_func) (info->stream, "fwait");
	      return (p + 1) - inbuf;
a2097 1
	}
d2099 1
a2099 5
      if (codep > inbuf)
	{
	  /* This will at least let objdump print the bytes followed
             by the error message generated by fetch_data.  */
	  return codep - inbuf;
d2117 9
a2125 4
      /* fwait not followed by floating point instruction.  */
      (*info->fprintf_func) (info->stream, "fwait");
      /* There may be other prefixes.  Skip any before the fwait.  */
      return codep - inbuf;
d2150 4
a2153 1
    oappend ("repz ");
d2155 4
a2158 1
    oappend ("repnz ");
d2160 4
a2163 1
    oappend ("lock ");
d2175 1
d2201 1
d2227 15
d2729 2
d2745 1
d2761 1
d2785 1
d2797 1
d2819 1
d2838 4
a2841 1
    oappend ("%cs:");
d2843 4
a2846 1
    oappend ("%ds:");
d2848 4
a2851 1
    oappend ("%ss:");
d2853 4
a2856 1
    oappend ("%es:");
d2858 4
a2861 1
    oappend ("%fs:");
d2863 4
a2866 1
    oappend ("%gs:");
d2907 1
d3130 1
d3200 1
d3227 1
d3269 1
d3314 1
d3357 1
d3654 1
@


1.3
log
@
Add missing files from last change in gas/testsuite.
i386-dis.c: Catch a number of cases where an invalid modrm would result in
bogus disassembly.  const lots of places.
@
text
@a49 1

d61 21
d104 10
a113 1
      (*info->memory_error_func) (status, start, info);
a1879 15
#define PREFIX_REPZ 1
#define PREFIX_REPNZ 2
#define PREFIX_LOCK 4
#define PREFIX_CS 8
#define PREFIX_SS 0x10
#define PREFIX_DS 0x20
#define PREFIX_ES 0x40
#define PREFIX_FS 0x80
#define PREFIX_GS 0x100
#define PREFIX_DATA 0x200
#define PREFIX_ADDR 0x400
#define PREFIX_FWAIT 0x800

static int prefixes;

d1922 1
a1922 1
	case 0x9b:
a2024 3
  if (setjmp (priv.bailout) != 0)
    /* Error return.  */
    return -1;
d2037 28
@


1.2
log
@P
i386 PIII SIMD support, remove ReverseRegRegmem kludge
tidy a few things in i386 intel mode disassembly
@
text
@d96 1
d100 2
a101 2
#define M OP_E, 0
#define Mp OP_E, 0		/* ? */
d104 1
a104 2
#define Rw OP_rm, w_mode
#define Rd OP_rm, d_mode
a110 3
#if 0
#define ONE OP_ONE, 0
#endif
d156 1
a156 1
#define MS OP_MS, b_mode
d168 1
a168 1
typedef void (*op_rtn) PARAMS ((int bytemode, int sizeflag ));
d185 1
a185 1
static void OP_rm PARAMS ((int, int));
a187 3
#if 0
static void OP_ONE PARAMS ((int, int));
#endif
d199 1
a199 1
static void putop PARAMS ((char *template, int sizeflag));
d205 1
d296 1
a296 1
  char *name;
d319 1
a319 1
static struct dis386 dis386_att[] = {
d610 1
a610 1
static struct dis386 dis386_intel[] = {
d901 1
a901 1
static struct dis386 dis386_twobyte_att[] = {
d931 1
a931 1
  { "(bad)" },  { "(bad)" },  { "(bad)" },  
d948 1
a948 1
  { PREGRP4 },  
d951 1
a951 1
  { "comiss", XM, EX },  
d972 1
a972 1
  { "xorps", XM, EX },  
d977 1
a977 1
  { "(bad)" },  
d981 1
a981 1
  { PREGRP6 },  
d997 1
a997 1
  { "movd", MX, Ev },
d1011 1
a1011 1
  { "movd", Ev, MX },
d1070 1
a1070 1
  { "lssS", Gv, Mp },	/* 386 lists only Mp */
d1072 2
a1073 2
  { "lfsS", Gv, Mp },	/* 386 lists only Mp */
  { "lgsS", Gv, Mp },	/* 386 lists only Mp */
d1111 1
a1111 1
  { "pmovmskb", Ev, MX },  
d1129 1
a1129 1
  { "movntq", Ev, MX },  
d1147 1
a1147 1
  { "maskmovq", MX, EM },  
d1159 1
a1159 1
static struct dis386 dis386_twobyte_intel[] = {
d1189 1
a1189 1
  { "(bad)" },  { "(bad)" },  { "(bad)" },  
d1206 1
a1206 1
  { PREGRP4 },  
d1209 1
a1209 1
  { "comiss", XM, EX },  
d1230 1
a1230 1
  { "xorps", XM, EX },  
d1235 1
a1235 1
  { "(bad)" },  
d1239 1
a1239 1
  { PREGRP6 },  
d1255 1
a1255 1
  { "movd", MX, Ev },
d1269 1
a1269 1
  { "movd", Ev, MX },
d1328 1
a1328 1
  { "lss", Gv, Mp },	/* 386 lists only Mp */
d1330 2
a1331 2
  { "lfs", Gv, Mp },	/* 386 lists only Mp */
  { "lgs", Gv, Mp },	/* 386 lists only Mp */
d1369 1
a1369 1
  { "pmovmskb", Ev, MX },  
d1387 1
a1387 1
  { "movntq", Ev, MX },  
d1405 1
a1405 1
  { "maskmovq", MX, EM },  
d1496 1
a1496 1
static void oappend PARAMS ((char *s));
d1498 1
a1498 1
static char *names32[]={
d1501 1
a1501 1
static char *names16[] = {
d1504 1
a1504 1
static char *names8[] = {
d1507 1
a1507 1
static char *names_seg[] = {
d1510 1
a1510 1
static char *index16[] = {
d1514 1
a1514 1
static struct dis386 grps[][8] = {
d1771 1
a1771 1
static struct dis386 prefix_user_table[][2] = {
d1794 2
a1795 2
    { "cvttps2pi", MX, EX },  
    { "cvttss2si", Gv, EX },  
a1941 2
static int print_insn_x86
  PARAMS ((bfd_vma pc, disassemble_info *info, int sizeflag));
d1984 1
a1984 18
  int flags;
  if (info->mach == bfd_mach_i386_i386
      || info->mach == bfd_mach_i386_i386_intel_syntax)
    flags = AFLAG|DFLAG;
  else if (info->mach == bfd_mach_i386_i8086)
    flags = 0;
  else
    abort ();
  return print_insn_x86 (pc, info, flags);
}

static int
print_insn_x86 (pc, info, sizeflag)
     bfd_vma pc;
     disassemble_info *info;
     int sizeflag;
{
  struct dis386 *dp;
d1991 1
d1996 8
d2141 1
a2141 1
  if (intel_syntax || two_source_ops) 
d2187 1
a2187 1
static char *float_mem_att[] = {
d2262 1
a2262 1
static char *float_mem_intel[] = {
d2350 1
a2350 1
static struct dis386 float_reg[][8] = {
d2508 1
a2508 1
  struct dis386 *dp;
d2524 1
a2524 1
      else 
d2575 1
a2575 1
     char *template;
d2578 1
a2578 1
  char *p;
d2712 1
a2712 1
     char *s;
d2765 3
d2774 3
a2776 1
	case 0:		/* sfence */
d2836 1
a2836 1
      
d2884 1
a2884 1
                  || (intel_syntax 
d3039 1
a3039 1
  char *s;
d3254 1
a3254 1
  char *s;
a3289 14
#if 0
/* Not used.  */

/* ARGSUSED */
static void
OP_ONE (dummy, sizeflag)
     int dummy;
     int sizeflag;
{
  oappend ("1");
}

#endif

a3295 1
  codep++; /* skip mod/rm */
a3305 1
  codep++; /* skip mod/rm */
a3315 1
  codep++; /* skip mod/rm */
d3321 1
a3321 1
OP_rm (bytemode, sizeflag)
d3325 4
a3328 9
  switch (bytemode)
    {
    case d_mode:
      oappend (names32[rm]);
      break;
    case w_mode:
      oappend (names16[rm]);
      break;
    }
d3382 2
a3383 2
OP_MS (ignore, sizeflag)
     int ignore;
d3386 4
a3389 3
  ++codep;
  sprintf (scratchbuf, "%%mm%d", rm);
  oappend (scratchbuf);
d3470 1
d3473 1
a3473 1
    strcat (obuf, mnemonic);
d3480 3
a3482 4
      op1out[0] = 0;
      op2out[0] = 0;
      codep = insn_codep + 1;
      strcat (obuf, "(bad)");
d3506 1
d3513 1
a3513 1
      strcat (obuf, scratchbuf);
d3518 3
a3520 4
      op1out[0] = 0;
      op2out[0] = 0;
      codep = insn_codep + 1;
      strcat (obuf, "(bad)");
d3540 6
@


1.1
log
@Initial revision
@
text
@d139 1
a139 2
#define Ap OP_DIR, lptr
#define Av OP_DIR, v_mode
d156 1
d158 1
d160 1
d162 1
d195 1
d197 1
d200 2
a223 8
#define eAX_reg 107
#define eCX_reg 108
#define eDX_reg 109
#define eBX_reg 110
#define eSP_reg 111
#define eBP_reg 112
#define eSI_reg 113
#define eDI_reg 114
d225 8
a232 1
#define lptr 115
d254 42
a295 22
#define GRP1b NULL, NULL, 0
#define GRP1S NULL, NULL, 1
#define GRP1Ss NULL, NULL, 2
#define GRP2b NULL, NULL, 3
#define GRP2S NULL, NULL, 4
#define GRP2b_one NULL, NULL, 5
#define GRP2S_one NULL, NULL, 6
#define GRP2b_cl NULL, NULL, 7
#define GRP2S_cl NULL, NULL, 8
#define GRP3b NULL, NULL, 9
#define GRP3S NULL, NULL, 10
#define GRP4  NULL, NULL, 11
#define GRP5  NULL, NULL, 12
#define GRP6  NULL, NULL, 13
#define GRP7 NULL, NULL, 14
#define GRP8 NULL, NULL, 15
#define GRP9 NULL, NULL, 16
#define GRP10 NULL, NULL, 17
#define GRP11 NULL, NULL, 18
#define GRP12 NULL, NULL, 19
#define GRP13 NULL, NULL, 20
#define GRP14 NULL, NULL, 21
d587 1
a587 1
  { "callP",	Av },
d617 8
a624 8
  { "addB",	Eb, Gb },
  { "addS",	Ev, Gv },
  { "addB",	Gb, Eb },
  { "addS",	Gv, Ev },
  { "addB",	AL, Ib },
  { "addS",	eAX, Iv },
  { "pushP",	es },
  { "popP",	es },
d626 7
a632 7
  { "orB",	Eb, Gb },
  { "orS",	Ev, Gv },
  { "orB",	Gb, Eb },
  { "orS",	Gv, Ev },
  { "orB",	AL, Ib },
  { "orS",	eAX, Iv },
  { "pushP",	cs },
d635 8
a642 8
  { "adcB",	Eb, Gb },
  { "adcS",	Ev, Gv },
  { "adcB",	Gb, Eb },
  { "adcS",	Gv, Ev },
  { "adcB",	AL, Ib },
  { "adcS",	eAX, Iv },
  { "pushP",	ss },
  { "popP",	ss },
d644 8
a651 8
  { "sbbB",	Eb, Gb },
  { "sbbS",	Ev, Gv },
  { "sbbB",	Gb, Eb },
  { "sbbS",	Gv, Ev },
  { "sbbB",	AL, Ib },
  { "sbbS",	eAX, Iv },
  { "pushP",	ds },
  { "popP",	ds },
d653 6
a658 6
  { "andB",	Eb, Gb },
  { "andS",	Ev, Gv },
  { "andB",	Gb, Eb },
  { "andS",	Gv, Ev },
  { "andB",	AL, Ib },
  { "andS",	eAX, Iv },
d662 6
a667 6
  { "subB",	Eb, Gb },
  { "subS",	Ev, Gv },
  { "subB",	Gb, Eb },
  { "subS",	Gv, Ev },
  { "subB",	AL, Ib },
  { "subS",	eAX, Iv },
d671 6
a676 6
  { "xorB",	Eb, Gb },
  { "xorS",	Ev, Gv },
  { "xorB",	Gb, Eb },
  { "xorS",	Gv, Ev },
  { "xorB",	AL, Ib },
  { "xorS",	eAX, Iv },
d680 6
a685 6
  { "cmpB",	Eb, Gb },
  { "cmpS",	Ev, Gv },
  { "cmpB",	Gb, Eb },
  { "cmpS",	Gv, Ev },
  { "cmpB",	AL, Ib },
  { "cmpS",	eAX, Iv },
d689 8
a696 8
  { "incS",	eAX },
  { "incS",	eCX },
  { "incS",	eDX },
  { "incS",	eBX },
  { "incS",	eSP },
  { "incS",	eBP },
  { "incS",	eSI },
  { "incS",	eDI },
d698 8
a705 8
  { "decS",	eAX },
  { "decS",	eCX },
  { "decS",	eDX },
  { "decS",	eBX },
  { "decS",	eSP },
  { "decS",	eBP },
  { "decS",	eSI },
  { "decS",	eDI },
d707 8
a714 8
  { "pushS",	eAX },
  { "pushS",	eCX },
  { "pushS",	eDX },
  { "pushS",	eBX },
  { "pushS",	eSP },
  { "pushS",	eBP },
  { "pushS",	eSI },
  { "pushS",	eDI },
d716 8
a723 8
  { "popS",	eAX },
  { "popS",	eCX },
  { "popS",	eDX },
  { "popS",	eBX },
  { "popS",	eSP },
  { "popS",	eBP },
  { "popS",	eSI },
  { "popS",	eDI },
d725 3
a727 3
  { "pushaP" },
  { "popaP" },
  { "boundS",	Gv, Ma },
d734 8
a741 8
  { "pushP",	Iv },		/* 386 book wrong */
  { "imulS",	Gv, Ev, Iv },
  { "pushP",	sIb },		/* push of byte really pushes 2 or 4 bytes */
  { "imulS",	Gv, Ev, sIb },
  { "insb",	Yb, indirDX },
  { "insR",	Yv, indirDX },
  { "outsb",	indirDX, Xb },
  { "outsR",	indirDX, Xv },
d765 4
a768 4
  { "testB",	Eb, Gb },
  { "testS",	Ev, Gv },
  { "xchgB",	Eb, Gb },
  { "xchgS",	Ev, Gv },
d770 8
a777 8
  { "movB",	Eb, Gb },
  { "movS",	Ev, Gv },
  { "movB",	Gb, Eb },
  { "movS",	Gv, Ev },
  { "movQ",	Ev, Sw },
  { "leaS",	Gv, M },
  { "movQ",	Sw, Ev },
  { "popQ",	Ev },
d780 7
a786 7
  { "xchgS",	eCX, eAX },
  { "xchgS",	eDX, eAX },
  { "xchgS",	eBX, eAX },
  { "xchgS",	eSP, eAX },
  { "xchgS",	eBP, eAX },
  { "xchgS",	eSI, eAX },
  { "xchgS",	eDI, eAX },
d788 3
a790 3
  { "cWtR" },
  { "cRtd" },
  { "lcallP",	Ap },
d792 2
a793 2
  { "pushfP" },
  { "popfP" },
d797 8
a804 8
  { "movB",	AL, Ob },
  { "movS",	eAX, Ov },
  { "movB",	Ob, AL },
  { "movS",	Ov, eAX },
  { "movsb",	Yb, Xb },
  { "movsR",	Yv, Xv },
  { "cmpsb",	Xb, Yb },
  { "cmpsR",	Xv, Yv },
d806 8
a813 8
  { "testB",	AL, Ib },
  { "testS",	eAX, Iv },
  { "stosB",	Yb, AL },
  { "stosS",	Yv, eAX },
  { "lodsB",	AL, Xb },
  { "lodsS",	eAX, Xv },
  { "scasB",	AL, Yb },
  { "scasS",	eAX, Yv },
d815 8
a822 8
  { "movB",	AL, Ib },
  { "movB",	CL, Ib },
  { "movB",	DL, Ib },
  { "movB",	BL, Ib },
  { "movB",	AH, Ib },
  { "movB",	CH, Ib },
  { "movB",	DH, Ib },
  { "movB",	BH, Ib },
d824 8
a831 8
  { "movS",	eAX, Iv },
  { "movS",	eCX, Iv },
  { "movS",	eDX, Iv },
  { "movS",	eBX, Iv },
  { "movS",	eSP, Iv },
  { "movS",	eBP, Iv },
  { "movS",	eSI, Iv },
  { "movS",	eDI, Iv },
d835 6
a840 6
  { "retP",	Iw },
  { "retP" },
  { "lesS",	Gv, Mp },
  { "ldsS",	Gv, Mp },
  { "movA",	Eb, Ib },
  { "movQ",	Ev, Iv },
d842 4
a845 4
  { "enterP",	Iw, Ib },
  { "leaveP" },
  { "lretP",	Iw },
  { "lretP" },
d849 1
a849 1
  { "iretP" },
d873 4
a876 4
  { "inB",	AL, Ib },
  { "inS",	eAX, Ib },
  { "outB",	Ib, AL },
  { "outS",	Ib, eAX },
d878 3
a880 3
  { "callP",	Av },
  { "jmpP",	Jv },
  { "ljmpP",	Ap },
d882 4
a885 4
  { "inB",	AL, indirDX },
  { "inS",	eAX, indirDX },
  { "outB",	indirDX, AL },
  { "outS",	indirDX, eAX },
d922 1
a922 1
  { GRP14 },
d926 8
a933 2
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
d935 2
a936 1
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
d949 8
a956 2
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
d970 8
a977 2
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
d979 8
a986 2
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
d1005 1
a1005 1
  { "(bad)" },
d1093 1
d1095 3
a1097 4
  { "(bad)" },
  { "(bad)" },
  { "(bad)" },
  { "(bad)" },
d1115 2
a1116 1
  { "(bad)" },  { "(bad)" },
d1120 1
a1120 1
  { "(bad)" },
d1124 1
a1124 1
  { "(bad)" },
d1127 1
a1127 1
  { "(bad)" },
d1130 3
d1134 1
a1134 3
  { "(bad)" },
  { "pmulhw", MX, EM },
  { "(bad)" },  { "(bad)" },
d1138 1
a1138 1
  { "(bad)" },
d1142 1
a1142 1
  { "(bad)" },
d1151 2
a1152 1
  { "(bad)" },  { "(bad)" },
d1168 2
a1169 2
  { "larS", Gv, Ew },
  { "lslS", Gv, Ew },
d1180 1
a1180 1
  { GRP14 },
d1184 8
a1191 2
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
d1193 2
a1194 1
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
d1198 5
a1202 5
  { "movL", Rd, Cd },
  { "movL", Rd, Dd },
  { "movL", Cd, Rd },
  { "movL", Dd, Rd },
  { "movL", Rd, Td },
d1204 1
a1204 1
  { "movL", Td, Rd },
d1207 8
a1214 2
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
d1228 8
a1235 2
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
d1237 8
a1244 2
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
  { "(bad)" },  { "(bad)" },  { "(bad)" },  { "(bad)" },
d1263 1
a1263 1
  { "(bad)" },
d1313 2
a1314 2
  { "pushP", fs },
  { "popP", fs },
d1316 3
a1318 3
  { "btS", Ev, Gv },
  { "shldS", Ev, Gv, Ib },
  { "shldS", Ev, Gv, CL },
d1322 2
a1323 2
  { "pushP", gs },
  { "popP", gs },
d1325 3
a1327 3
  { "btsS", Ev, Gv },
  { "shrdS", Ev, Gv, Ib },
  { "shrdS", Ev, Gv, CL },
d1329 1
a1329 1
  { "imulS", Gv, Ev },
d1331 6
a1336 6
  { "cmpxchgB", Eb, Gb },
  { "cmpxchgS", Ev, Gv },
  { "lssS", Gv, Mp },	/* 386 lists only Mp */
  { "btrS", Ev, Gv },
  { "lfsS", Gv, Mp },	/* 386 lists only Mp */
  { "lgsS", Gv, Mp },	/* 386 lists only Mp */
d1343 3
a1345 3
  { "btcS", Ev, Gv },
  { "bsfS", Gv, Ev },
  { "bsrS", Gv, Ev },
d1349 7
a1355 7
  { "xaddB", Eb, Gb },
  { "xaddS", Ev, Gv },
  { "(bad)" },
  { "(bad)" },
  { "(bad)" },
  { "(bad)" },
  { "(bad)" },
d1373 2
a1374 1
  { "(bad)" },  { "(bad)" },
d1378 1
a1378 1
  { "(bad)" },
d1382 1
a1382 1
  { "(bad)" },
d1385 1
a1385 1
  { "(bad)" },
d1388 3
d1392 1
a1392 3
  { "(bad)" },
  { "pmulhw", MX, EM },
  { "(bad)" },  { "(bad)" },
d1396 1
a1396 1
  { "(bad)" },
d1400 1
a1400 1
  { "(bad)" },
d1409 2
a1410 1
  { "(bad)" },  { "(bad)" },
d1423 20
a1442 16
  1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,
  1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,
  1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,
  1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,
  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  0,0,1,1,0,0,0,0,0,1,0,1,0,0,0,0,
  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,
  1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,
  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1
d1446 2
d1449 2
a1450 2
  /* 10 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 1f */
  /* 20 */ 1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0, /* 2f */
d1453 1
a1453 1
  /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 5f */
d1455 1
a1455 1
  /* 70 */ 0,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1, /* 7f */
d1461 28
a1488 3
  /* d0 */ 0,1,1,1,0,1,0,0,1,1,0,1,1,1,0,1, /* df */
  /* e0 */ 0,1,1,0,0,1,0,0,1,1,0,1,1,1,0,1, /* ef */
  /* f0 */ 0,1,1,1,0,1,0,0,1,1,1,0,1,1,1,0  /* ff */
d1744 2
d1749 9
d1762 1
a1762 1
  /* GRP14 */
d1776 80
d2014 1
d2019 3
a2021 3
  /* The output looks better if we put 5 bytes on a line, since that
     puts long word instructions on a single line.  */
  info->bytes_per_line = 5;
a2059 19
  if (prefixes & PREFIX_REPZ)
    oappend ("repz ");
  if (prefixes & PREFIX_REPNZ)
    oappend ("repnz ");
  if (prefixes & PREFIX_LOCK)
    oappend ("lock ");

  if (prefixes & PREFIX_DATA)
    sizeflag ^= DFLAG;

  if (prefixes & PREFIX_ADDR)
    {
      sizeflag ^= AFLAG;
      if (sizeflag & AFLAG)
        oappend ("addr32 ");
      else
	oappend ("addr16 ");
    }

d2068 1
d2077 1
d2081 19
d2115 14
a2128 1
	dp = &grps[dp->bytemode1][reg];
d2668 12
a2679 3
            break;
	  if (sizeflag & DFLAG)
	    *obufp++ = 'l';
d2681 6
a2686 1
	    *obufp++ = 'w';
a2701 2
          if (intel_syntax)
            break;
d2707 12
d2786 2
d2789 1
a2789 1
	  oappend ("<bad dis table>");
a2983 2
#define INTERNAL_DISASSEMBLER_ERROR _("<internal disassembler error>")

d3209 1
d3211 2
a3212 2
OP_DIR (size, sizeflag)
     int size;
d3217 1
a3217 1
  switch (size)
d3219 7
a3225 32
    case lptr:
      if (sizeflag & DFLAG)
	{
	  offset = get32 ();
	  seg = get16 ();
	}
      else
	{
	  offset = get16 ();
	  seg = get16 ();
	}
      sprintf (scratchbuf, "$0x%x,$0x%x", seg, offset);
      oappend (scratchbuf);
      break;
    case v_mode:
      if (sizeflag & DFLAG)
	offset = get32 ();
      else
	{
	  offset = get16 ();
	  if ((offset & 0x8000) != 0)
	    offset -= 0x10000;
	}

      offset = start_pc + codep - start_codep + offset;
      set_op (offset);
      sprintf (scratchbuf, "0x%x", offset);
      oappend (scratchbuf);
      break;
    default:
      oappend (INTERNAL_DISASSEMBLER_ERROR);
      break;
d3227 2
d3373 9
d3398 16
d3501 1
a3501 1
  mnemonic = Suffix3DNow[*codep++];
d3514 56
@


1.1.1.1
log
@19990502 sourceware import
@
text
@@

