head	1.4;
access;
symbols
	sid-snapshot-20180601:1.4
	sid-snapshot-20180501:1.4
	sid-snapshot-20180401:1.4
	sid-snapshot-20180301:1.4
	sid-snapshot-20180201:1.4
	sid-snapshot-20180101:1.4
	sid-snapshot-20171201:1.4
	sid-snapshot-20171101:1.4
	sid-snapshot-20171001:1.4
	sid-snapshot-20170901:1.4
	sid-snapshot-20170801:1.4
	sid-snapshot-20170701:1.4
	sid-snapshot-20170601:1.4
	sid-snapshot-20170501:1.4
	sid-snapshot-20170401:1.4
	sid-snapshot-20170301:1.4
	sid-snapshot-20170201:1.4
	sid-snapshot-20170101:1.4
	sid-snapshot-20161201:1.4
	sid-snapshot-20161101:1.4
	sid-snapshot-20160901:1.4
	sid-snapshot-20160801:1.4
	sid-snapshot-20160701:1.4
	sid-snapshot-20160601:1.4
	sid-snapshot-20160501:1.4
	sid-snapshot-20160401:1.4
	sid-snapshot-20160301:1.4
	sid-snapshot-20160201:1.4
	sid-snapshot-20160101:1.4
	sid-snapshot-20151201:1.4
	sid-snapshot-20151101:1.4
	sid-snapshot-20151001:1.4
	sid-snapshot-20150901:1.4
	sid-snapshot-20150801:1.4
	sid-snapshot-20150701:1.4
	sid-snapshot-20150601:1.4
	sid-snapshot-20150501:1.4
	sid-snapshot-20150401:1.4
	sid-snapshot-20150301:1.4
	sid-snapshot-20150201:1.4
	sid-snapshot-20150101:1.4
	sid-snapshot-20141201:1.4
	sid-snapshot-20141101:1.4
	sid-snapshot-20141001:1.4
	sid-snapshot-20140901:1.4
	sid-snapshot-20140801:1.4
	sid-snapshot-20140701:1.4
	sid-snapshot-20140601:1.4
	sid-snapshot-20140501:1.4
	sid-snapshot-20140401:1.4
	sid-snapshot-20140301:1.4
	sid-snapshot-20140201:1.4
	sid-snapshot-20140101:1.4
	sid-snapshot-20131201:1.4
	sid-snapshot-20131101:1.4
	sid-snapshot-20131001:1.4
	sid-snapshot-20130901:1.4
	sid-snapshot-20130801:1.4
	sid-snapshot-20130701:1.4
	sid-snapshot-20130601:1.4
	sid-snapshot-20130501:1.4
	sid-snapshot-20130401:1.4
	sid-snapshot-20130301:1.4
	sid-snapshot-20130201:1.4
	sid-snapshot-20130101:1.4
	sid-snapshot-20121201:1.4
	sid-snapshot-20121101:1.4
	sid-snapshot-20121001:1.4
	sid-snapshot-20120901:1.4
	sid-snapshot-20120801:1.4
	sid-snapshot-20120701:1.4
	sid-snapshot-20120601:1.4
	sid-snapshot-20120501:1.4
	sid-snapshot-20120401:1.4
	sid-snapshot-20120301:1.4
	sid-snapshot-20120201:1.4
	sid-snapshot-20120101:1.4
	sid-snapshot-20111201:1.4
	sid-snapshot-20111101:1.4
	sid-snapshot-20111001:1.4
	sid-snapshot-20110901:1.4
	sid-snapshot-20110801:1.4
	sid-snapshot-20110701:1.4
	sid-snapshot-20110601:1.4
	sid-snapshot-20110501:1.4
	sid-snapshot-20110401:1.4
	sid-snapshot-20110301:1.4
	sid-snapshot-20110201:1.4
	sid-snapshot-20110101:1.4
	sid-snapshot-20101201:1.4
	sid-snapshot-20101101:1.4
	sid-snapshot-20101001:1.4
	sid-snapshot-20100901:1.4
	sid-snapshot-20100801:1.4
	sid-snapshot-20100701:1.4
	sid-snapshot-20100601:1.4
	sid-snapshot-20100501:1.4
	sid-snapshot-20100401:1.4
	sid-snapshot-20100301:1.4
	sid-snapshot-20100201:1.4
	sid-snapshot-20100101:1.4
	sid-snapshot-20091201:1.4
	sid-snapshot-20091101:1.4
	sid-snapshot-20091001:1.4
	sid-snapshot-20090901:1.4
	sid-snapshot-20090801:1.4
	sid-snapshot-20090701:1.4
	sid-snapshot-20090601:1.4
	sid-snapshot-20090501:1.4
	sid-snapshot-20090401:1.4
	sid-snapshot-20090301:1.4
	sid-snapshot-20090201:1.4
	sid-snapshot-20090101:1.4
	sid-snapshot-20081201:1.4
	sid-snapshot-20081101:1.4
	sid-snapshot-20081001:1.4
	sid-snapshot-20080901:1.4
	sid-snapshot-20080801:1.4
	sid-snapshot-20080701:1.4
	sid-snapshot-20080601:1.4
	sid-snapshot-20080501:1.4
	sid-snapshot-20080403:1.4
	sid-snapshot-20080401:1.4
	sid-snapshot-20080301:1.4
	sid-snapshot-20080201:1.4
	sid-snapshot-20080101:1.4
	sid-snapshot-20071201:1.4
	sid-snapshot-20071101:1.4
	sid-snapshot-20071001:1.4
	sid-20020905-branchpoint:1.4
	sid-20020905-branch:1.4.0.2
	cygnus_cvs_20020108_pre:1.4;
locks; strict;
comment	@# @;


1.4
date	2001.08.04.12.10.32;	author bje;	state Exp;
branches;
next	1.3;

1.3
date	2001.06.13.08.13.43;	author bje;	state Exp;
branches;
next	1.2;

1.2
date	2001.05.31.06.19.56;	author bje;	state Exp;
branches;
next	1.1;

1.1
date	2000.12.07.19.30.58;	author fche;	state Exp;
branches;
next	;


desc
@@


1.4
log
@[ChangeLog]
2001-08-02  John Healy  <jhealy@@redhat.com>

	* lib/cpudefs.exp (run-sid-tests-raw): Renamed loader to cpu-loader.
	(run-one-sid-test): Removed un-necessary setting of sid-opts.

2001-08-02  Dave Brolley  <brolley@@redhat.com>

	* lib/cpudefs.exp: Rename loader to cpu-loader.

2001-07-27  John Healy  <jhealy@@redhat.com>

	* lib/cpudefs.exp (run-one-sid-test): Added check to see if
	protocol was set to sid the baseboard/<target>-sid.exp file
	and if so, set sid-opts accordingly.
	(sid-run-conf):  Essentially re-written to properly implement
	perl-free testing.  Fixed the call to sid-run-conf.
	(sid-run-bsp-tests): Added handling for perl-free testing.

2001-07-04  Ben Elliston  <bje@@redhat.com>

	* lib/docs.exp (doc_exists): Add "extension" arg. Update callers.
	(doc_trailing_whitespace): Remove.
	(doc_test): Don't invoke doc_trailing_whitespace. Test for the
	existence of both .txt and .xml documentation files.
	(doc_includes_component): Adjust regexp for XML syntax.

2001-05-29  matthew green  <mrg@@redhat.com>

	* sidcomp.cgen-cpu.arm7t/armeit.conf: Update for new
	--trace-semantics, etc. options.

2001-05-23  Ben Elliston  <bje@@redhat.com>

	* Makefile.am (EXPECT): Define.
	* Makefile.in: Regenerate.

2001-04-04  Ben Elliston  <bje@@redhat.com>

	* Makefile.am (RUNTEST): Define.
	* Makefile.in: Regenerate.

[sidcomp.cgen-cpu.arm7t/ChangeLog]
2001-08-02  Dave Brolley  <brolley@@redhat.com>

	* armeit.conf: Rename loader to cpu-loader.
@
text
@# docs.exp -*- Tcl -*-
#
# Copyright (C) 1999, 2001 Red Hat
#
# Procedures for performing an integrity check on an XML documentation
# file according to the component DTD.
#
# doc_test runs a integrity test on documentation.

proc doc_test {subdirectory compname} {
    global docname contents subdir

    set subdir $subdirectory
    regsub -all -- / $compname _ docname

    # Each sub-test, one by one.
    doc_exists $compname txt
    doc_exists $compname xml
    doc_includes_component $compname

    if {[info exists contents]} { unset contents }
}


proc doc_load {} {
    global docname contents
    
    if {[info exists contents]} { return 1 }

    if {![catch {set fd [open $docname r]}]} {
	set contents [read $fd]
	close $fd
	return 1
    }
    return 0
}
	

# Test if a doc file exists in the source tree.
# Passes or fails the test.

proc doc_exists {compname extension} {
    global srcdir subdir docname

    # search for related file names first
    set parts [split $docname {}]
    for {set i [expr [llength $parts] - 1]} {$i > 0} {set i [expr $i - 1]} {
	set candidate [join [lrange $parts 0 $i] {}]
	set dir [file join [file join $srcdir ".."] $subdir]
	set pattern "[file join $dir $candidate]*.${extension}"
	set candidates [glob -nocomplain -- $pattern]
	verbose "Candidates: $pattern -> $candidates"
	if {[llength $candidates] == 1} then {
	    pass "Documentation file (${extension}) for ${compname} exists"
	    set docname [lindex $candidates 0]
	    return
	}
    }
    fail "Documentation file (${extension}) for ${compname} is missing"
}


# Test if the documentation file includes documentation about COMPONENT.
# Passes or fails the test.

proc doc_includes_component {component} {
    global docname contents

    if {![doc_load]} { return }
    
    if {[regexp "<defcomponent name=\"${component}\"" $contents]} {
	pass "Documentation file seems to document $component"
    } else {
	fail "Documentation file does not seem to document $component"
    }
}
@


1.3
log
@2001-06-13  Ben Elliston  <bje@@redhat.com>

	* lib/docs.exp (doc_test): Pass $compname to doc_exists.
	(doc_exists): Use $compname to improve DejaGNU "pass" message.
@
text
@d1 1
a1 2
# -*- Tcl -*-
# docs.exp
d3 1
a3 1
# Copyright (C) 1999 Red Hat
d5 2
a6 5
# Description:
# Procedures for performing an integrity check on a documentation file
# formatted in the documented SID template format. These procs are
# quite simplistic right now, but will grow as we think of better
# ways to test it.
d8 1
a8 1
# doc_test runs a integrity test on a documentation file.
d17 2
a18 1
    doc_exists $compname
a19 1
    doc_trailing_whitespace
d42 1
a42 1
proc doc_exists {compname} {
d50 1
a50 1
	set pattern "[file join $dir $candidate]*.txt"
d54 1
a54 1
	    pass "Documentation file for ${compname} exists"
d59 1
a59 1
    fail "Documentation file for ${compname} is missing"
d71 1
a71 1
    if {[regexp "\\* Name\n  .*${component}\.*n" $contents]} {
a74 14
    }
}

# Look for any trailing whitespace on any line.

proc doc_trailing_whitespace {} {
    global docname contents
    
    if {![doc_load]} { return }

    if {[regexp "\[ \\t\]+$" $contents]} {
	fail "Documentation file contains trailing whitespace"
    } else {
	pass "Documentation file contains no trailing whitespace"
@


1.2
log
@2001-05-31  Ben Elliston  <bje@@redhat.com>

	* lib/docs.exp (doc_includes_component): Fail on regexp misses.
	* lib/monkey.exp (monkey_test): Re-enable tests.
	* sidcomp.ide/diskio.exp: Unset $contents at completion.
@
text
@d21 1
a21 1
    doc_exists
d46 1
a46 1
proc doc_exists {} {
d58 1
a58 1
	    pass "Documentation file exists (${docname}.txt)"
d63 1
a63 1
    fail "Documentation file ($docname) is missing"
@


1.1
log
@* public snapshot of sid simulator
@
text
@d78 1
a78 1
	pass "Documentation file does not seem to document $component"
@

