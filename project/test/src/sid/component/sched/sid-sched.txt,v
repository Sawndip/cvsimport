head	1.8;
access;
symbols
	sid-snapshot-20180601:1.8
	sid-snapshot-20180501:1.8
	sid-snapshot-20180401:1.8
	sid-snapshot-20180301:1.8
	sid-snapshot-20180201:1.8
	sid-snapshot-20180101:1.8
	sid-snapshot-20171201:1.8
	sid-snapshot-20171101:1.8
	sid-snapshot-20171001:1.8
	sid-snapshot-20170901:1.8
	sid-snapshot-20170801:1.8
	sid-snapshot-20170701:1.8
	sid-snapshot-20170601:1.8
	sid-snapshot-20170501:1.8
	sid-snapshot-20170401:1.8
	sid-snapshot-20170301:1.8
	sid-snapshot-20170201:1.8
	sid-snapshot-20170101:1.8
	sid-snapshot-20161201:1.8
	sid-snapshot-20161101:1.8
	sid-snapshot-20160901:1.8
	sid-snapshot-20160801:1.8
	sid-snapshot-20160701:1.8
	sid-snapshot-20160601:1.8
	sid-snapshot-20160501:1.8
	sid-snapshot-20160401:1.8
	sid-snapshot-20160301:1.8
	sid-snapshot-20160201:1.8
	sid-snapshot-20160101:1.8
	sid-snapshot-20151201:1.8
	sid-snapshot-20151101:1.8
	sid-snapshot-20151001:1.8
	sid-snapshot-20150901:1.8
	sid-snapshot-20150801:1.8
	sid-snapshot-20150701:1.8
	sid-snapshot-20150601:1.8
	sid-snapshot-20150501:1.8
	sid-snapshot-20150401:1.8
	sid-snapshot-20150301:1.8
	sid-snapshot-20150201:1.8
	sid-snapshot-20150101:1.8
	sid-snapshot-20141201:1.8
	sid-snapshot-20141101:1.8
	sid-snapshot-20141001:1.8
	sid-snapshot-20140901:1.8
	sid-snapshot-20140801:1.8
	sid-snapshot-20140701:1.8
	sid-snapshot-20140601:1.8
	sid-snapshot-20140501:1.8
	sid-snapshot-20140401:1.8
	sid-snapshot-20140301:1.8
	sid-snapshot-20140201:1.8
	sid-snapshot-20140101:1.8
	sid-snapshot-20131201:1.8
	sid-snapshot-20131101:1.8
	sid-snapshot-20131001:1.8
	sid-snapshot-20130901:1.8
	sid-snapshot-20130801:1.8
	sid-snapshot-20130701:1.8
	sid-snapshot-20130601:1.8
	sid-snapshot-20130501:1.8
	sid-snapshot-20130401:1.8
	sid-snapshot-20130301:1.8
	sid-snapshot-20130201:1.8
	sid-snapshot-20130101:1.8
	sid-snapshot-20121201:1.8
	sid-snapshot-20121101:1.8
	sid-snapshot-20121001:1.8
	sid-snapshot-20120901:1.8
	sid-snapshot-20120801:1.8
	sid-snapshot-20120701:1.8
	sid-snapshot-20120601:1.8
	sid-snapshot-20120501:1.8
	sid-snapshot-20120401:1.8
	sid-snapshot-20120301:1.8
	sid-snapshot-20120201:1.8
	sid-snapshot-20120101:1.8
	sid-snapshot-20111201:1.8
	sid-snapshot-20111101:1.8
	sid-snapshot-20111001:1.8
	sid-snapshot-20110901:1.8
	sid-snapshot-20110801:1.8
	sid-snapshot-20110701:1.8
	sid-snapshot-20110601:1.8
	sid-snapshot-20110501:1.8
	sid-snapshot-20110401:1.8
	sid-snapshot-20110301:1.8
	sid-snapshot-20110201:1.8
	sid-snapshot-20110101:1.8
	sid-snapshot-20101201:1.8
	sid-snapshot-20101101:1.8
	sid-snapshot-20101001:1.8
	sid-snapshot-20100901:1.8
	sid-snapshot-20100801:1.8
	sid-snapshot-20100701:1.8
	sid-snapshot-20100601:1.8
	sid-snapshot-20100501:1.8
	sid-snapshot-20100401:1.8
	sid-snapshot-20100301:1.8
	sid-snapshot-20100201:1.8
	sid-snapshot-20100101:1.8
	sid-snapshot-20091201:1.8
	sid-snapshot-20091101:1.8
	sid-snapshot-20091001:1.8
	sid-snapshot-20090901:1.8
	sid-snapshot-20090801:1.8
	sid-snapshot-20090701:1.8
	sid-snapshot-20090601:1.8
	sid-snapshot-20090501:1.8
	sid-snapshot-20090401:1.8
	sid-snapshot-20090301:1.8
	sid-snapshot-20090201:1.8
	sid-snapshot-20090101:1.8
	sid-snapshot-20081201:1.8
	sid-snapshot-20081101:1.8
	sid-snapshot-20081001:1.8
	sid-snapshot-20080901:1.8
	sid-snapshot-20080801:1.8
	sid-snapshot-20080701:1.8
	sid-snapshot-20080601:1.8
	sid-snapshot-20080501:1.8
	sid-snapshot-20080403:1.8
	sid-snapshot-20080401:1.8
	sid-snapshot-20080301:1.8
	sid-snapshot-20080201:1.8
	sid-snapshot-20080101:1.8
	sid-snapshot-20071201:1.8
	sid-snapshot-20071101:1.8
	sid-snapshot-20071001:1.8
	sid-20020905-branchpoint:1.4
	sid-20020905-branch:1.4.0.2
	cygnus_cvs_20020108_pre:1.4;
locks; strict;
comment	@# @;


1.8
date	2005.08.23.21.08.53;	author brolley;	state Exp;
branches;
next	1.7;

1.7
date	2003.10.21.21.36.29;	author brolley;	state Exp;
branches;
next	1.6;

1.6
date	2003.08.29.19.45.10;	author brolley;	state Exp;
branches;
next	1.5;

1.5
date	2003.01.08.03.42.16;	author bje;	state Exp;
branches;
next	1.4;

1.4
date	2001.10.17.19.01.36;	author brolley;	state Exp;
branches;
next	1.3;

1.3
date	2001.10.17.17.51.30;	author brolley;	state Exp;
branches;
next	1.2;

1.2
date	2001.08.03.01.30.22;	author bje;	state Exp;
branches;
next	1.1;

1.1
date	2000.12.07.19.30.56;	author fche;	state Exp;
branches;
next	;


desc
@@


1.8
log
@2005-08-23  Dave Brolley  <brolley@@redhat.com>

        * compSched.cxx (scheduling_event): Constructors now take
        a 'priority' argument.
        (operator <): Consider priority of events.
        (yield): Likewise.
        (next_event): Likewise.
        (schedule_irregular): Now takes a 'priority' argument. Used when
        creating scheduling events.
        (schedule_regular): Likewise.
        (refill_regular_events_table): Consider priority of events.
        (operator <<): Stream priority.
        (operator >>): Destream priority.
        (class scheduler_client): Add 'priority' member.
        (set_time): Pass priority of the client to the scheduler.
        (client_num_update): Handle N-priority attribute.
        * sid-sched.xml: Describe the N-priority attribute.
        * sid-sched.txt: Regenerated.
@
text
@               sid-sched (libsched.la :: sched_component_library)

Synopsis:

   These components manage multiple signal schedules.

     ----------------------------------------------------------------------

Functionality:

  Modelling:

   These components function as general purpose signal schedulers. They
   approximately correspond to a collection of programmable clock dividers.

   The number of controllable outputs ("subscriptions") is a matter of
   configuration.

   The three component types are identical, except in their notions of time.
   See the Timing section below.

   +-------------------------------------------------+
   |                    Behaviors                    |
   |-------------------------------------------------|
   | configuration | When the num-clients is         |
   |               | written-to, this component      |
   |               | adjusts its list of scheduler   |
   |               | clients. Each "client"          |
   |               | corresponds to a set of "N-"    |
   |               | pins and attributes, with its   |
   |               | own signalling schedule. During |
   |               | configuration, the clients can  |
   |               | also be named using the N-name  |
   |               | attributes, which provides a    |
   |               | more informative name for the   |
   |               | scheduler's TK GUI              |
   |---------------+---------------------------------|
   |        timing | There is no global concept of   |
   |               | simulation time in sid.         |
   |               | Instead, each scheduler         |
   |               | instance maintains its own      |
   |               | notion of time.                 |
   |               |                                 |
   |               | A sid-sched-sim scheduler       |
   |               | maintains a 64-bit integer as a |
   |               | time counter. When advancing,   |
   |               | this time counter is set to     |
   |               | jump forward to the earliest of |
   |               | the upcoming subscribed         |
   |               | signals. This way, it           |
   |               | represents the clock of a       |
   |               | traditional event-driven        |
   |               | simulator.                      |
   |               |                                 |
   |               | The sid-sched-host and          |
   |               | sid-sched-host-accurate         |
   |               | schedulers use a                |
   |               | millisecond-precision timer of  |
   |               | the host operating system. Its  |
   |               | time is simply that of the      |
   |               | operating system. When          |
   |               | advancing, there may be no      |
   |               | scheduled events due, even      |
   |               | though there may be scheduled   |
   |               | events. In such a case, if the  |
   |               | yield-host-time? attribute is   |
   |               | set to a value greater than or  |
   |               | equal to                        |
   |               | yield-host-time-threshold, a    |
   |               | host-time scheduler will yield  |
   |               | some amount of time to the host |
   |               | operating system using a        |
   |               | function like usleep().         |
   |               |                                 |
   |               | The time-query pin, when        |
   |               | driven, causes a scheduler to   |
   |               | signal its current 64-bit time  |
   |               | back, in two 32-bit halves, on  |
   |               | the time-high, then time-low    |
   |               | pins. Similarly, the time       |
   |               | attribute may be accessed to    |
   |               | get/set the scheduler's time.   |
   |---------------+---------------------------------|
   |  subscription | The scheduler maintains a       |
   |               | number of "subscriptions". Each |
   |               | subscription represents a       |
   |               | request to provide a series of  |
   |               | recurring "regular" signals, or |
   |               | a single-shot "irregular"       |
   |               | signal, some time in the        |
   |               | simulation's future. Each       |
   |               | subscription has an associated  |
   |               | set of pins and attributes to   |
   |               | control it.                     |
   |               |                                 |
   |               | Each subscription is defined by |
   |               | an index, a                     |
   |               | regular-vs-irregular flag, a    |
   |               | priority and a time quantity.   |
   |               | The index is a number between 0 |
   |               | and num-clients -1, and is      |
   |               | represented as N in the         |
   |               | pin/attribute list templates in |
   |               | this document. The              |
   |               | regular-vs-irregular flag is    |
   |               | accessible as the N-regular?    |
   |               | attribute. The priority is      |
   |               | accessible as the N-priority    |
   |               | attribute. Higher values        |
   |               | indicate higher priority. The   |
   |               | time quantity is accessible as  |
   |               | the N-time attribute. If the    |
   |               | value is zero, it is            |
   |               | interpreted as a request to     |
   |               | cancel all pending events for   |
   |               | this subscription. Otherwise,   |
   |               | the value is taken to be a      |
   |               | delta until the time of the     |
   |               | requested event.                |
   |               |                                 |
   |               | You can also set these controls |
   |               | by driving encoded values into  |
   |               | the N-control pin. The top bit  |
   |               | is interpreted as the           |
   |               | regular-vs-irregular flag (1:   |
   |               | regular, 0:irregular), and the  |
   |               | remaining bits as the delta     |
   |               | time value. If the delta is     |
   |               | zero, events for this           |
   |               | subscription are cancelled.     |
   |               |                                 |
   |               | In each case, the time value    |
   |               | sent is multiplied by a scale   |
   |               | before being merged into the    |
   |               | master schedule. The scaling    |
   |               | value is available on the       |
   |               | N-scale attribute, and may be   |
   |               | specified as a plain number, or |
   |               | as a fraction of two numbers    |
   |               | (e.g., 1/5).                    |
   |---------------+---------------------------------|
   |     advancing | When you have disabled the      |
   |               | scheduler by setting the        |
   |               | enabled? attribute to a value   |
   |               | less than the enable-threshold  |
   |               | attribute, advancing as         |
   |               | described below, does not       |
   |               | occur.                          |
   |               |                                 |
   |               | Whenever the advance input pin  |
   |               | is driven, the scheduler may    |
   |               | dispatch one or more signals by |
   |               | driving the N-event output pins |
   |               | with some value. A counter      |
   |               | accessed by the advance-count   |
   |               | attribute is incremented. If    |
   |               | the attribute enabled? has been |
   |               | changed from a value below      |
   |               | enable-threshold to a value     |
   |               | greater than or equal to        |
   |               | enable-threshold, then the pin  |
   |               | active will be driven with the  |
   |               | value 1. If the attribute       |
   |               | enabled? has been changed from  |
   |               | a value grater than or equal to |
   |               | enable-threshold to a value     |
   |               | less than enable-threshold,     |
   |               | then the pin active will be     |
   |               | driven with the value 0.        |
   |               |                                 |
   |               | Whether any particular N-event  |
   |               | pin is driven depends on the    |
   |               | subscription associated with    |
   |               | that pin, and the passage of    |
   |               | that scheduler's time. All      |
   |               | events that are due "now", or   |
   |               | that are overdue are            |
   |               | dispatched.                     |
   |               |                                 |
   |               | If there are multiple due or    |
   |               | overdue events, the scheduler   |
   |               | may loop over the pending event |
   |               | up to step-cycle-limit number   |
   |               | of times, as an optimization.   |
   |               | This loop may be aborted early  |
   |               | if the yield input pin is       |
   |               | driven.                         |
   |               |                                 |
   |               | If more than one event is       |
   |               | scheduled at the same time.     |
   |               | Events will be dispatched in    |
   |               | priority order. Events with     |
   |               | higher priority will be         |
   |               | dispatched before events with   |
   |               | lower priority.                 |
   +-------------------------------------------------+

   +-------------------------------------------------+
   |                 SID Conventions                 |
   |-------------------------------------------------|
   |        functional | supported  | -              |
   |-------------------+------------+----------------|
   |      save/restore | supported  | -              |
   |-------------------+------------+----------------|
   |     triggerpoints | not        | -              |
   |                   | supported  |                |
   |-------------------+------------+----------------|
   | inhibit-recursion | supported  | It prevents    |
   |                   |            | harmful        |
   |                   |            | recursion on   |
   |                   |            | the advance    |
   |                   |            | input pin.     |
   |-------------------+------------+----------------|
   |          category | supported  | It presents    |
   |                   |            | attributes in  |
   |                   |            | the pin,       |
   |                   |            | register and   |
   |                   |            | setting        |
   |                   |            | categories.    |
   +-------------------------------------------------+

     ----------------------------------------------------------------------

Environment:

   Related components

   Schedulers may be nested, though normally they are advanced via the top
   level event source (sid-control-cfgroot).

         new sid-sched-sim target-sched
         new sid-sched-host host-sched
         new SOME_KIND_OF_CPU cpu
         set target-sched num-clients 1
         connect-pin main perform-activity -> target-sched advance
         connect-pin main perform-activity -> host-sched advance
         connect-pin target-sched 0-event -> cpu step!
         set target-sched 0-regular? 1
         set target-sched 0-time 50


   Performance

   These schedulers use data structures and algorithms that attempt to be
   efficient for large number of event subscriptions.

   The sid-sched-host-accurate variety attempts to be accurate to 1 ms, but
   this requires many more host OS system calls and therefore slows down the
   simulation. The basic sid-sched-host type of scheduler attempt to be
   accurate to only 25 ms. It does this by frequently estimating the host
   time by adaptive extrapolation.

   High level interface

   See the <sidschedutil.h> header file for optional utility classes. These
   use the low level interface below to manage a scheduler subscription, or
   to get scheduler time.

     ----------------------------------------------------------------------

Component Reference:

  Component: sid-sched (Abstract)

   +-----------------------------------------------------+
   |                        pins                         |
   |-----------------------------------------------------|
   |   name   |direction|    legalvalues    | behaviors  |
   |----------+---------+-------------------+------------|
   |advance   |in       |any                |advancing   |
   |----------+---------+-------------------+------------|
   |yield     |in       |any                |advancing   |
   |----------+---------+-------------------+------------|
   |active    |out      |boolean            |advancing   |
   |----------+---------+-------------------+------------|
   |N-event   |out      |no value           |advancing   |
   |----------+---------+-------------------+------------|
   |N-control |in       |coded value        |subscription|
   |----------+---------+-------------------+------------|
   |time-query|in       |any                |timing      |
   |----------+---------+-------------------+------------|
   |time-high |out      |high order 32 bits |timing      |
   |          |         |of 64-bit value    |            |
   |----------+---------+-------------------+------------|
   |time-low  |out      |low order 32 bits  |timing      |
   |          |         |of 64-bit value    |            |
   +-----------------------------------------------------+

+------------------------------------------------------------------------------+
|                                  attributes                                  |
|------------------------------------------------------------------------------|
|           name            | category |  legal   |  default  |   behaviors   ||
|                           |          |  values  |   value   |               ||
|---------------------------+----------+----------+-----------+---------------||
|state-snapshot             |no        |opaque    |-          |state          ||
|                           |category  |string    |           |save/restore   ||
|---------------------------+----------+----------+-----------+---------------||
|num-clients                |setting   |numeric   |'0'        |configuration  ||
|---------------------------+----------+----------+-----------+---------------||
|N-name                     |setting   |-         |-          |configuration  ||
|---------------------------+----------+----------+-----------+---------------||
|N-regular?                 |setting   |boolean   |'0'        |subscription   ||
|---------------------------+----------+----------+-----------+---------------||
|N-time                     |setting   |numeric   |'0'        |subscription   ||
|---------------------------+----------+----------+-----------+---------------||
|N-priority                 |setting   |numeric   |'0'        |subscription   ||
|---------------------------+----------+----------+-----------+---------------||
|N-scale                    |setting   |numeric   |'1'        |subscription   ||
|                           |          |fraction  |           |               ||
|---------------------------+----------+----------+-----------+---------------||
|N-event                    |pin       |-         |-          |advancing      ||
|---------------------------+----------+----------+-----------+---------------||
|N-control                  |pin       |-         |-          |subscription   ||
|---------------------------+----------+----------+-----------+---------------||
|advance                    |pin       |-         |-          |advancing      ||
|---------------------------+----------+----------+-----------+---------------||
|yield                      |pin       |-         |-          |advancing      ||
|---------------------------+----------+----------+-----------+---------------||
|enable-threshold           |setting   |numeric   |'1'        |advancing      ||
|---------------------------+----------+----------+-----------+---------------||
|enabled?                   |setting   |numeric   |'1'        |advancing      ||
|---------------------------+----------+----------+-----------+---------------||
|yield-host-time-threshold  |setting   |numeric   |'1'        |timing         ||
|---------------------------+----------+----------+-----------+---------------||
|yield-host-time?           |setting   |numeric   |'0'        |timing         ||
|---------------------------+----------+----------+-----------+---------------||
|step-cycle-limit           |setting   |numeric   |advancing  |               ||
|---------------------------+----------+----------+-----------+---------------||
|time                       |register  |numeric   |timing     |               ||
|---------------------------+----------+----------+-----------+---------------||
|advance-count              |register  |numeric   |advancing  |               ||
+------------------------------------------------------------------------------+

  Variant: sid-sched-sim

   Same as sid-sched

  Variant: sid-sched-host

   Same as sid-sched

  Variant: sid-sched-host-accurate

   Same as sid-sched
@


1.7
log
@2003-10-07  Dave Brolley  <brolley@@redhat.com>

        For Graydon Hoare  <graydon@@redhat.com>
        * sid-visual-sched.tk (toggle_subscription): Do not alter the
        enabled? flag of the scheduler when updating subscriptions.
        (set_sub): Alter the subscription in an order that respects
        whether time is zero or not.
@
text
@d98 4
a101 4
   |               | regular-vs-irregular flag, and  |
   |               | a time quantity. The index is a |
   |               | number between 0 and            |
   |               | num-clients -1, and is          |
d107 13
a119 9
   |               | attribute. The time quantity is |
   |               | accessible as the N-time        |
   |               | attribute. If the value is      |
   |               | zero, it is interpreted as a    |
   |               | request to cancel all pending   |
   |               | events for this subscription.   |
   |               | Otherwise, the value is taken   |
   |               | to be a delta until the time of |
   |               | the requested event.            |
d188 8
d306 2
@


1.6
log
@2003-08-29  Dave Brolley  <brolley@@redhat.com>

        * compSched.cxx (operator <<): Stream active_p and active_pin.
        (operator >>): Ditto.
        (active_p): New member of scheduler_component.
        (active_pin): Ditto.
        (advance): Drive active_pin with 1 or 0 as the enable
        threshold is crossed.
        (scheduler_component): Initialize active_p. Add "active_pin".
        (sid-sched.xml): Document "active" pin and interaction between
        "enabled?" and "enable-threshold".
        (sid-sched.txt): Regenerated.
@
text
@d141 4
a144 3
   |               | less than enable-threshold,     |
   |               | advancing as described below,   |
   |               | does not occur.                 |
d253 66
a318 68
   +-------------------------------------------------+
   |                      pins                       |
   |-------------------------------------------------|
   |   name   |direction|  legalvalues  | behaviors  |
   |----------+---------+---------------+------------|
   |advance   |in       |any            |advancing   |
   |----------+---------+---------------+------------|
   |yield     |in       |any            |advancing   |
   |----------+---------+---------------+------------|
   |active    |out      |boolean        |advancing   |
   |----------+---------+---------------+------------|
   |N-event   |out      |no value       |advancing   |
   |----------+---------+---------------+------------|
   |N-control |in       |coded value    |subscription|
   |----------+---------+---------------+------------|
   |time-query|in       |any            |timing      |
   |----------+---------+---------------+------------|
   |          |         |high order 32  |            |
   |time-high |out      |bits of 64-bit |timing      |
   |          |         |value          |            |
   |----------+---------+---------------+------------|
   |          |         |low order 32   |            |
   |time-low  |out      |bits of 64-bit |timing      |
   |          |         |value          |            |
   +-------------------------------------------------+

   +---------------------------------------------------------------------------+
   |                                attributes                                 |
   |---------------------------------------------------------------------------|
   |          name           |category| legal  | default value  |  behaviors  ||
   |                         |        | values |                |             ||
   |-------------------------+--------+--------+----------------+-------------||
   |state-snapshot           |no      |opaque  |-               |state        ||
   |                         |category|string  |                |save/restore ||
   |-------------------------+--------+--------+----------------+-------------||
   |num-clients              |setting |numeric |'0'             |configuration||
   |-------------------------+--------+--------+----------------+-------------||
   |N-name                   |setting |-       |-               |configuration||
   |-------------------------+--------+--------+----------------+-------------||
   |N-regular?               |setting |boolean |'0'             |subscription ||
   |-------------------------+--------+--------+----------------+-------------||
   |N-time                   |setting |numeric |'0'             |subscription ||
   |-------------------------+--------+--------+----------------+-------------||
   |N-scale                  |setting |numeric |'1'             |subscription ||
   |                         |        |fraction|                |             ||
   |-------------------------+--------+--------+----------------+-------------||
   |N-event                  |pin     |-       |-               |advancing    ||
   |-------------------------+--------+--------+----------------+-------------||
   |N-control                |pin     |-       |-               |subscription ||
   |-------------------------+--------+--------+----------------+-------------||
   |advance                  |pin     |-       |-               |advancing    ||
   |-------------------------+--------+--------+----------------+-------------||
   |yield                    |pin     |-       |-               |advancing    ||
   |-------------------------+--------+--------+----------------+-------------||
   |enabled?                 |setting |numeric |'1'             |advancing    ||
   |-------------------------+--------+--------+----------------+-------------||
   |enable-threshold         |setting |numeric |'1'             |advancing    ||
   |-------------------------+--------+--------+----------------+-------------||
   |yield-host-time-threshold|setting |numeric |'1'             |timing       ||
   |-------------------------+--------+--------+----------------+-------------||
   |yield-host-time?         |setting |numeric |'0'             |timing       ||
   |-------------------------+--------+--------+----------------+-------------||
   |step-cycle-limit         |setting |numeric |advancing       |             ||
   |-------------------------+--------+--------+----------------+-------------||
   |time                     |register|numeric |timing          |             ||
   |-------------------------+--------+--------+----------------+-------------||
   |advance-count            |register|numeric |advancing       |             ||
   +---------------------------------------------------------------------------+
@


1.5
log
@* documentation changes for the following patch.
* apparently missed in the 2002-03-04 merge?

2002-01-09  Graydon Hoare  <graydon@@redhat.com>

	* compSched.cxx (scheduler_client): New member "name".
	(client_num_update): Hook up "N-name" attribute to client->name.
	* sid-visual-sched.tk (relate): Load subscription names into GUI,
	ghost subscriptions which have no output pins connected.
	* sid-sched.xml: Document new N-name attributes.
	* sid-sched.txt: Regenerate.
@
text
@d151 14
a164 1
   |               | attribute is incremented.       |
d261 2
d306 1
a306 1
   |enable-theshold          |setting |numeric |'1'             |advancing    ||
d308 1
a308 1
   |enabled?                 |setting |numeric |enable-threshold|advancing    ||
@


1.4
log
@Fixed a typo.
@
text
@d31 6
a36 1
   |               | own signalling schedule.        |
d273 2
@


1.3
log
@2001-10-17  Dave Brolley  <brolley@@redhat.com>

	* compSched.cxx (operator <<): Save state of enable_threshold and
	yield_host_time_threshold.
	(operator >>): Restore state of enable_threshold and
	yield_host_time_threshold.
	(class scheduler_component): New members: enable_threshold,
	yield_host_time_threshold.
	(scheduler_component::advance): Check enable_p against enable_threshold.
	Check yield_host_time_p against yield_host_time_theshold.
	(scheduler_component): Initialize enable_threshold, enable_p,
	yield_host_time_p and yield_host_time_threshold.
	(scheduler_component_ctor_1): Add attributes 'enable-threshold' and
	'yield-host-time-threshold'.
	* sid-sched.xml (enabled?): Update defscription.
	(yield-host-time): Update defscription.
	(enable-threshold): New attribute.
	(yield-host-time-threshold): New attribute.
	* sid-sched.txt: Regenerate.
@
text
@d63 1
a63 1
   |               | equalt to                       |
@


1.2
log
@* Freshly generated documentation.
* ChangeLog entries to follow later.
@
text
@d62 7
a68 4
   |               | set to 1, a host-time scheduler |
   |               | will yield some amount of time  |
   |               | to the host operating system    |
   |               | using a function like usleep(). |
d135 2
a136 1
   |               | enabled? attribute to 0,        |
d258 40
a297 36
   +-----------------------------------------------------------+
   |                        attributes                         |
   |-----------------------------------------------------------|
   |      name      |category| legal  | default |  behaviors  ||
   |                |        | values |  value  |             ||
   |----------------+--------+--------+---------+-------------||
   |state-snapshot  |no      |opaque  |-        |state        ||
   |                |category|string  |         |save/restore ||
   |----------------+--------+--------+---------+-------------||
   |num-clients     |setting |numeric |'0'      |configuration||
   |----------------+--------+--------+---------+-------------||
   |N-regular?      |setting |boolean |'0'      |subscription ||
   |----------------+--------+--------+---------+-------------||
   |N-time          |setting |numeric |'0'      |subscription ||
   |----------------+--------+--------+---------+-------------||
   |N-scale         |setting |numeric |'1'      |subscription ||
   |                |        |fraction|         |             ||
   |----------------+--------+--------+---------+-------------||
   |N-event         |pin     |-       |-        |advancing    ||
   |----------------+--------+--------+---------+-------------||
   |N-control       |pin     |-       |-        |subscription ||
   |----------------+--------+--------+---------+-------------||
   |advance         |pin     |-       |-        |advancing    ||
   |----------------+--------+--------+---------+-------------||
   |yield           |pin     |-       |-        |advancing    ||
   |----------------+--------+--------+---------+-------------||
   |enabled?        |setting |boolean |'1'      |advancing    ||
   |----------------+--------+--------+---------+-------------||
   |yield-host-time?|setting |boolean |'0'      |timing       ||
   |----------------+--------+--------+---------+-------------||
   |step-cycle-limit|setting |numeric |advancing|             ||
   |----------------+--------+--------+---------+-------------||
   |time            |register|numeric |timing   |             ||
   |----------------+--------+--------+---------+-------------||
   |advance-count   |register|numeric |advancing|             ||
   +-----------------------------------------------------------+
@


1.1
log
@* public snapshot of sid simulator
@
text
@d1 1
a1 2
* Name
  sid-sched-sim sid-sched-host sid-sched-host-accurate
d3 1
a3 2
* Synopsis
  These components manage multiple signal schedules.
d5 297
a301 169
  Attributes: enabled? num-clients step-cycle-limit time yield-host-time? 
              advance-count N-regular? N-time N-control N-event N-scale
  Pins: advance yield time-query time-high time-low N-control N-event

  Shared library: libsched.la
  Symbol: sched_component_library

* Functionality
 
  - Modelling

    * These components function as general purpose signal schedulers.
      They approximately correspond to a collection of programmable clock
      dividers.

    * The number of controllable outputs ("subscriptions") is a matter
      of configuration.

    * The three component types are identical, except in their notions
      of "time".  See the Timing section below.

  - Behaviors

    * Configuration

      When the "num-clients" is written-to, this component adjusts its
      list of scheduler clients.  Each "client" corresponds to a set of
      "N-" pins and attributes, with its own signalling schedule.

    * Timing

      There is no global concept of simulation time in sid.  Instead,
      each scheduler instance maintains its own notion of "time".  

      A "sid-sched-sim" scheduler maintains a 64-bit integer as a time
      counter.  When advancing, this "time" counter is set to jump
      forward to the earliest of the upcoming subscribed signals.
      This way, it represents the clock of a traditional event-driven
      simulator.
      
      The "sid-sched-host" and "sid-sched-host-accurate" schedulers use
      a millisecond-precision timer of the host operating system.  Its
      "time" is simply that of the operating system.  When
      advancing, there may be no scheduled events due, even though
      there may be scheduled events.  In such a case, if the
      "yield-host-time?"  attribute is set to "1", a host-time
      scheduler will yield some amount of time to the host operating
      system using a function like usleep().

      The "time-query" pin, when driven, causes a scheduler to signal
      its current 64-bit "time" back, in two 32-bit halves, on the
      "time-high", then "time-low" pins.  Similarly, the "time"
      attribute may be accessed to get/set the scheduler's time.

    * Subscription 

      The scheduler maintains a number of "subscriptions".  Each
      subscription represents a request to provide a series of
      recurring "regular" signals, or a single-shot "irregular"
      signal, some time in the simulation's future.  Each subscription
      has an associated set of pins and attributes to control it.

      Each subscription is defined by an index, a regular-vs-irregular
      flag, and a time quantity.  The index is a number between 0 and
      "num-clients" -1, and is represented as "N" in the pin/attribute
      list templates in this document.  The regular-vs-irregular flag
      is accessible as the "N-regular?" attribute.  The time
      quantity is accessible as the "N-time" attribute.  If the
      value is zero, it is interpreted as a request to cancel all pending
      events for this subscription.  Otherwise, the value is taken to
      be a delta until the "time" of the requested event.

      You can also set these controls by driving encoded values into
      the "N-control" pin.  The top bit is interpreted as the
      regular-vs-irregular flag (1: regular, 0:irregular), and the
      remaining bits as the delta "time" value.  If the delta is zero,
      events for this subscription are cancelled.

      In each case, the time value sent is multiplied by a scale before
      being merged into the master schedule.  The scaling value is
      available on the "N-scale" attribute, and may be specified as
      a plain number, or as a fraction of two numbers (e.g., "1/5").

    * Advancing

      When you have disabled the scheduler by setting the "enabled?"
      attribute to 0, advancing as described below, does not occur.

      Whenever the "advance" input pin is driven, the scheduler may
      dispatch one or more signals by driving the "N-event" output
      pins with some value.  A counter accessed by the "advance-count"
      attribute is incremented.

      Whether any particular "N-event" pin is driven depends on the
      subscription associated with that pin, and the passage of that
      scheduler's "time".  All events that are due "now", or that are 
      overdue are dispatched.

      If there are multiple due or overdue events, the scheduler may
      loop over the pending event up to "step-cycle-limit" number of
      times, as an optimization.  This loop may be aborted early if
      the "yield" input pin is driven.

  - SID conventions
    * This is a functional component.
    * It supports state save/restore.
    * It does not support triggerpoints.
    * It prevents harmful recursion on the "advance" input pin.
    * It presents attributes in the "pin", "register" and "setting" categories.

* Environment
  - Related components

    * Schedulers may be nested, though normally they are advanced via the
      top level event source (sid-control-cfgroot).

	new sid-sched-sim target-sched
        new sid-sched-host host-sched
	new SOME_KIND_OF_CPU cpu
	set target-sched num-clients 1
	connect-pin main perform-activity -> target-sched advance
	connect-pin main perform-activity -> host-sched advance
	connect-pin target-sched 0-event -> cpu step!
	set target-sched 0-regular? 1 
	set target-sched 0-time 50 

  - Performance

    * These schedulers use data structures and algorithms that attempt
      to be efficient for large number of event subscriptions.

    * The "sid-sched-host-accurate" variety attempts to be accurate to
      1 ms, but this requires many more host OS system calls and
      therefore slows down the simulation.  The basic "sid-sched-host"
      type of scheduler attempt to be accurate to only 25 ms.  It does 
      this by frequently estimating the host time by adaptive extrapolation.

* SID interface reference


  - low level:

    * pins

      - advance | input | any | advancing
      - yield | input | any | advancing
      - N-event | output | no value | advancing
      - N-control | input | coded value | subscription
      - time-query | input | any | timing      
      - time-high | output | high order 32 bits of 64-bit value | timing
      - time-low | output | low order 32 bits of 64-bit value | timing

    * attributes

      - state-snapshot | no category | opaque string | n/a | state save/restore
      - num-clients | setting | numeric | "0" | configuration
      - N-regular? | setting | boolean | "0" | subscription
      - N-time | setting | numeric | "0" | subscription
      - N-scale | setting | numeric fraction | "1" | subscription
      - N-event | pin | n/a | n/a | advancing
      - N-control | pin | n/a | n/a | subscription
      - advance | pin | n/a | n/a | advancing
      - yield | pin | n/a | n/a | advancing
      - enabled? | setting | boolean | "1" | advancing
      - yield-host-time? | setting | boolean | "0" | timing
      - step-cycle-limit | setting | numeric | advancing
      - time | register | numeric | timing
      - advance-count | register | numeric | advancing
 
@

