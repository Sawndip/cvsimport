head	1.8;
access;
symbols
	sid-snapshot-20180601:1.8
	sid-snapshot-20180501:1.8
	sid-snapshot-20180401:1.8
	sid-snapshot-20180301:1.8
	sid-snapshot-20180201:1.8
	sid-snapshot-20180101:1.8
	sid-snapshot-20171201:1.8
	sid-snapshot-20171101:1.8
	sid-snapshot-20171001:1.8
	sid-snapshot-20170901:1.8
	sid-snapshot-20170801:1.8
	sid-snapshot-20170701:1.8
	sid-snapshot-20170601:1.8
	sid-snapshot-20170501:1.8
	sid-snapshot-20170401:1.8
	sid-snapshot-20170301:1.8
	sid-snapshot-20170201:1.8
	sid-snapshot-20170101:1.8
	sid-snapshot-20161201:1.8
	sid-snapshot-20161101:1.8
	sid-snapshot-20160901:1.8
	sid-snapshot-20160801:1.8
	sid-snapshot-20160701:1.8
	sid-snapshot-20160601:1.8
	sid-snapshot-20160501:1.8
	sid-snapshot-20160401:1.8
	sid-snapshot-20160301:1.8
	sid-snapshot-20160201:1.8
	sid-snapshot-20160101:1.8
	sid-snapshot-20151201:1.8
	sid-snapshot-20151101:1.8
	sid-snapshot-20151001:1.8
	sid-snapshot-20150901:1.8
	sid-snapshot-20150801:1.8
	sid-snapshot-20150701:1.8
	sid-snapshot-20150601:1.8
	sid-snapshot-20150501:1.8
	sid-snapshot-20150401:1.8
	sid-snapshot-20150301:1.8
	sid-snapshot-20150201:1.8
	sid-snapshot-20150101:1.8
	sid-snapshot-20141201:1.8
	sid-snapshot-20141101:1.8
	sid-snapshot-20141001:1.8
	sid-snapshot-20140901:1.8
	sid-snapshot-20140801:1.8
	sid-snapshot-20140701:1.8
	sid-snapshot-20140601:1.8
	sid-snapshot-20140501:1.8
	sid-snapshot-20140401:1.8
	sid-snapshot-20140301:1.8
	sid-snapshot-20140201:1.8
	sid-snapshot-20140101:1.8
	sid-snapshot-20131201:1.8
	sid-snapshot-20131101:1.8
	sid-snapshot-20131001:1.8
	sid-snapshot-20130901:1.8
	sid-snapshot-20130801:1.8
	sid-snapshot-20130701:1.8
	sid-snapshot-20130601:1.8
	sid-snapshot-20130501:1.8
	sid-snapshot-20130401:1.8
	sid-snapshot-20130301:1.8
	sid-snapshot-20130201:1.8
	sid-snapshot-20130101:1.8
	sid-snapshot-20121201:1.8
	sid-snapshot-20121101:1.8
	sid-snapshot-20121001:1.8
	sid-snapshot-20120901:1.8
	sid-snapshot-20120801:1.8
	sid-snapshot-20120701:1.8
	sid-snapshot-20120601:1.8
	sid-snapshot-20120501:1.8
	sid-snapshot-20120401:1.8
	sid-snapshot-20120301:1.8
	sid-snapshot-20120201:1.8
	sid-snapshot-20120101:1.8
	sid-snapshot-20111201:1.8
	sid-snapshot-20111101:1.8
	sid-snapshot-20111001:1.8
	sid-snapshot-20110901:1.8
	sid-snapshot-20110801:1.8
	sid-snapshot-20110701:1.8
	sid-snapshot-20110601:1.8
	sid-snapshot-20110501:1.8
	sid-snapshot-20110401:1.8
	sid-snapshot-20110301:1.8
	sid-snapshot-20110201:1.8
	sid-snapshot-20110101:1.8
	sid-snapshot-20101201:1.8
	sid-snapshot-20101101:1.8
	sid-snapshot-20101001:1.8
	sid-snapshot-20100901:1.8
	sid-snapshot-20100801:1.8
	sid-snapshot-20100701:1.8
	sid-snapshot-20100601:1.8
	sid-snapshot-20100501:1.8
	sid-snapshot-20100401:1.8
	sid-snapshot-20100301:1.8
	sid-snapshot-20100201:1.7
	sid-snapshot-20100101:1.6
	sid-snapshot-20091201:1.6
	sid-snapshot-20091101:1.6
	sid-snapshot-20091001:1.5
	sid-snapshot-20090901:1.5
	sid-snapshot-20090801:1.5
	sid-snapshot-20090701:1.5
	sid-snapshot-20090601:1.5
	sid-snapshot-20090501:1.5
	sid-snapshot-20090401:1.5
	sid-snapshot-20090301:1.5
	sid-snapshot-20090201:1.5
	sid-snapshot-20090101:1.5
	sid-snapshot-20081201:1.5
	sid-snapshot-20081101:1.5
	sid-snapshot-20081001:1.5
	sid-snapshot-20080901:1.5
	sid-snapshot-20080801:1.5
	sid-snapshot-20080701:1.5
	sid-snapshot-20080601:1.5
	sid-snapshot-20080501:1.5
	sid-snapshot-20080403:1.5
	sid-snapshot-20080401:1.5
	sid-snapshot-20080301:1.5
	sid-snapshot-20080201:1.5
	sid-snapshot-20080101:1.5
	sid-snapshot-20071201:1.5
	sid-snapshot-20071101:1.5
	sid-snapshot-20071001:1.5
	sid-20020905-branchpoint:1.2
	sid-20020905-branch:1.2.0.2
	cygnus_cvs_20020108_pre:1.2;
locks; strict;
comment	@ * @;


1.8
date	2010.02.12.02.33.04;	author devans;	state Exp;
branches;
next	1.7;

1.7
date	2010.01.02.21.18.54;	author devans;	state Exp;
branches;
next	1.6;

1.6
date	2009.10.24.00.45.55;	author devans;	state Exp;
branches;
next	1.5;

1.5
date	2003.07.05.17.07.20;	author devans;	state Exp;
branches;
next	1.4;

1.4
date	2003.01.08.03.17.27;	author bje;	state Exp;
branches;
next	1.3;

1.3
date	2002.09.07.14.42.49;	author fche;	state Exp;
branches;
next	1.2;

1.2
date	2001.01.29.20.03.25;	author fche;	state Exp;
branches;
next	1.1;

1.1
date	2000.12.07.19.30.48;	author fche;	state Exp;
branches;
next	;


desc
@@


1.8
log
@Regenerate to pick up recent cgen changes.
[minor changes like removing K&R support, more consistent name for sfmt_empty]
@
text
@/* Decode header for thumb.

THIS FILE IS MACHINE GENERATED WITH CGEN.

Copyright (C) 2000-2010 Red Hat, Inc.

This file is part of the Red Hat simulators.


*/

#ifndef THUMB_DECODE_H
#define THUMB_DECODE_H

namespace arm7f {

using namespace cgen;
using namespace arm;

typedef UINT thumb_insn_word;

/* Enum declaration for instructions in cpu family thumb.  */
typedef enum thumb_insn_type {
  THUMB_INSN_X_AFTER, THUMB_INSN_X_BEFORE, THUMB_INSN_X_CTI_CHAIN, THUMB_INSN_X_CHAIN
 , THUMB_INSN_X_BEGIN, THUMB_INSN_X_INVALID, THUMB_INSN_LSL, THUMB_INSN_LSR
 , THUMB_INSN_ASR, THUMB_INSN_ADD, THUMB_INSN_ADDI, THUMB_INSN_SUB
 , THUMB_INSN_SUBI, THUMB_INSN_MOV, THUMB_INSN_CMP, THUMB_INSN_ADDI8
 , THUMB_INSN_SUBI8, THUMB_INSN_ALU_AND, THUMB_INSN_ALU_EOR, THUMB_INSN_ALU_LSL
 , THUMB_INSN_ALU_LSR, THUMB_INSN_ALU_ASR, THUMB_INSN_ALU_ROR, THUMB_INSN_ALU_ADC
 , THUMB_INSN_ALU_SBC, THUMB_INSN_ALU_TST, THUMB_INSN_ALU_NEG, THUMB_INSN_ALU_CMP
 , THUMB_INSN_ALU_CMN, THUMB_INSN_ALU_ORR, THUMB_INSN_ALU_MUL, THUMB_INSN_ALU_BIC
 , THUMB_INSN_ALU_MVN, THUMB_INSN_ADD_RD_HS, THUMB_INSN_ADD_HD_RS, THUMB_INSN_ADD_HD_HS
 , THUMB_INSN_CMP_RD_HS, THUMB_INSN_CMP_HD_RS, THUMB_INSN_CMP_HD_HS, THUMB_INSN_MOV_RD_HS
 , THUMB_INSN_MOV_HD_RS, THUMB_INSN_MOV_HD_HS, THUMB_INSN_BX_RS, THUMB_INSN_BX_HS
 , THUMB_INSN_LDR_PC, THUMB_INSN_STR, THUMB_INSN_STRB, THUMB_INSN_LDR
 , THUMB_INSN_LDRB, THUMB_INSN_STRH, THUMB_INSN_LDRH, THUMB_INSN_LDSB
 , THUMB_INSN_LDSH, THUMB_INSN_STR_IMM, THUMB_INSN_LDR_IMM, THUMB_INSN_STRB_IMM
 , THUMB_INSN_LDRB_IMM, THUMB_INSN_STRH_IMM, THUMB_INSN_LDRH_IMM, THUMB_INSN_STR_SPREL
 , THUMB_INSN_LDR_SPREL, THUMB_INSN_LDA_PC, THUMB_INSN_LDA_SP, THUMB_INSN_ADD_SP
 , THUMB_INSN_SUB_SP, THUMB_INSN_PUSH, THUMB_INSN_PUSH_LR, THUMB_INSN_POP
 , THUMB_INSN_POP_PC, THUMB_INSN_STMIA, THUMB_INSN_LDMIA, THUMB_INSN_BEQ
 , THUMB_INSN_BNE, THUMB_INSN_BCS, THUMB_INSN_BCC, THUMB_INSN_BMI
 , THUMB_INSN_BPL, THUMB_INSN_BVS, THUMB_INSN_BVC, THUMB_INSN_BHI
 , THUMB_INSN_BLS, THUMB_INSN_BGE, THUMB_INSN_BLT, THUMB_INSN_BGT
 , THUMB_INSN_BLE, THUMB_INSN_SWI, THUMB_INSN_B, THUMB_INSN_BL_HI
 , THUMB_INSN_BL_LO
} THUMB_INSN_TYPE;


// Forward decls.
struct arm7f_cpu;
struct thumb_scache;
typedef sem_status (thumb_sem_fn) (arm7f_cpu* cpu, thumb_scache* sem);


// Instruction descriptor.

struct thumb_idesc {

  // computed-goto label pointer (pbb engine)
  // FIXME: frag case to be redone (should instead point to usage table).
  cgoto_label cgoto;

  // scache engine executor for this insn
  thumb_sem_fn* execute;

  const char* insn_name;
  enum thumb_insn_type sem_index;
  arm_insn_attr attrs;

  // idesc table: indexed by sem_index
  static thumb_idesc idesc_table[];

  // semantic label pointers filled_in?
  static bool idesc_table_initialized_p;

  static thumb_insn_type lookup_virtual (virtual_insn_type vit);
};

// Instruction argument buffer.

union thumb_sem_fields {
  struct { /* no operands */
    int empty;
  } sfmt_empty;
  struct { /*  */
    UINT f_lbwl_lo;
  } sfmt_bl_lo;
  struct { /*  */
    INT f_lbwl_hi;
  } sfmt_bl_hi;
  struct { /*  */
    IADDR i_offset11;
  } sfmt_b;
  struct { /*  */
    UINT f_value8;
  } sfmt_swi;
  struct { /*  */
    IADDR i_soffset8;
  } sfmt_beq;
  struct { /*  */
    SI f_sword7;
  } sfmt_add_sp;
  struct { /*  */
    UINT f_bit10_rb;
    UINT f_rlist;
  } sfmt_stmia;
  struct { /*  */
    SI f_word8;
    UINT f_bit10_rd;
  } sfmt_ldr_pc;
  struct { /*  */
    UINT f_bit10_rd;
    UINT f_offset8;
  } sfmt_mov;
  struct { /*  */
    SI f_offset5_6;
    UINT f_rb;
    UINT f_rd;
  } sfmt_strh_imm;
  struct { /*  */
    UINT f_offset5;
    UINT f_rb;
    UINT f_rd;
  } sfmt_strb_imm;
  struct { /*  */
    SI f_offset5_7;
    UINT f_rb;
    UINT f_rd;
  } sfmt_str_imm;
  struct { /*  */
    UINT f_rb;
    UINT f_rd;
    UINT f_ro;
  } sfmt_str;
  struct { /*  */
    UINT f_offset3;
    UINT f_rd;
    UINT f_rs;
  } sfmt_addi;
  struct { /*  */
    UINT f_rd;
    UINT f_rn;
    UINT f_rs;
  } sfmt_add;
  struct { /*  */
    UINT f_offset5;
    UINT f_rd;
    UINT f_rs;
  } sfmt_lsl;
  // This one is for chain/cti-chain virtual insns.
  struct {
    // Number of insns in pbb.
    unsigned insn_count;
    // This is used by chain insns and by untaken conditional branches.
    thumb_scache* next;
    thumb_scache* branch_target;
  } chain;
  // This one is for `before' virtual insns.
  struct {
    // The cache entry of the real insn.
    thumb_scache* insn;
  } before;
};

// Simulator instruction cache.

struct thumb_scache {
  // executor
  union {
    cgoto_label cgoto;
    thumb_sem_fn* fn;
  } execute;

  // PC of this instruction.
  PCADDR addr;

  // instruction class
  thumb_idesc* idesc;

  // argument buffer
  thumb_sem_fields fields;



  // decode given instruction
  void decode (arm7f_cpu* current_cpu, PCADDR pc, thumb_insn_word base_insn, thumb_insn_word entire_insn);
};

} // end arm7f namespace

// Decls of each semantic fn.

using arm7f::thumb_sem_fn;
extern thumb_sem_fn thumb_sem_x_invalid;
extern thumb_sem_fn thumb_sem_lsl;
extern thumb_sem_fn thumb_sem_lsr;
extern thumb_sem_fn thumb_sem_asr;
extern thumb_sem_fn thumb_sem_add;
extern thumb_sem_fn thumb_sem_addi;
extern thumb_sem_fn thumb_sem_sub;
extern thumb_sem_fn thumb_sem_subi;
extern thumb_sem_fn thumb_sem_mov;
extern thumb_sem_fn thumb_sem_cmp;
extern thumb_sem_fn thumb_sem_addi8;
extern thumb_sem_fn thumb_sem_subi8;
extern thumb_sem_fn thumb_sem_alu_and;
extern thumb_sem_fn thumb_sem_alu_eor;
extern thumb_sem_fn thumb_sem_alu_lsl;
extern thumb_sem_fn thumb_sem_alu_lsr;
extern thumb_sem_fn thumb_sem_alu_asr;
extern thumb_sem_fn thumb_sem_alu_ror;
extern thumb_sem_fn thumb_sem_alu_adc;
extern thumb_sem_fn thumb_sem_alu_sbc;
extern thumb_sem_fn thumb_sem_alu_tst;
extern thumb_sem_fn thumb_sem_alu_neg;
extern thumb_sem_fn thumb_sem_alu_cmp;
extern thumb_sem_fn thumb_sem_alu_cmn;
extern thumb_sem_fn thumb_sem_alu_orr;
extern thumb_sem_fn thumb_sem_alu_mul;
extern thumb_sem_fn thumb_sem_alu_bic;
extern thumb_sem_fn thumb_sem_alu_mvn;
extern thumb_sem_fn thumb_sem_add_rd_hs;
extern thumb_sem_fn thumb_sem_add_hd_rs;
extern thumb_sem_fn thumb_sem_add_hd_hs;
extern thumb_sem_fn thumb_sem_cmp_rd_hs;
extern thumb_sem_fn thumb_sem_cmp_hd_rs;
extern thumb_sem_fn thumb_sem_cmp_hd_hs;
extern thumb_sem_fn thumb_sem_mov_rd_hs;
extern thumb_sem_fn thumb_sem_mov_hd_rs;
extern thumb_sem_fn thumb_sem_mov_hd_hs;
extern thumb_sem_fn thumb_sem_bx_rs;
extern thumb_sem_fn thumb_sem_bx_hs;
extern thumb_sem_fn thumb_sem_ldr_pc;
extern thumb_sem_fn thumb_sem_str;
extern thumb_sem_fn thumb_sem_strb;
extern thumb_sem_fn thumb_sem_ldr;
extern thumb_sem_fn thumb_sem_ldrb;
extern thumb_sem_fn thumb_sem_strh;
extern thumb_sem_fn thumb_sem_ldrh;
extern thumb_sem_fn thumb_sem_ldsb;
extern thumb_sem_fn thumb_sem_ldsh;
extern thumb_sem_fn thumb_sem_str_imm;
extern thumb_sem_fn thumb_sem_ldr_imm;
extern thumb_sem_fn thumb_sem_strb_imm;
extern thumb_sem_fn thumb_sem_ldrb_imm;
extern thumb_sem_fn thumb_sem_strh_imm;
extern thumb_sem_fn thumb_sem_ldrh_imm;
extern thumb_sem_fn thumb_sem_str_sprel;
extern thumb_sem_fn thumb_sem_ldr_sprel;
extern thumb_sem_fn thumb_sem_lda_pc;
extern thumb_sem_fn thumb_sem_lda_sp;
extern thumb_sem_fn thumb_sem_add_sp;
extern thumb_sem_fn thumb_sem_sub_sp;
extern thumb_sem_fn thumb_sem_push;
extern thumb_sem_fn thumb_sem_push_lr;
extern thumb_sem_fn thumb_sem_pop;
extern thumb_sem_fn thumb_sem_pop_pc;
extern thumb_sem_fn thumb_sem_stmia;
extern thumb_sem_fn thumb_sem_ldmia;
extern thumb_sem_fn thumb_sem_beq;
extern thumb_sem_fn thumb_sem_bne;
extern thumb_sem_fn thumb_sem_bcs;
extern thumb_sem_fn thumb_sem_bcc;
extern thumb_sem_fn thumb_sem_bmi;
extern thumb_sem_fn thumb_sem_bpl;
extern thumb_sem_fn thumb_sem_bvs;
extern thumb_sem_fn thumb_sem_bvc;
extern thumb_sem_fn thumb_sem_bhi;
extern thumb_sem_fn thumb_sem_bls;
extern thumb_sem_fn thumb_sem_bge;
extern thumb_sem_fn thumb_sem_blt;
extern thumb_sem_fn thumb_sem_bgt;
extern thumb_sem_fn thumb_sem_ble;
extern thumb_sem_fn thumb_sem_swi;
extern thumb_sem_fn thumb_sem_b;
extern thumb_sem_fn thumb_sem_bl_hi;
extern thumb_sem_fn thumb_sem_bl_lo;

#endif /* THUMB_DECODE_H */
@


1.7
log
@Regenerate cgen files, update copyright year.
@
text
@d85 1
a85 1
  } fmt_empty;
@


1.6
log
@	* cgen-cpu.h: Update for new location of cgen/bitset.h.
	* tracedis.h: Ditto.

Plus update generated files to pick up two cgen changes:
1)
	* desc-cpu.scm (/gen-hash-defines): Remove #include of cgen-bitset.h.
	* sid-cpu.scm (cgen-desc.h): Update location of cgen's bitset.h.
2)
	* utils-sim.scm (/gen-set-itype-and-extract): New function.
	(/gen-bracketed-set-itype-and-extract): New function.
	(/gen-decode-default-entry): Rewrite.
	(/table-guts-to-mask, /all-opcode-bits-used?): New functions.
	(/gen-decode-insn-entry): New arg table-guts-thus-far, all callers
	updated.  Don't unnecessarily emit check for whether all opcode bits
	have been examined.
	(/gen-decode-expr-set-itype): Delete.
	(/gen-decode-expr-entry): Update.
	(/gen-decode-table-entry): New arg table-guts-thus-far, all callers
	updated.  Keep track of decoder tables used thus far.
	(/gen-decoder-switch): Ditto.
@
text
@d5 1
a5 1
Copyright (C) 2000-2009 Red Hat, Inc.
@


1.5
log
@Regenerate cgen files (not due to any recent changes, just want to
establish a reference point).
@
text
@d5 1
a5 1
Copyright (C) 2000, 2001, 2002, 2003 Red Hat, Inc.
@


1.4
log
@2002-09-07  Frank Ch. Eigler  <fche@@redhat.com>

        * arm-*, thumb-*: Regenerated files with Robert Cragie's new
        cgen instructions.
	* arm-defs.h: Removed.
	* arm7.h: Don't include arm-defs.h.
	* Makefile.am: Stop arm-defs.h generation.
	* Makefile.in: Regenerated.
@
text
@d5 1
a5 1
Copyright (C) 2000, 2001, 2002 Red Hat, Inc.
a14 5
namespace thumb {
// forward declaration of struct in -defs.h
struct write_stacks;
}

d183 2
@


1.3
log
@* arm7t missing instructions

[cgen]
2002-09-07  Frank Ch. Eigler  <fche@@redhat.com>

	From Robert Cragie <rcc@@jennic.com>:
	* cpu/arm7.cpu (ldm*-sw*, stm*-sw*): New instructions.

[sid]
2002-09-07  Frank Ch. Eigler  <fche@@redhat.com>

	* arm-*, thumb-*: Regenerated files with Robert Cragie's new
	cgen instructions.
@
text
@d15 5
a187 2


@


1.2
log
@[arm7t/ChangeLog]
2001-01-26  Frank Ch. Eigler  <fche@@redhat.com>

	* arm-decode.h, -sem.cxx: Regenerated with more tracing improvements,
	* thumb-decode.h, -sem.cxx: Ditto.

[m32r/ChangeLog]
2001-01-26  Frank Ch. Eigler  <fche@@redhat.com>

	* m32r-decode.h, -sem.cxx: Regenerated with more tracing improvements.
@
text
@d5 1
a5 1
Copyright (C) 2000 Red Hat, Inc.
d7 1
a7 1
This file is part of the Cygnus Simulators.
d46 1
a46 1
 , THUMB_INSN_BL_LO, THUMB_INSN_MAX
@


1.1
log
@* public snapshot of sid simulator
@
text
@d184 1
a184 4
  // writeback flags
  // Only used if profiling or parallel execution support enabled during
  // file generation.
  unsigned written;
@

